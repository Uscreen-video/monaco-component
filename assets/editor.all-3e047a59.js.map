{"version":3,"file":"editor.all-3e047a59.js","sources":["../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/anchorSelect/browser/anchorSelect.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/browser/bracketMatching.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/moveCaretCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/caretOperations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/transpose.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/browser/clipboard.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/types.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeAction.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/message/browser/messageController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionMenu.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/lightBulbWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionUi.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionCommands.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionWidgetContribution.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionContributions.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelens.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codeLensCache.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelensWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelensController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/color.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorDetector.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorPickerModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorPickerWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorHoverParticipant.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/widget/embeddedCodeEditorWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/zoneWidget/browser/zoneWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/dropdown/dropdown.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/dropdown/dropdownActionViewItem.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/actions/browser/menuEntryActionViewItem.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/peekView/browser/peekView.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/hover/hoverWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverOperation.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverTypes.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetParser.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/replaceInput.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/history/browser/contextScopedHistoryWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggest.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHover.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/marked/marked.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/markdownRenderer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/markdownRenderer/browser/markdownRenderer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHover.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/getHover.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markdownHoverParticipant.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/severityIcon/common/severityIcon.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markerHoverParticipant.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hover.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorContributions.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/dataTransfer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/uuid.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/dnd/browser/dnd.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/dnd.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/labels.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetVariables.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetSession.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetController2.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/copyPaste/browser/copyPasteController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/copyPaste/browser/copyPasteContribution.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/blockCommentCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/lineCommentCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/comment.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/browser/contextmenu.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/browser/cursorUndo.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/dnd/browser/dragAndDropCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/dnd/browser/dnd.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/dropIntoEditor/browser/dropIntoEditorContribution.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findDecorations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/replaceAllCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/search.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/replacePattern.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findOptionsWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findState.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/history/browser/historyWidgetKeybindingHint.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingRanges.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/hiddenRangeModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/indentRangeProvider.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingDecorations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/syntaxRangeProvider.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/folding.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/browser/outlineModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/browser/documentSymbols.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/consts.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/utils.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostText.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionToGhostText.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/model/bracketPairsTextModelPart/fixBrackets.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionsModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestMemory.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordContextKey.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestAlternatives.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestCommitCharacters.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordDistance.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/completionModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestOvertypingCapturer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetStatus.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/symbolIcons/browser/symbolIcons.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/resizable/resizable.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetDetails.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/files/common/files.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetRenderer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/suggestWidgetInlineCompletionProvider.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/suggestWidgetPreviewModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostTextModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostTextWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostTextController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostTextHoverParticipant.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostText.contribution.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentUtils.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentation.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHints.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsHover.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsContribution.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplaceCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/lineSelection/browser/lineSelection.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/commands/trimTrailingWhitespaceCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/copyLinesCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/moveLinesCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/sortLinesCommand.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/linesOperations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/linkedEditing/browser/linkedEditing.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/links/browser/getLinks.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/links/browser/links.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/browser/multicursor.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/provideSignatureHelp.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHintsModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHintsWidget.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHints.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameInputField.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/rename.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScroll.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/wordSelections.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/smartSelect.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestInlineCompletions.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/browser/tokenization.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/opener/browser/link.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/unicodeHighlighter/browser/bannerController.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/unusualLineTerminators/browser/unusualLineTerminators.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/viewportSemanticTokens/browser/viewportSemanticTokens.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/wordHighlighter.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/browser/wordOperations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/browser/wordPartOperations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/contrib/readOnlyMessage/browser/contribution.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport './anchorSelect.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const SelectionAnchorSet = new RawContextKey('selectionAnchorSet', false);\nlet SelectionAnchorController = class SelectionAnchorController {\n    constructor(editor, contextKeyService) {\n        this.editor = editor;\n        this.selectionAnchorSetContextKey = SelectionAnchorSet.bindTo(contextKeyService);\n        this.modelChangeListener = editor.onDidChangeModel(() => this.selectionAnchorSetContextKey.reset());\n    }\n    static get(editor) {\n        return editor.getContribution(SelectionAnchorController.ID);\n    }\n    setSelectionAnchor() {\n        if (this.editor.hasModel()) {\n            const position = this.editor.getPosition();\n            this.editor.changeDecorations((accessor) => {\n                if (this.decorationId) {\n                    accessor.removeDecoration(this.decorationId);\n                }\n                this.decorationId = accessor.addDecoration(Selection.fromPositions(position, position), {\n                    description: 'selection-anchor',\n                    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n                    hoverMessage: new MarkdownString().appendText(localize('selectionAnchor', \"Selection Anchor\")),\n                    className: 'selection-anchor'\n                });\n            });\n            this.selectionAnchorSetContextKey.set(!!this.decorationId);\n            alert(localize('anchorSet', \"Anchor set at {0}:{1}\", position.lineNumber, position.column));\n        }\n    }\n    goToSelectionAnchor() {\n        if (this.editor.hasModel() && this.decorationId) {\n            const anchorPosition = this.editor.getModel().getDecorationRange(this.decorationId);\n            if (anchorPosition) {\n                this.editor.setPosition(anchorPosition.getStartPosition());\n            }\n        }\n    }\n    selectFromAnchorToCursor() {\n        if (this.editor.hasModel() && this.decorationId) {\n            const start = this.editor.getModel().getDecorationRange(this.decorationId);\n            if (start) {\n                const end = this.editor.getPosition();\n                this.editor.setSelection(Selection.fromPositions(start.getStartPosition(), end));\n                this.cancelSelectionAnchor();\n            }\n        }\n    }\n    cancelSelectionAnchor() {\n        if (this.decorationId) {\n            const decorationId = this.decorationId;\n            this.editor.changeDecorations((accessor) => {\n                accessor.removeDecoration(decorationId);\n                this.decorationId = undefined;\n            });\n            this.selectionAnchorSetContextKey.set(false);\n        }\n    }\n    dispose() {\n        this.cancelSelectionAnchor();\n        this.modelChangeListener.dispose();\n    }\n};\nSelectionAnchorController.ID = 'editor.contrib.selectionAnchorController';\nSelectionAnchorController = __decorate([\n    __param(1, IContextKeyService)\n], SelectionAnchorController);\nclass SetSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.setSelectionAnchor',\n            label: localize('setSelectionAnchor', \"Set Selection Anchor\"),\n            alias: 'Set Selection Anchor',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 32 /* KeyCode.KeyB */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.setSelectionAnchor();\n        });\n    }\n}\nclass GoToSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.goToSelectionAnchor',\n            label: localize('goToSelectionAnchor', \"Go to Selection Anchor\"),\n            alias: 'Go to Selection Anchor',\n            precondition: SelectionAnchorSet,\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.goToSelectionAnchor();\n        });\n    }\n}\nclass SelectFromAnchorToCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectFromAnchorToCursor',\n            label: localize('selectFromAnchorToCursor', \"Select from Anchor to Cursor\"),\n            alias: 'Select from Anchor to Cursor',\n            precondition: SelectionAnchorSet,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectFromAnchorToCursor();\n        });\n    }\n}\nclass CancelSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.cancelSelectionAnchor',\n            label: localize('cancelSelectionAnchor', \"Cancel Selection Anchor\"),\n            alias: 'Cancel Selection Anchor',\n            precondition: SelectionAnchorSet,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 9 /* KeyCode.Escape */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.cancelSelectionAnchor();\n        });\n    }\n}\nregisterEditorContribution(SelectionAnchorController.ID, SelectionAnchorController);\nregisterEditorAction(SetSelectionAnchor);\nregisterEditorAction(GoToSelectionAnchor);\nregisterEditorAction(SelectFromAnchorToCursor);\nregisterEditorAction(CancelSelectionAnchor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport './bracketMatching.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { editorBracketMatchBackground, editorBracketMatchBorder } from '../../../common/core/editorColorRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst overviewRulerBracketMatchForeground = registerColor('editorOverviewRuler.bracketMatchForeground', { dark: '#A0A0A0', light: '#A0A0A0', hcDark: '#A0A0A0', hcLight: '#A0A0A0' }, nls.localize('overviewRulerBracketMatchForeground', 'Overview ruler marker color for matching brackets.'));\nclass JumpToBracketAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.jumpToBracket',\n            label: nls.localize('smartSelect.jumpBracket', \"Go to Bracket\"),\n            alias: 'Go to Bracket',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 88 /* KeyCode.Backslash */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        var _a;\n        (_a = BracketMatchingController.get(editor)) === null || _a === void 0 ? void 0 : _a.jumpToBracket();\n    }\n}\nclass SelectToBracketAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectToBracket',\n            label: nls.localize('smartSelect.selectToBracket', \"Select to Bracket\"),\n            alias: 'Select to Bracket',\n            precondition: undefined,\n            description: {\n                description: `Select to Bracket`,\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'selectBrackets': {\n                                    type: 'boolean',\n                                    default: true\n                                }\n                            },\n                        }\n                    }]\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        let selectBrackets = true;\n        if (args && args.selectBrackets === false) {\n            selectBrackets = false;\n        }\n        (_a = BracketMatchingController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectToBracket(selectBrackets);\n    }\n}\nclass BracketsData {\n    constructor(position, brackets, options) {\n        this.position = position;\n        this.brackets = brackets;\n        this.options = options;\n    }\n}\nexport class BracketMatchingController extends Disposable {\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._lastBracketsData = [];\n        this._lastVersionId = 0;\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateBracketsSoon = this._register(new RunOnceScheduler(() => this._updateBrackets(), 50));\n        this._matchBrackets = this._editor.getOption(66 /* EditorOption.matchBrackets */);\n        this._updateBracketsSoon.schedule();\n        this._register(editor.onDidChangeCursorPosition((e) => {\n            if (this._matchBrackets === 'never') {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this._lastBracketsData = [];\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModelLanguageConfiguration((e) => {\n            this._lastBracketsData = [];\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(66 /* EditorOption.matchBrackets */)) {\n                this._matchBrackets = this._editor.getOption(66 /* EditorOption.matchBrackets */);\n                this._decorations.clear();\n                this._lastBracketsData = [];\n                this._lastVersionId = 0;\n                this._updateBracketsSoon.schedule();\n            }\n        }));\n        this._register(editor.onDidBlurEditorWidget(() => {\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidFocusEditorWidget(() => {\n            this._updateBracketsSoon.schedule();\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(BracketMatchingController.ID);\n    }\n    jumpToBracket() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const newSelections = this._editor.getSelections().map(selection => {\n            const position = selection.getStartPosition();\n            // find matching brackets if position is on a bracket\n            const brackets = model.bracketPairs.matchBracket(position);\n            let newCursorPosition = null;\n            if (brackets) {\n                if (brackets[0].containsPosition(position) && !brackets[1].containsPosition(position)) {\n                    newCursorPosition = brackets[1].getStartPosition();\n                }\n                else if (brackets[1].containsPosition(position)) {\n                    newCursorPosition = brackets[0].getStartPosition();\n                }\n            }\n            else {\n                // find the enclosing brackets if the position isn't on a matching bracket\n                const enclosingBrackets = model.bracketPairs.findEnclosingBrackets(position);\n                if (enclosingBrackets) {\n                    newCursorPosition = enclosingBrackets[1].getStartPosition();\n                }\n                else {\n                    // no enclosing brackets, try the very first next bracket\n                    const nextBracket = model.bracketPairs.findNextBracket(position);\n                    if (nextBracket && nextBracket.range) {\n                        newCursorPosition = nextBracket.range.getStartPosition();\n                    }\n                }\n            }\n            if (newCursorPosition) {\n                return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\n            }\n            return new Selection(position.lineNumber, position.column, position.lineNumber, position.column);\n        });\n        this._editor.setSelections(newSelections);\n        this._editor.revealRange(newSelections[0]);\n    }\n    selectToBracket(selectBrackets) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const newSelections = [];\n        this._editor.getSelections().forEach(selection => {\n            const position = selection.getStartPosition();\n            let brackets = model.bracketPairs.matchBracket(position);\n            if (!brackets) {\n                brackets = model.bracketPairs.findEnclosingBrackets(position);\n                if (!brackets) {\n                    const nextBracket = model.bracketPairs.findNextBracket(position);\n                    if (nextBracket && nextBracket.range) {\n                        brackets = model.bracketPairs.matchBracket(nextBracket.range.getStartPosition());\n                    }\n                }\n            }\n            let selectFrom = null;\n            let selectTo = null;\n            if (brackets) {\n                brackets.sort(Range.compareRangesUsingStarts);\n                const [open, close] = brackets;\n                selectFrom = selectBrackets ? open.getStartPosition() : open.getEndPosition();\n                selectTo = selectBrackets ? close.getEndPosition() : close.getStartPosition();\n                if (close.containsPosition(position)) {\n                    // select backwards if the cursor was on the closing bracket\n                    const tmp = selectFrom;\n                    selectFrom = selectTo;\n                    selectTo = tmp;\n                }\n            }\n            if (selectFrom && selectTo) {\n                newSelections.push(new Selection(selectFrom.lineNumber, selectFrom.column, selectTo.lineNumber, selectTo.column));\n            }\n        });\n        if (newSelections.length > 0) {\n            this._editor.setSelections(newSelections);\n            this._editor.revealRange(newSelections[0]);\n        }\n    }\n    _updateBrackets() {\n        if (this._matchBrackets === 'never') {\n            return;\n        }\n        this._recomputeBrackets();\n        const newDecorations = [];\n        let newDecorationsLen = 0;\n        for (const bracketData of this._lastBracketsData) {\n            const brackets = bracketData.brackets;\n            if (brackets) {\n                newDecorations[newDecorationsLen++] = { range: brackets[0], options: bracketData.options };\n                newDecorations[newDecorationsLen++] = { range: brackets[1], options: bracketData.options };\n            }\n        }\n        this._decorations.set(newDecorations);\n    }\n    _recomputeBrackets() {\n        if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n            // no model or no focus => no brackets!\n            this._lastBracketsData = [];\n            this._lastVersionId = 0;\n            return;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length > 100) {\n            // no bracket matching for high numbers of selections\n            this._lastBracketsData = [];\n            this._lastVersionId = 0;\n            return;\n        }\n        const model = this._editor.getModel();\n        const versionId = model.getVersionId();\n        let previousData = [];\n        if (this._lastVersionId === versionId) {\n            // use the previous data only if the model is at the same version id\n            previousData = this._lastBracketsData;\n        }\n        const positions = [];\n        let positionsLen = 0;\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            if (selection.isEmpty()) {\n                // will bracket match a cursor only if the selection is collapsed\n                positions[positionsLen++] = selection.getStartPosition();\n            }\n        }\n        // sort positions for `previousData` cache hits\n        if (positions.length > 1) {\n            positions.sort(Position.compare);\n        }\n        const newData = [];\n        let newDataLen = 0;\n        let previousIndex = 0;\n        const previousLen = previousData.length;\n        for (let i = 0, len = positions.length; i < len; i++) {\n            const position = positions[i];\n            while (previousIndex < previousLen && previousData[previousIndex].position.isBefore(position)) {\n                previousIndex++;\n            }\n            if (previousIndex < previousLen && previousData[previousIndex].position.equals(position)) {\n                newData[newDataLen++] = previousData[previousIndex];\n            }\n            else {\n                let brackets = model.bracketPairs.matchBracket(position, 20 /* give at most 20ms to compute */);\n                let options = BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;\n                if (!brackets && this._matchBrackets === 'always') {\n                    brackets = model.bracketPairs.findEnclosingBrackets(position, 20 /* give at most 20ms to compute */);\n                    options = BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER;\n                }\n                newData[newDataLen++] = new BracketsData(position, brackets, options);\n            }\n        }\n        this._lastBracketsData = newData;\n        this._lastVersionId = versionId;\n    }\n}\nBracketMatchingController.ID = 'editor.contrib.bracketMatchingController';\nBracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER = ModelDecorationOptions.register({\n    description: 'bracket-match-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'bracket-match',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerBracketMatchForeground),\n        position: OverviewRulerLane.Center\n    }\n});\nBracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER = ModelDecorationOptions.register({\n    description: 'bracket-match-no-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'bracket-match'\n});\nregisterEditorContribution(BracketMatchingController.ID, BracketMatchingController);\nregisterEditorAction(SelectToBracketAction);\nregisterEditorAction(JumpToBracketAction);\nregisterThemingParticipant((theme, collector) => {\n    const bracketMatchBackground = theme.getColor(editorBracketMatchBackground);\n    if (bracketMatchBackground) {\n        collector.addRule(`.monaco-editor .bracket-match { background-color: ${bracketMatchBackground}; }`);\n    }\n    const bracketMatchBorder = theme.getColor(editorBracketMatchBorder);\n    if (bracketMatchBorder) {\n        collector.addRule(`.monaco-editor .bracket-match { border: 1px solid ${bracketMatchBorder}; }`);\n    }\n});\n// Go to menu\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n    group: '5_infile_nav',\n    command: {\n        id: 'editor.action.jumpToBracket',\n        title: nls.localize({ key: 'miGoToBracket', comment: ['&& denotes a mnemonic'] }, \"Go to &&Bracket\")\n    },\n    order: 2\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class MoveCaretCommand {\n    constructor(selection, isMovingLeft) {\n        this._selection = selection;\n        this._isMovingLeft = isMovingLeft;\n    }\n    getEditOperations(model, builder) {\n        if (this._selection.startLineNumber !== this._selection.endLineNumber || this._selection.isEmpty()) {\n            return;\n        }\n        const lineNumber = this._selection.startLineNumber;\n        const startColumn = this._selection.startColumn;\n        const endColumn = this._selection.endColumn;\n        if (this._isMovingLeft && startColumn === 1) {\n            return;\n        }\n        if (!this._isMovingLeft && endColumn === model.getLineMaxColumn(lineNumber)) {\n            return;\n        }\n        if (this._isMovingLeft) {\n            const rangeBefore = new Range(lineNumber, startColumn - 1, lineNumber, startColumn);\n            const charBefore = model.getValueInRange(rangeBefore);\n            builder.addEditOperation(rangeBefore, null);\n            builder.addEditOperation(new Range(lineNumber, endColumn, lineNumber, endColumn), charBefore);\n        }\n        else {\n            const rangeAfter = new Range(lineNumber, endColumn, lineNumber, endColumn + 1);\n            const charAfter = model.getValueInRange(rangeAfter);\n            builder.addEditOperation(rangeAfter, null);\n            builder.addEditOperation(new Range(lineNumber, startColumn, lineNumber, startColumn), charAfter);\n        }\n    }\n    computeCursorState(model, helper) {\n        if (this._isMovingLeft) {\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn - 1, this._selection.endLineNumber, this._selection.endColumn - 1);\n        }\n        else {\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn + 1, this._selection.endLineNumber, this._selection.endColumn + 1);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { MoveCaretCommand } from './moveCaretCommand.js';\nimport * as nls from '../../../../nls.js';\nclass MoveCaretAction extends EditorAction {\n    constructor(left, opts) {\n        super(opts);\n        this.left = left;\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            commands.push(new MoveCaretCommand(selection, this.left));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass MoveCaretLeftAction extends MoveCaretAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.moveCarretLeftAction',\n            label: nls.localize('caret.moveLeft', \"Move Selected Text Left\"),\n            alias: 'Move Selected Text Left',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nclass MoveCaretRightAction extends MoveCaretAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.moveCarretRightAction',\n            label: nls.localize('caret.moveRight', \"Move Selected Text Right\"),\n            alias: 'Move Selected Text Right',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nregisterEditorAction(MoveCaretLeftAction);\nregisterEditorAction(MoveCaretRightAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand } from '../../../common/commands/replaceCommand.js';\nimport { MoveOperations } from '../../../common/cursor/cursorMoveOperations.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nclass TransposeLettersAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.transposeLetters',\n            label: nls.localize('transposeLetters.label', \"Transpose Letters\"),\n            alias: 'Transpose Letters',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: {\n                    primary: 256 /* KeyMod.WinCtrl */ | 50 /* KeyCode.KeyT */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            if (!selection.isEmpty()) {\n                continue;\n            }\n            const lineNumber = selection.startLineNumber;\n            const column = selection.startColumn;\n            const lastColumn = model.getLineMaxColumn(lineNumber);\n            if (lineNumber === 1 && (column === 1 || (column === 2 && lastColumn === 2))) {\n                // at beginning of file, nothing to do\n                continue;\n            }\n            // handle special case: when at end of line, transpose left two chars\n            // otherwise, transpose left and right chars\n            const endPosition = (column === lastColumn) ?\n                selection.getPosition() :\n                MoveOperations.rightPosition(model, selection.getPosition().lineNumber, selection.getPosition().column);\n            const middlePosition = MoveOperations.leftPosition(model, endPosition);\n            const beginPosition = MoveOperations.leftPosition(model, middlePosition);\n            const leftChar = model.getValueInRange(Range.fromPositions(beginPosition, middlePosition));\n            const rightChar = model.getValueInRange(Range.fromPositions(middlePosition, endPosition));\n            const replaceRange = Range.fromPositions(beginPosition, endPosition);\n            commands.push(new ReplaceCommand(replaceRange, rightChar + leftChar));\n        }\n        if (commands.length > 0) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, commands);\n            editor.pushUndoStop();\n        }\n    }\n}\nregisterEditorAction(TransposeLettersAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as browser from '../../../../base/browser/browser.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { CopyOptions, InMemoryClipboardMetadataManager } from '../../../browser/controller/textAreaInput.js';\nimport { EditorAction, MultiCommand, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nconst CLIPBOARD_CONTEXT_MENU_GROUP = '9_cutcopypaste';\nconst supportsCut = (platform.isNative || document.queryCommandSupported('cut'));\nconst supportsCopy = (platform.isNative || document.queryCommandSupported('copy'));\n// Firefox only supports navigator.clipboard.readText() in browser extensions.\n// See https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/readText#Browser_compatibility\n// When loading over http, navigator.clipboard can be undefined. See https://github.com/microsoft/monaco-editor/issues/2313\nconst supportsPaste = (typeof navigator.clipboard === 'undefined' || browser.isFirefox) ? document.queryCommandSupported('paste') : true;\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport const CutAction = supportsCut ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardCutAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind cut keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */, secondary: [1024 /* KeyMod.Shift */ | 20 /* KeyCode.Delete */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miCut', comment: ['&& denotes a mnemonic'] }, \"Cu&&t\"),\n            order: 1\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            when: EditorContextKeys.writable,\n            order: 1,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            when: EditorContextKeys.writable,\n            order: 1,\n        }]\n})) : undefined;\nexport const CopyAction = supportsCopy ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardCopyAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind copy keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */, secondary: [2048 /* KeyMod.CtrlCmd */ | 19 /* KeyCode.Insert */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miCopy', comment: ['&& denotes a mnemonic'] }, \"&&Copy\"),\n            order: 2\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 2,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 2,\n        }]\n})) : undefined;\nMenuRegistry.appendMenuItem(MenuId.MenubarEditMenu, { submenu: MenuId.MenubarCopy, title: { value: nls.localize('copy as', \"Copy As\"), original: 'Copy As', }, group: '2_ccp', order: 3 });\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextCopy, title: { value: nls.localize('copy as', \"Copy As\"), original: 'Copy As', }, group: CLIPBOARD_CONTEXT_MENU_GROUP, order: 3 });\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextShare, title: { value: nls.localize('share', \"Share\"), original: 'Share', }, group: '11_share', order: -1 });\nexport const PasteAction = supportsPaste ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardPasteAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind paste keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */, secondary: [1024 /* KeyMod.Shift */ | 19 /* KeyCode.Insert */] },\n        linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */, secondary: [1024 /* KeyMod.Shift */ | 19 /* KeyCode.Insert */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miPaste', comment: ['&& denotes a mnemonic'] }, \"&&Paste\"),\n            order: 4\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            when: EditorContextKeys.writable,\n            order: 4,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            when: EditorContextKeys.writable,\n            order: 4,\n        }]\n})) : undefined;\nclass ExecCommandCopyWithSyntaxHighlightingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.clipboardCopyWithSyntaxHighlightingAction',\n            label: nls.localize('actions.clipboard.copyWithSyntaxHighlightingLabel', \"Copy With Syntax Highlighting\"),\n            alias: 'Copy With Syntax Highlighting',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const emptySelectionClipboard = editor.getOption(33 /* EditorOption.emptySelectionClipboard */);\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\n            return;\n        }\n        CopyOptions.forceCopyWithSyntaxHighlighting = true;\n        editor.focus();\n        document.execCommand('copy');\n        CopyOptions.forceCopyWithSyntaxHighlighting = false;\n    }\n}\nfunction registerExecCommandImpl(target, browserCommand) {\n    if (!target) {\n        return;\n    }\n    // 1. handle case when focus is in editor.\n    target.addImplementation(10000, 'code-editor', (accessor, args) => {\n        // Only if editor text focus (i.e. not if editor has widget focus).\n        const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\n            // Do not execute if there is no selection and empty selection clipboard is off\n            const emptySelectionClipboard = focusedEditor.getOption(33 /* EditorOption.emptySelectionClipboard */);\n            const selection = focusedEditor.getSelection();\n            if (selection && selection.isEmpty() && !emptySelectionClipboard) {\n                return true;\n            }\n            document.execCommand(browserCommand);\n            return true;\n        }\n        return false;\n    });\n    // 2. (default) handle case when focus is somewhere else.\n    target.addImplementation(0, 'generic-dom', (accessor, args) => {\n        document.execCommand(browserCommand);\n        return true;\n    });\n}\nregisterExecCommandImpl(CutAction, 'cut');\nregisterExecCommandImpl(CopyAction, 'copy');\nif (PasteAction) {\n    // 1. Paste: handle case when focus is in editor.\n    PasteAction.addImplementation(10000, 'code-editor', (accessor, args) => {\n        const codeEditorService = accessor.get(ICodeEditorService);\n        const clipboardService = accessor.get(IClipboardService);\n        // Only if editor text focus (i.e. not if editor has widget focus).\n        const focusedEditor = codeEditorService.getFocusedCodeEditor();\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\n            const result = document.execCommand('paste');\n            // Use the clipboard service if document.execCommand('paste') was not successful\n            if (!result && platform.isWeb) {\n                return (() => __awaiter(void 0, void 0, void 0, function* () {\n                    const clipboardText = yield clipboardService.readText();\n                    if (clipboardText !== '') {\n                        const metadata = InMemoryClipboardMetadataManager.INSTANCE.get(clipboardText);\n                        let pasteOnNewLine = false;\n                        let multicursorText = null;\n                        let mode = null;\n                        if (metadata) {\n                            pasteOnNewLine = (focusedEditor.getOption(33 /* EditorOption.emptySelectionClipboard */) && !!metadata.isFromEmptySelection);\n                            multicursorText = (typeof metadata.multicursorText !== 'undefined' ? metadata.multicursorText : null);\n                            mode = metadata.mode;\n                        }\n                        focusedEditor.trigger('keyboard', \"paste\" /* Handler.Paste */, {\n                            text: clipboardText,\n                            pasteOnNewLine,\n                            multicursorText,\n                            mode\n                        });\n                    }\n                }))();\n            }\n            return true;\n        }\n        return false;\n    });\n    // 2. Paste: (default) handle case when focus is somewhere else.\n    PasteAction.addImplementation(0, 'generic-dom', (accessor, args) => {\n        document.execCommand('paste');\n        return true;\n    });\n}\nif (supportsCopy) {\n    registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class CodeActionKind {\n    constructor(value) {\n        this.value = value;\n    }\n    equals(other) {\n        return this.value === other.value;\n    }\n    contains(other) {\n        return this.equals(other) || this.value === '' || other.value.startsWith(this.value + CodeActionKind.sep);\n    }\n    intersects(other) {\n        return this.contains(other) || other.contains(this);\n    }\n    append(part) {\n        return new CodeActionKind(this.value + CodeActionKind.sep + part);\n    }\n}\nCodeActionKind.sep = '.';\nCodeActionKind.None = new CodeActionKind('@@none@@'); // Special code action that contains nothing\nCodeActionKind.Empty = new CodeActionKind('');\nCodeActionKind.QuickFix = new CodeActionKind('quickfix');\nCodeActionKind.Refactor = new CodeActionKind('refactor');\nCodeActionKind.Source = new CodeActionKind('source');\nCodeActionKind.SourceOrganizeImports = CodeActionKind.Source.append('organizeImports');\nCodeActionKind.SourceFixAll = CodeActionKind.Source.append('fixAll');\nexport var CodeActionTriggerSource;\n(function (CodeActionTriggerSource) {\n    CodeActionTriggerSource[\"Refactor\"] = \"refactor\";\n    CodeActionTriggerSource[\"RefactorPreview\"] = \"refactor preview\";\n    CodeActionTriggerSource[\"Lightbulb\"] = \"lightbulb\";\n    CodeActionTriggerSource[\"Default\"] = \"other (default)\";\n    CodeActionTriggerSource[\"SourceAction\"] = \"source action\";\n    CodeActionTriggerSource[\"QuickFix\"] = \"quick fix action\";\n    CodeActionTriggerSource[\"FixAll\"] = \"fix all\";\n    CodeActionTriggerSource[\"OrganizeImports\"] = \"organize imports\";\n    CodeActionTriggerSource[\"AutoFix\"] = \"auto fix\";\n    CodeActionTriggerSource[\"QuickFixHover\"] = \"quick fix hover window\";\n    CodeActionTriggerSource[\"OnSave\"] = \"save participants\";\n    CodeActionTriggerSource[\"ProblemsView\"] = \"problems view\";\n})(CodeActionTriggerSource || (CodeActionTriggerSource = {}));\nexport function mayIncludeActionsOfKind(filter, providedKind) {\n    // A provided kind may be a subset or superset of our filtered kind.\n    if (filter.include && !filter.include.intersects(providedKind)) {\n        return false;\n    }\n    if (filter.excludes) {\n        if (filter.excludes.some(exclude => excludesAction(providedKind, exclude, filter.include))) {\n            return false;\n        }\n    }\n    // Don't return source actions unless they are explicitly requested\n    if (!filter.includeSourceActions && CodeActionKind.Source.contains(providedKind)) {\n        return false;\n    }\n    return true;\n}\nexport function filtersAction(filter, action) {\n    const actionKind = action.kind ? new CodeActionKind(action.kind) : undefined;\n    // Filter out actions by kind\n    if (filter.include) {\n        if (!actionKind || !filter.include.contains(actionKind)) {\n            return false;\n        }\n    }\n    if (filter.excludes) {\n        if (actionKind && filter.excludes.some(exclude => excludesAction(actionKind, exclude, filter.include))) {\n            return false;\n        }\n    }\n    // Don't return source actions unless they are explicitly requested\n    if (!filter.includeSourceActions) {\n        if (actionKind && CodeActionKind.Source.contains(actionKind)) {\n            return false;\n        }\n    }\n    if (filter.onlyIncludePreferredActions) {\n        if (!action.isPreferred) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction excludesAction(providedKind, exclude, include) {\n    if (!exclude.contains(providedKind)) {\n        return false;\n    }\n    if (include && exclude.contains(include)) {\n        // The include is more specific, don't filter out\n        return false;\n    }\n    return true;\n}\nexport class CodeActionCommandArgs {\n    constructor(kind, apply, preferred) {\n        this.kind = kind;\n        this.apply = apply;\n        this.preferred = preferred;\n    }\n    static fromUser(arg, defaults) {\n        if (!arg || typeof arg !== 'object') {\n            return new CodeActionCommandArgs(defaults.kind, defaults.apply, false);\n        }\n        return new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg, defaults.kind), CodeActionCommandArgs.getApplyFromUser(arg, defaults.apply), CodeActionCommandArgs.getPreferredUser(arg));\n    }\n    static getApplyFromUser(arg, defaultAutoApply) {\n        switch (typeof arg.apply === 'string' ? arg.apply.toLowerCase() : '') {\n            case 'first': return \"first\" /* CodeActionAutoApply.First */;\n            case 'never': return \"never\" /* CodeActionAutoApply.Never */;\n            case 'ifsingle': return \"ifSingle\" /* CodeActionAutoApply.IfSingle */;\n            default: return defaultAutoApply;\n        }\n    }\n    static getKindFromUser(arg, defaultKind) {\n        return typeof arg.kind === 'string'\n            ? new CodeActionKind(arg.kind)\n            : defaultKind;\n    }\n    static getPreferredUser(arg) {\n        return typeof arg.preferred === 'boolean'\n            ? arg.preferred\n            : false;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { coalesce, equals, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { CodeActionKind, CodeActionTriggerSource, filtersAction, mayIncludeActionsOfKind } from './types.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport const codeActionCommandId = 'editor.action.codeAction';\nexport const refactorCommandId = 'editor.action.refactor';\nexport const refactorPreviewCommandId = 'editor.action.refactor.preview';\nexport const sourceActionCommandId = 'editor.action.sourceAction';\nexport const organizeImportsCommandId = 'editor.action.organizeImports';\nexport const fixAllCommandId = 'editor.action.fixAll';\nexport class CodeActionItem {\n    constructor(action, provider) {\n        this.action = action;\n        this.provider = provider;\n    }\n    resolve(token) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (((_a = this.provider) === null || _a === void 0 ? void 0 : _a.resolveCodeAction) && !this.action.edit) {\n                let action;\n                try {\n                    action = yield this.provider.resolveCodeAction(this.action, token);\n                }\n                catch (err) {\n                    onUnexpectedExternalError(err);\n                }\n                if (action) {\n                    this.action.edit = action.edit;\n                }\n            }\n            return this;\n        });\n    }\n}\nclass ManagedCodeActionSet extends Disposable {\n    constructor(actions, documentation, disposables) {\n        super();\n        this.documentation = documentation;\n        this._register(disposables);\n        this.allActions = [...actions].sort(ManagedCodeActionSet.codeActionsComparator);\n        this.validActions = this.allActions.filter(({ action }) => !action.disabled);\n    }\n    static codeActionsComparator({ action: a }, { action: b }) {\n        if (a.isPreferred && !b.isPreferred) {\n            return -1;\n        }\n        else if (!a.isPreferred && b.isPreferred) {\n            return 1;\n        }\n        if (isNonEmptyArray(a.diagnostics)) {\n            if (isNonEmptyArray(b.diagnostics)) {\n                return a.diagnostics[0].message.localeCompare(b.diagnostics[0].message);\n            }\n            else {\n                return -1;\n            }\n        }\n        else if (isNonEmptyArray(b.diagnostics)) {\n            return 1;\n        }\n        else {\n            return 0; // both have no diagnostics\n        }\n    }\n    get hasAutoFix() {\n        return this.validActions.some(({ action: fix }) => !!fix.kind && CodeActionKind.QuickFix.contains(new CodeActionKind(fix.kind)) && !!fix.isPreferred);\n    }\n}\nconst emptyCodeActionsResponse = { actions: [], documentation: undefined };\nexport function getCodeActions(registry, model, rangeOrSelection, trigger, progress, token) {\n    var _a;\n    const filter = trigger.filter || {};\n    const codeActionContext = {\n        only: (_a = filter.include) === null || _a === void 0 ? void 0 : _a.value,\n        trigger: trigger.type,\n    };\n    const cts = new TextModelCancellationTokenSource(model, token);\n    const providers = getCodeActionProviders(registry, model, filter);\n    const disposables = new DisposableStore();\n    const promises = providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\n        try {\n            progress.report(provider);\n            const providedCodeActions = yield provider.provideCodeActions(model, rangeOrSelection, codeActionContext, cts.token);\n            if (providedCodeActions) {\n                disposables.add(providedCodeActions);\n            }\n            if (cts.token.isCancellationRequested) {\n                return emptyCodeActionsResponse;\n            }\n            const filteredActions = ((providedCodeActions === null || providedCodeActions === void 0 ? void 0 : providedCodeActions.actions) || []).filter(action => action && filtersAction(filter, action));\n            const documentation = getDocumentation(provider, filteredActions, filter.include);\n            return {\n                actions: filteredActions.map(action => new CodeActionItem(action, provider)),\n                documentation\n            };\n        }\n        catch (err) {\n            if (isCancellationError(err)) {\n                throw err;\n            }\n            onUnexpectedExternalError(err);\n            return emptyCodeActionsResponse;\n        }\n    }));\n    const listener = registry.onDidChange(() => {\n        const newProviders = registry.all(model);\n        if (!equals(newProviders, providers)) {\n            cts.cancel();\n        }\n    });\n    return Promise.all(promises).then(actions => {\n        const allActions = actions.map(x => x.actions).flat();\n        const allDocumentation = coalesce(actions.map(x => x.documentation));\n        return new ManagedCodeActionSet(allActions, allDocumentation, disposables);\n    })\n        .finally(() => {\n        listener.dispose();\n        cts.dispose();\n    });\n}\nfunction getCodeActionProviders(registry, model, filter) {\n    return registry.all(model)\n        // Don't include providers that we know will not return code actions of interest\n        .filter(provider => {\n        if (!provider.providedCodeActionKinds) {\n            // We don't know what type of actions this provider will return.\n            return true;\n        }\n        return provider.providedCodeActionKinds.some(kind => mayIncludeActionsOfKind(filter, new CodeActionKind(kind)));\n    });\n}\nfunction getDocumentation(provider, providedCodeActions, only) {\n    if (!provider.documentation) {\n        return undefined;\n    }\n    const documentation = provider.documentation.map(entry => ({ kind: new CodeActionKind(entry.kind), command: entry.command }));\n    if (only) {\n        let currentBest;\n        for (const entry of documentation) {\n            if (entry.kind.contains(only)) {\n                if (!currentBest) {\n                    currentBest = entry;\n                }\n                else {\n                    // Take best match\n                    if (currentBest.kind.contains(entry.kind)) {\n                        currentBest = entry;\n                    }\n                }\n            }\n        }\n        if (currentBest) {\n            return currentBest === null || currentBest === void 0 ? void 0 : currentBest.command;\n        }\n    }\n    // Otherwise, check to see if any of the provided actions match.\n    for (const action of providedCodeActions) {\n        if (!action.kind) {\n            continue;\n        }\n        for (const entry of documentation) {\n            if (entry.kind.contains(new CodeActionKind(action.kind))) {\n                return entry.command;\n            }\n        }\n    }\n    return undefined;\n}\nCommandsRegistry.registerCommand('_executeCodeActionProvider', function (accessor, resource, rangeOrSelection, kind, itemResolveCount) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!(resource instanceof URI)) {\n            throw illegalArgument();\n        }\n        const { codeActionProvider } = accessor.get(ILanguageFeaturesService);\n        const model = accessor.get(IModelService).getModel(resource);\n        if (!model) {\n            throw illegalArgument();\n        }\n        const validatedRangeOrSelection = Selection.isISelection(rangeOrSelection)\n            ? Selection.liftSelection(rangeOrSelection)\n            : Range.isIRange(rangeOrSelection)\n                ? model.validateRange(rangeOrSelection)\n                : undefined;\n        if (!validatedRangeOrSelection) {\n            throw illegalArgument();\n        }\n        const include = typeof kind === 'string' ? new CodeActionKind(kind) : undefined;\n        const codeActionSet = yield getCodeActions(codeActionProvider, model, validatedRangeOrSelection, { type: 1 /* languages.CodeActionTriggerType.Invoke */, triggerAction: CodeActionTriggerSource.Default, filter: { includeSourceActions: true, include } }, Progress.None, CancellationToken.None);\n        const resolving = [];\n        const resolveCount = Math.min(codeActionSet.validActions.length, typeof itemResolveCount === 'number' ? itemResolveCount : 0);\n        for (let i = 0; i < resolveCount; i++) {\n            resolving.push(codeActionSet.validActions[i].resolve(CancellationToken.None));\n        }\n        try {\n            yield Promise.all(resolving);\n            return codeActionSet.validActions.map(item => item.action);\n        }\n        finally {\n            setTimeout(() => codeActionSet.dispose(), 100);\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport './messageController.css';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet MessageController = class MessageController {\n    constructor(editor, contextKeyService) {\n        this._messageWidget = new MutableDisposable();\n        this._messageListeners = new DisposableStore();\n        this._editor = editor;\n        this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(MessageController.ID);\n    }\n    dispose() {\n        this._messageListeners.dispose();\n        this._messageWidget.dispose();\n        this._visible.reset();\n    }\n    showMessage(message, position) {\n        alert(message);\n        this._visible.set(true);\n        this._messageWidget.clear();\n        this._messageListeners.clear();\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\n        // close on blur, cursor, model change, dispose\n        this._messageListeners.add(this._editor.onDidBlurEditorText(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidDispose(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidChangeModel(() => this.closeMessage()));\n        // 3sec\n        this._messageListeners.add(new TimeoutTimer(() => this.closeMessage(), 3000));\n        // close on mouse move\n        let bounds;\n        this._messageListeners.add(this._editor.onMouseMove(e => {\n            // outside the text area\n            if (!e.target.position) {\n                return;\n            }\n            if (!bounds) {\n                // define bounding box around position and first mouse occurance\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\n            }\n            else if (!bounds.containsPosition(e.target.position)) {\n                // check if position is still in bounds\n                this.closeMessage();\n            }\n        }));\n    }\n    closeMessage() {\n        this._visible.reset();\n        this._messageListeners.clear();\n        if (this._messageWidget.value) {\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\n        }\n    }\n};\nMessageController.ID = 'editor.contrib.messageController';\nMessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false, nls.localize('messageVisible', 'Whether the editor is currently showing an inline message'));\nMessageController = __decorate([\n    __param(1, IContextKeyService)\n], MessageController);\nexport { MessageController };\nconst MessageCommand = EditorCommand.bindToContribution(MessageController.get);\nregisterEditorCommand(new MessageCommand({\n    id: 'leaveEditorMessage',\n    precondition: MessageController.MESSAGE_VISIBLE,\n    handler: c => c.closeMessage(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        primary: 9 /* KeyCode.Escape */\n    }\n}));\nclass MessageWidget {\n    constructor(editor, { lineNumber, column }, text) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._editor = editor;\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* ScrollType.Smooth */);\n        this._position = { lineNumber, column };\n        this._domNode = document.createElement('div');\n        this._domNode.classList.add('monaco-editor-overlaymessage');\n        this._domNode.style.marginLeft = '-6px';\n        const anchorTop = document.createElement('div');\n        anchorTop.classList.add('anchor', 'top');\n        this._domNode.appendChild(anchorTop);\n        const message = document.createElement('div');\n        message.classList.add('message');\n        message.textContent = text;\n        this._domNode.appendChild(message);\n        const anchorBottom = document.createElement('div');\n        anchorBottom.classList.add('anchor', 'below');\n        this._domNode.appendChild(anchorBottom);\n        this._editor.addContentWidget(this);\n        this._domNode.classList.add('fadeIn');\n    }\n    static fadeOut(messageWidget) {\n        const dispose = () => {\n            messageWidget.dispose();\n            clearTimeout(handle);\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\n        };\n        const handle = setTimeout(dispose, 110);\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\n        messageWidget.getDomNode().classList.add('fadeOut');\n        return { dispose };\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return 'messageoverlay';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            position: this._position,\n            preference: [\n                1 /* ContentWidgetPositionPreference.ABOVE */,\n                2 /* ContentWidgetPositionPreference.BELOW */,\n            ],\n            positionAffinity: 1 /* PositionAffinity.Right */,\n        };\n    }\n    afterRender(position) {\n        this._domNode.classList.toggle('below', position === 2 /* ContentWidgetPositionPreference.BELOW */);\n    }\n}\nregisterEditorContribution(MessageController.ID, MessageController);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { Action, Separator } from '../../../../base/common/actions.js';\nimport { canceled } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, dispose, MutableDisposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './media/action.css';\nimport { Position } from '../../../common/core/position.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { codeActionCommandId, CodeActionItem, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\nimport { CodeActionCommandArgs, CodeActionKind, CodeActionTriggerSource } from './types.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService, IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport const Context = {\n    Visible: new RawContextKey('CodeActionMenuVisible', false, localize('CodeActionMenuVisible', \"Whether the code action list widget is visible\"))\n};\nclass CodeActionAction extends Action {\n    constructor(action, callback) {\n        super(action.command ? action.command.id : action.title, stripNewlines(action.title), undefined, !action.disabled, callback);\n        this.action = action;\n    }\n}\nfunction stripNewlines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, ' ');\n}\nconst TEMPLATE_ID = 'codeActionWidget';\nconst codeActionLineHeight = 26;\nlet CodeMenuRenderer = class CodeMenuRenderer {\n    constructor(acceptKeybindings, keybindingService) {\n        this.acceptKeybindings = acceptKeybindings;\n        this.keybindingService = keybindingService;\n    }\n    get templateId() { return TEMPLATE_ID; }\n    renderTemplate(container) {\n        const data = Object.create(null);\n        data.disposables = [];\n        data.root = container;\n        data.text = document.createElement('span');\n        // data.detail = document.createElement('');\n        container.append(data.text);\n        // container.append(data.detail);\n        return data;\n    }\n    renderElement(element, index, templateData) {\n        const data = templateData;\n        const text = element.title;\n        // const detail = element.detail;\n        const isEnabled = element.isEnabled;\n        const isSeparator = element.isSeparator;\n        const isDocumentation = element.isDocumentation;\n        data.text.textContent = text;\n        // data.detail.textContent = detail;\n        if (!isEnabled) {\n            data.root.classList.add('option-disabled');\n            data.root.style.backgroundColor = 'transparent !important';\n        }\n        else {\n            data.root.classList.remove('option-disabled');\n        }\n        if (isSeparator) {\n            data.root.classList.add('separator');\n            data.root.style.height = '10px';\n        }\n        if (!isDocumentation) {\n            const updateLabel = () => {\n                var _a, _b;\n                const [accept, preview] = this.acceptKeybindings;\n                data.root.title = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Refactor, Shift+F2 to Preview\"'] }, \"{0} to Refactor, {1} to Preview\", (_a = this.keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this.keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n                // data.root.title = this.keybindingService.lookupKeybinding(accept)?.getLabel() + ' to Refactor, ' + this.keybindingService.lookupKeybinding(preview)?.getLabel() + ' to Preview';\n            };\n            updateLabel();\n        }\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables = dispose(templateData.disposables);\n    }\n};\nCodeMenuRenderer = __decorate([\n    __param(1, IKeybindingService)\n], CodeMenuRenderer);\nlet CodeActionMenu = class CodeActionMenu extends Disposable {\n    constructor(_editor, _delegate, _contextMenuService, keybindingService, _languageFeaturesService, _telemetryService, _themeService, _configurationService, _contextViewService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._delegate = _delegate;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._telemetryService = _telemetryService;\n        this._configurationService = _configurationService;\n        this._contextViewService = _contextViewService;\n        this._contextKeyService = _contextKeyService;\n        this._showingActions = this._register(new MutableDisposable());\n        this.codeActionList = this._register(new MutableDisposable());\n        this.options = [];\n        this._visible = false;\n        this.viewItems = [];\n        this.hasSeperator = false;\n        this._keybindingResolver = new CodeActionKeybindingResolver({\n            getKeybindings: () => keybindingService.getKeybindings()\n        });\n        this._ctxMenuWidgetVisible = Context.Visible.bindTo(this._contextKeyService);\n        this.listRenderer = new CodeMenuRenderer([`onEnterSelectCodeAction`, `onEnterSelectCodeActionWithPreview`], keybindingService);\n    }\n    get isVisible() {\n        return this._visible;\n    }\n    isCodeActionWidgetEnabled(model) {\n        return this._configurationService.getValue('editor.experimental.useCustomCodeActionMenu', {\n            resource: model.uri\n        });\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            e.elements.forEach(element => {\n                if (element.isEnabled) {\n                    element.action.run();\n                    this.hideCodeActionWidget();\n                }\n            });\n        }\n    }\n    _onListHover(e) {\n        var _a, _b, _c, _d;\n        if (!e.element) {\n            this.currSelectedItem = undefined;\n            (_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.setFocus([]);\n        }\n        else {\n            if ((_b = e.element) === null || _b === void 0 ? void 0 : _b.isEnabled) {\n                (_c = this.codeActionList.value) === null || _c === void 0 ? void 0 : _c.setFocus([e.element.index]);\n                this.focusedEnabledItem = this.viewItems.indexOf(e.element);\n                this.currSelectedItem = e.element.index;\n            }\n            else {\n                this.currSelectedItem = undefined;\n                (_d = this.codeActionList.value) === null || _d === void 0 ? void 0 : _d.setFocus([e.element.index]);\n            }\n        }\n    }\n    renderCodeActionMenuList(element, inputArray) {\n        var _a;\n        const renderDisposables = new DisposableStore();\n        const renderMenu = document.createElement('div');\n        // Render invisible div to block mouse interaction in the rest of the UI\n        const menuBlock = document.createElement('div');\n        this.block = element.appendChild(menuBlock);\n        this.block.classList.add('context-view-block');\n        this.block.style.position = 'fixed';\n        this.block.style.cursor = 'initial';\n        this.block.style.left = '0';\n        this.block.style.top = '0';\n        this.block.style.width = '100%';\n        this.block.style.height = '100%';\n        this.block.style.zIndex = '-1';\n        renderDisposables.add(dom.addDisposableListener(this.block, dom.EventType.MOUSE_DOWN, e => e.stopPropagation()));\n        renderMenu.id = 'codeActionMenuWidget';\n        renderMenu.classList.add('codeActionMenuWidget');\n        element.appendChild(renderMenu);\n        this.codeActionList.value = new List('codeActionWidget', renderMenu, {\n            getHeight(element) {\n                if (element.isSeparator) {\n                    return 10;\n                }\n                return codeActionLineHeight;\n            },\n            getTemplateId(element) {\n                return 'codeActionWidget';\n            }\n        }, [this.listRenderer], { keyboardSupport: false });\n        renderDisposables.add(this.codeActionList.value.onMouseOver(e => this._onListHover(e)));\n        renderDisposables.add(this.codeActionList.value.onDidChangeFocus(e => { var _a; return (_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.domFocus(); }));\n        renderDisposables.add(this.codeActionList.value.onDidChangeSelection(e => this._onListSelection(e)));\n        renderDisposables.add(this._editor.onDidLayoutChange(e => this.hideCodeActionWidget()));\n        // Populating the list widget and tracking enabled options.\n        inputArray.forEach((item, index) => {\n            const currIsSeparator = item.class === 'separator';\n            let isDocumentation = false;\n            if (item instanceof CodeActionAction) {\n                isDocumentation = item.action.kind === CodeActionMenu.documentationID;\n            }\n            if (currIsSeparator) {\n                // set to true forever\n                this.hasSeperator = true;\n            }\n            const menuItem = { title: item.label, detail: item.tooltip, action: inputArray[index], isEnabled: item.enabled, isSeparator: currIsSeparator, index, isDocumentation };\n            if (item.enabled) {\n                this.viewItems.push(menuItem);\n            }\n            this.options.push(menuItem);\n        });\n        this.codeActionList.value.splice(0, this.codeActionList.value.length, this.options);\n        const height = this.hasSeperator ? (inputArray.length - 1) * codeActionLineHeight + 10 : inputArray.length * codeActionLineHeight;\n        renderMenu.style.height = String(height) + 'px';\n        this.codeActionList.value.layout(height);\n        // For finding width dynamically (not using resize observer)\n        const arr = [];\n        this.options.forEach((item, index) => {\n            var _a, _b;\n            if (!this.codeActionList.value) {\n                return;\n            }\n            const element = (_b = document.getElementById((_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.getElementID(index))) === null || _b === void 0 ? void 0 : _b.getElementsByTagName('span')[0].offsetWidth;\n            arr.push(Number(element));\n        });\n        // resize observer - can be used in the future since list widget supports dynamic height but not width\n        const maxWidth = Math.max(...arr);\n        // 40 is the additional padding for the list widget (20 left, 20 right)\n        renderMenu.style.width = maxWidth + 52 + 'px';\n        (_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.layout(height, maxWidth);\n        // List selection\n        if (this.viewItems.length < 1 || this.viewItems.every(item => item.isDocumentation)) {\n            this.currSelectedItem = undefined;\n        }\n        else {\n            this.focusedEnabledItem = 0;\n            this.currSelectedItem = this.viewItems[0].index;\n            this.codeActionList.value.setFocus([this.currSelectedItem]);\n        }\n        // List Focus\n        this.codeActionList.value.domFocus();\n        const focusTracker = dom.trackFocus(element);\n        const blurListener = focusTracker.onDidBlur(() => {\n            this.hideCodeActionWidget();\n            // this._contextViewService.hideContextView({ source: this });\n        });\n        renderDisposables.add(blurListener);\n        renderDisposables.add(focusTracker);\n        this._ctxMenuWidgetVisible.set(true);\n        return renderDisposables;\n    }\n    focusPrevious() {\n        var _a;\n        if (typeof this.focusedEnabledItem === 'undefined') {\n            this.focusedEnabledItem = this.viewItems[0].index;\n        }\n        else if (this.viewItems.length < 1) {\n            return false;\n        }\n        const startIndex = this.focusedEnabledItem;\n        let item;\n        do {\n            this.focusedEnabledItem = this.focusedEnabledItem - 1;\n            if (this.focusedEnabledItem < 0) {\n                this.focusedEnabledItem = this.viewItems.length - 1;\n            }\n            item = this.viewItems[this.focusedEnabledItem];\n            (_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.setFocus([item.index]);\n            this.currSelectedItem = item.index;\n        } while (this.focusedEnabledItem !== startIndex && ((!item.isEnabled) || item.action.id === Separator.ID));\n        return true;\n    }\n    focusNext() {\n        var _a;\n        if (typeof this.focusedEnabledItem === 'undefined') {\n            this.focusedEnabledItem = this.viewItems.length - 1;\n        }\n        else if (this.viewItems.length < 1) {\n            return false;\n        }\n        const startIndex = this.focusedEnabledItem;\n        let item;\n        do {\n            this.focusedEnabledItem = (this.focusedEnabledItem + 1) % this.viewItems.length;\n            item = this.viewItems[this.focusedEnabledItem];\n            (_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.setFocus([item.index]);\n            this.currSelectedItem = item.index;\n        } while (this.focusedEnabledItem !== startIndex && ((!item.isEnabled) || item.action.id === Separator.ID));\n        return true;\n    }\n    navigateListWithKeysUp() {\n        this.focusPrevious();\n    }\n    navigateListWithKeysDown() {\n        this.focusNext();\n    }\n    onEnterSet() {\n        var _a;\n        if (typeof this.currSelectedItem === 'number') {\n            (_a = this.codeActionList.value) === null || _a === void 0 ? void 0 : _a.setSelection([this.currSelectedItem]);\n        }\n    }\n    dispose() {\n        super.dispose();\n    }\n    hideCodeActionWidget() {\n        this._ctxMenuWidgetVisible.reset();\n        this.options = [];\n        this.viewItems = [];\n        this.focusedEnabledItem = 0;\n        this.currSelectedItem = undefined;\n        this.hasSeperator = false;\n        this._contextViewService.hideContextView({ source: this });\n    }\n    codeActionTelemetry(openedFromString, didCancel, CodeActions) {\n        this._telemetryService.publicLog2('codeAction.applyCodeAction', {\n            codeActionFrom: openedFromString,\n            validCodeActions: CodeActions.validActions.length,\n            cancelled: didCancel,\n        });\n    }\n    show(trigger, codeActions, at, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._editor.getModel();\n            if (!model) {\n                return;\n            }\n            const actionsToShow = options.includeDisabledActions ? codeActions.allActions : codeActions.validActions;\n            if (!actionsToShow.length) {\n                this._visible = false;\n                return;\n            }\n            if (!this._editor.getDomNode()) {\n                // cancel when editor went off-dom\n                this._visible = false;\n                throw canceled();\n            }\n            this._visible = true;\n            this._showingActions.value = codeActions;\n            const menuActions = this.getMenuActions(trigger, actionsToShow, codeActions.documentation);\n            const anchor = Position.isIPosition(at) ? this._toCoords(at) : at || { x: 0, y: 0 };\n            const resolver = this._keybindingResolver.getResolver();\n            const useShadowDOM = this._editor.getOption(117 /* EditorOption.useShadowDOM */);\n            if (this.isCodeActionWidgetEnabled(model)) {\n                this._contextViewService.showContextView({\n                    getAnchor: () => anchor,\n                    render: (container) => this.renderCodeActionMenuList(container, menuActions),\n                    onHide: (didCancel) => {\n                        const openedFromString = (options.fromLightbulb) ? CodeActionTriggerSource.Lightbulb : trigger.triggerAction;\n                        this.codeActionTelemetry(openedFromString, didCancel, codeActions);\n                        this._visible = false;\n                        this._editor.focus();\n                    },\n                }, this._editor.getDomNode(), false);\n            }\n            else {\n                this._contextMenuService.showContextMenu({\n                    domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\n                    getAnchor: () => anchor,\n                    getActions: () => menuActions,\n                    onHide: (didCancel) => {\n                        const openedFromString = (options.fromLightbulb) ? CodeActionTriggerSource.Lightbulb : trigger.triggerAction;\n                        this.codeActionTelemetry(openedFromString, didCancel, codeActions);\n                        this._visible = false;\n                        this._editor.focus();\n                    },\n                    autoSelectFirstItem: true,\n                    getKeyBinding: action => action instanceof CodeActionAction ? resolver(action.action) : undefined,\n                });\n            }\n        });\n    }\n    getMenuActions(trigger, actionsToShow, documentation) {\n        var _a, _b;\n        const toCodeActionAction = (item) => new CodeActionAction(item.action, () => this._delegate.onSelectCodeAction(item, trigger));\n        const result = actionsToShow\n            .map(toCodeActionAction);\n        const allDocumentation = [...documentation];\n        const model = this._editor.getModel();\n        if (model && result.length) {\n            for (const provider of this._languageFeaturesService.codeActionProvider.all(model)) {\n                if (provider._getAdditionalMenuItems) {\n                    allDocumentation.push(...provider._getAdditionalMenuItems({ trigger: trigger.type, only: (_b = (_a = trigger.filter) === null || _a === void 0 ? void 0 : _a.include) === null || _b === void 0 ? void 0 : _b.value }, actionsToShow.map(item => item.action)));\n                }\n            }\n        }\n        if (allDocumentation.length) {\n            result.push(new Separator(), ...allDocumentation.map(command => toCodeActionAction(new CodeActionItem({\n                title: command.title,\n                command: command,\n                kind: CodeActionMenu.documentationID\n            }, undefined))));\n        }\n        return result;\n    }\n    _toCoords(position) {\n        if (!this._editor.hasModel()) {\n            return { x: 0, y: 0 };\n        }\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n        this._editor.render();\n        // Translate to absolute editor position\n        const cursorCoords = this._editor.getScrolledVisiblePosition(position);\n        const editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\n        const x = editorCoords.left + cursorCoords.left;\n        const y = editorCoords.top + cursorCoords.top + cursorCoords.height;\n        return { x, y };\n    }\n};\nCodeActionMenu.documentationID = '_documentation';\nCodeActionMenu = __decorate([\n    __param(2, IContextMenuService),\n    __param(3, IKeybindingService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, ITelemetryService),\n    __param(6, IThemeService),\n    __param(7, IConfigurationService),\n    __param(8, IContextViewService),\n    __param(9, IContextKeyService)\n], CodeActionMenu);\nexport { CodeActionMenu };\nexport class CodeActionKeybindingResolver {\n    constructor(_keybindingProvider) {\n        this._keybindingProvider = _keybindingProvider;\n    }\n    getResolver() {\n        // Lazy since we may not actually ever read the value\n        const allCodeActionBindings = new Lazy(() => this._keybindingProvider.getKeybindings()\n            .filter(item => CodeActionKeybindingResolver.codeActionCommands.indexOf(item.command) >= 0)\n            .filter(item => item.resolvedKeybinding)\n            .map((item) => {\n            // Special case these commands since they come built-in with VS Code and don't use 'commandArgs'\n            let commandArgs = item.commandArgs;\n            if (item.command === organizeImportsCommandId) {\n                commandArgs = { kind: CodeActionKind.SourceOrganizeImports.value };\n            }\n            else if (item.command === fixAllCommandId) {\n                commandArgs = { kind: CodeActionKind.SourceFixAll.value };\n            }\n            return Object.assign({ resolvedKeybinding: item.resolvedKeybinding }, CodeActionCommandArgs.fromUser(commandArgs, {\n                kind: CodeActionKind.None,\n                apply: \"never\" /* CodeActionAutoApply.Never */\n            }));\n        }));\n        return (action) => {\n            if (action.kind) {\n                const binding = this.bestKeybindingForCodeAction(action, allCodeActionBindings.getValue());\n                return binding === null || binding === void 0 ? void 0 : binding.resolvedKeybinding;\n            }\n            return undefined;\n        };\n    }\n    bestKeybindingForCodeAction(action, candidates) {\n        if (!action.kind) {\n            return undefined;\n        }\n        const kind = new CodeActionKind(action.kind);\n        return candidates\n            .filter(candidate => candidate.kind.contains(kind))\n            .filter(candidate => {\n            if (candidate.preferred) {\n                // If the candidate keybinding only applies to preferred actions, the this action must also be preferred\n                return action.isPreferred;\n            }\n            return true;\n        })\n            .reduceRight((currentBest, candidate) => {\n            if (!currentBest) {\n                return candidate;\n            }\n            // Select the more specific binding\n            return currentBest.kind.contains(candidate.kind) ? candidate : currentBest;\n        }, undefined);\n    }\n}\nCodeActionKeybindingResolver.codeActionCommands = [\n    refactorCommandId,\n    codeActionCommandId,\n    sourceActionCommandId,\n    organizeImportsCommandId,\n    fixAllCommandId\n];\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Gesture } from '../../../../base/browser/touch.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport './lightBulbWidget.css';\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport * as nls from '../../../../nls.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { editorBackground, editorLightBulbAutoFixForeground, editorLightBulbForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nvar LightBulbState;\n(function (LightBulbState) {\n    LightBulbState.Hidden = { type: 0 /* Type.Hidden */ };\n    class Showing {\n        constructor(actions, trigger, editorPosition, widgetPosition) {\n            this.actions = actions;\n            this.trigger = trigger;\n            this.editorPosition = editorPosition;\n            this.widgetPosition = widgetPosition;\n            this.type = 1 /* Type.Showing */;\n        }\n    }\n    LightBulbState.Showing = Showing;\n})(LightBulbState || (LightBulbState = {}));\nlet LightBulbWidget = class LightBulbWidget extends Disposable {\n    constructor(_editor, _quickFixActionId, _preferredFixActionId, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._quickFixActionId = _quickFixActionId;\n        this._preferredFixActionId = _preferredFixActionId;\n        this._keybindingService = _keybindingService;\n        this._onClick = this._register(new Emitter());\n        this.onClick = this._onClick.event;\n        this._state = LightBulbState.Hidden;\n        this._domNode = document.createElement('div');\n        this._domNode.className = Codicon.lightBulb.classNames;\n        this._editor.addContentWidget(this);\n        this._register(this._editor.onDidChangeModelContent(_ => {\n            // cancel when the line in question has been removed\n            const editorModel = this._editor.getModel();\n            if (this.state.type !== 1 /* LightBulbState.Type.Showing */ || !editorModel || this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\n                this.hide();\n            }\n        }));\n        Gesture.ignoreTarget(this._domNode);\n        this._register(dom.addStandardDisposableGenericMouseDownListener(this._domNode, e => {\n            if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n                return;\n            }\n            // Make sure that focus / cursor location is not lost when clicking widget icon\n            this._editor.focus();\n            e.preventDefault();\n            // a bit of extra work to make sure the menu\n            // doesn't cover the line-text\n            const { top, height } = dom.getDomNodePagePosition(this._domNode);\n            const lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */);\n            let pad = Math.floor(lineHeight / 3);\n            if (this.state.widgetPosition.position !== null && this.state.widgetPosition.position.lineNumber < this.state.editorPosition.lineNumber) {\n                pad += lineHeight;\n            }\n            this._onClick.fire({\n                x: e.posx,\n                y: top + height + pad,\n                actions: this.state.actions,\n                trigger: this.state.trigger,\n            });\n        }));\n        this._register(dom.addDisposableListener(this._domNode, 'mouseenter', (e) => {\n            if ((e.buttons & 1) !== 1) {\n                return;\n            }\n            // mouse enters lightbulb while the primary/left button\n            // is being pressed -> hide the lightbulb\n            this.hide();\n        }));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            // hide when told to do so\n            if (e.hasChanged(59 /* EditorOption.lightbulb */) && !this._editor.getOption(59 /* EditorOption.lightbulb */).enabled) {\n                this.hide();\n            }\n        }));\n        this._updateLightBulbTitleAndIcon();\n        this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon, this));\n    }\n    dispose() {\n        super.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return 'LightBulbWidget';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return this._state.type === 1 /* LightBulbState.Type.Showing */ ? this._state.widgetPosition : null;\n    }\n    update(actions, trigger, atPosition) {\n        if (actions.validActions.length <= 0) {\n            return this.hide();\n        }\n        const options = this._editor.getOptions();\n        if (!options.get(59 /* EditorOption.lightbulb */).enabled) {\n            return this.hide();\n        }\n        const model = this._editor.getModel();\n        if (!model) {\n            return this.hide();\n        }\n        const { lineNumber, column } = model.validatePosition(atPosition);\n        const tabSize = model.getOptions().tabSize;\n        const fontInfo = options.get(46 /* EditorOption.fontInfo */);\n        const lineContent = model.getLineContent(lineNumber);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        const lineHasSpace = fontInfo.spaceWidth * indent > 22;\n        const isFolded = (lineNumber) => {\n            return lineNumber > 2 && this._editor.getTopForLineNumber(lineNumber) === this._editor.getTopForLineNumber(lineNumber - 1);\n        };\n        let effectiveLineNumber = lineNumber;\n        if (!lineHasSpace) {\n            if (lineNumber > 1 && !isFolded(lineNumber - 1)) {\n                effectiveLineNumber -= 1;\n            }\n            else if (!isFolded(lineNumber + 1)) {\n                effectiveLineNumber += 1;\n            }\n            else if (column * fontInfo.spaceWidth < 22) {\n                // cannot show lightbulb above/below and showing\n                // it inline would overlay the cursor...\n                return this.hide();\n            }\n        }\n        this.state = new LightBulbState.Showing(actions, trigger, atPosition, {\n            position: { lineNumber: effectiveLineNumber, column: 1 },\n            preference: LightBulbWidget._posPref\n        });\n        this._editor.layoutContentWidget(this);\n    }\n    hide() {\n        this.state = LightBulbState.Hidden;\n        this._editor.layoutContentWidget(this);\n    }\n    get state() { return this._state; }\n    set state(value) {\n        this._state = value;\n        this._updateLightBulbTitleAndIcon();\n    }\n    _updateLightBulbTitleAndIcon() {\n        if (this.state.type === 1 /* LightBulbState.Type.Showing */ && this.state.actions.hasAutoFix) {\n            // update icon\n            this._domNode.classList.remove(...Codicon.lightBulb.classNamesArray);\n            this._domNode.classList.add(...Codicon.lightbulbAutofix.classNamesArray);\n            const preferredKb = this._keybindingService.lookupKeybinding(this._preferredFixActionId);\n            if (preferredKb) {\n                this.title = nls.localize('preferredcodeActionWithKb', \"Show Code Actions. Preferred Quick Fix Available ({0})\", preferredKb.getLabel());\n                return;\n            }\n        }\n        // update icon\n        this._domNode.classList.remove(...Codicon.lightbulbAutofix.classNamesArray);\n        this._domNode.classList.add(...Codicon.lightBulb.classNamesArray);\n        const kb = this._keybindingService.lookupKeybinding(this._quickFixActionId);\n        if (kb) {\n            this.title = nls.localize('codeActionWithKb', \"Show Code Actions ({0})\", kb.getLabel());\n        }\n        else {\n            this.title = nls.localize('codeAction', \"Show Code Actions\");\n        }\n    }\n    set title(value) {\n        this._domNode.title = value;\n    }\n};\nLightBulbWidget._posPref = [0 /* ContentWidgetPositionPreference.EXACT */];\nLightBulbWidget = __decorate([\n    __param(3, IKeybindingService)\n], LightBulbWidget);\nexport { LightBulbWidget };\nregisterThemingParticipant((theme, collector) => {\n    var _a;\n    const editorBackgroundColor = (_a = theme.getColor(editorBackground)) === null || _a === void 0 ? void 0 : _a.transparent(0.7);\n    // Lightbulb Icon\n    const editorLightBulbForegroundColor = theme.getColor(editorLightBulbForeground);\n    if (editorLightBulbForegroundColor) {\n        collector.addRule(`\n\t\t.monaco-editor .contentWidgets ${Codicon.lightBulb.cssSelector} {\n\t\t\tcolor: ${editorLightBulbForegroundColor};\n\t\t\tbackground-color: ${editorBackgroundColor};\n\t\t}`);\n    }\n    // Lightbulb Auto Fix Icon\n    const editorLightBulbAutoFixForegroundColor = theme.getColor(editorLightBulbAutoFixForeground);\n    if (editorLightBulbAutoFixForegroundColor) {\n        collector.addRule(`\n\t\t.monaco-editor .contentWidgets ${Codicon.lightbulbAutofix.cssSelector} {\n\t\t\tcolor: ${editorLightBulbAutoFixForegroundColor};\n\t\t\tbackground-color: ${editorBackgroundColor};\n\t\t}`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _CodeActionUi_disposed;\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { CodeActionMenu } from './codeActionMenu.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nlet CodeActionUi = class CodeActionUi extends Disposable {\n    constructor(_editor, quickFixActionId, preferredFixActionId, delegate, instantiationService) {\n        super();\n        this._editor = _editor;\n        this.delegate = delegate;\n        this._activeCodeActions = this._register(new MutableDisposable());\n        this.previewOn = false;\n        _CodeActionUi_disposed.set(this, false);\n        this._codeActionWidget = new Lazy(() => {\n            return this._register(instantiationService.createInstance(CodeActionMenu, this._editor, {\n                onSelectCodeAction: (action, trigger) => __awaiter(this, void 0, void 0, function* () {\n                    if (this.previewOn) {\n                        this.delegate.applyCodeAction(action, /* retrigger */ true, Boolean(this.previewOn));\n                    }\n                    else {\n                        this.delegate.applyCodeAction(action, /* retrigger */ true, Boolean(trigger.preview));\n                    }\n                    this.previewOn = false;\n                })\n            }));\n        });\n        this._lightBulbWidget = new Lazy(() => {\n            const widget = this._register(instantiationService.createInstance(LightBulbWidget, this._editor, quickFixActionId, preferredFixActionId));\n            this._register(widget.onClick(e => this.showCodeActionList(e.trigger, e.actions, e, { includeDisabledActions: false, fromLightbulb: true })));\n            return widget;\n        });\n    }\n    dispose() {\n        __classPrivateFieldSet(this, _CodeActionUi_disposed, true, \"f\");\n        super.dispose();\n    }\n    hideCodeActionWidget() {\n        if (this._codeActionWidget.hasValue()) {\n            this._codeActionWidget.getValue().hideCodeActionWidget();\n        }\n    }\n    onEnter() {\n        if (this._codeActionWidget.hasValue()) {\n            this._codeActionWidget.getValue().onEnterSet();\n        }\n    }\n    onPreviewEnter() {\n        this.previewOn = true;\n        this.onEnter();\n    }\n    navigateList(navUp) {\n        if (this._codeActionWidget.hasValue()) {\n            if (navUp) {\n                this._codeActionWidget.getValue().navigateListWithKeysUp();\n            }\n            else {\n                this._codeActionWidget.getValue().navigateListWithKeysDown();\n            }\n        }\n    }\n    update(newState) {\n        var _a, _b, _c, _d, _e;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (newState.type !== 1 /* CodeActionsState.Type.Triggered */) {\n                (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\n                return;\n            }\n            let actions;\n            try {\n                actions = yield newState.actions;\n            }\n            catch (e) {\n                onUnexpectedError(e);\n                return;\n            }\n            if (__classPrivateFieldGet(this, _CodeActionUi_disposed, \"f\")) {\n                return;\n            }\n            this._lightBulbWidget.getValue().update(actions, newState.trigger, newState.position);\n            if (newState.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n                if ((_b = newState.trigger.filter) === null || _b === void 0 ? void 0 : _b.include) { // Triggered for specific scope\n                    // Check to see if we want to auto apply.\n                    const validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\n                    if (validActionToApply) {\n                        try {\n                            this._lightBulbWidget.getValue().hide();\n                            yield this.delegate.applyCodeAction(validActionToApply, false, false);\n                        }\n                        finally {\n                            actions.dispose();\n                        }\n                        return;\n                    }\n                    // Check to see if there is an action that we would have applied were it not invalid\n                    if (newState.trigger.context) {\n                        const invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\n                        if (invalidAction && invalidAction.action.disabled) {\n                            (_c = MessageController.get(this._editor)) === null || _c === void 0 ? void 0 : _c.showMessage(invalidAction.action.disabled, newState.trigger.context.position);\n                            actions.dispose();\n                            return;\n                        }\n                    }\n                }\n                const includeDisabledActions = !!((_d = newState.trigger.filter) === null || _d === void 0 ? void 0 : _d.include);\n                if (newState.trigger.context) {\n                    if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\n                        (_e = MessageController.get(this._editor)) === null || _e === void 0 ? void 0 : _e.showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\n                        this._activeCodeActions.value = actions;\n                        actions.dispose();\n                        return;\n                    }\n                }\n                this._activeCodeActions.value = actions;\n                this._codeActionWidget.getValue().show(newState.trigger, actions, newState.position, { includeDisabledActions, fromLightbulb: false });\n            }\n            else {\n                // auto magically triggered\n                if (this._codeActionWidget.getValue().isVisible) {\n                    // TODO: Figure out if we should update the showing menu?\n                    actions.dispose();\n                }\n                else {\n                    this._activeCodeActions.value = actions;\n                }\n            }\n        });\n    }\n    getInvalidActionThatWouldHaveBeenApplied(trigger, actions) {\n        if (!actions.allActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length === 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.allActions.length === 1)) {\n            return actions.allActions.find(({ action }) => action.disabled);\n        }\n        return undefined;\n    }\n    tryGetValidActionToApply(trigger, actions) {\n        if (!actions.validActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length > 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.validActions.length === 1)) {\n            return actions.validActions[0];\n        }\n        return undefined;\n    }\n    showCodeActionList(trigger, actions, at, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._codeActionWidget.getValue().show(trigger, actions, at, options);\n        });\n    }\n};\n_CodeActionUi_disposed = new WeakMap();\nCodeActionUi = __decorate([\n    __param(4, IInstantiationService)\n], CodeActionUi);\nexport { CodeActionUi };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _CodeActionModel_isDisposed;\nimport { createCancelablePromise, TimeoutTimer } from '../../../../base/common/async.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { Range } from '../../../common/core/range.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { getCodeActions } from './codeAction.js';\nimport { CodeActionTriggerSource } from './types.js';\nexport const SUPPORTED_CODE_ACTIONS = new RawContextKey('supportedCodeAction', '');\nclass CodeActionOracle extends Disposable {\n    constructor(_editor, _markerService, _signalChange, _delay = 250) {\n        super();\n        this._editor = _editor;\n        this._markerService = _markerService;\n        this._signalChange = _signalChange;\n        this._delay = _delay;\n        this._autoTriggerTimer = this._register(new TimeoutTimer());\n        this._register(this._markerService.onMarkerChanged(e => this._onMarkerChanges(e)));\n        this._register(this._editor.onDidChangeCursorPosition(() => this._onCursorChange()));\n    }\n    trigger(trigger) {\n        const selection = this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);\n        return this._createEventAndSignalChange(trigger, selection);\n    }\n    _onMarkerChanges(resources) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (resources.some(resource => isEqual(resource, model.uri))) {\n            this._autoTriggerTimer.cancelAndSet(() => {\n                this.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n            }, this._delay);\n        }\n    }\n    _onCursorChange() {\n        this._autoTriggerTimer.cancelAndSet(() => {\n            this.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n        }, this._delay);\n    }\n    _getRangeOfMarker(selection) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return undefined;\n        }\n        for (const marker of this._markerService.read({ resource: model.uri })) {\n            const markerRange = model.validateRange(marker);\n            if (Range.intersectRanges(markerRange, selection)) {\n                return Range.lift(markerRange);\n            }\n        }\n        return undefined;\n    }\n    _getRangeOfSelectionUnlessWhitespaceEnclosed(trigger) {\n        if (!this._editor.hasModel()) {\n            return undefined;\n        }\n        const model = this._editor.getModel();\n        const selection = this._editor.getSelection();\n        if (selection.isEmpty() && trigger.type === 2 /* CodeActionTriggerType.Auto */) {\n            const { lineNumber, column } = selection.getPosition();\n            const line = model.getLineContent(lineNumber);\n            if (line.length === 0) {\n                // empty line\n                return undefined;\n            }\n            else if (column === 1) {\n                // look only right\n                if (/\\s/.test(line[0])) {\n                    return undefined;\n                }\n            }\n            else if (column === model.getLineMaxColumn(lineNumber)) {\n                // look only left\n                if (/\\s/.test(line[line.length - 1])) {\n                    return undefined;\n                }\n            }\n            else {\n                // look left and right\n                if (/\\s/.test(line[column - 2]) && /\\s/.test(line[column - 1])) {\n                    return undefined;\n                }\n            }\n        }\n        return selection;\n    }\n    _createEventAndSignalChange(trigger, selection) {\n        const model = this._editor.getModel();\n        if (!selection || !model) {\n            // cancel\n            this._signalChange(undefined);\n            return undefined;\n        }\n        const markerRange = this._getRangeOfMarker(selection);\n        const position = markerRange ? markerRange.getStartPosition() : selection.getStartPosition();\n        const e = {\n            trigger,\n            selection,\n            position\n        };\n        this._signalChange(e);\n        return e;\n    }\n}\nexport var CodeActionsState;\n(function (CodeActionsState) {\n    CodeActionsState.Empty = { type: 0 /* Type.Empty */ };\n    class Triggered {\n        constructor(trigger, rangeOrSelection, position, _cancellablePromise) {\n            this.trigger = trigger;\n            this.rangeOrSelection = rangeOrSelection;\n            this.position = position;\n            this._cancellablePromise = _cancellablePromise;\n            this.type = 1 /* Type.Triggered */;\n            this.actions = _cancellablePromise.catch((e) => {\n                if (isCancellationError(e)) {\n                    return emptyCodeActionSet;\n                }\n                throw e;\n            });\n        }\n        cancel() {\n            this._cancellablePromise.cancel();\n        }\n    }\n    CodeActionsState.Triggered = Triggered;\n})(CodeActionsState || (CodeActionsState = {}));\nconst emptyCodeActionSet = {\n    allActions: [],\n    validActions: [],\n    dispose: () => { },\n    documentation: [],\n    hasAutoFix: false\n};\nexport class CodeActionModel extends Disposable {\n    constructor(_editor, _registry, _markerService, contextKeyService, _progressService) {\n        super();\n        this._editor = _editor;\n        this._registry = _registry;\n        this._markerService = _markerService;\n        this._progressService = _progressService;\n        this._codeActionOracle = this._register(new MutableDisposable());\n        this._state = CodeActionsState.Empty;\n        this._onDidChangeState = this._register(new Emitter());\n        this.onDidChangeState = this._onDidChangeState.event;\n        _CodeActionModel_isDisposed.set(this, false);\n        this._supportedCodeActions = SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService);\n        this._register(this._editor.onDidChangeModel(() => this._update()));\n        this._register(this._editor.onDidChangeModelLanguage(() => this._update()));\n        this._register(this._registry.onDidChange(() => this._update()));\n        this._update();\n    }\n    dispose() {\n        if (__classPrivateFieldGet(this, _CodeActionModel_isDisposed, \"f\")) {\n            return;\n        }\n        __classPrivateFieldSet(this, _CodeActionModel_isDisposed, true, \"f\");\n        super.dispose();\n        this.setState(CodeActionsState.Empty, true);\n    }\n    _update() {\n        if (__classPrivateFieldGet(this, _CodeActionModel_isDisposed, \"f\")) {\n            return;\n        }\n        this._codeActionOracle.value = undefined;\n        this.setState(CodeActionsState.Empty);\n        const model = this._editor.getModel();\n        if (model\n            && this._registry.has(model)\n            && !this._editor.getOption(83 /* EditorOption.readOnly */)) {\n            const supportedActions = [];\n            for (const provider of this._registry.all(model)) {\n                if (Array.isArray(provider.providedCodeActionKinds)) {\n                    supportedActions.push(...provider.providedCodeActionKinds);\n                }\n            }\n            this._supportedCodeActions.set(supportedActions.join(' '));\n            this._codeActionOracle.value = new CodeActionOracle(this._editor, this._markerService, trigger => {\n                var _a;\n                if (!trigger) {\n                    this.setState(CodeActionsState.Empty);\n                    return;\n                }\n                const actions = createCancelablePromise(token => getCodeActions(this._registry, model, trigger.selection, trigger.trigger, Progress.None, token));\n                if (trigger.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n                    (_a = this._progressService) === null || _a === void 0 ? void 0 : _a.showWhile(actions, 250);\n                }\n                this.setState(new CodeActionsState.Triggered(trigger.trigger, trigger.selection, trigger.position, actions));\n            }, undefined);\n            this._codeActionOracle.value.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n        }\n        else {\n            this._supportedCodeActions.reset();\n        }\n    }\n    trigger(trigger) {\n        var _a;\n        (_a = this._codeActionOracle.value) === null || _a === void 0 ? void 0 : _a.trigger(trigger);\n    }\n    setState(newState, skipNotify) {\n        if (newState === this._state) {\n            return;\n        }\n        // Cancel old request\n        if (this._state.type === 1 /* CodeActionsState.Type.Triggered */) {\n            this._state.cancel();\n        }\n        this._state = newState;\n        if (!skipNotify && !__classPrivateFieldGet(this, _CodeActionModel_isDisposed, \"f\")) {\n            this._onDidChangeState.fire(newState);\n        }\n    }\n}\n_CodeActionModel_isDisposed = new WeakMap();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService, ResourceEdit } from '../../../browser/services/bulkEditService.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { codeActionCommandId, fixAllCommandId, organizeImportsCommandId, refactorCommandId, refactorPreviewCommandId, sourceActionCommandId } from './codeAction.js';\nimport { CodeActionUi } from './codeActionUi.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CodeActionModel, SUPPORTED_CODE_ACTIONS } from './codeActionModel.js';\nimport { CodeActionCommandArgs, CodeActionKind, CodeActionTriggerSource } from './types.js';\nimport { Context } from './codeActionMenu.js';\nfunction contextKeyForSupportedActions(kind) {\n    return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0], new RegExp('(\\\\s|^)' + escapeRegExpCharacters(kind.value) + '\\\\b'));\n}\nfunction refactorTrigger(editor, userArgs, preview, codeActionFrom) {\n    const args = CodeActionCommandArgs.fromUser(userArgs, {\n        kind: CodeActionKind.Refactor,\n        apply: \"never\" /* CodeActionAutoApply.Never */\n    });\n    return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\n        ? args.preferred\n            ? nls.localize('editor.action.refactor.noneMessage.preferred.kind', \"No preferred refactorings for '{0}' available\", userArgs.kind)\n            : nls.localize('editor.action.refactor.noneMessage.kind', \"No refactorings for '{0}' available\", userArgs.kind)\n        : args.preferred\n            ? nls.localize('editor.action.refactor.noneMessage.preferred', \"No preferred refactorings available\")\n            : nls.localize('editor.action.refactor.noneMessage', \"No refactorings available\"), {\n        include: CodeActionKind.Refactor.contains(args.kind) ? args.kind : CodeActionKind.None,\n        onlyIncludePreferredActions: args.preferred\n    }, args.apply, preview, codeActionFrom);\n}\nconst argsSchema = {\n    type: 'object',\n    defaultSnippets: [{ body: { kind: '' } }],\n    properties: {\n        'kind': {\n            type: 'string',\n            description: nls.localize('args.schema.kind', \"Kind of the code action to run.\"),\n        },\n        'apply': {\n            type: 'string',\n            description: nls.localize('args.schema.apply', \"Controls when the returned actions are applied.\"),\n            default: \"ifSingle\" /* CodeActionAutoApply.IfSingle */,\n            enum: [\"first\" /* CodeActionAutoApply.First */, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, \"never\" /* CodeActionAutoApply.Never */],\n            enumDescriptions: [\n                nls.localize('args.schema.apply.first', \"Always apply the first returned code action.\"),\n                nls.localize('args.schema.apply.ifSingle', \"Apply the first returned code action if it is the only one.\"),\n                nls.localize('args.schema.apply.never', \"Do not apply the returned code actions.\"),\n            ]\n        },\n        'preferred': {\n            type: 'boolean',\n            default: false,\n            description: nls.localize('args.schema.preferred', \"Controls if only preferred code actions should be returned.\"),\n        }\n    }\n};\nlet QuickFixController = class QuickFixController extends Disposable {\n    constructor(editor, markerService, contextKeyService, progressService, _instantiationService, languageFeaturesService) {\n        super();\n        this._instantiationService = _instantiationService;\n        this._editor = editor;\n        this._model = this._register(new CodeActionModel(this._editor, languageFeaturesService.codeActionProvider, markerService, contextKeyService, progressService));\n        this._register(this._model.onDidChangeState(newState => this.update(newState)));\n        this._ui = new Lazy(() => this._register(new CodeActionUi(editor, QuickFixAction.Id, AutoFixAction.Id, {\n            applyCodeAction: (action, retrigger, preview) => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    yield this._applyCodeAction(action, preview);\n                }\n                finally {\n                    if (retrigger) {\n                        this._trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.QuickFix, filter: {} });\n                    }\n                }\n            })\n        }, this._instantiationService)));\n    }\n    static get(editor) {\n        return editor.getContribution(QuickFixController.ID);\n    }\n    update(newState) {\n        this._ui.getValue().update(newState);\n    }\n    hideCodeActionMenu() {\n        if (this._ui.hasValue()) {\n            this._ui.getValue().hideCodeActionWidget();\n        }\n    }\n    navigateCodeActionList(navUp) {\n        if (this._ui.hasValue()) {\n            this._ui.getValue().navigateList(navUp);\n        }\n    }\n    selectedOption() {\n        if (this._ui.hasValue()) {\n            this._ui.getValue().onEnter();\n        }\n    }\n    selectedOptionWithPreview() {\n        if (this._ui.hasValue()) {\n            this._ui.getValue().onPreviewEnter();\n        }\n    }\n    showCodeActions(trigger, actions, at) {\n        return this._ui.getValue().showCodeActionList(trigger, actions, at, { includeDisabledActions: false, fromLightbulb: false });\n    }\n    manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply, preview) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        (_a = MessageController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.closeMessage();\n        const triggerPosition = this._editor.getPosition();\n        this._trigger({ type: 1 /* CodeActionTriggerType.Invoke */, triggerAction, filter, autoApply, context: { notAvailableMessage, position: triggerPosition }, preview });\n    }\n    _trigger(trigger) {\n        return this._model.trigger(trigger);\n    }\n    _applyCodeAction(action, preview) {\n        return this._instantiationService.invokeFunction(applyCodeAction, action, ApplyCodeActionReason.FromCodeActions, { preview, editor: this._editor });\n    }\n};\nQuickFixController.ID = 'editor.contrib.quickFixController';\nQuickFixController = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IContextKeyService),\n    __param(3, IEditorProgressService),\n    __param(4, IInstantiationService),\n    __param(5, ILanguageFeaturesService)\n], QuickFixController);\nexport { QuickFixController };\nexport var ApplyCodeActionReason;\n(function (ApplyCodeActionReason) {\n    ApplyCodeActionReason[\"OnSave\"] = \"onSave\";\n    ApplyCodeActionReason[\"FromProblemsView\"] = \"fromProblemsView\";\n    ApplyCodeActionReason[\"FromCodeActions\"] = \"fromCodeActions\";\n})(ApplyCodeActionReason || (ApplyCodeActionReason = {}));\nexport function applyCodeAction(accessor, item, codeActionReason, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const bulkEditService = accessor.get(IBulkEditService);\n        const commandService = accessor.get(ICommandService);\n        const telemetryService = accessor.get(ITelemetryService);\n        const notificationService = accessor.get(INotificationService);\n        telemetryService.publicLog2('codeAction.applyCodeAction', {\n            codeActionTitle: item.action.title,\n            codeActionKind: item.action.kind,\n            codeActionIsPreferred: !!item.action.isPreferred,\n            reason: codeActionReason,\n        });\n        yield item.resolve(CancellationToken.None);\n        if (item.action.edit) {\n            yield bulkEditService.apply(ResourceEdit.convert(item.action.edit), {\n                editor: options === null || options === void 0 ? void 0 : options.editor,\n                label: item.action.title,\n                quotableLabel: item.action.title,\n                code: 'undoredo.codeAction',\n                respectAutoSaveConfig: true,\n                showPreview: options === null || options === void 0 ? void 0 : options.preview,\n            });\n        }\n        if (item.action.command) {\n            try {\n                yield commandService.executeCommand(item.action.command.id, ...(item.action.command.arguments || []));\n            }\n            catch (err) {\n                const message = asMessage(err);\n                notificationService.error(typeof message === 'string'\n                    ? message\n                    : nls.localize('applyCodeActionFailed', \"An unknown error occurred while applying the code action\"));\n            }\n        }\n    });\n}\nfunction asMessage(err) {\n    if (typeof err === 'string') {\n        return err;\n    }\n    else if (err instanceof Error && typeof err.message === 'string') {\n        return err.message;\n    }\n    else {\n        return undefined;\n    }\n}\nfunction triggerCodeActionsForEditorSelection(editor, notAvailableMessage, filter, autoApply, preview = false, triggerAction = CodeActionTriggerSource.Default) {\n    if (editor.hasModel()) {\n        const controller = QuickFixController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply, preview);\n    }\n}\nexport class QuickFixAction extends EditorAction {\n    constructor() {\n        super({\n            id: QuickFixAction.Id,\n            label: nls.localize('quickfix.trigger.label', \"Quick Fix...\"),\n            alias: 'Quick Fix...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 84 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.quickFix.noneMessage', \"No code actions available\"), undefined, undefined, false, CodeActionTriggerSource.QuickFix);\n    }\n}\nQuickFixAction.Id = 'editor.action.quickFix';\nexport class CodeActionCommand extends EditorCommand {\n    constructor() {\n        super({\n            id: codeActionCommandId,\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            description: {\n                description: 'Trigger a code action',\n                args: [{ name: 'args', schema: argsSchema, }]\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Empty,\n            apply: \"ifSingle\" /* CodeActionAutoApply.IfSingle */,\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred.kind', \"No preferred code actions for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.codeAction.noneMessage.kind', \"No code actions for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred', \"No preferred code actions available\")\n                : nls.localize('editor.action.codeAction.noneMessage', \"No code actions available\"), {\n            include: args.kind,\n            includeSourceActions: true,\n            onlyIncludePreferredActions: args.preferred,\n        }, args.apply);\n    }\n}\nexport class RefactorAction extends EditorAction {\n    constructor() {\n        super({\n            id: refactorCommandId,\n            label: nls.localize('refactor.label', \"Refactor...\"),\n            alias: 'Refactor...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 48 /* KeyCode.KeyR */,\n                mac: {\n                    primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 48 /* KeyCode.KeyR */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 2,\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Refactor)),\n            },\n            description: {\n                description: 'Refactor...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        return refactorTrigger(editor, userArgs, false, CodeActionTriggerSource.Refactor);\n    }\n}\nexport class RefactorPreview extends EditorAction {\n    constructor() {\n        super({\n            id: refactorPreviewCommandId,\n            label: nls.localize('refactor.preview.label', \"Refactor with Preview...\"),\n            alias: 'Refactor Preview...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            description: {\n                description: 'Refactor Preview...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        return refactorTrigger(editor, userArgs, true, CodeActionTriggerSource.RefactorPreview);\n    }\n}\nexport class SourceAction extends EditorAction {\n    constructor() {\n        super({\n            id: sourceActionCommandId,\n            label: nls.localize('source.label', \"Source Action...\"),\n            alias: 'Source Action...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 2.1,\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Source)),\n            },\n            description: {\n                description: 'Source Action...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Source,\n            apply: \"never\" /* CodeActionAutoApply.Never */\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.source.noneMessage.preferred.kind', \"No preferred source actions for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.source.noneMessage.kind', \"No source actions for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.source.noneMessage.preferred', \"No preferred source actions available\")\n                : nls.localize('editor.action.source.noneMessage', \"No source actions available\"), {\n            include: CodeActionKind.Source.contains(args.kind) ? args.kind : CodeActionKind.None,\n            includeSourceActions: true,\n            onlyIncludePreferredActions: args.preferred,\n        }, args.apply, undefined, CodeActionTriggerSource.SourceAction);\n    }\n}\nexport class OrganizeImportsAction extends EditorAction {\n    constructor() {\n        super({\n            id: organizeImportsCommandId,\n            label: nls.localize('organizeImports.label', \"Organize Imports\"),\n            alias: 'Organize Imports',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 45 /* KeyCode.KeyO */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.organize.noneMessage', \"No organize imports action available\"), { include: CodeActionKind.SourceOrganizeImports, includeSourceActions: true }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, undefined, CodeActionTriggerSource.OrganizeImports);\n    }\n}\nexport class FixAllAction extends EditorAction {\n    constructor() {\n        super({\n            id: fixAllCommandId,\n            label: nls.localize('fixAll.label', \"Fix All\"),\n            alias: 'Fix All',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceFixAll))\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('fixAll.noneMessage', \"No fix all action available\"), { include: CodeActionKind.SourceFixAll, includeSourceActions: true }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, undefined, CodeActionTriggerSource.FixAll);\n    }\n}\nexport class AutoFixAction extends EditorAction {\n    constructor() {\n        super({\n            id: AutoFixAction.Id,\n            label: nls.localize('autoFix.label', \"Auto Fix...\"),\n            alias: 'Auto Fix...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.QuickFix)),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 84 /* KeyCode.Period */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 84 /* KeyCode.Period */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.autoFix.noneMessage', \"No auto fixes available\"), {\n            include: CodeActionKind.QuickFix,\n            onlyIncludePreferredActions: true\n        }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, undefined, CodeActionTriggerSource.AutoFix);\n    }\n}\nAutoFixAction.Id = 'editor.action.autoFix';\nconst CodeActionContribution = EditorCommand.bindToContribution(QuickFixController.get);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 90;\nregisterEditorCommand(new CodeActionContribution({\n    id: 'hideCodeActionMenuWidget',\n    precondition: Context.Visible,\n    handler(x) {\n        x.hideCodeActionMenu();\n    },\n    kbOpts: {\n        weight: weight,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CodeActionContribution({\n    id: 'focusPreviousCodeAction',\n    precondition: Context.Visible,\n    handler(x) {\n        x.navigateCodeActionList(true);\n    },\n    kbOpts: {\n        weight: weight + 100000,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n    }\n}));\nregisterEditorCommand(new CodeActionContribution({\n    id: 'focusNextCodeAction',\n    precondition: Context.Visible,\n    handler(x) {\n        x.navigateCodeActionList(false);\n    },\n    kbOpts: {\n        weight: weight + 100000,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n    }\n}));\nregisterEditorCommand(new CodeActionContribution({\n    id: 'onEnterSelectCodeAction',\n    precondition: Context.Visible,\n    handler(x) {\n        x.selectedOption();\n    },\n    kbOpts: {\n        weight: weight + 100000,\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */],\n    }\n}));\nregisterEditorCommand(new CodeActionContribution({\n    id: 'onEnterSelectCodeActionWithPreview',\n    precondition: Context.Visible,\n    handler(x) {\n        x.selectedOptionWithPreview();\n    },\n    kbOpts: {\n        weight: weight + 100000,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { editorConfigurationBaseNode } from '../../../common/config/editorConfigurationSchema.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nRegistry.as(Extensions.Configuration).registerConfiguration(Object.assign(Object.assign({}, editorConfigurationBaseNode), { properties: {\n        'editor.experimental.useCustomCodeActionMenu': {\n            type: 'boolean',\n            tags: ['experimental'],\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('codeActionWidget', \"Enabling this adjusts how the code action menu is rendered.\"),\n            default: false,\n        },\n    } }));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { AutoFixAction, CodeActionCommand, FixAllAction, OrganizeImportsAction, QuickFixAction, QuickFixController, RefactorAction, RefactorPreview, SourceAction } from './codeActionCommands.js';\nimport './codeActionWidgetContribution.js';\nregisterEditorContribution(QuickFixController.ID, QuickFixController);\nregisterEditorAction(QuickFixAction);\nregisterEditorAction(RefactorAction);\nregisterEditorAction(RefactorPreview);\nregisterEditorAction(SourceAction);\nregisterEditorAction(OrganizeImportsAction);\nregisterEditorAction(AutoFixAction);\nregisterEditorAction(FixAllAction);\nregisterEditorCommand(new CodeActionCommand());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class CodeLensModel {\n    constructor() {\n        this.lenses = [];\n        this._disposables = new DisposableStore();\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    get isDisposed() {\n        return this._disposables.isDisposed;\n    }\n    add(list, provider) {\n        this._disposables.add(list);\n        for (const symbol of list.lenses) {\n            this.lenses.push({ symbol, provider });\n        }\n    }\n}\nexport function getCodeLensModel(registry, model, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const provider = registry.ordered(model);\n        const providerRanks = new Map();\n        const result = new CodeLensModel();\n        const promises = provider.map((provider, i) => __awaiter(this, void 0, void 0, function* () {\n            providerRanks.set(provider, i);\n            try {\n                const list = yield Promise.resolve(provider.provideCodeLenses(model, token));\n                if (list) {\n                    result.add(list, provider);\n                }\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }));\n        yield Promise.all(promises);\n        result.lenses = result.lenses.sort((a, b) => {\n            // sort by lineNumber, provider-rank, and column\n            if (a.symbol.range.startLineNumber < b.symbol.range.startLineNumber) {\n                return -1;\n            }\n            else if (a.symbol.range.startLineNumber > b.symbol.range.startLineNumber) {\n                return 1;\n            }\n            else if ((providerRanks.get(a.provider)) < (providerRanks.get(b.provider))) {\n                return -1;\n            }\n            else if ((providerRanks.get(a.provider)) > (providerRanks.get(b.provider))) {\n                return 1;\n            }\n            else if (a.symbol.range.startColumn < b.symbol.range.startColumn) {\n                return -1;\n            }\n            else if (a.symbol.range.startColumn > b.symbol.range.startColumn) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        });\n        return result;\n    });\n}\nCommandsRegistry.registerCommand('_executeCodeLensProvider', function (accessor, ...args) {\n    let [uri, itemResolveCount] = args;\n    assertType(URI.isUri(uri));\n    assertType(typeof itemResolveCount === 'number' || !itemResolveCount);\n    const { codeLensProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const result = [];\n    const disposables = new DisposableStore();\n    return getCodeLensModel(codeLensProvider, model, CancellationToken.None).then(value => {\n        disposables.add(value);\n        const resolve = [];\n        for (const item of value.lenses) {\n            if (itemResolveCount === undefined || itemResolveCount === null || Boolean(item.symbol.command)) {\n                result.push(item.symbol);\n            }\n            else if (itemResolveCount-- > 0 && item.provider.resolveCodeLens) {\n                resolve.push(Promise.resolve(item.provider.resolveCodeLens(model, item.symbol, CancellationToken.None)).then(symbol => result.push(symbol || item.symbol)));\n            }\n        }\n        return Promise.all(resolve);\n    }).then(() => {\n        return result;\n    }).finally(() => {\n        // make sure to return results, then (on next tick)\n        // dispose the results\n        setTimeout(() => disposables.dispose(), 100);\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { runWhenIdle } from '../../../../base/common/async.js';\nimport { once } from '../../../../base/common/functional.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { Range } from '../../../common/core/range.js';\nimport { CodeLensModel } from './codelens.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nexport const ICodeLensCache = createDecorator('ICodeLensCache');\nclass CacheItem {\n    constructor(lineCount, data) {\n        this.lineCount = lineCount;\n        this.data = data;\n    }\n}\nlet CodeLensCache = class CodeLensCache {\n    constructor(storageService) {\n        this._fakeProvider = new class {\n            provideCodeLenses() {\n                throw new Error('not supported');\n            }\n        };\n        this._cache = new LRUCache(20, 0.75);\n        // remove old data\n        const oldkey = 'codelens/cache';\n        runWhenIdle(() => storageService.remove(oldkey, 1 /* StorageScope.WORKSPACE */));\n        // restore lens data on start\n        const key = 'codelens/cache2';\n        const raw = storageService.get(key, 1 /* StorageScope.WORKSPACE */, '{}');\n        this._deserialize(raw);\n        // store lens data on shutdown\n        once(storageService.onWillSaveState)(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                storageService.store(key, this._serialize(), 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n            }\n        });\n    }\n    put(model, data) {\n        // create a copy of the model that is without command-ids\n        // but with comand-labels\n        const copyItems = data.lenses.map(item => {\n            var _a;\n            return {\n                range: item.symbol.range,\n                command: item.symbol.command && { id: '', title: (_a = item.symbol.command) === null || _a === void 0 ? void 0 : _a.title },\n            };\n        });\n        const copyModel = new CodeLensModel();\n        copyModel.add({ lenses: copyItems, dispose: () => { } }, this._fakeProvider);\n        const item = new CacheItem(model.getLineCount(), copyModel);\n        this._cache.set(model.uri.toString(), item);\n    }\n    get(model) {\n        const item = this._cache.get(model.uri.toString());\n        return item && item.lineCount === model.getLineCount() ? item.data : undefined;\n    }\n    delete(model) {\n        this._cache.delete(model.uri.toString());\n    }\n    // --- persistence\n    _serialize() {\n        const data = Object.create(null);\n        for (const [key, value] of this._cache) {\n            const lines = new Set();\n            for (const d of value.data.lenses) {\n                lines.add(d.symbol.range.startLineNumber);\n            }\n            data[key] = {\n                lineCount: value.lineCount,\n                lines: [...lines.values()]\n            };\n        }\n        return JSON.stringify(data);\n    }\n    _deserialize(raw) {\n        try {\n            const data = JSON.parse(raw);\n            for (const key in data) {\n                const element = data[key];\n                const lenses = [];\n                for (const line of element.lines) {\n                    lenses.push({ range: new Range(line, 1, line, 11) });\n                }\n                const model = new CodeLensModel();\n                model.add({ lenses, dispose() { } }, this._fakeProvider);\n                this._cache.set(key, new CacheItem(element.lineCount, model));\n            }\n        }\n        catch (_a) {\n            // ignore...\n        }\n    }\n};\nCodeLensCache = __decorate([\n    __param(0, IStorageService)\n], CodeLensCache);\nexport { CodeLensCache };\nregisterSingleton(ICodeLensCache, CodeLensCache);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { renderLabelWithIcons } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport './codelensWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nclass CodeLensViewZone {\n    constructor(afterLineNumber, heightInPx, onHeight) {\n        /**\n         * We want that this view zone, which reserves space for a code lens appears\n         * as close as possible to the next line, so we use a very large value here.\n         */\n        this.afterColumn = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = heightInPx;\n        this._onHeight = onHeight;\n        this.suppressMouseDown = true;\n        this.domNode = document.createElement('div');\n    }\n    onComputedHeight(height) {\n        if (this._lastHeight === undefined) {\n            this._lastHeight = height;\n        }\n        else if (this._lastHeight !== height) {\n            this._lastHeight = height;\n            this._onHeight();\n        }\n    }\n    isVisible() {\n        return this._lastHeight !== 0\n            && this.domNode.hasAttribute('monaco-visible-view-zone');\n    }\n}\nclass CodeLensContentWidget {\n    constructor(editor, className, line) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = false;\n        this.suppressMouseDown = true;\n        this._commands = new Map();\n        this._isEmpty = true;\n        this._editor = editor;\n        this._id = `codelens.widget-${(CodeLensContentWidget._idPool++)}`;\n        this.updatePosition(line);\n        this._domNode = document.createElement('span');\n        this._domNode.className = `codelens-decoration ${className}`;\n    }\n    withCommands(lenses, animate) {\n        this._commands.clear();\n        const children = [];\n        let hasSymbol = false;\n        for (let i = 0; i < lenses.length; i++) {\n            const lens = lenses[i];\n            if (!lens) {\n                continue;\n            }\n            hasSymbol = true;\n            if (lens.command) {\n                const title = renderLabelWithIcons(lens.command.title.trim());\n                if (lens.command.id) {\n                    children.push(dom.$('a', { id: String(i), title: lens.command.tooltip, role: 'button' }, ...title));\n                    this._commands.set(String(i), lens.command);\n                }\n                else {\n                    children.push(dom.$('span', { title: lens.command.tooltip }, ...title));\n                }\n                if (i + 1 < lenses.length) {\n                    children.push(dom.$('span', undefined, '\\u00a0|\\u00a0'));\n                }\n            }\n        }\n        if (!hasSymbol) {\n            // symbols but no commands\n            dom.reset(this._domNode, dom.$('span', undefined, 'no commands'));\n        }\n        else {\n            // symbols and commands\n            dom.reset(this._domNode, ...children);\n            if (this._isEmpty && animate) {\n                this._domNode.classList.add('fadein');\n            }\n            this._isEmpty = false;\n        }\n    }\n    getCommand(link) {\n        return link.parentElement === this._domNode\n            ? this._commands.get(link.id)\n            : undefined;\n    }\n    getId() {\n        return this._id;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    updatePosition(line) {\n        const column = this._editor.getModel().getLineFirstNonWhitespaceColumn(line);\n        this._widgetPosition = {\n            position: { lineNumber: line, column: column },\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    getPosition() {\n        return this._widgetPosition || null;\n    }\n}\nCodeLensContentWidget._idPool = 0;\nexport class CodeLensHelper {\n    constructor() {\n        this._removeDecorations = [];\n        this._addDecorations = [];\n        this._addDecorationsCallbacks = [];\n    }\n    addDecoration(decoration, callback) {\n        this._addDecorations.push(decoration);\n        this._addDecorationsCallbacks.push(callback);\n    }\n    removeDecoration(decorationId) {\n        this._removeDecorations.push(decorationId);\n    }\n    commit(changeAccessor) {\n        const resultingDecorations = changeAccessor.deltaDecorations(this._removeDecorations, this._addDecorations);\n        for (let i = 0, len = resultingDecorations.length; i < len; i++) {\n            this._addDecorationsCallbacks[i](resultingDecorations[i]);\n        }\n    }\n}\nexport class CodeLensWidget {\n    constructor(data, editor, className, helper, viewZoneChangeAccessor, heightInPx, updateCallback) {\n        this._isDisposed = false;\n        this._editor = editor;\n        this._className = className;\n        this._data = data;\n        // create combined range, track all ranges with decorations,\n        // check if there is already something to render\n        this._decorationIds = [];\n        let range;\n        const lenses = [];\n        this._data.forEach((codeLensData, i) => {\n            if (codeLensData.symbol.command) {\n                lenses.push(codeLensData.symbol);\n            }\n            helper.addDecoration({\n                range: codeLensData.symbol.range,\n                options: ModelDecorationOptions.EMPTY\n            }, id => this._decorationIds[i] = id);\n            // the range contains all lenses on this line\n            if (!range) {\n                range = Range.lift(codeLensData.symbol.range);\n            }\n            else {\n                range = Range.plusRange(range, codeLensData.symbol.range);\n            }\n        });\n        this._viewZone = new CodeLensViewZone(range.startLineNumber - 1, heightInPx, updateCallback);\n        this._viewZoneId = viewZoneChangeAccessor.addZone(this._viewZone);\n        if (lenses.length > 0) {\n            this._createContentWidgetIfNecessary();\n            this._contentWidget.withCommands(lenses, false);\n        }\n    }\n    _createContentWidgetIfNecessary() {\n        if (!this._contentWidget) {\n            this._contentWidget = new CodeLensContentWidget(this._editor, this._className, this._viewZone.afterLineNumber + 1);\n            this._editor.addContentWidget(this._contentWidget);\n        }\n        else {\n            this._editor.layoutContentWidget(this._contentWidget);\n        }\n    }\n    dispose(helper, viewZoneChangeAccessor) {\n        this._decorationIds.forEach(helper.removeDecoration, helper);\n        this._decorationIds = [];\n        viewZoneChangeAccessor === null || viewZoneChangeAccessor === void 0 ? void 0 : viewZoneChangeAccessor.removeZone(this._viewZoneId);\n        if (this._contentWidget) {\n            this._editor.removeContentWidget(this._contentWidget);\n            this._contentWidget = undefined;\n        }\n        this._isDisposed = true;\n    }\n    isDisposed() {\n        return this._isDisposed;\n    }\n    isValid() {\n        return this._decorationIds.some((id, i) => {\n            const range = this._editor.getModel().getDecorationRange(id);\n            const symbol = this._data[i].symbol;\n            return !!(range && Range.isEmpty(symbol.range) === range.isEmpty());\n        });\n    }\n    updateCodeLensSymbols(data, helper) {\n        this._decorationIds.forEach(helper.removeDecoration, helper);\n        this._decorationIds = [];\n        this._data = data;\n        this._data.forEach((codeLensData, i) => {\n            helper.addDecoration({\n                range: codeLensData.symbol.range,\n                options: ModelDecorationOptions.EMPTY\n            }, id => this._decorationIds[i] = id);\n        });\n    }\n    updateHeight(height, viewZoneChangeAccessor) {\n        this._viewZone.heightInPx = height;\n        viewZoneChangeAccessor.layoutZone(this._viewZoneId);\n        if (this._contentWidget) {\n            this._editor.layoutContentWidget(this._contentWidget);\n        }\n    }\n    computeIfNecessary(model) {\n        if (!this._viewZone.isVisible()) {\n            return null;\n        }\n        // Read editor current state\n        for (let i = 0; i < this._decorationIds.length; i++) {\n            const range = model.getDecorationRange(this._decorationIds[i]);\n            if (range) {\n                this._data[i].symbol.range = range;\n            }\n        }\n        return this._data;\n    }\n    updateCommands(symbols) {\n        this._createContentWidgetIfNecessary();\n        this._contentWidget.withCommands(symbols, true);\n        for (let i = 0; i < this._data.length; i++) {\n            const resolved = symbols[i];\n            if (resolved) {\n                const { symbol } = this._data[i];\n                symbol.command = resolved.command || symbol.command;\n            }\n        }\n    }\n    getCommand(link) {\n        var _a;\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.getCommand(link);\n    }\n    getLineNumber() {\n        const range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n        if (range) {\n            return range.startLineNumber;\n        }\n        return -1;\n    }\n    update(viewZoneChangeAccessor) {\n        if (this.isValid()) {\n            const range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n            if (range) {\n                this._viewZone.afterLineNumber = range.startLineNumber - 1;\n                viewZoneChangeAccessor.layoutZone(this._viewZoneId);\n                if (this._contentWidget) {\n                    this._contentWidget.updatePosition(range.startLineNumber);\n                    this._editor.layoutContentWidget(this._contentWidget);\n                }\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createCancelablePromise, disposableTimeout, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { hash } from '../../../../base/common/hash.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { getCodeLensModel } from './codelens.js';\nimport { ICodeLensCache } from './codeLensCache.js';\nimport { CodeLensHelper, CodeLensWidget } from './codelensWidget.js';\nimport { localize } from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nlet CodeLensContribution = class CodeLensContribution {\n    constructor(_editor, _languageFeaturesService, debounceService, _commandService, _notificationService, _codeLensCache) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._codeLensCache = _codeLensCache;\n        this._disposables = new DisposableStore();\n        this._localToDispose = new DisposableStore();\n        this._lenses = [];\n        this._oldCodeLensModels = new DisposableStore();\n        this._provideCodeLensDebounce = debounceService.for(_languageFeaturesService.codeLensProvider, 'CodeLensProvide', { min: 250 });\n        this._resolveCodeLensesDebounce = debounceService.for(_languageFeaturesService.codeLensProvider, 'CodeLensResolve', { min: 250, salt: 'resolve' });\n        this._resolveCodeLensesScheduler = new RunOnceScheduler(() => this._resolveCodeLensesInViewport(), this._resolveCodeLensesDebounce.default());\n        this._disposables.add(this._editor.onDidChangeModel(() => this._onModelChange()));\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => this._onModelChange()));\n        this._disposables.add(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */) || e.hasChanged(16 /* EditorOption.codeLensFontSize */) || e.hasChanged(15 /* EditorOption.codeLensFontFamily */)) {\n                this._updateLensStyle();\n            }\n            if (e.hasChanged(14 /* EditorOption.codeLens */)) {\n                this._onModelChange();\n            }\n        }));\n        this._disposables.add(_languageFeaturesService.codeLensProvider.onDidChange(this._onModelChange, this));\n        this._onModelChange();\n        this._styleClassName = '_' + hash(this._editor.getId()).toString(16);\n        this._styleElement = dom.createStyleSheet(dom.isInShadowDOM(this._editor.getContainerDomNode())\n            ? this._editor.getContainerDomNode()\n            : undefined);\n        this._updateLensStyle();\n    }\n    dispose() {\n        var _a;\n        this._localDispose();\n        this._disposables.dispose();\n        this._oldCodeLensModels.dispose();\n        (_a = this._currentCodeLensModel) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._styleElement.remove();\n    }\n    _getLayoutInfo() {\n        const lineHeightFactor = Math.max(1.3, this._editor.getOption(61 /* EditorOption.lineHeight */) / this._editor.getOption(48 /* EditorOption.fontSize */));\n        let fontSize = this._editor.getOption(16 /* EditorOption.codeLensFontSize */);\n        if (!fontSize || fontSize < 5) {\n            fontSize = (this._editor.getOption(48 /* EditorOption.fontSize */) * .9) | 0;\n        }\n        return {\n            fontSize,\n            codeLensHeight: (fontSize * lineHeightFactor) | 0,\n        };\n    }\n    _updateLensStyle() {\n        const { codeLensHeight, fontSize } = this._getLayoutInfo();\n        const fontFamily = this._editor.getOption(15 /* EditorOption.codeLensFontFamily */);\n        const editorFontInfo = this._editor.getOption(46 /* EditorOption.fontInfo */);\n        const fontFamilyVar = `--codelens-font-family${this._styleClassName}`;\n        const fontFeaturesVar = `--codelens-font-features${this._styleClassName}`;\n        let newStyle = `\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} { line-height: ${codeLensHeight}px; font-size: ${fontSize}px; padding-right: ${Math.round(fontSize * 0.5)}px; font-feature-settings: var(${fontFeaturesVar}) }\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} span.codicon { line-height: ${codeLensHeight}px; font-size: ${fontSize}px; }\n\t\t`;\n        if (fontFamily) {\n            newStyle += `.monaco-editor .codelens-decoration.${this._styleClassName} { font-family: var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}}`;\n        }\n        this._styleElement.textContent = newStyle;\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily !== null && fontFamily !== void 0 ? fontFamily : 'inherit');\n        this._editor.getContainerDomNode().style.setProperty(fontFeaturesVar, editorFontInfo.fontFeatureSettings);\n        //\n        this._editor.changeViewZones(accessor => {\n            for (const lens of this._lenses) {\n                lens.updateHeight(codeLensHeight, accessor);\n            }\n        });\n    }\n    _localDispose() {\n        var _a, _b, _c;\n        (_a = this._getCodeLensModelPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n        this._getCodeLensModelPromise = undefined;\n        (_b = this._resolveCodeLensesPromise) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._resolveCodeLensesPromise = undefined;\n        this._localToDispose.clear();\n        this._oldCodeLensModels.clear();\n        (_c = this._currentCodeLensModel) === null || _c === void 0 ? void 0 : _c.dispose();\n    }\n    _onModelChange() {\n        this._localDispose();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!this._editor.getOption(14 /* EditorOption.codeLens */)) {\n            return;\n        }\n        const cachedLenses = this._codeLensCache.get(model);\n        if (cachedLenses) {\n            this._renderCodeLensSymbols(cachedLenses);\n        }\n        if (!this._languageFeaturesService.codeLensProvider.has(model)) {\n            // no provider -> return but check with\n            // cached lenses. they expire after 30 seconds\n            if (cachedLenses) {\n                this._localToDispose.add(disposableTimeout(() => {\n                    const cachedLensesNow = this._codeLensCache.get(model);\n                    if (cachedLenses === cachedLensesNow) {\n                        this._codeLensCache.delete(model);\n                        this._onModelChange();\n                    }\n                }, 30 * 1000));\n            }\n            return;\n        }\n        for (const provider of this._languageFeaturesService.codeLensProvider.all(model)) {\n            if (typeof provider.onDidChange === 'function') {\n                const registration = provider.onDidChange(() => scheduler.schedule());\n                this._localToDispose.add(registration);\n            }\n        }\n        const scheduler = new RunOnceScheduler(() => {\n            var _a;\n            const t1 = Date.now();\n            (_a = this._getCodeLensModelPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._getCodeLensModelPromise = createCancelablePromise(token => getCodeLensModel(this._languageFeaturesService.codeLensProvider, model, token));\n            this._getCodeLensModelPromise.then(result => {\n                if (this._currentCodeLensModel) {\n                    this._oldCodeLensModels.add(this._currentCodeLensModel);\n                }\n                this._currentCodeLensModel = result;\n                // cache model to reduce flicker\n                this._codeLensCache.put(model, result);\n                // update moving average\n                const newDelay = this._provideCodeLensDebounce.update(model, Date.now() - t1);\n                scheduler.delay = newDelay;\n                // render lenses\n                this._renderCodeLensSymbols(result);\n                // dom.scheduleAtNextAnimationFrame(() => this._resolveCodeLensesInViewport());\n                this._resolveCodeLensesInViewportSoon();\n            }, onUnexpectedError);\n        }, this._provideCodeLensDebounce.get(model));\n        this._localToDispose.add(scheduler);\n        this._localToDispose.add(toDisposable(() => this._resolveCodeLensesScheduler.cancel()));\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n            this._editor.changeDecorations(decorationsAccessor => {\n                this._editor.changeViewZones(viewZonesAccessor => {\n                    const toDispose = [];\n                    let lastLensLineNumber = -1;\n                    this._lenses.forEach((lens) => {\n                        if (!lens.isValid() || lastLensLineNumber === lens.getLineNumber()) {\n                            // invalid -> lens collapsed, attach range doesn't exist anymore\n                            // line_number -> lenses should never be on the same line\n                            toDispose.push(lens);\n                        }\n                        else {\n                            lens.update(viewZonesAccessor);\n                            lastLensLineNumber = lens.getLineNumber();\n                        }\n                    });\n                    const helper = new CodeLensHelper();\n                    toDispose.forEach((l) => {\n                        l.dispose(helper, viewZonesAccessor);\n                        this._lenses.splice(this._lenses.indexOf(l), 1);\n                    });\n                    helper.commit(decorationsAccessor);\n                });\n            });\n            // Ask for all references again\n            scheduler.schedule();\n        }));\n        this._localToDispose.add(this._editor.onDidFocusEditorWidget(() => {\n            scheduler.schedule();\n        }));\n        this._localToDispose.add(this._editor.onDidScrollChange(e => {\n            if (e.scrollTopChanged && this._lenses.length > 0) {\n                this._resolveCodeLensesInViewportSoon();\n            }\n        }));\n        this._localToDispose.add(this._editor.onDidLayoutChange(() => {\n            this._resolveCodeLensesInViewportSoon();\n        }));\n        this._localToDispose.add(toDisposable(() => {\n            if (this._editor.getModel()) {\n                const scrollState = StableEditorScrollState.capture(this._editor);\n                this._editor.changeDecorations(decorationsAccessor => {\n                    this._editor.changeViewZones(viewZonesAccessor => {\n                        this._disposeAllLenses(decorationsAccessor, viewZonesAccessor);\n                    });\n                });\n                scrollState.restore(this._editor);\n            }\n            else {\n                // No accessors available\n                this._disposeAllLenses(undefined, undefined);\n            }\n        }));\n        this._localToDispose.add(this._editor.onMouseDown(e => {\n            if (e.target.type !== 9 /* MouseTargetType.CONTENT_WIDGET */) {\n                return;\n            }\n            let target = e.target.element;\n            if ((target === null || target === void 0 ? void 0 : target.tagName) === 'SPAN') {\n                target = target.parentElement;\n            }\n            if ((target === null || target === void 0 ? void 0 : target.tagName) === 'A') {\n                for (const lens of this._lenses) {\n                    const command = lens.getCommand(target);\n                    if (command) {\n                        this._commandService.executeCommand(command.id, ...(command.arguments || [])).catch(err => this._notificationService.error(err));\n                        break;\n                    }\n                }\n            }\n        }));\n        scheduler.schedule();\n    }\n    _disposeAllLenses(decChangeAccessor, viewZoneChangeAccessor) {\n        const helper = new CodeLensHelper();\n        for (const lens of this._lenses) {\n            lens.dispose(helper, viewZoneChangeAccessor);\n        }\n        if (decChangeAccessor) {\n            helper.commit(decChangeAccessor);\n        }\n        this._lenses.length = 0;\n    }\n    _renderCodeLensSymbols(symbols) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const maxLineNumber = this._editor.getModel().getLineCount();\n        const groups = [];\n        let lastGroup;\n        for (const symbol of symbols.lenses) {\n            const line = symbol.symbol.range.startLineNumber;\n            if (line < 1 || line > maxLineNumber) {\n                // invalid code lens\n                continue;\n            }\n            else if (lastGroup && lastGroup[lastGroup.length - 1].symbol.range.startLineNumber === line) {\n                // on same line as previous\n                lastGroup.push(symbol);\n            }\n            else {\n                // on later line as previous\n                lastGroup = [symbol];\n                groups.push(lastGroup);\n            }\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        const layoutInfo = this._getLayoutInfo();\n        this._editor.changeDecorations(decorationsAccessor => {\n            this._editor.changeViewZones(viewZoneAccessor => {\n                const helper = new CodeLensHelper();\n                let codeLensIndex = 0;\n                let groupsIndex = 0;\n                while (groupsIndex < groups.length && codeLensIndex < this._lenses.length) {\n                    const symbolsLineNumber = groups[groupsIndex][0].symbol.range.startLineNumber;\n                    const codeLensLineNumber = this._lenses[codeLensIndex].getLineNumber();\n                    if (codeLensLineNumber < symbolsLineNumber) {\n                        this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n                        this._lenses.splice(codeLensIndex, 1);\n                    }\n                    else if (codeLensLineNumber === symbolsLineNumber) {\n                        this._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex], helper);\n                        groupsIndex++;\n                        codeLensIndex++;\n                    }\n                    else {\n                        this._lenses.splice(codeLensIndex, 0, new CodeLensWidget(groups[groupsIndex], this._editor, this._styleClassName, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n                        codeLensIndex++;\n                        groupsIndex++;\n                    }\n                }\n                // Delete extra code lenses\n                while (codeLensIndex < this._lenses.length) {\n                    this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n                    this._lenses.splice(codeLensIndex, 1);\n                }\n                // Create extra symbols\n                while (groupsIndex < groups.length) {\n                    this._lenses.push(new CodeLensWidget(groups[groupsIndex], this._editor, this._styleClassName, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n                    groupsIndex++;\n                }\n                helper.commit(decorationsAccessor);\n            });\n        });\n        scrollState.restore(this._editor);\n    }\n    _resolveCodeLensesInViewportSoon() {\n        const model = this._editor.getModel();\n        if (model) {\n            this._resolveCodeLensesScheduler.schedule();\n        }\n    }\n    _resolveCodeLensesInViewport() {\n        var _a;\n        (_a = this._resolveCodeLensesPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n        this._resolveCodeLensesPromise = undefined;\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        const toResolve = [];\n        const lenses = [];\n        this._lenses.forEach((lens) => {\n            const request = lens.computeIfNecessary(model);\n            if (request) {\n                toResolve.push(request);\n                lenses.push(lens);\n            }\n        });\n        if (toResolve.length === 0) {\n            return;\n        }\n        const t1 = Date.now();\n        const resolvePromise = createCancelablePromise(token => {\n            const promises = toResolve.map((request, i) => {\n                const resolvedSymbols = new Array(request.length);\n                const promises = request.map((request, i) => {\n                    if (!request.symbol.command && typeof request.provider.resolveCodeLens === 'function') {\n                        return Promise.resolve(request.provider.resolveCodeLens(model, request.symbol, token)).then(symbol => {\n                            resolvedSymbols[i] = symbol;\n                        }, onUnexpectedExternalError);\n                    }\n                    else {\n                        resolvedSymbols[i] = request.symbol;\n                        return Promise.resolve(undefined);\n                    }\n                });\n                return Promise.all(promises).then(() => {\n                    if (!token.isCancellationRequested && !lenses[i].isDisposed()) {\n                        lenses[i].updateCommands(resolvedSymbols);\n                    }\n                });\n            });\n            return Promise.all(promises);\n        });\n        this._resolveCodeLensesPromise = resolvePromise;\n        this._resolveCodeLensesPromise.then(() => {\n            // update moving average\n            const newDelay = this._resolveCodeLensesDebounce.update(model, Date.now() - t1);\n            this._resolveCodeLensesScheduler.delay = newDelay;\n            if (this._currentCodeLensModel) { // update the cached state with new resolved items\n                this._codeLensCache.put(model, this._currentCodeLensModel);\n            }\n            this._oldCodeLensModels.clear(); // dispose old models once we have updated the UI with the current model\n            if (resolvePromise === this._resolveCodeLensesPromise) {\n                this._resolveCodeLensesPromise = undefined;\n            }\n        }, err => {\n            onUnexpectedError(err); // can also be cancellation!\n            if (resolvePromise === this._resolveCodeLensesPromise) {\n                this._resolveCodeLensesPromise = undefined;\n            }\n        });\n    }\n    getModel() {\n        return this._currentCodeLensModel;\n    }\n};\nCodeLensContribution.ID = 'css.editor.codeLens';\nCodeLensContribution = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, ICommandService),\n    __param(4, INotificationService),\n    __param(5, ICodeLensCache)\n], CodeLensContribution);\nexport { CodeLensContribution };\nregisterEditorContribution(CodeLensContribution.ID, CodeLensContribution);\nregisterEditorAction(class ShowLensesInCurrentLine extends EditorAction {\n    constructor() {\n        super({\n            id: 'codelens.showLensesInCurrentLine',\n            precondition: EditorContextKeys.hasCodeLensProvider,\n            label: localize('showLensOnLine', \"Show CodeLens Commands For Current Line\"),\n            alias: 'Show CodeLens Commands For Current Line',\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.hasModel()) {\n                return;\n            }\n            const quickInputService = accessor.get(IQuickInputService);\n            const commandService = accessor.get(ICommandService);\n            const notificationService = accessor.get(INotificationService);\n            const lineNumber = editor.getSelection().positionLineNumber;\n            const codelensController = editor.getContribution(CodeLensContribution.ID);\n            if (!codelensController) {\n                return;\n            }\n            const model = codelensController.getModel();\n            if (!model) {\n                // nothing\n                return;\n            }\n            const items = [];\n            for (const lens of model.lenses) {\n                if (lens.symbol.command && lens.symbol.range.startLineNumber === lineNumber) {\n                    items.push({\n                        label: lens.symbol.command.title,\n                        command: lens.symbol.command\n                    });\n                }\n            }\n            if (items.length === 0) {\n                // We dont want an empty picker\n                return;\n            }\n            const item = yield quickInputService.pick(items, { canPickMany: false });\n            if (!item) {\n                // Nothing picked\n                return;\n            }\n            if (model.isDisposed) {\n                // retry whenever the model has been disposed\n                return yield commandService.executeCommand(this.id);\n            }\n            try {\n                yield commandService.executeCommand(item.command.id, ...(item.command.arguments || []));\n            }\n            catch (err) {\n                notificationService.error(err);\n            }\n        });\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function getColors(registry, model, token) {\n    const colors = [];\n    const providers = registry.ordered(model).reverse();\n    const promises = providers.map(provider => Promise.resolve(provider.provideDocumentColors(model, token)).then(result => {\n        if (Array.isArray(result)) {\n            for (const colorInfo of result) {\n                colors.push({ colorInfo, provider });\n            }\n        }\n    }));\n    return Promise.all(promises).then(() => colors);\n}\nexport function getColorPresentations(model, colorInfo, provider, token) {\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\n}\nCommandsRegistry.registerCommand('_executeDocumentColorProvider', function (accessor, ...args) {\n    const [resource] = args;\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const { colorProvider: colorProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const rawCIs = [];\n    const providers = colorProviderRegistry.ordered(model).reverse();\n    const promises = providers.map(provider => Promise.resolve(provider.provideDocumentColors(model, CancellationToken.None)).then(result => {\n        if (Array.isArray(result)) {\n            for (const ci of result) {\n                rawCIs.push({ range: ci.range, color: [ci.color.red, ci.color.green, ci.color.blue, ci.color.alpha] });\n            }\n        }\n    }));\n    return Promise.all(promises).then(() => rawCIs);\n});\nCommandsRegistry.registerCommand('_executeColorPresentationProvider', function (accessor, ...args) {\n    const [color, context] = args;\n    const { uri, range } = context;\n    if (!(uri instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\n        throw illegalArgument();\n    }\n    const [red, green, blue, alpha] = color;\n    const { colorProvider: colorProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const colorInfo = {\n        range,\n        color: { red, green, blue, alpha }\n    };\n    const presentations = [];\n    const providers = colorProviderRegistry.ordered(model).reverse();\n    const promises = providers.map(provider => Promise.resolve(provider.provideColorPresentations(model, colorInfo, CancellationToken.None)).then(result => {\n        if (Array.isArray(result)) {\n            presentations.push(...result);\n        }\n    }));\n    return Promise.all(promises).then(() => presentations);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, TimeoutTimer } from '../../../../base/common/async.js';\nimport { RGBA } from '../../../../base/common/color.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { noBreakWhitespace } from '../../../../base/common/strings.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getColors } from './color.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport const ColorDecorationInjectedTextMarker = Object.create({});\nconst MAX_DECORATORS = 500;\nlet ColorDetector = class ColorDetector extends Disposable {\n    constructor(_editor, _configurationService, _languageFeaturesService, languageFeatureDebounceService) {\n        super();\n        this._editor = _editor;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._localToDispose = this._register(new DisposableStore());\n        this._decorationsIds = [];\n        this._colorDatas = new Map();\n        this._colorDecoratorIds = this._editor.createDecorationsCollection();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._colorDecorationClassRefs = this._register(new DisposableStore());\n        this._debounceInformation = languageFeatureDebounceService.for(_languageFeaturesService.colorProvider, 'Document Colors', { min: ColorDetector.RECOMPUTE_TIME });\n        this._register(_editor.onDidChangeModel(() => {\n            this._isEnabled = this.isEnabled();\n            this.onModelChanged();\n        }));\n        this._register(_editor.onDidChangeModelLanguage(() => this.onModelChanged()));\n        this._register(_languageFeaturesService.colorProvider.onDidChange(() => this.onModelChanged()));\n        this._register(_editor.onDidChangeConfiguration(() => {\n            const prevIsEnabled = this._isEnabled;\n            this._isEnabled = this.isEnabled();\n            if (prevIsEnabled !== this._isEnabled) {\n                if (this._isEnabled) {\n                    this.onModelChanged();\n                }\n                else {\n                    this.removeAllDecorations();\n                }\n            }\n        }));\n        this._timeoutTimer = null;\n        this._computePromise = null;\n        this._isEnabled = this.isEnabled();\n        this.onModelChanged();\n    }\n    isEnabled() {\n        const model = this._editor.getModel();\n        if (!model) {\n            return false;\n        }\n        const languageId = model.getLanguageId();\n        // handle deprecated settings. [languageId].colorDecorators.enable\n        const deprecatedConfig = this._configurationService.getValue(languageId);\n        if (deprecatedConfig && typeof deprecatedConfig === 'object') {\n            const colorDecorators = deprecatedConfig['colorDecorators']; // deprecatedConfig.valueOf('.colorDecorators.enable');\n            if (colorDecorators && colorDecorators['enable'] !== undefined && !colorDecorators['enable']) {\n                return colorDecorators['enable'];\n            }\n        }\n        return this._editor.getOption(17 /* EditorOption.colorDecorators */);\n    }\n    static get(editor) {\n        return editor.getContribution(this.ID);\n    }\n    dispose() {\n        this.stop();\n        this.removeAllDecorations();\n        super.dispose();\n    }\n    onModelChanged() {\n        this.stop();\n        if (!this._isEnabled) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.colorProvider.has(model)) {\n            return;\n        }\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n            if (!this._timeoutTimer) {\n                this._timeoutTimer = new TimeoutTimer();\n                this._timeoutTimer.cancelAndSet(() => {\n                    this._timeoutTimer = null;\n                    this.beginCompute();\n                }, this._debounceInformation.get(model));\n            }\n        }));\n        this.beginCompute();\n    }\n    beginCompute() {\n        this._computePromise = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n            const model = this._editor.getModel();\n            if (!model) {\n                return Promise.resolve([]);\n            }\n            const sw = new StopWatch(false);\n            const colors = yield getColors(this._languageFeaturesService.colorProvider, model, token);\n            this._debounceInformation.update(model, sw.elapsed());\n            return colors;\n        }));\n        this._computePromise.then((colorInfos) => {\n            this.updateDecorations(colorInfos);\n            this.updateColorDecorators(colorInfos);\n            this._computePromise = null;\n        }, onUnexpectedError);\n    }\n    stop() {\n        if (this._timeoutTimer) {\n            this._timeoutTimer.cancel();\n            this._timeoutTimer = null;\n        }\n        if (this._computePromise) {\n            this._computePromise.cancel();\n            this._computePromise = null;\n        }\n        this._localToDispose.clear();\n    }\n    updateDecorations(colorDatas) {\n        const decorations = colorDatas.map(c => ({\n            range: {\n                startLineNumber: c.colorInfo.range.startLineNumber,\n                startColumn: c.colorInfo.range.startColumn,\n                endLineNumber: c.colorInfo.range.endLineNumber,\n                endColumn: c.colorInfo.range.endColumn\n            },\n            options: ModelDecorationOptions.EMPTY\n        }));\n        this._editor.changeDecorations((changeAccessor) => {\n            this._decorationsIds = changeAccessor.deltaDecorations(this._decorationsIds, decorations);\n            this._colorDatas = new Map();\n            this._decorationsIds.forEach((id, i) => this._colorDatas.set(id, colorDatas[i]));\n        });\n    }\n    updateColorDecorators(colorData) {\n        this._colorDecorationClassRefs.clear();\n        const decorations = [];\n        for (let i = 0; i < colorData.length && decorations.length < MAX_DECORATORS; i++) {\n            const { red, green, blue, alpha } = colorData[i].colorInfo.color;\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n            const color = `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n            const ref = this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({\n                backgroundColor: color\n            }));\n            decorations.push({\n                range: {\n                    startLineNumber: colorData[i].colorInfo.range.startLineNumber,\n                    startColumn: colorData[i].colorInfo.range.startColumn,\n                    endLineNumber: colorData[i].colorInfo.range.endLineNumber,\n                    endColumn: colorData[i].colorInfo.range.endColumn\n                },\n                options: {\n                    description: 'colorDetector',\n                    before: {\n                        content: noBreakWhitespace,\n                        inlineClassName: `${ref.className} colorpicker-color-decoration`,\n                        inlineClassNameAffectsLetterSpacing: true,\n                        attachedData: ColorDecorationInjectedTextMarker\n                    }\n                }\n            });\n        }\n        this._colorDecoratorIds.set(decorations);\n    }\n    removeAllDecorations() {\n        this._editor.removeDecorations(this._decorationsIds);\n        this._decorationsIds = [];\n        this._colorDecoratorIds.clear();\n        this._colorDecorationClassRefs.clear();\n    }\n    getColorData(position) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return null;\n        }\n        const decorations = model\n            .getDecorationsInRange(Range.fromPositions(position, position))\n            .filter(d => this._colorDatas.has(d.id));\n        if (decorations.length === 0) {\n            return null;\n        }\n        return this._colorDatas.get(decorations[0].id);\n    }\n    isColorDecoration(decoration) {\n        return this._colorDecoratorIds.has(decoration);\n    }\n};\nColorDetector.ID = 'editor.contrib.colorDetector';\nColorDetector.RECOMPUTE_TIME = 1000; // ms\nColorDetector = __decorate([\n    __param(1, IConfigurationService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ILanguageFeatureDebounceService)\n], ColorDetector);\nexport { ColorDetector };\nregisterEditorContribution(ColorDetector.ID, ColorDetector);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nexport class ColorPickerModel {\n    constructor(color, availableColorPresentations, presentationIndex) {\n        this.presentationIndex = presentationIndex;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this._onDidChangeColor = new Emitter();\n        this.onDidChangeColor = this._onDidChangeColor.event;\n        this._onDidChangePresentation = new Emitter();\n        this.onDidChangePresentation = this._onDidChangePresentation.event;\n        this.originalColor = color;\n        this._color = color;\n        this._colorPresentations = availableColorPresentations;\n    }\n    get color() {\n        return this._color;\n    }\n    set color(color) {\n        if (this._color.equals(color)) {\n            return;\n        }\n        this._color = color;\n        this._onDidChangeColor.fire(color);\n    }\n    get presentation() { return this.colorPresentations[this.presentationIndex]; }\n    get colorPresentations() {\n        return this._colorPresentations;\n    }\n    set colorPresentations(colorPresentations) {\n        this._colorPresentations = colorPresentations;\n        if (this.presentationIndex > colorPresentations.length - 1) {\n            this.presentationIndex = 0;\n        }\n        this._onDidChangePresentation.fire(this.presentation);\n    }\n    selectNextColorPresentation() {\n        this.presentationIndex = (this.presentationIndex + 1) % this.colorPresentations.length;\n        this.flushColor();\n        this._onDidChangePresentation.fire(this.presentation);\n    }\n    guessColorPresentation(color, originalText) {\n        for (let i = 0; i < this.colorPresentations.length; i++) {\n            if (originalText.toLowerCase() === this.colorPresentations[i].label) {\n                this.presentationIndex = i;\n                this._onDidChangePresentation.fire(this.presentation);\n                break;\n            }\n        }\n    }\n    flushColor() {\n        this._onColorFlushed.fire(this._color);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PixelRatio } from '../../../../base/browser/browser.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { GlobalPointerMoveMonitor } from '../../../../base/browser/globalPointerMoveMonitor.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Color, HSVA, RGBA } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport './colorPicker.css';\nimport { localize } from '../../../../nls.js';\nimport { editorHoverBackground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nconst $ = dom.$;\nexport class ColorPickerHeader extends Disposable {\n    constructor(container, model, themeService) {\n        super();\n        this.model = model;\n        this.domNode = $('.colorpicker-header');\n        dom.append(container, this.domNode);\n        this.pickedColorNode = dom.append(this.domNode, $('.picked-color'));\n        const tooltip = localize('clickToToggleColorOptions', \"Click to toggle color options (rgb/hsl/hex)\");\n        this.pickedColorNode.setAttribute('title', tooltip);\n        const colorBox = dom.append(this.domNode, $('.original-color'));\n        colorBox.style.backgroundColor = Color.Format.CSS.format(this.model.originalColor) || '';\n        this.backgroundColor = themeService.getColorTheme().getColor(editorHoverBackground) || Color.white;\n        this._register(registerThemingParticipant((theme, collector) => {\n            this.backgroundColor = theme.getColor(editorHoverBackground) || Color.white;\n        }));\n        this._register(dom.addDisposableListener(this.pickedColorNode, dom.EventType.CLICK, () => this.model.selectNextColorPresentation()));\n        this._register(dom.addDisposableListener(colorBox, dom.EventType.CLICK, () => {\n            this.model.color = this.model.originalColor;\n            this.model.flushColor();\n        }));\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\n        this._register(model.onDidChangePresentation(this.onDidChangePresentation, this));\n        this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(model.color) || '';\n        this.pickedColorNode.classList.toggle('light', model.color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : model.color.isLighter());\n        this.onDidChangeColor(this.model.color);\n    }\n    onDidChangeColor(color) {\n        this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(color) || '';\n        this.pickedColorNode.classList.toggle('light', color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : color.isLighter());\n        this.onDidChangePresentation();\n    }\n    onDidChangePresentation() {\n        this.pickedColorNode.textContent = this.model.presentation ? this.model.presentation.label : '';\n        this.pickedColorNode.prepend($('.codicon.codicon-color-mode'));\n    }\n}\nexport class ColorPickerBody extends Disposable {\n    constructor(container, model, pixelRatio) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this.domNode = $('.colorpicker-body');\n        dom.append(container, this.domNode);\n        this.saturationBox = new SaturationBox(this.domNode, this.model, this.pixelRatio);\n        this._register(this.saturationBox);\n        this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange, this));\n        this._register(this.saturationBox.onColorFlushed(this.flushColor, this));\n        this.opacityStrip = new OpacityStrip(this.domNode, this.model);\n        this._register(this.opacityStrip);\n        this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange, this));\n        this._register(this.opacityStrip.onColorFlushed(this.flushColor, this));\n        this.hueStrip = new HueStrip(this.domNode, this.model);\n        this._register(this.hueStrip);\n        this._register(this.hueStrip.onDidChange(this.onDidHueChange, this));\n        this._register(this.hueStrip.onColorFlushed(this.flushColor, this));\n    }\n    flushColor() {\n        this.model.flushColor();\n    }\n    onDidSaturationValueChange({ s, v }) {\n        const hsva = this.model.color.hsva;\n        this.model.color = new Color(new HSVA(hsva.h, s, v, hsva.a));\n    }\n    onDidOpacityChange(a) {\n        const hsva = this.model.color.hsva;\n        this.model.color = new Color(new HSVA(hsva.h, hsva.s, hsva.v, a));\n    }\n    onDidHueChange(value) {\n        const hsva = this.model.color.hsva;\n        const h = (1 - value) * 360;\n        this.model.color = new Color(new HSVA(h === 360 ? 0 : h, hsva.s, hsva.v, hsva.a));\n    }\n    layout() {\n        this.saturationBox.layout();\n        this.opacityStrip.layout();\n        this.hueStrip.layout();\n    }\n}\nclass SaturationBox extends Disposable {\n    constructor(container, model, pixelRatio) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this.domNode = $('.saturation-wrap');\n        dom.append(container, this.domNode);\n        // Create canvas, draw selected color\n        this.canvas = document.createElement('canvas');\n        this.canvas.className = 'saturation-box';\n        dom.append(this.domNode, this.canvas);\n        // Add selection circle\n        this.selection = $('.saturation-selection');\n        dom.append(this.domNode, this.selection);\n        this.layout();\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.POINTER_DOWN, e => this.onPointerDown(e)));\n        this._register(this.model.onDidChangeColor(this.onDidChangeColor, this));\n        this.monitor = null;\n    }\n    onPointerDown(e) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        this.monitor = this._register(new GlobalPointerMoveMonitor());\n        const origin = dom.getDomNodePagePosition(this.domNode);\n        if (e.target !== this.selection) {\n            this.onDidChangePosition(e.offsetX, e.offsetY);\n        }\n        this.monitor.startMonitoring(e.target, e.pointerId, e.buttons, event => this.onDidChangePosition(event.pageX - origin.left, event.pageY - origin.top), () => null);\n        const pointerUpListener = dom.addDisposableListener(document, dom.EventType.POINTER_UP, () => {\n            this._onColorFlushed.fire();\n            pointerUpListener.dispose();\n            if (this.monitor) {\n                this.monitor.stopMonitoring(true);\n                this.monitor = null;\n            }\n        }, true);\n    }\n    onDidChangePosition(left, top) {\n        const s = Math.max(0, Math.min(1, left / this.width));\n        const v = Math.max(0, Math.min(1, 1 - (top / this.height)));\n        this.paintSelection(s, v);\n        this._onDidChange.fire({ s, v });\n    }\n    layout() {\n        this.width = this.domNode.offsetWidth;\n        this.height = this.domNode.offsetHeight;\n        this.canvas.width = this.width * this.pixelRatio;\n        this.canvas.height = this.height * this.pixelRatio;\n        this.paint();\n        const hsva = this.model.color.hsva;\n        this.paintSelection(hsva.s, hsva.v);\n    }\n    paint() {\n        const hsva = this.model.color.hsva;\n        const saturatedColor = new Color(new HSVA(hsva.h, 1, 1, 1));\n        const ctx = this.canvas.getContext('2d');\n        const whiteGradient = ctx.createLinearGradient(0, 0, this.canvas.width, 0);\n        whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\n        whiteGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.5)');\n        whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n        const blackGradient = ctx.createLinearGradient(0, 0, 0, this.canvas.height);\n        blackGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n        blackGradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\n        ctx.rect(0, 0, this.canvas.width, this.canvas.height);\n        ctx.fillStyle = Color.Format.CSS.format(saturatedColor);\n        ctx.fill();\n        ctx.fillStyle = whiteGradient;\n        ctx.fill();\n        ctx.fillStyle = blackGradient;\n        ctx.fill();\n    }\n    paintSelection(s, v) {\n        this.selection.style.left = `${s * this.width}px`;\n        this.selection.style.top = `${this.height - v * this.height}px`;\n    }\n    onDidChangeColor() {\n        if (this.monitor && this.monitor.isMonitoring()) {\n            return;\n        }\n        this.paint();\n    }\n}\nclass Strip extends Disposable {\n    constructor(container, model) {\n        super();\n        this.model = model;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this.domNode = dom.append(container, $('.strip'));\n        this.overlay = dom.append(this.domNode, $('.overlay'));\n        this.slider = dom.append(this.domNode, $('.slider'));\n        this.slider.style.top = `0px`;\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.POINTER_DOWN, e => this.onPointerDown(e)));\n        this.layout();\n    }\n    layout() {\n        this.height = this.domNode.offsetHeight - this.slider.offsetHeight;\n        const value = this.getValue(this.model.color);\n        this.updateSliderPosition(value);\n    }\n    onPointerDown(e) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const monitor = this._register(new GlobalPointerMoveMonitor());\n        const origin = dom.getDomNodePagePosition(this.domNode);\n        this.domNode.classList.add('grabbing');\n        if (e.target !== this.slider) {\n            this.onDidChangeTop(e.offsetY);\n        }\n        monitor.startMonitoring(e.target, e.pointerId, e.buttons, event => this.onDidChangeTop(event.pageY - origin.top), () => null);\n        const pointerUpListener = dom.addDisposableListener(document, dom.EventType.POINTER_UP, () => {\n            this._onColorFlushed.fire();\n            pointerUpListener.dispose();\n            monitor.stopMonitoring(true);\n            this.domNode.classList.remove('grabbing');\n        }, true);\n    }\n    onDidChangeTop(top) {\n        const value = Math.max(0, Math.min(1, 1 - (top / this.height)));\n        this.updateSliderPosition(value);\n        this._onDidChange.fire(value);\n    }\n    updateSliderPosition(value) {\n        this.slider.style.top = `${(1 - value) * this.height}px`;\n    }\n}\nclass OpacityStrip extends Strip {\n    constructor(container, model) {\n        super(container, model);\n        this.domNode.classList.add('opacity-strip');\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\n        this.onDidChangeColor(this.model.color);\n    }\n    onDidChangeColor(color) {\n        const { r, g, b } = color.rgba;\n        const opaque = new Color(new RGBA(r, g, b, 1));\n        const transparent = new Color(new RGBA(r, g, b, 0));\n        this.overlay.style.background = `linear-gradient(to bottom, ${opaque} 0%, ${transparent} 100%)`;\n    }\n    getValue(color) {\n        return color.hsva.a;\n    }\n}\nclass HueStrip extends Strip {\n    constructor(container, model) {\n        super(container, model);\n        this.domNode.classList.add('hue-strip');\n    }\n    getValue(color) {\n        return 1 - (color.hsva.h / 360);\n    }\n}\nexport class ColorPickerWidget extends Widget {\n    constructor(container, model, pixelRatio, themeService) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._register(PixelRatio.onDidChange(() => this.layout()));\n        const element = $('.colorpicker-widget');\n        container.appendChild(element);\n        const header = new ColorPickerHeader(element, this.model, themeService);\n        this.body = new ColorPickerBody(element, this.model, this.pixelRatio);\n        this._register(header);\n        this._register(this.body);\n    }\n    layout() {\n        this.body.layout();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getColorPresentations } from './color.js';\nimport { ColorDetector } from './colorDetector.js';\nimport { ColorPickerModel } from './colorPickerModel.js';\nimport { ColorPickerWidget } from './colorPickerWidget.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport class ColorHover {\n    constructor(owner, range, model, provider) {\n        this.owner = owner;\n        this.range = range;\n        this.model = model;\n        this.provider = provider;\n        /**\n         * Force the hover to always be rendered at this specific range,\n         * even in the case of multiple hover parts.\n         */\n        this.forceShowAtRange = true;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet ColorHoverParticipant = class ColorHoverParticipant {\n    constructor(_editor, _themeService) {\n        this._editor = _editor;\n        this._themeService = _themeService;\n        this.hoverOrdinal = 1;\n    }\n    computeSync(anchor, lineDecorations) {\n        return [];\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        return AsyncIterableObject.fromPromise(this._computeAsync(anchor, lineDecorations, token));\n    }\n    _computeAsync(anchor, lineDecorations, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                return [];\n            }\n            const colorDetector = ColorDetector.get(this._editor);\n            if (!colorDetector) {\n                return [];\n            }\n            for (const d of lineDecorations) {\n                if (!colorDetector.isColorDecoration(d)) {\n                    continue;\n                }\n                const colorData = colorDetector.getColorData(d.range.getStartPosition());\n                if (colorData) {\n                    const colorHover = yield this._createColorHover(this._editor.getModel(), colorData.colorInfo, colorData.provider);\n                    return [colorHover];\n                }\n            }\n            return [];\n        });\n    }\n    _createColorHover(editorModel, colorInfo, provider) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const originalText = editorModel.getValueInRange(colorInfo.range);\n            const { red, green, blue, alpha } = colorInfo.color;\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n            const color = new Color(rgba);\n            const colorPresentations = yield getColorPresentations(editorModel, colorInfo, provider, CancellationToken.None);\n            const model = new ColorPickerModel(color, [], 0);\n            model.colorPresentations = colorPresentations || [];\n            model.guessColorPresentation(color, originalText);\n            return new ColorHover(this, Range.lift(colorInfo.range), model, provider);\n        });\n    }\n    renderHoverParts(context, hoverParts) {\n        if (hoverParts.length === 0 || !this._editor.hasModel()) {\n            return Disposable.None;\n        }\n        const disposables = new DisposableStore();\n        const colorHover = hoverParts[0];\n        const editorModel = this._editor.getModel();\n        const model = colorHover.model;\n        const widget = disposables.add(new ColorPickerWidget(context.fragment, model, this._editor.getOption(131 /* EditorOption.pixelRatio */), this._themeService));\n        context.setColorPicker(widget);\n        let range = new Range(colorHover.range.startLineNumber, colorHover.range.startColumn, colorHover.range.endLineNumber, colorHover.range.endColumn);\n        const updateEditorModel = () => {\n            let textEdits;\n            let newRange;\n            if (model.presentation.textEdit) {\n                textEdits = [model.presentation.textEdit];\n                newRange = new Range(model.presentation.textEdit.range.startLineNumber, model.presentation.textEdit.range.startColumn, model.presentation.textEdit.range.endLineNumber, model.presentation.textEdit.range.endColumn);\n                const trackedRange = this._editor.getModel()._setTrackedRange(null, newRange, 3 /* TrackedRangeStickiness.GrowsOnlyWhenTypingAfter */);\n                this._editor.pushUndoStop();\n                this._editor.executeEdits('colorpicker', textEdits);\n                newRange = this._editor.getModel()._getTrackedRange(trackedRange) || newRange;\n            }\n            else {\n                textEdits = [{ range, text: model.presentation.label, forceMoveMarkers: false }];\n                newRange = range.setEndPosition(range.endLineNumber, range.startColumn + model.presentation.label.length);\n                this._editor.pushUndoStop();\n                this._editor.executeEdits('colorpicker', textEdits);\n            }\n            if (model.presentation.additionalTextEdits) {\n                textEdits = [...model.presentation.additionalTextEdits];\n                this._editor.executeEdits('colorpicker', textEdits);\n                context.hide();\n            }\n            this._editor.pushUndoStop();\n            range = newRange;\n        };\n        const updateColorPresentations = (color) => {\n            return getColorPresentations(editorModel, {\n                range: range,\n                color: {\n                    red: color.rgba.r / 255,\n                    green: color.rgba.g / 255,\n                    blue: color.rgba.b / 255,\n                    alpha: color.rgba.a\n                }\n            }, colorHover.provider, CancellationToken.None).then((colorPresentations) => {\n                model.colorPresentations = colorPresentations || [];\n            });\n        };\n        disposables.add(model.onColorFlushed((color) => {\n            updateColorPresentations(color).then(updateEditorModel);\n        }));\n        disposables.add(model.onDidChangeColor(updateColorPresentations));\n        return disposables;\n    }\n};\nColorHoverParticipant = __decorate([\n    __param(1, IThemeService)\n], ColorHoverParticipant);\nexport { ColorHoverParticipant };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor) {\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._opts = createOptions(this._editor.getOption(72 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(72 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(72 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as objects from '../../../base/common/objects.js';\nimport { ICodeEditorService } from '../services/codeEditorService.js';\nimport { CodeEditorWidget } from './codeEditorWidget.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\nlet EmbeddedCodeEditorWidget = class EmbeddedCodeEditorWidget extends CodeEditorWidget {\n    constructor(domElement, options, parentEditor, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService) {\n        super(domElement, Object.assign(Object.assign({}, parentEditor.getRawOptions()), { overflowWidgetsDomNode: parentEditor.getOverflowWidgetsDomNode() }), {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService);\n        this._parentEditor = parentEditor;\n        this._overwriteOptions = options;\n        // Overwrite parent's options\n        super.updateOptions(this._overwriteOptions);\n        this._register(parentEditor.onDidChangeConfiguration((e) => this._onParentConfigurationChanged(e)));\n    }\n    getParentEditor() {\n        return this._parentEditor;\n    }\n    _onParentConfigurationChanged(e) {\n        super.updateOptions(this._parentEditor.getRawOptions());\n        super.updateOptions(this._overwriteOptions);\n    }\n    updateOptions(newOptions) {\n        objects.mixin(this._overwriteOptions, newOptions, true);\n        super.updateOptions(this._overwriteOptions);\n    }\n};\nEmbeddedCodeEditorWidget = __decorate([\n    __param(3, IInstantiationService),\n    __param(4, ICodeEditorService),\n    __param(5, ICommandService),\n    __param(6, IContextKeyService),\n    __param(7, IThemeService),\n    __param(8, INotificationService),\n    __param(9, IAccessibilityService),\n    __param(10, ILanguageConfigurationService),\n    __param(11, ILanguageFeaturesService)\n], EmbeddedCodeEditorWidget);\nexport { EmbeddedCodeEditorWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Sash } from '../../../../base/browser/ui/sash/sash.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { IdGenerator } from '../../../../base/common/idGenerator.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as objects from '../../../../base/common/objects.js';\nimport './zoneWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nconst defaultColor = new Color(new RGBA(0, 122, 204));\nconst defaultOptions = {\n    showArrow: true,\n    showFrame: true,\n    className: '',\n    frameColor: defaultColor,\n    arrowColor: defaultColor,\n    keepEditorSelection: false\n};\nconst WIDGET_ID = 'vs.editor.contrib.zoneWidget';\nexport class ViewZoneDelegate {\n    constructor(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight) {\n        this.id = ''; // A valid zone id should be greater than 0\n        this.domNode = domNode;\n        this.afterLineNumber = afterLineNumber;\n        this.afterColumn = afterColumn;\n        this.heightInLines = heightInLines;\n        this._onDomNodeTop = onDomNodeTop;\n        this._onComputedHeight = onComputedHeight;\n    }\n    onDomNodeTop(top) {\n        this._onDomNodeTop(top);\n    }\n    onComputedHeight(height) {\n        this._onComputedHeight(height);\n    }\n}\nexport class OverlayWidgetDelegate {\n    constructor(id, domNode) {\n        this._id = id;\n        this._domNode = domNode;\n    }\n    getId() {\n        return this._id;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return null;\n    }\n}\nclass Arrow {\n    constructor(_editor) {\n        this._editor = _editor;\n        this._ruleName = Arrow._IdGenerator.nextId();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._color = null;\n        this._height = -1;\n    }\n    dispose() {\n        this.hide();\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n    }\n    set color(value) {\n        if (this._color !== value) {\n            this._color = value;\n            this._updateStyle();\n        }\n    }\n    set height(value) {\n        if (this._height !== value) {\n            this._height = value;\n            this._updateStyle();\n        }\n    }\n    _updateStyle() {\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n        dom.createCSSRule(`.monaco-editor ${this._ruleName}`, `border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `);\n    }\n    show(where) {\n        if (where.column === 1) {\n            // the arrow isn't pretty at column 1 and we need to push it out a little\n            where = { lineNumber: where.lineNumber, column: 2 };\n        }\n        this._decorations.set([{\n                range: Range.fromPositions(where),\n                options: {\n                    description: 'zone-widget-arrow',\n                    className: this._ruleName,\n                    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n                }\n            }]);\n    }\n    hide() {\n        this._decorations.clear();\n    }\n}\nArrow._IdGenerator = new IdGenerator('.arrow-decoration-');\nexport class ZoneWidget {\n    constructor(editor, options = {}) {\n        this._arrow = null;\n        this._overlayWidget = null;\n        this._resizeSash = null;\n        this._viewZone = null;\n        this._disposables = new DisposableStore();\n        this.container = null;\n        this._isShowing = false;\n        this.editor = editor;\n        this._positionMarkerId = this.editor.createDecorationsCollection();\n        this.options = objects.deepClone(options);\n        objects.mixin(this.options, defaultOptions, false);\n        this.domNode = document.createElement('div');\n        if (!this.options.isAccessible) {\n            this.domNode.setAttribute('aria-hidden', 'true');\n            this.domNode.setAttribute('role', 'presentation');\n        }\n        this._disposables.add(this.editor.onDidLayoutChange((info) => {\n            const width = this._getWidth(info);\n            this.domNode.style.width = width + 'px';\n            this.domNode.style.left = this._getLeft(info) + 'px';\n            this._onWidth(width);\n        }));\n    }\n    dispose() {\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        if (this._viewZone) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    accessor.removeZone(this._viewZone.id);\n                }\n                this._viewZone = null;\n            });\n        }\n        this._positionMarkerId.clear();\n        this._disposables.dispose();\n    }\n    create() {\n        this.domNode.classList.add('zone-widget');\n        if (this.options.className) {\n            this.domNode.classList.add(this.options.className);\n        }\n        this.container = document.createElement('div');\n        this.container.classList.add('zone-widget-container');\n        this.domNode.appendChild(this.container);\n        if (this.options.showArrow) {\n            this._arrow = new Arrow(this.editor);\n            this._disposables.add(this._arrow);\n        }\n        this._fillContainer(this.container);\n        this._initSash();\n        this._applyStyles();\n    }\n    style(styles) {\n        if (styles.frameColor) {\n            this.options.frameColor = styles.frameColor;\n        }\n        if (styles.arrowColor) {\n            this.options.arrowColor = styles.arrowColor;\n        }\n        this._applyStyles();\n    }\n    _applyStyles() {\n        if (this.container && this.options.frameColor) {\n            const frameColor = this.options.frameColor.toString();\n            this.container.style.borderTopColor = frameColor;\n            this.container.style.borderBottomColor = frameColor;\n        }\n        if (this._arrow && this.options.arrowColor) {\n            const arrowColor = this.options.arrowColor.toString();\n            this._arrow.color = arrowColor;\n        }\n    }\n    _getWidth(info) {\n        return info.width - info.minimap.minimapWidth - info.verticalScrollbarWidth;\n    }\n    _getLeft(info) {\n        // If minimap is to the left, we move beyond it\n        if (info.minimap.minimapWidth > 0 && info.minimap.minimapLeft === 0) {\n            return info.minimap.minimapWidth;\n        }\n        return 0;\n    }\n    _onViewZoneTop(top) {\n        this.domNode.style.top = top + 'px';\n    }\n    _onViewZoneHeight(height) {\n        this.domNode.style.height = `${height}px`;\n        if (this.container) {\n            const containerHeight = height - this._decoratingElementsHeight();\n            this.container.style.height = `${containerHeight}px`;\n            const layoutInfo = this.editor.getLayoutInfo();\n            this._doLayout(containerHeight, this._getWidth(layoutInfo));\n        }\n        if (this._resizeSash) {\n            this._resizeSash.layout();\n        }\n    }\n    get position() {\n        const range = this._positionMarkerId.getRange(0);\n        if (!range) {\n            return undefined;\n        }\n        return range.getStartPosition();\n    }\n    show(rangeOrPos, heightInLines) {\n        const range = Range.isIRange(rangeOrPos) ? Range.lift(rangeOrPos) : Range.fromPositions(rangeOrPos);\n        this._isShowing = true;\n        this._showImpl(range, heightInLines);\n        this._isShowing = false;\n        this._positionMarkerId.set([{ range, options: ModelDecorationOptions.EMPTY }]);\n    }\n    hide() {\n        if (this._viewZone) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    accessor.removeZone(this._viewZone.id);\n                }\n            });\n            this._viewZone = null;\n        }\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        if (this._arrow) {\n            this._arrow.hide();\n        }\n    }\n    _decoratingElementsHeight() {\n        const lineHeight = this.editor.getOption(61 /* EditorOption.lineHeight */);\n        let result = 0;\n        if (this.options.showArrow) {\n            const arrowHeight = Math.round(lineHeight / 3);\n            result += 2 * arrowHeight;\n        }\n        if (this.options.showFrame) {\n            const frameThickness = Math.round(lineHeight / 9);\n            result += 2 * frameThickness;\n        }\n        return result;\n    }\n    _showImpl(where, heightInLines) {\n        const position = where.getStartPosition();\n        const layoutInfo = this.editor.getLayoutInfo();\n        const width = this._getWidth(layoutInfo);\n        this.domNode.style.width = `${width}px`;\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\n        // Render the widget as zone (rendering) and widget (lifecycle)\n        const viewZoneDomNode = document.createElement('div');\n        viewZoneDomNode.style.overflow = 'hidden';\n        const lineHeight = this.editor.getOption(61 /* EditorOption.lineHeight */);\n        // adjust heightInLines to viewport\n        const maxHeightInLines = Math.max(12, (this.editor.getLayoutInfo().height / lineHeight) * 0.8);\n        heightInLines = Math.min(heightInLines, maxHeightInLines);\n        let arrowHeight = 0;\n        let frameThickness = 0;\n        // Render the arrow one 1/3 of an editor line height\n        if (this._arrow && this.options.showArrow) {\n            arrowHeight = Math.round(lineHeight / 3);\n            this._arrow.height = arrowHeight;\n            this._arrow.show(position);\n        }\n        // Render the frame as 1/9 of an editor line height\n        if (this.options.showFrame) {\n            frameThickness = Math.round(lineHeight / 9);\n        }\n        // insert zone widget\n        this.editor.changeViewZones((accessor) => {\n            if (this._viewZone) {\n                accessor.removeZone(this._viewZone.id);\n            }\n            if (this._overlayWidget) {\n                this.editor.removeOverlayWidget(this._overlayWidget);\n                this._overlayWidget = null;\n            }\n            this.domNode.style.top = '-1000px';\n            this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, (top) => this._onViewZoneTop(top), (height) => this._onViewZoneHeight(height));\n            this._viewZone.id = accessor.addZone(this._viewZone);\n            this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + this._viewZone.id, this.domNode);\n            this.editor.addOverlayWidget(this._overlayWidget);\n        });\n        if (this.container && this.options.showFrame) {\n            const width = this.options.frameWidth ? this.options.frameWidth : frameThickness;\n            this.container.style.borderTopWidth = width + 'px';\n            this.container.style.borderBottomWidth = width + 'px';\n        }\n        const containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\n        if (this.container) {\n            this.container.style.top = arrowHeight + 'px';\n            this.container.style.height = containerHeight + 'px';\n            this.container.style.overflow = 'hidden';\n        }\n        this._doLayout(containerHeight, width);\n        if (!this.options.keepEditorSelection) {\n            this.editor.setSelection(where);\n        }\n        const model = this.editor.getModel();\n        if (model) {\n            const revealLine = where.endLineNumber + 1;\n            if (revealLine <= model.getLineCount()) {\n                // reveal line below the zone widget\n                this.revealLine(revealLine, false);\n            }\n            else {\n                // reveal last line atop\n                this.revealLine(model.getLineCount(), true);\n            }\n        }\n    }\n    revealLine(lineNumber, isLastLine) {\n        if (isLastLine) {\n            this.editor.revealLineInCenter(lineNumber, 0 /* ScrollType.Smooth */);\n        }\n        else {\n            this.editor.revealLine(lineNumber, 0 /* ScrollType.Smooth */);\n        }\n    }\n    setCssClass(className, classToReplace) {\n        if (!this.container) {\n            return;\n        }\n        if (classToReplace) {\n            this.container.classList.remove(classToReplace);\n        }\n        this.container.classList.add(className);\n    }\n    _onWidth(widthInPixel) {\n        // implement in subclass\n    }\n    _doLayout(heightInPixel, widthInPixel) {\n        // implement in subclass\n    }\n    _relayout(newHeightInLines) {\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    this._viewZone.heightInLines = newHeightInLines;\n                    accessor.layoutZone(this._viewZone.id);\n                }\n            });\n        }\n    }\n    // --- sash\n    _initSash() {\n        if (this._resizeSash) {\n            return;\n        }\n        this._resizeSash = this._disposables.add(new Sash(this.domNode, this, { orientation: 1 /* Orientation.HORIZONTAL */ }));\n        if (!this.options.isResizeable) {\n            this._resizeSash.state = 0 /* SashState.Disabled */;\n        }\n        let data;\n        this._disposables.add(this._resizeSash.onDidStart((e) => {\n            if (this._viewZone) {\n                data = {\n                    startY: e.startY,\n                    heightInLines: this._viewZone.heightInLines,\n                };\n            }\n        }));\n        this._disposables.add(this._resizeSash.onDidEnd(() => {\n            data = undefined;\n        }));\n        this._disposables.add(this._resizeSash.onDidChange((evt) => {\n            if (data) {\n                const lineDelta = (evt.currentY - data.startY) / this.editor.getOption(61 /* EditorOption.lineHeight */);\n                const roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\n                const newHeightInLines = data.heightInLines + roundedLineDelta;\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\n                    this._relayout(newHeightInLines);\n                }\n            }\n        }));\n    }\n    getHorizontalSashLeft() {\n        return 0;\n    }\n    getHorizontalSashTop() {\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\n    }\n    getHorizontalSashWidth() {\n        const layoutInfo = this.editor.getLayoutInfo();\n        return layoutInfo.width - layoutInfo.minimap.minimapWidth;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, addDisposableListener, append, EventHelper, EventType } from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { EventType as GestureEventType, Gesture } from '../../touch.js';\nimport { ActionRunner } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport './dropdown.css';\nexport class BaseDropdown extends ActionRunner {\n    constructor(container, options) {\n        super();\n        this._onDidChangeVisibility = this._register(new Emitter());\n        this.onDidChangeVisibility = this._onDidChangeVisibility.event;\n        this._element = append(container, $('.monaco-dropdown'));\n        this._label = append(this._element, $('.dropdown-label'));\n        let labelRenderer = options.labelRenderer;\n        if (!labelRenderer) {\n            labelRenderer = (container) => {\n                container.textContent = options.label || '';\n                return null;\n            };\n        }\n        for (const event of [EventType.CLICK, EventType.MOUSE_DOWN, GestureEventType.Tap]) {\n            this._register(addDisposableListener(this.element, event, e => EventHelper.stop(e, true))); // prevent default click behaviour to trigger\n        }\n        for (const event of [EventType.MOUSE_DOWN, GestureEventType.Tap]) {\n            this._register(addDisposableListener(this._label, event, e => {\n                if (e instanceof MouseEvent && (e.detail > 1 || e.button !== 0)) {\n                    // prevent right click trigger to allow separate context menu (https://github.com/microsoft/vscode/issues/151064)\n                    // prevent multiple clicks to open multiple context menus (https://github.com/microsoft/vscode/issues/41363)\n                    return;\n                }\n                if (this.visible) {\n                    this.hide();\n                }\n                else {\n                    this.show();\n                }\n            }));\n        }\n        this._register(addDisposableListener(this._label, EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(3 /* KeyCode.Enter */) || event.equals(10 /* KeyCode.Space */)) {\n                EventHelper.stop(e, true); // https://github.com/microsoft/vscode/issues/57997\n                if (this.visible) {\n                    this.hide();\n                }\n                else {\n                    this.show();\n                }\n            }\n        }));\n        const cleanupFn = labelRenderer(this._label);\n        if (cleanupFn) {\n            this._register(cleanupFn);\n        }\n        this._register(Gesture.addTarget(this._label));\n    }\n    get element() {\n        return this._element;\n    }\n    show() {\n        if (!this.visible) {\n            this.visible = true;\n            this._onDidChangeVisibility.fire(true);\n        }\n    }\n    hide() {\n        if (this.visible) {\n            this.visible = false;\n            this._onDidChangeVisibility.fire(false);\n        }\n    }\n    dispose() {\n        super.dispose();\n        this.hide();\n        if (this.boxContainer) {\n            this.boxContainer.remove();\n            this.boxContainer = undefined;\n        }\n        if (this.contents) {\n            this.contents.remove();\n            this.contents = undefined;\n        }\n        if (this._label) {\n            this._label.remove();\n            this._label = undefined;\n        }\n    }\n}\nexport class DropdownMenu extends BaseDropdown {\n    constructor(container, options) {\n        super(container, options);\n        this._actions = [];\n        this._contextMenuProvider = options.contextMenuProvider;\n        this.actions = options.actions || [];\n        this.actionProvider = options.actionProvider;\n        this.menuClassName = options.menuClassName || '';\n        this.menuAsChild = !!options.menuAsChild;\n    }\n    set menuOptions(options) {\n        this._menuOptions = options;\n    }\n    get menuOptions() {\n        return this._menuOptions;\n    }\n    get actions() {\n        if (this.actionProvider) {\n            return this.actionProvider.getActions();\n        }\n        return this._actions;\n    }\n    set actions(actions) {\n        this._actions = actions;\n    }\n    show() {\n        super.show();\n        this.element.classList.add('active');\n        this._contextMenuProvider.showContextMenu({\n            getAnchor: () => this.element,\n            getActions: () => this.actions,\n            getActionsContext: () => this.menuOptions ? this.menuOptions.context : null,\n            getActionViewItem: action => this.menuOptions && this.menuOptions.actionViewItemProvider ? this.menuOptions.actionViewItemProvider(action) : undefined,\n            getKeyBinding: action => this.menuOptions && this.menuOptions.getKeyBinding ? this.menuOptions.getKeyBinding(action) : undefined,\n            getMenuClassName: () => this.menuClassName,\n            onHide: () => this.onHide(),\n            actionRunner: this.menuOptions ? this.menuOptions.actionRunner : undefined,\n            anchorAlignment: this.menuOptions ? this.menuOptions.anchorAlignment : 0 /* AnchorAlignment.LEFT */,\n            domForShadowRoot: this.menuAsChild ? this.element : undefined\n        });\n    }\n    hide() {\n        super.hide();\n    }\n    onHide() {\n        this.hide();\n        this.element.classList.remove('active');\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, append } from '../../dom.js';\nimport { BaseActionViewItem } from '../actionbar/actionViewItems.js';\nimport { DropdownMenu } from './dropdown.js';\nimport { Emitter } from '../../../common/event.js';\nimport './dropdown.css';\nexport class DropdownMenuActionViewItem extends BaseActionViewItem {\n    constructor(action, menuActionsOrProvider, contextMenuProvider, options = Object.create(null)) {\n        super(null, action, options);\n        this.actionItem = null;\n        this._onDidChangeVisibility = this._register(new Emitter());\n        this.menuActionsOrProvider = menuActionsOrProvider;\n        this.contextMenuProvider = contextMenuProvider;\n        this.options = options;\n        if (this.options.actionRunner) {\n            this.actionRunner = this.options.actionRunner;\n        }\n    }\n    render(container) {\n        this.actionItem = container;\n        const labelRenderer = (el) => {\n            this.element = append(el, $('a.action-label'));\n            let classNames = [];\n            if (typeof this.options.classNames === 'string') {\n                classNames = this.options.classNames.split(/\\s+/g).filter(s => !!s);\n            }\n            else if (this.options.classNames) {\n                classNames = this.options.classNames;\n            }\n            // todo@aeschli: remove codicon, should come through `this.options.classNames`\n            if (!classNames.find(c => c === 'icon')) {\n                classNames.push('codicon');\n            }\n            this.element.classList.add(...classNames);\n            this.element.setAttribute('role', 'button');\n            this.element.setAttribute('aria-haspopup', 'true');\n            this.element.setAttribute('aria-expanded', 'false');\n            this.element.title = this._action.label || '';\n            this.element.ariaLabel = this._action.label || '';\n            return null;\n        };\n        const isActionsArray = Array.isArray(this.menuActionsOrProvider);\n        const options = {\n            contextMenuProvider: this.contextMenuProvider,\n            labelRenderer: labelRenderer,\n            menuAsChild: this.options.menuAsChild,\n            actions: isActionsArray ? this.menuActionsOrProvider : undefined,\n            actionProvider: isActionsArray ? undefined : this.menuActionsOrProvider\n        };\n        this.dropdownMenu = this._register(new DropdownMenu(container, options));\n        this._register(this.dropdownMenu.onDidChangeVisibility(visible => {\n            var _a;\n            (_a = this.element) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-expanded', `${visible}`);\n            this._onDidChangeVisibility.fire(visible);\n        }));\n        this.dropdownMenu.menuOptions = {\n            actionViewItemProvider: this.options.actionViewItemProvider,\n            actionRunner: this.actionRunner,\n            getKeyBinding: this.options.keybindingProvider,\n            context: this._context\n        };\n        if (this.options.anchorAlignmentProvider) {\n            const that = this;\n            this.dropdownMenu.menuOptions = Object.assign(Object.assign({}, this.dropdownMenu.menuOptions), { get anchorAlignment() {\n                    return that.options.anchorAlignmentProvider();\n                } });\n        }\n        this.updateTooltip();\n        this.updateEnabled();\n    }\n    getTooltip() {\n        let title = null;\n        if (this.getAction().tooltip) {\n            title = this.getAction().tooltip;\n        }\n        else if (this.getAction().label) {\n            title = this.getAction().label;\n        }\n        return title !== null && title !== void 0 ? title : undefined;\n    }\n    setActionContext(newContext) {\n        super.setActionContext(newContext);\n        if (this.dropdownMenu) {\n            if (this.dropdownMenu.menuOptions) {\n                this.dropdownMenu.menuOptions.context = newContext;\n            }\n            else {\n                this.dropdownMenu.menuOptions = { context: newContext };\n            }\n        }\n    }\n    updateEnabled() {\n        var _a, _b;\n        const disabled = !this.getAction().enabled;\n        (_a = this.actionItem) === null || _a === void 0 ? void 0 : _a.classList.toggle('disabled', disabled);\n        (_b = this.element) === null || _b === void 0 ? void 0 : _b.classList.toggle('disabled', disabled);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { $, addDisposableListener, append, asCSSUrl, EventType, ModifierKeyEmitter, prepend } from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from '../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { DropdownMenuActionViewItem } from '../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\nimport { ActionRunner, Separator, SubmenuAction } from '../../../base/common/actions.js';\nimport { UILabelProvider } from '../../../base/common/keybindingLabels.js';\nimport { combinedDisposable, DisposableStore, MutableDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { isLinux, isWindows, OS } from '../../../base/common/platform.js';\nimport './menuEntryActionViewItem.css';\nimport { localize } from '../../../nls.js';\nimport { IMenuService, MenuItemAction, SubmenuItemAction } from '../common/actions.js';\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { INotificationService } from '../../notification/common/notification.js';\nimport { IStorageService } from '../../storage/common/storage.js';\nimport { IThemeService, ThemeIcon } from '../../theme/common/themeService.js';\nimport { isDark } from '../../theme/common/theme.js';\nimport { assertType } from '../../../base/common/types.js';\nexport function createAndFillInActionBarActions(menu, options, target, primaryGroup, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions) {\n    const groups = menu.getActions(options);\n    const isPrimaryAction = typeof primaryGroup === 'string' ? (actionGroup) => actionGroup === primaryGroup : primaryGroup;\n    // Action bars handle alternative actions on their own so the alternative actions should be ignored\n    fillInActions(groups, target, false, isPrimaryAction, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions);\n    return asDisposable(groups);\n}\nfunction asDisposable(groups) {\n    const disposables = new DisposableStore();\n    for (const [, actions] of groups) {\n        for (const action of actions) {\n            disposables.add(action);\n        }\n    }\n    return disposables;\n}\nfunction fillInActions(groups, target, useAlternativeActions, isPrimaryAction = actionGroup => actionGroup === 'navigation', primaryMaxCount = Number.MAX_SAFE_INTEGER, shouldInlineSubmenu = () => false, useSeparatorsInPrimaryActions = false) {\n    let primaryBucket;\n    let secondaryBucket;\n    if (Array.isArray(target)) {\n        primaryBucket = target;\n        secondaryBucket = target;\n    }\n    else {\n        primaryBucket = target.primary;\n        secondaryBucket = target.secondary;\n    }\n    const submenuInfo = new Set();\n    for (const [group, actions] of groups) {\n        let target;\n        if (isPrimaryAction(group)) {\n            target = primaryBucket;\n            if (target.length > 0 && useSeparatorsInPrimaryActions) {\n                target.push(new Separator());\n            }\n        }\n        else {\n            target = secondaryBucket;\n            if (target.length > 0) {\n                target.push(new Separator());\n            }\n        }\n        for (let action of actions) {\n            if (useAlternativeActions) {\n                action = action instanceof MenuItemAction && action.alt ? action.alt : action;\n            }\n            const newLen = target.push(action);\n            // keep submenu info for later inlining\n            if (action instanceof SubmenuAction) {\n                submenuInfo.add({ group, action, index: newLen - 1 });\n            }\n        }\n    }\n    // ask the outside if submenu should be inlined or not. only ask when\n    // there would be enough space\n    for (const { group, action, index } of submenuInfo) {\n        const target = isPrimaryAction(group) ? primaryBucket : secondaryBucket;\n        // inlining submenus with length 0 or 1 is easy,\n        // larger submenus need to be checked with the overall limit\n        const submenuActions = action.actions;\n        if ((submenuActions.length <= 1 || target.length + submenuActions.length - 2 <= primaryMaxCount) && shouldInlineSubmenu(action, group, target.length)) {\n            target.splice(index, 1, ...submenuActions);\n        }\n    }\n    // overflow items from the primary group into the secondary bucket\n    if (primaryBucket !== secondaryBucket && primaryBucket.length > primaryMaxCount) {\n        const overflow = primaryBucket.splice(primaryMaxCount, primaryBucket.length - primaryMaxCount);\n        secondaryBucket.unshift(...overflow, new Separator());\n    }\n}\nlet MenuEntryActionViewItem = class MenuEntryActionViewItem extends ActionViewItem {\n    constructor(action, options, _keybindingService, _notificationService, _contextKeyService, _themeService, _contextMenuService) {\n        super(undefined, action, { icon: !!(action.class || action.item.icon), label: !action.class && !action.item.icon, draggable: options === null || options === void 0 ? void 0 : options.draggable, keybinding: options === null || options === void 0 ? void 0 : options.keybinding, hoverDelegate: options === null || options === void 0 ? void 0 : options.hoverDelegate });\n        this._keybindingService = _keybindingService;\n        this._notificationService = _notificationService;\n        this._contextKeyService = _contextKeyService;\n        this._themeService = _themeService;\n        this._contextMenuService = _contextMenuService;\n        this._wantsAltCommand = false;\n        this._itemClassDispose = this._register(new MutableDisposable());\n        this._altKey = ModifierKeyEmitter.getInstance();\n    }\n    get _menuItemAction() {\n        return this._action;\n    }\n    get _commandAction() {\n        return this._wantsAltCommand && this._menuItemAction.alt || this._menuItemAction;\n    }\n    onClick(event) {\n        return __awaiter(this, void 0, void 0, function* () {\n            event.preventDefault();\n            event.stopPropagation();\n            try {\n                yield this.actionRunner.run(this._commandAction, this._context);\n            }\n            catch (err) {\n                this._notificationService.error(err);\n            }\n        });\n    }\n    render(container) {\n        super.render(container);\n        container.classList.add('menu-entry');\n        this._updateItemClass(this._menuItemAction.item);\n        let mouseOver = false;\n        let alternativeKeyDown = this._altKey.keyStatus.altKey || ((isWindows || isLinux) && this._altKey.keyStatus.shiftKey);\n        const updateAltState = () => {\n            var _a;\n            const wantsAltCommand = mouseOver && alternativeKeyDown && !!((_a = this._commandAction.alt) === null || _a === void 0 ? void 0 : _a.enabled);\n            if (wantsAltCommand !== this._wantsAltCommand) {\n                this._wantsAltCommand = wantsAltCommand;\n                this.updateLabel();\n                this.updateTooltip();\n                this.updateClass();\n            }\n        };\n        if (this._menuItemAction.alt) {\n            this._register(this._altKey.event(value => {\n                alternativeKeyDown = value.altKey || ((isWindows || isLinux) && value.shiftKey);\n                updateAltState();\n            }));\n        }\n        this._register(addDisposableListener(container, 'mouseleave', _ => {\n            mouseOver = false;\n            updateAltState();\n        }));\n        this._register(addDisposableListener(container, 'mouseenter', _ => {\n            mouseOver = true;\n            updateAltState();\n        }));\n    }\n    updateLabel() {\n        if (this.options.label && this.label) {\n            this.label.textContent = this._commandAction.label;\n        }\n    }\n    getTooltip() {\n        var _a;\n        const keybinding = this._keybindingService.lookupKeybinding(this._commandAction.id, this._contextKeyService);\n        const keybindingLabel = keybinding && keybinding.getLabel();\n        const tooltip = this._commandAction.tooltip || this._commandAction.label;\n        let title = keybindingLabel\n            ? localize('titleAndKb', \"{0} ({1})\", tooltip, keybindingLabel)\n            : tooltip;\n        if (!this._wantsAltCommand && ((_a = this._menuItemAction.alt) === null || _a === void 0 ? void 0 : _a.enabled)) {\n            const altTooltip = this._menuItemAction.alt.tooltip || this._menuItemAction.alt.label;\n            const altKeybinding = this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id, this._contextKeyService);\n            const altKeybindingLabel = altKeybinding && altKeybinding.getLabel();\n            const altTitleSection = altKeybindingLabel\n                ? localize('titleAndKb', \"{0} ({1})\", altTooltip, altKeybindingLabel)\n                : altTooltip;\n            title = localize('titleAndKbAndAlt', \"{0}\\n[{1}] {2}\", title, UILabelProvider.modifierLabels[OS].altKey, altTitleSection);\n        }\n        return title;\n    }\n    updateClass() {\n        if (this.options.icon) {\n            if (this._commandAction !== this._menuItemAction) {\n                if (this._menuItemAction.alt) {\n                    this._updateItemClass(this._menuItemAction.alt.item);\n                }\n            }\n            else {\n                this._updateItemClass(this._menuItemAction.item);\n            }\n        }\n    }\n    _updateItemClass(item) {\n        var _a;\n        this._itemClassDispose.value = undefined;\n        const { element, label } = this;\n        if (!element || !label) {\n            return;\n        }\n        const icon = this._commandAction.checked && ((_a = item.toggled) === null || _a === void 0 ? void 0 : _a.icon) ? item.toggled.icon : item.icon;\n        if (!icon) {\n            return;\n        }\n        if (ThemeIcon.isThemeIcon(icon)) {\n            // theme icons\n            const iconClasses = ThemeIcon.asClassNameArray(icon);\n            label.classList.add(...iconClasses);\n            this._itemClassDispose.value = toDisposable(() => {\n                label.classList.remove(...iconClasses);\n            });\n        }\n        else {\n            // icon path/url\n            label.style.backgroundImage = (isDark(this._themeService.getColorTheme().type)\n                ? asCSSUrl(icon.dark)\n                : asCSSUrl(icon.light));\n            label.classList.add('icon');\n            this._itemClassDispose.value = combinedDisposable(toDisposable(() => {\n                label.style.backgroundImage = '';\n                label.classList.remove('icon');\n            }), this._themeService.onDidColorThemeChange(() => {\n                // refresh when the theme changes in case we go between dark <-> light\n                this.updateClass();\n            }));\n        }\n    }\n};\nMenuEntryActionViewItem = __decorate([\n    __param(2, IKeybindingService),\n    __param(3, INotificationService),\n    __param(4, IContextKeyService),\n    __param(5, IThemeService),\n    __param(6, IContextMenuService)\n], MenuEntryActionViewItem);\nexport { MenuEntryActionViewItem };\nlet SubmenuEntryActionViewItem = class SubmenuEntryActionViewItem extends DropdownMenuActionViewItem {\n    constructor(action, options, _contextMenuService, _themeService) {\n        var _a, _b;\n        const dropdownOptions = Object.assign({}, options !== null && options !== void 0 ? options : Object.create(null), {\n            menuAsChild: (_a = options === null || options === void 0 ? void 0 : options.menuAsChild) !== null && _a !== void 0 ? _a : false,\n            classNames: (_b = options === null || options === void 0 ? void 0 : options.classNames) !== null && _b !== void 0 ? _b : (ThemeIcon.isThemeIcon(action.item.icon) ? ThemeIcon.asClassName(action.item.icon) : undefined),\n        });\n        super(action, { getActions: () => action.actions }, _contextMenuService, dropdownOptions);\n        this._contextMenuService = _contextMenuService;\n        this._themeService = _themeService;\n    }\n    render(container) {\n        super.render(container);\n        assertType(this.element);\n        container.classList.add('menu-entry');\n        const action = this._action;\n        const { icon } = action.item;\n        if (icon && !ThemeIcon.isThemeIcon(icon)) {\n            this.element.classList.add('icon');\n            const setBackgroundImage = () => {\n                if (this.element) {\n                    this.element.style.backgroundImage = (isDark(this._themeService.getColorTheme().type)\n                        ? asCSSUrl(icon.dark)\n                        : asCSSUrl(icon.light));\n                }\n            };\n            setBackgroundImage();\n            this._register(this._themeService.onDidColorThemeChange(() => {\n                // refresh when the theme changes in case we go between dark <-> light\n                setBackgroundImage();\n            }));\n        }\n    }\n};\nSubmenuEntryActionViewItem = __decorate([\n    __param(2, IContextMenuService),\n    __param(3, IThemeService)\n], SubmenuEntryActionViewItem);\nexport { SubmenuEntryActionViewItem };\nlet DropdownWithDefaultActionViewItem = class DropdownWithDefaultActionViewItem extends BaseActionViewItem {\n    constructor(submenuAction, options, _keybindingService, _notificationService, _contextMenuService, _menuService, _instaService, _storageService) {\n        var _a, _b, _c;\n        super(null, submenuAction);\n        this._keybindingService = _keybindingService;\n        this._notificationService = _notificationService;\n        this._contextMenuService = _contextMenuService;\n        this._menuService = _menuService;\n        this._instaService = _instaService;\n        this._storageService = _storageService;\n        this._container = null;\n        this._options = options;\n        this._storageKey = `${submenuAction.item.submenu.id}_lastActionId`;\n        // determine default action\n        let defaultAction;\n        const defaultActionId = _storageService.get(this._storageKey, 1 /* StorageScope.WORKSPACE */);\n        if (defaultActionId) {\n            defaultAction = submenuAction.actions.find(a => defaultActionId === a.id);\n        }\n        if (!defaultAction) {\n            defaultAction = submenuAction.actions[0];\n        }\n        this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, defaultAction, { keybinding: this._getDefaultActionKeybindingLabel(defaultAction) });\n        const dropdownOptions = Object.assign({}, options !== null && options !== void 0 ? options : Object.create(null), {\n            menuAsChild: (_a = options === null || options === void 0 ? void 0 : options.menuAsChild) !== null && _a !== void 0 ? _a : true,\n            classNames: (_b = options === null || options === void 0 ? void 0 : options.classNames) !== null && _b !== void 0 ? _b : ['codicon', 'codicon-chevron-down'],\n            actionRunner: (_c = options === null || options === void 0 ? void 0 : options.actionRunner) !== null && _c !== void 0 ? _c : new ActionRunner()\n        });\n        this._dropdown = new DropdownMenuActionViewItem(submenuAction, submenuAction.actions, this._contextMenuService, dropdownOptions);\n        this._dropdown.actionRunner.onDidRun((e) => {\n            if (e.action instanceof MenuItemAction) {\n                this.update(e.action);\n            }\n        });\n    }\n    update(lastAction) {\n        this._storageService.store(this._storageKey, lastAction.id, 1 /* StorageScope.WORKSPACE */, 0 /* StorageTarget.USER */);\n        this._defaultAction.dispose();\n        this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, lastAction, { keybinding: this._getDefaultActionKeybindingLabel(lastAction) });\n        this._defaultAction.actionRunner = new class extends ActionRunner {\n            runAction(action, context) {\n                return __awaiter(this, void 0, void 0, function* () {\n                    yield action.run(undefined);\n                });\n            }\n        }();\n        if (this._container) {\n            this._defaultAction.render(prepend(this._container, $('.action-container')));\n        }\n    }\n    _getDefaultActionKeybindingLabel(defaultAction) {\n        var _a;\n        let defaultActionKeybinding;\n        if ((_a = this._options) === null || _a === void 0 ? void 0 : _a.renderKeybindingWithDefaultActionLabel) {\n            const kb = this._keybindingService.lookupKeybinding(defaultAction.id);\n            if (kb) {\n                defaultActionKeybinding = `(${kb.getLabel()})`;\n            }\n        }\n        return defaultActionKeybinding;\n    }\n    setActionContext(newContext) {\n        super.setActionContext(newContext);\n        this._defaultAction.setActionContext(newContext);\n        this._dropdown.setActionContext(newContext);\n    }\n    render(container) {\n        this._container = container;\n        super.render(this._container);\n        this._container.classList.add('monaco-dropdown-with-default');\n        const primaryContainer = $('.action-container');\n        this._defaultAction.render(append(this._container, primaryContainer));\n        this._register(addDisposableListener(primaryContainer, EventType.KEY_DOWN, (e) => {\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(17 /* KeyCode.RightArrow */)) {\n                this._defaultAction.element.tabIndex = -1;\n                this._dropdown.focus();\n                event.stopPropagation();\n            }\n        }));\n        const dropdownContainer = $('.dropdown-action-container');\n        this._dropdown.render(append(this._container, dropdownContainer));\n        this._register(addDisposableListener(dropdownContainer, EventType.KEY_DOWN, (e) => {\n            var _a;\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                this._defaultAction.element.tabIndex = 0;\n                this._dropdown.setFocusable(false);\n                (_a = this._defaultAction.element) === null || _a === void 0 ? void 0 : _a.focus();\n                event.stopPropagation();\n            }\n        }));\n    }\n    focus(fromRight) {\n        if (fromRight) {\n            this._dropdown.focus();\n        }\n        else {\n            this._defaultAction.element.tabIndex = 0;\n            this._defaultAction.element.focus();\n        }\n    }\n    blur() {\n        this._defaultAction.element.tabIndex = -1;\n        this._dropdown.blur();\n        this._container.blur();\n    }\n    setFocusable(focusable) {\n        if (focusable) {\n            this._defaultAction.element.tabIndex = 0;\n        }\n        else {\n            this._defaultAction.element.tabIndex = -1;\n            this._dropdown.setFocusable(false);\n        }\n    }\n    dispose() {\n        this._defaultAction.dispose();\n        this._dropdown.dispose();\n        super.dispose();\n    }\n};\nDropdownWithDefaultActionViewItem = __decorate([\n    __param(2, IKeybindingService),\n    __param(3, INotificationService),\n    __param(4, IContextMenuService),\n    __param(5, IMenuService),\n    __param(6, IInstantiationService),\n    __param(7, IStorageService)\n], DropdownWithDefaultActionViewItem);\nexport { DropdownWithDefaultActionViewItem };\n/**\n * Creates action view items for menu actions or submenu actions.\n */\nexport function createActionViewItem(instaService, action, options) {\n    if (action instanceof MenuItemAction) {\n        return instaService.createInstance(MenuEntryActionViewItem, action, options);\n    }\n    else if (action instanceof SubmenuItemAction) {\n        if (action.item.rememberDefaultAction) {\n            return instaService.createInstance(DropdownWithDefaultActionViewItem, action, options);\n        }\n        else {\n            return instaService.createInstance(SubmenuEntryActionViewItem, action, options);\n        }\n    }\n    else {\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport * as objects from '../../../../base/common/objects.js';\nimport './media/peekViewWidget.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { ZoneWidget } from '../../zoneWidget/browser/zoneWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { createActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { activeContrastBorder, contrastBorder, editorForeground, editorInfoForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nexport const IPeekViewService = createDecorator('IPeekViewService');\nregisterSingleton(IPeekViewService, class {\n    constructor() {\n        this._widgets = new Map();\n    }\n    addExclusiveWidget(editor, widget) {\n        const existing = this._widgets.get(editor);\n        if (existing) {\n            existing.listener.dispose();\n            existing.widget.dispose();\n        }\n        const remove = () => {\n            const data = this._widgets.get(editor);\n            if (data && data.widget === widget) {\n                data.listener.dispose();\n                this._widgets.delete(editor);\n            }\n        };\n        this._widgets.set(editor, { widget, listener: widget.onDidClose(remove) });\n    }\n});\nexport var PeekContext;\n(function (PeekContext) {\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true, nls.localize('inReferenceSearchEditor', \"Whether the current code editor is embedded inside peek\"));\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\n})(PeekContext || (PeekContext = {}));\nlet PeekContextController = class PeekContextController {\n    constructor(editor, contextKeyService) {\n        if (editor instanceof EmbeddedCodeEditorWidget) {\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\n        }\n    }\n    dispose() { }\n};\nPeekContextController.ID = 'editor.contrib.referenceController';\nPeekContextController = __decorate([\n    __param(1, IContextKeyService)\n], PeekContextController);\nregisterEditorContribution(PeekContextController.ID, PeekContextController);\nexport function getOuterEditor(accessor) {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (editor instanceof EmbeddedCodeEditorWidget) {\n        return editor.getParentEditor();\n    }\n    return editor;\n}\nconst defaultOptions = {\n    headerBackgroundColor: Color.white,\n    primaryHeadingColor: Color.fromHex('#333333'),\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\n};\nlet PeekViewWidget = class PeekViewWidget extends ZoneWidget {\n    constructor(editor, options, instantiationService) {\n        super(editor, options);\n        this.instantiationService = instantiationService;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        objects.mixin(this.options, defaultOptions, false);\n    }\n    dispose() {\n        if (!this.disposed) {\n            this.disposed = true; // prevent consumers who dispose on onDidClose from looping\n            super.dispose();\n            this._onDidClose.fire(this);\n        }\n    }\n    style(styles) {\n        const options = this.options;\n        if (styles.headerBackgroundColor) {\n            options.headerBackgroundColor = styles.headerBackgroundColor;\n        }\n        if (styles.primaryHeadingColor) {\n            options.primaryHeadingColor = styles.primaryHeadingColor;\n        }\n        if (styles.secondaryHeadingColor) {\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\n        }\n        super.style(styles);\n    }\n    _applyStyles() {\n        super._applyStyles();\n        const options = this.options;\n        if (this._headElement && options.headerBackgroundColor) {\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\n        }\n        if (this._primaryHeading && options.primaryHeadingColor) {\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\n        }\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\n        }\n        if (this._bodyElement && options.frameColor) {\n            this._bodyElement.style.borderColor = options.frameColor.toString();\n        }\n    }\n    _fillContainer(container) {\n        this.setCssClass('peekview-widget');\n        this._headElement = dom.$('.head');\n        this._bodyElement = dom.$('.body');\n        this._fillHead(this._headElement);\n        this._fillBody(this._bodyElement);\n        container.appendChild(this._headElement);\n        container.appendChild(this._bodyElement);\n    }\n    _fillHead(container, noCloseAction) {\n        const titleElement = dom.$('.peekview-title');\n        if (this.options.supportOnTitleClick) {\n            titleElement.classList.add('clickable');\n            dom.addStandardDisposableListener(titleElement, 'click', event => this._onTitleClick(event));\n        }\n        dom.append(this._headElement, titleElement);\n        this._fillTitleIcon(titleElement);\n        this._primaryHeading = dom.$('span.filename');\n        this._secondaryHeading = dom.$('span.dirname');\n        this._metaHeading = dom.$('span.meta');\n        dom.append(titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\n        const actionsContainer = dom.$('.peekview-actions');\n        dom.append(this._headElement, actionsContainer);\n        const actionBarOptions = this._getActionBarOptions();\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\n        this._disposables.add(this._actionbarWidget);\n        if (!noCloseAction) {\n            this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), Codicon.close.classNames, true, () => {\n                this.dispose();\n                return Promise.resolve();\n            }), { label: false, icon: true });\n        }\n    }\n    _fillTitleIcon(container) {\n    }\n    _getActionBarOptions() {\n        return {\n            actionViewItemProvider: createActionViewItem.bind(undefined, this.instantiationService),\n            orientation: 0 /* ActionsOrientation.HORIZONTAL */\n        };\n    }\n    _onTitleClick(event) {\n        // implement me if supportOnTitleClick option is set\n    }\n    setTitle(primaryHeading, secondaryHeading) {\n        if (this._primaryHeading && this._secondaryHeading) {\n            this._primaryHeading.innerText = primaryHeading;\n            this._primaryHeading.setAttribute('title', primaryHeading);\n            if (secondaryHeading) {\n                this._secondaryHeading.innerText = secondaryHeading;\n            }\n            else {\n                dom.clearNode(this._secondaryHeading);\n            }\n        }\n    }\n    setMetaTitle(value) {\n        if (this._metaHeading) {\n            if (value) {\n                this._metaHeading.innerText = value;\n                dom.show(this._metaHeading);\n            }\n            else {\n                dom.hide(this._metaHeading);\n            }\n        }\n    }\n    _doLayout(heightInPixel, widthInPixel) {\n        if (!this._isShowing && heightInPixel < 0) {\n            // Looks like the view zone got folded away!\n            this.dispose();\n            return;\n        }\n        const headHeight = Math.ceil(this.editor.getOption(61 /* EditorOption.lineHeight */) * 1.2);\n        const bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\n        this._doLayoutHead(headHeight, widthInPixel);\n        this._doLayoutBody(bodyHeight, widthInPixel);\n    }\n    _doLayoutHead(heightInPixel, widthInPixel) {\n        if (this._headElement) {\n            this._headElement.style.height = `${heightInPixel}px`;\n            this._headElement.style.lineHeight = this._headElement.style.height;\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        if (this._bodyElement) {\n            this._bodyElement.style.height = `${heightInPixel}px`;\n        }\n    }\n};\nPeekViewWidget = __decorate([\n    __param(2, IInstantiationService)\n], PeekViewWidget);\nexport { PeekViewWidget };\nexport const peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: transparent(editorInfoForeground, .1), light: transparent(editorInfoForeground, .1), hcDark: null, hcLight: null }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\nexport const peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: Color.white, light: Color.black, hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\nexport const peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#616161', hcDark: '#FFFFFF99', hcLight: '#292929' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\nexport const peekViewBorder = registerColor('peekView.border', { dark: editorInfoForeground, light: editorInfoForeground, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\nexport const peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\nexport const peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\nexport const peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\nexport const peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hcDark: null, hcLight: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\nexport const peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\nexport const peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\nexport const peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hcDark: peekViewEditorBackground, hcLight: peekViewEditorBackground }, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\nexport const peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hcDark: null, hcLight: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\nexport const peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hcDark: null, hcLight: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\nexport const peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"symbol in {0} on line {1} at column {2}, {3}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn, preview.value);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    resolve(textModelResolverService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._previews.size !== 0) {\n                return this;\n            }\n            for (const child of this.children) {\n                if (this._previews.has(child.uri)) {\n                    continue;\n                }\n                try {\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\n                    this._previews.set(child.uri, new FilePreview(ref));\n                }\n                catch (err) {\n                    onUnexpectedError(err);\n                }\n            }\n            return this;\n        });\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { attachBadgeStyler } from '../../../../../platform/theme/common/styler.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService, themeService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\n        this._register(attachBadgeStyler(this.badge, themeService));\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService),\n    __param(2, IThemeService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: false\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = class ReferencesController {\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(ReferencesController.ID);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(79 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    goToNextOrPreviousReference(fwd) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            const currentPosition = this._widget.position;\n            if (!currentPosition) {\n                return;\n            }\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n            if (!source) {\n                return;\n            }\n            const target = this._model.nextOrPreviousReference(source, fwd);\n            const editorFocus = this._editor.hasTextFocus();\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\n            yield this._widget.setSelection(target);\n            yield this._gotoReference(target);\n            if (editorFocus) {\n                this._editor.focus();\n            }\n            else if (this._widget && previewEditorFocus) {\n                this._widget.focusOnPreviewEditor();\n            }\n        });\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            yield this._widget.revealReference(reference);\n        });\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref) {\n        if (this._widget) {\n            this._widget.hide();\n        }\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */ }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nfunction getLocationLinks(model, position, registry, provide) {\n    const provider = registry.ordered(model);\n    // get results\n    const promises = provider.map((provider) => {\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n            onUnexpectedExternalError(err);\n            return undefined;\n        });\n    });\n    return Promise.all(promises).then(values => {\n        const result = [];\n        for (const value of values) {\n            if (Array.isArray(value)) {\n                result.push(...value);\n            }\n            else if (value) {\n                result.push(value);\n            }\n        }\n        return result;\n    });\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    }));\n}\n// -- API commands ----\nfunction _sortedAndDeduped(callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const rawLinks = yield callback();\n        const model = new ReferencesModel(rawLinks, '');\n        const modelLinks = model.references.map(ref => ref.link);\n        model.dispose();\n        return modelLinks;\n    });\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nconst _goToActionIds = new Set();\nfunction registerGoToAction(ctor) {\n    const result = new ctor();\n    registerInstantiatedEditorAction(result);\n    _goToActionIds.add(result.id);\n    return result;\n}\nexport class SymbolNavigationAnchor {\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction {\n    constructor(configuration, opts) {\n        super(opts);\n        this.configuration = configuration;\n    }\n    run(accessor, editor, arg) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && _goToActionIds.has(altActionId)) {\n                    altAction = editor.getAction(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.id);\n                altAction.run().finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.id);\n                });\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                    selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        decorations.clear();\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nconst goToDefinitionKb = isWeb && !isStandalone()\n    ? 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */\n    : 70 /* KeyCode.F12 */;\nregisterGoToAction((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDefinitionAction.id,\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                alias: 'Go to Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: goToDefinitionKb,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.1\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterGoToAction((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: OpenDefinitionToSideAction.id,\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                alias: 'Open Definition to the Side',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, goToDefinitionKb),\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterGoToAction((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekDefinitionAction.id,\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                alias: 'Peek Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterGoToAction((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDeclarationAction.id,\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                alias: 'Go to Declaration',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.3\n                },\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterGoToAction(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n            alias: 'Peek Declaration',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterGoToAction((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToTypeDefinitionAction.ID,\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                alias: 'Go to Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.4\n                }\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterGoToAction((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekTypeDefinitionAction.ID,\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                alias: 'Peek Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterGoToAction((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToImplementationAction.ID,\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                alias: 'Go to Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.45\n                }\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterGoToAction((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekImplementationAction.ID,\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                alias: 'Peek Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterGoToAction(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            label: nls.localize('goToReferences.label', \"Go to References\"),\n            alias: 'Go to References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: 'navigation',\n                order: 1.45\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterGoToAction(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            label: nls.localize('references.action.label', \"Peek References\"),\n            alias: 'Peek References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            label: nls.localize('label.generic', \"Go to Any Symbol\"),\n            alias: 'Go to Any Symbol',\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _a;\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(53 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n// -- unconditionally register goto-action\nMenuRegistry.appendMenuItems([\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDefinition',\n                title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 2,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDeclaration',\n                title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToTypeDefinition',\n                title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToImplementation',\n                title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n            },\n            group: '4_symbol_nav',\n            order: 4,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToReferences',\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            group: '4_symbol_nav',\n            order: 5,\n        },\n    },\n]);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { editorActiveLinkForeground } from '../../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../../platform/theme/common/themeService.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(() => {\n                    this.removeLinkDecorations();\n                }, (error) => {\n                    this.removeLinkDecorations();\n                    onUnexpectedError(error);\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        // For issue: https://github.com/microsoft/vscode/issues/46257\n        // equivalent to mouse move with meta/ctrl key\n        // First find the definition and add decorations\n        // to the editor to be shown with the content hover widget\n        return this.startFindDefinition(position).then(() => {\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\n        this.toUnhookForKeyboard.clear();\n        // Find word at mouse position\n        const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n        if (!word) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return Promise.resolve(0);\n        }\n        // Return early if word at position is still the same\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n            return Promise.resolve(0);\n        }\n        this.currentWordAtPosition = word;\n        // Find definition and decorate word if found\n        const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n        if (this.previousPromise) {\n            this.previousPromise.cancel();\n            this.previousPromise = null;\n        }\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n        return this.previousPromise.then(results => {\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            // Multiple results\n            if (results.length > 1) {\n                this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            // Single result\n            else {\n                const result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    let wordRange;\n                    if (result.originSelectionRange) {\n                        wordRange = Range.lift(result.originSelectionRange);\n                    }\n                    else {\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n                    }\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(wordRange, new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue));\n                    ref.dispose();\n                });\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        return this.editor.hasModel() &&\n            mouseEvent.isNoneOrSingleMouseDown &&\n            (mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */) &&\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\n            this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(80 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\n            return action.run(accessor, this.editor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\nregisterThemingParticipant((theme, collector) => {\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n    if (activeLinkForeground) {\n        collector.addRule(`.monaco-editor .goto-definition-link { color: ${activeLinkForeground} !important; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { DomScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { Disposable } from '../../../common/lifecycle.js';\nimport './hover.css';\nconst $ = dom.$;\nexport class HoverWidget extends Disposable {\n    constructor() {\n        super();\n        this.containerDomNode = document.createElement('div');\n        this.containerDomNode.className = 'monaco-hover';\n        this.containerDomNode.tabIndex = 0;\n        this.containerDomNode.setAttribute('role', 'tooltip');\n        this.contentsDomNode = document.createElement('div');\n        this.contentsDomNode.className = 'monaco-hover-content';\n        this.scrollbar = this._register(new DomScrollableElement(this.contentsDomNode, {\n            consumeMouseWheelIfScrollbarIsNeeded: true\n        }));\n        this.containerDomNode.appendChild(this.scrollbar.getDomNode());\n    }\n    onContentsChanged() {\n        this.scrollbar.scanDomNode();\n    }\n}\nexport class HoverAction extends Disposable {\n    constructor(parent, actionOptions, keybindingLabel) {\n        super();\n        this.actionContainer = dom.append(parent, $('div.action-container'));\n        this.actionContainer.setAttribute('tabindex', '0');\n        this.action = dom.append(this.actionContainer, $('a.action'));\n        this.action.setAttribute('role', 'button');\n        if (actionOptions.iconClass) {\n            dom.append(this.action, $(`span.icon.${actionOptions.iconClass}`));\n        }\n        const label = dom.append(this.action, $('span'));\n        label.textContent = keybindingLabel ? `${actionOptions.label} (${keybindingLabel})` : actionOptions.label;\n        this._register(dom.addDisposableListener(this.actionContainer, dom.EventType.CLICK, e => {\n            e.stopPropagation();\n            e.preventDefault();\n            actionOptions.run(this.actionContainer);\n        }));\n        this._register(dom.addDisposableListener(this.actionContainer, dom.EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(3 /* KeyCode.Enter */)) {\n                e.stopPropagation();\n                e.preventDefault();\n                actionOptions.run(this.actionContainer);\n            }\n        }));\n        this.setEnabled(true);\n    }\n    static render(parent, actionOptions, keybindingLabel) {\n        return new HoverAction(parent, actionOptions, keybindingLabel);\n    }\n    setEnabled(enabled) {\n        if (enabled) {\n            this.actionContainer.classList.remove('disabled');\n            this.actionContainer.removeAttribute('aria-disabled');\n        }\n        else {\n            this.actionContainer.classList.add('disabled');\n            this.actionContainer.setAttribute('aria-disabled', 'true');\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var m = o[Symbol.asyncIterator], i;\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n};\nimport { createCancelableAsyncIterable, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nexport class HoverResult {\n    constructor(value, isComplete, hasLoadingMessage) {\n        this.value = value;\n        this.isComplete = isComplete;\n        this.hasLoadingMessage = hasLoadingMessage;\n    }\n}\n/**\n * Computing the hover is very fine tuned.\n *\n * Suppose the hover delay is 300ms (the default). Then, when resting the mouse at an anchor:\n * - at 150ms, the async computation is triggered (i.e. semantic hover)\n *   - if async results already come in, they are not rendered yet.\n * - at 300ms, the sync computation is triggered (i.e. decorations, markers)\n *   - if there are sync or async results, they are rendered.\n * - at 900ms, if the async computation hasn't finished, a \"Loading...\" result is added.\n */\nexport class HoverOperation extends Disposable {\n    constructor(_editor, _computer) {\n        super();\n        this._editor = _editor;\n        this._computer = _computer;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._firstWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerAsyncComputation(), 0));\n        this._secondWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerSyncComputation(), 0));\n        this._loadingMessageScheduler = this._register(new RunOnceScheduler(() => this._triggerLoadingMessage(), 0));\n        this._state = 0 /* HoverOperationState.Idle */;\n        this._asyncIterable = null;\n        this._asyncIterableDone = false;\n        this._result = [];\n    }\n    dispose() {\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        super.dispose();\n    }\n    get _hoverTime() {\n        return this._editor.getOption(55 /* EditorOption.hover */).delay;\n    }\n    get _firstWaitTime() {\n        return this._hoverTime / 2;\n    }\n    get _secondWaitTime() {\n        return this._hoverTime - this._firstWaitTime;\n    }\n    get _loadingMessageTime() {\n        return 3 * this._hoverTime;\n    }\n    _setState(state, fireResult = true) {\n        this._state = state;\n        if (fireResult) {\n            this._fireResult();\n        }\n    }\n    _triggerAsyncComputation() {\n        this._setState(2 /* HoverOperationState.SecondWait */);\n        this._secondWaitScheduler.schedule(this._secondWaitTime);\n        if (this._computer.computeAsync) {\n            this._asyncIterableDone = false;\n            this._asyncIterable = createCancelableAsyncIterable(token => this._computer.computeAsync(token));\n            (() => __awaiter(this, void 0, void 0, function* () {\n                var e_1, _a;\n                try {\n                    try {\n                        for (var _b = __asyncValues(this._asyncIterable), _c; _c = yield _b.next(), !_c.done;) {\n                            const item = _c.value;\n                            if (item) {\n                                this._result.push(item);\n                                this._fireResult();\n                            }\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_c && !_c.done && (_a = _b.return)) yield _a.call(_b);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                    this._asyncIterableDone = true;\n                    if (this._state === 3 /* HoverOperationState.WaitingForAsync */ || this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */) {\n                        this._setState(0 /* HoverOperationState.Idle */);\n                    }\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                }\n            }))();\n        }\n        else {\n            this._asyncIterableDone = true;\n        }\n    }\n    _triggerSyncComputation() {\n        if (this._computer.computeSync) {\n            this._result = this._result.concat(this._computer.computeSync());\n        }\n        this._setState(this._asyncIterableDone ? 0 /* HoverOperationState.Idle */ : 3 /* HoverOperationState.WaitingForAsync */);\n    }\n    _triggerLoadingMessage() {\n        if (this._state === 3 /* HoverOperationState.WaitingForAsync */) {\n            this._setState(4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        }\n    }\n    _fireResult() {\n        if (this._state === 1 /* HoverOperationState.FirstWait */ || this._state === 2 /* HoverOperationState.SecondWait */) {\n            // Do not send out results before the hover time\n            return;\n        }\n        const isComplete = (this._state === 0 /* HoverOperationState.Idle */);\n        const hasLoadingMessage = (this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        this._onResult.fire(new HoverResult(this._result.slice(0), isComplete, hasLoadingMessage));\n    }\n    start(mode) {\n        if (mode === 0 /* HoverStartMode.Delayed */) {\n            if (this._state === 0 /* HoverOperationState.Idle */) {\n                this._setState(1 /* HoverOperationState.FirstWait */);\n                this._firstWaitScheduler.schedule(this._firstWaitTime);\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime);\n            }\n        }\n        else {\n            switch (this._state) {\n                case 0 /* HoverOperationState.Idle */:\n                    this._triggerAsyncComputation();\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n                case 2 /* HoverOperationState.SecondWait */:\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n            }\n        }\n    }\n    cancel() {\n        this._firstWaitScheduler.cancel();\n        this._secondWaitScheduler.cancel();\n        this._loadingMessageScheduler.cancel();\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        this._result = [];\n        this._setState(0 /* HoverOperationState.Idle */, false);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverRangeAnchor {\n    constructor(priority, range) {\n        this.priority = priority;\n        this.range = range;\n        this.type = 1 /* HoverAnchorType.Range */;\n    }\n    equals(other) {\n        return (other.type === 1 /* HoverAnchorType.Range */ && this.range.equalsRange(other.range));\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 1 /* HoverAnchorType.Range */ && showAtPosition.lineNumber === this.range.startLineNumber);\n    }\n}\nexport class HoverForeignElementAnchor {\n    constructor(priority, owner, range) {\n        this.priority = priority;\n        this.owner = owner;\n        this.range = range;\n        this.type = 2 /* HoverAnchorType.ForeignElement */;\n    }\n    equals(other) {\n        return (other.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === other.owner);\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === lastAnchor.owner);\n    }\n}\nexport const HoverParticipantRegistry = (new class HoverParticipantRegistry {\n    constructor() {\n        this._participants = [];\n    }\n    register(ctor) {\n        this._participants.push(ctor);\n    }\n    getAll() {\n        return this._participants;\n    }\n}());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Scanner {\n    constructor() {\n        this.value = '';\n        this.pos = 0;\n    }\n    static isDigitCharacter(ch) {\n        return ch >= 48 /* CharCode.Digit0 */ && ch <= 57 /* CharCode.Digit9 */;\n    }\n    static isVariableCharacter(ch) {\n        return ch === 95 /* CharCode.Underline */\n            || (ch >= 97 /* CharCode.a */ && ch <= 122 /* CharCode.z */)\n            || (ch >= 65 /* CharCode.A */ && ch <= 90 /* CharCode.Z */);\n    }\n    text(value) {\n        this.value = value;\n        this.pos = 0;\n    }\n    tokenText(token) {\n        return this.value.substr(token.pos, token.len);\n    }\n    next() {\n        if (this.pos >= this.value.length) {\n            return { type: 14 /* TokenType.EOF */, pos: this.pos, len: 0 };\n        }\n        const pos = this.pos;\n        let len = 0;\n        let ch = this.value.charCodeAt(pos);\n        let type;\n        // static types\n        type = Scanner._table[ch];\n        if (typeof type === 'number') {\n            this.pos += 1;\n            return { type, pos, len: 1 };\n        }\n        // number\n        if (Scanner.isDigitCharacter(ch)) {\n            type = 8 /* TokenType.Int */;\n            do {\n                len += 1;\n                ch = this.value.charCodeAt(pos + len);\n            } while (Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // variable name\n        if (Scanner.isVariableCharacter(ch)) {\n            type = 9 /* TokenType.VariableName */;\n            do {\n                ch = this.value.charCodeAt(pos + (++len));\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // format\n        type = 10 /* TokenType.Format */;\n        do {\n            len += 1;\n            ch = this.value.charCodeAt(pos + len);\n        } while (!isNaN(ch)\n            && typeof Scanner._table[ch] === 'undefined' // not static token\n            && !Scanner.isDigitCharacter(ch) // not number\n            && !Scanner.isVariableCharacter(ch) // not variable\n        );\n        this.pos += len;\n        return { type, pos, len };\n    }\n}\nScanner._table = {\n    [36 /* CharCode.DollarSign */]: 0 /* TokenType.Dollar */,\n    [58 /* CharCode.Colon */]: 1 /* TokenType.Colon */,\n    [44 /* CharCode.Comma */]: 2 /* TokenType.Comma */,\n    [123 /* CharCode.OpenCurlyBrace */]: 3 /* TokenType.CurlyOpen */,\n    [125 /* CharCode.CloseCurlyBrace */]: 4 /* TokenType.CurlyClose */,\n    [92 /* CharCode.Backslash */]: 5 /* TokenType.Backslash */,\n    [47 /* CharCode.Slash */]: 6 /* TokenType.Forwardslash */,\n    [124 /* CharCode.Pipe */]: 7 /* TokenType.Pipe */,\n    [43 /* CharCode.Plus */]: 11 /* TokenType.Plus */,\n    [45 /* CharCode.Dash */]: 12 /* TokenType.Dash */,\n    [63 /* CharCode.QuestionMark */]: 13 /* TokenType.QuestionMark */,\n};\nexport class Marker {\n    constructor() {\n        this._children = [];\n    }\n    appendChild(child) {\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\n            // this and previous child are text -> merge them\n            this._children[this._children.length - 1].value += child.value;\n        }\n        else {\n            // normal adoption of child\n            child.parent = this;\n            this._children.push(child);\n        }\n        return this;\n    }\n    replace(child, others) {\n        const { parent } = child;\n        const idx = parent.children.indexOf(child);\n        const newChildren = parent.children.slice(0);\n        newChildren.splice(idx, 1, ...others);\n        parent._children = newChildren;\n        (function _fixParent(children, parent) {\n            for (const child of children) {\n                child.parent = parent;\n                _fixParent(child.children, child);\n            }\n        })(others, parent);\n    }\n    get children() {\n        return this._children;\n    }\n    get snippet() {\n        let candidate = this;\n        while (true) {\n            if (!candidate) {\n                return undefined;\n            }\n            if (candidate instanceof TextmateSnippet) {\n                return candidate;\n            }\n            candidate = candidate.parent;\n        }\n    }\n    toString() {\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\n    }\n    len() {\n        return 0;\n    }\n}\nexport class Text extends Marker {\n    constructor(value) {\n        super();\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n    len() {\n        return this.value.length;\n    }\n    clone() {\n        return new Text(this.value);\n    }\n}\nexport class TransformableMarker extends Marker {\n}\nexport class Placeholder extends TransformableMarker {\n    constructor(index) {\n        super();\n        this.index = index;\n    }\n    static compareByIndex(a, b) {\n        if (a.index === b.index) {\n            return 0;\n        }\n        else if (a.isFinalTabstop) {\n            return 1;\n        }\n        else if (b.isFinalTabstop) {\n            return -1;\n        }\n        else if (a.index < b.index) {\n            return -1;\n        }\n        else if (a.index > b.index) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    get isFinalTabstop() {\n        return this.index === 0;\n    }\n    get choice() {\n        return this._children.length === 1 && this._children[0] instanceof Choice\n            ? this._children[0]\n            : undefined;\n    }\n    clone() {\n        const ret = new Placeholder(this.index);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class Choice extends Marker {\n    constructor() {\n        super(...arguments);\n        this.options = [];\n    }\n    appendChild(marker) {\n        if (marker instanceof Text) {\n            marker.parent = this;\n            this.options.push(marker);\n        }\n        return this;\n    }\n    toString() {\n        return this.options[0].value;\n    }\n    len() {\n        return this.options[0].len();\n    }\n    clone() {\n        const ret = new Choice();\n        this.options.forEach(ret.appendChild, ret);\n        return ret;\n    }\n}\nexport class Transform extends Marker {\n    constructor() {\n        super(...arguments);\n        this.regexp = new RegExp('');\n    }\n    resolve(value) {\n        const _this = this;\n        let didMatch = false;\n        let ret = value.replace(this.regexp, function () {\n            didMatch = true;\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\n        });\n        // when the regex didn't match and when the transform has\n        // else branches, then run those\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\n            ret = this._replace([]);\n        }\n        return ret;\n    }\n    _replace(groups) {\n        let ret = '';\n        for (const marker of this._children) {\n            if (marker instanceof FormatString) {\n                let value = groups[marker.index] || '';\n                value = marker.resolve(value);\n                ret += value;\n            }\n            else {\n                ret += marker.toString();\n            }\n        }\n        return ret;\n    }\n    toString() {\n        return '';\n    }\n    clone() {\n        const ret = new Transform();\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class FormatString extends Marker {\n    constructor(index, shorthandName, ifValue, elseValue) {\n        super();\n        this.index = index;\n        this.shorthandName = shorthandName;\n        this.ifValue = ifValue;\n        this.elseValue = elseValue;\n    }\n    resolve(value) {\n        if (this.shorthandName === 'upcase') {\n            return !value ? '' : value.toLocaleUpperCase();\n        }\n        else if (this.shorthandName === 'downcase') {\n            return !value ? '' : value.toLocaleLowerCase();\n        }\n        else if (this.shorthandName === 'capitalize') {\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\n        }\n        else if (this.shorthandName === 'pascalcase') {\n            return !value ? '' : this._toPascalCase(value);\n        }\n        else if (this.shorthandName === 'camelcase') {\n            return !value ? '' : this._toCamelCase(value);\n        }\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\n            return this.ifValue;\n        }\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\n            return this.elseValue;\n        }\n        else {\n            return value || '';\n        }\n    }\n    _toPascalCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map(word => {\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    _toCamelCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map((word, index) => {\n            if (index === 0) {\n                return word.charAt(0).toLowerCase() + word.substr(1);\n            }\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    clone() {\n        const ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\n        return ret;\n    }\n}\nexport class Variable extends TransformableMarker {\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n    resolve(resolver) {\n        let value = resolver.resolve(this);\n        if (this.transform) {\n            value = this.transform.resolve(value || '');\n        }\n        if (value !== undefined) {\n            this._children = [new Text(value)];\n            return true;\n        }\n        return false;\n    }\n    clone() {\n        const ret = new Variable(this.name);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nfunction walk(marker, visitor) {\n    const stack = [...marker];\n    while (stack.length > 0) {\n        const marker = stack.shift();\n        const recurse = visitor(marker);\n        if (!recurse) {\n            break;\n        }\n        stack.unshift(...marker.children);\n    }\n}\nexport class TextmateSnippet extends Marker {\n    get placeholderInfo() {\n        if (!this._placeholders) {\n            // fill in placeholders\n            const all = [];\n            let last;\n            this.walk(function (candidate) {\n                if (candidate instanceof Placeholder) {\n                    all.push(candidate);\n                    last = !last || last.index < candidate.index ? candidate : last;\n                }\n                return true;\n            });\n            this._placeholders = { all, last };\n        }\n        return this._placeholders;\n    }\n    get placeholders() {\n        const { all } = this.placeholderInfo;\n        return all;\n    }\n    offset(marker) {\n        let pos = 0;\n        let found = false;\n        this.walk(candidate => {\n            if (candidate === marker) {\n                found = true;\n                return false;\n            }\n            pos += candidate.len();\n            return true;\n        });\n        if (!found) {\n            return -1;\n        }\n        return pos;\n    }\n    fullLen(marker) {\n        let ret = 0;\n        walk([marker], marker => {\n            ret += marker.len();\n            return true;\n        });\n        return ret;\n    }\n    enclosingPlaceholders(placeholder) {\n        const ret = [];\n        let { parent } = placeholder;\n        while (parent) {\n            if (parent instanceof Placeholder) {\n                ret.push(parent);\n            }\n            parent = parent.parent;\n        }\n        return ret;\n    }\n    resolveVariables(resolver) {\n        this.walk(candidate => {\n            if (candidate instanceof Variable) {\n                if (candidate.resolve(resolver)) {\n                    this._placeholders = undefined;\n                }\n            }\n            return true;\n        });\n        return this;\n    }\n    appendChild(child) {\n        this._placeholders = undefined;\n        return super.appendChild(child);\n    }\n    replace(child, others) {\n        this._placeholders = undefined;\n        return super.replace(child, others);\n    }\n    clone() {\n        const ret = new TextmateSnippet();\n        this._children = this.children.map(child => child.clone());\n        return ret;\n    }\n    walk(visitor) {\n        walk(this.children, visitor);\n    }\n}\nexport class SnippetParser {\n    constructor() {\n        this._scanner = new Scanner();\n        this._token = { type: 14 /* TokenType.EOF */, pos: 0, len: 0 };\n    }\n    static escape(value) {\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\n    }\n    static guessNeedsClipboard(template) {\n        return /\\${?CLIPBOARD/.test(template);\n    }\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\n        const snippet = new TextmateSnippet();\n        this.parseFragment(value, snippet);\n        this.ensureFinalTabstop(snippet, enforceFinalTabstop !== null && enforceFinalTabstop !== void 0 ? enforceFinalTabstop : false, insertFinalTabstop !== null && insertFinalTabstop !== void 0 ? insertFinalTabstop : false);\n        return snippet;\n    }\n    parseFragment(value, snippet) {\n        const offset = snippet.children.length;\n        this._scanner.text(value);\n        this._token = this._scanner.next();\n        while (this._parse(snippet)) {\n            // nothing\n        }\n        // fill in values for placeholders. the first placeholder of an index\n        // that has a value defines the value for all placeholders with that index\n        const placeholderDefaultValues = new Map();\n        const incompletePlaceholders = [];\n        snippet.walk(marker => {\n            if (marker instanceof Placeholder) {\n                if (marker.isFinalTabstop) {\n                    placeholderDefaultValues.set(0, undefined);\n                }\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\n                    placeholderDefaultValues.set(marker.index, marker.children);\n                }\n                else {\n                    incompletePlaceholders.push(marker);\n                }\n            }\n            return true;\n        });\n        for (const placeholder of incompletePlaceholders) {\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\n            if (defaultValues) {\n                const clone = new Placeholder(placeholder.index);\n                clone.transform = placeholder.transform;\n                for (const child of defaultValues) {\n                    clone.appendChild(child.clone());\n                }\n                snippet.replace(placeholder, [clone]);\n            }\n        }\n        return snippet.children.slice(offset);\n    }\n    ensureFinalTabstop(snippet, enforceFinalTabstop, insertFinalTabstop) {\n        if (enforceFinalTabstop || insertFinalTabstop && snippet.placeholders.length > 0) {\n            const finalTabstop = snippet.placeholders.find(p => p.index === 0);\n            if (!finalTabstop) {\n                // the snippet uses placeholders but has no\n                // final tabstop defined -> insert at the end\n                snippet.appendChild(new Placeholder(0));\n            }\n        }\n    }\n    _accept(type, value) {\n        if (type === undefined || this._token.type === type) {\n            const ret = !value ? true : this._scanner.tokenText(this._token);\n            this._token = this._scanner.next();\n            return ret;\n        }\n        return false;\n    }\n    _backTo(token) {\n        this._scanner.pos = token.pos + token.len;\n        this._token = token;\n        return false;\n    }\n    _until(type) {\n        const start = this._token;\n        while (this._token.type !== type) {\n            if (this._token.type === 14 /* TokenType.EOF */) {\n                return false;\n            }\n            else if (this._token.type === 5 /* TokenType.Backslash */) {\n                const nextToken = this._scanner.next();\n                if (nextToken.type !== 0 /* TokenType.Dollar */\n                    && nextToken.type !== 4 /* TokenType.CurlyClose */\n                    && nextToken.type !== 5 /* TokenType.Backslash */) {\n                    return false;\n                }\n            }\n            this._token = this._scanner.next();\n        }\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\n        this._token = this._scanner.next();\n        return value;\n    }\n    _parse(marker) {\n        return this._parseEscaped(marker)\n            || this._parseTabstopOrVariableName(marker)\n            || this._parseComplexPlaceholder(marker)\n            || this._parseComplexVariable(marker)\n            || this._parseAnything(marker);\n    }\n    // \\$, \\\\, \\} -> just text\n    _parseEscaped(marker) {\n        let value;\n        if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n            // saw a backslash, append escaped token or that backslash\n            value = this._accept(0 /* TokenType.Dollar */, true)\n                || this._accept(4 /* TokenType.CurlyClose */, true)\n                || this._accept(5 /* TokenType.Backslash */, true)\n                || value;\n            marker.appendChild(new Text(value));\n            return true;\n        }\n        return false;\n    }\n    // $foo -> variable, $1 -> tabstop\n    _parseTabstopOrVariableName(parent) {\n        let value;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && (value = this._accept(9 /* TokenType.VariableName */, true) || this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        parent.appendChild(/^\\d+$/.test(value)\n            ? new Placeholder(Number(value))\n            : new Variable(value));\n        return true;\n    }\n    // ${1:<children>}, ${1} -> placeholder\n    _parseComplexPlaceholder(parent) {\n        let index;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (index = this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const placeholder = new Placeholder(Number(index));\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${1:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(placeholder);\n                    return true;\n                }\n                if (this._parse(placeholder)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + index + ':'));\n                placeholder.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (placeholder.index > 0 && this._accept(7 /* TokenType.Pipe */)) {\n            // ${1|one,two,three|}\n            const choice = new Choice();\n            while (true) {\n                if (this._parseChoiceElement(choice)) {\n                    if (this._accept(2 /* TokenType.Comma */)) {\n                        // opt, -> more\n                        continue;\n                    }\n                    if (this._accept(7 /* TokenType.Pipe */)) {\n                        placeholder.appendChild(choice);\n                        if (this._accept(4 /* TokenType.CurlyClose */)) {\n                            // ..|} -> done\n                            parent.appendChild(placeholder);\n                            return true;\n                        }\n                    }\n                }\n                this._backTo(token);\n                return false;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1/<regex>/<format>/<options>}\n            if (this._parseTransform(placeholder)) {\n                parent.appendChild(placeholder);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(placeholder);\n            return true;\n        }\n        else {\n            // ${1 <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseChoiceElement(parent) {\n        const token = this._token;\n        const values = [];\n        while (true) {\n            if (this._token.type === 2 /* TokenType.Comma */ || this._token.type === 7 /* TokenType.Pipe */) {\n                break;\n            }\n            let value;\n            if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n                // \\, \\|, or \\\\\n                value = this._accept(2 /* TokenType.Comma */, true)\n                    || this._accept(7 /* TokenType.Pipe */, true)\n                    || this._accept(5 /* TokenType.Backslash */, true)\n                    || value;\n            }\n            else {\n                value = this._accept(undefined, true);\n            }\n            if (!value) {\n                // EOF\n                this._backTo(token);\n                return false;\n            }\n            values.push(value);\n        }\n        if (values.length === 0) {\n            this._backTo(token);\n            return false;\n        }\n        parent.appendChild(new Text(values.join('')));\n        return true;\n    }\n    // ${foo:<children>}, ${foo} -> variable\n    _parseComplexVariable(parent) {\n        let name;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (name = this._accept(9 /* TokenType.VariableName */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const variable = new Variable(name);\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${foo:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(variable);\n                    return true;\n                }\n                if (this._parse(variable)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + name + ':'));\n                variable.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${foo/<regex>/<format>/<options>}\n            if (this._parseTransform(variable)) {\n                parent.appendChild(variable);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${foo}\n            parent.appendChild(variable);\n            return true;\n        }\n        else {\n            // ${foo <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseTransform(parent) {\n        // ...<regex>/<format>/<options>}\n        const transform = new Transform();\n        let regexValue = '';\n        let regexOptions = '';\n        // (1) /regex\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                regexValue += escaped;\n                continue;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexValue += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        // (2) /format\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(5 /* TokenType.Backslash */, true) || this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                transform.appendChild(new Text(escaped));\n                continue;\n            }\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\n                continue;\n            }\n            return false;\n        }\n        // (3) /option\n        while (true) {\n            if (this._accept(4 /* TokenType.CurlyClose */)) {\n                break;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexOptions += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        try {\n            transform.regexp = new RegExp(regexValue, regexOptions);\n        }\n        catch (e) {\n            // invalid regexp\n            return false;\n        }\n        parent.transform = transform;\n        return true;\n    }\n    _parseFormatString(parent) {\n        const token = this._token;\n        if (!this._accept(0 /* TokenType.Dollar */)) {\n            return false;\n        }\n        let complex = false;\n        if (this._accept(3 /* TokenType.CurlyOpen */)) {\n            complex = true;\n        }\n        const index = this._accept(8 /* TokenType.Int */, true);\n        if (!index) {\n            this._backTo(token);\n            return false;\n        }\n        else if (!complex) {\n            // $1\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (!this._accept(1 /* TokenType.Colon */)) {\n            this._backTo(token);\n            return false;\n        }\n        if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1:/upcase}\n            const shorthand = this._accept(9 /* TokenType.VariableName */, true);\n            if (!shorthand || !this._accept(4 /* TokenType.CurlyClose */)) {\n                this._backTo(token);\n                return false;\n            }\n            else {\n                parent.appendChild(new FormatString(Number(index), shorthand));\n                return true;\n            }\n        }\n        else if (this._accept(11 /* TokenType.Plus */)) {\n            // ${1:+<if>}\n            const ifValue = this._until(4 /* TokenType.CurlyClose */);\n            if (ifValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\n                return true;\n            }\n        }\n        else if (this._accept(12 /* TokenType.Dash */)) {\n            // ${2:-<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        else if (this._accept(13 /* TokenType.QuestionMark */)) {\n            // ${2:?<if>:<else>}\n            const ifValue = this._until(1 /* TokenType.Colon */);\n            if (ifValue) {\n                const elseValue = this._until(4 /* TokenType.CurlyClose */);\n                if (elseValue) {\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\n                    return true;\n                }\n            }\n        }\n        else {\n            // ${1:<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        this._backTo(token);\n        return false;\n    }\n    _parseAnything(marker) {\n        if (this._token.type !== 14 /* TokenType.EOF */) {\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\n            this._accept(undefined);\n            return true;\n        }\n        return false;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../dom.js';\nimport { Toggle } from '../toggle/toggle.js';\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\nimport { Widget } from '../widget.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { Emitter } from '../../../common/event.js';\nimport './findInput.css';\nimport * as nls from '../../../../nls.js';\nconst NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\nconst NLS_PRESERVE_CASE_LABEL = nls.localize('label.preserveCaseToggle', \"Preserve Case\");\nexport class PreserveCaseToggle extends Toggle {\n    constructor(opts) {\n        super({\n            // TODO: does this need its own icon?\n            icon: Codicon.preserveCase,\n            title: NLS_PRESERVE_CASE_LABEL + opts.appendTitle,\n            isChecked: opts.isChecked,\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\n            inputActiveOptionForeground: opts.inputActiveOptionForeground,\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\n        });\n    }\n}\nexport class ReplaceInput extends Widget {\n    constructor(parent, contextViewProvider, _showOptionButtons, options) {\n        super();\n        this._showOptionButtons = _showOptionButtons;\n        this.fixFocusOnOptionClickEnabled = true;\n        this.cachedOptionsWidth = 0;\n        this._onDidOptionChange = this._register(new Emitter());\n        this.onDidOptionChange = this._onDidOptionChange.event;\n        this._onKeyDown = this._register(new Emitter());\n        this.onKeyDown = this._onKeyDown.event;\n        this._onMouseDown = this._register(new Emitter());\n        this._onInput = this._register(new Emitter());\n        this._onKeyUp = this._register(new Emitter());\n        this._onPreserveCaseKeyDown = this._register(new Emitter());\n        this.onPreserveCaseKeyDown = this._onPreserveCaseKeyDown.event;\n        this.contextViewProvider = contextViewProvider;\n        this.placeholder = options.placeholder || '';\n        this.validation = options.validation;\n        this.label = options.label || NLS_DEFAULT_LABEL;\n        this.inputActiveOptionBorder = options.inputActiveOptionBorder;\n        this.inputActiveOptionForeground = options.inputActiveOptionForeground;\n        this.inputActiveOptionBackground = options.inputActiveOptionBackground;\n        this.inputBackground = options.inputBackground;\n        this.inputForeground = options.inputForeground;\n        this.inputBorder = options.inputBorder;\n        this.inputValidationInfoBorder = options.inputValidationInfoBorder;\n        this.inputValidationInfoBackground = options.inputValidationInfoBackground;\n        this.inputValidationInfoForeground = options.inputValidationInfoForeground;\n        this.inputValidationWarningBorder = options.inputValidationWarningBorder;\n        this.inputValidationWarningBackground = options.inputValidationWarningBackground;\n        this.inputValidationWarningForeground = options.inputValidationWarningForeground;\n        this.inputValidationErrorBorder = options.inputValidationErrorBorder;\n        this.inputValidationErrorBackground = options.inputValidationErrorBackground;\n        this.inputValidationErrorForeground = options.inputValidationErrorForeground;\n        const appendPreserveCaseLabel = options.appendPreserveCaseLabel || '';\n        const history = options.history || [];\n        const flexibleHeight = !!options.flexibleHeight;\n        const flexibleWidth = !!options.flexibleWidth;\n        const flexibleMaxHeight = options.flexibleMaxHeight;\n        this.domNode = document.createElement('div');\n        this.domNode.classList.add('monaco-findInput');\n        this.inputBox = this._register(new HistoryInputBox(this.domNode, this.contextViewProvider, {\n            ariaLabel: this.label || '',\n            placeholder: this.placeholder || '',\n            validationOptions: {\n                validation: this.validation\n            },\n            inputBackground: this.inputBackground,\n            inputForeground: this.inputForeground,\n            inputBorder: this.inputBorder,\n            inputValidationInfoBackground: this.inputValidationInfoBackground,\n            inputValidationInfoForeground: this.inputValidationInfoForeground,\n            inputValidationInfoBorder: this.inputValidationInfoBorder,\n            inputValidationWarningBackground: this.inputValidationWarningBackground,\n            inputValidationWarningForeground: this.inputValidationWarningForeground,\n            inputValidationWarningBorder: this.inputValidationWarningBorder,\n            inputValidationErrorBackground: this.inputValidationErrorBackground,\n            inputValidationErrorForeground: this.inputValidationErrorForeground,\n            inputValidationErrorBorder: this.inputValidationErrorBorder,\n            history,\n            showHistoryHint: options.showHistoryHint,\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight\n        }));\n        this.preserveCase = this._register(new PreserveCaseToggle({\n            appendTitle: appendPreserveCaseLabel,\n            isChecked: false,\n            inputActiveOptionBorder: this.inputActiveOptionBorder,\n            inputActiveOptionForeground: this.inputActiveOptionForeground,\n            inputActiveOptionBackground: this.inputActiveOptionBackground,\n        }));\n        this._register(this.preserveCase.onChange(viaKeyboard => {\n            this._onDidOptionChange.fire(viaKeyboard);\n            if (!viaKeyboard && this.fixFocusOnOptionClickEnabled) {\n                this.inputBox.focus();\n            }\n            this.validate();\n        }));\n        this._register(this.preserveCase.onKeyDown(e => {\n            this._onPreserveCaseKeyDown.fire(e);\n        }));\n        if (this._showOptionButtons) {\n            this.cachedOptionsWidth = this.preserveCase.width();\n        }\n        else {\n            this.cachedOptionsWidth = 0;\n        }\n        // Arrow-Key support to navigate between options\n        const indexes = [this.preserveCase.domNode];\n        this.onkeydown(this.domNode, (event) => {\n            if (event.equals(15 /* KeyCode.LeftArrow */) || event.equals(17 /* KeyCode.RightArrow */) || event.equals(9 /* KeyCode.Escape */)) {\n                const index = indexes.indexOf(document.activeElement);\n                if (index >= 0) {\n                    let newIndex = -1;\n                    if (event.equals(17 /* KeyCode.RightArrow */)) {\n                        newIndex = (index + 1) % indexes.length;\n                    }\n                    else if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                        if (index === 0) {\n                            newIndex = indexes.length - 1;\n                        }\n                        else {\n                            newIndex = index - 1;\n                        }\n                    }\n                    if (event.equals(9 /* KeyCode.Escape */)) {\n                        indexes[index].blur();\n                        this.inputBox.focus();\n                    }\n                    else if (newIndex >= 0) {\n                        indexes[newIndex].focus();\n                    }\n                    dom.EventHelper.stop(event, true);\n                }\n            }\n        });\n        const controls = document.createElement('div');\n        controls.className = 'controls';\n        controls.style.display = this._showOptionButtons ? 'block' : 'none';\n        controls.appendChild(this.preserveCase.domNode);\n        this.domNode.appendChild(controls);\n        parent === null || parent === void 0 ? void 0 : parent.appendChild(this.domNode);\n        this.onkeydown(this.inputBox.inputElement, (e) => this._onKeyDown.fire(e));\n        this.onkeyup(this.inputBox.inputElement, (e) => this._onKeyUp.fire(e));\n        this.oninput(this.inputBox.inputElement, (e) => this._onInput.fire());\n        this.onmousedown(this.inputBox.inputElement, (e) => this._onMouseDown.fire(e));\n    }\n    enable() {\n        this.domNode.classList.remove('disabled');\n        this.inputBox.enable();\n        this.preserveCase.enable();\n    }\n    disable() {\n        this.domNode.classList.add('disabled');\n        this.inputBox.disable();\n        this.preserveCase.disable();\n    }\n    setEnabled(enabled) {\n        if (enabled) {\n            this.enable();\n        }\n        else {\n            this.disable();\n        }\n    }\n    style(styles) {\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\n        this.inputActiveOptionForeground = styles.inputActiveOptionForeground;\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\n        this.inputBackground = styles.inputBackground;\n        this.inputForeground = styles.inputForeground;\n        this.inputBorder = styles.inputBorder;\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\n        this.applyStyles();\n    }\n    applyStyles() {\n        if (this.domNode) {\n            const toggleStyles = {\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\n                inputActiveOptionForeground: this.inputActiveOptionForeground,\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\n            };\n            this.preserveCase.style(toggleStyles);\n            const inputBoxStyles = {\n                inputBackground: this.inputBackground,\n                inputForeground: this.inputForeground,\n                inputBorder: this.inputBorder,\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\n                inputValidationErrorBorder: this.inputValidationErrorBorder\n            };\n            this.inputBox.style(inputBoxStyles);\n        }\n    }\n    select() {\n        this.inputBox.select();\n    }\n    focus() {\n        this.inputBox.focus();\n    }\n    getPreserveCase() {\n        return this.preserveCase.checked;\n    }\n    setPreserveCase(value) {\n        this.preserveCase.checked = value;\n    }\n    focusOnPreserve() {\n        this.preserveCase.focus();\n    }\n    validate() {\n        if (this.inputBox) {\n            this.inputBox.validate();\n        }\n    }\n    set width(newWidth) {\n        this.inputBox.paddingRight = this.cachedOptionsWidth;\n        this.inputBox.width = newWidth;\n        this.domNode.style.width = newWidth + 'px';\n    }\n    dispose() {\n        super.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { FindInput } from '../../../base/browser/ui/findinput/findInput.js';\nimport { ReplaceInput } from '../../../base/browser/ui/findinput/replaceInput.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../contextkey/common/contextkey.js';\nimport { KeybindingsRegistry } from '../../keybinding/common/keybindingsRegistry.js';\nimport { localize } from '../../../nls.js';\nimport { DisposableStore, toDisposable } from '../../../base/common/lifecycle.js';\nexport const historyNavigationVisible = new RawContextKey('suggestWidgetVisible', false, localize('suggestWidgetVisible', \"Whether suggestion are visible\"));\nconst HistoryNavigationWidgetFocusContext = 'historyNavigationWidgetFocus';\nconst HistoryNavigationForwardsEnablementContext = 'historyNavigationForwardsEnabled';\nconst HistoryNavigationBackwardsEnablementContext = 'historyNavigationBackwardsEnabled';\nlet lastFocusedWidget = undefined;\nconst widgets = [];\nexport function registerAndCreateHistoryNavigationContext(contextKeyService, widget) {\n    if (widgets.includes(widget)) {\n        throw new Error('Cannot register the same widget multiple times');\n    }\n    widgets.push(widget);\n    const disposableStore = new DisposableStore();\n    const scopedContextKeyService = disposableStore.add(contextKeyService.createScoped(widget.element));\n    const historyNavigationWidgetFocus = new RawContextKey(HistoryNavigationWidgetFocusContext, false).bindTo(scopedContextKeyService);\n    const historyNavigationForwardsEnablement = new RawContextKey(HistoryNavigationForwardsEnablementContext, true).bindTo(scopedContextKeyService);\n    const historyNavigationBackwardsEnablement = new RawContextKey(HistoryNavigationBackwardsEnablementContext, true).bindTo(scopedContextKeyService);\n    const onDidFocus = () => {\n        historyNavigationWidgetFocus.set(true);\n        lastFocusedWidget = widget;\n    };\n    const onDidBlur = () => {\n        historyNavigationWidgetFocus.set(false);\n        if (lastFocusedWidget === widget) {\n            lastFocusedWidget = undefined;\n        }\n    };\n    // Check for currently being focused\n    if (widget.element === document.activeElement) {\n        onDidFocus();\n    }\n    disposableStore.add(widget.onDidFocus(() => onDidFocus()));\n    disposableStore.add(widget.onDidBlur(() => onDidBlur()));\n    disposableStore.add(toDisposable(() => {\n        widgets.splice(widgets.indexOf(widget), 1);\n        onDidBlur();\n    }));\n    return {\n        scopedContextKeyService,\n        historyNavigationForwardsEnablement,\n        historyNavigationBackwardsEnablement,\n        dispose() {\n            disposableStore.dispose();\n        }\n    };\n}\nlet ContextScopedFindInput = class ContextScopedFindInput extends FindInput {\n    constructor(container, contextViewProvider, options, contextKeyService, showFindOptions = false) {\n        super(container, contextViewProvider, showFindOptions, options);\n        this._register(registerAndCreateHistoryNavigationContext(contextKeyService, this.inputBox));\n    }\n};\nContextScopedFindInput = __decorate([\n    __param(3, IContextKeyService)\n], ContextScopedFindInput);\nexport { ContextScopedFindInput };\nlet ContextScopedReplaceInput = class ContextScopedReplaceInput extends ReplaceInput {\n    constructor(container, contextViewProvider, options, contextKeyService, showReplaceOptions = false) {\n        super(container, contextViewProvider, showReplaceOptions, options);\n        this._register(registerAndCreateHistoryNavigationContext(contextKeyService, this.inputBox));\n    }\n};\nContextScopedReplaceInput = __decorate([\n    __param(3, IContextKeyService)\n], ContextScopedReplaceInput);\nexport { ContextScopedReplaceInput };\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'history.showPrevious',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext), ContextKeyExpr.equals(HistoryNavigationBackwardsEnablementContext, true), historyNavigationVisible.isEqualTo(false)),\n    primary: 16 /* KeyCode.UpArrow */,\n    secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n    handler: (accessor) => {\n        if (lastFocusedWidget) {\n            lastFocusedWidget.showPreviousValue();\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'history.showNext',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext), ContextKeyExpr.equals(HistoryNavigationForwardsEnablementContext, true), historyNavigationVisible.isEqualTo(false)),\n    primary: 18 /* KeyCode.DownArrow */,\n    secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n    handler: (accessor) => {\n        if (lastFocusedWidget) {\n            lastFocusedWidget.showNextValue();\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancellationError, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { historyNavigationVisible } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nexport const Context = {\n    Visible: historyNavigationVisible,\n    HasFocusedSuggestion: new RawContextKey('suggestWidgetHasFocusedSuggestion', false, localize('suggestWidgetHasSelection', \"Whether any suggestion is focused\")),\n    DetailsVisible: new RawContextKey('suggestWidgetDetailsVisible', false, localize('suggestWidgetDetailsVisible', \"Whether suggestion details are visible\")),\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false, localize('suggestWidgetMultipleSuggestions', \"Whether there are multiple suggestions to pick from\")),\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true, localize('suggestionMakesTextEdit', \"Whether inserting the current suggestion yields in a change or has everything already been typed\")),\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true, localize('acceptSuggestionOnEnter', \"Whether suggestions are inserted when pressing Enter\")),\n    HasInsertAndReplaceRange: new RawContextKey('suggestionHasInsertAndReplaceRange', false, localize('suggestionHasInsertAndReplaceRange', \"Whether the current suggestion has insert and replace behaviour\")),\n    InsertMode: new RawContextKey('suggestionInsertMode', undefined, { type: 'string', description: localize('suggestionInsertMode', \"Whether the default behaviour is to insert or replace\") }),\n    CanResolve: new RawContextKey('suggestionCanResolve', false, localize('suggestionCanResolve', \"Whether the current suggestion supports to resolve further details\")),\n};\nexport const suggestWidgetStatusbarMenu = new MenuId('suggestWidgetStatusBar');\nexport class CompletionItem {\n    constructor(position, completion, container, provider) {\n        this.position = position;\n        this.completion = completion;\n        this.container = container;\n        this.provider = provider;\n        // validation\n        this.isInvalid = false;\n        // sorting, filtering\n        this.score = FuzzyScore.Default;\n        this.distance = 0;\n        this.textLabel = typeof completion.label === 'string'\n            ? completion.label\n            : completion.label.label;\n        // ensure lower-variants (perf)\n        this.labelLow = this.textLabel.toLowerCase();\n        // validate label\n        this.isInvalid = !this.textLabel;\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\n        this.extensionId = completion.extensionId;\n        // normalize ranges\n        if (Range.isIRange(completion.range)) {\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            // validate range\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range) || completion.range.startLineNumber !== position.lineNumber;\n        }\n        else {\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\n            // validate ranges\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range.insert) || Range.spansMultipleLines(completion.range.replace)\n                || completion.range.insert.startLineNumber !== position.lineNumber || completion.range.replace.startLineNumber !== position.lineNumber\n                || completion.range.insert.startColumn !== completion.range.replace.startColumn;\n        }\n        // create the suggestion resolver\n        if (typeof provider.resolveCompletionItem !== 'function') {\n            this._resolveCache = Promise.resolve();\n            this._isResolved = true;\n        }\n    }\n    // ---- resolving\n    get isResolved() {\n        return !!this._isResolved;\n    }\n    resolve(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._resolveCache) {\n                const sub = token.onCancellationRequested(() => {\n                    this._resolveCache = undefined;\n                    this._isResolved = false;\n                });\n                this._resolveCache = Promise.resolve(this.provider.resolveCompletionItem(this.completion, token)).then(value => {\n                    Object.assign(this.completion, value);\n                    this._isResolved = true;\n                    sub.dispose();\n                }, err => {\n                    if (isCancellationError(err)) {\n                        // the IPC queue will reject the request with the\n                        // cancellation error -> reset cached\n                        this._resolveCache = undefined;\n                        this._isResolved = false;\n                    }\n                });\n            }\n            return this._resolveCache;\n        });\n    }\n}\nexport class CompletionOptions {\n    constructor(snippetSortOrder = 2 /* SnippetSortOrder.Bottom */, kindFilter = new Set(), providerFilter = new Set(), showDeprecated = true) {\n        this.snippetSortOrder = snippetSortOrder;\n        this.kindFilter = kindFilter;\n        this.providerFilter = providerFilter;\n        this.showDeprecated = showDeprecated;\n    }\n}\nCompletionOptions.default = new CompletionOptions();\nlet _snippetSuggestSupport;\nexport function getSnippetSuggestSupport() {\n    return _snippetSuggestSupport;\n}\nexport class CompletionItemModel {\n    constructor(items, needsClipboard, durations, disposable) {\n        this.items = items;\n        this.needsClipboard = needsClipboard;\n        this.durations = durations;\n        this.disposable = disposable;\n    }\n}\nexport function provideSuggestionItems(registry, model, position, options = CompletionOptions.default, context = { triggerKind: 0 /* languages.CompletionTriggerKind.Invoke */ }, token = CancellationToken.None) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const sw = new StopWatch(true);\n        position = position.clone();\n        const word = model.getWordAtPosition(position);\n        const defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\n        const defaultRange = { replace: defaultReplaceRange, insert: defaultReplaceRange.setEndPosition(position.lineNumber, position.column) };\n        const result = [];\n        const disposables = new DisposableStore();\n        const durations = [];\n        let needsClipboard = false;\n        const onCompletionList = (provider, container, sw) => {\n            var _a, _b, _c;\n            let didAddResult = false;\n            if (!container) {\n                return didAddResult;\n            }\n            for (const suggestion of container.suggestions) {\n                if (!options.kindFilter.has(suggestion.kind)) {\n                    // skip if not showing deprecated suggestions\n                    if (!options.showDeprecated && ((_a = suggestion === null || suggestion === void 0 ? void 0 : suggestion.tags) === null || _a === void 0 ? void 0 : _a.includes(1 /* languages.CompletionItemTag.Deprecated */))) {\n                        continue;\n                    }\n                    // fill in default range when missing\n                    if (!suggestion.range) {\n                        suggestion.range = defaultRange;\n                    }\n                    // fill in default sortText when missing\n                    if (!suggestion.sortText) {\n                        suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.label;\n                    }\n                    if (!needsClipboard && suggestion.insertTextRules && suggestion.insertTextRules & 4 /* languages.CompletionItemInsertTextRule.InsertAsSnippet */) {\n                        needsClipboard = SnippetParser.guessNeedsClipboard(suggestion.insertText);\n                    }\n                    result.push(new CompletionItem(position, suggestion, container, provider));\n                    didAddResult = true;\n                }\n            }\n            if (isDisposable(container)) {\n                disposables.add(container);\n            }\n            durations.push({\n                providerName: (_b = provider._debugDisplayName) !== null && _b !== void 0 ? _b : 'unknown_provider', elapsedProvider: (_c = container.duration) !== null && _c !== void 0 ? _c : -1, elapsedOverall: sw.elapsed()\n            });\n            return didAddResult;\n        };\n        // ask for snippets in parallel to asking \"real\" providers. Only do something if configured to\n        // do so - no snippet filter, no special-providers-only request\n        const snippetCompletions = (() => __awaiter(this, void 0, void 0, function* () {\n            if (!_snippetSuggestSupport || options.kindFilter.has(27 /* languages.CompletionItemKind.Snippet */)) {\n                return;\n            }\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(_snippetSuggestSupport)) {\n                return;\n            }\n            const sw = new StopWatch(true);\n            const list = yield _snippetSuggestSupport.provideCompletionItems(model, position, context, token);\n            onCompletionList(_snippetSuggestSupport, list, sw);\n        }))();\n        // add suggestions from contributed providers - providers are ordered in groups of\n        // equal score and once a group produces a result the process stops\n        // get provider groups, always add snippet suggestion provider\n        for (const providerGroup of registry.orderedGroups(model)) {\n            // for each support in the group ask for suggestions\n            let didAddResult = false;\n            yield Promise.all(providerGroup.map((provider) => __awaiter(this, void 0, void 0, function* () {\n                if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\n                    return;\n                }\n                try {\n                    const sw = new StopWatch(true);\n                    const list = yield provider.provideCompletionItems(model, position, context, token);\n                    didAddResult = onCompletionList(provider, list, sw) || didAddResult;\n                }\n                catch (err) {\n                    onUnexpectedExternalError(err);\n                }\n            })));\n            if (didAddResult || token.isCancellationRequested) {\n                break;\n            }\n        }\n        yield snippetCompletions;\n        if (token.isCancellationRequested) {\n            disposables.dispose();\n            return Promise.reject(new CancellationError());\n        }\n        return new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)), needsClipboard, { entries: durations, elapsed: sw.elapsed() }, disposables);\n    });\n}\nfunction defaultComparator(a, b) {\n    // check with 'sortText'\n    if (a.sortTextLow && b.sortTextLow) {\n        if (a.sortTextLow < b.sortTextLow) {\n            return -1;\n        }\n        else if (a.sortTextLow > b.sortTextLow) {\n            return 1;\n        }\n    }\n    // check with 'label'\n    if (a.textLabel < b.textLabel) {\n        return -1;\n    }\n    else if (a.textLabel > b.textLabel) {\n        return 1;\n    }\n    // check with 'type'\n    return a.completion.kind - b.completion.kind;\n}\nfunction snippetUpComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nfunction snippetDownComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nconst _snippetComparators = new Map();\n_snippetComparators.set(0 /* SnippetSortOrder.Top */, snippetUpComparator);\n_snippetComparators.set(2 /* SnippetSortOrder.Bottom */, snippetDownComparator);\n_snippetComparators.set(1 /* SnippetSortOrder.Inline */, defaultComparator);\nexport function getSuggestionComparator(snippetConfig) {\n    return _snippetComparators.get(snippetConfig);\n}\nCommandsRegistry.registerCommand('_executeCompletionItemProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, position, triggerCharacter, maxItemsToResolve] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    assertType(typeof maxItemsToResolve === 'number' || !maxItemsToResolve);\n    const { completionProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = {\n            incomplete: false,\n            suggestions: []\n        };\n        const resolving = [];\n        const completions = yield provideSuggestionItems(completionProvider, ref.object.textEditorModel, Position.lift(position), undefined, { triggerCharacter, triggerKind: triggerCharacter ? 1 /* languages.CompletionTriggerKind.TriggerCharacter */ : 0 /* languages.CompletionTriggerKind.Invoke */ });\n        for (const item of completions.items) {\n            if (resolving.length < (maxItemsToResolve !== null && maxItemsToResolve !== void 0 ? maxItemsToResolve : 0)) {\n                resolving.push(item.resolve(CancellationToken.None));\n            }\n            result.incomplete = result.incomplete || item.container.incomplete;\n            result.suggestions.push(item.completion);\n        }\n        try {\n            yield Promise.all(resolving);\n            return result;\n        }\n        finally {\n            setTimeout(() => completions.disposable.dispose(), 100);\n        }\n    }\n    finally {\n        ref.dispose();\n    }\n}));\nexport function showSimpleSuggestions(editor, provider) {\n    var _a;\n    (_a = editor.getContribution('editor.contrib.suggestController')) === null || _a === void 0 ? void 0 : _a.triggerSuggest(new Set().add(provider), undefined, true);\n}\nexport class QuickSuggestionsOptions {\n    static isAllOff(config) {\n        return config.other === 'off' && config.comments === 'off' && config.strings === 'off';\n    }\n    static isAllOn(config) {\n        return config.other === 'on' && config.comments === 'on' && config.strings === 'on';\n    }\n    static valueFor(config, tokenType) {\n        switch (tokenType) {\n            case 1 /* StandardTokenType.Comment */: return config.comments;\n            case 2 /* StandardTokenType.String */: return config.strings;\n            default: return config.other;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction, HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverParticipantRegistry, HoverRangeAnchor } from './hoverTypes.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { Context as SuggestContext } from '../../suggest/browser/suggest.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nconst $ = dom.$;\nlet ContentHoverController = class ContentHoverController extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._widget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor));\n        this._isChangingDecorations = false;\n        this._messages = [];\n        this._messagesAreComplete = false;\n        // Instantiate participants and sort them by `hoverOrdinal` which is relevant for rendering order.\n        this._participants = [];\n        for (const participant of HoverParticipantRegistry.getAll()) {\n            this._participants.push(this._instantiationService.createInstance(participant, this._editor));\n        }\n        this._participants.sort((p1, p2) => p1.hoverOrdinal - p2.hoverOrdinal);\n        this._computer = new ContentHoverComputer(this._editor, this._participants);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value, result.isComplete, result.hasLoadingMessage);\n        }));\n        this._register(this._editor.onDidChangeModelDecorations(() => {\n            if (this._isChangingDecorations) {\n                return;\n            }\n            this._onModelDecorationsChanged();\n        }));\n        this._register(dom.addStandardDisposableListener(this._widget.getDomNode(), 'keydown', (e) => {\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                this.hide();\n            }\n        }));\n        this._register(TokenizationRegistry.onDidChange(() => {\n            if (this._widget.position && this._computer.anchor && this._messages.length > 0) {\n                this._widget.clear();\n                this._renderMessages(this._computer.anchor, this._messages);\n            }\n        }));\n    }\n    _onModelDecorationsChanged() {\n        if (this._widget.position) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            if (!this._widget.isColorPickerVisible) { // TODO@Michel ensure that displayed text for other decorations is computed even if color picker is in place\n                this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n            }\n        }\n    }\n    maybeShowAt(mouseEvent) {\n        const anchorCandidates = [];\n        for (const participant of this._participants) {\n            if (participant.suggestHoverAnchor) {\n                const anchor = participant.suggestHoverAnchor(mouseEvent);\n                if (anchor) {\n                    anchorCandidates.push(anchor);\n                }\n            }\n        }\n        const target = mouseEvent.target;\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            anchorCandidates.push(new HoverRangeAnchor(0, target.range));\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            const epsilon = this._editor.getOption(46 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth / 2;\n            if (!target.detail.isAfterLines && typeof target.detail.horizontalDistanceToText === 'number' && target.detail.horizontalDistanceToText < epsilon) {\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range));\n            }\n        }\n        if (anchorCandidates.length === 0) {\n            return false;\n        }\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\n        this._startShowingAt(anchorCandidates[0], 0 /* HoverStartMode.Delayed */, false);\n        return true;\n    }\n    startShowingAtRange(range, mode, focus) {\n        this._startShowingAt(new HoverRangeAnchor(0, range), mode, focus);\n    }\n    _startShowingAt(anchor, mode, focus) {\n        if (this._computer.anchor && this._computer.anchor.equals(anchor)) {\n            // We have to show the widget at the exact same range as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        if (this._widget.position) {\n            // The range might have changed, but the hover is visible\n            // Instead of hiding it completely, filter out messages that are still in the new range and\n            // kick off a new computation\n            if (!this._computer.anchor || !anchor.canAdoptVisibleHover(this._computer.anchor, this._widget.position)) {\n                this.hide();\n            }\n            else {\n                const filteredMessages = this._messages.filter((m) => m.isValidForHoverAnchor(anchor));\n                if (filteredMessages.length === 0) {\n                    this.hide();\n                }\n                else if (filteredMessages.length === this._messages.length && this._messagesAreComplete) {\n                    // no change\n                    return;\n                }\n                else {\n                    this._renderMessages(anchor, filteredMessages);\n                }\n            }\n        }\n        this._computer.anchor = anchor;\n        this._computer.shouldFocus = focus;\n        this._hoverOperation.start(mode);\n    }\n    hide() {\n        this._computer.anchor = null;\n        this._hoverOperation.cancel();\n        this._widget.hide();\n    }\n    isColorPickerVisible() {\n        return this._widget.isColorPickerVisible;\n    }\n    containsNode(node) {\n        return this._widget.getDomNode().contains(node);\n    }\n    _addLoadingMessage(result) {\n        if (this._computer.anchor) {\n            for (const participant of this._participants) {\n                if (participant.createLoadingMessage) {\n                    const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n                    if (loadingMessage) {\n                        return result.slice(0).concat([loadingMessage]);\n                    }\n                }\n            }\n        }\n        return result;\n    }\n    _withResult(result, isComplete, hasLoadingMessage) {\n        this._messages = (hasLoadingMessage ? this._addLoadingMessage(result) : result);\n        this._messagesAreComplete = isComplete;\n        if (this._computer.anchor && this._messages.length > 0) {\n            this._renderMessages(this._computer.anchor, this._messages);\n        }\n        else if (isComplete) {\n            this.hide();\n        }\n    }\n    _renderMessages(anchor, messages) {\n        const { showAtPosition, showAtRange, highlightRange } = ContentHoverController.computeHoverRanges(anchor.range, messages);\n        const disposables = new DisposableStore();\n        const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\n        const fragment = document.createDocumentFragment();\n        let colorPicker = null;\n        const context = {\n            fragment,\n            statusBar,\n            setColorPicker: (widget) => colorPicker = widget,\n            onContentsChanged: () => this._widget.onContentsChanged(),\n            hide: () => this.hide()\n        };\n        for (const participant of this._participants) {\n            const hoverParts = messages.filter(msg => msg.owner === participant);\n            if (hoverParts.length > 0) {\n                disposables.add(participant.renderHoverParts(context, hoverParts));\n            }\n        }\n        if (statusBar.hasContent) {\n            fragment.appendChild(statusBar.hoverElement);\n        }\n        if (fragment.hasChildNodes()) {\n            if (highlightRange) {\n                const highlightDecoration = this._editor.createDecorationsCollection();\n                try {\n                    this._isChangingDecorations = true;\n                    highlightDecoration.set([{\n                            range: highlightRange,\n                            options: ContentHoverController._DECORATION_OPTIONS\n                        }]);\n                }\n                finally {\n                    this._isChangingDecorations = false;\n                }\n                disposables.add(toDisposable(() => {\n                    try {\n                        this._isChangingDecorations = true;\n                        highlightDecoration.clear();\n                    }\n                    finally {\n                        this._isChangingDecorations = false;\n                    }\n                }));\n            }\n            this._widget.showAt(fragment, new ContentHoverVisibleData(colorPicker, showAtPosition, showAtRange, this._editor.getOption(55 /* EditorOption.hover */).above, this._computer.shouldFocus, disposables));\n        }\n        else {\n            disposables.dispose();\n        }\n    }\n    static computeHoverRanges(anchorRange, messages) {\n        // The anchor range is always on a single line\n        const anchorLineNumber = anchorRange.startLineNumber;\n        let renderStartColumn = anchorRange.startColumn;\n        let renderEndColumn = anchorRange.endColumn;\n        let highlightRange = messages[0].range;\n        let forceShowAtRange = null;\n        for (const msg of messages) {\n            highlightRange = Range.plusRange(highlightRange, msg.range);\n            if (msg.range.startLineNumber === anchorLineNumber && msg.range.endLineNumber === anchorLineNumber) {\n                // this message has a range that is completely sitting on the line of the anchor\n                renderStartColumn = Math.min(renderStartColumn, msg.range.startColumn);\n                renderEndColumn = Math.max(renderEndColumn, msg.range.endColumn);\n            }\n            if (msg.forceShowAtRange) {\n                forceShowAtRange = msg.range;\n            }\n        }\n        return {\n            showAtPosition: forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorRange.startLineNumber, renderStartColumn),\n            showAtRange: forceShowAtRange ? forceShowAtRange : new Range(anchorLineNumber, renderStartColumn, anchorLineNumber, renderEndColumn),\n            highlightRange\n        };\n    }\n};\nContentHoverController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'content-hover-highlight',\n    className: 'hoverHighlight'\n});\nContentHoverController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverController);\nexport { ContentHoverController };\nclass ContentHoverVisibleData {\n    constructor(colorPicker, showAtPosition, showAtRange, preferAbove, stoleFocus, disposables) {\n        this.colorPicker = colorPicker;\n        this.showAtPosition = showAtPosition;\n        this.showAtRange = showAtRange;\n        this.preferAbove = preferAbove;\n        this.stoleFocus = stoleFocus;\n        this.disposables = disposables;\n    }\n}\nlet ContentHoverWidget = class ContentHoverWidget extends Disposable {\n    constructor(_editor, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextKeyService = _contextKeyService;\n        this.allowEditorOverflow = true;\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(this._contextKeyService);\n        this._hover = this._register(new HoverWidget());\n        this._visibleData = null;\n        this._register(this._editor.onDidLayoutChange(() => this._layout()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._setVisibleData(null);\n        this._layout();\n        this._editor.addContentWidget(this);\n    }\n    /**\n     * Returns `null` if the hover is not visible.\n     */\n    get position() {\n        var _a, _b;\n        return (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition) !== null && _b !== void 0 ? _b : null;\n    }\n    get isColorPickerVisible() {\n        var _a;\n        return Boolean((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker);\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n        if (this._visibleData) {\n            this._visibleData.disposables.dispose();\n        }\n        super.dispose();\n    }\n    getId() {\n        return ContentHoverWidget.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        if (!this._visibleData) {\n            return null;\n        }\n        let preferAbove = this._visibleData.preferAbove;\n        if (!preferAbove && this._contextKeyService.getContextKeyValue(SuggestContext.Visible.key)) {\n            // Prefer rendering above if the suggest widget is visible\n            preferAbove = true;\n        }\n        return {\n            position: this._visibleData.showAtPosition,\n            range: this._visibleData.showAtRange,\n            preference: (preferAbove\n                ? [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */]\n                : [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]),\n        };\n    }\n    _setVisibleData(visibleData) {\n        if (this._visibleData) {\n            this._visibleData.disposables.dispose();\n        }\n        this._visibleData = visibleData;\n        this._hoverVisibleKey.set(!!this._visibleData);\n        this._hover.containerDomNode.classList.toggle('hidden', !this._visibleData);\n    }\n    _layout() {\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250);\n        const { fontSize, lineHeight } = this._editor.getOption(46 /* EditorOption.fontInfo */);\n        this._hover.contentsDomNode.style.fontSize = `${fontSize}px`;\n        this._hover.contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this._hover.contentsDomNode.style.maxHeight = `${height}px`;\n        this._hover.contentsDomNode.style.maxWidth = `${Math.max(this._editor.getLayoutInfo().width * 0.66, 500)}px`;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    showAt(node, visibleData) {\n        this._setVisibleData(visibleData);\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._hover.contentsDomNode.style.paddingBottom = '';\n        this._updateFont();\n        this.onContentsChanged();\n        // Simply force a synchronous render on the editor\n        // such that the widget does not really render with left = '0px'\n        this._editor.render();\n        // See https://github.com/microsoft/vscode/issues/140339\n        // TODO: Doing a second layout of the hover after force rendering the editor\n        this.onContentsChanged();\n        if (visibleData.stoleFocus) {\n            this._hover.containerDomNode.focus();\n        }\n        if (visibleData.colorPicker) {\n            visibleData.colorPicker.layout();\n        }\n    }\n    hide() {\n        if (this._visibleData) {\n            const stoleFocus = this._visibleData.stoleFocus;\n            this._setVisibleData(null);\n            this._editor.layoutContentWidget(this);\n            if (stoleFocus) {\n                this._editor.focus();\n            }\n        }\n    }\n    onContentsChanged() {\n        this._editor.layoutContentWidget(this);\n        this._hover.onContentsChanged();\n        const scrollDimensions = this._hover.scrollbar.getScrollDimensions();\n        const hasHorizontalScrollbar = (scrollDimensions.scrollWidth > scrollDimensions.width);\n        if (hasHorizontalScrollbar) {\n            // There is just a horizontal scrollbar\n            const extraBottomPadding = `${this._hover.scrollbar.options.horizontalScrollbarSize}px`;\n            if (this._hover.contentsDomNode.style.paddingBottom !== extraBottomPadding) {\n                this._hover.contentsDomNode.style.paddingBottom = extraBottomPadding;\n                this._editor.layoutContentWidget(this);\n                this._hover.onContentsChanged();\n            }\n        }\n    }\n    clear() {\n        this._hover.contentsDomNode.textContent = '';\n    }\n};\nContentHoverWidget.ID = 'editor.contrib.contentHoverWidget';\nContentHoverWidget = __decorate([\n    __param(1, IContextKeyService)\n], ContentHoverWidget);\nexport { ContentHoverWidget };\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n    constructor(_keybindingService) {\n        super();\n        this._keybindingService = _keybindingService;\n        this._hasContent = false;\n        this.hoverElement = $('div.hover-row.status-bar');\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n    }\n    get hasContent() {\n        return this._hasContent;\n    }\n    addAction(actionOptions) {\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        this._hasContent = true;\n        return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n    }\n    append(element) {\n        const result = dom.append(this.actionsElement, element);\n        this._hasContent = true;\n        return result;\n    }\n};\nEditorHoverStatusBar = __decorate([\n    __param(0, IKeybindingService)\n], EditorHoverStatusBar);\nclass ContentHoverComputer {\n    constructor(_editor, _participants) {\n        this._editor = _editor;\n        this._participants = _participants;\n        this._anchor = null;\n        this._shouldFocus = false;\n    }\n    get anchor() { return this._anchor; }\n    set anchor(value) { this._anchor = value; }\n    get shouldFocus() { return this._shouldFocus; }\n    set shouldFocus(value) { this._shouldFocus = value; }\n    static _getLineDecorations(editor, anchor) {\n        if (anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        if (lineNumber > model.getLineCount()) {\n            // invalid line\n            return [];\n        }\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        return editor.getLineDecorations(lineNumber).filter((d) => {\n            if (d.options.isWholeLine) {\n                return true;\n            }\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            if (d.options.showIfCollapsed) {\n                // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n                if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n                    return false;\n                }\n            }\n            else {\n                if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n    computeAsync(token) {\n        const anchor = this._anchor;\n        if (!this._editor.hasModel() || !anchor) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n        return AsyncIterableObject.merge(this._participants.map((participant) => {\n            if (!participant.computeAsync) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return participant.computeAsync(anchor, lineDecorations, token);\n        }));\n    }\n    computeSync() {\n        if (!this._editor.hasModel() || !this._anchor) {\n            return [];\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n        let result = [];\n        for (const participant of this._participants) {\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n        }\n        return coalesce(result);\n    }\n}\n","/**\n * marked - a markdown parser\n * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n// ESM-uncomment-begin\nlet __marked_exports = {};\n(function() {\n  function define(deps, factory) {\n    factory(__marked_exports);\n  }\n  define.amd = true;\n// ESM-uncomment-end\n\n (function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.marked = {}));\n})(this, (function (exports) { 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _createForOfIteratorHelperLoose(o, allowArrayLike) {\n    var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n    if (it) return (it = it.call(o)).next.bind(it);\n\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      return function () {\n        if (i >= o.length) return {\n          done: true\n        };\n        return {\n          done: false,\n          value: o[i++]\n        };\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function getDefaults() {\n    return {\n      baseUrl: null,\n      breaks: false,\n      extensions: null,\n      gfm: true,\n      headerIds: true,\n      headerPrefix: '',\n      highlight: null,\n      langPrefix: 'language-',\n      mangle: true,\n      pedantic: false,\n      renderer: null,\n      sanitize: false,\n      sanitizer: null,\n      silent: false,\n      smartLists: false,\n      smartypants: false,\n      tokenizer: null,\n      walkTokens: null,\n      xhtml: false\n    };\n  }\n  exports.defaults = getDefaults();\n  function changeDefaults(newDefaults) {\n    exports.defaults = newDefaults;\n  }\n\n  /**\n   * Helpers\n   */\n  var escapeTest = /[&<>\"']/;\n  var escapeReplace = /[&<>\"']/g;\n  var escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\n  var escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\n  var escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  var getEscapeReplacement = function getEscapeReplacement(ch) {\n    return escapeReplacements[ch];\n  };\n\n  function escape(html, encode) {\n    if (encode) {\n      if (escapeTest.test(html)) {\n        return html.replace(escapeReplace, getEscapeReplacement);\n      }\n    } else {\n      if (escapeTestNoEncode.test(html)) {\n        return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n      }\n    }\n\n    return html;\n  }\n  var unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\n  /**\n   * @param {string} html\n   */\n\n  function unescape(html) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, function (_, n) {\n      n = n.toLowerCase();\n      if (n === 'colon') return ':';\n\n      if (n.charAt(0) === '#') {\n        return n.charAt(1) === 'x' ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));\n      }\n\n      return '';\n    });\n  }\n  var caret = /(^|[^\\[])\\^/g;\n  /**\n   * @param {string | RegExp} regex\n   * @param {string} opt\n   */\n\n  function edit(regex, opt) {\n    regex = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    var obj = {\n      replace: function replace(name, val) {\n        val = val.source || val;\n        val = val.replace(caret, '$1');\n        regex = regex.replace(name, val);\n        return obj;\n      },\n      getRegex: function getRegex() {\n        return new RegExp(regex, opt);\n      }\n    };\n    return obj;\n  }\n  var nonWordAndColonTest = /[^\\w:]/g;\n  var originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\n  /**\n   * @param {boolean} sanitize\n   * @param {string} base\n   * @param {string} href\n   */\n\n  function cleanUrl(sanitize, base, href) {\n    if (sanitize) {\n      var prot;\n\n      try {\n        prot = decodeURIComponent(unescape(href)).replace(nonWordAndColonTest, '').toLowerCase();\n      } catch (e) {\n        return null;\n      }\n\n      if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n        return null;\n      }\n    }\n\n    if (base && !originIndependentUrl.test(href)) {\n      href = resolveUrl(base, href);\n    }\n\n    try {\n      href = encodeURI(href).replace(/%25/g, '%');\n    } catch (e) {\n      return null;\n    }\n\n    return href;\n  }\n  var baseUrls = {};\n  var justDomain = /^[^:]+:\\/*[^/]*$/;\n  var protocol = /^([^:]+:)[\\s\\S]*$/;\n  var domain = /^([^:]+:\\/*[^/]*)[\\s\\S]*$/;\n  /**\n   * @param {string} base\n   * @param {string} href\n   */\n\n  function resolveUrl(base, href) {\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n      } else {\n        baseUrls[' ' + base] = rtrim(base, '/', true);\n      }\n    }\n\n    base = baseUrls[' ' + base];\n    var relativeBase = base.indexOf(':') === -1;\n\n    if (href.substring(0, 2) === '//') {\n      if (relativeBase) {\n        return href;\n      }\n\n      return base.replace(protocol, '$1') + href;\n    } else if (href.charAt(0) === '/') {\n      if (relativeBase) {\n        return href;\n      }\n\n      return base.replace(domain, '$1') + href;\n    } else {\n      return base + href;\n    }\n  }\n  var noopTest = {\n    exec: function noopTest() {}\n  };\n  function merge(obj) {\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }\n  function splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        escaped = !escaped;\n      }\n\n      if (escaped) {\n        // odd number of slashes means | is escaped\n        // so we leave it alone\n        return '|';\n      } else {\n        // add space before unescaped |\n        return ' |';\n      }\n    }),\n        cells = row.split(/ \\|/);\n    var i = 0; // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n\n    if (!cells[0].trim()) {\n      cells.shift();\n    }\n\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n      cells.pop();\n    }\n\n    if (cells.length > count) {\n      cells.splice(count);\n    } else {\n      while (cells.length < count) {\n        cells.push('');\n      }\n    }\n\n    for (; i < cells.length; i++) {\n      // leading or trailing whitespace is ignored per the gfm spec\n      cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n\n    return cells;\n  }\n  /**\n   * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n   * /c*$/ is vulnerable to REDOS.\n   *\n   * @param {string} str\n   * @param {string} c\n   * @param {boolean} invert Remove suffix of non-c chars instead. Default falsey.\n   */\n\n  function rtrim(str, c, invert) {\n    var l = str.length;\n\n    if (l === 0) {\n      return '';\n    } // Length of suffix matching the invert condition.\n\n\n    var suffLen = 0; // Step left until we fail to match the invert condition.\n\n    while (suffLen < l) {\n      var currChar = str.charAt(l - suffLen - 1);\n\n      if (currChar === c && !invert) {\n        suffLen++;\n      } else if (currChar !== c && invert) {\n        suffLen++;\n      } else {\n        break;\n      }\n    }\n\n    return str.slice(0, l - suffLen);\n  }\n  function findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n      return -1;\n    }\n\n    var l = str.length;\n    var level = 0,\n        i = 0;\n\n    for (; i < l; i++) {\n      if (str[i] === '\\\\') {\n        i++;\n      } else if (str[i] === b[0]) {\n        level++;\n      } else if (str[i] === b[1]) {\n        level--;\n\n        if (level < 0) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  }\n  function checkSanitizeDeprecation(opt) {\n    if (opt && opt.sanitize && !opt.silent) {\n      console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');\n    }\n  } // copied from https://stackoverflow.com/a/5450113/806777\n\n  /**\n   * @param {string} pattern\n   * @param {number} count\n   */\n\n  function repeatString(pattern, count) {\n    if (count < 1) {\n      return '';\n    }\n\n    var result = '';\n\n    while (count > 1) {\n      if (count & 1) {\n        result += pattern;\n      }\n\n      count >>= 1;\n      pattern += pattern;\n    }\n\n    return result + pattern;\n  }\n\n  function outputLink(cap, link, raw, lexer) {\n    var href = link.href;\n    var title = link.title ? escape(link.title) : null;\n    var text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n\n    if (cap[0].charAt(0) !== '!') {\n      lexer.state.inLink = true;\n      var token = {\n        type: 'link',\n        raw: raw,\n        href: href,\n        title: title,\n        text: text,\n        tokens: lexer.inlineTokens(text, [])\n      };\n      lexer.state.inLink = false;\n      return token;\n    }\n\n    return {\n      type: 'image',\n      raw: raw,\n      href: href,\n      title: title,\n      text: escape(text)\n    };\n  }\n\n  function indentCodeCompensation(raw, text) {\n    var matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n\n    if (matchIndentToCode === null) {\n      return text;\n    }\n\n    var indentToCode = matchIndentToCode[1];\n    return text.split('\\n').map(function (node) {\n      var matchIndentInNode = node.match(/^\\s+/);\n\n      if (matchIndentInNode === null) {\n        return node;\n      }\n\n      var indentInNode = matchIndentInNode[0];\n\n      if (indentInNode.length >= indentToCode.length) {\n        return node.slice(indentToCode.length);\n      }\n\n      return node;\n    }).join('\\n');\n  }\n  /**\n   * Tokenizer\n   */\n\n\n  var Tokenizer = /*#__PURE__*/function () {\n    function Tokenizer(options) {\n      this.options = options || exports.defaults;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap && cap[0].length > 0) {\n        return {\n          type: 'space',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.code = function code(src) {\n      var cap = this.rules.block.code.exec(src);\n\n      if (cap) {\n        var text = cap[0].replace(/^ {1,4}/gm, '');\n        return {\n          type: 'code',\n          raw: cap[0],\n          codeBlockStyle: 'indented',\n          text: !this.options.pedantic ? rtrim(text, '\\n') : text\n        };\n      }\n    };\n\n    _proto.fences = function fences(src) {\n      var cap = this.rules.block.fences.exec(src);\n\n      if (cap) {\n        var raw = cap[0];\n        var text = indentCodeCompensation(raw, cap[3] || '');\n        return {\n          type: 'code',\n          raw: raw,\n          lang: cap[2] ? cap[2].trim() : cap[2],\n          text: text\n        };\n      }\n    };\n\n    _proto.heading = function heading(src) {\n      var cap = this.rules.block.heading.exec(src);\n\n      if (cap) {\n        var text = cap[2].trim(); // remove trailing #s\n\n        if (/#$/.test(text)) {\n          var trimmed = rtrim(text, '#');\n\n          if (this.options.pedantic) {\n            text = trimmed.trim();\n          } else if (!trimmed || / $/.test(trimmed)) {\n            // CommonMark requires space before trailing #s\n            text = trimmed.trim();\n          }\n        }\n\n        var token = {\n          type: 'heading',\n          raw: cap[0],\n          depth: cap[1].length,\n          text: text,\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.hr = function hr(src) {\n      var cap = this.rules.block.hr.exec(src);\n\n      if (cap) {\n        return {\n          type: 'hr',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.blockquote = function blockquote(src) {\n      var cap = this.rules.block.blockquote.exec(src);\n\n      if (cap) {\n        var text = cap[0].replace(/^ *>[ \\t]?/gm, '');\n        return {\n          type: 'blockquote',\n          raw: cap[0],\n          tokens: this.lexer.blockTokens(text, []),\n          text: text\n        };\n      }\n    };\n\n    _proto.list = function list(src) {\n      var cap = this.rules.block.list.exec(src);\n\n      if (cap) {\n        var raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine, line, nextLine, rawLine, itemContents, endEarly;\n        var bull = cap[1].trim();\n        var isordered = bull.length > 1;\n        var list = {\n          type: 'list',\n          raw: '',\n          ordered: isordered,\n          start: isordered ? +bull.slice(0, -1) : '',\n          loose: false,\n          items: []\n        };\n        bull = isordered ? \"\\\\d{1,9}\\\\\" + bull.slice(-1) : \"\\\\\" + bull;\n\n        if (this.options.pedantic) {\n          bull = isordered ? bull : '[*+-]';\n        } // Get next list item\n\n\n        var itemRegex = new RegExp(\"^( {0,3}\" + bull + \")((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))\"); // Check if current bullet point can start a new List Item\n\n        while (src) {\n          endEarly = false;\n\n          if (!(cap = itemRegex.exec(src))) {\n            break;\n          }\n\n          if (this.rules.block.hr.test(src)) {\n            // End list if bullet was actually HR (possibly move into itemRegex?)\n            break;\n          }\n\n          raw = cap[0];\n          src = src.substring(raw.length);\n          line = cap[2].split('\\n', 1)[0];\n          nextLine = src.split('\\n', 1)[0];\n\n          if (this.options.pedantic) {\n            indent = 2;\n            itemContents = line.trimLeft();\n          } else {\n            indent = cap[2].search(/[^ ]/); // Find first non-space char\n\n            indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n\n            itemContents = line.slice(indent);\n            indent += cap[1].length;\n          }\n\n          blankLine = false;\n\n          if (!line && /^ *$/.test(nextLine)) {\n            // Items begin with at most one blank line\n            raw += nextLine + '\\n';\n            src = src.substring(nextLine.length + 1);\n            endEarly = true;\n          }\n\n          if (!endEarly) {\n            var nextBulletRegex = new RegExp(\"^ {0,\" + Math.min(3, indent - 1) + \"}(?:[*+-]|\\\\d{1,9}[.)])((?: [^\\\\n]*)?(?:\\\\n|$))\");\n            var hrRegex = new RegExp(\"^ {0,\" + Math.min(3, indent - 1) + \"}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)\"); // Check if following lines should be included in List Item\n\n            while (src) {\n              rawLine = src.split('\\n', 1)[0];\n              line = rawLine; // Re-align to follow commonmark nesting rules\n\n              if (this.options.pedantic) {\n                line = line.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n              } // End list item if found start of new bullet\n\n\n              if (nextBulletRegex.test(line)) {\n                break;\n              } // Horizontal rule found\n\n\n              if (hrRegex.test(src)) {\n                break;\n              }\n\n              if (line.search(/[^ ]/) >= indent || !line.trim()) {\n                // Dedent if possible\n                itemContents += '\\n' + line.slice(indent);\n              } else if (!blankLine) {\n                // Until blank line, item doesn't need indentation\n                itemContents += '\\n' + line;\n              } else {\n                // Otherwise, improper indentation ends this item\n                break;\n              }\n\n              if (!blankLine && !line.trim()) {\n                // Check if current line is blank\n                blankLine = true;\n              }\n\n              raw += rawLine + '\\n';\n              src = src.substring(rawLine.length + 1);\n            }\n          }\n\n          if (!list.loose) {\n            // If the previous item ended with a blank line, the list is loose\n            if (endsWithBlankLine) {\n              list.loose = true;\n            } else if (/\\n *\\n *$/.test(raw)) {\n              endsWithBlankLine = true;\n            }\n          } // Check for task list items\n\n\n          if (this.options.gfm) {\n            istask = /^\\[[ xX]\\] /.exec(itemContents);\n\n            if (istask) {\n              ischecked = istask[0] !== '[ ] ';\n              itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n            }\n          }\n\n          list.items.push({\n            type: 'list_item',\n            raw: raw,\n            task: !!istask,\n            checked: ischecked,\n            loose: false,\n            text: itemContents\n          });\n          list.raw += raw;\n        } // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n\n\n        list.items[list.items.length - 1].raw = raw.trimRight();\n        list.items[list.items.length - 1].text = itemContents.trimRight();\n        list.raw = list.raw.trimRight();\n        var l = list.items.length; // Item child tokens handled here at end because we needed to have the final item to trim it first\n\n        for (i = 0; i < l; i++) {\n          this.lexer.state.top = false;\n          list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n          var spacers = list.items[i].tokens.filter(function (t) {\n            return t.type === 'space';\n          });\n          var hasMultipleLineBreaks = spacers.every(function (t) {\n            var chars = t.raw.split('');\n            var lineBreaks = 0;\n\n            for (var _iterator = _createForOfIteratorHelperLoose(chars), _step; !(_step = _iterator()).done;) {\n              var _char = _step.value;\n\n              if (_char === '\\n') {\n                lineBreaks += 1;\n              }\n\n              if (lineBreaks > 1) {\n                return true;\n              }\n            }\n\n            return false;\n          });\n\n          if (!list.loose && spacers.length && hasMultipleLineBreaks) {\n            // Having a single line break doesn't mean a list is loose. A single line break is terminating the last list item\n            list.loose = true;\n            list.items[i].loose = true;\n          }\n        }\n\n        return list;\n      }\n    };\n\n    _proto.html = function html(src) {\n      var cap = this.rules.block.html.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'html',\n          raw: cap[0],\n          pre: !this.options.sanitizer && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n          text: cap[0]\n        };\n\n        if (this.options.sanitize) {\n          token.type = 'paragraph';\n          token.text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);\n          token.tokens = [];\n          this.lexer.inline(token.text, token.tokens);\n        }\n\n        return token;\n      }\n    };\n\n    _proto.def = function def(src) {\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          type: 'def',\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: cap[3]\n        };\n      }\n    };\n\n    _proto.table = function table(src) {\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells(cap[1]).map(function (c) {\n            return {\n              text: c\n            };\n          }),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          rows: cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : []\n        };\n\n        if (item.header.length === item.align.length) {\n          item.raw = cap[0];\n          var l = item.align.length;\n          var i, j, k, row;\n\n          for (i = 0; i < l; i++) {\n            if (/^ *-+: *$/.test(item.align[i])) {\n              item.align[i] = 'right';\n            } else if (/^ *:-+: *$/.test(item.align[i])) {\n              item.align[i] = 'center';\n            } else if (/^ *:-+ *$/.test(item.align[i])) {\n              item.align[i] = 'left';\n            } else {\n              item.align[i] = null;\n            }\n          }\n\n          l = item.rows.length;\n\n          for (i = 0; i < l; i++) {\n            item.rows[i] = splitCells(item.rows[i], item.header.length).map(function (c) {\n              return {\n                text: c\n              };\n            });\n          } // parse child tokens inside headers and cells\n          // header child tokens\n\n\n          l = item.header.length;\n\n          for (j = 0; j < l; j++) {\n            item.header[j].tokens = [];\n            this.lexer.inline(item.header[j].text, item.header[j].tokens);\n          } // cell child tokens\n\n\n          l = item.rows.length;\n\n          for (j = 0; j < l; j++) {\n            row = item.rows[j];\n\n            for (k = 0; k < row.length; k++) {\n              row[k].tokens = [];\n              this.lexer.inline(row[k].text, row[k].tokens);\n            }\n          }\n\n          return item;\n        }\n      }\n    };\n\n    _proto.lheading = function lheading(src) {\n      var cap = this.rules.block.lheading.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'heading',\n          raw: cap[0],\n          depth: cap[2].charAt(0) === '=' ? 1 : 2,\n          text: cap[1],\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.paragraph = function paragraph(src) {\n      var cap = this.rules.block.paragraph.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'paragraph',\n          raw: cap[0],\n          text: cap[1].charAt(cap[1].length - 1) === '\\n' ? cap[1].slice(0, -1) : cap[1],\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.text = function text(src) {\n      var cap = this.rules.block.text.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'text',\n          raw: cap[0],\n          text: cap[0],\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.escape = function escape$1(src) {\n      var cap = this.rules.inline.escape.exec(src);\n\n      if (cap) {\n        return {\n          type: 'escape',\n          raw: cap[0],\n          text: escape(cap[1])\n        };\n      }\n    };\n\n    _proto.tag = function tag(src) {\n      var cap = this.rules.inline.tag.exec(src);\n\n      if (cap) {\n        if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n          this.lexer.state.inLink = true;\n        } else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n          this.lexer.state.inLink = false;\n        }\n\n        if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n          this.lexer.state.inRawBlock = true;\n        } else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n          this.lexer.state.inRawBlock = false;\n        }\n\n        return {\n          type: this.options.sanitize ? 'text' : 'html',\n          raw: cap[0],\n          inLink: this.lexer.state.inLink,\n          inRawBlock: this.lexer.state.inRawBlock,\n          text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0]\n        };\n      }\n    };\n\n    _proto.link = function link(src) {\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n          } // ending angle bracket cannot be escaped\n\n\n          var rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n\n          if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n            return;\n          }\n        } else {\n          // find closing parenthesis\n          var lastParenIndex = findClosingBracket(cap[2], '()');\n\n          if (lastParenIndex > -1) {\n            var start = cap[0].indexOf('!') === 0 ? 5 : 4;\n            var linkLen = start + cap[1].length + lastParenIndex;\n            cap[2] = cap[2].substring(0, lastParenIndex);\n            cap[0] = cap[0].substring(0, linkLen).trim();\n            cap[3] = '';\n          }\n        }\n\n        var href = cap[2];\n        var title = '';\n\n        if (this.options.pedantic) {\n          // split pedantic href and title\n          var link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n          if (link) {\n            href = link[1];\n            title = link[3];\n          }\n        } else {\n          title = cap[3] ? cap[3].slice(1, -1) : '';\n        }\n\n        href = href.trim();\n\n        if (/^</.test(href)) {\n          if (this.options.pedantic && !/>$/.test(trimmedUrl)) {\n            // pedantic allows starting angle bracket without ending angle bracket\n            href = href.slice(1);\n          } else {\n            href = href.slice(1, -1);\n          }\n        }\n\n        return outputLink(cap, {\n          href: href ? href.replace(this.rules.inline._escapes, '$1') : href,\n          title: title ? title.replace(this.rules.inline._escapes, '$1') : title\n        }, cap[0], this.lexer);\n      }\n    };\n\n    _proto.reflink = function reflink(src, links) {\n      var cap;\n\n      if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {\n        var link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n        link = links[link.toLowerCase()];\n\n        if (!link || !link.href) {\n          var text = cap[0].charAt(0);\n          return {\n            type: 'text',\n            raw: text,\n            text: text\n          };\n        }\n\n        return outputLink(cap, link, cap[0], this.lexer);\n      }\n    };\n\n    _proto.emStrong = function emStrong(src, maskedSrc, prevChar) {\n      if (prevChar === void 0) {\n        prevChar = '';\n      }\n\n      var match = this.rules.inline.emStrong.lDelim.exec(src);\n      if (!match) return; // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n\n      if (match[3] && prevChar.match(/(?:[0-9A-Za-z\\xAA\\xB2\\xB3\\xB5\\xB9\\xBA\\xBC-\\xBE\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0620-\\u064A\\u0660-\\u0669\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07C0-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u0870-\\u0887\\u0889-\\u088E\\u08A0-\\u08C9\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0966-\\u096F\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09E6-\\u09F1\\u09F4-\\u09F9\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A6F\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AE6-\\u0AEF\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B66-\\u0B6F\\u0B71-\\u0B77\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0BE6-\\u0BF2\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C5D\\u0C60\\u0C61\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDD\\u0CDE\\u0CE0\\u0CE1\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D04-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D58-\\u0D61\\u0D66-\\u0D78\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DE6-\\u0DEF\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F20-\\u0F33\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F-\\u1049\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u1090-\\u1099\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1369-\\u137C\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u1711\\u171F-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1820-\\u1878\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19DA\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4C\\u1B50-\\u1B59\\u1B83-\\u1BA0\\u1BAE-\\u1BE5\\u1C00-\\u1C23\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CE9-\\u1CEC\\u1CEE-\\u1CF3\\u1CF5\\u1CF6\\u1CFA\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2070\\u2071\\u2074-\\u2079\\u207F-\\u2089\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2150-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2C00-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2CFD\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3192-\\u3195\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\u3400-\\u4DBF\\u4E00-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7CA\\uA7D0\\uA7D1\\uA7D3\\uA7D5-\\uA7D9\\uA7F2-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA830-\\uA835\\uA840-\\uA873\\uA882-\\uA8B3\\uA8D0-\\uA8D9\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA8FE\\uA900-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF-\\uA9D9\\uA9E0-\\uA9E4\\uA9E6-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB69\\uAB70-\\uABE2\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE1-\\uDEFB\\uDF00-\\uDF23\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDD70-\\uDD7A\\uDD7C-\\uDD8A\\uDD8C-\\uDD92\\uDD94\\uDD95\\uDD97-\\uDDA1\\uDDA3-\\uDDB1\\uDDB3-\\uDDB9\\uDDBB\\uDDBC\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67\\uDF80-\\uDF85\\uDF87-\\uDFB0\\uDFB2-\\uDFBA]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC58-\\uDC76\\uDC79-\\uDC9E\\uDCA7-\\uDCAF\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDCFB-\\uDD1B\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBC-\\uDDCF\\uDDD2-\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE40-\\uDE48\\uDE60-\\uDE7E\\uDE80-\\uDE9F\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDEEB-\\uDEEF\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF58-\\uDF72\\uDF78-\\uDF91\\uDFA9-\\uDFAF]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDCFA-\\uDD23\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDE80-\\uDEA9\\uDEB0\\uDEB1\\uDF00-\\uDF27\\uDF30-\\uDF45\\uDF51-\\uDF54\\uDF70-\\uDF81\\uDFB0-\\uDFCB\\uDFE0-\\uDFF6]|\\uD804[\\uDC03-\\uDC37\\uDC52-\\uDC6F\\uDC71\\uDC72\\uDC75\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD03-\\uDD26\\uDD36-\\uDD3F\\uDD44\\uDD47\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDD0-\\uDDDA\\uDDDC\\uDDE1-\\uDDF4\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDEF0-\\uDEF9\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC50-\\uDC59\\uDC5F-\\uDC61\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEAA\\uDEB8\\uDEC0-\\uDEC9\\uDF00-\\uDF1A\\uDF30-\\uDF3B\\uDF40-\\uDF46]|\\uD806[\\uDC00-\\uDC2B\\uDCA0-\\uDCF2\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD2F\\uDD3F\\uDD41\\uDD50-\\uDD59\\uDDA0-\\uDDA7\\uDDAA-\\uDDD0\\uDDE1\\uDDE3\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE89\\uDE9D\\uDEB0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC50-\\uDC6C\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46\\uDD50-\\uDD59\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD89\\uDD98\\uDDA0-\\uDDA9\\uDEE0-\\uDEF2\\uDFB0\\uDFC0-\\uDFD4]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|\\uD80B[\\uDF90-\\uDFF0]|[\\uD80C\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDE70-\\uDEBE\\uDEC0-\\uDEC9\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF5B-\\uDF61\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDE40-\\uDE96\\uDF00-\\uDF4A\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1\\uDFE3]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDD00-\\uDD08]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD82C[\\uDC00-\\uDD22\\uDD50-\\uDD52\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD837[\\uDF00-\\uDF1E]|\\uD838[\\uDD00-\\uDD2C\\uDD37-\\uDD3D\\uDD40-\\uDD49\\uDD4E\\uDE90-\\uDEAD\\uDEC0-\\uDEEB\\uDEF0-\\uDEF9]|\\uD839[\\uDFE0-\\uDFE6\\uDFE8-\\uDFEB\\uDFED\\uDFEE\\uDFF0-\\uDFFE]|\\uD83A[\\uDC00-\\uDCC4\\uDCC7-\\uDCCF\\uDD00-\\uDD43\\uDD4B\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF38\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])/)) return;\n      var nextChar = match[1] || match[2] || '';\n\n      if (!nextChar || nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))) {\n        var lLength = match[0].length - 1;\n        var rDelim,\n            rLength,\n            delimTotal = lLength,\n            midDelimTotal = 0;\n        var endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;\n        endReg.lastIndex = 0; // Clip maskedSrc to same section of string as src (move to lexer?)\n\n        maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n\n        while ((match = endReg.exec(maskedSrc)) != null) {\n          rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n          if (!rDelim) continue; // skip single * in __abc*abc__\n\n          rLength = rDelim.length;\n\n          if (match[3] || match[4]) {\n            // found another Left Delim\n            delimTotal += rLength;\n            continue;\n          } else if (match[5] || match[6]) {\n            // either Left or Right Delim\n            if (lLength % 3 && !((lLength + rLength) % 3)) {\n              midDelimTotal += rLength;\n              continue; // CommonMark Emphasis Rules 9-10\n            }\n          }\n\n          delimTotal -= rLength;\n          if (delimTotal > 0) continue; // Haven't found enough closing delimiters\n          // Remove extra characters. *a*** -> *a*\n\n          rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal); // Create `em` if smallest delimiter has odd char count. *a***\n\n          if (Math.min(lLength, rLength) % 2) {\n            var _text = src.slice(1, lLength + match.index + rLength);\n\n            return {\n              type: 'em',\n              raw: src.slice(0, lLength + match.index + rLength + 1),\n              text: _text,\n              tokens: this.lexer.inlineTokens(_text, [])\n            };\n          } // Create 'strong' if smallest delimiter has even char count. **a***\n\n\n          var text = src.slice(2, lLength + match.index + rLength - 1);\n          return {\n            type: 'strong',\n            raw: src.slice(0, lLength + match.index + rLength + 1),\n            text: text,\n            tokens: this.lexer.inlineTokens(text, [])\n          };\n        }\n      }\n    };\n\n    _proto.codespan = function codespan(src) {\n      var cap = this.rules.inline.code.exec(src);\n\n      if (cap) {\n        var text = cap[2].replace(/\\n/g, ' ');\n        var hasNonSpaceChars = /[^ ]/.test(text);\n        var hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n\n        if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n          text = text.substring(1, text.length - 1);\n        }\n\n        text = escape(text, true);\n        return {\n          type: 'codespan',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    _proto.br = function br(src) {\n      var cap = this.rules.inline.br.exec(src);\n\n      if (cap) {\n        return {\n          type: 'br',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.del = function del(src) {\n      var cap = this.rules.inline.del.exec(src);\n\n      if (cap) {\n        return {\n          type: 'del',\n          raw: cap[0],\n          text: cap[2],\n          tokens: this.lexer.inlineTokens(cap[2], [])\n        };\n      }\n    };\n\n    _proto.autolink = function autolink(src, mangle) {\n      var cap = this.rules.inline.autolink.exec(src);\n\n      if (cap) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);\n          href = 'mailto:' + text;\n        } else {\n          text = escape(cap[1]);\n          href = text;\n        }\n\n        return {\n          type: 'link',\n          raw: cap[0],\n          text: text,\n          href: href,\n          tokens: [{\n            type: 'text',\n            raw: text,\n            text: text\n          }]\n        };\n      }\n    };\n\n    _proto.url = function url(src, mangle) {\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n          var prevCapZero;\n\n          do {\n            prevCapZero = cap[0];\n            cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];\n          } while (prevCapZero !== cap[0]);\n\n          text = escape(cap[0]);\n\n          if (cap[1] === 'www.') {\n            href = 'http://' + text;\n          } else {\n            href = text;\n          }\n        }\n\n        return {\n          type: 'link',\n          raw: cap[0],\n          text: text,\n          href: href,\n          tokens: [{\n            type: 'text',\n            raw: text,\n            text: text\n          }]\n        };\n      }\n    };\n\n    _proto.inlineText = function inlineText(src, smartypants) {\n      var cap = this.rules.inline.text.exec(src);\n\n      if (cap) {\n        var text;\n\n        if (this.lexer.state.inRawBlock) {\n          text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0];\n        } else {\n          text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);\n        }\n\n        return {\n          type: 'text',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    return Tokenizer;\n  }();\n\n  /**\n   * Block-Level Grammar\n   */\n\n  var block = {\n    newline: /^(?: *(?:\\n|$))+/,\n    code: /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/,\n    fences: /^ {0,3}(`{3,}(?=[^`\\n]*\\n)|~{3,})([^\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/,\n    hr: /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/,\n    heading: /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/,\n    blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n    list: /^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/,\n    html: '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n    + ')',\n    def: /^ {0,3}\\[(label)\\]: *(?:\\n *)?<?([^\\s>]+)>?(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/,\n    table: noopTest,\n    lheading: /^([^\\n]+)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    // regex template, placeholders will be replaced according to different paragraph\n    // interruption rules of commonmark and the original markdown spec:\n    _paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/,\n    text: /^[^\\n]+/\n  };\n  block._label = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\n  block._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\n  block.def = edit(block.def).replace('label', block._label).replace('title', block._title).getRegex();\n  block.bullet = /(?:[*+-]|\\d{1,9}[.)])/;\n  block.listItemStart = edit(/^( *)(bull) */).replace('bull', block.bullet).getRegex();\n  block.list = edit(block.list).replace(/bull/g, block.bullet).replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))').replace('def', '\\\\n+(?=' + block.def.source + ')').getRegex();\n  block._tag = 'address|article|aside|base|basefont|blockquote|body|caption' + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption' + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe' + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option' + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr' + '|track|ul';\n  block._comment = /<!--(?!-?>)[\\s\\S]*?(?:-->|$)/;\n  block.html = edit(block.html, 'i').replace('comment', block._comment).replace('tag', block._tag).replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex();\n  block.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n  .replace('|table', '').replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n  block.blockquote = edit(block.blockquote).replace('paragraph', block.paragraph).getRegex();\n  /**\n   * Normal Block Grammar\n   */\n\n  block.normal = merge({}, block);\n  /**\n   * GFM Block Grammar\n   */\n\n  block.gfm = merge({}, block.normal, {\n    table: '^ *([^\\\\n ].*\\\\|.*)\\\\n' // Header\n    + ' {0,3}(?:\\\\| *)?(:?-+:? *(?:\\\\| *:?-+:? *)*)(?:\\\\| *)?' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)' // Cells\n\n  });\n  block.gfm.table = edit(block.gfm.table).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n  .getRegex();\n  block.gfm.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n  .replace('table', block.gfm.table) // interrupt paragraphs with table\n  .replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n  /**\n   * Pedantic grammar (original John Gruber's loose markdown specification)\n   */\n\n  block.pedantic = merge({}, block.normal, {\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)' + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n    + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))').replace('comment', block._comment).replace(/tag/g, '(?!(?:' + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub' + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)' + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b').getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest,\n    // fences not supported\n    paragraph: edit(block.normal._paragraph).replace('hr', block.hr).replace('heading', ' *#{1,6} *[^\\n]').replace('lheading', block.lheading).replace('blockquote', ' {0,3}>').replace('|fences', '').replace('|list', '').replace('|html', '').getRegex()\n  });\n  /**\n   * Inline-Level Grammar\n   */\n\n  var inline = {\n    escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n    autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n    url: noopTest,\n    tag: '^comment' + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>',\n    // CDATA section\n    link: /^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/,\n    reflink: /^!?\\[(label)\\]\\[(ref)\\]/,\n    nolink: /^!?\\[(ref)\\](?:\\[\\])?/,\n    reflinkSearch: 'reflink|nolink(?!\\\\()',\n    emStrong: {\n      lDelim: /^(?:\\*+(?:([punct_])|[^\\s*]))|^_+(?:([punct*])|([^\\s_]))/,\n      //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.\n      //          () Skip orphan inside strong  () Consume to delim (1) #***                (2) a***#, a***                   (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a\n      rDelimAst: /^[^_*]*?\\_\\_[^_*]*?\\*[^_*]*?(?=\\_\\_)|[^*]+(?=[^*])|[punct_](\\*+)(?=[\\s]|$)|[^punct*_\\s](\\*+)(?=[punct_\\s]|$)|[punct_\\s](\\*+)(?=[^punct*_\\s])|[\\s](\\*+)(?=[punct_])|[punct_](\\*+)(?=[punct_])|[^punct*_\\s](\\*+)(?=[^punct*_\\s])/,\n      rDelimUnd: /^[^_*]*?\\*\\*[^_*]*?\\_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|[punct*](\\_+)(?=[\\s]|$)|[^punct*_\\s](\\_+)(?=[punct*\\s]|$)|[punct*\\s](\\_+)(?=[^punct*_\\s])|[\\s](\\_+)(?=[punct*])|[punct*](\\_+)(?=[punct*])/ // ^- Not allowed for _\n\n    },\n    code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n    br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n    del: noopTest,\n    text: /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/,\n    punctuation: /^([\\spunctuation])/\n  }; // list of punctuation marks from CommonMark spec\n  // without * and _ to handle the different emphasis markers * and _\n\n  inline._punctuation = '!\"#$%&\\'()+\\\\-.,/:;<=>?@\\\\[\\\\]`^{|}~';\n  inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex(); // sequences em should skip over [title](link), `code`, <html>\n\n  inline.blockSkip = /\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>/g;\n  inline.escapedEmSt = /\\\\\\*|\\\\_/g;\n  inline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();\n  inline.emStrong.lDelim = edit(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();\n  inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g').replace(/punct/g, inline._punctuation).getRegex();\n  inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g').replace(/punct/g, inline._punctuation).getRegex();\n  inline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\n  inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\n  inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\n  inline.autolink = edit(inline.autolink).replace('scheme', inline._scheme).replace('email', inline._email).getRegex();\n  inline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\n  inline.tag = edit(inline.tag).replace('comment', inline._comment).replace('attribute', inline._attribute).getRegex();\n  inline._label = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\n  inline._href = /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/;\n  inline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\n  inline.link = edit(inline.link).replace('label', inline._label).replace('href', inline._href).replace('title', inline._title).getRegex();\n  inline.reflink = edit(inline.reflink).replace('label', inline._label).replace('ref', block._label).getRegex();\n  inline.nolink = edit(inline.nolink).replace('ref', block._label).getRegex();\n  inline.reflinkSearch = edit(inline.reflinkSearch, 'g').replace('reflink', inline.reflink).replace('nolink', inline.nolink).getRegex();\n  /**\n   * Normal Inline Grammar\n   */\n\n  inline.normal = merge({}, inline);\n  /**\n   * Pedantic Inline Grammar\n   */\n\n  inline.pedantic = merge({}, inline.normal, {\n    strong: {\n      start: /^__|\\*\\*/,\n      middle: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n      endAst: /\\*\\*(?!\\*)/g,\n      endUnd: /__(?!_)/g\n    },\n    em: {\n      start: /^_|\\*/,\n      middle: /^()\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)|^_(?=\\S)([\\s\\S]*?\\S)_(?!_)/,\n      endAst: /\\*(?!\\*)/g,\n      endUnd: /_(?!_)/g\n    },\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/).replace('label', inline._label).getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace('label', inline._label).getRegex()\n  });\n  /**\n   * GFM Inline Grammar\n   */\n\n  inline.gfm = merge({}, inline.normal, {\n    escape: edit(inline.escape).replace('])', '~|])').getRegex(),\n    _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n    url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n    _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\n  });\n  inline.gfm.url = edit(inline.gfm.url, 'i').replace('email', inline.gfm._extended_email).getRegex();\n  /**\n   * GFM + Line Breaks Inline Grammar\n   */\n\n  inline.breaks = merge({}, inline.gfm, {\n    br: edit(inline.br).replace('{2,}', '*').getRegex(),\n    text: edit(inline.gfm.text).replace('\\\\b_', '\\\\b_| {2,}\\\\n').replace(/\\{2,\\}/g, '*').getRegex()\n  });\n\n  /**\n   * smartypants text replacement\n   * @param {string} text\n   */\n\n  function smartypants(text) {\n    return text // em-dashes\n    .replace(/---/g, \"\\u2014\") // en-dashes\n    .replace(/--/g, \"\\u2013\") // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, \"$1\\u2018\") // closing singles & apostrophes\n    .replace(/'/g, \"\\u2019\") // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, \"$1\\u201C\") // closing doubles\n    .replace(/\"/g, \"\\u201D\") // ellipses\n    .replace(/\\.{3}/g, \"\\u2026\");\n  }\n  /**\n   * mangle email addresses\n   * @param {string} text\n   */\n\n\n  function mangle(text) {\n    var out = '',\n        i,\n        ch;\n    var l = text.length;\n\n    for (i = 0; i < l; i++) {\n      ch = text.charCodeAt(i);\n\n      if (Math.random() > 0.5) {\n        ch = 'x' + ch.toString(16);\n      }\n\n      out += '&#' + ch + ';';\n    }\n\n    return out;\n  }\n  /**\n   * Block Lexer\n   */\n\n\n  var Lexer = /*#__PURE__*/function () {\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || exports.defaults;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options = this.options;\n      this.tokenizer.lexer = this;\n      this.inlineQueue = [];\n      this.state = {\n        inLink: false,\n        inRawBlock: false,\n        top: true\n      };\n      var rules = {\n        block: block.normal,\n        inline: inline.normal\n      };\n\n      if (this.options.pedantic) {\n        rules.block = block.pedantic;\n        rules.inline = inline.pedantic;\n      } else if (this.options.gfm) {\n        rules.block = block.gfm;\n\n        if (this.options.breaks) {\n          rules.inline = inline.breaks;\n        } else {\n          rules.inline = inline.gfm;\n        }\n      }\n\n      this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n\n\n    /**\n     * Static Lex Method\n     */\n    Lexer.lex = function lex(src, options) {\n      var lexer = new Lexer(options);\n      return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    ;\n\n    Lexer.lexInline = function lexInline(src, options) {\n      var lexer = new Lexer(options);\n      return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    ;\n\n    var _proto = Lexer.prototype;\n\n    _proto.lex = function lex(src) {\n      src = src.replace(/\\r\\n|\\r/g, '\\n');\n      this.blockTokens(src, this.tokens);\n      var next;\n\n      while (next = this.inlineQueue.shift()) {\n        this.inlineTokens(next.src, next.tokens);\n      }\n\n      return this.tokens;\n    }\n    /**\n     * Lexing\n     */\n    ;\n\n    _proto.blockTokens = function blockTokens(src, tokens) {\n      var _this = this;\n\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n      } else {\n        src = src.replace(/^( *)(\\t+)/gm, function (_, leading, tabs) {\n          return leading + '    '.repeat(tabs.length);\n        });\n      }\n\n      var token, lastToken, cutSrc, lastParagraphClipped;\n\n      while (src) {\n        if (this.options.extensions && this.options.extensions.block && this.options.extensions.block.some(function (extTokenizer) {\n          if (token = extTokenizer.call({\n            lexer: _this\n          }, src, tokens)) {\n            src = src.substring(token.raw.length);\n            tokens.push(token);\n            return true;\n          }\n\n          return false;\n        })) {\n          continue;\n        } // newline\n\n\n        if (token = this.tokenizer.space(src)) {\n          src = src.substring(token.raw.length);\n\n          if (token.raw.length === 1 && tokens.length > 0) {\n            // if there's a single \\n as a spacer, it's terminating the last line,\n            // so move it there so that we don't get unecessary paragraph tags\n            tokens[tokens.length - 1].raw += '\\n';\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // code\n\n\n        if (token = this.tokenizer.code(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1]; // An indented code block cannot interrupt a paragraph.\n\n          if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // fences\n\n\n        if (token = this.tokenizer.fences(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // heading\n\n\n        if (token = this.tokenizer.heading(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // hr\n\n\n        if (token = this.tokenizer.hr(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // blockquote\n\n\n        if (token = this.tokenizer.blockquote(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // list\n\n\n        if (token = this.tokenizer.list(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // html\n\n\n        if (token = this.tokenizer.html(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // def\n\n\n        if (token = this.tokenizer.def(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.raw;\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else if (!this.tokens.links[token.tag]) {\n            this.tokens.links[token.tag] = {\n              href: token.href,\n              title: token.title\n            };\n          }\n\n          continue;\n        } // table (gfm)\n\n\n        if (token = this.tokenizer.table(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // lheading\n\n\n        if (token = this.tokenizer.lheading(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // top-level paragraph\n        // prevent paragraph consuming extensions by clipping 'src' to extension start\n\n\n        cutSrc = src;\n\n        if (this.options.extensions && this.options.extensions.startBlock) {\n          (function () {\n            var startIndex = Infinity;\n            var tempSrc = src.slice(1);\n            var tempStart = void 0;\n\n            _this.options.extensions.startBlock.forEach(function (getStartIndex) {\n              tempStart = getStartIndex.call({\n                lexer: this\n              }, tempSrc);\n\n              if (typeof tempStart === 'number' && tempStart >= 0) {\n                startIndex = Math.min(startIndex, tempStart);\n              }\n            });\n\n            if (startIndex < Infinity && startIndex >= 0) {\n              cutSrc = src.substring(0, startIndex + 1);\n            }\n          })();\n        }\n\n        if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastParagraphClipped && lastToken.type === 'paragraph') {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n            this.inlineQueue.pop();\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else {\n            tokens.push(token);\n          }\n\n          lastParagraphClipped = cutSrc.length !== src.length;\n          src = src.substring(token.raw.length);\n          continue;\n        } // text\n\n\n        if (token = this.tokenizer.text(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && lastToken.type === 'text') {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n            this.inlineQueue.pop();\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        }\n\n        if (src) {\n          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n\n          if (this.options.silent) {\n            console.error(errMsg);\n            break;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n\n      this.state.top = true;\n      return tokens;\n    };\n\n    _proto.inline = function inline(src, tokens) {\n      this.inlineQueue.push({\n        src: src,\n        tokens: tokens\n      });\n    }\n    /**\n     * Lexing/Compiling\n     */\n    ;\n\n    _proto.inlineTokens = function inlineTokens(src, tokens) {\n      var _this2 = this;\n\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      var token, lastToken, cutSrc; // String with links masked to avoid interference with em and strong\n\n      var maskedSrc = src;\n      var match;\n      var keepPrevChar, prevChar; // Mask out reflinks\n\n      if (this.tokens.links) {\n        var links = Object.keys(this.tokens.links);\n\n        if (links.length > 0) {\n          while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n            if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n              maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n            }\n          }\n        }\n      } // Mask out other blocks\n\n\n      while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n        maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n      } // Mask out escaped em & strong delimiters\n\n\n      while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {\n        maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);\n      }\n\n      while (src) {\n        if (!keepPrevChar) {\n          prevChar = '';\n        }\n\n        keepPrevChar = false; // extensions\n\n        if (this.options.extensions && this.options.extensions.inline && this.options.extensions.inline.some(function (extTokenizer) {\n          if (token = extTokenizer.call({\n            lexer: _this2\n          }, src, tokens)) {\n            src = src.substring(token.raw.length);\n            tokens.push(token);\n            return true;\n          }\n\n          return false;\n        })) {\n          continue;\n        } // escape\n\n\n        if (token = this.tokenizer.escape(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // tag\n\n\n        if (token = this.tokenizer.tag(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // link\n\n\n        if (token = this.tokenizer.link(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // reflink, nolink\n\n\n        if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // em & strong\n\n\n        if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // code\n\n\n        if (token = this.tokenizer.codespan(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // br\n\n\n        if (token = this.tokenizer.br(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // del (gfm)\n\n\n        if (token = this.tokenizer.del(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // autolink\n\n\n        if (token = this.tokenizer.autolink(src, mangle)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // url (gfm)\n\n\n        if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // text\n        // prevent inlineText consuming extensions by clipping 'src' to extension start\n\n\n        cutSrc = src;\n\n        if (this.options.extensions && this.options.extensions.startInline) {\n          (function () {\n            var startIndex = Infinity;\n            var tempSrc = src.slice(1);\n            var tempStart = void 0;\n\n            _this2.options.extensions.startInline.forEach(function (getStartIndex) {\n              tempStart = getStartIndex.call({\n                lexer: this\n              }, tempSrc);\n\n              if (typeof tempStart === 'number' && tempStart >= 0) {\n                startIndex = Math.min(startIndex, tempStart);\n              }\n            });\n\n            if (startIndex < Infinity && startIndex >= 0) {\n              cutSrc = src.substring(0, startIndex + 1);\n            }\n          })();\n        }\n\n        if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {\n          src = src.substring(token.raw.length);\n\n          if (token.raw.slice(-1) !== '_') {\n            // Track prevChar before string of ____ started\n            prevChar = token.raw.slice(-1);\n          }\n\n          keepPrevChar = true;\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        }\n\n        if (src) {\n          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n\n          if (this.options.silent) {\n            console.error(errMsg);\n            break;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n\n      return tokens;\n    };\n\n    _createClass(Lexer, null, [{\n      key: \"rules\",\n      get: function get() {\n        return {\n          block: block,\n          inline: inline\n        };\n      }\n    }]);\n\n    return Lexer;\n  }();\n\n  /**\n   * Renderer\n   */\n\n  var Renderer = /*#__PURE__*/function () {\n    function Renderer(options) {\n      this.options = options || exports.defaults;\n    }\n\n    var _proto = Renderer.prototype;\n\n    _proto.code = function code(_code, infostring, escaped) {\n      var lang = (infostring || '').match(/\\S*/)[0];\n\n      if (this.options.highlight) {\n        var out = this.options.highlight(_code, lang);\n\n        if (out != null && out !== _code) {\n          escaped = true;\n          _code = out;\n        }\n      }\n\n      _code = _code.replace(/\\n$/, '') + '\\n';\n\n      if (!lang) {\n        return '<pre><code>' + (escaped ? _code : escape(_code, true)) + '</code></pre>\\n';\n      }\n\n      return '<pre><code class=\"' + this.options.langPrefix + escape(lang, true) + '\">' + (escaped ? _code : escape(_code, true)) + '</code></pre>\\n';\n    }\n    /**\n     * @param {string} quote\n     */\n    ;\n\n    _proto.blockquote = function blockquote(quote) {\n      return \"<blockquote>\\n\" + quote + \"</blockquote>\\n\";\n    };\n\n    _proto.html = function html(_html) {\n      return _html;\n    }\n    /**\n     * @param {string} text\n     * @param {string} level\n     * @param {string} raw\n     * @param {any} slugger\n     */\n    ;\n\n    _proto.heading = function heading(text, level, raw, slugger) {\n      if (this.options.headerIds) {\n        var id = this.options.headerPrefix + slugger.slug(raw);\n        return \"<h\" + level + \" id=\\\"\" + id + \"\\\">\" + text + \"</h\" + level + \">\\n\";\n      } // ignore IDs\n\n\n      return \"<h\" + level + \">\" + text + \"</h\" + level + \">\\n\";\n    };\n\n    _proto.hr = function hr() {\n      return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n    };\n\n    _proto.list = function list(body, ordered, start) {\n      var type = ordered ? 'ol' : 'ul',\n          startatt = ordered && start !== 1 ? ' start=\"' + start + '\"' : '';\n      return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.listitem = function listitem(text) {\n      return \"<li>\" + text + \"</li>\\n\";\n    };\n\n    _proto.checkbox = function checkbox(checked) {\n      return '<input ' + (checked ? 'checked=\"\" ' : '') + 'disabled=\"\" type=\"checkbox\"' + (this.options.xhtml ? ' /' : '') + '> ';\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.paragraph = function paragraph(text) {\n      return \"<p>\" + text + \"</p>\\n\";\n    }\n    /**\n     * @param {string} header\n     * @param {string} body\n     */\n    ;\n\n    _proto.table = function table(header, body) {\n      if (body) body = \"<tbody>\" + body + \"</tbody>\";\n      return '<table>\\n' + '<thead>\\n' + header + '</thead>\\n' + body + '</table>\\n';\n    }\n    /**\n     * @param {string} content\n     */\n    ;\n\n    _proto.tablerow = function tablerow(content) {\n      return \"<tr>\\n\" + content + \"</tr>\\n\";\n    };\n\n    _proto.tablecell = function tablecell(content, flags) {\n      var type = flags.header ? 'th' : 'td';\n      var tag = flags.align ? \"<\" + type + \" align=\\\"\" + flags.align + \"\\\">\" : \"<\" + type + \">\";\n      return tag + content + (\"</\" + type + \">\\n\");\n    }\n    /**\n     * span level renderer\n     * @param {string} text\n     */\n    ;\n\n    _proto.strong = function strong(text) {\n      return \"<strong>\" + text + \"</strong>\";\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.em = function em(text) {\n      return \"<em>\" + text + \"</em>\";\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.codespan = function codespan(text) {\n      return \"<code>\" + text + \"</code>\";\n    };\n\n    _proto.br = function br() {\n      return this.options.xhtml ? '<br/>' : '<br>';\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.del = function del(text) {\n      return \"<del>\" + text + \"</del>\";\n    }\n    /**\n     * @param {string} href\n     * @param {string} title\n     * @param {string} text\n     */\n    ;\n\n    _proto.link = function link(href, title, text) {\n      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n\n      if (href === null) {\n        return text;\n      }\n\n      var out = '<a href=\"' + escape(href) + '\"';\n\n      if (title) {\n        out += ' title=\"' + title + '\"';\n      }\n\n      out += '>' + text + '</a>';\n      return out;\n    }\n    /**\n     * @param {string} href\n     * @param {string} title\n     * @param {string} text\n     */\n    ;\n\n    _proto.image = function image(href, title, text) {\n      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n\n      if (href === null) {\n        return text;\n      }\n\n      var out = \"<img src=\\\"\" + href + \"\\\" alt=\\\"\" + text + \"\\\"\";\n\n      if (title) {\n        out += \" title=\\\"\" + title + \"\\\"\";\n      }\n\n      out += this.options.xhtml ? '/>' : '>';\n      return out;\n    };\n\n    _proto.text = function text(_text) {\n      return _text;\n    };\n\n    return Renderer;\n  }();\n\n  /**\n   * TextRenderer\n   * returns only the textual part of the token\n   */\n  var TextRenderer = /*#__PURE__*/function () {\n    function TextRenderer() {}\n\n    var _proto = TextRenderer.prototype;\n\n    // no need for block level renderers\n    _proto.strong = function strong(text) {\n      return text;\n    };\n\n    _proto.em = function em(text) {\n      return text;\n    };\n\n    _proto.codespan = function codespan(text) {\n      return text;\n    };\n\n    _proto.del = function del(text) {\n      return text;\n    };\n\n    _proto.html = function html(text) {\n      return text;\n    };\n\n    _proto.text = function text(_text) {\n      return _text;\n    };\n\n    _proto.link = function link(href, title, text) {\n      return '' + text;\n    };\n\n    _proto.image = function image(href, title, text) {\n      return '' + text;\n    };\n\n    _proto.br = function br() {\n      return '';\n    };\n\n    return TextRenderer;\n  }();\n\n  /**\n   * Slugger generates header id\n   */\n  var Slugger = /*#__PURE__*/function () {\n    function Slugger() {\n      this.seen = {};\n    }\n    /**\n     * @param {string} value\n     */\n\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '').replace(/\\s/g, '-');\n    }\n    /**\n     * Finds the next safe (unique) slug to use\n     * @param {string} originalSlug\n     * @param {boolean} isDryRun\n     */\n    ;\n\n    _proto.getNextSafeSlug = function getNextSafeSlug(originalSlug, isDryRun) {\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.seen.hasOwnProperty(slug));\n      }\n\n      if (!isDryRun) {\n        this.seen[originalSlug] = occurenceAccumulator;\n        this.seen[slug] = 0;\n      }\n\n      return slug;\n    }\n    /**\n     * Convert string to unique id\n     * @param {object} [options]\n     * @param {boolean} [options.dryrun] Generates the next unique slug without\n     * updating the internal accumulator.\n     */\n    ;\n\n    _proto.slug = function slug(value, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      var slug = this.serialize(value);\n      return this.getNextSafeSlug(slug, options.dryrun);\n    };\n\n    return Slugger;\n  }();\n\n  /**\n   * Parsing & Compiling\n   */\n\n  var Parser = /*#__PURE__*/function () {\n    function Parser(options) {\n      this.options = options || exports.defaults;\n      this.options.renderer = this.options.renderer || new Renderer();\n      this.renderer = this.options.renderer;\n      this.renderer.options = this.options;\n      this.textRenderer = new TextRenderer();\n      this.slugger = new Slugger();\n    }\n    /**\n     * Static Parse Method\n     */\n\n\n    Parser.parse = function parse(tokens, options) {\n      var parser = new Parser(options);\n      return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    ;\n\n    Parser.parseInline = function parseInline(tokens, options) {\n      var parser = new Parser(options);\n      return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    ;\n\n    var _proto = Parser.prototype;\n\n    _proto.parse = function parse(tokens, top) {\n      if (top === void 0) {\n        top = true;\n      }\n\n      var out = '',\n          i,\n          j,\n          k,\n          l2,\n          l3,\n          row,\n          cell,\n          header,\n          body,\n          token,\n          ordered,\n          start,\n          loose,\n          itemBody,\n          item,\n          checked,\n          task,\n          checkbox,\n          ret;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i]; // Run any renderer extensions\n\n        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n          ret = this.options.extensions.renderers[token.type].call({\n            parser: this\n          }, token);\n\n          if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {\n            out += ret || '';\n            continue;\n          }\n        }\n\n        switch (token.type) {\n          case 'space':\n            {\n              continue;\n            }\n\n          case 'hr':\n            {\n              out += this.renderer.hr();\n              continue;\n            }\n\n          case 'heading':\n            {\n              out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape(this.parseInline(token.tokens, this.textRenderer)), this.slugger);\n              continue;\n            }\n\n          case 'code':\n            {\n              out += this.renderer.code(token.text, token.lang, token.escaped);\n              continue;\n            }\n\n          case 'table':\n            {\n              header = ''; // header\n\n              cell = '';\n              l2 = token.header.length;\n\n              for (j = 0; j < l2; j++) {\n                cell += this.renderer.tablecell(this.parseInline(token.header[j].tokens), {\n                  header: true,\n                  align: token.align[j]\n                });\n              }\n\n              header += this.renderer.tablerow(cell);\n              body = '';\n              l2 = token.rows.length;\n\n              for (j = 0; j < l2; j++) {\n                row = token.rows[j];\n                cell = '';\n                l3 = row.length;\n\n                for (k = 0; k < l3; k++) {\n                  cell += this.renderer.tablecell(this.parseInline(row[k].tokens), {\n                    header: false,\n                    align: token.align[k]\n                  });\n                }\n\n                body += this.renderer.tablerow(cell);\n              }\n\n              out += this.renderer.table(header, body);\n              continue;\n            }\n\n          case 'blockquote':\n            {\n              body = this.parse(token.tokens);\n              out += this.renderer.blockquote(body);\n              continue;\n            }\n\n          case 'list':\n            {\n              ordered = token.ordered;\n              start = token.start;\n              loose = token.loose;\n              l2 = token.items.length;\n              body = '';\n\n              for (j = 0; j < l2; j++) {\n                item = token.items[j];\n                checked = item.checked;\n                task = item.task;\n                itemBody = '';\n\n                if (item.task) {\n                  checkbox = this.renderer.checkbox(checked);\n\n                  if (loose) {\n                    if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                      item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n\n                      if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                      }\n                    } else {\n                      item.tokens.unshift({\n                        type: 'text',\n                        text: checkbox\n                      });\n                    }\n                  } else {\n                    itemBody += checkbox;\n                  }\n                }\n\n                itemBody += this.parse(item.tokens, loose);\n                body += this.renderer.listitem(itemBody, task, checked);\n              }\n\n              out += this.renderer.list(body, ordered, start);\n              continue;\n            }\n\n          case 'html':\n            {\n              // TODO parse inline content if parameter markdown=1\n              out += this.renderer.html(token.text);\n              continue;\n            }\n\n          case 'paragraph':\n            {\n              out += this.renderer.paragraph(this.parseInline(token.tokens));\n              continue;\n            }\n\n          case 'text':\n            {\n              body = token.tokens ? this.parseInline(token.tokens) : token.text;\n\n              while (i + 1 < l && tokens[i + 1].type === 'text') {\n                token = tokens[++i];\n                body += '\\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);\n              }\n\n              out += top ? this.renderer.paragraph(body) : body;\n              continue;\n            }\n\n          default:\n            {\n              var errMsg = 'Token with \"' + token.type + '\" type was not found.';\n\n              if (this.options.silent) {\n                console.error(errMsg);\n                return;\n              } else {\n                throw new Error(errMsg);\n              }\n            }\n        }\n      }\n\n      return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    ;\n\n    _proto.parseInline = function parseInline(tokens, renderer) {\n      renderer = renderer || this.renderer;\n      var out = '',\n          i,\n          token,\n          ret;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i]; // Run any renderer extensions\n\n        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n          ret = this.options.extensions.renderers[token.type].call({\n            parser: this\n          }, token);\n\n          if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {\n            out += ret || '';\n            continue;\n          }\n        }\n\n        switch (token.type) {\n          case 'escape':\n            {\n              out += renderer.text(token.text);\n              break;\n            }\n\n          case 'html':\n            {\n              out += renderer.html(token.text);\n              break;\n            }\n\n          case 'link':\n            {\n              out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'image':\n            {\n              out += renderer.image(token.href, token.title, token.text);\n              break;\n            }\n\n          case 'strong':\n            {\n              out += renderer.strong(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'em':\n            {\n              out += renderer.em(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'codespan':\n            {\n              out += renderer.codespan(token.text);\n              break;\n            }\n\n          case 'br':\n            {\n              out += renderer.br();\n              break;\n            }\n\n          case 'del':\n            {\n              out += renderer.del(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'text':\n            {\n              out += renderer.text(token.text);\n              break;\n            }\n\n          default:\n            {\n              var errMsg = 'Token with \"' + token.type + '\" type was not found.';\n\n              if (this.options.silent) {\n                console.error(errMsg);\n                return;\n              } else {\n                throw new Error(errMsg);\n              }\n            }\n        }\n      }\n\n      return out;\n    };\n\n    return Parser;\n  }();\n\n  /**\n   * Marked\n   */\n\n  function marked(src, opt, callback) {\n    // throw error in case of non string input\n    if (typeof src === 'undefined' || src === null) {\n      throw new Error('marked(): input parameter is undefined or null');\n    }\n\n    if (typeof src !== 'string') {\n      throw new Error('marked(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n    }\n\n    if (typeof opt === 'function') {\n      callback = opt;\n      opt = null;\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n    checkSanitizeDeprecation(opt);\n\n    if (callback) {\n      var highlight = opt.highlight;\n      var tokens;\n\n      try {\n        tokens = Lexer.lex(src, opt);\n      } catch (e) {\n        return callback(e);\n      }\n\n      var done = function done(err) {\n        var out;\n\n        if (!err) {\n          try {\n            if (opt.walkTokens) {\n              marked.walkTokens(tokens, opt.walkTokens);\n            }\n\n            out = Parser.parse(tokens, opt);\n          } catch (e) {\n            err = e;\n          }\n        }\n\n        opt.highlight = highlight;\n        return err ? callback(err) : callback(null, out);\n      };\n\n      if (!highlight || highlight.length < 3) {\n        return done();\n      }\n\n      delete opt.highlight;\n      if (!tokens.length) return done();\n      var pending = 0;\n      marked.walkTokens(tokens, function (token) {\n        if (token.type === 'code') {\n          pending++;\n          setTimeout(function () {\n            highlight(token.text, token.lang, function (err, code) {\n              if (err) {\n                return done(err);\n              }\n\n              if (code != null && code !== token.text) {\n                token.text = code;\n                token.escaped = true;\n              }\n\n              pending--;\n\n              if (pending === 0) {\n                done();\n              }\n            });\n          }, 0);\n        }\n      });\n\n      if (pending === 0) {\n        done();\n      }\n\n      return;\n    }\n\n    try {\n      var _tokens = Lexer.lex(src, opt);\n\n      if (opt.walkTokens) {\n        marked.walkTokens(_tokens, opt.walkTokens);\n      }\n\n      return Parser.parse(_tokens, opt);\n    } catch (e) {\n      e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n      if (opt.silent) {\n        return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';\n      }\n\n      throw e;\n    }\n  }\n  /**\n   * Options\n   */\n\n  marked.options = marked.setOptions = function (opt) {\n    merge(marked.defaults, opt);\n    changeDefaults(marked.defaults);\n    return marked;\n  };\n\n  marked.getDefaults = getDefaults;\n  marked.defaults = exports.defaults;\n  /**\n   * Use Extension\n   */\n\n  marked.use = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var opts = merge.apply(void 0, [{}].concat(args));\n    var extensions = marked.defaults.extensions || {\n      renderers: {},\n      childTokens: {}\n    };\n    var hasExtensions;\n    args.forEach(function (pack) {\n      // ==-- Parse \"addon\" extensions --== //\n      if (pack.extensions) {\n        hasExtensions = true;\n        pack.extensions.forEach(function (ext) {\n          if (!ext.name) {\n            throw new Error('extension name required');\n          }\n\n          if (ext.renderer) {\n            // Renderer extensions\n            var prevRenderer = extensions.renderers ? extensions.renderers[ext.name] : null;\n\n            if (prevRenderer) {\n              // Replace extension with func to run new extension but fall back if false\n              extensions.renderers[ext.name] = function () {\n                for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                  args[_key2] = arguments[_key2];\n                }\n\n                var ret = ext.renderer.apply(this, args);\n\n                if (ret === false) {\n                  ret = prevRenderer.apply(this, args);\n                }\n\n                return ret;\n              };\n            } else {\n              extensions.renderers[ext.name] = ext.renderer;\n            }\n          }\n\n          if (ext.tokenizer) {\n            // Tokenizer Extensions\n            if (!ext.level || ext.level !== 'block' && ext.level !== 'inline') {\n              throw new Error(\"extension level must be 'block' or 'inline'\");\n            }\n\n            if (extensions[ext.level]) {\n              extensions[ext.level].unshift(ext.tokenizer);\n            } else {\n              extensions[ext.level] = [ext.tokenizer];\n            }\n\n            if (ext.start) {\n              // Function to check for start of token\n              if (ext.level === 'block') {\n                if (extensions.startBlock) {\n                  extensions.startBlock.push(ext.start);\n                } else {\n                  extensions.startBlock = [ext.start];\n                }\n              } else if (ext.level === 'inline') {\n                if (extensions.startInline) {\n                  extensions.startInline.push(ext.start);\n                } else {\n                  extensions.startInline = [ext.start];\n                }\n              }\n            }\n          }\n\n          if (ext.childTokens) {\n            // Child tokens to be visited by walkTokens\n            extensions.childTokens[ext.name] = ext.childTokens;\n          }\n        });\n      } // ==-- Parse \"overwrite\" extensions --== //\n\n\n      if (pack.renderer) {\n        (function () {\n          var renderer = marked.defaults.renderer || new Renderer();\n\n          var _loop = function _loop(prop) {\n            var prevRenderer = renderer[prop]; // Replace renderer with func to run extension, but fall back if false\n\n            renderer[prop] = function () {\n              for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n                args[_key3] = arguments[_key3];\n              }\n\n              var ret = pack.renderer[prop].apply(renderer, args);\n\n              if (ret === false) {\n                ret = prevRenderer.apply(renderer, args);\n              }\n\n              return ret;\n            };\n          };\n\n          for (var prop in pack.renderer) {\n            _loop(prop);\n          }\n\n          opts.renderer = renderer;\n        })();\n      }\n\n      if (pack.tokenizer) {\n        (function () {\n          var tokenizer = marked.defaults.tokenizer || new Tokenizer();\n\n          var _loop2 = function _loop2(prop) {\n            var prevTokenizer = tokenizer[prop]; // Replace tokenizer with func to run extension, but fall back if false\n\n            tokenizer[prop] = function () {\n              for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n                args[_key4] = arguments[_key4];\n              }\n\n              var ret = pack.tokenizer[prop].apply(tokenizer, args);\n\n              if (ret === false) {\n                ret = prevTokenizer.apply(tokenizer, args);\n              }\n\n              return ret;\n            };\n          };\n\n          for (var prop in pack.tokenizer) {\n            _loop2(prop);\n          }\n\n          opts.tokenizer = tokenizer;\n        })();\n      } // ==-- Parse WalkTokens extensions --== //\n\n\n      if (pack.walkTokens) {\n        var _walkTokens = marked.defaults.walkTokens;\n\n        opts.walkTokens = function (token) {\n          pack.walkTokens.call(this, token);\n\n          if (_walkTokens) {\n            _walkTokens.call(this, token);\n          }\n        };\n      }\n\n      if (hasExtensions) {\n        opts.extensions = extensions;\n      }\n\n      marked.setOptions(opts);\n    });\n  };\n  /**\n   * Run callback for every token\n   */\n\n\n  marked.walkTokens = function (tokens, callback) {\n    var _loop3 = function _loop3() {\n      var token = _step.value;\n      callback.call(marked, token);\n\n      switch (token.type) {\n        case 'table':\n          {\n            for (var _iterator2 = _createForOfIteratorHelperLoose(token.header), _step2; !(_step2 = _iterator2()).done;) {\n              var cell = _step2.value;\n              marked.walkTokens(cell.tokens, callback);\n            }\n\n            for (var _iterator3 = _createForOfIteratorHelperLoose(token.rows), _step3; !(_step3 = _iterator3()).done;) {\n              var row = _step3.value;\n\n              for (var _iterator4 = _createForOfIteratorHelperLoose(row), _step4; !(_step4 = _iterator4()).done;) {\n                var _cell = _step4.value;\n                marked.walkTokens(_cell.tokens, callback);\n              }\n            }\n\n            break;\n          }\n\n        case 'list':\n          {\n            marked.walkTokens(token.items, callback);\n            break;\n          }\n\n        default:\n          {\n            if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) {\n              // Walk any extensions\n              marked.defaults.extensions.childTokens[token.type].forEach(function (childTokens) {\n                marked.walkTokens(token[childTokens], callback);\n              });\n            } else if (token.tokens) {\n              marked.walkTokens(token.tokens, callback);\n            }\n          }\n      }\n    };\n\n    for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done;) {\n      _loop3();\n    }\n  };\n  /**\n   * Parse Inline\n   * @param {string} src\n   */\n\n\n  marked.parseInline = function (src, opt) {\n    // throw error in case of non string input\n    if (typeof src === 'undefined' || src === null) {\n      throw new Error('marked.parseInline(): input parameter is undefined or null');\n    }\n\n    if (typeof src !== 'string') {\n      throw new Error('marked.parseInline(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n    checkSanitizeDeprecation(opt);\n\n    try {\n      var tokens = Lexer.lexInline(src, opt);\n\n      if (opt.walkTokens) {\n        marked.walkTokens(tokens, opt.walkTokens);\n      }\n\n      return Parser.parseInline(tokens, opt);\n    } catch (e) {\n      e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n      if (opt.silent) {\n        return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';\n      }\n\n      throw e;\n    }\n  };\n  /**\n   * Expose\n   */\n\n\n  marked.Parser = Parser;\n  marked.parser = Parser.parse;\n  marked.Renderer = Renderer;\n  marked.TextRenderer = TextRenderer;\n  marked.Lexer = Lexer;\n  marked.lexer = Lexer.lex;\n  marked.Tokenizer = Tokenizer;\n  marked.Slugger = Slugger;\n  marked.parse = marked;\n  var options = marked.options;\n  var setOptions = marked.setOptions;\n  var use = marked.use;\n  var walkTokens = marked.walkTokens;\n  var parseInline = marked.parseInline;\n  var parse = marked;\n  var parser = Parser.parse;\n  var lexer = Lexer.lex;\n\n  exports.Lexer = Lexer;\n  exports.Parser = Parser;\n  exports.Renderer = Renderer;\n  exports.Slugger = Slugger;\n  exports.TextRenderer = TextRenderer;\n  exports.Tokenizer = Tokenizer;\n  exports.getDefaults = getDefaults;\n  exports.lexer = lexer;\n  exports.marked = marked;\n  exports.options = options;\n  exports.parse = parse;\n  exports.parseInline = parseInline;\n  exports.parser = parser;\n  exports.setOptions = setOptions;\n  exports.use = use;\n  exports.walkTokens = walkTokens;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n\n// ESM-uncomment-begin\n})();\nexport var marked = (__marked_exports || exports);\n// ESM-uncomment-end\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as DOM from './dom.js';\nimport * as dompurify from './dompurify/dompurify.js';\nimport { DomEmitter } from './event.js';\nimport { createElement } from './formattedTextRenderer.js';\nimport { StandardMouseEvent } from './mouseEvent.js';\nimport { renderLabelWithIcons } from './ui/iconLabel/iconLabels.js';\nimport { onUnexpectedError } from '../common/errors.js';\nimport { Event } from '../common/event.js';\nimport { escapeDoubleQuotes, parseHrefAndDimensions, removeMarkdownEscapes } from '../common/htmlContent.js';\nimport { markdownEscapeEscapedIcons } from '../common/iconLabels.js';\nimport { defaultGenerator } from '../common/idGenerator.js';\nimport { DisposableStore } from '../common/lifecycle.js';\nimport { marked } from '../common/marked/marked.js';\nimport { parse } from '../common/marshalling.js';\nimport { FileAccess, Schemas } from '../common/network.js';\nimport { cloneAndChange } from '../common/objects.js';\nimport { dirname, resolvePath } from '../common/resources.js';\nimport { escape } from '../common/strings.js';\nimport { URI } from '../common/uri.js';\n/**\n * Low-level way create a html element from a markdown string.\n *\n * **Note** that for most cases you should be using [`MarkdownRenderer`](./src/vs/editor/contrib/markdownRenderer/browser/markdownRenderer.ts)\n * which comes with support for pretty code block rendering and which uses the default way of handling links.\n */\nexport function renderMarkdown(markdown, options = {}, markedOptions = {}) {\n    var _a;\n    const disposables = new DisposableStore();\n    let isDisposed = false;\n    const element = createElement(options);\n    const _uriMassage = function (part) {\n        let data;\n        try {\n            data = parse(decodeURIComponent(part));\n        }\n        catch (e) {\n            // ignore\n        }\n        if (!data) {\n            return part;\n        }\n        data = cloneAndChange(data, value => {\n            if (markdown.uris && markdown.uris[value]) {\n                return URI.revive(markdown.uris[value]);\n            }\n            else {\n                return undefined;\n            }\n        });\n        return encodeURIComponent(JSON.stringify(data));\n    };\n    const _href = function (href, isDomUri) {\n        const data = markdown.uris && markdown.uris[href];\n        let uri = URI.revive(data);\n        if (isDomUri) {\n            if (href.startsWith(Schemas.data + ':')) {\n                return href;\n            }\n            if (!uri) {\n                uri = URI.parse(href);\n            }\n            // this URI will end up as \"src\"-attribute of a dom node\n            // and because of that special rewriting needs to be done\n            // so that the URI uses a protocol that's understood by\n            // browsers (like http or https)\n            return FileAccess.asBrowserUri(uri).toString(true);\n        }\n        if (!uri) {\n            return href;\n        }\n        if (URI.parse(href).toString() === uri.toString()) {\n            return href; // no transformation performed\n        }\n        if (uri.query) {\n            uri = uri.with({ query: _uriMassage(uri.query) });\n        }\n        return uri.toString();\n    };\n    const renderer = new marked.Renderer();\n    renderer.image = (href, title, text) => {\n        let dimensions = [];\n        let attributes = [];\n        if (href) {\n            ({ href, dimensions } = parseHrefAndDimensions(href));\n            attributes.push(`src=\"${escapeDoubleQuotes(href)}\"`);\n        }\n        if (text) {\n            attributes.push(`alt=\"${escapeDoubleQuotes(text)}\"`);\n        }\n        if (title) {\n            attributes.push(`title=\"${escapeDoubleQuotes(title)}\"`);\n        }\n        if (dimensions.length) {\n            attributes = attributes.concat(dimensions);\n        }\n        return '<img ' + attributes.join(' ') + '>';\n    };\n    renderer.link = (href, title, text) => {\n        if (typeof href !== 'string') {\n            return '';\n        }\n        // Remove markdown escapes. Workaround for https://github.com/chjj/marked/issues/829\n        if (href === text) { // raw link case\n            text = removeMarkdownEscapes(text);\n        }\n        title = typeof title === 'string' ? escapeDoubleQuotes(removeMarkdownEscapes(title)) : '';\n        href = removeMarkdownEscapes(href);\n        // HTML Encode href\n        href = href.replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&#39;');\n        return `<a href=\"${href}\" title=\"${title || href}\">${text}</a>`;\n    };\n    renderer.paragraph = (text) => {\n        return `<p>${text}</p>`;\n    };\n    // Will collect [id, renderedElement] tuples\n    const codeBlocks = [];\n    if (options.codeBlockRenderer) {\n        renderer.code = (code, lang) => {\n            const id = defaultGenerator.nextId();\n            const value = options.codeBlockRenderer(lang !== null && lang !== void 0 ? lang : '', code);\n            codeBlocks.push(value.then(element => [id, element]));\n            return `<div class=\"code\" data-code=\"${id}\">${escape(code)}</div>`;\n        };\n    }\n    if (options.actionHandler) {\n        const onClick = options.actionHandler.disposables.add(new DomEmitter(element, 'click'));\n        const onAuxClick = options.actionHandler.disposables.add(new DomEmitter(element, 'auxclick'));\n        options.actionHandler.disposables.add(Event.any(onClick.event, onAuxClick.event)(e => {\n            const mouseEvent = new StandardMouseEvent(e);\n            if (!mouseEvent.leftButton && !mouseEvent.middleButton) {\n                return;\n            }\n            let target = mouseEvent.target;\n            if (target.tagName !== 'A') {\n                target = target.parentElement;\n                if (!target || target.tagName !== 'A') {\n                    return;\n                }\n            }\n            try {\n                let href = target.dataset['href'];\n                if (href) {\n                    if (markdown.baseUri) {\n                        href = resolveWithBaseUri(URI.from(markdown.baseUri), href);\n                    }\n                    options.actionHandler.callback(href, mouseEvent);\n                }\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                mouseEvent.preventDefault();\n            }\n        }));\n    }\n    if (!markdown.supportHtml) {\n        // TODO: Can we deprecated this in favor of 'supportHtml'?\n        // Use our own sanitizer so that we can let through only spans.\n        // Otherwise, we'd be letting all html be rendered.\n        // If we want to allow markdown permitted tags, then we can delete sanitizer and sanitize.\n        // We always pass the output through dompurify after this so that we don't rely on\n        // marked for sanitization.\n        markedOptions.sanitizer = (html) => {\n            const match = markdown.isTrusted ? html.match(/^(<span[^>]+>)|(<\\/\\s*span>)$/) : undefined;\n            return match ? html : '';\n        };\n        markedOptions.sanitize = true;\n        markedOptions.silent = true;\n    }\n    markedOptions.renderer = renderer;\n    // values that are too long will freeze the UI\n    let value = (_a = markdown.value) !== null && _a !== void 0 ? _a : '';\n    if (value.length > 100000) {\n        value = `${value.substr(0, 100000)}`;\n    }\n    // escape theme icons\n    if (markdown.supportThemeIcons) {\n        value = markdownEscapeEscapedIcons(value);\n    }\n    let renderedMarkdown = marked.parse(value, markedOptions);\n    // Rewrite theme icons\n    if (markdown.supportThemeIcons) {\n        const elements = renderLabelWithIcons(renderedMarkdown);\n        renderedMarkdown = elements.map(e => typeof e === 'string' ? e : e.outerHTML).join('');\n    }\n    const htmlParser = new DOMParser();\n    const markdownHtmlDoc = htmlParser.parseFromString(sanitizeRenderedMarkdown(markdown, renderedMarkdown), 'text/html');\n    markdownHtmlDoc.body.querySelectorAll('img')\n        .forEach(img => {\n        const src = img.getAttribute('src'); // Get the raw 'src' attribute value as text, not the resolved 'src'\n        if (src) {\n            let href = src;\n            try {\n                if (markdown.baseUri) { // absolute or relative local path, or file: uri\n                    href = resolveWithBaseUri(URI.from(markdown.baseUri), href);\n                }\n            }\n            catch (err) { }\n            img.src = _href(href, true);\n        }\n    });\n    markdownHtmlDoc.body.querySelectorAll('a')\n        .forEach(a => {\n        const href = a.getAttribute('href'); // Get the raw 'href' attribute value as text, not the resolved 'href'\n        a.setAttribute('href', ''); // Clear out href. We use the `data-href` for handling clicks instead\n        if (!href\n            || /^data:|javascript:/i.test(href)\n            || (/^command:/i.test(href) && !markdown.isTrusted)\n            || /^command:(\\/\\/\\/)?_workbench\\.downloadResource/i.test(href)) {\n            // drop the link\n            a.replaceWith(...a.childNodes);\n        }\n        else {\n            let resolvedHref = _href(href, false);\n            if (markdown.baseUri) {\n                resolvedHref = resolveWithBaseUri(URI.from(markdown.baseUri), href);\n            }\n            a.dataset.href = resolvedHref;\n        }\n    });\n    element.innerHTML = sanitizeRenderedMarkdown(markdown, markdownHtmlDoc.body.innerHTML);\n    if (codeBlocks.length > 0) {\n        Promise.all(codeBlocks).then((tuples) => {\n            var _a, _b;\n            if (isDisposed) {\n                return;\n            }\n            const renderedElements = new Map(tuples);\n            const placeholderElements = element.querySelectorAll(`div[data-code]`);\n            for (const placeholderElement of placeholderElements) {\n                const renderedElement = renderedElements.get((_a = placeholderElement.dataset['code']) !== null && _a !== void 0 ? _a : '');\n                if (renderedElement) {\n                    DOM.reset(placeholderElement, renderedElement);\n                }\n            }\n            (_b = options.asyncRenderCallback) === null || _b === void 0 ? void 0 : _b.call(options);\n        });\n    }\n    // signal size changes for image tags\n    if (options.asyncRenderCallback) {\n        for (const img of element.getElementsByTagName('img')) {\n            const listener = disposables.add(DOM.addDisposableListener(img, 'load', () => {\n                listener.dispose();\n                options.asyncRenderCallback();\n            }));\n        }\n    }\n    return {\n        element,\n        dispose: () => {\n            isDisposed = true;\n            disposables.dispose();\n        }\n    };\n}\nfunction resolveWithBaseUri(baseUri, href) {\n    const hasScheme = /^\\w[\\w\\d+.-]*:/.test(href);\n    if (hasScheme) {\n        return href;\n    }\n    if (baseUri.path.endsWith('/')) {\n        return resolvePath(baseUri, href).toString();\n    }\n    else {\n        return resolvePath(dirname(baseUri), href).toString();\n    }\n}\nfunction sanitizeRenderedMarkdown(options, renderedMarkdown) {\n    const { config, allowedSchemes } = getSanitizerOptions(options);\n    dompurify.addHook('uponSanitizeAttribute', (element, e) => {\n        if (e.attrName === 'style' || e.attrName === 'class') {\n            if (element.tagName === 'SPAN') {\n                if (e.attrName === 'style') {\n                    e.keepAttr = /^(color\\:#[0-9a-fA-F]+;)?(background-color\\:#[0-9a-fA-F]+;)?$/.test(e.attrValue);\n                    return;\n                }\n                else if (e.attrName === 'class') {\n                    e.keepAttr = /^codicon codicon-[a-z\\-]+( codicon-modifier-[a-z\\-]+)?$/.test(e.attrValue);\n                    return;\n                }\n            }\n            e.keepAttr = false;\n            return;\n        }\n    });\n    const hook = DOM.hookDomPurifyHrefAndSrcSanitizer(allowedSchemes);\n    try {\n        return dompurify.sanitize(renderedMarkdown, Object.assign(Object.assign({}, config), { RETURN_TRUSTED_TYPE: true }));\n    }\n    finally {\n        dompurify.removeHook('uponSanitizeAttribute');\n        hook.dispose();\n    }\n}\nfunction getSanitizerOptions(options) {\n    const allowedSchemes = [\n        Schemas.http,\n        Schemas.https,\n        Schemas.mailto,\n        Schemas.data,\n        Schemas.file,\n        Schemas.vscodeFileResource,\n        Schemas.vscodeRemote,\n        Schemas.vscodeRemoteResource,\n    ];\n    if (options.isTrusted) {\n        allowedSchemes.push(Schemas.command);\n    }\n    return {\n        config: {\n            // allowedTags should included everything that markdown renders to.\n            // Since we have our own sanitize function for marked, it's possible we missed some tag so let dompurify make sure.\n            // HTML tags that can result from markdown are from reading https://spec.commonmark.org/0.29/\n            // HTML table tags that can result from markdown are from https://github.github.com/gfm/#tables-extension-\n            ALLOWED_TAGS: ['ul', 'li', 'p', 'b', 'i', 'code', 'blockquote', 'ol', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'em', 'pre', 'table', 'thead', 'tbody', 'tr', 'th', 'td', 'div', 'del', 'a', 'strong', 'br', 'img', 'span'],\n            ALLOWED_ATTR: ['href', 'data-href', 'target', 'title', 'src', 'alt', 'class', 'style', 'data-code', 'width', 'height', 'align'],\n            ALLOW_UNKNOWN_PROTOCOLS: true,\n        },\n        allowedSchemes\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a;\nimport { renderMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { tokenizeToString } from '../../../common/languages/textToHtmlTokenizer.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { applyFontInfo } from '../../../browser/config/domFontInfo.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../common/languages/modesRegistry.js';\n/**\n * Markdown renderer that can render codeblocks with the editor mechanics. This\n * renderer should always be preferred.\n */\nlet MarkdownRenderer = class MarkdownRenderer {\n    constructor(_options, _languageService, _openerService) {\n        this._options = _options;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._onDidRenderAsync = new Emitter();\n        this.onDidRenderAsync = this._onDidRenderAsync.event;\n    }\n    dispose() {\n        this._onDidRenderAsync.dispose();\n    }\n    render(markdown, options, markedOptions) {\n        if (!markdown) {\n            const element = document.createElement('span');\n            return { element, dispose: () => { } };\n        }\n        const disposables = new DisposableStore();\n        const rendered = disposables.add(renderMarkdown(markdown, Object.assign(Object.assign({}, this._getRenderOptions(markdown, disposables)), options), markedOptions));\n        return {\n            element: rendered.element,\n            dispose: () => disposables.dispose()\n        };\n    }\n    _getRenderOptions(markdown, disposables) {\n        return {\n            codeBlockRenderer: (languageAlias, value) => __awaiter(this, void 0, void 0, function* () {\n                var _a, _b, _c;\n                // In markdown,\n                // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\n                // it is possible no alias is given in which case we fall back to the current editor lang\n                let languageId;\n                if (languageAlias) {\n                    languageId = this._languageService.getLanguageIdByLanguageName(languageAlias);\n                }\n                else if (this._options.editor) {\n                    languageId = (_a = this._options.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLanguageId();\n                }\n                if (!languageId) {\n                    languageId = PLAINTEXT_LANGUAGE_ID;\n                }\n                const html = yield tokenizeToString(this._languageService, value, languageId);\n                const element = document.createElement('span');\n                element.innerHTML = ((_c = (_b = MarkdownRenderer._ttpTokenizer) === null || _b === void 0 ? void 0 : _b.createHTML(html)) !== null && _c !== void 0 ? _c : html);\n                // use \"good\" font\n                if (this._options.editor) {\n                    const fontInfo = this._options.editor.getOption(46 /* EditorOption.fontInfo */);\n                    applyFontInfo(element, fontInfo);\n                }\n                else if (this._options.codeBlockFontFamily) {\n                    element.style.fontFamily = this._options.codeBlockFontFamily;\n                }\n                if (this._options.codeBlockFontSize !== undefined) {\n                    element.style.fontSize = this._options.codeBlockFontSize;\n                }\n                return element;\n            }),\n            asyncRenderCallback: () => this._onDidRenderAsync.fire(),\n            actionHandler: {\n                callback: (content) => this._openerService.open(content, { fromUserGesture: true, allowContributedOpeners: true, allowCommands: markdown.isTrusted }).catch(onUnexpectedError),\n                disposables: disposables\n            }\n        };\n    }\n};\nMarkdownRenderer._ttpTokenizer = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('tokenizeToString', {\n    createHTML(html) {\n        return html;\n    }\n});\nMarkdownRenderer = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService)\n], MarkdownRenderer);\nexport { MarkdownRenderer };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { isEmptyMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { NullOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nconst $ = dom.$;\nexport class MarginHoverWidget extends Disposable {\n    constructor(editor, languageService, openerService = NullOpenerService) {\n        super();\n        this._renderDisposeables = this._register(new DisposableStore());\n        this._editor = editor;\n        this._isVisible = false;\n        this._messages = [];\n        this._hover = this._register(new HoverWidget());\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        this._markdownRenderer = this._register(new MarkdownRenderer({ editor: this._editor }, languageService, openerService));\n        this._computer = new MarginHoverComputer(this._editor);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value);\n        }));\n        this._register(this._editor.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._editor.addOverlayWidget(this);\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    getId() {\n        return MarginHoverWidget.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        return null;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _onModelDecorationsChanged() {\n        if (this._isVisible) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n        }\n    }\n    startShowingAt(lineNumber) {\n        if (this._computer.lineNumber === lineNumber) {\n            // We have to show the widget at the exact same line number as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this.hide();\n        this._computer.lineNumber = lineNumber;\n        this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n    }\n    hide() {\n        this._computer.lineNumber = -1;\n        this._hoverOperation.cancel();\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n    }\n    _withResult(result) {\n        this._messages = result;\n        if (this._messages.length > 0) {\n            this._renderMessages(this._computer.lineNumber, this._messages);\n        }\n        else {\n            this.hide();\n        }\n    }\n    _renderMessages(lineNumber, messages) {\n        this._renderDisposeables.clear();\n        const fragment = document.createDocumentFragment();\n        for (const msg of messages) {\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderedContents = this._renderDisposeables.add(this._markdownRenderer.render(msg.value));\n            hoverContentsElement.appendChild(renderedContents.element);\n            fragment.appendChild(markdownHoverElement);\n        }\n        this._updateContents(fragment);\n        this._showAt(lineNumber);\n    }\n    _updateContents(node) {\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._updateFont();\n    }\n    _showAt(lineNumber) {\n        if (!this._isVisible) {\n            this._isVisible = true;\n            this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        }\n        const editorLayout = this._editor.getLayoutInfo();\n        const topForLineNumber = this._editor.getTopForLineNumber(lineNumber);\n        const editorScrollTop = this._editor.getScrollTop();\n        const lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */);\n        const nodeHeight = this._hover.containerDomNode.clientHeight;\n        const top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\n        this._hover.containerDomNode.style.left = `${editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth}px`;\n        this._hover.containerDomNode.style.top = `${Math.max(Math.round(top), 0)}px`;\n    }\n}\nMarginHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\nclass MarginHoverComputer {\n    constructor(_editor) {\n        this._editor = _editor;\n        this._lineNumber = -1;\n    }\n    get lineNumber() {\n        return this._lineNumber;\n    }\n    set lineNumber(value) {\n        this._lineNumber = value;\n    }\n    computeSync() {\n        const toHoverMessage = (contents) => {\n            return {\n                value: contents\n            };\n        };\n        const lineDecorations = this._editor.getLineDecorations(this._lineNumber);\n        const result = [];\n        if (!lineDecorations) {\n            return result;\n        }\n        for (const d of lineDecorations) {\n            if (!d.options.glyphMarginClassName) {\n                continue;\n            }\n            const hoverMessage = d.options.glyphMarginHoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            result.push(...asArray(hoverMessage).map(toHoverMessage));\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class HoverProviderResult {\n    constructor(provider, hover, ordinal) {\n        this.provider = provider;\n        this.hover = hover;\n        this.ordinal = ordinal;\n    }\n}\nfunction executeProvider(provider, ordinal, model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            const result = yield Promise.resolve(provider.provideHover(model, position, token));\n            if (result && isValid(result)) {\n                return new HoverProviderResult(provider, result, ordinal);\n            }\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n        }\n        return undefined;\n    });\n}\nexport function getHover(registry, model, position, token) {\n    const providers = registry.ordered(model);\n    const promises = providers.map((provider, index) => executeProvider(provider, index, model, position, token));\n    return AsyncIterableObject.fromPromises(promises).coalesce();\n}\nexport function getHoverPromise(registry, model, position, token) {\n    return getHover(registry, model, position, token).map(item => item.hover).toPromise();\n}\nregisterModelAndPositionCommand('_executeHoverProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    return getHoverPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None);\n});\nfunction isValid(result) {\n    const hasRange = (typeof result.range !== 'undefined');\n    const hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\n    return hasRange && hasHtmlContent;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { getHover } from './getHover.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nconst $ = dom.$;\nexport class MarkdownHover {\n    constructor(owner, range, contents, ordinal) {\n        this.owner = owner;\n        this.range = range;\n        this.contents = contents;\n        this.ordinal = ordinal;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n    constructor(_editor, _languageService, _openerService, _configurationService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.hoverOrdinal = 2;\n    }\n    createLoadingMessage(anchor) {\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], 2000);\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        let index = 1000;\n        const lineLength = model.getLineLength(lineNumber);\n        const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: languageId\n        });\n        if (typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n                }], index++));\n        }\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const hoverMessage = d.options.hoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage), index++));\n        }\n        return result;\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const model = this._editor.getModel();\n        if (!this._languageFeaturesService.hoverProvider.has(model)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const position = new Position(anchor.range.startLineNumber, anchor.range.startColumn);\n        return getHover(this._languageFeaturesService.hoverProvider, model, position, token)\n            .filter(item => !isEmptyMarkdownString(item.hover.contents))\n            .map(item => {\n            const rng = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n            return new MarkdownHover(this, rng, item.hover.contents, item.ordinal);\n        });\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderMarkdownHovers(context, hoverParts, this._editor, this._languageService, this._openerService);\n    }\n};\nMarkdownHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeaturesService)\n], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nexport function renderMarkdownHovers(context, hoverParts, editor, languageService, openerService) {\n    // Sort hover parts to keep them stable since they might come in async, out-of-order\n    hoverParts.sort((a, b) => a.ordinal - b.ordinal);\n    const disposables = new DisposableStore();\n    for (const hoverPart of hoverParts) {\n        for (const contents of hoverPart.contents) {\n            if (isEmptyMarkdownString(contents)) {\n                continue;\n            }\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderer = disposables.add(new MarkdownRenderer({ editor }, languageService, openerService));\n            disposables.add(renderer.onDidRenderAsync(() => {\n                hoverContentsElement.className = 'hover-contents code-hover-contents';\n                context.onContentsChanged();\n            }));\n            const renderedContents = disposables.add(renderer.render(contents));\n            hoverContentsElement.appendChild(renderedContents.element);\n            context.fragment.appendChild(markdownHoverElement);\n        }\n    }\n    return disposables;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../base/common/codicons.js';\nimport Severity from '../../../base/common/severity.js';\nimport { problemsErrorIconForeground, problemsInfoIconForeground, problemsWarningIconForeground } from '../../theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../theme/common/themeService.js';\nexport var SeverityIcon;\n(function (SeverityIcon) {\n    function className(severity) {\n        switch (severity) {\n            case Severity.Ignore:\n                return 'severity-ignore ' + Codicon.info.classNames;\n            case Severity.Info:\n                return Codicon.info.classNames;\n            case Severity.Warning:\n                return Codicon.warning.classNames;\n            case Severity.Error:\n                return Codicon.error.classNames;\n            default:\n                return '';\n        }\n    }\n    SeverityIcon.className = className;\n})(SeverityIcon || (SeverityIcon = {}));\nregisterThemingParticipant((theme, collector) => {\n    const errorIconForeground = theme.getColor(problemsErrorIconForeground);\n    if (errorIconForeground) {\n        const errorCodiconSelector = Codicon.error.cssSelector;\n        collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${errorCodiconSelector},\n\t\t\t.markers-panel .marker-icon${errorCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${errorCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${errorCodiconSelector} {\n\t\t\t\tcolor: ${errorIconForeground};\n\t\t\t}\n\t\t`);\n    }\n    const warningIconForeground = theme.getColor(problemsWarningIconForeground);\n    if (warningIconForeground) {\n        const warningCodiconSelector = Codicon.warning.cssSelector;\n        collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${warningCodiconSelector},\n\t\t\t.markers-panel .marker-icon${warningCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${warningCodiconSelector},\n\t\t\t.extension-editor ${warningCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${warningCodiconSelector},\n\t\t\t.preferences-editor ${warningCodiconSelector} {\n\t\t\t\tcolor: ${warningIconForeground};\n\t\t\t}\n\t\t`);\n    }\n    const infoIconForeground = theme.getColor(problemsInfoIconForeground);\n    if (infoIconForeground) {\n        const infoCodiconSelector = Codicon.info.cssSelector;\n        collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${infoCodiconSelector},\n\t\t\t.markers-panel .marker-icon${infoCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${infoCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${infoCodiconSelector},\n\t\t\t.extension-editor ${infoCodiconSelector} {\n\t\t\t\tcolor: ${infoIconForeground};\n\t\t\t}\n\t\t`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/common/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(61 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(46 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nlet MarkerNavigationWidget = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\nexport { MarkerNavigationWidget };\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nexport const editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nexport const editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nexport const editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nexport const editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nexport const editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nexport const editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nexport const editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nlet MarkerController = class MarkerController {\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(MarkerController.ID);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    nagivate(next, multiFile) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.hasModel()) {\n                const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n                model.move(next, this._editor.getModel(), this._editor.getPosition());\n                if (!model.selected) {\n                    return;\n                }\n                if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                    // show in different editor\n                    this._cleanUp();\n                    const otherEditor = yield this._editorService.openCodeEditor({\n                        resource: model.selected.marker.resource,\n                        options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                    }, this._editor);\n                    if (otherEditor) {\n                        (_a = MarkerController.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                        (_b = MarkerController.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                    }\n                }\n                else {\n                    // show in this editor\n                    this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n                }\n            }\n        });\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nexport { MarkerController };\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n            }\n        });\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, disposableTimeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IMarkerDecorationsService } from '../../../common/services/markerDecorations.js';\nimport { getCodeActions } from '../../codeAction/browser/codeAction.js';\nimport { QuickFixAction, QuickFixController } from '../../codeAction/browser/codeActionCommands.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../../codeAction/browser/types.js';\nimport { MarkerController, NextMarkerAction } from '../../gotoError/browser/gotoError.js';\nimport * as nls from '../../../../nls.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { textLinkActiveForeground, textLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nconst $ = dom.$;\nexport class MarkerHover {\n    constructor(owner, range, marker) {\n        this.owner = owner;\n        this.range = range;\n        this.marker = marker;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nconst markerCodeActionTrigger = {\n    type: 1 /* CodeActionTriggerType.Invoke */,\n    filter: { include: CodeActionKind.QuickFix },\n    triggerAction: CodeActionTriggerSource.QuickFixHover\n};\nlet MarkerHoverParticipant = class MarkerHoverParticipant {\n    constructor(_editor, _markerDecorationsService, _openerService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._markerDecorationsService = _markerDecorationsService;\n        this._openerService = _openerService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.hoverOrdinal = 5;\n        this.recentMarkerCodeActionsInfo = undefined;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const marker = this._markerDecorationsService.getMarker(model.uri, d);\n            if (!marker) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkerHover(this, range, marker));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        if (!hoverParts.length) {\n            return Disposable.None;\n        }\n        const disposables = new DisposableStore();\n        hoverParts.forEach(msg => context.fragment.appendChild(this.renderMarkerHover(msg, disposables)));\n        const markerHoverForStatusbar = hoverParts.length === 1 ? hoverParts[0] : hoverParts.sort((a, b) => MarkerSeverity.compare(a.marker.severity, b.marker.severity))[0];\n        this.renderMarkerStatusbar(context, markerHoverForStatusbar, disposables);\n        return disposables;\n    }\n    renderMarkerHover(markerHover, disposables) {\n        const hoverElement = $('div.hover-row');\n        const markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\n        const { source, message, code, relatedInformation } = markerHover.marker;\n        this._editor.applyFontInfo(markerElement);\n        const messageElement = dom.append(markerElement, $('span'));\n        messageElement.style.whiteSpace = 'pre-wrap';\n        messageElement.innerText = message;\n        if (source || code) {\n            // Code has link\n            if (code && typeof code !== 'string') {\n                const sourceAndCodeElement = $('span');\n                if (source) {\n                    const sourceElement = dom.append(sourceAndCodeElement, $('span'));\n                    sourceElement.innerText = source;\n                }\n                const codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\n                codeLink.setAttribute('href', code.target.toString());\n                disposables.add(dom.addDisposableListener(codeLink, 'click', (e) => {\n                    this._openerService.open(code.target, { allowCommands: true });\n                    e.preventDefault();\n                    e.stopPropagation();\n                }));\n                const codeElement = dom.append(codeLink, $('span'));\n                codeElement.innerText = code.value;\n                const detailsElement = dom.append(markerElement, sourceAndCodeElement);\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n            }\n            else {\n                const detailsElement = dom.append(markerElement, $('span'));\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n                detailsElement.innerText = source && code ? `${source}(${code})` : source ? source : `(${code})`;\n            }\n        }\n        if (isNonEmptyArray(relatedInformation)) {\n            for (const { message, resource, startLineNumber, startColumn } of relatedInformation) {\n                const relatedInfoContainer = dom.append(markerElement, $('div'));\n                relatedInfoContainer.style.marginTop = '8px';\n                const a = dom.append(relatedInfoContainer, $('a'));\n                a.innerText = `${basename(resource)}(${startLineNumber}, ${startColumn}): `;\n                a.style.cursor = 'pointer';\n                disposables.add(dom.addDisposableListener(a, 'click', (e) => {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    if (this._openerService) {\n                        this._openerService.open(resource, {\n                            fromUserGesture: true,\n                            editorOptions: { selection: { startLineNumber, startColumn } }\n                        }).catch(onUnexpectedError);\n                    }\n                }));\n                const messageElement = dom.append(relatedInfoContainer, $('span'));\n                messageElement.innerText = message;\n                this._editor.applyFontInfo(messageElement);\n            }\n        }\n        return hoverElement;\n    }\n    renderMarkerStatusbar(context, markerHover, disposables) {\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\n            context.statusBar.addAction({\n                label: nls.localize('view problem', \"View Problem\"),\n                commandId: NextMarkerAction.ID,\n                run: () => {\n                    var _a;\n                    context.hide();\n                    (_a = MarkerController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.showAtMarker(markerHover.marker);\n                    this._editor.focus();\n                }\n            });\n        }\n        if (!this._editor.getOption(83 /* EditorOption.readOnly */)) {\n            const quickfixPlaceholderElement = context.statusBar.append($('div'));\n            if (this.recentMarkerCodeActionsInfo) {\n                if (IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker) === IMarkerData.makeKey(markerHover.marker)) {\n                    if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                        quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    }\n                }\n                else {\n                    this.recentMarkerCodeActionsInfo = undefined;\n                }\n            }\n            const updatePlaceholderDisposable = this.recentMarkerCodeActionsInfo && !this.recentMarkerCodeActionsInfo.hasCodeActions ? Disposable.None : disposables.add(disposableTimeout(() => quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\"), 200));\n            if (!quickfixPlaceholderElement.textContent) {\n                // Have some content in here to avoid flickering\n                quickfixPlaceholderElement.textContent = String.fromCharCode(0xA0); // &nbsp;\n            }\n            const codeActionsPromise = this.getCodeActions(markerHover.marker);\n            disposables.add(toDisposable(() => codeActionsPromise.cancel()));\n            codeActionsPromise.then(actions => {\n                updatePlaceholderDisposable.dispose();\n                this.recentMarkerCodeActionsInfo = { marker: markerHover.marker, hasCodeActions: actions.validActions.length > 0 };\n                if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                    actions.dispose();\n                    quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    return;\n                }\n                quickfixPlaceholderElement.style.display = 'none';\n                let showing = false;\n                disposables.add(toDisposable(() => {\n                    if (!showing) {\n                        actions.dispose();\n                    }\n                }));\n                context.statusBar.addAction({\n                    label: nls.localize('quick fixes', \"Quick Fix...\"),\n                    commandId: QuickFixAction.Id,\n                    run: (target) => {\n                        showing = true;\n                        const controller = QuickFixController.get(this._editor);\n                        const elementPosition = dom.getDomNodePagePosition(target);\n                        // Hide the hover pre-emptively, otherwise the editor can close the code actions\n                        // context menu as well when using keyboard navigation\n                        context.hide();\n                        controller === null || controller === void 0 ? void 0 : controller.showCodeActions(markerCodeActionTrigger, actions, {\n                            x: elementPosition.left + 6,\n                            y: elementPosition.top + elementPosition.height + 6,\n                            width: elementPosition.width,\n                            height: elementPosition.height\n                        });\n                    }\n                });\n            }, onUnexpectedError);\n        }\n    }\n    getCodeActions(marker) {\n        return createCancelablePromise(cancellationToken => {\n            return getCodeActions(this._languageFeaturesService.codeActionProvider, this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, Progress.None, cancellationToken);\n        });\n    }\n};\nMarkerHoverParticipant = __decorate([\n    __param(1, IMarkerDecorationsService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageFeaturesService)\n], MarkerHoverParticipant);\nexport { MarkerHoverParticipant };\nregisterThemingParticipant((theme, collector) => {\n    const linkFg = theme.getColor(textLinkForeground);\n    if (linkFg) {\n        collector.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${linkFg}; }`);\n    }\n    const activeLinkFg = theme.getColor(textLinkActiveForeground);\n    if (activeLinkFg) {\n        collector.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${activeLinkFg}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { ContentHoverWidget, ContentHoverController } from './contentHover.js';\nimport { MarginHoverWidget } from './marginHover.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { editorHoverBackground, editorHoverBorder, editorHoverForeground, editorHoverHighlight, editorHoverStatusBarBackground, textCodeBlockBackground, textLinkActiveForeground, textLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { HoverParticipantRegistry } from './hoverTypes.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { MarkerHoverParticipant } from './markerHoverParticipant.js';\nlet ModesHoverController = class ModesHoverController {\n    constructor(_editor, _instantiationService, _openerService, _languageService, _contextKeyService) {\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._openerService = _openerService;\n        this._languageService = _languageService;\n        this._toUnhook = new DisposableStore();\n        this._isMouseDown = false;\n        this._hoverClicked = false;\n        this._contentWidget = null;\n        this._glyphWidget = null;\n        this._hookEvents();\n        this._didChangeConfigurationHandler = this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(55 /* EditorOption.hover */)) {\n                this._unhookEvents();\n                this._hookEvents();\n            }\n        });\n    }\n    static get(editor) {\n        return editor.getContribution(ModesHoverController.ID);\n    }\n    _hookEvents() {\n        const hideWidgetsEventHandler = () => this._hideWidgets();\n        const hoverOpts = this._editor.getOption(55 /* EditorOption.hover */);\n        this._isHoverEnabled = hoverOpts.enabled;\n        this._isHoverSticky = hoverOpts.sticky;\n        if (this._isHoverEnabled) {\n            this._toUnhook.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n            this._toUnhook.add(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\n            this._toUnhook.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._toUnhook.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        else {\n            this._toUnhook.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._toUnhook.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        this._toUnhook.add(this._editor.onMouseLeave((e) => this._onEditorMouseLeave(e)));\n        this._toUnhook.add(this._editor.onDidChangeModel(hideWidgetsEventHandler));\n        this._toUnhook.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\n    }\n    _unhookEvents() {\n        this._toUnhook.clear();\n    }\n    _onEditorScrollChanged(e) {\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\n            this._hideWidgets();\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._isMouseDown = true;\n        const target = mouseEvent.target;\n        if (target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID) {\n            this._hoverClicked = true;\n            // mouse down on top of content hover widget\n            return;\n        }\n        if (target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */ && target.detail === MarginHoverWidget.ID) {\n            // mouse down on top of overlay hover widget\n            return;\n        }\n        if (target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */) {\n            this._hoverClicked = false;\n        }\n        this._hideWidgets();\n    }\n    _onEditorMouseUp(mouseEvent) {\n        this._isMouseDown = false;\n    }\n    _onEditorMouseLeave(mouseEvent) {\n        var _a;\n        const targetEm = (mouseEvent.event.browserEvent.relatedTarget);\n        if ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.containsNode(targetEm)) {\n            // when the mouse is inside hover widget\n            return;\n        }\n        this._hideWidgets();\n    }\n    _onEditorMouseMove(mouseEvent) {\n        var _a, _b, _c, _d, _e;\n        const target = mouseEvent.target;\n        if (this._isMouseDown && this._hoverClicked) {\n            return;\n        }\n        if (this._isHoverSticky && target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID) {\n            // mouse moved on top of content hover widget\n            return;\n        }\n        if (this._isHoverSticky && !((_b = (_a = mouseEvent.event.browserEvent.view) === null || _a === void 0 ? void 0 : _a.getSelection()) === null || _b === void 0 ? void 0 : _b.isCollapsed)) {\n            // selected text within content hover widget\n            return;\n        }\n        if (!this._isHoverSticky && target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID\n            && ((_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.isColorPickerVisible())) {\n            // though the hover is not sticky, the color picker needs to.\n            return;\n        }\n        if (this._isHoverSticky && target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */ && target.detail === MarginHoverWidget.ID) {\n            // mouse moved on top of overlay hover widget\n            return;\n        }\n        if (!this._isHoverEnabled) {\n            this._hideWidgets();\n            return;\n        }\n        const contentWidget = this._getOrCreateContentWidget();\n        if (contentWidget.maybeShowAt(mouseEvent)) {\n            (_d = this._glyphWidget) === null || _d === void 0 ? void 0 : _d.hide();\n            return;\n        }\n        if (target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ && target.position) {\n            (_e = this._contentWidget) === null || _e === void 0 ? void 0 : _e.hide();\n            if (!this._glyphWidget) {\n                this._glyphWidget = new MarginHoverWidget(this._editor, this._languageService, this._openerService);\n            }\n            this._glyphWidget.startShowingAt(target.position.lineNumber);\n            return;\n        }\n        this._hideWidgets();\n    }\n    _onKeyDown(e) {\n        if (e.keyCode !== 5 /* KeyCode.Ctrl */ && e.keyCode !== 6 /* KeyCode.Alt */ && e.keyCode !== 57 /* KeyCode.Meta */ && e.keyCode !== 4 /* KeyCode.Shift */) {\n            // Do not hide hover when a modifier key is pressed\n            this._hideWidgets();\n        }\n    }\n    _hideWidgets() {\n        var _a, _b, _c;\n        if ((this._isMouseDown && this._hoverClicked && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible()))) {\n            return;\n        }\n        this._hoverClicked = false;\n        (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.hide();\n        (_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.hide();\n    }\n    _getOrCreateContentWidget() {\n        if (!this._contentWidget) {\n            this._contentWidget = this._instantiationService.createInstance(ContentHoverController, this._editor);\n        }\n        return this._contentWidget;\n    }\n    isColorPickerVisible() {\n        var _a;\n        return ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible()) || false;\n    }\n    showContentHover(range, mode, focus) {\n        this._getOrCreateContentWidget().startShowingAtRange(range, mode, focus);\n    }\n    dispose() {\n        var _a, _b;\n        this._unhookEvents();\n        this._toUnhook.dispose();\n        this._didChangeConfigurationHandler.dispose();\n        (_a = this._glyphWidget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.dispose();\n    }\n};\nModesHoverController.ID = 'editor.contrib.hover';\nModesHoverController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageService),\n    __param(4, IContextKeyService)\n], ModesHoverController);\nexport { ModesHoverController };\nclass ShowHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showHover',\n            label: nls.localize({\n                key: 'showHover',\n                comment: [\n                    'Label for action that will trigger the showing of a hover in the editor.',\n                    'This allows for users to show the hover without using the mouse.'\n                ]\n            }, \"Show Hover\"),\n            alias: 'Show Hover',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const controller = ModesHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const focus = editor.getOption(2 /* EditorOption.accessibilitySupport */) === 2 /* AccessibilitySupport.Enabled */;\n        controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, focus);\n    }\n}\nclass ShowDefinitionPreviewHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showDefinitionPreviewHover',\n            label: nls.localize({\n                key: 'showDefinitionPreviewHover',\n                comment: [\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\n                    'This allows for users to show the definition preview hover without using the mouse.'\n                ]\n            }, \"Show Definition Preview Hover\"),\n            alias: 'Show Definition Preview Hover',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const controller = ModesHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        if (!position) {\n            return;\n        }\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const goto = GotoDefinitionAtPositionEditorContribution.get(editor);\n        if (!goto) {\n            return;\n        }\n        const promise = goto.startFindDefinitionFromCursor(position);\n        promise.then(() => {\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, true);\n        });\n    }\n}\nregisterEditorContribution(ModesHoverController.ID, ModesHoverController);\nregisterEditorAction(ShowHoverAction);\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\nHoverParticipantRegistry.register(MarkdownHoverParticipant);\nHoverParticipantRegistry.register(MarkerHoverParticipant);\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const editorHoverHighlightColor = theme.getColor(editorHoverHighlight);\n    if (editorHoverHighlightColor) {\n        collector.addRule(`.monaco-editor .hoverHighlight { background-color: ${editorHoverHighlightColor}; }`);\n    }\n    const hoverBackground = theme.getColor(editorHoverBackground);\n    if (hoverBackground) {\n        collector.addRule(`.monaco-editor .monaco-hover { background-color: ${hoverBackground}; }`);\n    }\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${hoverBorder}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n    const link = theme.getColor(textLinkForeground);\n    if (link) {\n        collector.addRule(`.monaco-editor .monaco-hover a { color: ${link}; }`);\n    }\n    const linkHover = theme.getColor(textLinkActiveForeground);\n    if (linkHover) {\n        collector.addRule(`.monaco-editor .monaco-hover a:hover { color: ${linkHover}; }`);\n    }\n    const hoverForeground = theme.getColor(editorHoverForeground);\n    if (hoverForeground) {\n        collector.addRule(`.monaco-editor .monaco-hover { color: ${hoverForeground}; }`);\n    }\n    const actionsBackground = theme.getColor(editorHoverStatusBarBackground);\n    if (actionsBackground) {\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${actionsBackground}; }`);\n    }\n    const codeBackground = theme.getColor(textCodeBlockBackground);\n    if (codeBackground) {\n        collector.addRule(`.monaco-editor .monaco-hover code { background-color: ${codeBackground}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ColorDecorationInjectedTextMarker } from './colorDetector.js';\nimport { ColorHoverParticipant } from './colorHoverParticipant.js';\nimport { ModesHoverController } from '../../hover/browser/hover.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nexport class ColorContribution extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._register(_editor.onMouseDown((e) => this.onMouseDown(e)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    onMouseDown(mouseEvent) {\n        const target = mouseEvent.target;\n        if (target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return;\n        }\n        if (!target.detail.injectedText) {\n            return;\n        }\n        if (target.detail.injectedText.options.attachedData !== ColorDecorationInjectedTextMarker) {\n            return;\n        }\n        if (!target.range) {\n            return;\n        }\n        const hoverController = this._editor.getContribution(ModesHoverController.ID);\n        if (!hoverController) {\n            return;\n        }\n        if (!hoverController.isColorPickerVisible()) {\n            const range = new Range(target.range.startLineNumber, target.range.startColumn + 1, target.range.endLineNumber, target.range.endColumn + 1);\n            hoverController.showContentHover(range, 1 /* HoverStartMode.Immediate */, false);\n        }\n    }\n}\nColorContribution.ID = 'editor.contrib.colorContribution'; // ms\nregisterEditorContribution(ColorContribution.ID, ColorContribution);\nHoverParticipantRegistry.register(ColorHoverParticipant);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport function createStringDataTransferItem(stringOrPromise) {\n    return {\n        asString: () => __awaiter(this, void 0, void 0, function* () { return stringOrPromise; }),\n        asFile: () => undefined,\n        value: typeof stringOrPromise === 'string' ? stringOrPromise : undefined,\n    };\n}\nexport function createFileDataTransferItem(fileName, uri, data) {\n    return {\n        asString: () => __awaiter(this, void 0, void 0, function* () { return ''; }),\n        asFile: () => ({ name: fileName, uri, data }),\n        value: undefined,\n    };\n}\nexport class VSDataTransfer {\n    constructor() {\n        this._entries = new Map();\n    }\n    get size() {\n        return this._entries.size;\n    }\n    has(mimeType) {\n        return this._entries.has(this.toKey(mimeType));\n    }\n    get(mimeType) {\n        var _a;\n        return (_a = this._entries.get(this.toKey(mimeType))) === null || _a === void 0 ? void 0 : _a[0];\n    }\n    append(mimeType, value) {\n        const existing = this._entries.get(mimeType);\n        if (existing) {\n            existing.push(value);\n        }\n        else {\n            this._entries.set(this.toKey(mimeType), [value]);\n        }\n    }\n    replace(mimeType, value) {\n        this._entries.set(this.toKey(mimeType), [value]);\n    }\n    delete(mimeType) {\n        this._entries.delete(this.toKey(mimeType));\n    }\n    *entries() {\n        for (const [mine, items] of this._entries.entries()) {\n            for (const item of items) {\n                yield [mine, item];\n            }\n        }\n    }\n    values() {\n        return Array.from(this._entries.values()).flat();\n    }\n    forEach(f) {\n        for (const [mime, item] of this.entries()) {\n            f(item, mime);\n        }\n    }\n    toKey(mimeType) {\n        return mimeType.toLowerCase();\n    }\n}\n","export const generateUuid = (function () {\n    // use `randomUUID` if possible\n    if (typeof crypto === 'object' && typeof crypto.randomUUID === 'function') {\n        return crypto.randomUUID.bind(crypto);\n    }\n    // use `randomValues` if possible\n    let getRandomValues;\n    if (typeof crypto === 'object' && typeof crypto.getRandomValues === 'function') {\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    else {\n        getRandomValues = function (bucket) {\n            for (let i = 0; i < bucket.length; i++) {\n                bucket[i] = Math.floor(Math.random() * 256);\n            }\n            return bucket;\n        };\n    }\n    // prep-work\n    const _data = new Uint8Array(16);\n    const _hex = [];\n    for (let i = 0; i < 256; i++) {\n        _hex.push(i.toString(16).padStart(2, '0'));\n    }\n    return function generateUuid() {\n        // get data\n        getRandomValues(_data);\n        // set version bits\n        _data[6] = (_data[6] & 0x0f) | 0x40;\n        _data[8] = (_data[8] & 0x3f) | 0x80;\n        // print as string\n        let i = 0;\n        let result = '';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        return result;\n    };\n})();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DataTransfers } from '../../../base/browser/dnd.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { extractSelection } from '../../opener/common/opener.js';\nimport { Registry } from '../../registry/common/platform.js';\n//#region Editor / Resources DND\nexport const CodeDataTransfers = {\n    EDITORS: 'CodeEditors',\n    FILES: 'CodeFiles'\n};\nexport function extractEditorsDropData(e) {\n    var _a;\n    const editors = [];\n    if (e.dataTransfer && e.dataTransfer.types.length > 0) {\n        // Data Transfer: Code Editors\n        const rawEditorsData = e.dataTransfer.getData(CodeDataTransfers.EDITORS);\n        if (rawEditorsData) {\n            try {\n                editors.push(...parse(rawEditorsData));\n            }\n            catch (error) {\n                // Invalid transfer\n            }\n        }\n        // Data Transfer: Resources\n        else {\n            try {\n                const rawResourcesData = e.dataTransfer.getData(DataTransfers.RESOURCES);\n                editors.push(...createDraggedEditorInputFromRawResourcesData(rawResourcesData));\n            }\n            catch (error) {\n                // Invalid transfer\n            }\n        }\n        // Check for native file transfer\n        if ((_a = e.dataTransfer) === null || _a === void 0 ? void 0 : _a.files) {\n            for (let i = 0; i < e.dataTransfer.files.length; i++) {\n                const file = e.dataTransfer.files[i];\n                if (file && file.path /* Electron only */) {\n                    try {\n                        editors.push({ resource: URI.file(file.path), isExternal: true, allowWorkspaceOpen: true });\n                    }\n                    catch (error) {\n                        // Invalid URI\n                    }\n                }\n            }\n        }\n        // Check for CodeFiles transfer\n        const rawCodeFiles = e.dataTransfer.getData(CodeDataTransfers.FILES);\n        if (rawCodeFiles) {\n            try {\n                const codeFiles = JSON.parse(rawCodeFiles);\n                for (const codeFile of codeFiles) {\n                    editors.push({ resource: URI.file(codeFile), isExternal: true, allowWorkspaceOpen: true });\n                }\n            }\n            catch (error) {\n                // Invalid transfer\n            }\n        }\n        // Workbench contributions\n        const contributions = Registry.as(Extensions.DragAndDropContribution).getAll();\n        for (const contribution of contributions) {\n            const data = e.dataTransfer.getData(contribution.dataFormatKey);\n            if (data) {\n                try {\n                    editors.push(...contribution.getEditorInputs(data));\n                }\n                catch (error) {\n                    // Invalid transfer\n                }\n            }\n        }\n    }\n    return editors;\n}\nexport function createDraggedEditorInputFromRawResourcesData(rawResourcesData) {\n    const editors = [];\n    if (rawResourcesData) {\n        const resourcesRaw = JSON.parse(rawResourcesData);\n        for (const resourceRaw of resourcesRaw) {\n            if (resourceRaw.indexOf(':') > 0) { // mitigate https://github.com/microsoft/vscode/issues/124946\n                const { selection, uri } = extractSelection(URI.parse(resourceRaw));\n                editors.push({ resource: uri, options: { selection } });\n            }\n        }\n    }\n    return editors;\n}\nclass DragAndDropContributionRegistry {\n    constructor() {\n        this._contributions = new Map();\n    }\n    getAll() {\n        return this._contributions.values();\n    }\n}\nexport const Extensions = {\n    DragAndDropContribution: 'workbench.contributions.dragAndDrop'\n};\nRegistry.add(Extensions.DragAndDropContribution, new DragAndDropContributionRegistry());\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { DataTransfers } from '../../base/browser/dnd.js';\nimport { distinct } from '../../base/common/arrays.js';\nimport { createFileDataTransferItem, createStringDataTransferItem, VSDataTransfer } from '../../base/common/dataTransfer.js';\nimport { Mimes } from '../../base/common/mime.js';\nimport { URI } from '../../base/common/uri.js';\nimport { CodeDataTransfers, extractEditorsDropData } from '../../platform/dnd/browser/dnd.js';\nexport function toVSDataTransfer(dataTransfer) {\n    const vsDataTransfer = new VSDataTransfer();\n    for (const item of dataTransfer.items) {\n        const type = item.type;\n        if (item.kind === 'string') {\n            const asStringValue = new Promise(resolve => item.getAsString(resolve));\n            vsDataTransfer.append(type, createStringDataTransferItem(asStringValue));\n        }\n        else if (item.kind === 'file') {\n            const file = item.getAsFile();\n            if (file) {\n                vsDataTransfer.append(type, createFileDataTransferItemFromFile(file));\n            }\n        }\n    }\n    return vsDataTransfer;\n}\nexport function createFileDataTransferItemFromFile(file) {\n    const uri = file.path ? URI.parse(file.path) : undefined;\n    return createFileDataTransferItem(file.name, uri, () => __awaiter(this, void 0, void 0, function* () {\n        return new Uint8Array(yield file.arrayBuffer());\n    }));\n}\nconst INTERNAL_DND_MIME_TYPES = Object.freeze([\n    CodeDataTransfers.EDITORS,\n    CodeDataTransfers.FILES,\n    DataTransfers.RESOURCES,\n]);\nexport function addExternalEditorsDropData(dataTransfer, dragEvent, overwriteUriList = false) {\n    var _a;\n    if (dragEvent.dataTransfer && (overwriteUriList || !dataTransfer.has(Mimes.uriList))) {\n        const editorData = extractEditorsDropData(dragEvent)\n            .filter(input => input.resource)\n            .map(input => input.resource.toString());\n        // Also add in the files\n        for (const item of (_a = dragEvent.dataTransfer) === null || _a === void 0 ? void 0 : _a.items) {\n            const file = item.getAsFile();\n            if (file) {\n                editorData.push(file.path ? URI.file(file.path).toString() : file.name);\n            }\n        }\n        if (editorData.length) {\n            dataTransfer.replace(Mimes.uriList, createStringDataTransferItem(UriList.create(editorData)));\n        }\n    }\n    for (const internal of INTERNAL_DND_MIME_TYPES) {\n        dataTransfer.delete(internal);\n    }\n}\nexport const UriList = Object.freeze({\n    // http://amundsen.com/hypermedia/urilist/\n    create: (entries) => {\n        return distinct(entries.map(x => x.toString())).join('\\r\\n');\n    },\n    parse: (str) => {\n        return str.split('\\r\\n').filter(value => !value.startsWith('#'));\n    }\n});\n","import { hasDriveLetter } from './extpath.js';\nimport { isWindows } from './platform.js';\nexport function normalizeDriveLetter(path, isWindowsOS = isWindows) {\n    if (hasDriveLetter(path, isWindowsOS)) {\n        return path.charAt(0).toUpperCase() + path.slice(1);\n    }\n    return path;\n}\nlet normalizedUserHomeCached = Object.create(null);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { commonPrefixLength, getLeadingWhitespace, isFalsyOrWhitespace, splitLines } from '../../../../base/common/strings.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Text } from './snippetParser.js';\nimport * as nls from '../../../../nls.js';\nimport { WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nexport const KnownSnippetVariableNames = Object.freeze({\n    'CURRENT_YEAR': true,\n    'CURRENT_YEAR_SHORT': true,\n    'CURRENT_MONTH': true,\n    'CURRENT_DATE': true,\n    'CURRENT_HOUR': true,\n    'CURRENT_MINUTE': true,\n    'CURRENT_SECOND': true,\n    'CURRENT_DAY_NAME': true,\n    'CURRENT_DAY_NAME_SHORT': true,\n    'CURRENT_MONTH_NAME': true,\n    'CURRENT_MONTH_NAME_SHORT': true,\n    'CURRENT_SECONDS_UNIX': true,\n    'SELECTION': true,\n    'CLIPBOARD': true,\n    'TM_SELECTED_TEXT': true,\n    'TM_CURRENT_LINE': true,\n    'TM_CURRENT_WORD': true,\n    'TM_LINE_INDEX': true,\n    'TM_LINE_NUMBER': true,\n    'TM_FILENAME': true,\n    'TM_FILENAME_BASE': true,\n    'TM_DIRECTORY': true,\n    'TM_FILEPATH': true,\n    'CURSOR_INDEX': true,\n    'CURSOR_NUMBER': true,\n    'RELATIVE_FILEPATH': true,\n    'BLOCK_COMMENT_START': true,\n    'BLOCK_COMMENT_END': true,\n    'LINE_COMMENT': true,\n    'WORKSPACE_NAME': true,\n    'WORKSPACE_FOLDER': true,\n    'RANDOM': true,\n    'RANDOM_HEX': true,\n    'UUID': true\n});\nexport class CompositeSnippetVariableResolver {\n    constructor(_delegates) {\n        this._delegates = _delegates;\n        //\n    }\n    resolve(variable) {\n        for (const delegate of this._delegates) {\n            const value = delegate.resolve(variable);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n        return undefined;\n    }\n}\nexport class SelectionBasedVariableResolver {\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\n        this._model = _model;\n        this._selection = _selection;\n        this._selectionIdx = _selectionIdx;\n        this._overtypingCapturer = _overtypingCapturer;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\n            let value = this._model.getValueInRange(this._selection) || undefined;\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\n            // If there was no selected text, try to get last overtyped text\n            if (!value && this._overtypingCapturer) {\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\n                if (info) {\n                    value = info.value;\n                    isMultiline = info.multiline;\n                }\n            }\n            if (value && isMultiline && variable.snippet) {\n                // Selection is a multiline string which we indentation we now\n                // need to adjust. We compare the indentation of this variable\n                // with the indentation at the editor position and add potential\n                // extra indentation to the value\n                const line = this._model.getLineContent(this._selection.startLineNumber);\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\n                let varLeadingWhitespace = lineLeadingWhitespace;\n                variable.snippet.walk(marker => {\n                    if (marker === variable) {\n                        return false;\n                    }\n                    if (marker instanceof Text) {\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\n                    }\n                    return true;\n                });\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\n            }\n            return value;\n        }\n        else if (name === 'TM_CURRENT_LINE') {\n            return this._model.getLineContent(this._selection.positionLineNumber);\n        }\n        else if (name === 'TM_CURRENT_WORD') {\n            const info = this._model.getWordAtPosition({\n                lineNumber: this._selection.positionLineNumber,\n                column: this._selection.positionColumn\n            });\n            return info && info.word || undefined;\n        }\n        else if (name === 'TM_LINE_INDEX') {\n            return String(this._selection.positionLineNumber - 1);\n        }\n        else if (name === 'TM_LINE_NUMBER') {\n            return String(this._selection.positionLineNumber);\n        }\n        else if (name === 'CURSOR_INDEX') {\n            return String(this._selectionIdx);\n        }\n        else if (name === 'CURSOR_NUMBER') {\n            return String(this._selectionIdx + 1);\n        }\n        return undefined;\n    }\n}\nexport class ModelBasedVariableResolver {\n    constructor(_labelService, _model) {\n        this._labelService = _labelService;\n        this._model = _model;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'TM_FILENAME') {\n            return path.basename(this._model.uri.fsPath);\n        }\n        else if (name === 'TM_FILENAME_BASE') {\n            const name = path.basename(this._model.uri.fsPath);\n            const idx = name.lastIndexOf('.');\n            if (idx <= 0) {\n                return name;\n            }\n            else {\n                return name.slice(0, idx);\n            }\n        }\n        else if (name === 'TM_DIRECTORY') {\n            if (path.dirname(this._model.uri.fsPath) === '.') {\n                return '';\n            }\n            return this._labelService.getUriLabel(dirname(this._model.uri));\n        }\n        else if (name === 'TM_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri);\n        }\n        else if (name === 'RELATIVE_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\n        }\n        return undefined;\n    }\n}\nexport class ClipboardBasedVariableResolver {\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\n        this._readClipboardText = _readClipboardText;\n        this._selectionIdx = _selectionIdx;\n        this._selectionCount = _selectionCount;\n        this._spread = _spread;\n        //\n    }\n    resolve(variable) {\n        if (variable.name !== 'CLIPBOARD') {\n            return undefined;\n        }\n        const clipboardText = this._readClipboardText();\n        if (!clipboardText) {\n            return undefined;\n        }\n        // `spread` is assigning each cursor a line of the clipboard\n        // text whenever there the line count equals the cursor count\n        // and when enabled\n        if (this._spread) {\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\n            if (lines.length === this._selectionCount) {\n                return lines[this._selectionIdx];\n            }\n        }\n        return clipboardText;\n    }\n}\nlet CommentBasedVariableResolver = class CommentBasedVariableResolver {\n    constructor(_model, _selection, _languageConfigurationService) {\n        this._model = _model;\n        this._selection = _selection;\n        this._languageConfigurationService = _languageConfigurationService;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\n        const config = this._languageConfigurationService.getLanguageConfiguration(langId).comments;\n        if (!config) {\n            return undefined;\n        }\n        if (name === 'LINE_COMMENT') {\n            return config.lineCommentToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_START') {\n            return config.blockCommentStartToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_END') {\n            return config.blockCommentEndToken || undefined;\n        }\n        return undefined;\n    }\n};\nCommentBasedVariableResolver = __decorate([\n    __param(2, ILanguageConfigurationService)\n], CommentBasedVariableResolver);\nexport { CommentBasedVariableResolver };\nexport class TimeBasedVariableResolver {\n    constructor() {\n        this._date = new Date();\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'CURRENT_YEAR') {\n            return String(this._date.getFullYear());\n        }\n        else if (name === 'CURRENT_YEAR_SHORT') {\n            return String(this._date.getFullYear()).slice(-2);\n        }\n        else if (name === 'CURRENT_MONTH') {\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DATE') {\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_HOUR') {\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_MINUTE') {\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_SECOND') {\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DAY_NAME') {\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME') {\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_SECONDS_UNIX') {\n            return String(Math.floor(this._date.getTime() / 1000));\n        }\n        return undefined;\n    }\n}\nTimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\nTimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\nTimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\nTimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\nexport class WorkspaceBasedVariableResolver {\n    constructor(_workspaceService) {\n        this._workspaceService = _workspaceService;\n        //\n    }\n    resolve(variable) {\n        if (!this._workspaceService) {\n            return undefined;\n        }\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\n        if (!workspaceIdentifier) {\n            return undefined;\n        }\n        if (variable.name === 'WORKSPACE_NAME') {\n            return this._resolveWorkspaceName(workspaceIdentifier);\n        }\n        else if (variable.name === 'WORKSPACE_FOLDER') {\n            return this._resoveWorkspacePath(workspaceIdentifier);\n        }\n        return undefined;\n    }\n    _resolveWorkspaceName(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return path.basename(workspaceIdentifier.uri.path);\n        }\n        let filename = path.basename(workspaceIdentifier.configPath.path);\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n        }\n        return filename;\n    }\n    _resoveWorkspacePath(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\n        }\n        const filename = path.basename(workspaceIdentifier.configPath.path);\n        let folderpath = workspaceIdentifier.configPath.fsPath;\n        if (folderpath.endsWith(filename)) {\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\n        }\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\n    }\n}\nexport class RandomBasedVariableResolver {\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'RANDOM') {\n            return Math.random().toString().slice(-6);\n        }\n        else if (name === 'RANDOM_HEX') {\n            return Math.random().toString(16).slice(-6);\n        }\n        else if (name === 'UUID') {\n            return generateUuid();\n        }\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport './snippetSession.css';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { Choice, Placeholder, SnippetParser, Text, TextmateSnippet } from './snippetParser.js';\nimport { ClipboardBasedVariableResolver, CommentBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, RandomBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, WorkspaceBasedVariableResolver } from './snippetVariables.js';\nexport class OneSnippet {\n    constructor(_editor, _snippet, _snippetLineLeadingWhitespace) {\n        this._editor = _editor;\n        this._snippet = _snippet;\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\n        this._offset = -1;\n        this._nestingLevel = 1;\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\n        this._placeholderGroupsIdx = -1;\n    }\n    initialize(textChange) {\n        this._offset = textChange.newPosition;\n    }\n    dispose() {\n        if (this._placeholderDecorations) {\n            this._editor.removeDecorations([...this._placeholderDecorations.values()]);\n        }\n        this._placeholderGroups.length = 0;\n    }\n    _initDecorations() {\n        if (this._offset === -1) {\n            throw new Error(`Snippet not initialized!`);\n        }\n        if (this._placeholderDecorations) {\n            // already initialized\n            return;\n        }\n        this._placeholderDecorations = new Map();\n        const model = this._editor.getModel();\n        this._editor.changeDecorations(accessor => {\n            // create a decoration for each placeholder\n            for (const placeholder of this._snippet.placeholders) {\n                const placeholderOffset = this._snippet.offset(placeholder);\n                const placeholderLen = this._snippet.fullLen(placeholder);\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\n                const handle = accessor.addDecoration(range, options);\n                this._placeholderDecorations.set(placeholder, handle);\n            }\n        });\n    }\n    move(fwd) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this._initDecorations();\n        // Transform placeholder text if necessary\n        if (this._placeholderGroupsIdx >= 0) {\n            const operations = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                // Check if the placeholder has a transformation\n                if (placeholder.transform) {\n                    const id = this._placeholderDecorations.get(placeholder);\n                    const range = this._editor.getModel().getDecorationRange(id);\n                    const currentValue = this._editor.getModel().getValueInRange(range);\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\n                    // fix indentation for transformed lines\n                    for (let i = 1; i < transformedValueLines.length; i++) {\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\n                    }\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\n                }\n            }\n            if (operations.length > 0) {\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\n            }\n        }\n        let couldSkipThisPlaceholder = false;\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\n            this._placeholderGroupsIdx += 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\n            this._placeholderGroupsIdx -= 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else {\n            // the selection of the current placeholder might\n            // not acurate any more -> simply restore it\n        }\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\n            const activePlaceholders = new Set();\n            // change stickiness to always grow when typing at its edges\n            // because these decorations represent the currently active\n            // tabstop.\n            // Special case #1: reaching the final tabstop\n            // Special case #2: placeholders enclosing active placeholders\n            const selections = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\n                // consider to skip this placeholder index when the decoration\n                // range is empty but when the placeholder wasn't. that's a strong\n                // hint that the placeholder has been deleted. (all placeholder must match this)\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                activePlaceholders.add(placeholder);\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                    activePlaceholders.add(enclosingPlaceholder);\n                }\n            }\n            // change stickness to never grow when typing at its edges\n            // so that in-active tabstops never grow\n            for (const [placeholder, id] of this._placeholderDecorations) {\n                if (!activePlaceholders.has(placeholder)) {\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\n                }\n            }\n            return selections;\n        });\n        return !couldSkipThisPlaceholder ? newSelections !== null && newSelections !== void 0 ? newSelections : [] : this.move(fwd);\n    }\n    _hasPlaceholderBeenCollapsed(placeholder) {\n        // A placeholder is empty when it wasn't empty when authored but\n        // when its tracking decoration is empty. This also applies to all\n        // potential parent placeholders\n        let marker = placeholder;\n        while (marker) {\n            if (marker instanceof Placeholder) {\n                const id = this._placeholderDecorations.get(marker);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (range.isEmpty() && marker.toString().length > 0) {\n                    return true;\n                }\n            }\n            marker = marker.parent;\n        }\n        return false;\n    }\n    get isAtFirstPlaceholder() {\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\n    }\n    get isAtLastPlaceholder() {\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\n    }\n    get hasPlaceholder() {\n        return this._snippet.placeholders.length > 0;\n    }\n    get isTrivialSnippet() {\n        return this._snippet.placeholders.length === 0\n            || (this._snippet.placeholders.length === 1 && this._snippet.placeholders[0].isFinalTabstop);\n    }\n    computePossibleSelections() {\n        const result = new Map();\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\n            let ranges;\n            for (const placeholder of placeholdersWithEqualIndex) {\n                if (placeholder.isFinalTabstop) {\n                    // ignore those\n                    break;\n                }\n                if (!ranges) {\n                    ranges = [];\n                    result.set(placeholder.index, ranges);\n                }\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (!range) {\n                    // one of the placeholder lost its decoration and\n                    // therefore we bail out and pretend the placeholder\n                    // (with its mirrors) doesn't exist anymore.\n                    result.delete(placeholder.index);\n                    break;\n                }\n                ranges.push(range);\n            }\n        }\n        return result;\n    }\n    get activeChoice() {\n        if (!this._placeholderDecorations) {\n            return undefined;\n        }\n        const placeholder = this._placeholderGroups[this._placeholderGroupsIdx][0];\n        if (!(placeholder === null || placeholder === void 0 ? void 0 : placeholder.choice)) {\n            return undefined;\n        }\n        const id = this._placeholderDecorations.get(placeholder);\n        if (!id) {\n            return undefined;\n        }\n        const range = this._editor.getModel().getDecorationRange(id);\n        if (!range) {\n            return undefined;\n        }\n        return { range, choice: placeholder.choice };\n    }\n    get hasChoice() {\n        let result = false;\n        this._snippet.walk(marker => {\n            result = marker instanceof Choice;\n            return !result;\n        });\n        return result;\n    }\n    merge(others) {\n        const model = this._editor.getModel();\n        this._nestingLevel *= 10;\n        this._editor.changeDecorations(accessor => {\n            // For each active placeholder take one snippet and merge it\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\n            // everything is sorted by editor selection we can simply remove\n            // elements from the beginning of the array\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const nested = others.shift();\n                console.assert(nested._offset !== -1);\n                console.assert(!nested._placeholderDecorations);\n                // Massage placeholder-indicies of the nested snippet to be\n                // sorted right after the insertion point. This ensures we move\n                // through the placeholders in the correct order\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\n                    if (nestedPlaceholder.isFinalTabstop) {\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\n                    }\n                    else {\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\n                    }\n                }\n                this._snippet.replace(placeholder, nested._snippet.children);\n                // Remove the placeholder at which position are inserting\n                // the snippet and also remove its decoration.\n                const id = this._placeholderDecorations.get(placeholder);\n                accessor.removeDecoration(id);\n                this._placeholderDecorations.delete(placeholder);\n                // For each *new* placeholder we create decoration to monitor\n                // how and if it grows/shrinks.\n                for (const placeholder of nested._snippet.placeholders) {\n                    const placeholderOffset = nested._snippet.offset(placeholder);\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\n                    this._placeholderDecorations.set(placeholder, handle);\n                }\n            }\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\n        });\n    }\n}\nOneSnippet._decor = {\n    active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n    inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n};\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetSession = class SnippetSession {\n    constructor(_editor, _template, _options = _defaultOptions, _languageConfigurationService) {\n        this._editor = _editor;\n        this._template = _template;\n        this._options = _options;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._templateMerges = [];\n        this._snippets = [];\n    }\n    static adjustWhitespace(model, position, snippet, adjustIndentation, adjustNewlines) {\n        const line = model.getLineContent(position.lineNumber);\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\n        // the snippet as inserted\n        let snippetTextString;\n        snippet.walk(marker => {\n            // all text elements that are not inside choice\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\n                return true;\n            }\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\n            if (adjustIndentation) {\n                // adjust indentation of snippet test\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\n                // -all N+1 lines get extra-indented and normalized\n                // -the text start get extra-indented and normalized when following a linebreak\n                const offset = snippet.offset(marker);\n                if (offset === 0) {\n                    // snippet start\n                    lines[0] = model.normalizeIndentation(lines[0]);\n                }\n                else {\n                    // check if text start is after a linebreak\n                    snippetTextString = snippetTextString !== null && snippetTextString !== void 0 ? snippetTextString : snippet.toString();\n                    const prevChar = snippetTextString.charCodeAt(offset - 1);\n                    if (prevChar === 10 /* CharCode.LineFeed */ || prevChar === 13 /* CharCode.CarriageReturn */) {\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\n                    }\n                }\n                for (let i = 1; i < lines.length; i++) {\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\n                }\n            }\n            const newValue = lines.join(model.getEOL());\n            if (newValue !== marker.value) {\n                marker.parent.replace(marker, [new Text(newValue)]);\n                snippetTextString = undefined;\n            }\n            return true;\n        });\n        return lineLeadingWhitespace;\n    }\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\n            // overwrite[Before|After] is compute using the position, not the whole\n            // selection. therefore we adjust the selection around that position\n            const { positionLineNumber, positionColumn } = selection;\n            const positionColumnBefore = positionColumn - overwriteBefore;\n            const positionColumnAfter = positionColumn + overwriteAfter;\n            const range = model.validateRange({\n                startLineNumber: positionLineNumber,\n                startColumn: positionColumnBefore,\n                endLineNumber: positionLineNumber,\n                endColumn: positionColumnAfter\n            });\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\n        }\n        return selection;\n    }\n    static createEditsAndSnippetsFromSelections(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        const edits = [];\n        const snippets = [];\n        if (!editor.hasModel()) {\n            return { edits, snippets };\n        }\n        const model = editor.getModel();\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService));\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model));\n        const readClipboardText = () => clipboardText;\n        // know what text the overwrite[Before|After] extensions\n        // of the primary curser have selected because only when\n        // secondary selections extend to the same text we can grow them\n        const firstBeforeText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\n        const firstAfterText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\n        // remember the first non-whitespace column to decide if\n        // `keepWhitespace` should be overruled for secondary selections\n        const firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\n        // sort selections by their start position but remeber\n        // the original index. that allows you to create correct\n        // offset-based selection logic without changing the\n        // primary selection\n        const indexedSelections = editor.getSelections()\n            .map((selection, idx) => ({ selection, idx }))\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        for (const { selection, idx } of indexedSelections) {\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\n            // compare if this matches the extensions of the primary selection\n            let extensionBefore = SnippetSession.adjustSelection(model, selection, overwriteBefore, 0);\n            let extensionAfter = SnippetSession.adjustSelection(model, selection, 0, overwriteAfter);\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\n                extensionBefore = selection;\n            }\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\n                extensionAfter = selection;\n            }\n            // merge the before and after selection into one\n            const snippetSelection = selection\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\n            // adjust the template string to match the indentation and\n            // whitespace rules of this insert location (can be different for each cursor)\n            // happens when being asked for (default) or when this is a secondary\n            // cursor and the leading whitespace is different\n            const start = snippetSelection.getStartPosition();\n            const snippetLineLeadingWhitespace = SnippetSession.adjustWhitespace(model, start, snippet, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), true);\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\n                modelBasedVariableResolver,\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(73 /* EditorOption.multiCursorPaste */) === 'spread'),\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\n                new CommentBasedVariableResolver(model, selection, languageConfigurationService),\n                new TimeBasedVariableResolver,\n                new WorkspaceBasedVariableResolver(workspaceService),\n                new RandomBasedVariableResolver,\n            ]));\n            // store snippets with the index of their originating selection.\n            // that ensures the primiary cursor stays primary despite not being\n            // the one with lowest start position\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edits[idx]._isTracked = true;\n            snippets[idx] = new OneSnippet(editor, snippet, snippetLineLeadingWhitespace);\n        }\n        return { edits, snippets };\n    }\n    static createEditsAndSnippetsFromEdits(editor, snippetEdits, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        if (!editor.hasModel() || snippetEdits.length === 0) {\n            return { edits: [], snippets: [] };\n        }\n        const edits = [];\n        const model = editor.getModel();\n        const parser = new SnippetParser();\n        const snippet = new TextmateSnippet();\n        // snippet variables resolver\n        const resolver = new CompositeSnippetVariableResolver([\n            editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model)),\n            new ClipboardBasedVariableResolver(() => clipboardText, 0, editor.getSelections().length, editor.getOption(73 /* EditorOption.multiCursorPaste */) === 'spread'),\n            new SelectionBasedVariableResolver(model, editor.getSelection(), 0, overtypingCapturer),\n            new CommentBasedVariableResolver(model, editor.getSelection(), languageConfigurationService),\n            new TimeBasedVariableResolver,\n            new WorkspaceBasedVariableResolver(editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService))),\n            new RandomBasedVariableResolver,\n        ]);\n        //\n        snippetEdits = snippetEdits.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let offset = 0;\n        for (let i = 0; i < snippetEdits.length; i++) {\n            const { range, template } = snippetEdits[i];\n            // gaps between snippet edits are appended as text nodes. this\n            // ensures placeholder-offsets are later correct\n            if (i > 0) {\n                const lastRange = snippetEdits[i - 1].range;\n                const textRange = Range.fromPositions(lastRange.getEndPosition(), range.getStartPosition());\n                const textNode = new Text(model.getValueInRange(textRange));\n                snippet.appendChild(textNode);\n                offset += textNode.value.length;\n            }\n            parser.parseFragment(template, snippet);\n            snippet.resolveVariables(resolver);\n            const snippetText = snippet.toString();\n            const snippetFragmentText = snippetText.slice(offset);\n            offset = snippetText.length;\n            // make edit\n            const edit = EditOperation.replace(range, snippetFragmentText);\n            edit.identifier = { major: i, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edit._isTracked = true;\n            edits.push(edit);\n        }\n        //\n        parser.ensureFinalTabstop(snippet, enforceFinalTabstop, true);\n        return {\n            edits,\n            snippets: [new OneSnippet(editor, snippet, '')]\n        };\n    }\n    dispose() {\n        dispose(this._snippets);\n    }\n    _logInfo() {\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\n    }\n    insert() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // make insert edit and start with first selections\n        const { edits, snippets } = typeof this._template === 'string'\n            ? SnippetSession.createEditsAndSnippetsFromSelections(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService)\n            : SnippetSession.createEditsAndSnippetsFromEdits(this._editor, this._template, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService);\n        this._snippets = snippets;\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            if (this._snippets[0].hasPlaceholder) {\n                return this._move(true);\n            }\n            else {\n                return undoEdits\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n        this._editor.revealRange(this._editor.getSelections()[0]);\n    }\n    merge(template, options = _defaultOptions) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\n        const { edits, snippets } = SnippetSession.createEditsAndSnippetsFromSelections(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer, this._languageConfigurationService);\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            // Trivial snippets have no placeholder or are just the final placeholder. That means they\n            // are just text insertions and we don't need to merge the nested snippet into the existing\n            // snippet\n            const isTrivialSnippet = snippets[0].isTrivialSnippet;\n            if (!isTrivialSnippet) {\n                for (const snippet of this._snippets) {\n                    snippet.merge(snippets);\n                }\n                console.assert(snippets.length === 0);\n            }\n            if (this._snippets[0].hasPlaceholder && !isTrivialSnippet) {\n                return this._move(undefined);\n            }\n            else {\n                return undoEdits.map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n    }\n    next() {\n        const newSelections = this._move(true);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    prev() {\n        const newSelections = this._move(false);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    _move(fwd) {\n        const selections = [];\n        for (const snippet of this._snippets) {\n            const oneSelection = snippet.move(fwd);\n            selections.push(...oneSelection);\n        }\n        return selections;\n    }\n    get isAtFirstPlaceholder() {\n        return this._snippets[0].isAtFirstPlaceholder;\n    }\n    get isAtLastPlaceholder() {\n        return this._snippets[0].isAtLastPlaceholder;\n    }\n    get hasPlaceholder() {\n        return this._snippets[0].hasPlaceholder;\n    }\n    get hasChoice() {\n        return this._snippets[0].hasChoice;\n    }\n    get activeChoice() {\n        return this._snippets[0].activeChoice;\n    }\n    isSelectionWithinPlaceholders() {\n        if (!this.hasPlaceholder) {\n            return false;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length < this._snippets.length) {\n            // this means we started snippet mode with N\n            // selections and have M (N > M) selections.\n            // So one snippet is without selection -> cancel\n            return false;\n        }\n        const allPossibleSelections = new Map();\n        for (const snippet of this._snippets) {\n            const possibleSelections = snippet.computePossibleSelections();\n            // for the first snippet find the placeholder (and its ranges)\n            // that contain at least one selection. for all remaining snippets\n            // the same placeholder (and their ranges) must be used.\n            if (allPossibleSelections.size === 0) {\n                for (const [index, ranges] of possibleSelections) {\n                    ranges.sort(Range.compareRangesUsingStarts);\n                    for (const selection of selections) {\n                        if (ranges[0].containsRange(selection)) {\n                            allPossibleSelections.set(index, []);\n                            break;\n                        }\n                    }\n                }\n            }\n            if (allPossibleSelections.size === 0) {\n                // return false if we couldn't associate a selection to\n                // this (the first) snippet\n                return false;\n            }\n            // add selections from 'this' snippet so that we know all\n            // selections for this placeholder\n            allPossibleSelections.forEach((array, index) => {\n                array.push(...possibleSelections.get(index));\n            });\n        }\n        // sort selections (and later placeholder-ranges). then walk both\n        // arrays and make sure the placeholder-ranges contain the corresponding\n        // selection\n        selections.sort(Range.compareRangesUsingStarts);\n        for (const [index, ranges] of allPossibleSelections) {\n            if (ranges.length !== selections.length) {\n                allPossibleSelections.delete(index);\n                continue;\n            }\n            ranges.sort(Range.compareRangesUsingStarts);\n            for (let i = 0; i < ranges.length; i++) {\n                if (!ranges[i].containsRange(selections[i])) {\n                    allPossibleSelections.delete(index);\n                    continue;\n                }\n            }\n        }\n        // from all possible selections we have deleted those\n        // that don't match with the current selection. if we don't\n        // have any left, we don't have a selection anymore\n        return allPossibleSelections.size > 0;\n    }\n};\nSnippetSession = __decorate([\n    __param(3, ILanguageConfigurationService)\n], SnippetSession);\nexport { SnippetSession };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { showSimpleSuggestions } from '../../suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { SnippetSession } from './snippetSession.js';\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    undoStopBefore: true,\n    undoStopAfter: true,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetController2 = class SnippetController2 {\n    constructor(_editor, _logService, _languageFeaturesService, contextKeyService, _languageConfigurationService) {\n        this._editor = _editor;\n        this._logService = _logService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._snippetListener = new DisposableStore();\n        this._modelVersionId = -1;\n        this._inSnippet = SnippetController2.InSnippetMode.bindTo(contextKeyService);\n        this._hasNextTabstop = SnippetController2.HasNextTabstop.bindTo(contextKeyService);\n        this._hasPrevTabstop = SnippetController2.HasPrevTabstop.bindTo(contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(SnippetController2.ID);\n    }\n    dispose() {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._snippetListener.dispose();\n    }\n    apply(edits, opts) {\n        try {\n            this._doInsert(edits, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_edits=', edits);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    insert(template, opts) {\n        // this is here to find out more about the yet-not-understood\n        // error that sometimes happens when we fail to inserted a nested\n        // snippet\n        try {\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_template=', template);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    _doInsert(template, opts) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // don't listen while inserting the snippet\n        // as that is the inflight state causing cancelation\n        this._snippetListener.clear();\n        if (opts.undoStopBefore) {\n            this._editor.getModel().pushStackElement();\n        }\n        // don't merge\n        if (this._session && typeof template !== 'string') {\n            this.cancel();\n        }\n        if (!this._session) {\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\n            this._session = new SnippetSession(this._editor, template, opts, this._languageConfigurationService);\n            this._session.insert();\n        }\n        else {\n            assertType(typeof template === 'string');\n            this._session.merge(template, opts);\n        }\n        if (opts.undoStopAfter) {\n            this._editor.getModel().pushStackElement();\n        }\n        // regster completion item provider when there is any choice element\n        if ((_a = this._session) === null || _a === void 0 ? void 0 : _a.hasChoice) {\n            this._choiceCompletionItemProvider = {\n                provideCompletionItems: (model, position) => {\n                    if (!this._session || model !== this._editor.getModel() || !Position.equals(this._editor.getPosition(), position)) {\n                        return undefined;\n                    }\n                    const { activeChoice } = this._session;\n                    if (!activeChoice || activeChoice.choice.options.length === 0) {\n                        return undefined;\n                    }\n                    const word = model.getValueInRange(activeChoice.range);\n                    const isAnyOfOptions = Boolean(activeChoice.choice.options.find(o => o.value === word));\n                    const suggestions = [];\n                    for (let i = 0; i < activeChoice.choice.options.length; i++) {\n                        const option = activeChoice.choice.options[i];\n                        suggestions.push({\n                            kind: 13 /* CompletionItemKind.Value */,\n                            label: option.value,\n                            insertText: option.value,\n                            sortText: 'a'.repeat(i + 1),\n                            range: activeChoice.range,\n                            filterText: isAnyOfOptions ? `${word}_${option.value}` : undefined,\n                            command: { id: 'jumpToNextSnippetPlaceholder', title: localize('next', 'Go to next placeholder...') }\n                        });\n                    }\n                    return { suggestions };\n                }\n            };\n            const registration = this._languageFeaturesService.completionProvider.register({\n                language: this._editor.getModel().getLanguageId(),\n                pattern: this._editor.getModel().uri.fsPath,\n                scheme: this._editor.getModel().uri.scheme\n            }, this._choiceCompletionItemProvider);\n            this._snippetListener.add(registration);\n        }\n        this._updateState();\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\n    }\n    _updateState() {\n        if (!this._session || !this._editor.hasModel()) {\n            // canceled in the meanwhile\n            return;\n        }\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\n            // undo until the 'before' state happened\n            // and makes use cancel snippet mode\n            return this.cancel();\n        }\n        if (!this._session.hasPlaceholder) {\n            // don't listen for selection changes and don't\n            // update context keys when the snippet is plain text\n            return this.cancel();\n        }\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\n            this._editor.getModel().pushStackElement();\n            return this.cancel();\n        }\n        this._inSnippet.set(true);\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\n        this._handleChoice();\n    }\n    _handleChoice() {\n        if (!this._session || !this._editor.hasModel()) {\n            this._currentChoice = undefined;\n            return;\n        }\n        const { activeChoice } = this._session;\n        if (!activeChoice || !this._choiceCompletionItemProvider) {\n            this._currentChoice = undefined;\n            return;\n        }\n        if (this._currentChoice !== activeChoice.choice) {\n            this._currentChoice = activeChoice.choice;\n            // trigger suggest with the special choice completion provider\n            queueMicrotask(() => {\n                showSimpleSuggestions(this._editor, this._choiceCompletionItemProvider);\n            });\n        }\n    }\n    finish() {\n        while (this._inSnippet.get()) {\n            this.next();\n        }\n    }\n    cancel(resetSelection = false) {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._snippetListener.clear();\n        this._currentChoice = undefined;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._session = undefined;\n        this._modelVersionId = -1;\n        if (resetSelection) {\n            // reset selection to the primary cursor when being asked\n            // for. this happens when explicitly cancelling snippet mode,\n            // e.g. when pressing ESC\n            this._editor.setSelections([this._editor.getSelection()]);\n        }\n    }\n    prev() {\n        if (this._session) {\n            this._session.prev();\n        }\n        this._updateState();\n    }\n    next() {\n        if (this._session) {\n            this._session.next();\n        }\n        this._updateState();\n    }\n    isInSnippet() {\n        return Boolean(this._inSnippet.get());\n    }\n};\nSnippetController2.ID = 'snippetController2';\nSnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\"));\nSnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\"));\nSnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\"));\nSnippetController2 = __decorate([\n    __param(1, ILogService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageConfigurationService)\n], SnippetController2);\nexport { SnippetController2 };\nregisterEditorContribution(SnippetController2.ID, SnippetController2);\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToNextSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\n    handler: ctrl => ctrl.next(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToPrevSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\n    handler: ctrl => ctrl.prev(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'leaveSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.cancel(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'acceptSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.finish(),\n    // kbOpts: {\n    // \tweight: KeybindingWeight.EditorContrib + 30,\n    // \tkbExpr: EditorContextKeys.textFocus,\n    // \tprimary: KeyCode.Enter,\n    // }\n}));\n// ---\nexport function performSnippetEdit(editor, snippet, selections) {\n    const controller = SnippetController2.get(editor);\n    if (!controller) {\n        return false;\n    }\n    editor.focus();\n    controller.apply(selections.map(selection => {\n        return {\n            range: Selection.liftSelection(selection),\n            template: snippet\n        };\n    }));\n    return controller.isInSnippet();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { DataTransfers } from '../../../../base/browser/dnd.js';\nimport { addDisposableListener } from '../../../../base/browser/dom.js';\nimport { createCancelablePromise } from '../../../../base/common/async.js';\nimport { createStringDataTransferItem } from '../../../../base/common/dataTransfer.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../base/common/mime.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { toVSDataTransfer, UriList } from '../../../browser/dnd.js';\nimport { IBulkEditService, ResourceEdit } from '../../../browser/services/bulkEditService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { performSnippetEdit } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst vscodeClipboardMime = 'application/vnd.code.copyMetadata';\nlet CopyPasteController = class CopyPasteController extends Disposable {\n    constructor(editor, _bulkEditService, _clipboardService, _configurationService, _languageFeaturesService) {\n        super();\n        this._bulkEditService = _bulkEditService;\n        this._clipboardService = _clipboardService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._editor = editor;\n        const container = editor.getContainerDomNode();\n        this._register(addDisposableListener(container, 'copy', e => this.handleCopy(e)));\n        this._register(addDisposableListener(container, 'cut', e => this.handleCopy(e)));\n        this._register(addDisposableListener(container, 'paste', e => this.handlePaste(e), true));\n    }\n    arePasteActionsEnabled(model) {\n        return this._configurationService.getValue('editor.experimental.pasteActions.enabled', {\n            resource: model.uri\n        });\n    }\n    handleCopy(e) {\n        var _a;\n        if (!e.clipboardData || !this._editor.hasTextFocus()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const selections = this._editor.getSelections();\n        if (!model || !(selections === null || selections === void 0 ? void 0 : selections.length)) {\n            return;\n        }\n        if (!this.arePasteActionsEnabled(model)) {\n            return;\n        }\n        const ranges = [...selections];\n        const primarySelection = selections[0];\n        const wasFromEmptySelection = primarySelection.isEmpty();\n        if (wasFromEmptySelection) {\n            if (!this._editor.getOption(33 /* EditorOption.emptySelectionClipboard */)) {\n                return;\n            }\n            ranges[0] = new Range(primarySelection.startLineNumber, 0, primarySelection.startLineNumber, model.getLineLength(primarySelection.startLineNumber));\n        }\n        const providers = this._languageFeaturesService.documentPasteEditProvider.ordered(model).filter(x => !!x.prepareDocumentPaste);\n        if (!providers.length) {\n            this.setCopyMetadata(e.clipboardData, { wasFromEmptySelection });\n            return;\n        }\n        const dataTransfer = toVSDataTransfer(e.clipboardData);\n        // Save off a handle pointing to data that VS Code maintains.\n        const handle = generateUuid();\n        this.setCopyMetadata(e.clipboardData, {\n            id: handle,\n            wasFromEmptySelection,\n        });\n        const promise = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n            const results = yield Promise.all(providers.map(provider => {\n                return provider.prepareDocumentPaste(model, ranges, dataTransfer, token);\n            }));\n            for (const result of results) {\n                result === null || result === void 0 ? void 0 : result.forEach((value, key) => {\n                    dataTransfer.replace(key, value);\n                });\n            }\n            return dataTransfer;\n        }));\n        (_a = this._currentClipboardItem) === null || _a === void 0 ? void 0 : _a.dataTransferPromise.cancel();\n        this._currentClipboardItem = { handle: handle, dataTransferPromise: promise };\n    }\n    setCopyMetadata(dataTransfer, metadata) {\n        dataTransfer.setData(vscodeClipboardMime, JSON.stringify(metadata));\n    }\n    handlePaste(e) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!e.clipboardData || !this._editor.hasTextFocus()) {\n                return;\n            }\n            const selections = this._editor.getSelections();\n            if (!(selections === null || selections === void 0 ? void 0 : selections.length) || !this._editor.hasModel()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            if (!this.arePasteActionsEnabled(model)) {\n                return;\n            }\n            let metadata;\n            const rawMetadata = (_a = e.clipboardData) === null || _a === void 0 ? void 0 : _a.getData(vscodeClipboardMime);\n            if (rawMetadata && typeof rawMetadata === 'string') {\n                metadata = JSON.parse(rawMetadata);\n            }\n            const providers = this._languageFeaturesService.documentPasteEditProvider.ordered(model);\n            if (!providers.length) {\n                return;\n            }\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const originalDocVersion = model.getVersionId();\n            const tokenSource = new EditorStateCancellationTokenSource(this._editor, 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */);\n            try {\n                const dataTransfer = toVSDataTransfer(e.clipboardData);\n                if ((metadata === null || metadata === void 0 ? void 0 : metadata.id) && ((_b = this._currentClipboardItem) === null || _b === void 0 ? void 0 : _b.handle) === metadata.id) {\n                    const toMergeDataTransfer = yield this._currentClipboardItem.dataTransferPromise;\n                    toMergeDataTransfer.forEach((value, key) => {\n                        dataTransfer.replace(key, value);\n                    });\n                }\n                if (!dataTransfer.has(Mimes.uriList)) {\n                    const resources = yield this._clipboardService.readResources();\n                    if (resources.length) {\n                        dataTransfer.append(Mimes.uriList, createStringDataTransferItem(UriList.create(resources)));\n                    }\n                }\n                dataTransfer.delete(vscodeClipboardMime);\n                for (const provider of providers) {\n                    if (!provider.pasteMimeTypes.some(type => {\n                        if (type.toLowerCase() === DataTransfers.FILES.toLowerCase()) {\n                            return [...dataTransfer.values()].some(item => item.asFile());\n                        }\n                        return dataTransfer.has(type);\n                    })) {\n                        continue;\n                    }\n                    const edit = yield provider.provideDocumentPasteEdits(model, selections, dataTransfer, tokenSource.token);\n                    if (originalDocVersion !== model.getVersionId()) {\n                        return;\n                    }\n                    if (edit) {\n                        performSnippetEdit(this._editor, typeof edit.insertText === 'string' ? SnippetParser.escape(edit.insertText) : edit.insertText.snippet, selections);\n                        if (edit.additionalEdit) {\n                            yield this._bulkEditService.apply(ResourceEdit.convert(edit.additionalEdit), { editor: this._editor });\n                        }\n                        return;\n                    }\n                }\n                // Default handler\n                const textDataTransfer = (_c = dataTransfer.get(Mimes.text)) !== null && _c !== void 0 ? _c : dataTransfer.get('text');\n                if (!textDataTransfer) {\n                    return;\n                }\n                const text = yield textDataTransfer.asString();\n                if (originalDocVersion !== model.getVersionId()) {\n                    return;\n                }\n                this._editor.trigger('keyboard', \"paste\" /* Handler.Paste */, {\n                    text: text,\n                    pasteOnNewLine: metadata === null || metadata === void 0 ? void 0 : metadata.wasFromEmptySelection,\n                    multicursorText: null\n                });\n            }\n            finally {\n                tokenSource.dispose();\n            }\n        });\n    }\n};\nCopyPasteController.ID = 'editor.contrib.copyPasteActionController';\nCopyPasteController = __decorate([\n    __param(1, IBulkEditService),\n    __param(2, IClipboardService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeaturesService)\n], CopyPasteController);\nexport { CopyPasteController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorConfigurationBaseNode } from '../../../common/config/editorConfigurationSchema.js';\nimport { CopyPasteController } from './copyPasteController.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nregisterEditorContribution(CopyPasteController.ID, CopyPasteController);\nRegistry.as(Extensions.Configuration).registerConfiguration(Object.assign(Object.assign({}, editorConfigurationBaseNode), { properties: {\n        'editor.experimental.pasteActions.enabled': {\n            type: 'boolean',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('pasteActions', \"Enable/disable running edits from extensions on paste.\"),\n            default: false,\n        },\n    } }));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class BlockCommentCommand {\n    constructor(selection, insertSpace, languageConfigurationService) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._selection = selection;\n        this._insertSpace = insertSpace;\n        this._usedEndToken = null;\n    }\n    static _haystackHasNeedleAtOffset(haystack, needle, offset) {\n        if (offset < 0) {\n            return false;\n        }\n        const needleLength = needle.length;\n        const haystackLength = haystack.length;\n        if (offset + needleLength > haystackLength) {\n            return false;\n        }\n        for (let i = 0; i < needleLength; i++) {\n            const codeA = haystack.charCodeAt(offset + i);\n            const codeB = needle.charCodeAt(i);\n            if (codeA === codeB) {\n                continue;\n            }\n            if (codeA >= 65 /* CharCode.A */ && codeA <= 90 /* CharCode.Z */ && codeA + 32 === codeB) {\n                // codeA is upper-case variant of codeB\n                continue;\n            }\n            if (codeB >= 65 /* CharCode.A */ && codeB <= 90 /* CharCode.Z */ && codeB + 32 === codeA) {\n                // codeB is upper-case variant of codeA\n                continue;\n            }\n            return false;\n        }\n        return true;\n    }\n    _createOperationsForBlockComment(selection, startToken, endToken, insertSpace, model, builder) {\n        const startLineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endLineNumber = selection.endLineNumber;\n        const endColumn = selection.endColumn;\n        const startLineText = model.getLineContent(startLineNumber);\n        const endLineText = model.getLineContent(endLineNumber);\n        let startTokenIndex = startLineText.lastIndexOf(startToken, startColumn - 1 + startToken.length);\n        let endTokenIndex = endLineText.indexOf(endToken, endColumn - 1 - endToken.length);\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            if (startLineNumber === endLineNumber) {\n                const lineBetweenTokens = startLineText.substring(startTokenIndex + startToken.length, endTokenIndex);\n                if (lineBetweenTokens.indexOf(endToken) >= 0) {\n                    // force to add a block comment\n                    startTokenIndex = -1;\n                    endTokenIndex = -1;\n                }\n            }\n            else {\n                const startLineAfterStartToken = startLineText.substring(startTokenIndex + startToken.length);\n                const endLineBeforeEndToken = endLineText.substring(0, endTokenIndex);\n                if (startLineAfterStartToken.indexOf(endToken) >= 0 || endLineBeforeEndToken.indexOf(endToken) >= 0) {\n                    // force to add a block comment\n                    startTokenIndex = -1;\n                    endTokenIndex = -1;\n                }\n            }\n        }\n        let ops;\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            // Consider spaces as part of the comment tokens\n            if (insertSpace && startTokenIndex + startToken.length < startLineText.length && startLineText.charCodeAt(startTokenIndex + startToken.length) === 32 /* CharCode.Space */) {\n                // Pretend the start token contains a trailing space\n                startToken = startToken + ' ';\n            }\n            if (insertSpace && endTokenIndex > 0 && endLineText.charCodeAt(endTokenIndex - 1) === 32 /* CharCode.Space */) {\n                // Pretend the end token contains a leading space\n                endToken = ' ' + endToken;\n                endTokenIndex -= 1;\n            }\n            ops = BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\n        }\n        else {\n            ops = BlockCommentCommand._createAddBlockCommentOperations(selection, startToken, endToken, this._insertSpace);\n            this._usedEndToken = ops.length === 1 ? endToken : null;\n        }\n        for (const op of ops) {\n            builder.addTrackedEditOperation(op.range, op.text);\n        }\n    }\n    static _createRemoveBlockCommentOperations(r, startToken, endToken) {\n        const res = [];\n        if (!Range.isEmpty(r)) {\n            // Remove block comment start\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.startLineNumber, r.startColumn)));\n            // Remove block comment end\n            res.push(EditOperation.delete(new Range(r.endLineNumber, r.endColumn, r.endLineNumber, r.endColumn + endToken.length)));\n        }\n        else {\n            // Remove both continuously\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.endLineNumber, r.endColumn + endToken.length)));\n        }\n        return res;\n    }\n    static _createAddBlockCommentOperations(r, startToken, endToken, insertSpace) {\n        const res = [];\n        if (!Range.isEmpty(r)) {\n            // Insert block comment start\n            res.push(EditOperation.insert(new Position(r.startLineNumber, r.startColumn), startToken + (insertSpace ? ' ' : '')));\n            // Insert block comment end\n            res.push(EditOperation.insert(new Position(r.endLineNumber, r.endColumn), (insertSpace ? ' ' : '') + endToken));\n        }\n        else {\n            // Insert both continuously\n            res.push(EditOperation.replace(new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn), startToken + '  ' + endToken));\n        }\n        return res;\n    }\n    getEditOperations(model, builder) {\n        const startLineNumber = this._selection.startLineNumber;\n        const startColumn = this._selection.startColumn;\n        model.tokenization.tokenizeIfCheap(startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, startColumn);\n        const config = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\n            // Mode does not support block comments\n            return;\n        }\n        this._createOperationsForBlockComment(this._selection, config.blockCommentStartToken, config.blockCommentEndToken, this._insertSpace, model, builder);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        if (inverseEditOperations.length === 2) {\n            const startTokenEditOperation = inverseEditOperations[0];\n            const endTokenEditOperation = inverseEditOperations[1];\n            return new Selection(startTokenEditOperation.range.endLineNumber, startTokenEditOperation.range.endColumn, endTokenEditOperation.range.startLineNumber, endTokenEditOperation.range.startColumn);\n        }\n        else {\n            const srcRange = inverseEditOperations[0].range;\n            const deltaColumn = this._usedEndToken ? -this._usedEndToken.length - 1 : 0; // minus 1 space before endToken\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn + deltaColumn, srcRange.endLineNumber, srcRange.endColumn + deltaColumn);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { BlockCommentCommand } from './blockCommentCommand.js';\nexport class LineCommentCommand {\n    constructor(languageConfigurationService, selection, tabSize, type, insertSpace, ignoreEmptyLines, ignoreFirstLine) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._selection = selection;\n        this._tabSize = tabSize;\n        this._type = type;\n        this._insertSpace = insertSpace;\n        this._selectionId = null;\n        this._deltaColumn = 0;\n        this._moveEndPositionDown = false;\n        this._ignoreEmptyLines = ignoreEmptyLines;\n        this._ignoreFirstLine = ignoreFirstLine || false;\n    }\n    /**\n     * Do an initial pass over the lines and gather info about the line comment string.\n     * Returns null if any of the lines doesn't support a line comment string.\n     */\n    static _gatherPreflightCommentStrings(model, startLineNumber, endLineNumber, languageConfigurationService) {\n        model.tokenization.tokenizeIfCheap(startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, 1);\n        const config = languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        const commentStr = (config ? config.lineCommentToken : null);\n        if (!commentStr) {\n            // Mode does not support line comments\n            return null;\n        }\n        const lines = [];\n        for (let i = 0, lineCount = endLineNumber - startLineNumber + 1; i < lineCount; i++) {\n            lines[i] = {\n                ignore: false,\n                commentStr: commentStr,\n                commentStrOffset: 0,\n                commentStrLength: commentStr.length\n            };\n        }\n        return lines;\n    }\n    /**\n     * Analyze lines and decide which lines are relevant and what the toggle should do.\n     * Also, build up several offsets and lengths useful in the generation of editor operations.\n     */\n    static _analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService) {\n        let onlyWhitespaceLines = true;\n        let shouldRemoveComments;\n        if (type === 0 /* Type.Toggle */) {\n            shouldRemoveComments = true;\n        }\n        else if (type === 1 /* Type.ForceAdd */) {\n            shouldRemoveComments = false;\n        }\n        else {\n            shouldRemoveComments = true;\n        }\n        for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\n            const lineData = lines[i];\n            const lineNumber = startLineNumber + i;\n            if (lineNumber === startLineNumber && ignoreFirstLine) {\n                // first line ignored\n                lineData.ignore = true;\n                continue;\n            }\n            const lineContent = model.getLineContent(lineNumber);\n            const lineContentStartOffset = strings.firstNonWhitespaceIndex(lineContent);\n            if (lineContentStartOffset === -1) {\n                // Empty or whitespace only line\n                lineData.ignore = ignoreEmptyLines;\n                lineData.commentStrOffset = lineContent.length;\n                continue;\n            }\n            onlyWhitespaceLines = false;\n            lineData.ignore = false;\n            lineData.commentStrOffset = lineContentStartOffset;\n            if (shouldRemoveComments && !BlockCommentCommand._haystackHasNeedleAtOffset(lineContent, lineData.commentStr, lineContentStartOffset)) {\n                if (type === 0 /* Type.Toggle */) {\n                    // Every line so far has been a line comment, but this one is not\n                    shouldRemoveComments = false;\n                }\n                else if (type === 1 /* Type.ForceAdd */) {\n                    // Will not happen\n                }\n                else {\n                    lineData.ignore = true;\n                }\n            }\n            if (shouldRemoveComments && insertSpace) {\n                // Remove a following space if present\n                const commentStrEndOffset = lineContentStartOffset + lineData.commentStrLength;\n                if (commentStrEndOffset < lineContent.length && lineContent.charCodeAt(commentStrEndOffset) === 32 /* CharCode.Space */) {\n                    lineData.commentStrLength += 1;\n                }\n            }\n        }\n        if (type === 0 /* Type.Toggle */ && onlyWhitespaceLines) {\n            // For only whitespace lines, we insert comments\n            shouldRemoveComments = false;\n            // Also, no longer ignore them\n            for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\n                lines[i].ignore = false;\n            }\n        }\n        return {\n            supported: true,\n            shouldRemoveComments: shouldRemoveComments,\n            lines: lines\n        };\n    }\n    /**\n     * Analyze all lines and decide exactly what to do => not supported | insert line comments | remove line comments\n     */\n    static _gatherPreflightData(type, insertSpace, model, startLineNumber, endLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService) {\n        const lines = LineCommentCommand._gatherPreflightCommentStrings(model, startLineNumber, endLineNumber, languageConfigurationService);\n        if (lines === null) {\n            return {\n                supported: false\n            };\n        }\n        return LineCommentCommand._analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService);\n    }\n    /**\n     * Given a successful analysis, execute either insert line comments, either remove line comments\n     */\n    _executeLineComments(model, builder, data, s) {\n        let ops;\n        if (data.shouldRemoveComments) {\n            ops = LineCommentCommand._createRemoveLineCommentsOperations(data.lines, s.startLineNumber);\n        }\n        else {\n            LineCommentCommand._normalizeInsertionPoint(model, data.lines, s.startLineNumber, this._tabSize);\n            ops = this._createAddLineCommentsOperations(data.lines, s.startLineNumber);\n        }\n        const cursorPosition = new Position(s.positionLineNumber, s.positionColumn);\n        for (let i = 0, len = ops.length; i < len; i++) {\n            builder.addEditOperation(ops[i].range, ops[i].text);\n            if (Range.isEmpty(ops[i].range) && Range.getStartPosition(ops[i].range).equals(cursorPosition)) {\n                const lineContent = model.getLineContent(cursorPosition.lineNumber);\n                if (lineContent.length + 1 === cursorPosition.column) {\n                    this._deltaColumn = (ops[i].text || '').length;\n                }\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n    }\n    _attemptRemoveBlockComment(model, s, startToken, endToken) {\n        let startLineNumber = s.startLineNumber;\n        let endLineNumber = s.endLineNumber;\n        const startTokenAllowedBeforeColumn = endToken.length + Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.startColumn);\n        let startTokenIndex = model.getLineContent(startLineNumber).lastIndexOf(startToken, startTokenAllowedBeforeColumn - 1);\n        let endTokenIndex = model.getLineContent(endLineNumber).indexOf(endToken, s.endColumn - 1 - startToken.length);\n        if (startTokenIndex !== -1 && endTokenIndex === -1) {\n            endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\n            endLineNumber = startLineNumber;\n        }\n        if (startTokenIndex === -1 && endTokenIndex !== -1) {\n            startTokenIndex = model.getLineContent(endLineNumber).lastIndexOf(startToken, endTokenIndex);\n            startLineNumber = endLineNumber;\n        }\n        if (s.isEmpty() && (startTokenIndex === -1 || endTokenIndex === -1)) {\n            startTokenIndex = model.getLineContent(startLineNumber).indexOf(startToken);\n            if (startTokenIndex !== -1) {\n                endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\n            }\n        }\n        // We have to adjust to possible inner white space.\n        // For Space after startToken, add Space to startToken - range math will work out.\n        if (startTokenIndex !== -1 && model.getLineContent(startLineNumber).charCodeAt(startTokenIndex + startToken.length) === 32 /* CharCode.Space */) {\n            startToken += ' ';\n        }\n        // For Space before endToken, add Space before endToken and shift index one left.\n        if (endTokenIndex !== -1 && model.getLineContent(endLineNumber).charCodeAt(endTokenIndex - 1) === 32 /* CharCode.Space */) {\n            endToken = ' ' + endToken;\n            endTokenIndex -= 1;\n        }\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            return BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\n        }\n        return null;\n    }\n    /**\n     * Given an unsuccessful analysis, delegate to the block comment command\n     */\n    _executeBlockComment(model, builder, s) {\n        model.tokenization.tokenizeIfCheap(s.startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(s.startLineNumber, 1);\n        const config = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\n            // Mode does not support block comments\n            return;\n        }\n        const startToken = config.blockCommentStartToken;\n        const endToken = config.blockCommentEndToken;\n        let ops = this._attemptRemoveBlockComment(model, s, startToken, endToken);\n        if (!ops) {\n            if (s.isEmpty()) {\n                const lineContent = model.getLineContent(s.startLineNumber);\n                let firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n                if (firstNonWhitespaceIndex === -1) {\n                    // Line is empty or contains only whitespace\n                    firstNonWhitespaceIndex = lineContent.length;\n                }\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, firstNonWhitespaceIndex + 1, s.startLineNumber, lineContent.length + 1), startToken, endToken, this._insertSpace);\n            }\n            else {\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), startToken, endToken, this._insertSpace);\n            }\n            if (ops.length === 1) {\n                // Leave cursor after token and Space\n                this._deltaColumn = startToken.length + 1;\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n        for (const op of ops) {\n            builder.addEditOperation(op.range, op.text);\n        }\n    }\n    getEditOperations(model, builder) {\n        let s = this._selection;\n        this._moveEndPositionDown = false;\n        if (s.startLineNumber === s.endLineNumber && this._ignoreFirstLine) {\n            builder.addEditOperation(new Range(s.startLineNumber, model.getLineMaxColumn(s.startLineNumber), s.startLineNumber + 1, 1), s.startLineNumber === model.getLineCount() ? '' : '\\n');\n            this._selectionId = builder.trackSelection(s);\n            return;\n        }\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._moveEndPositionDown = true;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const data = LineCommentCommand._gatherPreflightData(this._type, this._insertSpace, model, s.startLineNumber, s.endLineNumber, this._ignoreEmptyLines, this._ignoreFirstLine, this.languageConfigurationService);\n        if (data.supported) {\n            return this._executeLineComments(model, builder, data, s);\n        }\n        return this._executeBlockComment(model, builder, s);\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._moveEndPositionDown) {\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\n        }\n        return new Selection(result.selectionStartLineNumber, result.selectionStartColumn + this._deltaColumn, result.positionLineNumber, result.positionColumn + this._deltaColumn);\n    }\n    /**\n     * Generate edit operations in the remove line comment case\n     */\n    static _createRemoveLineCommentsOperations(lines, startLineNumber) {\n        const res = [];\n        for (let i = 0, len = lines.length; i < len; i++) {\n            const lineData = lines[i];\n            if (lineData.ignore) {\n                continue;\n            }\n            res.push(EditOperation.delete(new Range(startLineNumber + i, lineData.commentStrOffset + 1, startLineNumber + i, lineData.commentStrOffset + lineData.commentStrLength + 1)));\n        }\n        return res;\n    }\n    /**\n     * Generate edit operations in the add line comment case\n     */\n    _createAddLineCommentsOperations(lines, startLineNumber) {\n        const res = [];\n        const afterCommentStr = this._insertSpace ? ' ' : '';\n        for (let i = 0, len = lines.length; i < len; i++) {\n            const lineData = lines[i];\n            if (lineData.ignore) {\n                continue;\n            }\n            res.push(EditOperation.insert(new Position(startLineNumber + i, lineData.commentStrOffset + 1), lineData.commentStr + afterCommentStr));\n        }\n        return res;\n    }\n    static nextVisibleColumn(currentVisibleColumn, tabSize, isTab, columnSize) {\n        if (isTab) {\n            return currentVisibleColumn + (tabSize - (currentVisibleColumn % tabSize));\n        }\n        return currentVisibleColumn + columnSize;\n    }\n    /**\n     * Adjust insertion points to have them vertically aligned in the add line comment case\n     */\n    static _normalizeInsertionPoint(model, lines, startLineNumber, tabSize) {\n        let minVisibleColumn = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        let j;\n        let lenJ;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].ignore) {\n                continue;\n            }\n            const lineContent = model.getLineContent(startLineNumber + i);\n            let currentVisibleColumn = 0;\n            for (let j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* CharCode.Tab */, 1);\n            }\n            if (currentVisibleColumn < minVisibleColumn) {\n                minVisibleColumn = currentVisibleColumn;\n            }\n        }\n        minVisibleColumn = Math.floor(minVisibleColumn / tabSize) * tabSize;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].ignore) {\n                continue;\n            }\n            const lineContent = model.getLineContent(startLineNumber + i);\n            let currentVisibleColumn = 0;\n            for (j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* CharCode.Tab */, 1);\n            }\n            if (currentVisibleColumn > minVisibleColumn) {\n                lines[i].commentStrOffset = j - 1;\n            }\n            else {\n                lines[i].commentStrOffset = j;\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { BlockCommentCommand } from './blockCommentCommand.js';\nimport { LineCommentCommand } from './lineCommentCommand.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nclass CommentLineAction extends EditorAction {\n    constructor(type, opts) {\n        super(opts);\n        this._type = type;\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const commands = [];\n        const modelOptions = model.getOptions();\n        const commentsOptions = editor.getOption(19 /* EditorOption.comments */);\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignoreFirstLine: false }));\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        // Remove selections that would result in copying the same line\n        let prev = selections[0];\n        for (let i = 1; i < selections.length; i++) {\n            const curr = selections[i];\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\n                // these two selections would copy the same line\n                if (prev.index < curr.index) {\n                    // prev wins\n                    curr.ignoreFirstLine = true;\n                }\n                else {\n                    // curr wins\n                    prev.ignoreFirstLine = true;\n                    prev = curr;\n                }\n            }\n        }\n        for (const selection of selections) {\n            commands.push(new LineCommentCommand(languageConfigurationService, selection.selection, modelOptions.tabSize, this._type, commentsOptions.insertSpace, commentsOptions.ignoreEmptyLines, selection.ignoreFirstLine));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass ToggleCommentLineAction extends CommentLineAction {\n    constructor() {\n        super(0 /* Type.Toggle */, {\n            id: 'editor.action.commentLine',\n            label: nls.localize('comment.line', \"Toggle Line Comment\"),\n            alias: 'Toggle Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 85 /* KeyCode.Slash */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarEditMenu,\n                group: '5_insert',\n                title: nls.localize({ key: 'miToggleLineComment', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Line Comment\"),\n                order: 1\n            }\n        });\n    }\n}\nclass AddLineCommentAction extends CommentLineAction {\n    constructor() {\n        super(1 /* Type.ForceAdd */, {\n            id: 'editor.action.addCommentLine',\n            label: nls.localize('comment.line.add', \"Add Line Comment\"),\n            alias: 'Add Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass RemoveLineCommentAction extends CommentLineAction {\n    constructor() {\n        super(2 /* Type.ForceRemove */, {\n            id: 'editor.action.removeCommentLine',\n            label: nls.localize('comment.line.remove', \"Remove Line Comment\"),\n            alias: 'Remove Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 51 /* KeyCode.KeyU */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass BlockCommentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.blockComment',\n            label: nls.localize('comment.block', \"Toggle Block Comment\"),\n            alias: 'Toggle Block Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 31 /* KeyCode.KeyA */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 31 /* KeyCode.KeyA */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarEditMenu,\n                group: '5_insert',\n                title: nls.localize({ key: 'miToggleBlockComment', comment: ['&& denotes a mnemonic'] }, \"Toggle &&Block Comment\"),\n                order: 2\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commentsOptions = editor.getOption(19 /* EditorOption.comments */);\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            commands.push(new BlockCommentCommand(selection, commentsOptions.insertSpace, languageConfigurationService));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nregisterEditorAction(ToggleCommentLineAction);\nregisterEditorAction(AddLineCommentAction);\nregisterEditorAction(RemoveLineCommentAction);\nregisterEditorAction(BlockCommentAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionViewItem } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { Separator, SubmenuAction } from '../../../../base/common/actions.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isIOS } from '../../../../base/common/platform.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nimport { IMenuService, MenuId, SubmenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService, IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nlet ContextMenuController = class ContextMenuController {\n    constructor(editor, _contextMenuService, _contextViewService, _contextKeyService, _keybindingService, _menuService, _configurationService) {\n        this._contextMenuService = _contextMenuService;\n        this._contextViewService = _contextViewService;\n        this._contextKeyService = _contextKeyService;\n        this._keybindingService = _keybindingService;\n        this._menuService = _menuService;\n        this._configurationService = _configurationService;\n        this._toDispose = new DisposableStore();\n        this._contextMenuIsBeingShownCount = 0;\n        this._editor = editor;\n        this._toDispose.add(this._editor.onContextMenu((e) => this._onContextMenu(e)));\n        this._toDispose.add(this._editor.onMouseWheel((e) => {\n            if (this._contextMenuIsBeingShownCount > 0) {\n                const view = this._contextViewService.getContextViewElement();\n                const target = e.srcElement;\n                // Event triggers on shadow root host first\n                // Check if the context view is under this host before hiding it #103169\n                if (!(target.shadowRoot && dom.getShadowRoot(view) === target.shadowRoot)) {\n                    this._contextViewService.hideContextView();\n                }\n            }\n        }));\n        this._toDispose.add(this._editor.onKeyDown((e) => {\n            if (!this._editor.getOption(20 /* EditorOption.contextmenu */)) {\n                return; // Context menu is turned off through configuration\n            }\n            if (e.keyCode === 58 /* KeyCode.ContextMenu */) {\n                // Chrome is funny like that\n                e.preventDefault();\n                e.stopPropagation();\n                this.showContextMenu();\n            }\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(ContextMenuController.ID);\n    }\n    _onContextMenu(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._editor.getOption(20 /* EditorOption.contextmenu */)) {\n            this._editor.focus();\n            // Ensure the cursor is at the position of the mouse click\n            if (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\n                this._editor.setPosition(e.target.position);\n            }\n            return; // Context menu is turned off through configuration\n        }\n        if (e.target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */) {\n            return; // allow native menu on widgets to support right click on input field for example in find\n        }\n        if (e.target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.detail.injectedText) {\n            return; // allow native menu on injected text\n        }\n        e.event.preventDefault();\n        e.event.stopPropagation();\n        if (e.target.type === 11 /* MouseTargetType.SCROLLBAR */) {\n            return this._showScrollbarContextMenu({ x: e.event.posx - 1, width: 2, y: e.event.posy - 1, height: 2 });\n        }\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.type !== 7 /* MouseTargetType.CONTENT_EMPTY */ && e.target.type !== 1 /* MouseTargetType.TEXTAREA */) {\n            return; // only support mouse click into text or native context menu key for now\n        }\n        // Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\n        this._editor.focus();\n        // Ensure the cursor is at the position of the mouse click\n        if (e.target.position) {\n            let hasSelectionAtPosition = false;\n            for (const selection of this._editor.getSelections()) {\n                if (selection.containsPosition(e.target.position)) {\n                    hasSelectionAtPosition = true;\n                    break;\n                }\n            }\n            if (!hasSelectionAtPosition) {\n                this._editor.setPosition(e.target.position);\n            }\n        }\n        // Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\n        let anchor = null;\n        if (e.target.type !== 1 /* MouseTargetType.TEXTAREA */) {\n            anchor = { x: e.event.posx - 1, width: 2, y: e.event.posy - 1, height: 2 };\n        }\n        // Show the context menu\n        this.showContextMenu(anchor);\n    }\n    showContextMenu(anchor) {\n        if (!this._editor.getOption(20 /* EditorOption.contextmenu */)) {\n            return; // Context menu is turned off through configuration\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // Find actions available for menu\n        const menuActions = this._getMenuActions(this._editor.getModel(), this._editor.isSimpleWidget ? MenuId.SimpleEditorContext : MenuId.EditorContext);\n        // Show menu if we have actions to show\n        if (menuActions.length > 0) {\n            this._doShowContextMenu(menuActions, anchor);\n        }\n    }\n    _getMenuActions(model, menuId) {\n        const result = [];\n        // get menu groups\n        const menu = this._menuService.createMenu(menuId, this._contextKeyService);\n        const groups = menu.getActions({ arg: model.uri });\n        menu.dispose();\n        // translate them into other actions\n        for (const group of groups) {\n            const [, actions] = group;\n            let addedItems = 0;\n            for (const action of actions) {\n                if (action instanceof SubmenuItemAction) {\n                    const subActions = this._getMenuActions(model, action.item.submenu);\n                    if (subActions.length > 0) {\n                        result.push(new SubmenuAction(action.id, action.label, subActions));\n                        addedItems++;\n                    }\n                }\n                else {\n                    result.push(action);\n                    addedItems++;\n                }\n            }\n            if (addedItems) {\n                result.push(new Separator());\n            }\n        }\n        if (result.length) {\n            result.pop(); // remove last separator\n        }\n        return result;\n    }\n    _doShowContextMenu(actions, anchor = null) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // Disable hover\n        const oldHoverSetting = this._editor.getOption(55 /* EditorOption.hover */);\n        this._editor.updateOptions({\n            hover: {\n                enabled: false\n            }\n        });\n        if (!anchor) {\n            // Ensure selection is visible\n            this._editor.revealPosition(this._editor.getPosition(), 1 /* ScrollType.Immediate */);\n            this._editor.render();\n            const cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\n            // Translate to absolute editor position\n            const editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\n            const posx = editorCoords.left + cursorCoords.left;\n            const posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\n            anchor = { x: posx, y: posy };\n        }\n        const useShadowDOM = this._editor.getOption(117 /* EditorOption.useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\n        // Show menu\n        this._contextMenuIsBeingShownCount++;\n        this._contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\n            getAnchor: () => anchor,\n            getActions: () => actions,\n            getActionViewItem: (action) => {\n                const keybinding = this._keybindingFor(action);\n                if (keybinding) {\n                    return new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\n                }\n                const customActionViewItem = action;\n                if (typeof customActionViewItem.getActionViewItem === 'function') {\n                    return customActionViewItem.getActionViewItem();\n                }\n                return new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\n            },\n            getKeyBinding: (action) => {\n                return this._keybindingFor(action);\n            },\n            onHide: (wasCancelled) => {\n                this._contextMenuIsBeingShownCount--;\n                this._editor.focus();\n                this._editor.updateOptions({\n                    hover: oldHoverSetting\n                });\n            }\n        });\n    }\n    _showScrollbarContextMenu(anchor) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const minimapOptions = this._editor.getOption(67 /* EditorOption.minimap */);\n        let lastId = 0;\n        const createAction = (opts) => {\n            return {\n                id: `menu-action-${++lastId}`,\n                label: opts.label,\n                tooltip: '',\n                class: undefined,\n                enabled: (typeof opts.enabled === 'undefined' ? true : opts.enabled),\n                checked: opts.checked,\n                run: opts.run,\n                dispose: () => null\n            };\n        };\n        const createSubmenuAction = (label, actions) => {\n            return new SubmenuAction(`menu-action-${++lastId}`, label, actions, undefined);\n        };\n        const createEnumAction = (label, enabled, configName, configuredValue, options) => {\n            if (!enabled) {\n                return createAction({ label, enabled, run: () => { } });\n            }\n            const createRunner = (value) => {\n                return () => {\n                    this._configurationService.updateValue(configName, value);\n                };\n            };\n            const actions = [];\n            for (const option of options) {\n                actions.push(createAction({\n                    label: option.label,\n                    checked: configuredValue === option.value,\n                    run: createRunner(option.value)\n                }));\n            }\n            return createSubmenuAction(label, actions);\n        };\n        const actions = [];\n        actions.push(createAction({\n            label: nls.localize('context.minimap.minimap', \"Minimap\"),\n            checked: minimapOptions.enabled,\n            run: () => {\n                this._configurationService.updateValue(`editor.minimap.enabled`, !minimapOptions.enabled);\n            }\n        }));\n        actions.push(new Separator());\n        actions.push(createAction({\n            label: nls.localize('context.minimap.renderCharacters', \"Render Characters\"),\n            enabled: minimapOptions.enabled,\n            checked: minimapOptions.renderCharacters,\n            run: () => {\n                this._configurationService.updateValue(`editor.minimap.renderCharacters`, !minimapOptions.renderCharacters);\n            }\n        }));\n        actions.push(createEnumAction(nls.localize('context.minimap.size', \"Vertical size\"), minimapOptions.enabled, 'editor.minimap.size', minimapOptions.size, [{\n                label: nls.localize('context.minimap.size.proportional', \"Proportional\"),\n                value: 'proportional'\n            }, {\n                label: nls.localize('context.minimap.size.fill', \"Fill\"),\n                value: 'fill'\n            }, {\n                label: nls.localize('context.minimap.size.fit', \"Fit\"),\n                value: 'fit'\n            }]));\n        actions.push(createEnumAction(nls.localize('context.minimap.slider', \"Slider\"), minimapOptions.enabled, 'editor.minimap.showSlider', minimapOptions.showSlider, [{\n                label: nls.localize('context.minimap.slider.mouseover', \"Mouse Over\"),\n                value: 'mouseover'\n            }, {\n                label: nls.localize('context.minimap.slider.always', \"Always\"),\n                value: 'always'\n            }]));\n        const useShadowDOM = this._editor.getOption(117 /* EditorOption.useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\n        this._contextMenuIsBeingShownCount++;\n        this._contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\n            getAnchor: () => anchor,\n            getActions: () => actions,\n            onHide: (wasCancelled) => {\n                this._contextMenuIsBeingShownCount--;\n                this._editor.focus();\n            }\n        });\n    }\n    _keybindingFor(action) {\n        return this._keybindingService.lookupKeybinding(action.id);\n    }\n    dispose() {\n        if (this._contextMenuIsBeingShownCount > 0) {\n            this._contextViewService.hideContextView();\n        }\n        this._toDispose.dispose();\n    }\n};\nContextMenuController.ID = 'editor.contrib.contextmenu';\nContextMenuController = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, IContextViewService),\n    __param(3, IContextKeyService),\n    __param(4, IKeybindingService),\n    __param(5, IMenuService),\n    __param(6, IConfigurationService)\n], ContextMenuController);\nexport { ContextMenuController };\nclass ShowContextMenu extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showContextMenu',\n            label: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\n            alias: 'Show Editor Context Menu',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        var _a;\n        (_a = ContextMenuController.get(editor)) === null || _a === void 0 ? void 0 : _a.showContextMenu();\n    }\n}\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController);\nregisterEditorAction(ShowContextMenu);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nclass CursorState {\n    constructor(selections) {\n        this.selections = selections;\n    }\n    equals(other) {\n        const thisLen = this.selections.length;\n        const otherLen = other.selections.length;\n        if (thisLen !== otherLen) {\n            return false;\n        }\n        for (let i = 0; i < thisLen; i++) {\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\nclass StackElement {\n    constructor(cursorState, scrollTop, scrollLeft) {\n        this.cursorState = cursorState;\n        this.scrollTop = scrollTop;\n        this.scrollLeft = scrollLeft;\n    }\n}\nexport class CursorUndoRedoController extends Disposable {\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._isCursorUndoRedo = false;\n        this._undoStack = [];\n        this._redoStack = [];\n        this._register(editor.onDidChangeModel((e) => {\n            this._undoStack = [];\n            this._redoStack = [];\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            this._undoStack = [];\n            this._redoStack = [];\n        }));\n        this._register(editor.onDidChangeCursorSelection((e) => {\n            if (this._isCursorUndoRedo) {\n                return;\n            }\n            if (!e.oldSelections) {\n                return;\n            }\n            if (e.oldModelVersionId !== e.modelVersionId) {\n                return;\n            }\n            const prevState = new CursorState(e.oldSelections);\n            const isEqualToLastUndoStack = (this._undoStack.length > 0 && this._undoStack[this._undoStack.length - 1].cursorState.equals(prevState));\n            if (!isEqualToLastUndoStack) {\n                this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\n                this._redoStack = [];\n                if (this._undoStack.length > 50) {\n                    // keep the cursor undo stack bounded\n                    this._undoStack.shift();\n                }\n            }\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(CursorUndoRedoController.ID);\n    }\n    cursorUndo() {\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\n            return;\n        }\n        this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n        this._applyState(this._undoStack.pop());\n    }\n    cursorRedo() {\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\n            return;\n        }\n        this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n        this._applyState(this._redoStack.pop());\n    }\n    _applyState(stackElement) {\n        this._isCursorUndoRedo = true;\n        this._editor.setSelections(stackElement.cursorState.selections);\n        this._editor.setScrollPosition({\n            scrollTop: stackElement.scrollTop,\n            scrollLeft: stackElement.scrollLeft\n        });\n        this._isCursorUndoRedo = false;\n    }\n}\nCursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\nexport class CursorUndo extends EditorAction {\n    constructor() {\n        super({\n            id: 'cursorUndo',\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\n            alias: 'Cursor Undo',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 51 /* KeyCode.KeyU */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        (_a = CursorUndoRedoController.get(editor)) === null || _a === void 0 ? void 0 : _a.cursorUndo();\n    }\n}\nexport class CursorRedo extends EditorAction {\n    constructor() {\n        super({\n            id: 'cursorRedo',\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\n            alias: 'Cursor Redo',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        (_a = CursorUndoRedoController.get(editor)) === null || _a === void 0 ? void 0 : _a.cursorRedo();\n    }\n}\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController);\nregisterEditorAction(CursorUndo);\nregisterEditorAction(CursorRedo);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class DragAndDropCommand {\n    constructor(selection, targetPosition, copy) {\n        this.selection = selection;\n        this.targetPosition = targetPosition;\n        this.copy = copy;\n        this.targetSelection = null;\n    }\n    getEditOperations(model, builder) {\n        const text = model.getValueInRange(this.selection);\n        if (!this.copy) {\n            builder.addEditOperation(this.selection, null);\n        }\n        builder.addEditOperation(new Range(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column), text);\n        if (this.selection.containsPosition(this.targetPosition) && !(this.copy && (this.selection.getEndPosition().equals(this.targetPosition) || this.selection.getStartPosition().equals(this.targetPosition)) // we allow users to paste content beside the selection\n        )) {\n            this.targetSelection = this.selection;\n            return;\n        }\n        if (this.copy) {\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.selection.endLineNumber - this.selection.startLineNumber + this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        if (this.targetPosition.lineNumber > this.selection.endLineNumber) {\n            // Drag the selection downwards\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        if (this.targetPosition.lineNumber < this.selection.endLineNumber) {\n            // Drag the selection upwards\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber + this.selection.endLineNumber - this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        // The target position is at the same line as the selection's end position.\n        if (this.selection.endColumn <= this.targetPosition.column) {\n            // The target position is after the selection's end position\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn :\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column :\n                this.selection.endColumn);\n        }\n        else {\n            // The target position is before the selection's end position. Since the selection doesn't contain the target position, the selection is one-line and target position is before this selection.\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column + this.selection.endColumn - this.selection.startColumn);\n        }\n    }\n    computeCursorState(model, helper) {\n        return this.targetSelection;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { isMacintosh } from '../../../../base/common/platform.js';\nimport './dnd.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { DragAndDropCommand } from './dragAndDropCommand.js';\nfunction hasTriggerModifier(e) {\n    if (isMacintosh) {\n        return e.altKey;\n    }\n    else {\n        return e.ctrlKey;\n    }\n}\nexport class DragAndDropController extends Disposable {\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._dndDecorationIds = this._editor.createDecorationsCollection();\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\n        this._register(this._editor.onMouseDrag((e) => this._onEditorMouseDrag(e)));\n        this._register(this._editor.onMouseDrop((e) => this._onEditorMouseDrop(e)));\n        this._register(this._editor.onMouseDropCanceled(() => this._onEditorMouseDropCanceled()));\n        this._register(this._editor.onKeyDown((e) => this.onEditorKeyDown(e)));\n        this._register(this._editor.onKeyUp((e) => this.onEditorKeyUp(e)));\n        this._register(this._editor.onDidBlurEditorWidget(() => this.onEditorBlur()));\n        this._register(this._editor.onDidBlurEditorText(() => this.onEditorBlur()));\n        this._mouseDown = false;\n        this._modifierPressed = false;\n        this._dragSelection = null;\n    }\n    onEditorBlur() {\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n        this._modifierPressed = false;\n    }\n    onEditorKeyDown(e) {\n        if (!this._editor.getOption(31 /* EditorOption.dragAndDrop */) || this._editor.getOption(18 /* EditorOption.columnSelection */)) {\n            return;\n        }\n        if (hasTriggerModifier(e)) {\n            this._modifierPressed = true;\n        }\n        if (this._mouseDown && hasTriggerModifier(e)) {\n            this._editor.updateOptions({\n                mouseStyle: 'copy'\n            });\n        }\n    }\n    onEditorKeyUp(e) {\n        if (!this._editor.getOption(31 /* EditorOption.dragAndDrop */) || this._editor.getOption(18 /* EditorOption.columnSelection */)) {\n            return;\n        }\n        if (hasTriggerModifier(e)) {\n            this._modifierPressed = false;\n        }\n        if (this._mouseDown && e.keyCode === DragAndDropController.TRIGGER_KEY_VALUE) {\n            this._editor.updateOptions({\n                mouseStyle: 'default'\n            });\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._mouseDown = true;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        this._mouseDown = false;\n        // Whenever users release the mouse, the drag and drop operation should finish and the cursor should revert to text.\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n    }\n    _onEditorMouseDrag(mouseEvent) {\n        const target = mouseEvent.target;\n        if (this._dragSelection === null) {\n            const selections = this._editor.getSelections() || [];\n            const possibleSelections = selections.filter(selection => target.position && selection.containsPosition(target.position));\n            if (possibleSelections.length === 1) {\n                this._dragSelection = possibleSelections[0];\n            }\n            else {\n                return;\n            }\n        }\n        if (hasTriggerModifier(mouseEvent.event)) {\n            this._editor.updateOptions({\n                mouseStyle: 'copy'\n            });\n        }\n        else {\n            this._editor.updateOptions({\n                mouseStyle: 'default'\n            });\n        }\n        if (target.position) {\n            if (this._dragSelection.containsPosition(target.position)) {\n                this._removeDecoration();\n            }\n            else {\n                this.showAt(target.position);\n            }\n        }\n    }\n    _onEditorMouseDropCanceled() {\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n    }\n    _onEditorMouseDrop(mouseEvent) {\n        if (mouseEvent.target && (this._hitContent(mouseEvent.target) || this._hitMargin(mouseEvent.target)) && mouseEvent.target.position) {\n            const newCursorPosition = new Position(mouseEvent.target.position.lineNumber, mouseEvent.target.position.column);\n            if (this._dragSelection === null) {\n                let newSelections = null;\n                if (mouseEvent.event.shiftKey) {\n                    const primarySelection = this._editor.getSelection();\n                    if (primarySelection) {\n                        const { selectionStartLineNumber, selectionStartColumn } = primarySelection;\n                        newSelections = [new Selection(selectionStartLineNumber, selectionStartColumn, newCursorPosition.lineNumber, newCursorPosition.column)];\n                    }\n                }\n                else {\n                    newSelections = (this._editor.getSelections() || []).map(selection => {\n                        if (selection.containsPosition(newCursorPosition)) {\n                            return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\n                        }\n                        else {\n                            return selection;\n                        }\n                    });\n                }\n                // Use `mouse` as the source instead of `api` and setting the reason to explicit (to behave like any other mouse operation).\n                this._editor.setSelections(newSelections || [], 'mouse', 3 /* CursorChangeReason.Explicit */);\n            }\n            else if (!this._dragSelection.containsPosition(newCursorPosition) ||\n                ((hasTriggerModifier(mouseEvent.event) ||\n                    this._modifierPressed) && (this._dragSelection.getEndPosition().equals(newCursorPosition) || this._dragSelection.getStartPosition().equals(newCursorPosition)) // we allow users to paste content beside the selection\n                )) {\n                this._editor.pushUndoStop();\n                this._editor.executeCommand(DragAndDropController.ID, new DragAndDropCommand(this._dragSelection, newCursorPosition, hasTriggerModifier(mouseEvent.event) || this._modifierPressed));\n                this._editor.pushUndoStop();\n            }\n        }\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n    }\n    showAt(position) {\n        this._dndDecorationIds.set([{\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\n                options: DragAndDropController._DECORATION_OPTIONS\n            }]);\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n    }\n    _removeDecoration() {\n        this._dndDecorationIds.clear();\n    }\n    _hitContent(target) {\n        return target.type === 6 /* MouseTargetType.CONTENT_TEXT */ ||\n            target.type === 7 /* MouseTargetType.CONTENT_EMPTY */;\n    }\n    _hitMargin(target) {\n        return target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ ||\n            target.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */ ||\n            target.type === 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */;\n    }\n    dispose() {\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n        this._modifierPressed = false;\n        super.dispose();\n    }\n}\nDragAndDropController.ID = 'editor.contrib.dragAndDrop';\nDragAndDropController.TRIGGER_KEY_VALUE = isMacintosh ? 6 /* KeyCode.Alt */ : 5 /* KeyCode.Ctrl */;\nDragAndDropController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'dnd-target',\n    className: 'dnd-target'\n});\nregisterEditorContribution(DragAndDropController.ID, DragAndDropController);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { raceCancellation } from '../../../../base/common/async.js';\nimport { VSDataTransfer } from '../../../../base/common/dataTransfer.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../base/common/mime.js';\nimport { relativePath } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { addExternalEditorsDropData, toVSDataTransfer, UriList } from '../../../browser/dnd.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService, ResourceEdit } from '../../../browser/services/bulkEditService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { performSnippetEdit } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { localize } from '../../../../nls.js';\nimport { IProgressService } from '../../../../platform/progress/common/progress.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nlet DropIntoEditorController = class DropIntoEditorController extends Disposable {\n    constructor(editor, _bulkEditService, _languageFeaturesService, _progressService, workspaceContextService) {\n        super();\n        this._bulkEditService = _bulkEditService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._progressService = _progressService;\n        this._register(editor.onDropIntoEditor(e => this.onDropIntoEditor(editor, e.position, e.event)));\n        this._languageFeaturesService.documentOnDropEditProvider.register('*', new DefaultOnDropProvider(workspaceContextService));\n    }\n    onDropIntoEditor(editor, position, dragEvent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!dragEvent.dataTransfer || !editor.hasModel()) {\n                return;\n            }\n            const model = editor.getModel();\n            const initialModelVersion = model.getVersionId();\n            const ourDataTransfer = yield this.extractDataTransferData(dragEvent);\n            if (ourDataTransfer.size === 0) {\n                return;\n            }\n            if (editor.getModel().getVersionId() !== initialModelVersion) {\n                return;\n            }\n            const tokenSource = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */);\n            try {\n                const providers = this._languageFeaturesService.documentOnDropEditProvider.ordered(model);\n                const edit = yield this._progressService.withProgress({\n                    location: 15 /* ProgressLocation.Notification */,\n                    delay: 750,\n                    title: localize('dropProgressTitle', \"Running drop handlers...\"),\n                    cancellable: true,\n                }, () => {\n                    return raceCancellation((() => __awaiter(this, void 0, void 0, function* () {\n                        for (const provider of providers) {\n                            const edit = yield provider.provideDocumentOnDropEdits(model, position, ourDataTransfer, tokenSource.token);\n                            if (tokenSource.token.isCancellationRequested) {\n                                return undefined;\n                            }\n                            if (edit) {\n                                return edit;\n                            }\n                        }\n                        return undefined;\n                    }))(), tokenSource.token);\n                }, () => {\n                    tokenSource.cancel();\n                });\n                if (tokenSource.token.isCancellationRequested || editor.getModel().getVersionId() !== initialModelVersion) {\n                    return;\n                }\n                if (edit) {\n                    const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n                    performSnippetEdit(editor, typeof edit.insertText === 'string' ? SnippetParser.escape(edit.insertText) : edit.insertText.snippet, [Selection.fromRange(range, 0 /* SelectionDirection.LTR */)]);\n                    if (edit.additionalEdit) {\n                        yield this._bulkEditService.apply(ResourceEdit.convert(edit.additionalEdit), { editor });\n                    }\n                    return;\n                }\n            }\n            finally {\n                tokenSource.dispose();\n            }\n        });\n    }\n    extractDataTransferData(dragEvent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!dragEvent.dataTransfer) {\n                return new VSDataTransfer();\n            }\n            const textEditorDataTransfer = toVSDataTransfer(dragEvent.dataTransfer);\n            addExternalEditorsDropData(textEditorDataTransfer, dragEvent);\n            return textEditorDataTransfer;\n        });\n    }\n};\nDropIntoEditorController.ID = 'editor.contrib.dropIntoEditorController';\nDropIntoEditorController = __decorate([\n    __param(1, IBulkEditService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IProgressService),\n    __param(4, IWorkspaceContextService)\n], DropIntoEditorController);\nexport { DropIntoEditorController };\nlet DefaultOnDropProvider = class DefaultOnDropProvider {\n    constructor(_workspaceContextService) {\n        this._workspaceContextService = _workspaceContextService;\n    }\n    provideDocumentOnDropEdits(_model, _position, dataTransfer, _token) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            const urlListEntry = dataTransfer.get(Mimes.uriList);\n            if (urlListEntry) {\n                const urlList = yield urlListEntry.asString();\n                const snippet = this.getUriListInsertText(urlList);\n                if (snippet) {\n                    return { insertText: snippet };\n                }\n            }\n            const textEntry = (_a = dataTransfer.get('text')) !== null && _a !== void 0 ? _a : dataTransfer.get(Mimes.text);\n            if (textEntry) {\n                const text = yield textEntry.asString();\n                return { insertText: text };\n            }\n            return undefined;\n        });\n    }\n    getUriListInsertText(strUriList) {\n        const uris = [];\n        for (const resource of UriList.parse(strUriList)) {\n            try {\n                uris.push(URI.parse(resource));\n            }\n            catch (_a) {\n                // noop\n            }\n        }\n        if (!uris.length) {\n            return;\n        }\n        return uris\n            .map(uri => {\n            const root = this._workspaceContextService.getWorkspaceFolder(uri);\n            if (root) {\n                const rel = relativePath(root.uri, uri);\n                if (rel) {\n                    return rel;\n                }\n            }\n            return uri.fsPath;\n        })\n            .join(' ');\n    }\n};\nDefaultOnDropProvider = __decorate([\n    __param(0, IWorkspaceContextService)\n], DefaultOnDropProvider);\nregisterEditorContribution(DropIntoEditorController.ID, DropIntoEditorController);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { MinimapPosition, OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { minimapFindMatch, overviewRulerFindMatchForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nexport class FindDecorations {\n    constructor(editor) {\n        this._editor = editor;\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n        this._startPosition = this._editor.getPosition();\n    }\n    dispose() {\n        this._editor.removeDecorations(this._allDecorations());\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n    }\n    reset() {\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n    }\n    getCount() {\n        return this._decorations.length;\n    }\n    /** @deprecated use getFindScopes to support multiple selections */\n    getFindScope() {\n        if (this._findScopeDecorationIds[0]) {\n            return this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]);\n        }\n        return null;\n    }\n    getFindScopes() {\n        if (this._findScopeDecorationIds.length) {\n            const scopes = this._findScopeDecorationIds.map(findScopeDecorationId => this._editor.getModel().getDecorationRange(findScopeDecorationId)).filter(element => !!element);\n            if (scopes.length) {\n                return scopes;\n            }\n        }\n        return null;\n    }\n    getStartPosition() {\n        return this._startPosition;\n    }\n    setStartPosition(newStartPosition) {\n        this._startPosition = newStartPosition;\n        this.setCurrentFindMatch(null);\n    }\n    _getDecorationIndex(decorationId) {\n        const index = this._decorations.indexOf(decorationId);\n        if (index >= 0) {\n            return index + 1;\n        }\n        return 1;\n    }\n    getCurrentMatchesPosition(desiredRange) {\n        const candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\n        for (const candidate of candidates) {\n            const candidateOpts = candidate.options;\n            if (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\n                return this._getDecorationIndex(candidate.id);\n            }\n        }\n        // We don't know the current match position, so returns zero to show '?' in find widget\n        return 0;\n    }\n    setCurrentFindMatch(nextMatch) {\n        let newCurrentDecorationId = null;\n        let matchPosition = 0;\n        if (nextMatch) {\n            for (let i = 0, len = this._decorations.length; i < len; i++) {\n                const range = this._editor.getModel().getDecorationRange(this._decorations[i]);\n                if (nextMatch.equalsRange(range)) {\n                    newCurrentDecorationId = this._decorations[i];\n                    matchPosition = (i + 1);\n                    break;\n                }\n            }\n        }\n        if (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\n            this._editor.changeDecorations((changeAccessor) => {\n                if (this._highlightedDecorationId !== null) {\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\n                    this._highlightedDecorationId = null;\n                }\n                if (newCurrentDecorationId !== null) {\n                    this._highlightedDecorationId = newCurrentDecorationId;\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\n                }\n                if (this._rangeHighlightDecorationId !== null) {\n                    changeAccessor.removeDecoration(this._rangeHighlightDecorationId);\n                    this._rangeHighlightDecorationId = null;\n                }\n                if (newCurrentDecorationId !== null) {\n                    let rng = this._editor.getModel().getDecorationRange(newCurrentDecorationId);\n                    if (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\n                        const lineBeforeEnd = rng.endLineNumber - 1;\n                        const lineBeforeEndMaxColumn = this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\n                        rng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\n                    }\n                    this._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\n                }\n            });\n        }\n        return matchPosition;\n    }\n    set(findMatches, findScopes) {\n        this._editor.changeDecorations((accessor) => {\n            let findMatchesOptions = FindDecorations._FIND_MATCH_DECORATION;\n            const newOverviewRulerApproximateDecorations = [];\n            if (findMatches.length > 1000) {\n                // we go into a mode where the overview ruler gets \"approximate\" decorations\n                // the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\n                findMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\n                // approximate a distance in lines where matches should be merged\n                const lineCount = this._editor.getModel().getLineCount();\n                const height = this._editor.getLayoutInfo().height;\n                const approxPixelsPerLine = height / lineCount;\n                const mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\n                // merge decorations as much as possible\n                let prevStartLineNumber = findMatches[0].range.startLineNumber;\n                let prevEndLineNumber = findMatches[0].range.endLineNumber;\n                for (let i = 1, len = findMatches.length; i < len; i++) {\n                    const range = findMatches[i].range;\n                    if (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\n                        if (range.endLineNumber > prevEndLineNumber) {\n                            prevEndLineNumber = range.endLineNumber;\n                        }\n                    }\n                    else {\n                        newOverviewRulerApproximateDecorations.push({\n                            range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n                            options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n                        });\n                        prevStartLineNumber = range.startLineNumber;\n                        prevEndLineNumber = range.endLineNumber;\n                    }\n                }\n                newOverviewRulerApproximateDecorations.push({\n                    range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n                    options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n                });\n            }\n            // Find matches\n            const newFindMatchesDecorations = new Array(findMatches.length);\n            for (let i = 0, len = findMatches.length; i < len; i++) {\n                newFindMatchesDecorations[i] = {\n                    range: findMatches[i].range,\n                    options: findMatchesOptions\n                };\n            }\n            this._decorations = accessor.deltaDecorations(this._decorations, newFindMatchesDecorations);\n            // Overview ruler approximate decorations\n            this._overviewRulerApproximateDecorations = accessor.deltaDecorations(this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\n            // Range highlight\n            if (this._rangeHighlightDecorationId) {\n                accessor.removeDecoration(this._rangeHighlightDecorationId);\n                this._rangeHighlightDecorationId = null;\n            }\n            // Find scope\n            if (this._findScopeDecorationIds.length) {\n                this._findScopeDecorationIds.forEach(findScopeDecorationId => accessor.removeDecoration(findScopeDecorationId));\n                this._findScopeDecorationIds = [];\n            }\n            if (findScopes === null || findScopes === void 0 ? void 0 : findScopes.length) {\n                this._findScopeDecorationIds = findScopes.map(findScope => accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION));\n            }\n        });\n    }\n    matchBeforePosition(position) {\n        if (this._decorations.length === 0) {\n            return null;\n        }\n        for (let i = this._decorations.length - 1; i >= 0; i--) {\n            const decorationId = this._decorations[i];\n            const r = this._editor.getModel().getDecorationRange(decorationId);\n            if (!r || r.endLineNumber > position.lineNumber) {\n                continue;\n            }\n            if (r.endLineNumber < position.lineNumber) {\n                return r;\n            }\n            if (r.endColumn > position.column) {\n                continue;\n            }\n            return r;\n        }\n        return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\n    }\n    matchAfterPosition(position) {\n        if (this._decorations.length === 0) {\n            return null;\n        }\n        for (let i = 0, len = this._decorations.length; i < len; i++) {\n            const decorationId = this._decorations[i];\n            const r = this._editor.getModel().getDecorationRange(decorationId);\n            if (!r || r.startLineNumber < position.lineNumber) {\n                continue;\n            }\n            if (r.startLineNumber > position.lineNumber) {\n                return r;\n            }\n            if (r.startColumn < position.column) {\n                continue;\n            }\n            return r;\n        }\n        return this._editor.getModel().getDecorationRange(this._decorations[0]);\n    }\n    _allDecorations() {\n        let result = [];\n        result = result.concat(this._decorations);\n        result = result.concat(this._overviewRulerApproximateDecorations);\n        if (this._findScopeDecorationIds.length) {\n            result.push(...this._findScopeDecorationIds);\n        }\n        if (this._rangeHighlightDecorationId) {\n            result.push(this._rangeHighlightDecorationId);\n        }\n        return result;\n    }\n}\nFindDecorations._CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n    description: 'current-find-match',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    zIndex: 13,\n    className: 'currentFindMatch',\n    showIfCollapsed: true,\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerFindMatchForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapFindMatch),\n        position: MinimapPosition.Inline\n    }\n});\nFindDecorations._FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    zIndex: 10,\n    className: 'findMatch',\n    showIfCollapsed: true,\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerFindMatchForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapFindMatch),\n        position: MinimapPosition.Inline\n    }\n});\nFindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match-no-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'findMatch',\n    showIfCollapsed: true\n});\nFindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match-only-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerFindMatchForeground),\n        position: OverviewRulerLane.Center\n    }\n});\nFindDecorations._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\n    description: 'find-range-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'rangeHighlight',\n    isWholeLine: true\n});\nFindDecorations._FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\n    description: 'find-scope',\n    className: 'findScope',\n    isWholeLine: true\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nexport class ReplaceAllCommand {\n    constructor(editorSelection, ranges, replaceStrings) {\n        this._editorSelection = editorSelection;\n        this._ranges = ranges;\n        this._replaceStrings = replaceStrings;\n        this._trackedEditorSelectionId = null;\n    }\n    getEditOperations(model, builder) {\n        if (this._ranges.length > 0) {\n            // Collect all edit operations\n            const ops = [];\n            for (let i = 0; i < this._ranges.length; i++) {\n                ops.push({\n                    range: this._ranges[i],\n                    text: this._replaceStrings[i]\n                });\n            }\n            // Sort them in ascending order by range starts\n            ops.sort((o1, o2) => {\n                return Range.compareRangesUsingStarts(o1.range, o2.range);\n            });\n            // Merge operations that touch each other\n            const resultOps = [];\n            let previousOp = ops[0];\n            for (let i = 1; i < ops.length; i++) {\n                if (previousOp.range.endLineNumber === ops[i].range.startLineNumber && previousOp.range.endColumn === ops[i].range.startColumn) {\n                    // These operations are one after another and can be merged\n                    previousOp.range = previousOp.range.plusRange(ops[i].range);\n                    previousOp.text = previousOp.text + ops[i].text;\n                }\n                else {\n                    resultOps.push(previousOp);\n                    previousOp = ops[i];\n                }\n            }\n            resultOps.push(previousOp);\n            for (const op of resultOps) {\n                builder.addEditOperation(op.range, op.text);\n            }\n        }\n        this._trackedEditorSelectionId = builder.trackSelection(this._editorSelection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._trackedEditorSelectionId);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from './strings.js';\nexport function buildReplaceStringWithCasePreserved(matches, pattern) {\n    if (matches && (matches[0] !== '')) {\n        const containsHyphens = validateSpecificSpecialCharacter(matches, pattern, '-');\n        const containsUnderscores = validateSpecificSpecialCharacter(matches, pattern, '_');\n        if (containsHyphens && !containsUnderscores) {\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '-');\n        }\n        else if (!containsHyphens && containsUnderscores) {\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '_');\n        }\n        if (matches[0].toUpperCase() === matches[0]) {\n            return pattern.toUpperCase();\n        }\n        else if (matches[0].toLowerCase() === matches[0]) {\n            return pattern.toLowerCase();\n        }\n        else if (strings.containsUppercaseCharacter(matches[0][0]) && pattern.length > 0) {\n            return pattern[0].toUpperCase() + pattern.substr(1);\n        }\n        else if (matches[0][0].toUpperCase() !== matches[0][0] && pattern.length > 0) {\n            return pattern[0].toLowerCase() + pattern.substr(1);\n        }\n        else {\n            // we don't understand its pattern yet.\n            return pattern;\n        }\n    }\n    else {\n        return pattern;\n    }\n}\nfunction validateSpecificSpecialCharacter(matches, pattern, specialCharacter) {\n    const doesContainSpecialCharacter = matches[0].indexOf(specialCharacter) !== -1 && pattern.indexOf(specialCharacter) !== -1;\n    return doesContainSpecialCharacter && matches[0].split(specialCharacter).length === pattern.split(specialCharacter).length;\n}\nfunction buildReplaceStringForSpecificSpecialCharacter(matches, pattern, specialCharacter) {\n    const splitPatternAtSpecialCharacter = pattern.split(specialCharacter);\n    const splitMatchAtSpecialCharacter = matches[0].split(specialCharacter);\n    let replaceString = '';\n    splitPatternAtSpecialCharacter.forEach((splitValue, index) => {\n        replaceString += buildReplaceStringWithCasePreserved([splitMatchAtSpecialCharacter[index]], splitValue) + specialCharacter;\n    });\n    return replaceString.slice(0, -1);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { buildReplaceStringWithCasePreserved } from '../../../../base/common/search.js';\n/**\n * Assigned when the replace pattern is entirely static.\n */\nclass StaticValueReplacePattern {\n    constructor(staticValue) {\n        this.staticValue = staticValue;\n        this.kind = 0 /* ReplacePatternKind.StaticValue */;\n    }\n}\n/**\n * Assigned when the replace pattern has replacement patterns.\n */\nclass DynamicPiecesReplacePattern {\n    constructor(pieces) {\n        this.pieces = pieces;\n        this.kind = 1 /* ReplacePatternKind.DynamicPieces */;\n    }\n}\nexport class ReplacePattern {\n    constructor(pieces) {\n        if (!pieces || pieces.length === 0) {\n            this._state = new StaticValueReplacePattern('');\n        }\n        else if (pieces.length === 1 && pieces[0].staticValue !== null) {\n            this._state = new StaticValueReplacePattern(pieces[0].staticValue);\n        }\n        else {\n            this._state = new DynamicPiecesReplacePattern(pieces);\n        }\n    }\n    static fromStaticValue(value) {\n        return new ReplacePattern([ReplacePiece.staticValue(value)]);\n    }\n    get hasReplacementPatterns() {\n        return (this._state.kind === 1 /* ReplacePatternKind.DynamicPieces */);\n    }\n    buildReplaceString(matches, preserveCase) {\n        if (this._state.kind === 0 /* ReplacePatternKind.StaticValue */) {\n            if (preserveCase) {\n                return buildReplaceStringWithCasePreserved(matches, this._state.staticValue);\n            }\n            else {\n                return this._state.staticValue;\n            }\n        }\n        let result = '';\n        for (let i = 0, len = this._state.pieces.length; i < len; i++) {\n            const piece = this._state.pieces[i];\n            if (piece.staticValue !== null) {\n                // static value ReplacePiece\n                result += piece.staticValue;\n                continue;\n            }\n            // match index ReplacePiece\n            let match = ReplacePattern._substitute(piece.matchIndex, matches);\n            if (piece.caseOps !== null && piece.caseOps.length > 0) {\n                const repl = [];\n                const lenOps = piece.caseOps.length;\n                let opIdx = 0;\n                for (let idx = 0, len = match.length; idx < len; idx++) {\n                    if (opIdx >= lenOps) {\n                        repl.push(match.slice(idx));\n                        break;\n                    }\n                    switch (piece.caseOps[opIdx]) {\n                        case 'U':\n                            repl.push(match[idx].toUpperCase());\n                            break;\n                        case 'u':\n                            repl.push(match[idx].toUpperCase());\n                            opIdx++;\n                            break;\n                        case 'L':\n                            repl.push(match[idx].toLowerCase());\n                            break;\n                        case 'l':\n                            repl.push(match[idx].toLowerCase());\n                            opIdx++;\n                            break;\n                        default:\n                            repl.push(match[idx]);\n                    }\n                }\n                match = repl.join('');\n            }\n            result += match;\n        }\n        return result;\n    }\n    static _substitute(matchIndex, matches) {\n        if (matches === null) {\n            return '';\n        }\n        if (matchIndex === 0) {\n            return matches[0];\n        }\n        let remainder = '';\n        while (matchIndex > 0) {\n            if (matchIndex < matches.length) {\n                // A match can be undefined\n                const match = (matches[matchIndex] || '');\n                return match + remainder;\n            }\n            remainder = String(matchIndex % 10) + remainder;\n            matchIndex = Math.floor(matchIndex / 10);\n        }\n        return '$' + remainder;\n    }\n}\n/**\n * A replace piece can either be a static string or an index to a specific match.\n */\nexport class ReplacePiece {\n    constructor(staticValue, matchIndex, caseOps) {\n        this.staticValue = staticValue;\n        this.matchIndex = matchIndex;\n        if (!caseOps || caseOps.length === 0) {\n            this.caseOps = null;\n        }\n        else {\n            this.caseOps = caseOps.slice(0);\n        }\n    }\n    static staticValue(value) {\n        return new ReplacePiece(value, -1, null);\n    }\n    static caseOps(index, caseOps) {\n        return new ReplacePiece(null, index, caseOps);\n    }\n}\nclass ReplacePieceBuilder {\n    constructor(source) {\n        this._source = source;\n        this._lastCharIndex = 0;\n        this._result = [];\n        this._resultLen = 0;\n        this._currentStaticPiece = '';\n    }\n    emitUnchanged(toCharIndex) {\n        this._emitStatic(this._source.substring(this._lastCharIndex, toCharIndex));\n        this._lastCharIndex = toCharIndex;\n    }\n    emitStatic(value, toCharIndex) {\n        this._emitStatic(value);\n        this._lastCharIndex = toCharIndex;\n    }\n    _emitStatic(value) {\n        if (value.length === 0) {\n            return;\n        }\n        this._currentStaticPiece += value;\n    }\n    emitMatchIndex(index, toCharIndex, caseOps) {\n        if (this._currentStaticPiece.length !== 0) {\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\n            this._currentStaticPiece = '';\n        }\n        this._result[this._resultLen++] = ReplacePiece.caseOps(index, caseOps);\n        this._lastCharIndex = toCharIndex;\n    }\n    finalize() {\n        this.emitUnchanged(this._source.length);\n        if (this._currentStaticPiece.length !== 0) {\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\n            this._currentStaticPiece = '';\n        }\n        return new ReplacePattern(this._result);\n    }\n}\n/**\n * \\n\t\t\t=> inserts a LF\n * \\t\t\t\t=> inserts a TAB\n * \\\\\t\t\t=> inserts a \"\\\".\n * \\u\t\t\t=> upper-cases one character in a match.\n * \\U\t\t\t=> upper-cases ALL remaining characters in a match.\n * \\l\t\t\t=> lower-cases one character in a match.\n * \\L\t\t\t=> lower-cases ALL remaining characters in a match.\n * $$\t\t\t=> inserts a \"$\".\n * $& and $0\t=> inserts the matched substring.\n * $n\t\t\t=> Where n is a non-negative integer lesser than 100, inserts the nth parenthesized submatch string\n * everything else stays untouched\n *\n * Also see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter\n */\nexport function parseReplaceString(replaceString) {\n    if (!replaceString || replaceString.length === 0) {\n        return new ReplacePattern(null);\n    }\n    const caseOps = [];\n    const result = new ReplacePieceBuilder(replaceString);\n    for (let i = 0, len = replaceString.length; i < len; i++) {\n        const chCode = replaceString.charCodeAt(i);\n        if (chCode === 92 /* CharCode.Backslash */) {\n            // move to next char\n            i++;\n            if (i >= len) {\n                // string ends with a \\\n                break;\n            }\n            const nextChCode = replaceString.charCodeAt(i);\n            // let replaceWithCharacter: string | null = null;\n            switch (nextChCode) {\n                case 92 /* CharCode.Backslash */:\n                    // \\\\ => inserts a \"\\\"\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\\\', i + 1);\n                    break;\n                case 110 /* CharCode.n */:\n                    // \\n => inserts a LF\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\n', i + 1);\n                    break;\n                case 116 /* CharCode.t */:\n                    // \\t => inserts a TAB\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\t', i + 1);\n                    break;\n                // Case modification of string replacements, patterned after Boost, but only applied\n                // to the replacement text, not subsequent content.\n                case 117 /* CharCode.u */:\n                // \\u => upper-cases one character.\n                case 85 /* CharCode.U */:\n                // \\U => upper-cases ALL following characters.\n                case 108 /* CharCode.l */:\n                // \\l => lower-cases one character.\n                case 76 /* CharCode.L */:\n                    // \\L => lower-cases ALL following characters.\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('', i + 1);\n                    caseOps.push(String.fromCharCode(nextChCode));\n                    break;\n            }\n            continue;\n        }\n        if (chCode === 36 /* CharCode.DollarSign */) {\n            // move to next char\n            i++;\n            if (i >= len) {\n                // string ends with a $\n                break;\n            }\n            const nextChCode = replaceString.charCodeAt(i);\n            if (nextChCode === 36 /* CharCode.DollarSign */) {\n                // $$ => inserts a \"$\"\n                result.emitUnchanged(i - 1);\n                result.emitStatic('$', i + 1);\n                continue;\n            }\n            if (nextChCode === 48 /* CharCode.Digit0 */ || nextChCode === 38 /* CharCode.Ampersand */) {\n                // $& and $0 => inserts the matched substring.\n                result.emitUnchanged(i - 1);\n                result.emitMatchIndex(0, i + 1, caseOps);\n                caseOps.length = 0;\n                continue;\n            }\n            if (49 /* CharCode.Digit1 */ <= nextChCode && nextChCode <= 57 /* CharCode.Digit9 */) {\n                // $n\n                let matchIndex = nextChCode - 48 /* CharCode.Digit0 */;\n                // peek next char to probe for $nn\n                if (i + 1 < len) {\n                    const nextNextChCode = replaceString.charCodeAt(i + 1);\n                    if (48 /* CharCode.Digit0 */ <= nextNextChCode && nextNextChCode <= 57 /* CharCode.Digit9 */) {\n                        // $nn\n                        // move to next char\n                        i++;\n                        matchIndex = matchIndex * 10 + (nextNextChCode - 48 /* CharCode.Digit0 */);\n                        result.emitUnchanged(i - 2);\n                        result.emitMatchIndex(matchIndex, i + 1, caseOps);\n                        caseOps.length = 0;\n                        continue;\n                    }\n                }\n                result.emitUnchanged(i - 1);\n                result.emitMatchIndex(matchIndex, i + 1, caseOps);\n                caseOps.length = 0;\n                continue;\n            }\n        }\n    }\n    return result.finalize();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstInSorted } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler, TimeoutTimer } from '../../../../base/common/async.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection } from '../../../common/commands/replaceCommand.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { SearchParams } from '../../../common/model/textModelSearch.js';\nimport { FindDecorations } from './findDecorations.js';\nimport { ReplaceAllCommand } from './replaceAllCommand.js';\nimport { parseReplaceString, ReplacePattern } from './replacePattern.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const CONTEXT_FIND_WIDGET_VISIBLE = new RawContextKey('findWidgetVisible', false);\nexport const CONTEXT_FIND_WIDGET_NOT_VISIBLE = CONTEXT_FIND_WIDGET_VISIBLE.toNegated();\n// Keep ContextKey use of 'Focussed' to not break when clauses\nexport const CONTEXT_FIND_INPUT_FOCUSED = new RawContextKey('findInputFocussed', false);\nexport const CONTEXT_REPLACE_INPUT_FOCUSED = new RawContextKey('replaceInputFocussed', false);\nexport const ToggleCaseSensitiveKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 33 /* KeyCode.KeyC */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 33 /* KeyCode.KeyC */ }\n};\nexport const ToggleWholeWordKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 53 /* KeyCode.KeyW */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 53 /* KeyCode.KeyW */ }\n};\nexport const ToggleRegexKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 48 /* KeyCode.KeyR */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 48 /* KeyCode.KeyR */ }\n};\nexport const ToggleSearchScopeKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 42 /* KeyCode.KeyL */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 42 /* KeyCode.KeyL */ }\n};\nexport const TogglePreserveCaseKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 46 /* KeyCode.KeyP */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 46 /* KeyCode.KeyP */ }\n};\nexport const FIND_IDS = {\n    StartFindAction: 'actions.find',\n    StartFindWithSelection: 'actions.findWithSelection',\n    StartFindWithArgs: 'editor.actions.findWithArgs',\n    NextMatchFindAction: 'editor.action.nextMatchFindAction',\n    PreviousMatchFindAction: 'editor.action.previousMatchFindAction',\n    NextSelectionMatchFindAction: 'editor.action.nextSelectionMatchFindAction',\n    PreviousSelectionMatchFindAction: 'editor.action.previousSelectionMatchFindAction',\n    StartFindReplaceAction: 'editor.action.startFindReplaceAction',\n    CloseFindWidgetCommand: 'closeFindWidget',\n    ToggleCaseSensitiveCommand: 'toggleFindCaseSensitive',\n    ToggleWholeWordCommand: 'toggleFindWholeWord',\n    ToggleRegexCommand: 'toggleFindRegex',\n    ToggleSearchScopeCommand: 'toggleFindInSelection',\n    TogglePreserveCaseCommand: 'togglePreserveCase',\n    ReplaceOneAction: 'editor.action.replaceOne',\n    ReplaceAllAction: 'editor.action.replaceAll',\n    SelectAllMatchesAction: 'editor.action.selectAllMatches'\n};\nexport const MATCHES_LIMIT = 19999;\nconst RESEARCH_DELAY = 240;\nexport class FindModelBoundToEditorModel {\n    constructor(editor, state) {\n        this._toDispose = new DisposableStore();\n        this._editor = editor;\n        this._state = state;\n        this._isDisposed = false;\n        this._startSearchingTimer = new TimeoutTimer();\n        this._decorations = new FindDecorations(editor);\n        this._toDispose.add(this._decorations);\n        this._updateDecorationsScheduler = new RunOnceScheduler(() => this.research(false), 100);\n        this._toDispose.add(this._updateDecorationsScheduler);\n        this._toDispose.add(this._editor.onDidChangeCursorPosition((e) => {\n            if (e.reason === 3 /* CursorChangeReason.Explicit */\n                || e.reason === 5 /* CursorChangeReason.Undo */\n                || e.reason === 6 /* CursorChangeReason.Redo */) {\n                this._decorations.setStartPosition(this._editor.getPosition());\n            }\n        }));\n        this._ignoreModelContentChanged = false;\n        this._toDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (this._ignoreModelContentChanged) {\n                return;\n            }\n            if (e.isFlush) {\n                // a model.setValue() was called\n                this._decorations.reset();\n            }\n            this._decorations.setStartPosition(this._editor.getPosition());\n            this._updateDecorationsScheduler.schedule();\n        }));\n        this._toDispose.add(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this.research(false, this._state.searchScope);\n    }\n    dispose() {\n        this._isDisposed = true;\n        dispose(this._startSearchingTimer);\n        this._toDispose.dispose();\n    }\n    _onStateChanged(e) {\n        if (this._isDisposed) {\n            // The find model is disposed during a find state changed event\n            return;\n        }\n        if (!this._editor.hasModel()) {\n            // The find model will be disposed momentarily\n            return;\n        }\n        if (e.searchString || e.isReplaceRevealed || e.isRegex || e.wholeWord || e.matchCase || e.searchScope) {\n            const model = this._editor.getModel();\n            if (model.isTooLargeForSyncing()) {\n                this._startSearchingTimer.cancel();\n                this._startSearchingTimer.setIfNotSet(() => {\n                    if (e.searchScope) {\n                        this.research(e.moveCursor, this._state.searchScope);\n                    }\n                    else {\n                        this.research(e.moveCursor);\n                    }\n                }, RESEARCH_DELAY);\n            }\n            else {\n                if (e.searchScope) {\n                    this.research(e.moveCursor, this._state.searchScope);\n                }\n                else {\n                    this.research(e.moveCursor);\n                }\n            }\n        }\n    }\n    static _getSearchRange(model, findScope) {\n        // If we have set now or before a find scope, use it for computing the search range\n        if (findScope) {\n            return findScope;\n        }\n        return model.getFullModelRange();\n    }\n    research(moveCursor, newFindScope) {\n        let findScopes = null;\n        if (typeof newFindScope !== 'undefined') {\n            if (newFindScope !== null) {\n                if (!Array.isArray(newFindScope)) {\n                    findScopes = [newFindScope];\n                }\n                else {\n                    findScopes = newFindScope;\n                }\n            }\n        }\n        else {\n            findScopes = this._decorations.getFindScopes();\n        }\n        if (findScopes !== null) {\n            findScopes = findScopes.map(findScope => {\n                if (findScope.startLineNumber !== findScope.endLineNumber) {\n                    let endLineNumber = findScope.endLineNumber;\n                    if (findScope.endColumn === 1) {\n                        endLineNumber = endLineNumber - 1;\n                    }\n                    return new Range(findScope.startLineNumber, 1, endLineNumber, this._editor.getModel().getLineMaxColumn(endLineNumber));\n                }\n                return findScope;\n            });\n        }\n        const findMatches = this._findMatches(findScopes, false, MATCHES_LIMIT);\n        this._decorations.set(findMatches, findScopes);\n        const editorSelection = this._editor.getSelection();\n        let currentMatchesPosition = this._decorations.getCurrentMatchesPosition(editorSelection);\n        if (currentMatchesPosition === 0 && findMatches.length > 0) {\n            // current selection is not on top of a match\n            // try to find its nearest result from the top of the document\n            const matchAfterSelection = findFirstInSorted(findMatches.map(match => match.range), range => Range.compareRangesUsingStarts(range, editorSelection) >= 0);\n            currentMatchesPosition = matchAfterSelection > 0 ? matchAfterSelection - 1 + 1 /** match position is one based */ : currentMatchesPosition;\n        }\n        this._state.changeMatchInfo(currentMatchesPosition, this._decorations.getCount(), undefined);\n        if (moveCursor && this._editor.getOption(37 /* EditorOption.find */).cursorMoveOnType) {\n            this._moveToNextMatch(this._decorations.getStartPosition());\n        }\n    }\n    _hasMatches() {\n        return (this._state.matchesCount > 0);\n    }\n    _cannotFind() {\n        if (!this._hasMatches()) {\n            const findScope = this._decorations.getFindScope();\n            if (findScope) {\n                // Reveal the selection so user is reminded that 'selection find' is on.\n                this._editor.revealRangeInCenterIfOutsideViewport(findScope, 0 /* ScrollType.Smooth */);\n            }\n            return true;\n        }\n        return false;\n    }\n    _setCurrentFindMatch(match) {\n        const matchesPosition = this._decorations.setCurrentFindMatch(match);\n        this._state.changeMatchInfo(matchesPosition, this._decorations.getCount(), match);\n        this._editor.setSelection(match);\n        this._editor.revealRangeInCenterIfOutsideViewport(match, 0 /* ScrollType.Smooth */);\n    }\n    _prevSearchPosition(before) {\n        const isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\n            || this._state.searchString.indexOf('$') >= 0);\n        let { lineNumber, column } = before;\n        const model = this._editor.getModel();\n        if (isUsingLineStops || column === 1) {\n            if (lineNumber === 1) {\n                lineNumber = model.getLineCount();\n            }\n            else {\n                lineNumber--;\n            }\n            column = model.getLineMaxColumn(lineNumber);\n        }\n        else {\n            column--;\n        }\n        return new Position(lineNumber, column);\n    }\n    _moveToPrevMatch(before, isRecursed = false) {\n        if (!this._state.canNavigateBack()) {\n            // we are beyond the first matched find result\n            // instead of doing nothing, we should refocus the first item\n            const nextMatchRange = this._decorations.matchAfterPosition(before);\n            if (nextMatchRange) {\n                this._setCurrentFindMatch(nextMatchRange);\n            }\n            return;\n        }\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\n            let prevMatchRange = this._decorations.matchBeforePosition(before);\n            if (prevMatchRange && prevMatchRange.isEmpty() && prevMatchRange.getStartPosition().equals(before)) {\n                before = this._prevSearchPosition(before);\n                prevMatchRange = this._decorations.matchBeforePosition(before);\n            }\n            if (prevMatchRange) {\n                this._setCurrentFindMatch(prevMatchRange);\n            }\n            return;\n        }\n        if (this._cannotFind()) {\n            return;\n        }\n        const findScope = this._decorations.getFindScope();\n        const searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\n        // ...(----)...|...\n        if (searchRange.getEndPosition().isBefore(before)) {\n            before = searchRange.getEndPosition();\n        }\n        // ...|...(----)...\n        if (before.isBefore(searchRange.getStartPosition())) {\n            before = searchRange.getEndPosition();\n        }\n        const { lineNumber, column } = before;\n        const model = this._editor.getModel();\n        let position = new Position(lineNumber, column);\n        let prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false);\n        if (prevMatch && prevMatch.range.isEmpty() && prevMatch.range.getStartPosition().equals(position)) {\n            // Looks like we're stuck at this position, unacceptable!\n            position = this._prevSearchPosition(position);\n            prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false);\n        }\n        if (!prevMatch) {\n            // there is precisely one match and selection is on top of it\n            return;\n        }\n        if (!isRecursed && !searchRange.containsRange(prevMatch.range)) {\n            return this._moveToPrevMatch(prevMatch.range.getStartPosition(), true);\n        }\n        this._setCurrentFindMatch(prevMatch.range);\n    }\n    moveToPrevMatch() {\n        this._moveToPrevMatch(this._editor.getSelection().getStartPosition());\n    }\n    _nextSearchPosition(after) {\n        const isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\n            || this._state.searchString.indexOf('$') >= 0);\n        let { lineNumber, column } = after;\n        const model = this._editor.getModel();\n        if (isUsingLineStops || column === model.getLineMaxColumn(lineNumber)) {\n            if (lineNumber === model.getLineCount()) {\n                lineNumber = 1;\n            }\n            else {\n                lineNumber++;\n            }\n            column = 1;\n        }\n        else {\n            column++;\n        }\n        return new Position(lineNumber, column);\n    }\n    _moveToNextMatch(after) {\n        if (!this._state.canNavigateForward()) {\n            // we are beyond the last matched find result\n            // instead of doing nothing, we should refocus the last item\n            const prevMatchRange = this._decorations.matchBeforePosition(after);\n            if (prevMatchRange) {\n                this._setCurrentFindMatch(prevMatchRange);\n            }\n            return;\n        }\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\n            let nextMatchRange = this._decorations.matchAfterPosition(after);\n            if (nextMatchRange && nextMatchRange.isEmpty() && nextMatchRange.getStartPosition().equals(after)) {\n                // Looks like we're stuck at this position, unacceptable!\n                after = this._nextSearchPosition(after);\n                nextMatchRange = this._decorations.matchAfterPosition(after);\n            }\n            if (nextMatchRange) {\n                this._setCurrentFindMatch(nextMatchRange);\n            }\n            return;\n        }\n        const nextMatch = this._getNextMatch(after, false, true);\n        if (nextMatch) {\n            this._setCurrentFindMatch(nextMatch.range);\n        }\n    }\n    _getNextMatch(after, captureMatches, forceMove, isRecursed = false) {\n        if (this._cannotFind()) {\n            return null;\n        }\n        const findScope = this._decorations.getFindScope();\n        const searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\n        // ...(----)...|...\n        if (searchRange.getEndPosition().isBefore(after)) {\n            after = searchRange.getStartPosition();\n        }\n        // ...|...(----)...\n        if (after.isBefore(searchRange.getStartPosition())) {\n            after = searchRange.getStartPosition();\n        }\n        const { lineNumber, column } = after;\n        const model = this._editor.getModel();\n        let position = new Position(lineNumber, column);\n        let nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, captureMatches);\n        if (forceMove && nextMatch && nextMatch.range.isEmpty() && nextMatch.range.getStartPosition().equals(position)) {\n            // Looks like we're stuck at this position, unacceptable!\n            position = this._nextSearchPosition(position);\n            nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, captureMatches);\n        }\n        if (!nextMatch) {\n            // there is precisely one match and selection is on top of it\n            return null;\n        }\n        if (!isRecursed && !searchRange.containsRange(nextMatch.range)) {\n            return this._getNextMatch(nextMatch.range.getEndPosition(), captureMatches, forceMove, true);\n        }\n        return nextMatch;\n    }\n    moveToNextMatch() {\n        this._moveToNextMatch(this._editor.getSelection().getEndPosition());\n    }\n    _getReplacePattern() {\n        if (this._state.isRegex) {\n            return parseReplaceString(this._state.replaceString);\n        }\n        return ReplacePattern.fromStaticValue(this._state.replaceString);\n    }\n    replace() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const replacePattern = this._getReplacePattern();\n        const selection = this._editor.getSelection();\n        const nextMatch = this._getNextMatch(selection.getStartPosition(), true, false);\n        if (nextMatch) {\n            if (selection.equalsRange(nextMatch.range)) {\n                // selection sits on a find match => replace it!\n                const replaceString = replacePattern.buildReplaceString(nextMatch.matches, this._state.preserveCase);\n                const command = new ReplaceCommand(selection, replaceString);\n                this._executeEditorCommand('replace', command);\n                this._decorations.setStartPosition(new Position(selection.startLineNumber, selection.startColumn + replaceString.length));\n                this.research(true);\n            }\n            else {\n                this._decorations.setStartPosition(this._editor.getPosition());\n                this._setCurrentFindMatch(nextMatch.range);\n            }\n        }\n    }\n    _findMatches(findScopes, captureMatches, limitResultCount) {\n        const searchRanges = (findScopes || [null]).map((scope) => FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), scope));\n        return this._editor.getModel().findMatches(this._state.searchString, searchRanges, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, captureMatches, limitResultCount);\n    }\n    replaceAll() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const findScopes = this._decorations.getFindScopes();\n        if (findScopes === null && this._state.matchesCount >= MATCHES_LIMIT) {\n            // Doing a replace on the entire file that is over ${MATCHES_LIMIT} matches\n            this._largeReplaceAll();\n        }\n        else {\n            this._regularReplaceAll(findScopes);\n        }\n        this.research(false);\n    }\n    _largeReplaceAll() {\n        const searchParams = new SearchParams(this._state.searchString, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null);\n        const searchData = searchParams.parseSearchRequest();\n        if (!searchData) {\n            return;\n        }\n        let searchRegex = searchData.regex;\n        if (!searchRegex.multiline) {\n            let mod = 'mu';\n            if (searchRegex.ignoreCase) {\n                mod += 'i';\n            }\n            if (searchRegex.global) {\n                mod += 'g';\n            }\n            searchRegex = new RegExp(searchRegex.source, mod);\n        }\n        const model = this._editor.getModel();\n        const modelText = model.getValue(1 /* EndOfLinePreference.LF */);\n        const fullModelRange = model.getFullModelRange();\n        const replacePattern = this._getReplacePattern();\n        let resultText;\n        const preserveCase = this._state.preserveCase;\n        if (replacePattern.hasReplacementPatterns || preserveCase) {\n            resultText = modelText.replace(searchRegex, function () {\n                return replacePattern.buildReplaceString(arguments, preserveCase);\n            });\n        }\n        else {\n            resultText = modelText.replace(searchRegex, replacePattern.buildReplaceString(null, preserveCase));\n        }\n        const command = new ReplaceCommandThatPreservesSelection(fullModelRange, resultText, this._editor.getSelection());\n        this._executeEditorCommand('replaceAll', command);\n    }\n    _regularReplaceAll(findScopes) {\n        const replacePattern = this._getReplacePattern();\n        // Get all the ranges (even more than the highlighted ones)\n        const matches = this._findMatches(findScopes, replacePattern.hasReplacementPatterns || this._state.preserveCase, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const replaceStrings = [];\n        for (let i = 0, len = matches.length; i < len; i++) {\n            replaceStrings[i] = replacePattern.buildReplaceString(matches[i].matches, this._state.preserveCase);\n        }\n        const command = new ReplaceAllCommand(this._editor.getSelection(), matches.map(m => m.range), replaceStrings);\n        this._executeEditorCommand('replaceAll', command);\n    }\n    selectAllMatches() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const findScopes = this._decorations.getFindScopes();\n        // Get all the ranges (even more than the highlighted ones)\n        const matches = this._findMatches(findScopes, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        let selections = matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn));\n        // If one of the ranges is the editor selection, then maintain it as primary\n        const editorSelection = this._editor.getSelection();\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const sel = selections[i];\n            if (sel.equalsRange(editorSelection)) {\n                selections = [editorSelection].concat(selections.slice(0, i)).concat(selections.slice(i + 1));\n                break;\n            }\n        }\n        this._editor.setSelections(selections);\n    }\n    _executeEditorCommand(source, command) {\n        try {\n            this._ignoreModelContentChanged = true;\n            this._editor.pushUndoStop();\n            this._editor.executeCommand(source, command);\n            this._editor.pushUndoStop();\n        }\n        finally {\n            this._ignoreModelContentChanged = false;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { CaseSensitiveToggle, RegexToggle, WholeWordsToggle } from '../../../../base/browser/ui/findinput/findInputToggles.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { FIND_IDS } from './findModel.js';\nimport { contrastBorder, editorWidgetBackground, editorWidgetForeground, inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nexport class FindOptionsWidget extends Widget {\n    constructor(editor, state, keybindingService, themeService) {\n        super();\n        this._hideSoon = this._register(new RunOnceScheduler(() => this._hide(), 2000));\n        this._isVisible = false;\n        this._editor = editor;\n        this._state = state;\n        this._keybindingService = keybindingService;\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'findOptionsWidget';\n        this._domNode.style.display = 'none';\n        this._domNode.style.top = '10px';\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        const inputActiveOptionBorderColor = themeService.getColorTheme().getColor(inputActiveOptionBorder);\n        const inputActiveOptionForegroundColor = themeService.getColorTheme().getColor(inputActiveOptionForeground);\n        const inputActiveOptionBackgroundColor = themeService.getColorTheme().getColor(inputActiveOptionBackground);\n        this.caseSensitive = this._register(new CaseSensitiveToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n            isChecked: this._state.matchCase,\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\n            inputActiveOptionForeground: inputActiveOptionForegroundColor,\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\n        }));\n        this._domNode.appendChild(this.caseSensitive.domNode);\n        this._register(this.caseSensitive.onChange(() => {\n            this._state.change({\n                matchCase: this.caseSensitive.checked\n            }, false);\n        }));\n        this.wholeWords = this._register(new WholeWordsToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n            isChecked: this._state.wholeWord,\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\n            inputActiveOptionForeground: inputActiveOptionForegroundColor,\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\n        }));\n        this._domNode.appendChild(this.wholeWords.domNode);\n        this._register(this.wholeWords.onChange(() => {\n            this._state.change({\n                wholeWord: this.wholeWords.checked\n            }, false);\n        }));\n        this.regex = this._register(new RegexToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n            isChecked: this._state.isRegex,\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\n            inputActiveOptionForeground: inputActiveOptionForegroundColor,\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\n        }));\n        this._domNode.appendChild(this.regex.domNode);\n        this._register(this.regex.onChange(() => {\n            this._state.change({\n                isRegex: this.regex.checked\n            }, false);\n        }));\n        this._editor.addOverlayWidget(this);\n        this._register(this._state.onFindReplaceStateChange((e) => {\n            let somethingChanged = false;\n            if (e.isRegex) {\n                this.regex.checked = this._state.isRegex;\n                somethingChanged = true;\n            }\n            if (e.wholeWord) {\n                this.wholeWords.checked = this._state.wholeWord;\n                somethingChanged = true;\n            }\n            if (e.matchCase) {\n                this.caseSensitive.checked = this._state.matchCase;\n                somethingChanged = true;\n            }\n            if (!this._state.isRevealed && somethingChanged) {\n                this._revealTemporarily();\n            }\n        }));\n        this._register(dom.addDisposableListener(this._domNode, dom.EventType.MOUSE_LEAVE, (e) => this._onMouseLeave()));\n        this._register(dom.addDisposableListener(this._domNode, 'mouseover', (e) => this._onMouseOver()));\n        this._applyTheme(themeService.getColorTheme());\n        this._register(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n    }\n    _keybindingLabelFor(actionId) {\n        const kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return ` (${kb.getLabel()})`;\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return FindOptionsWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            preference: 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */\n        };\n    }\n    highlightFindOptions() {\n        this._revealTemporarily();\n    }\n    _revealTemporarily() {\n        this._show();\n        this._hideSoon.schedule();\n    }\n    _onMouseLeave() {\n        this._hideSoon.schedule();\n    }\n    _onMouseOver() {\n        this._hideSoon.cancel();\n    }\n    _show() {\n        if (this._isVisible) {\n            return;\n        }\n        this._isVisible = true;\n        this._domNode.style.display = 'block';\n    }\n    _hide() {\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._domNode.style.display = 'none';\n    }\n    _applyTheme(theme) {\n        const inputStyles = {\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\n            inputActiveOptionForeground: theme.getColor(inputActiveOptionForeground),\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground)\n        };\n        this.caseSensitive.style(inputStyles);\n        this.wholeWords.style(inputStyles);\n        this.regex.style(inputStyles);\n    }\n}\nFindOptionsWidget.ID = 'editor.contrib.findOptionsWidget';\nregisterThemingParticipant((theme, collector) => {\n    const widgetBackground = theme.getColor(editorWidgetBackground);\n    if (widgetBackground) {\n        collector.addRule(`.monaco-editor .findOptionsWidget { background-color: ${widgetBackground}; }`);\n    }\n    const widgetForeground = theme.getColor(editorWidgetForeground);\n    if (widgetForeground) {\n        collector.addRule(`.monaco-editor .findOptionsWidget { color: ${widgetForeground}; }`);\n    }\n    const widgetShadowColor = theme.getColor(widgetShadow);\n    if (widgetShadowColor) {\n        collector.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${widgetShadowColor}; }`);\n    }\n    const hcBorder = theme.getColor(contrastBorder);\n    if (hcBorder) {\n        collector.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${hcBorder}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { MATCHES_LIMIT } from './findModel.js';\nfunction effectiveOptionValue(override, value) {\n    if (override === 1 /* FindOptionOverride.True */) {\n        return true;\n    }\n    if (override === 2 /* FindOptionOverride.False */) {\n        return false;\n    }\n    return value;\n}\nexport class FindReplaceState extends Disposable {\n    constructor() {\n        super();\n        this._onFindReplaceStateChange = this._register(new Emitter());\n        this.onFindReplaceStateChange = this._onFindReplaceStateChange.event;\n        this._searchString = '';\n        this._replaceString = '';\n        this._isRevealed = false;\n        this._isReplaceRevealed = false;\n        this._isRegex = false;\n        this._isRegexOverride = 0 /* FindOptionOverride.NotSet */;\n        this._wholeWord = false;\n        this._wholeWordOverride = 0 /* FindOptionOverride.NotSet */;\n        this._matchCase = false;\n        this._matchCaseOverride = 0 /* FindOptionOverride.NotSet */;\n        this._preserveCase = false;\n        this._preserveCaseOverride = 0 /* FindOptionOverride.NotSet */;\n        this._searchScope = null;\n        this._matchesPosition = 0;\n        this._matchesCount = 0;\n        this._currentMatch = null;\n        this._loop = true;\n        this._isSearching = false;\n        this._filters = null;\n    }\n    get searchString() { return this._searchString; }\n    get replaceString() { return this._replaceString; }\n    get isRevealed() { return this._isRevealed; }\n    get isReplaceRevealed() { return this._isReplaceRevealed; }\n    get isRegex() { return effectiveOptionValue(this._isRegexOverride, this._isRegex); }\n    get wholeWord() { return effectiveOptionValue(this._wholeWordOverride, this._wholeWord); }\n    get matchCase() { return effectiveOptionValue(this._matchCaseOverride, this._matchCase); }\n    get preserveCase() { return effectiveOptionValue(this._preserveCaseOverride, this._preserveCase); }\n    get actualIsRegex() { return this._isRegex; }\n    get actualWholeWord() { return this._wholeWord; }\n    get actualMatchCase() { return this._matchCase; }\n    get actualPreserveCase() { return this._preserveCase; }\n    get searchScope() { return this._searchScope; }\n    get matchesPosition() { return this._matchesPosition; }\n    get matchesCount() { return this._matchesCount; }\n    get currentMatch() { return this._currentMatch; }\n    changeMatchInfo(matchesPosition, matchesCount, currentMatch) {\n        const changeEvent = {\n            moveCursor: false,\n            updateHistory: false,\n            searchString: false,\n            replaceString: false,\n            isRevealed: false,\n            isReplaceRevealed: false,\n            isRegex: false,\n            wholeWord: false,\n            matchCase: false,\n            preserveCase: false,\n            searchScope: false,\n            matchesPosition: false,\n            matchesCount: false,\n            currentMatch: false,\n            loop: false,\n            isSearching: false,\n            filters: false\n        };\n        let somethingChanged = false;\n        if (matchesCount === 0) {\n            matchesPosition = 0;\n        }\n        if (matchesPosition > matchesCount) {\n            matchesPosition = matchesCount;\n        }\n        if (this._matchesPosition !== matchesPosition) {\n            this._matchesPosition = matchesPosition;\n            changeEvent.matchesPosition = true;\n            somethingChanged = true;\n        }\n        if (this._matchesCount !== matchesCount) {\n            this._matchesCount = matchesCount;\n            changeEvent.matchesCount = true;\n            somethingChanged = true;\n        }\n        if (typeof currentMatch !== 'undefined') {\n            if (!Range.equalsRange(this._currentMatch, currentMatch)) {\n                this._currentMatch = currentMatch;\n                changeEvent.currentMatch = true;\n                somethingChanged = true;\n            }\n        }\n        if (somethingChanged) {\n            this._onFindReplaceStateChange.fire(changeEvent);\n        }\n    }\n    change(newState, moveCursor, updateHistory = true) {\n        var _a;\n        const changeEvent = {\n            moveCursor: moveCursor,\n            updateHistory: updateHistory,\n            searchString: false,\n            replaceString: false,\n            isRevealed: false,\n            isReplaceRevealed: false,\n            isRegex: false,\n            wholeWord: false,\n            matchCase: false,\n            preserveCase: false,\n            searchScope: false,\n            matchesPosition: false,\n            matchesCount: false,\n            currentMatch: false,\n            loop: false,\n            isSearching: false,\n            filters: false\n        };\n        let somethingChanged = false;\n        const oldEffectiveIsRegex = this.isRegex;\n        const oldEffectiveWholeWords = this.wholeWord;\n        const oldEffectiveMatchCase = this.matchCase;\n        const oldEffectivePreserveCase = this.preserveCase;\n        if (typeof newState.searchString !== 'undefined') {\n            if (this._searchString !== newState.searchString) {\n                this._searchString = newState.searchString;\n                changeEvent.searchString = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.replaceString !== 'undefined') {\n            if (this._replaceString !== newState.replaceString) {\n                this._replaceString = newState.replaceString;\n                changeEvent.replaceString = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isRevealed !== 'undefined') {\n            if (this._isRevealed !== newState.isRevealed) {\n                this._isRevealed = newState.isRevealed;\n                changeEvent.isRevealed = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isReplaceRevealed !== 'undefined') {\n            if (this._isReplaceRevealed !== newState.isReplaceRevealed) {\n                this._isReplaceRevealed = newState.isReplaceRevealed;\n                changeEvent.isReplaceRevealed = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isRegex !== 'undefined') {\n            this._isRegex = newState.isRegex;\n        }\n        if (typeof newState.wholeWord !== 'undefined') {\n            this._wholeWord = newState.wholeWord;\n        }\n        if (typeof newState.matchCase !== 'undefined') {\n            this._matchCase = newState.matchCase;\n        }\n        if (typeof newState.preserveCase !== 'undefined') {\n            this._preserveCase = newState.preserveCase;\n        }\n        if (typeof newState.searchScope !== 'undefined') {\n            if (!((_a = newState.searchScope) === null || _a === void 0 ? void 0 : _a.every((newSearchScope) => {\n                var _a;\n                return (_a = this._searchScope) === null || _a === void 0 ? void 0 : _a.some(existingSearchScope => {\n                    return !Range.equalsRange(existingSearchScope, newSearchScope);\n                });\n            }))) {\n                this._searchScope = newState.searchScope;\n                changeEvent.searchScope = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.loop !== 'undefined') {\n            if (this._loop !== newState.loop) {\n                this._loop = newState.loop;\n                changeEvent.loop = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isSearching !== 'undefined') {\n            if (this._isSearching !== newState.isSearching) {\n                this._isSearching = newState.isSearching;\n                changeEvent.isSearching = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.filters !== 'undefined') {\n            if (this._filters) {\n                this._filters.update(newState.filters);\n            }\n            else {\n                this._filters = newState.filters;\n            }\n            changeEvent.filters = true;\n            somethingChanged = true;\n        }\n        // Overrides get set when they explicitly come in and get reset anytime something else changes\n        this._isRegexOverride = (typeof newState.isRegexOverride !== 'undefined' ? newState.isRegexOverride : 0 /* FindOptionOverride.NotSet */);\n        this._wholeWordOverride = (typeof newState.wholeWordOverride !== 'undefined' ? newState.wholeWordOverride : 0 /* FindOptionOverride.NotSet */);\n        this._matchCaseOverride = (typeof newState.matchCaseOverride !== 'undefined' ? newState.matchCaseOverride : 0 /* FindOptionOverride.NotSet */);\n        this._preserveCaseOverride = (typeof newState.preserveCaseOverride !== 'undefined' ? newState.preserveCaseOverride : 0 /* FindOptionOverride.NotSet */);\n        if (oldEffectiveIsRegex !== this.isRegex) {\n            somethingChanged = true;\n            changeEvent.isRegex = true;\n        }\n        if (oldEffectiveWholeWords !== this.wholeWord) {\n            somethingChanged = true;\n            changeEvent.wholeWord = true;\n        }\n        if (oldEffectiveMatchCase !== this.matchCase) {\n            somethingChanged = true;\n            changeEvent.matchCase = true;\n        }\n        if (oldEffectivePreserveCase !== this.preserveCase) {\n            somethingChanged = true;\n            changeEvent.preserveCase = true;\n        }\n        if (somethingChanged) {\n            this._onFindReplaceStateChange.fire(changeEvent);\n        }\n    }\n    canNavigateBack() {\n        return this.canNavigateInLoop() || (this.matchesPosition !== 1);\n    }\n    canNavigateForward() {\n        return this.canNavigateInLoop() || (this.matchesPosition < this.matchesCount);\n    }\n    canNavigateInLoop() {\n        return this._loop || (this.matchesCount >= MATCHES_LIMIT);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function showHistoryKeybindingHint(keybindingService) {\n    var _a, _b;\n    return ((_a = keybindingService.lookupKeybinding('history.showPrevious')) === null || _a === void 0 ? void 0 : _a.getElectronAccelerator()) === 'Up' && ((_b = keybindingService.lookupKeybinding('history.showNext')) === null || _b === void 0 ? void 0 : _b.getElectronAccelerator()) === 'Down';\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { alert as alertFn } from '../../../../base/browser/ui/aria/aria.js';\nimport { Toggle } from '../../../../base/browser/ui/toggle/toggle.js';\nimport { Sash } from '../../../../base/browser/ui/sash/sash.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './findWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from './findModel.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextScopedFindInput, ContextScopedReplaceInput } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nimport { showHistoryKeybindingHint } from '../../../../platform/history/browser/historyWidgetKeybindingHint.js';\nimport { contrastBorder, editorFindMatch, editorFindMatchBorder, editorFindMatchHighlight, editorFindMatchHighlightBorder, editorFindRangeHighlight, editorFindRangeHighlightBorder, editorWidgetBackground, editorWidgetBorder, editorWidgetForeground, editorWidgetResizeBorder, errorForeground, focusBorder, inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground, inputBackground, inputBorder, inputForeground, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, inputValidationInfoBackground, inputValidationInfoBorder, inputValidationInfoForeground, inputValidationWarningBackground, inputValidationWarningBorder, inputValidationWarningForeground, toolbarHoverBackground, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon, widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nimport { registerThemingParticipant, ThemeIcon } from '../../../../platform/theme/common/themeService.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nconst findSelectionIcon = registerIcon('find-selection', Codicon.selection, nls.localize('findSelectionIcon', 'Icon for \\'Find in Selection\\' in the editor find widget.'));\nconst findCollapsedIcon = registerIcon('find-collapsed', Codicon.chevronRight, nls.localize('findCollapsedIcon', 'Icon to indicate that the editor find widget is collapsed.'));\nconst findExpandedIcon = registerIcon('find-expanded', Codicon.chevronDown, nls.localize('findExpandedIcon', 'Icon to indicate that the editor find widget is expanded.'));\nexport const findReplaceIcon = registerIcon('find-replace', Codicon.replace, nls.localize('findReplaceIcon', 'Icon for \\'Replace\\' in the editor find widget.'));\nexport const findReplaceAllIcon = registerIcon('find-replace-all', Codicon.replaceAll, nls.localize('findReplaceAllIcon', 'Icon for \\'Replace All\\' in the editor find widget.'));\nexport const findPreviousMatchIcon = registerIcon('find-previous-match', Codicon.arrowUp, nls.localize('findPreviousMatchIcon', 'Icon for \\'Find Previous\\' in the editor find widget.'));\nexport const findNextMatchIcon = registerIcon('find-next-match', Codicon.arrowDown, nls.localize('findNextMatchIcon', 'Icon for \\'Find Next\\' in the editor find widget.'));\nconst NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\nconst NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\nconst NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous Match\");\nconst NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next Match\");\nconst NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in Selection\");\nconst NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\nconst NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\nconst NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\nconst NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\nconst NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\nconst NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace\");\nconst NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\nexport const NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\nexport const NLS_NO_RESULTS = nls.localize('label.noResults', \"No results\");\nconst FIND_WIDGET_INITIAL_WIDTH = 419;\nconst PART_WIDTH = 275;\nconst FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\nlet MAX_MATCHES_COUNT_WIDTH = 69;\n// let FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\nconst FIND_INPUT_AREA_HEIGHT = 33; // The height of Find Widget when Replace Input is not visible.\nconst ctrlEnterReplaceAllWarningPromptedKey = 'ctrlEnterReplaceAll.windows.donotask';\nconst ctrlKeyMod = (platform.isMacintosh ? 256 /* KeyMod.WinCtrl */ : 2048 /* KeyMod.CtrlCmd */);\nexport class FindWidgetViewZone {\n    constructor(afterLineNumber) {\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\n        this.suppressMouseDown = false;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'dock-find-viewzone';\n    }\n}\nfunction stopPropagationForMultiLineUpwards(event, value, textarea) {\n    const isMultiline = !!value.match(/\\n/);\n    if (textarea && isMultiline && textarea.selectionStart > 0) {\n        event.stopPropagation();\n        return;\n    }\n}\nfunction stopPropagationForMultiLineDownwards(event, value, textarea) {\n    const isMultiline = !!value.match(/\\n/);\n    if (textarea && isMultiline && textarea.selectionEnd < textarea.value.length) {\n        event.stopPropagation();\n        return;\n    }\n}\nexport class FindWidget extends Widget {\n    constructor(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService, storageService, notificationService) {\n        super();\n        this._cachedHeight = null;\n        this._revealTimeouts = [];\n        this._codeEditor = codeEditor;\n        this._controller = controller;\n        this._state = state;\n        this._contextViewProvider = contextViewProvider;\n        this._keybindingService = keybindingService;\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._notificationService = notificationService;\n        this._ctrlEnterReplaceAllWarningPrompted = !!storageService.getBoolean(ctrlEnterReplaceAllWarningPromptedKey, 0 /* StorageScope.PROFILE */);\n        this._isVisible = false;\n        this._isReplaceVisible = false;\n        this._ignoreChangeEvent = false;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._register(toDisposable(() => this._updateHistoryDelayer.cancel()));\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._buildDomNode();\n        this._updateButtons();\n        this._tryUpdateWidgetWidth();\n        this._findInput.inputBox.layout();\n        this._register(this._codeEditor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(83 /* EditorOption.readOnly */)) {\n                if (this._codeEditor.getOption(83 /* EditorOption.readOnly */)) {\n                    // Hide replace part if editor becomes read only\n                    this._state.change({ isReplaceRevealed: false }, false);\n                }\n                this._updateButtons();\n            }\n            if (e.hasChanged(133 /* EditorOption.layoutInfo */)) {\n                this._tryUpdateWidgetWidth();\n            }\n            if (e.hasChanged(2 /* EditorOption.accessibilitySupport */)) {\n                this.updateAccessibilitySupport();\n            }\n            if (e.hasChanged(37 /* EditorOption.find */)) {\n                const addExtraSpaceOnTop = this._codeEditor.getOption(37 /* EditorOption.find */).addExtraSpaceOnTop;\n                if (addExtraSpaceOnTop && !this._viewZone) {\n                    this._viewZone = new FindWidgetViewZone(0);\n                    this._showViewZone();\n                }\n                if (!addExtraSpaceOnTop && this._viewZone) {\n                    this._removeViewZone();\n                }\n            }\n        }));\n        this.updateAccessibilitySupport();\n        this._register(this._codeEditor.onDidChangeCursorSelection(() => {\n            if (this._isVisible) {\n                this._updateToggleSelectionFindButton();\n            }\n        }));\n        this._register(this._codeEditor.onDidFocusEditorWidget(() => __awaiter(this, void 0, void 0, function* () {\n            if (this._isVisible) {\n                const globalBufferTerm = yield this._controller.getGlobalBufferTerm();\n                if (globalBufferTerm && globalBufferTerm !== this._state.searchString) {\n                    this._state.change({ searchString: globalBufferTerm }, false);\n                    this._findInput.select();\n                }\n            }\n        })));\n        this._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._findFocusTracker = this._register(dom.trackFocus(this._findInput.inputBox.inputElement));\n        this._register(this._findFocusTracker.onDidFocus(() => {\n            this._findInputFocused.set(true);\n            this._updateSearchScope();\n        }));\n        this._register(this._findFocusTracker.onDidBlur(() => {\n            this._findInputFocused.set(false);\n        }));\n        this._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._replaceFocusTracker = this._register(dom.trackFocus(this._replaceInput.inputBox.inputElement));\n        this._register(this._replaceFocusTracker.onDidFocus(() => {\n            this._replaceInputFocused.set(true);\n            this._updateSearchScope();\n        }));\n        this._register(this._replaceFocusTracker.onDidBlur(() => {\n            this._replaceInputFocused.set(false);\n        }));\n        this._codeEditor.addOverlayWidget(this);\n        if (this._codeEditor.getOption(37 /* EditorOption.find */).addExtraSpaceOnTop) {\n            this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\n        }\n        this._applyTheme(themeService.getColorTheme());\n        this._register(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._register(this._codeEditor.onDidChangeModel(() => {\n            if (!this._isVisible) {\n                return;\n            }\n            this._viewZoneId = undefined;\n        }));\n        this._register(this._codeEditor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged) {\n                this._layoutViewZone();\n                return;\n            }\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\n            setTimeout(() => {\n                this._layoutViewZone();\n            }, 0);\n        }));\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return FindWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        if (this._isVisible) {\n            return {\n                preference: 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */\n            };\n        }\n        return null;\n    }\n    // ----- React to state changes\n    _onStateChanged(e) {\n        if (e.searchString) {\n            try {\n                this._ignoreChangeEvent = true;\n                this._findInput.setValue(this._state.searchString);\n            }\n            finally {\n                this._ignoreChangeEvent = false;\n            }\n            this._updateButtons();\n        }\n        if (e.replaceString) {\n            this._replaceInput.inputBox.value = this._state.replaceString;\n        }\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._reveal();\n            }\n            else {\n                this._hide(true);\n            }\n        }\n        if (e.isReplaceRevealed) {\n            if (this._state.isReplaceRevealed) {\n                if (!this._codeEditor.getOption(83 /* EditorOption.readOnly */) && !this._isReplaceVisible) {\n                    this._isReplaceVisible = true;\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                    this._updateButtons();\n                    this._replaceInput.inputBox.layout();\n                }\n            }\n            else {\n                if (this._isReplaceVisible) {\n                    this._isReplaceVisible = false;\n                    this._updateButtons();\n                }\n            }\n        }\n        if ((e.isRevealed || e.isReplaceRevealed) && (this._state.isRevealed || this._state.isReplaceRevealed)) {\n            if (this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }\n        if (e.isRegex) {\n            this._findInput.setRegex(this._state.isRegex);\n        }\n        if (e.wholeWord) {\n            this._findInput.setWholeWords(this._state.wholeWord);\n        }\n        if (e.matchCase) {\n            this._findInput.setCaseSensitive(this._state.matchCase);\n        }\n        if (e.preserveCase) {\n            this._replaceInput.setPreserveCase(this._state.preserveCase);\n        }\n        if (e.searchScope) {\n            if (this._state.searchScope) {\n                this._toggleSelectionFind.checked = true;\n            }\n            else {\n                this._toggleSelectionFind.checked = false;\n            }\n            this._updateToggleSelectionFindButton();\n        }\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\n            const showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\n            this._domNode.classList.toggle('no-results', showRedOutline);\n            this._updateMatchesCount();\n            this._updateButtons();\n        }\n        if (e.searchString || e.currentMatch) {\n            this._layoutViewZone();\n        }\n        if (e.updateHistory) {\n            this._delayedUpdateHistory();\n        }\n        if (e.loop) {\n            this._updateButtons();\n        }\n    }\n    _delayedUpdateHistory() {\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(undefined, onUnexpectedError);\n    }\n    _updateHistory() {\n        if (this._state.searchString) {\n            this._findInput.inputBox.addToHistory();\n        }\n        if (this._state.replaceString) {\n            this._replaceInput.inputBox.addToHistory();\n        }\n    }\n    _updateMatchesCount() {\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\n        if (this._state.matchesCount >= MATCHES_LIMIT) {\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\n        }\n        else {\n            this._matchesCount.title = '';\n        }\n        // remove previous content\n        if (this._matchesCount.firstChild) {\n            this._matchesCount.removeChild(this._matchesCount.firstChild);\n        }\n        let label;\n        if (this._state.matchesCount > 0) {\n            let matchesCount = String(this._state.matchesCount);\n            if (this._state.matchesCount >= MATCHES_LIMIT) {\n                matchesCount += '+';\n            }\n            let matchesPosition = String(this._state.matchesPosition);\n            if (matchesPosition === '0') {\n                matchesPosition = '?';\n            }\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\n        }\n        else {\n            label = NLS_NO_RESULTS;\n        }\n        this._matchesCount.appendChild(document.createTextNode(label));\n        alertFn(this._getAriaLabel(label, this._state.currentMatch, this._state.searchString));\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\n    }\n    // ----- actions\n    _getAriaLabel(label, currentMatch, searchString) {\n        if (label === NLS_NO_RESULTS) {\n            return searchString === ''\n                ? nls.localize('ariaSearchNoResultEmpty', \"{0} found\", label)\n                : nls.localize('ariaSearchNoResult', \"{0} found for '{1}'\", label, searchString);\n        }\n        if (currentMatch) {\n            const ariaLabel = nls.localize('ariaSearchNoResultWithLineNum', \"{0} found for '{1}', at {2}\", label, searchString, currentMatch.startLineNumber + ':' + currentMatch.startColumn);\n            const model = this._codeEditor.getModel();\n            if (model && (currentMatch.startLineNumber <= model.getLineCount()) && (currentMatch.startLineNumber >= 1)) {\n                const lineContent = model.getLineContent(currentMatch.startLineNumber);\n                return `${lineContent}, ${ariaLabel}`;\n            }\n            return ariaLabel;\n        }\n        return nls.localize('ariaSearchNoResultWithLineNumNoCurrentMatch', \"{0} found for '{1}'\", label, searchString);\n    }\n    /**\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\n     * If 'selection find' is OFF we enable the button only if there is a selection.\n     */\n    _updateToggleSelectionFindButton() {\n        const selection = this._codeEditor.getSelection();\n        const isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n        const isChecked = this._toggleSelectionFind.checked;\n        if (this._isVisible && (isChecked || isSelection)) {\n            this._toggleSelectionFind.enable();\n        }\n        else {\n            this._toggleSelectionFind.disable();\n        }\n    }\n    _updateButtons() {\n        this._findInput.setEnabled(this._isVisible);\n        this._replaceInput.setEnabled(this._isVisible && this._isReplaceVisible);\n        this._updateToggleSelectionFindButton();\n        this._closeBtn.setEnabled(this._isVisible);\n        const findInputIsNonEmpty = (this._state.searchString.length > 0);\n        const matchesCount = this._state.matchesCount ? true : false;\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateBack());\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateForward());\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._domNode.classList.toggle('replaceToggled', this._isReplaceVisible);\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        const canReplace = !this._codeEditor.getOption(83 /* EditorOption.readOnly */);\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\n    }\n    _reveal() {\n        this._revealTimeouts.forEach(e => {\n            clearTimeout(e);\n        });\n        this._revealTimeouts = [];\n        if (!this._isVisible) {\n            this._isVisible = true;\n            const selection = this._codeEditor.getSelection();\n            switch (this._codeEditor.getOption(37 /* EditorOption.find */).autoFindInSelection) {\n                case 'always':\n                    this._toggleSelectionFind.checked = true;\n                    break;\n                case 'never':\n                    this._toggleSelectionFind.checked = false;\n                    break;\n                case 'multiline': {\n                    const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                    this._toggleSelectionFind.checked = isSelectionMultipleLine;\n                    break;\n                }\n                default:\n                    break;\n            }\n            this._tryUpdateWidgetWidth();\n            this._updateButtons();\n            this._revealTimeouts.push(setTimeout(() => {\n                this._domNode.classList.add('visible');\n                this._domNode.setAttribute('aria-hidden', 'false');\n            }, 0));\n            // validate query again as it's being dismissed when we hide the find widget.\n            this._revealTimeouts.push(setTimeout(() => {\n                this._findInput.validate();\n            }, 200));\n            this._codeEditor.layoutOverlayWidget(this);\n            let adjustEditorScrollTop = true;\n            if (this._codeEditor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection && selection) {\n                const domNode = this._codeEditor.getDomNode();\n                if (domNode) {\n                    const editorCoords = dom.getDomNodePagePosition(domNode);\n                    const startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\n                    const startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\n                    const startTop = startCoords ? startCoords.top : 0;\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\n                        if (selection.endLineNumber > selection.startLineNumber) {\n                            adjustEditorScrollTop = false;\n                        }\n                        const leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\n                        if (startLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                        const endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\n                        const endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\n                        if (endLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                    }\n                }\n            }\n            this._showViewZone(adjustEditorScrollTop);\n        }\n    }\n    _hide(focusTheEditor) {\n        this._revealTimeouts.forEach(e => {\n            clearTimeout(e);\n        });\n        this._revealTimeouts = [];\n        if (this._isVisible) {\n            this._isVisible = false;\n            this._updateButtons();\n            this._domNode.classList.remove('visible');\n            this._domNode.setAttribute('aria-hidden', 'true');\n            this._findInput.clearMessage();\n            if (focusTheEditor) {\n                this._codeEditor.focus();\n            }\n            this._codeEditor.layoutOverlayWidget(this);\n            this._removeViewZone();\n        }\n    }\n    _layoutViewZone(targetScrollTop) {\n        const addExtraSpaceOnTop = this._codeEditor.getOption(37 /* EditorOption.find */).addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            this._removeViewZone();\n            return;\n        }\n        if (!this._isVisible) {\n            return;\n        }\n        const viewZone = this._viewZone;\n        if (this._viewZoneId !== undefined || !viewZone) {\n            return;\n        }\n        this._codeEditor.changeViewZones((accessor) => {\n            viewZone.heightInPx = this._getHeight();\n            this._viewZoneId = accessor.addZone(viewZone);\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\n            this._codeEditor.setScrollTop(targetScrollTop || this._codeEditor.getScrollTop() + viewZone.heightInPx);\n        });\n    }\n    _showViewZone(adjustScroll = true) {\n        if (!this._isVisible) {\n            return;\n        }\n        const addExtraSpaceOnTop = this._codeEditor.getOption(37 /* EditorOption.find */).addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            return;\n        }\n        if (this._viewZone === undefined) {\n            this._viewZone = new FindWidgetViewZone(0);\n        }\n        const viewZone = this._viewZone;\n        this._codeEditor.changeViewZones((accessor) => {\n            if (this._viewZoneId !== undefined) {\n                // the view zone already exists, we need to update the height\n                const newHeight = this._getHeight();\n                if (newHeight === viewZone.heightInPx) {\n                    return;\n                }\n                const scrollAdjustment = newHeight - viewZone.heightInPx;\n                viewZone.heightInPx = newHeight;\n                accessor.layoutZone(this._viewZoneId);\n                if (adjustScroll) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n                }\n                return;\n            }\n            else {\n                let scrollAdjustment = this._getHeight();\n                // if the editor has top padding, factor that into the zone height\n                scrollAdjustment -= this._codeEditor.getOption(77 /* EditorOption.padding */).top;\n                if (scrollAdjustment <= 0) {\n                    return;\n                }\n                viewZone.heightInPx = scrollAdjustment;\n                this._viewZoneId = accessor.addZone(viewZone);\n                if (adjustScroll) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n                }\n            }\n        });\n    }\n    _removeViewZone() {\n        this._codeEditor.changeViewZones((accessor) => {\n            if (this._viewZoneId !== undefined) {\n                accessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n                if (this._viewZone) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() - this._viewZone.heightInPx);\n                    this._viewZone = undefined;\n                }\n            }\n        });\n    }\n    _applyTheme(theme) {\n        const inputStyles = {\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground),\n            inputActiveOptionForeground: theme.getColor(inputActiveOptionForeground),\n            inputBackground: theme.getColor(inputBackground),\n            inputForeground: theme.getColor(inputForeground),\n            inputBorder: theme.getColor(inputBorder),\n            inputValidationInfoBackground: theme.getColor(inputValidationInfoBackground),\n            inputValidationInfoForeground: theme.getColor(inputValidationInfoForeground),\n            inputValidationInfoBorder: theme.getColor(inputValidationInfoBorder),\n            inputValidationWarningBackground: theme.getColor(inputValidationWarningBackground),\n            inputValidationWarningForeground: theme.getColor(inputValidationWarningForeground),\n            inputValidationWarningBorder: theme.getColor(inputValidationWarningBorder),\n            inputValidationErrorBackground: theme.getColor(inputValidationErrorBackground),\n            inputValidationErrorForeground: theme.getColor(inputValidationErrorForeground),\n            inputValidationErrorBorder: theme.getColor(inputValidationErrorBorder),\n        };\n        this._findInput.style(inputStyles);\n        this._replaceInput.style(inputStyles);\n        this._toggleSelectionFind.style(inputStyles);\n    }\n    _tryUpdateWidgetWidth() {\n        if (!this._isVisible) {\n            return;\n        }\n        if (!dom.isInDOM(this._domNode)) {\n            // the widget is not in the DOM\n            return;\n        }\n        const layoutInfo = this._codeEditor.getLayoutInfo();\n        const editorContentWidth = layoutInfo.contentWidth;\n        if (editorContentWidth <= 0) {\n            // for example, diff view original editor\n            this._domNode.classList.add('hiddenEditor');\n            return;\n        }\n        else if (this._domNode.classList.contains('hiddenEditor')) {\n            this._domNode.classList.remove('hiddenEditor');\n        }\n        const editorWidth = layoutInfo.width;\n        const minimapWidth = layoutInfo.minimap.minimapWidth;\n        let collapsedFindWidget = false;\n        let reducedFindWidget = false;\n        let narrowFindWidget = false;\n        if (this._resized) {\n            const widgetWidth = dom.getTotalWidth(this._domNode);\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\n                this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                return;\n            }\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\n            reducedFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\n            narrowFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\n            collapsedFindWidget = true;\n        }\n        this._domNode.classList.toggle('collapsed-find-widget', collapsedFindWidget);\n        this._domNode.classList.toggle('narrow-find-widget', narrowFindWidget);\n        this._domNode.classList.toggle('reduced-find-widget', reducedFindWidget);\n        if (!narrowFindWidget && !collapsedFindWidget) {\n            // the minimal left offset of findwidget is 15px.\n            this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n        }\n        if (this._resized) {\n            this._findInput.inputBox.layout();\n            const findInputWidth = this._findInput.inputBox.element.clientWidth;\n            if (findInputWidth > 0) {\n                this._replaceInput.width = findInputWidth;\n            }\n        }\n        else if (this._isReplaceVisible) {\n            this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n        }\n    }\n    _getHeight() {\n        let totalheight = 0;\n        // find input margin top\n        totalheight += 4;\n        // find input height\n        totalheight += this._findInput.inputBox.height + 2 /** input box border */;\n        if (this._isReplaceVisible) {\n            // replace input margin\n            totalheight += 4;\n            totalheight += this._replaceInput.inputBox.height + 2 /** input box border */;\n        }\n        // margin bottom\n        totalheight += 4;\n        return totalheight;\n    }\n    _tryUpdateHeight() {\n        const totalHeight = this._getHeight();\n        if (this._cachedHeight !== null && this._cachedHeight === totalHeight) {\n            return false;\n        }\n        this._cachedHeight = totalHeight;\n        this._domNode.style.height = `${totalHeight}px`;\n        return true;\n    }\n    // ----- Public\n    focusFindInput() {\n        this._findInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._findInput.focus();\n    }\n    focusReplaceInput() {\n        this._replaceInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._replaceInput.focus();\n    }\n    highlightFindOptions() {\n        this._findInput.highlightFindOptions();\n    }\n    _updateSearchScope() {\n        if (!this._codeEditor.hasModel()) {\n            return;\n        }\n        if (this._toggleSelectionFind.checked) {\n            const selections = this._codeEditor.getSelections();\n            selections.map(selection => {\n                if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                    selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                }\n                const currentMatch = this._state.currentMatch;\n                if (selection.startLineNumber !== selection.endLineNumber) {\n                    if (!Range.equalsRange(selection, currentMatch)) {\n                        return selection;\n                    }\n                }\n                return null;\n            }).filter(element => !!element);\n            if (selections.length) {\n                this._state.change({ searchScope: selections }, true);\n            }\n        }\n    }\n    _onFindInputMouseDown(e) {\n        // on linux, middle key does pasting.\n        if (e.middleButton) {\n            e.stopPropagation();\n        }\n    }\n    _onFindInputKeyDown(e) {\n        if (e.equals(ctrlKeyMod | 3 /* KeyCode.Enter */)) {\n            if (this._keybindingService.dispatchEvent(e, e.target)) {\n                e.preventDefault();\n                return;\n            }\n            else {\n                this._findInput.inputBox.insertAtCursor('\\n');\n                e.preventDefault();\n                return;\n            }\n        }\n        if (e.equals(2 /* KeyCode.Tab */)) {\n            if (this._isReplaceVisible) {\n                this._replaceInput.focus();\n            }\n            else {\n                this._findInput.focusOnCaseSensitive();\n            }\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(16 /* KeyCode.UpArrow */)) {\n            return stopPropagationForMultiLineUpwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\n        }\n        if (e.equals(18 /* KeyCode.DownArrow */)) {\n            return stopPropagationForMultiLineDownwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\n        }\n    }\n    _onReplaceInputKeyDown(e) {\n        if (e.equals(ctrlKeyMod | 3 /* KeyCode.Enter */)) {\n            if (this._keybindingService.dispatchEvent(e, e.target)) {\n                e.preventDefault();\n                return;\n            }\n            else {\n                if (platform.isWindows && platform.isNative && !this._ctrlEnterReplaceAllWarningPrompted) {\n                    // this is the first time when users press Ctrl + Enter to replace all\n                    this._notificationService.info(nls.localize('ctrlEnter.keybindingChanged', 'Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.'));\n                    this._ctrlEnterReplaceAllWarningPrompted = true;\n                    this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey, true, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n                }\n                this._replaceInput.inputBox.insertAtCursor('\\n');\n                e.preventDefault();\n                return;\n            }\n        }\n        if (e.equals(2 /* KeyCode.Tab */)) {\n            this._findInput.focusOnCaseSensitive();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n            this._findInput.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(16 /* KeyCode.UpArrow */)) {\n            return stopPropagationForMultiLineUpwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\n        }\n        if (e.equals(18 /* KeyCode.DownArrow */)) {\n            return stopPropagationForMultiLineDownwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\n        }\n    }\n    // ----- sash\n    getVerticalSashLeft(_sash) {\n        return 0;\n    }\n    // ----- initialization\n    _keybindingLabelFor(actionId) {\n        const kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return ` (${kb.getLabel()})`;\n    }\n    _buildDomNode() {\n        const flexibleHeight = true;\n        const flexibleWidth = true;\n        // Find input\n        this._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\n            width: FIND_INPUT_AREA_WIDTH,\n            label: NLS_FIND_INPUT_LABEL,\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\n            appendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n            appendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n            appendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n            validation: (value) => {\n                if (value.length === 0 || !this._findInput.getRegex()) {\n                    return null;\n                }\n                try {\n                    // use `g` and `u` which are also used by the TextModel search\n                    new RegExp(value, 'gu');\n                    return null;\n                }\n                catch (e) {\n                    return { content: e.message };\n                }\n            },\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight: 118,\n            showHistoryHint: () => showHistoryKeybindingHint(this._keybindingService)\n        }, this._contextKeyService, true));\n        this._findInput.setRegex(!!this._state.isRegex);\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\n        this._findInput.setWholeWords(!!this._state.wholeWord);\n        this._register(this._findInput.onKeyDown((e) => this._onFindInputKeyDown(e)));\n        this._register(this._findInput.inputBox.onDidChange(() => {\n            if (this._ignoreChangeEvent) {\n                return;\n            }\n            this._state.change({ searchString: this._findInput.getValue() }, true);\n        }));\n        this._register(this._findInput.onDidOptionChange(() => {\n            this._state.change({\n                isRegex: this._findInput.getRegex(),\n                wholeWord: this._findInput.getWholeWords(),\n                matchCase: this._findInput.getCaseSensitive()\n            }, true);\n        }));\n        this._register(this._findInput.onCaseSensitiveKeyDown((e) => {\n            if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n                if (this._isReplaceVisible) {\n                    this._replaceInput.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        this._register(this._findInput.onRegexKeyDown((e) => {\n            if (e.equals(2 /* KeyCode.Tab */)) {\n                if (this._isReplaceVisible) {\n                    this._replaceInput.focusOnPreserve();\n                    e.preventDefault();\n                }\n            }\n        }));\n        this._register(this._findInput.inputBox.onDidHeightChange((e) => {\n            if (this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }));\n        if (platform.isLinux) {\n            this._register(this._findInput.onMouseDown((e) => this._onFindInputMouseDown(e)));\n        }\n        this._matchesCount = document.createElement('div');\n        this._matchesCount.className = 'matchesCount';\n        this._updateMatchesCount();\n        // Previous button\n        this._prevBtn = this._register(new SimpleButton({\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\n            icon: findPreviousMatchIcon,\n            onTrigger: () => {\n                this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(undefined, onUnexpectedError);\n            }\n        }));\n        // Next button\n        this._nextBtn = this._register(new SimpleButton({\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\n            icon: findNextMatchIcon,\n            onTrigger: () => {\n                this._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(undefined, onUnexpectedError);\n            }\n        }));\n        const findPart = document.createElement('div');\n        findPart.className = 'find-part';\n        findPart.appendChild(this._findInput.domNode);\n        const actionsContainer = document.createElement('div');\n        actionsContainer.className = 'find-actions';\n        findPart.appendChild(actionsContainer);\n        actionsContainer.appendChild(this._matchesCount);\n        actionsContainer.appendChild(this._prevBtn.domNode);\n        actionsContainer.appendChild(this._nextBtn.domNode);\n        // Toggle selection button\n        this._toggleSelectionFind = this._register(new Toggle({\n            icon: findSelectionIcon,\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\n            isChecked: false\n        }));\n        this._register(this._toggleSelectionFind.onChange(() => {\n            if (this._toggleSelectionFind.checked) {\n                if (this._codeEditor.hasModel()) {\n                    const selections = this._codeEditor.getSelections();\n                    selections.map(selection => {\n                        if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                            selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                        }\n                        if (!selection.isEmpty()) {\n                            return selection;\n                        }\n                        return null;\n                    }).filter(element => !!element);\n                    if (selections.length) {\n                        this._state.change({ searchScope: selections }, true);\n                    }\n                }\n            }\n            else {\n                this._state.change({ searchScope: null }, true);\n            }\n        }));\n        actionsContainer.appendChild(this._toggleSelectionFind.domNode);\n        // Close button\n        this._closeBtn = this._register(new SimpleButton({\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\n            icon: widgetClose,\n            onTrigger: () => {\n                this._state.change({ isRevealed: false, searchScope: null }, false);\n            },\n            onKeyDown: (e) => {\n                if (e.equals(2 /* KeyCode.Tab */)) {\n                    if (this._isReplaceVisible) {\n                        if (this._replaceBtn.isEnabled()) {\n                            this._replaceBtn.focus();\n                        }\n                        else {\n                            this._codeEditor.focus();\n                        }\n                        e.preventDefault();\n                    }\n                }\n            }\n        }));\n        actionsContainer.appendChild(this._closeBtn.domNode);\n        // Replace input\n        this._replaceInput = this._register(new ContextScopedReplaceInput(null, undefined, {\n            label: NLS_REPLACE_INPUT_LABEL,\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\n            appendPreserveCaseLabel: this._keybindingLabelFor(FIND_IDS.TogglePreserveCaseCommand),\n            history: [],\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight: 118,\n            showHistoryHint: () => showHistoryKeybindingHint(this._keybindingService)\n        }, this._contextKeyService, true));\n        this._replaceInput.setPreserveCase(!!this._state.preserveCase);\n        this._register(this._replaceInput.onKeyDown((e) => this._onReplaceInputKeyDown(e)));\n        this._register(this._replaceInput.inputBox.onDidChange(() => {\n            this._state.change({ replaceString: this._replaceInput.inputBox.value }, false);\n        }));\n        this._register(this._replaceInput.inputBox.onDidHeightChange((e) => {\n            if (this._isReplaceVisible && this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }));\n        this._register(this._replaceInput.onDidOptionChange(() => {\n            this._state.change({\n                preserveCase: this._replaceInput.getPreserveCase()\n            }, true);\n        }));\n        this._register(this._replaceInput.onPreserveCaseKeyDown((e) => {\n            if (e.equals(2 /* KeyCode.Tab */)) {\n                if (this._prevBtn.isEnabled()) {\n                    this._prevBtn.focus();\n                }\n                else if (this._nextBtn.isEnabled()) {\n                    this._nextBtn.focus();\n                }\n                else if (this._toggleSelectionFind.enabled) {\n                    this._toggleSelectionFind.focus();\n                }\n                else if (this._closeBtn.isEnabled()) {\n                    this._closeBtn.focus();\n                }\n                e.preventDefault();\n            }\n        }));\n        // Replace one button\n        this._replaceBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\n            icon: findReplaceIcon,\n            onTrigger: () => {\n                this._controller.replace();\n            },\n            onKeyDown: (e) => {\n                if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n                    this._closeBtn.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        // Replace all button\n        this._replaceAllBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\n            icon: findReplaceAllIcon,\n            onTrigger: () => {\n                this._controller.replaceAll();\n            }\n        }));\n        const replacePart = document.createElement('div');\n        replacePart.className = 'replace-part';\n        replacePart.appendChild(this._replaceInput.domNode);\n        const replaceActionsContainer = document.createElement('div');\n        replaceActionsContainer.className = 'replace-actions';\n        replacePart.appendChild(replaceActionsContainer);\n        replaceActionsContainer.appendChild(this._replaceBtn.domNode);\n        replaceActionsContainer.appendChild(this._replaceAllBtn.domNode);\n        // Toggle replace button\n        this._toggleReplaceBtn = this._register(new SimpleButton({\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\n            className: 'codicon toggle left',\n            onTrigger: () => {\n                this._state.change({ isReplaceRevealed: !this._isReplaceVisible }, false);\n                if (this._isReplaceVisible) {\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                    this._replaceInput.inputBox.layout();\n                }\n                this._showViewZone();\n            }\n        }));\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        // Widget\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'editor-widget find-widget';\n        this._domNode.setAttribute('aria-hidden', 'true');\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\n        this._domNode.style.width = `${FIND_WIDGET_INITIAL_WIDTH}px`;\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\n        this._domNode.appendChild(findPart);\n        this._domNode.appendChild(replacePart);\n        this._resizeSash = new Sash(this._domNode, this, { orientation: 0 /* Orientation.VERTICAL */, size: 2 });\n        this._resized = false;\n        let originalWidth = FIND_WIDGET_INITIAL_WIDTH;\n        this._register(this._resizeSash.onDidStart(() => {\n            originalWidth = dom.getTotalWidth(this._domNode);\n        }));\n        this._register(this._resizeSash.onDidChange((evt) => {\n            this._resized = true;\n            const width = originalWidth + evt.startX - evt.currentX;\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\n                // narrow down the find widget should be handled by CSS.\n                return;\n            }\n            const maxWidth = parseFloat(dom.getComputedStyle(this._domNode).maxWidth) || 0;\n            if (width > maxWidth) {\n                return;\n            }\n            this._domNode.style.width = `${width}px`;\n            if (this._isReplaceVisible) {\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n            }\n            this._findInput.inputBox.layout();\n            this._tryUpdateHeight();\n        }));\n        this._register(this._resizeSash.onDidReset(() => {\n            // users double click on the sash\n            const currentWidth = dom.getTotalWidth(this._domNode);\n            if (currentWidth < FIND_WIDGET_INITIAL_WIDTH) {\n                // The editor is narrow and the width of the find widget is controlled fully by CSS.\n                return;\n            }\n            let width = FIND_WIDGET_INITIAL_WIDTH;\n            if (!this._resized || currentWidth === FIND_WIDGET_INITIAL_WIDTH) {\n                // 1. never resized before, double click should maximizes it\n                // 2. users resized it already but its width is the same as default\n                const layoutInfo = this._codeEditor.getLayoutInfo();\n                width = layoutInfo.width - 28 - layoutInfo.minimap.minimapWidth - 15;\n                this._resized = true;\n            }\n            else {\n                /**\n                 * no op, the find widget should be shrinked to its default size.\n                 */\n            }\n            this._domNode.style.width = `${width}px`;\n            if (this._isReplaceVisible) {\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n            }\n            this._findInput.inputBox.layout();\n        }));\n    }\n    updateAccessibilitySupport() {\n        const value = this._codeEditor.getOption(2 /* EditorOption.accessibilitySupport */);\n        this._findInput.setFocusInputOnOptionClick(value !== 2 /* AccessibilitySupport.Enabled */);\n    }\n}\nFindWidget.ID = 'editor.contrib.findWidget';\nexport class SimpleButton extends Widget {\n    constructor(opts) {\n        super();\n        this._opts = opts;\n        let className = 'button';\n        if (this._opts.className) {\n            className = className + ' ' + this._opts.className;\n        }\n        if (this._opts.icon) {\n            className = className + ' ' + ThemeIcon.asClassName(this._opts.icon);\n        }\n        this._domNode = document.createElement('div');\n        this._domNode.title = this._opts.label;\n        this._domNode.tabIndex = 0;\n        this._domNode.className = className;\n        this._domNode.setAttribute('role', 'button');\n        this._domNode.setAttribute('aria-label', this._opts.label);\n        this.onclick(this._domNode, (e) => {\n            this._opts.onTrigger();\n            e.preventDefault();\n        });\n        this.onkeydown(this._domNode, (e) => {\n            var _a, _b;\n            if (e.equals(10 /* KeyCode.Space */) || e.equals(3 /* KeyCode.Enter */)) {\n                this._opts.onTrigger();\n                e.preventDefault();\n                return;\n            }\n            (_b = (_a = this._opts).onKeyDown) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        });\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    isEnabled() {\n        return (this._domNode.tabIndex >= 0);\n    }\n    focus() {\n        this._domNode.focus();\n    }\n    setEnabled(enabled) {\n        this._domNode.classList.toggle('disabled', !enabled);\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\n        this._domNode.tabIndex = enabled ? 0 : -1;\n    }\n    setExpanded(expanded) {\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\n        if (expanded) {\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findCollapsedIcon));\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findExpandedIcon));\n        }\n        else {\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findExpandedIcon));\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findCollapsedIcon));\n        }\n    }\n}\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const addBackgroundColorRule = (selector, color) => {\n        if (color) {\n            collector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`);\n        }\n    };\n    addBackgroundColorRule('.findMatch', theme.getColor(editorFindMatchHighlight));\n    addBackgroundColorRule('.currentFindMatch', theme.getColor(editorFindMatch));\n    addBackgroundColorRule('.findScope', theme.getColor(editorFindRangeHighlight));\n    const widgetBackground = theme.getColor(editorWidgetBackground);\n    addBackgroundColorRule('.find-widget', widgetBackground);\n    const widgetShadowColor = theme.getColor(widgetShadow);\n    if (widgetShadowColor) {\n        collector.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${widgetShadowColor}; }`);\n    }\n    const findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n    if (findMatchHighlightBorder) {\n        collector.addRule(`.monaco-editor .findMatch { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n    }\n    const findMatchBorder = theme.getColor(editorFindMatchBorder);\n    if (findMatchBorder) {\n        collector.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${findMatchBorder}; padding: 1px; box-sizing: border-box; }`);\n    }\n    const findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\n    if (findRangeHighlightBorder) {\n        collector.addRule(`.monaco-editor .findScope { border: 1px ${isHighContrast(theme.type) ? 'dashed' : 'solid'} ${findRangeHighlightBorder}; }`);\n    }\n    const hcBorder = theme.getColor(contrastBorder);\n    if (hcBorder) {\n        collector.addRule(`.monaco-editor .find-widget { border: 1px solid ${hcBorder}; }`);\n    }\n    const foreground = theme.getColor(editorWidgetForeground);\n    if (foreground) {\n        collector.addRule(`.monaco-editor .find-widget { color: ${foreground}; }`);\n    }\n    const error = theme.getColor(errorForeground);\n    if (error) {\n        collector.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${error}; }`);\n    }\n    const resizeBorderBackground = theme.getColor(editorWidgetResizeBorder);\n    if (resizeBorderBackground) {\n        collector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${resizeBorderBackground}; }`);\n    }\n    else {\n        const border = theme.getColor(editorWidgetBorder);\n        if (border) {\n            collector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${border}; }`);\n        }\n    }\n    // Action bars\n    const toolbarHoverBackgroundColor = theme.getColor(toolbarHoverBackground);\n    if (toolbarHoverBackgroundColor) {\n        collector.addRule(`\n\t\t.monaco-editor .find-widget .button:not(.disabled):hover,\n\t\t.monaco-editor .find-widget .codicon-find-selection:hover {\n\t\t\tbackground-color: ${toolbarHoverBackgroundColor} !important;\n\t\t}\n\t`);\n    }\n    // This rule is used to override the outline color for synthetic-focus find input.\n    const focusOutline = theme.getColor(focusBorder);\n    if (focusOutline) {\n        collector.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${focusOutline}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, MultiEditorAction, registerEditorAction, registerEditorCommand, registerEditorContribution, registerMultiEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, CONTEXT_REPLACE_INPUT_FOCUSED, FindModelBoundToEditorModel, FIND_IDS, ToggleCaseSensitiveKeybinding, TogglePreserveCaseKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding } from './findModel.js';\nimport { FindOptionsWidget } from './findOptionsWidget.js';\nimport { FindReplaceState } from './findState.js';\nimport { FindWidget } from './findWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nconst SEARCH_STRING_MAX_LENGTH = 524288;\nexport function getSelectionSearchString(editor, seedSearchStringFromSelection = 'single', seedSearchStringFromNonEmptySelection = false) {\n    if (!editor.hasModel()) {\n        return null;\n    }\n    const selection = editor.getSelection();\n    // if selection spans multiple lines, default search string to empty\n    if ((seedSearchStringFromSelection === 'single' && selection.startLineNumber === selection.endLineNumber)\n        || seedSearchStringFromSelection === 'multiple') {\n        if (selection.isEmpty()) {\n            const wordAtPosition = editor.getConfiguredWordAtPosition(selection.getStartPosition());\n            if (wordAtPosition && (false === seedSearchStringFromNonEmptySelection)) {\n                return wordAtPosition.word;\n            }\n        }\n        else {\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\n                return editor.getModel().getValueInRange(selection);\n            }\n        }\n    }\n    return null;\n}\nlet CommonFindController = class CommonFindController extends Disposable {\n    constructor(editor, contextKeyService, storageService, clipboardService) {\n        super();\n        this._editor = editor;\n        this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._clipboardService = clipboardService;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._state = this._register(new FindReplaceState());\n        this.loadQueryState();\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._model = null;\n        this._register(this._editor.onDidChangeModel(() => {\n            const shouldRestartFind = (this._editor.getModel() && this._state.isRevealed);\n            this.disposeModel();\n            this._state.change({\n                searchScope: null,\n                matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, false),\n                wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, false),\n                isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, false),\n                preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, false)\n            }, false);\n            if (shouldRestartFind) {\n                this._start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: 'none',\n                    seedSearchStringFromNonEmptySelection: false,\n                    seedSearchStringFromGlobalClipboard: false,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: false,\n                    updateSearchScope: false,\n                    loop: this._editor.getOption(37 /* EditorOption.find */).loop\n                });\n            }\n        }));\n    }\n    get editor() {\n        return this._editor;\n    }\n    static get(editor) {\n        return editor.getContribution(CommonFindController.ID);\n    }\n    dispose() {\n        this.disposeModel();\n        super.dispose();\n    }\n    disposeModel() {\n        if (this._model) {\n            this._model.dispose();\n            this._model = null;\n        }\n    }\n    _onStateChanged(e) {\n        this.saveQueryState(e);\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._findWidgetVisible.set(true);\n            }\n            else {\n                this._findWidgetVisible.reset();\n                this.disposeModel();\n            }\n        }\n        if (e.searchString) {\n            this.setGlobalBufferTerm(this._state.searchString);\n        }\n    }\n    saveQueryState(e) {\n        if (e.isRegex) {\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* StorageScope.WORKSPACE */, 0 /* StorageTarget.USER */);\n        }\n        if (e.wholeWord) {\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* StorageScope.WORKSPACE */, 0 /* StorageTarget.USER */);\n        }\n        if (e.matchCase) {\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* StorageScope.WORKSPACE */, 0 /* StorageTarget.USER */);\n        }\n        if (e.preserveCase) {\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* StorageScope.WORKSPACE */, 0 /* StorageTarget.USER */);\n        }\n    }\n    loadQueryState() {\n        this._state.change({\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, this._state.matchCase),\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, this._state.wholeWord),\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, this._state.isRegex),\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, this._state.preserveCase)\n        }, false);\n    }\n    isFindInputFocused() {\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\n    }\n    getState() {\n        return this._state;\n    }\n    closeFindWidget() {\n        this._state.change({\n            isRevealed: false,\n            searchScope: null\n        }, false);\n        this._editor.focus();\n    }\n    toggleCaseSensitive() {\n        this._state.change({ matchCase: !this._state.matchCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleWholeWords() {\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleRegex() {\n        this._state.change({ isRegex: !this._state.isRegex }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    togglePreserveCase() {\n        this._state.change({ preserveCase: !this._state.preserveCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleSearchScope() {\n        if (this._state.searchScope) {\n            this._state.change({ searchScope: null }, true);\n        }\n        else {\n            if (this._editor.hasModel()) {\n                const selections = this._editor.getSelections();\n                selections.map(selection => {\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                    }\n                    if (!selection.isEmpty()) {\n                        return selection;\n                    }\n                    return null;\n                }).filter(element => !!element);\n                if (selections.length) {\n                    this._state.change({ searchScope: selections }, true);\n                }\n            }\n        }\n    }\n    setSearchString(searchString) {\n        if (this._state.isRegex) {\n            searchString = strings.escapeRegExpCharacters(searchString);\n        }\n        this._state.change({ searchString: searchString }, false);\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        // overwritten in subclass\n    }\n    _start(opts, newState) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.disposeModel();\n            if (!this._editor.hasModel()) {\n                // cannot do anything with an editor that doesn't have a model...\n                return;\n            }\n            const stateChanges = Object.assign(Object.assign({}, newState), { isRevealed: true });\n            if (opts.seedSearchStringFromSelection === 'single') {\n                const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection, opts.seedSearchStringFromNonEmptySelection);\n                if (selectionSearchString) {\n                    if (this._state.isRegex) {\n                        stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\n                    }\n                    else {\n                        stateChanges.searchString = selectionSearchString;\n                    }\n                }\n            }\n            else if (opts.seedSearchStringFromSelection === 'multiple' && !opts.updateSearchScope) {\n                const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection);\n                if (selectionSearchString) {\n                    stateChanges.searchString = selectionSearchString;\n                }\n            }\n            if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\n                const selectionSearchString = yield this.getGlobalBufferTerm();\n                if (!this._editor.hasModel()) {\n                    // the editor has lost its model in the meantime\n                    return;\n                }\n                if (selectionSearchString) {\n                    stateChanges.searchString = selectionSearchString;\n                }\n            }\n            // Overwrite isReplaceRevealed\n            if (opts.forceRevealReplace || stateChanges.isReplaceRevealed) {\n                stateChanges.isReplaceRevealed = true;\n            }\n            else if (!this._findWidgetVisible.get()) {\n                stateChanges.isReplaceRevealed = false;\n            }\n            if (opts.updateSearchScope) {\n                const currentSelections = this._editor.getSelections();\n                if (currentSelections.some(selection => !selection.isEmpty())) {\n                    stateChanges.searchScope = currentSelections;\n                }\n            }\n            stateChanges.loop = opts.loop;\n            this._state.change(stateChanges, false);\n            if (!this._model) {\n                this._model = new FindModelBoundToEditorModel(this._editor, this._state);\n            }\n        });\n    }\n    start(opts, newState) {\n        return this._start(opts, newState);\n    }\n    moveToNextMatch() {\n        if (this._model) {\n            this._model.moveToNextMatch();\n            return true;\n        }\n        return false;\n    }\n    moveToPrevMatch() {\n        if (this._model) {\n            this._model.moveToPrevMatch();\n            return true;\n        }\n        return false;\n    }\n    replace() {\n        if (this._model) {\n            this._model.replace();\n            return true;\n        }\n        return false;\n    }\n    replaceAll() {\n        if (this._model) {\n            this._model.replaceAll();\n            return true;\n        }\n        return false;\n    }\n    selectAllMatches() {\n        if (this._model) {\n            this._model.selectAllMatches();\n            this._editor.focus();\n            return true;\n        }\n        return false;\n    }\n    getGlobalBufferTerm() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.getOption(37 /* EditorOption.find */).globalFindClipboard\n                && this._editor.hasModel()\n                && !this._editor.getModel().isTooLargeForSyncing()) {\n                return this._clipboardService.readFindText();\n            }\n            return '';\n        });\n    }\n    setGlobalBufferTerm(text) {\n        if (this._editor.getOption(37 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            // intentionally not awaited\n            this._clipboardService.writeFindText(text);\n        }\n    }\n};\nCommonFindController.ID = 'editor.contrib.findController';\nCommonFindController = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IStorageService),\n    __param(3, IClipboardService)\n], CommonFindController);\nexport { CommonFindController };\nlet FindController = class FindController extends CommonFindController {\n    constructor(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, _notificationService, _storageService, clipboardService) {\n        super(editor, _contextKeyService, _storageService, clipboardService);\n        this._contextViewService = _contextViewService;\n        this._keybindingService = _keybindingService;\n        this._themeService = _themeService;\n        this._notificationService = _notificationService;\n        this._widget = null;\n        this._findOptionsWidget = null;\n    }\n    _start(opts, newState) {\n        const _super = Object.create(null, {\n            _start: { get: () => super._start }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._widget) {\n                this._createFindWidget();\n            }\n            const selection = this._editor.getSelection();\n            let updateSearchScope = false;\n            switch (this._editor.getOption(37 /* EditorOption.find */).autoFindInSelection) {\n                case 'always':\n                    updateSearchScope = true;\n                    break;\n                case 'never':\n                    updateSearchScope = false;\n                    break;\n                case 'multiline': {\n                    const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                    updateSearchScope = isSelectionMultipleLine;\n                    break;\n                }\n                default:\n                    break;\n            }\n            opts.updateSearchScope = opts.updateSearchScope || updateSearchScope;\n            yield _super._start.call(this, opts, newState);\n            if (this._widget) {\n                if (opts.shouldFocus === 2 /* FindStartFocusAction.FocusReplaceInput */) {\n                    this._widget.focusReplaceInput();\n                }\n                else if (opts.shouldFocus === 1 /* FindStartFocusAction.FocusFindInput */) {\n                    this._widget.focusFindInput();\n                }\n            }\n        });\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        if (this._state.isRevealed && !ignoreWhenVisible) {\n            this._widget.highlightFindOptions();\n        }\n        else {\n            this._findOptionsWidget.highlightFindOptions();\n        }\n    }\n    _createFindWidget() {\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService, this._themeService));\n    }\n};\nFindController = __decorate([\n    __param(1, IContextViewService),\n    __param(2, IContextKeyService),\n    __param(3, IKeybindingService),\n    __param(4, IThemeService),\n    __param(5, INotificationService),\n    __param(6, IStorageService),\n    __param(7, IClipboardService)\n], FindController);\nexport { FindController };\nexport const StartFindAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindAction,\n    label: nls.localize('startFindAction', \"Find\"),\n    alias: 'Find',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\n        order: 1\n    }\n}));\nStartFindAction.addImplementation(0, (accessor, editor, args) => {\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    return controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(37 /* EditorOption.find */).globalFindClipboard,\n        shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(37 /* EditorOption.find */).loop\n    });\n});\nconst findArgDescription = {\n    description: 'Open a new In-Editor Find Widget.',\n    args: [{\n            name: 'Open a new In-Editor Find Widget args',\n            schema: {\n                properties: {\n                    searchString: { type: 'string' },\n                    replaceString: { type: 'string' },\n                    regex: { type: 'boolean' },\n                    regexOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.isRegexOverride', 'Overrides \"Use Regular Expression\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    wholeWord: { type: 'boolean' },\n                    wholeWordOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.wholeWordOverride', 'Overrides \"Match Whole Word\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    matchCase: { type: 'boolean' },\n                    matchCaseOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.matchCaseOverride', 'Overrides \"Math Case\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    preserveCase: { type: 'boolean' },\n                    preserveCaseOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.preserveCaseOverride', 'Overrides \"Preserve Case\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    findInSelection: { type: 'boolean' },\n                }\n            }\n        }]\n};\nexport class StartFindWithArgsAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithArgs,\n            label: nls.localize('startFindWithArgsAction', \"Find With Arguments\"),\n            alias: 'Find With Arguments',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: findArgDescription\n        });\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = CommonFindController.get(editor);\n            if (controller) {\n                const newState = args ? {\n                    searchString: args.searchString,\n                    replaceString: args.replaceString,\n                    isReplaceRevealed: args.replaceString !== undefined,\n                    isRegex: args.isRegex,\n                    // isRegexOverride: args.regexOverride,\n                    wholeWord: args.matchWholeWord,\n                    // wholeWordOverride: args.wholeWordOverride,\n                    matchCase: args.isCaseSensitive,\n                    // matchCaseOverride: args.matchCaseOverride,\n                    preserveCase: args.preserveCase,\n                    // preserveCaseOverride: args.preserveCaseOverride,\n                } : {};\n                yield controller.start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                    seedSearchStringFromNonEmptySelection: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                    seedSearchStringFromGlobalClipboard: true,\n                    shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n                    shouldAnimate: true,\n                    updateSearchScope: (args === null || args === void 0 ? void 0 : args.findInSelection) || false,\n                    loop: editor.getOption(37 /* EditorOption.find */).loop\n                }, newState);\n                controller.setGlobalBufferTerm(controller.getState().searchString);\n            }\n        });\n    }\n}\nexport class StartFindWithSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithSelection,\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\n            alias: 'Find With Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 35 /* KeyCode.KeyE */,\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = CommonFindController.get(editor);\n            if (controller) {\n                yield controller.start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: 'multiple',\n                    seedSearchStringFromNonEmptySelection: false,\n                    seedSearchStringFromGlobalClipboard: false,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: true,\n                    updateSearchScope: false,\n                    loop: editor.getOption(37 /* EditorOption.find */).loop\n                });\n                controller.setGlobalBufferTerm(controller.getState().searchString);\n            }\n        });\n    }\n}\nexport class MatchFindAction extends EditorAction {\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = CommonFindController.get(editor);\n            if (controller && !this._run(controller)) {\n                yield controller.start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                    seedSearchStringFromNonEmptySelection: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                    seedSearchStringFromGlobalClipboard: true,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: true,\n                    updateSearchScope: false,\n                    loop: editor.getOption(37 /* EditorOption.find */).loop\n                });\n                this._run(controller);\n            }\n        });\n    }\n}\nexport class NextMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextMatchFindAction,\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\n            alias: 'Find Next',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 37 /* KeyCode.KeyG */, secondary: [61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }]\n        });\n    }\n    _run(controller) {\n        const result = controller.moveToNextMatch();\n        if (result) {\n            controller.editor.pushUndoStop();\n            return true;\n        }\n        return false;\n    }\n}\nexport class PreviousMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousMatchFindAction,\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n            alias: 'Find Previous',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 37 /* KeyCode.KeyG */, secondary: [1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            ]\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport class SelectionMatchFindAction extends EditorAction {\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = CommonFindController.get(editor);\n            if (!controller) {\n                return;\n            }\n            const seedSearchStringFromNonEmptySelection = editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection === 'selection';\n            let selectionSearchString = null;\n            if (editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never') {\n                selectionSearchString = getSelectionSearchString(editor, 'single', seedSearchStringFromNonEmptySelection);\n            }\n            if (selectionSearchString) {\n                controller.setSearchString(selectionSearchString);\n            }\n            if (!this._run(controller)) {\n                yield controller.start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                    seedSearchStringFromNonEmptySelection: seedSearchStringFromNonEmptySelection,\n                    seedSearchStringFromGlobalClipboard: false,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: true,\n                    updateSearchScope: false,\n                    loop: editor.getOption(37 /* EditorOption.find */).loop\n                });\n                this._run(controller);\n            }\n        });\n    }\n}\nexport class NextSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextSelectionMatchFindAction,\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\n            alias: 'Find Next Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToNextMatch();\n    }\n}\nexport class PreviousSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\n            alias: 'Find Previous Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport const StartFindReplaceAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindReplaceAction,\n    label: nls.localize('startReplace', \"Replace\"),\n    alias: 'Replace',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 38 /* KeyCode.KeyH */,\n        mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */ },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\n        order: 2\n    }\n}));\nStartFindReplaceAction.addImplementation(0, (accessor, editor, args) => {\n    if (!editor.hasModel() || editor.getOption(83 /* EditorOption.readOnly */)) {\n        return false;\n    }\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    const currentSelection = editor.getSelection();\n    const findInputFocused = controller.isFindInputFocused();\n    // we only seed search string from selection when the current selection is single line and not empty,\n    // + the find input is not focused\n    const seedSearchStringFromSelection = !currentSelection.isEmpty()\n        && currentSelection.startLineNumber === currentSelection.endLineNumber\n        && (editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never')\n        && !findInputFocused;\n    /*\n    * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\n\n    * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\n    * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\n    * findInputFocused false seedSearchStringFromSelection false FocusFindInput\n    */\n    const shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\n        2 /* FindStartFocusAction.FocusReplaceInput */ : 1 /* FindStartFocusAction.FocusFindInput */;\n    return controller.start({\n        forceRevealReplace: true,\n        seedSearchStringFromSelection: seedSearchStringFromSelection ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(37 /* EditorOption.find */).seedSearchStringFromSelection !== 'never',\n        shouldFocus: shouldFocus,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(37 /* EditorOption.find */).loop\n    });\n});\nregisterEditorContribution(CommonFindController.ID, FindController);\nregisterEditorAction(StartFindWithArgsAction);\nregisterEditorAction(StartFindWithSelectionAction);\nregisterEditorAction(NextMatchFindAction);\nregisterEditorAction(PreviousMatchFindAction);\nregisterEditorAction(NextSelectionMatchFindAction);\nregisterEditorAction(PreviousSelectionMatchFindAction);\nconst FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.CloseFindWidgetCommand,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.closeFindWidget(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\n    precondition: undefined,\n    handler: x => x.toggleCaseSensitive(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleCaseSensitiveKeybinding.primary,\n        mac: ToggleCaseSensitiveKeybinding.mac,\n        win: ToggleCaseSensitiveKeybinding.win,\n        linux: ToggleCaseSensitiveKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleWholeWordCommand,\n    precondition: undefined,\n    handler: x => x.toggleWholeWords(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleWholeWordKeybinding.primary,\n        mac: ToggleWholeWordKeybinding.mac,\n        win: ToggleWholeWordKeybinding.win,\n        linux: ToggleWholeWordKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleRegexCommand,\n    precondition: undefined,\n    handler: x => x.toggleRegex(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleRegexKeybinding.primary,\n        mac: ToggleRegexKeybinding.mac,\n        win: ToggleRegexKeybinding.win,\n        linux: ToggleRegexKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleSearchScopeCommand,\n    precondition: undefined,\n    handler: x => x.toggleSearchScope(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleSearchScopeKeybinding.primary,\n        mac: ToggleSearchScopeKeybinding.mac,\n        win: ToggleSearchScopeKeybinding.win,\n        linux: ToggleSearchScopeKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.TogglePreserveCaseCommand,\n    precondition: undefined,\n    handler: x => x.togglePreserveCase(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: TogglePreserveCaseKeybinding.primary,\n        mac: TogglePreserveCaseKeybinding.mac,\n        win: TogglePreserveCaseKeybinding.win,\n        linux: TogglePreserveCaseKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 22 /* KeyCode.Digit1 */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: undefined,\n        mac: {\n            primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n        }\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.SelectAllMatchesAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.selectAllMatches(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\nconst MASK_INDENT = 0xFF000000;\nclass BitField {\n    constructor(size) {\n        const numWords = Math.ceil(size / 32);\n        this._states = new Uint32Array(numWords);\n    }\n    get(index) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        return (this._states[arrayIndex] & (1 << bit)) !== 0;\n    }\n    set(index, newState) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        const value = this._states[arrayIndex];\n        if (newState) {\n            this._states[arrayIndex] = value | (1 << bit);\n        }\n        else {\n            this._states[arrayIndex] = value & ~(1 << bit);\n        }\n    }\n}\nexport class FoldingRegions {\n    constructor(startIndexes, endIndexes, types) {\n        this.sourceAbbr = {\n            [0 /* FoldSource.provider */]: ' ',\n            [1 /* FoldSource.userDefined */]: 'u',\n            [2 /* FoldSource.recovered */]: 'r',\n        };\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\n            throw new Error('invalid startIndexes or endIndexes size');\n        }\n        this._startIndexes = startIndexes;\n        this._endIndexes = endIndexes;\n        this._collapseStates = new BitField(startIndexes.length);\n        this._userDefinedStates = new BitField(startIndexes.length);\n        this._recoveredStates = new BitField(startIndexes.length);\n        this._types = types;\n        this._parentsComputed = false;\n    }\n    ensureParentIndices() {\n        if (!this._parentsComputed) {\n            this._parentsComputed = true;\n            const parentIndexes = [];\n            const isInsideLast = (startLineNumber, endLineNumber) => {\n                const index = parentIndexes[parentIndexes.length - 1];\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\n            };\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\n                const startLineNumber = this._startIndexes[i];\n                const endLineNumber = this._endIndexes[i];\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\n                }\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\n                    parentIndexes.pop();\n                }\n                const parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\n                parentIndexes.push(i);\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\n            }\n        }\n    }\n    get length() {\n        return this._startIndexes.length;\n    }\n    getStartLineNumber(index) {\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getEndLineNumber(index) {\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getType(index) {\n        return this._types ? this._types[index] : undefined;\n    }\n    hasTypes() {\n        return !!this._types;\n    }\n    isCollapsed(index) {\n        return this._collapseStates.get(index);\n    }\n    setCollapsed(index, newState) {\n        this._collapseStates.set(index, newState);\n    }\n    isUserDefined(index) {\n        return this._userDefinedStates.get(index);\n    }\n    setUserDefined(index, newState) {\n        return this._userDefinedStates.set(index, newState);\n    }\n    isRecovered(index) {\n        return this._recoveredStates.get(index);\n    }\n    setRecovered(index, newState) {\n        return this._recoveredStates.set(index, newState);\n    }\n    getSource(index) {\n        if (this.isUserDefined(index)) {\n            return 1 /* FoldSource.userDefined */;\n        }\n        else if (this.isRecovered(index)) {\n            return 2 /* FoldSource.recovered */;\n        }\n        return 0 /* FoldSource.provider */;\n    }\n    setSource(index, source) {\n        if (source === 1 /* FoldSource.userDefined */) {\n            this.setUserDefined(index, true);\n            this.setRecovered(index, false);\n        }\n        else if (source === 2 /* FoldSource.recovered */) {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, true);\n        }\n        else {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, false);\n        }\n    }\n    setCollapsedAllOfType(type, newState) {\n        let hasChanged = false;\n        if (this._types) {\n            for (let i = 0; i < this._types.length; i++) {\n                if (this._types[i] === type) {\n                    this.setCollapsed(i, newState);\n                    hasChanged = true;\n                }\n            }\n        }\n        return hasChanged;\n    }\n    toRegion(index) {\n        return new FoldingRegion(this, index);\n    }\n    getParentIndex(index) {\n        this.ensureParentIndices();\n        const parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\n        if (parent === MAX_FOLDING_REGIONS) {\n            return -1;\n        }\n        return parent;\n    }\n    contains(index, line) {\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\n    }\n    findIndex(line) {\n        let low = 0, high = this._startIndexes.length;\n        if (high === 0) {\n            return -1; // no children\n        }\n        while (low < high) {\n            const mid = Math.floor((low + high) / 2);\n            if (line < this.getStartLineNumber(mid)) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        return low - 1;\n    }\n    findRange(line) {\n        let index = this.findIndex(line);\n        if (index >= 0) {\n            const endLineNumber = this.getEndLineNumber(index);\n            if (endLineNumber >= line) {\n                return index;\n            }\n            index = this.getParentIndex(index);\n            while (index !== -1) {\n                if (this.contains(index, line)) {\n                    return index;\n                }\n                index = this.getParentIndex(index);\n            }\n        }\n        return -1;\n    }\n    toString() {\n        const res = [];\n        for (let i = 0; i < this.length; i++) {\n            res[i] = `[${this.sourceAbbr[this.getSource(i)]}${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\n        }\n        return res.join(', ');\n    }\n    toFoldRange(index) {\n        return {\n            startLineNumber: this._startIndexes[index] & MAX_LINE_NUMBER,\n            endLineNumber: this._endIndexes[index] & MAX_LINE_NUMBER,\n            type: this._types ? this._types[index] : undefined,\n            isCollapsed: this.isCollapsed(index),\n            source: this.getSource(index)\n        };\n    }\n    static fromFoldRanges(ranges) {\n        const rangesLength = ranges.length;\n        const startIndexes = new Uint32Array(rangesLength);\n        const endIndexes = new Uint32Array(rangesLength);\n        let types = [];\n        let gotTypes = false;\n        for (let i = 0; i < rangesLength; i++) {\n            const range = ranges[i];\n            startIndexes[i] = range.startLineNumber;\n            endIndexes[i] = range.endLineNumber;\n            types.push(range.type);\n            if (range.type) {\n                gotTypes = true;\n            }\n        }\n        if (!gotTypes) {\n            types = undefined;\n        }\n        const regions = new FoldingRegions(startIndexes, endIndexes, types);\n        for (let i = 0; i < rangesLength; i++) {\n            if (ranges[i].isCollapsed) {\n                regions.setCollapsed(i, true);\n            }\n            regions.setSource(i, ranges[i].source);\n        }\n        return regions;\n    }\n    /**\n     * Two inputs, each a FoldingRegions or a FoldRange[], are merged.\n     * Each input must be pre-sorted on startLineNumber.\n     * The first list is assumed to always include all regions currently defined by range providers.\n     * The second list only contains the previously collapsed and all manual ranges.\n     * If the line position matches, the range of the new range is taken, and the range is no longer manual\n     * When an entry in one list overlaps an entry in the other, the second list's entry \"wins\" and\n     * overlapping entries in the first list are discarded.\n     * Invalid entries are discarded. An entry is invalid if:\n     * \t\tthe start and end line numbers aren't a valid range of line numbers,\n     * \t\tit is out of sequence or has the same start line as a preceding entry,\n     * \t\tit overlaps a preceding entry and is not fully contained by that entry.\n     */\n    static sanitizeAndMerge(rangesA, rangesB, maxLineNumber) {\n        maxLineNumber = maxLineNumber !== null && maxLineNumber !== void 0 ? maxLineNumber : Number.MAX_VALUE;\n        const getIndexedFunction = (r, limit) => {\n            return Array.isArray(r)\n                ? ((i) => { return (i < limit) ? r[i] : undefined; })\n                : ((i) => { return (i < limit) ? r.toFoldRange(i) : undefined; });\n        };\n        const getA = getIndexedFunction(rangesA, rangesA.length);\n        const getB = getIndexedFunction(rangesB, rangesB.length);\n        let indexA = 0;\n        let indexB = 0;\n        let nextA = getA(0);\n        let nextB = getB(0);\n        const stackedRanges = [];\n        let topStackedRange;\n        let prevLineNumber = 0;\n        const resultRanges = [];\n        while (nextA || nextB) {\n            let useRange = undefined;\n            if (nextB && (!nextA || nextA.startLineNumber >= nextB.startLineNumber)) {\n                if (nextA && nextA.startLineNumber === nextB.startLineNumber) {\n                    if (nextB.source === 1 /* FoldSource.userDefined */) {\n                        // a user defined range (possibly unfolded)\n                        useRange = nextB;\n                    }\n                    else {\n                        // a previously folded range or a (possibly unfolded) recovered range\n                        useRange = nextA;\n                        useRange.isCollapsed = nextB.isCollapsed && nextA.endLineNumber === nextB.endLineNumber;\n                        useRange.source = 0 /* FoldSource.provider */;\n                    }\n                    nextA = getA(++indexA); // not necessary, just for speed\n                }\n                else {\n                    useRange = nextB;\n                    if (nextB.isCollapsed && nextB.source === 0 /* FoldSource.provider */) {\n                        // a previously collapsed range\n                        useRange.source = 2 /* FoldSource.recovered */;\n                    }\n                }\n                nextB = getB(++indexB);\n            }\n            else {\n                // nextA is next. The user folded B set takes precedence and we sometimes need to look\n                // ahead in it to check for an upcoming conflict.\n                let scanIndex = indexB;\n                let prescanB = nextB;\n                while (true) {\n                    if (!prescanB || prescanB.startLineNumber > nextA.endLineNumber) {\n                        useRange = nextA;\n                        break; // no conflict, use this nextA\n                    }\n                    if (prescanB.source === 1 /* FoldSource.userDefined */ && prescanB.endLineNumber > nextA.endLineNumber) {\n                        // we found a user folded range, it wins\n                        break; // without setting nextResult, so this nextA gets skipped\n                    }\n                    prescanB = getB(++scanIndex);\n                }\n                nextA = getA(++indexA);\n            }\n            if (useRange) {\n                while (topStackedRange\n                    && topStackedRange.endLineNumber < useRange.startLineNumber) {\n                    topStackedRange = stackedRanges.pop();\n                }\n                if (useRange.endLineNumber > useRange.startLineNumber\n                    && useRange.startLineNumber > prevLineNumber\n                    && useRange.endLineNumber <= maxLineNumber\n                    && (!topStackedRange\n                        || topStackedRange.endLineNumber >= useRange.endLineNumber)) {\n                    resultRanges.push(useRange);\n                    prevLineNumber = useRange.startLineNumber;\n                    if (topStackedRange) {\n                        stackedRanges.push(topStackedRange);\n                    }\n                    topStackedRange = useRange;\n                }\n            }\n        }\n        return resultRanges;\n    }\n}\nexport class FoldingRegion {\n    constructor(ranges, index) {\n        this.ranges = ranges;\n        this.index = index;\n    }\n    get startLineNumber() {\n        return this.ranges.getStartLineNumber(this.index);\n    }\n    get endLineNumber() {\n        return this.ranges.getEndLineNumber(this.index);\n    }\n    get regionIndex() {\n        return this.index;\n    }\n    get parentIndex() {\n        return this.ranges.getParentIndex(this.index);\n    }\n    get isCollapsed() {\n        return this.ranges.isCollapsed(this.index);\n    }\n    containedBy(range) {\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\n    }\n    containsLine(lineNumber) {\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { hash } from '../../../../base/common/hash.js';\nexport class FoldingModel {\n    constructor(textModel, decorationProvider) {\n        this._updateEventEmitter = new Emitter();\n        this.onDidChange = this._updateEventEmitter.event;\n        this._textModel = textModel;\n        this._decorationProvider = decorationProvider;\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\n        this._editorDecorationIds = [];\n    }\n    get regions() { return this._regions; }\n    get textModel() { return this._textModel; }\n    toggleCollapseState(toggledRegions) {\n        if (!toggledRegions.length) {\n            return;\n        }\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\n        const processed = {};\n        this._decorationProvider.changeDecorations(accessor => {\n            let k = 0; // index from [0 ... this.regions.length]\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\n            let lastHiddenLine = -1; // the end of the last hidden lines\n            const updateDecorationsUntil = (index) => {\n                while (k < index) {\n                    const endLineNumber = this._regions.getEndLineNumber(k);\n                    const isCollapsed = this._regions.isCollapsed(k);\n                    if (endLineNumber <= dirtyRegionEndLine) {\n                        const isManual = this.regions.getSource(k) !== 0 /* FoldSource.provider */;\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual));\n                    }\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\n                        lastHiddenLine = endLineNumber;\n                    }\n                    k++;\n                }\n            };\n            for (const region of toggledRegions) {\n                const index = region.regionIndex;\n                const editorDecorationId = this._editorDecorationIds[index];\n                if (editorDecorationId && !processed[editorDecorationId]) {\n                    processed[editorDecorationId] = true;\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\n                    const newCollapseState = !this._regions.isCollapsed(index);\n                    this._regions.setCollapsed(index, newCollapseState);\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\n                }\n            }\n            updateDecorationsUntil(this._regions.length);\n        });\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\n    }\n    removeManualRanges(ranges) {\n        const newFoldingRanges = new Array();\n        const intersects = (foldRange) => {\n            for (const range of ranges) {\n                if (!(range.startLineNumber > foldRange.endLineNumber || foldRange.startLineNumber > range.endLineNumber)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        for (let i = 0; i < this._regions.length; i++) {\n            const foldRange = this._regions.toFoldRange(i);\n            if (foldRange.source === 0 /* FoldSource.provider */ || !intersects(foldRange)) {\n                newFoldingRanges.push(foldRange);\n            }\n        }\n        this.updatePost(FoldingRegions.fromFoldRanges(newFoldingRanges));\n    }\n    update(newRegions, blockedLineNumers = []) {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges(blockedLineNumers);\n        const newRanges = FoldingRegions.sanitizeAndMerge(newRegions, foldedOrManualRanges, this._textModel.getLineCount());\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    updatePost(newRegions) {\n        const newEditorDecorations = [];\n        let lastHiddenLine = -1;\n        for (let index = 0, limit = newRegions.length; index < limit; index++) {\n            const startLineNumber = newRegions.getStartLineNumber(index);\n            const endLineNumber = newRegions.getEndLineNumber(index);\n            const isCollapsed = newRegions.isCollapsed(index);\n            const isManual = newRegions.getSource(index) !== 0 /* FoldSource.provider */;\n            const decorationRange = {\n                startLineNumber: startLineNumber,\n                startColumn: this._textModel.getLineMaxColumn(startLineNumber),\n                endLineNumber: endLineNumber,\n                endColumn: this._textModel.getLineMaxColumn(endLineNumber) + 1\n            };\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual) });\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\n                lastHiddenLine = endLineNumber;\n            }\n        }\n        this._decorationProvider.changeDecorations(accessor => this._editorDecorationIds = accessor.deltaDecorations(this._editorDecorationIds, newEditorDecorations));\n        this._regions = newRegions;\n        this._updateEventEmitter.fire({ model: this });\n    }\n    _currentFoldedOrManualRanges(blockedLineNumers = []) {\n        const isBlocked = (startLineNumber, endLineNumber) => {\n            for (const blockedLineNumber of blockedLineNumers) {\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\n                    return true;\n                }\n            }\n            return false;\n        };\n        const foldedRanges = [];\n        for (let i = 0, limit = this._regions.length; i < limit; i++) {\n            let isCollapsed = this.regions.isCollapsed(i);\n            const source = this.regions.getSource(i);\n            if (isCollapsed || source !== 0 /* FoldSource.provider */) {\n                const foldRange = this._regions.toFoldRange(i);\n                const decRange = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\n                if (decRange) {\n                    if (isCollapsed && (isBlocked(decRange.startLineNumber, decRange.endLineNumber) || decRange.endLineNumber - decRange.startLineNumber !== foldRange.endLineNumber - foldRange.startLineNumber)) {\n                        isCollapsed = false; // uncollapse is the range is blocked or there has been lines removed or added\n                    }\n                    foldedRanges.push({\n                        startLineNumber: decRange.startLineNumber,\n                        endLineNumber: decRange.endLineNumber,\n                        type: foldRange.type,\n                        isCollapsed,\n                        source\n                    });\n                }\n            }\n        }\n        return foldedRanges;\n    }\n    /**\n     * Collapse state memento, for persistence only\n     */\n    getMemento() {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges();\n        const result = [];\n        for (let i = 0, limit = foldedOrManualRanges.length; i < limit; i++) {\n            const range = foldedOrManualRanges[i];\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            result.push({\n                startLineNumber: range.startLineNumber,\n                endLineNumber: range.endLineNumber,\n                isCollapsed: range.isCollapsed,\n                source: range.source,\n                checksum: checksum\n            });\n        }\n        return (result.length > 0) ? result : undefined;\n    }\n    /**\n     * Apply persisted state, for persistence only\n     */\n    applyMemento(state) {\n        var _a, _b;\n        if (!Array.isArray(state)) {\n            return;\n        }\n        const rangesToRestore = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (const range of state) {\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            if (!range.checksum || checksum === range.checksum) {\n                rangesToRestore.push({\n                    startLineNumber: range.startLineNumber,\n                    endLineNumber: range.endLineNumber,\n                    type: undefined,\n                    isCollapsed: (_a = range.isCollapsed) !== null && _a !== void 0 ? _a : true,\n                    source: (_b = range.source) !== null && _b !== void 0 ? _b : 0 /* FoldSource.provider */\n                });\n            }\n        }\n        const newRanges = FoldingRegions.sanitizeAndMerge(this._regions, rangesToRestore, maxLineNumber);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    _getLinesChecksum(lineNumber1, lineNumber2) {\n        const h = hash(this._textModel.getLineContent(lineNumber1)\n            + this._textModel.getLineContent(lineNumber2));\n        return h % 1000000; // 6 digits is plenty\n    }\n    dispose() {\n        this._decorationProvider.removeDecorations(this._editorDecorationIds);\n    }\n    getAllRegionsAtLine(lineNumber, filter) {\n        const result = [];\n        if (this._regions) {\n            let index = this._regions.findRange(lineNumber);\n            let level = 1;\n            while (index >= 0) {\n                const current = this._regions.toRegion(index);\n                if (!filter || filter(current, level)) {\n                    result.push(current);\n                }\n                level++;\n                index = current.parentIndex;\n            }\n        }\n        return result;\n    }\n    getRegionAtLine(lineNumber) {\n        if (this._regions) {\n            const index = this._regions.findRange(lineNumber);\n            if (index >= 0) {\n                return this._regions.toRegion(index);\n            }\n        }\n        return null;\n    }\n    getRegionsInside(region, filter) {\n        const result = [];\n        const index = region ? region.regionIndex + 1 : 0;\n        const endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\n        if (filter && filter.length === 2) {\n            const levelStack = [];\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\n                        levelStack.pop();\n                    }\n                    levelStack.push(current);\n                    if (filter(current, levelStack.length)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    if (!filter || filter(current)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n}\n/**\n * Collapse or expand the regions at the given locations\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region) {\n            const doCollapse = !region.isCollapsed;\n            toToggle.push(region);\n            if (levels > 1) {\n                const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                toToggle.push(...regionsInside);\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all children.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\n    const toToggle = [];\n    if (lineNumbers && lineNumbers.length > 0) {\n        for (const lineNumber of lineNumbers) {\n            const region = foldingModel.getRegionAtLine(lineNumber);\n            if (region) {\n                if (region.isCollapsed !== doCollapse) {\n                    toToggle.push(region);\n                }\n                if (levels > 1) {\n                    const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                    toToggle.push(...regionsInside);\n                }\n            }\n        }\n    }\n    else {\n        const regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n        toToggle.push(...regionsInside);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all parents.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\n        toToggle.push(...regions);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\n * @param doCollapse Whether to collapse or expand\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\n        if (regions.length > 0) {\n            toToggle.push(regions[0]);\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\n * @param foldLevel level. Level == 1 is the top level\n * @param doCollapse Whether to collapse or expand\n*/\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\n    const filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\n * @param doCollapse Whether to collapse or expand\n * @param blockedLineNumbers the location of regions to not collapse or expand\n */\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\n    const filteredRegions = [];\n    for (const lineNumber of blockedLineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, undefined);\n        if (regions.length > 0) {\n            filteredRegions.push(regions[0]);\n        }\n    }\n    const filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions for which the lines start with a given regex\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\n    const editorModel = foldingModel.textModel;\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i)) {\n            const startLineNumber = regions.getStartLineNumber(i);\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\n                toToggle.push(regions.toRegion(i));\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions of the given type\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\n            toToggle.push(regions.toRegion(i));\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Get line to go to for parent fold of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Parent fold start line\n */\nexport function getParentFoldLine(lineNumber, foldingModel) {\n    let startLineNumber = null;\n    const foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    if (foldingRegion !== null) {\n        startLineNumber = foldingRegion.startLineNumber;\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\n        if (lineNumber === startLineNumber) {\n            const parentFoldingIdx = foldingRegion.parentIndex;\n            if (parentFoldingIdx !== -1) {\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\n            }\n            else {\n                startLineNumber = null;\n            }\n        }\n    }\n    return startLineNumber;\n}\n/**\n * Get line to go to for previous fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Previous fold start line\n */\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to previous sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\n        if (lineNumber !== foldingRegion.startLineNumber) {\n            return foldingRegion.startLineNumber;\n        }\n        else {\n            // Find min line number to stay within parent.\n            const expectedParentIndex = foldingRegion.parentIndex;\n            let minLineNumber = 0;\n            if (expectedParentIndex !== -1) {\n                minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\n            }\n            // Find fold at same level.\n            while (foldingRegion !== null) {\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                    // Keep at same level.\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\n                        return null;\n                    }\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\n                        return foldingRegion.startLineNumber;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    }\n    else {\n        // Go to last fold that's before the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(foldingModel.regions.length - 1);\n            while (foldingRegion !== null) {\n                // Found fold before current line.\n                if (foldingRegion.startLineNumber < lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * Get line to go to next fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Next fold start line\n */\nexport function getNextFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to next sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // Find max line number to stay within parent.\n        const expectedParentIndex = foldingRegion.parentIndex;\n        let maxLineNumber = 0;\n        if (expectedParentIndex !== -1) {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\n        }\n        else if (foldingModel.regions.length === 0) {\n            return null;\n        }\n        else {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingModel.regions.length - 1);\n        }\n        // Find fold at same level.\n        while (foldingRegion !== null) {\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                // Keep at same level.\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\n                    return null;\n                }\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\n                    return foldingRegion.startLineNumber;\n                }\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    else {\n        // Go to first fold that's after the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(0);\n            while (foldingRegion !== null) {\n                // Found fold after current line.\n                if (foldingRegion.startLineNumber > lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstInSorted } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Range } from '../../../common/core/range.js';\nimport { countEOL } from '../../../common/core/eolCounter.js';\nexport class HiddenRangeModel {\n    constructor(model) {\n        this._updateEventEmitter = new Emitter();\n        this._hasLineChanges = false;\n        this._foldingModel = model;\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\n        this._hiddenRanges = [];\n        if (model.regions.length) {\n            this.updateHiddenRanges();\n        }\n    }\n    get onDidChange() { return this._updateEventEmitter.event; }\n    get hiddenRanges() { return this._hiddenRanges; }\n    notifyChangeModelContent(e) {\n        if (this._hiddenRanges.length && !this._hasLineChanges) {\n            this._hasLineChanges = e.changes.some(change => {\n                return change.range.endLineNumber !== change.range.startLineNumber || countEOL(change.text)[0] !== 0;\n            });\n        }\n    }\n    updateHiddenRanges() {\n        let updateHiddenAreas = false;\n        const newHiddenAreas = [];\n        let i = 0; // index into hidden\n        let k = 0;\n        let lastCollapsedStart = Number.MAX_VALUE;\n        let lastCollapsedEnd = -1;\n        const ranges = this._foldingModel.regions;\n        for (; i < ranges.length; i++) {\n            if (!ranges.isCollapsed(i)) {\n                continue;\n            }\n            const startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\n            const endLineNumber = ranges.getEndLineNumber(i);\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\n                // ignore ranges contained in collapsed regions\n                continue;\n            }\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\n                // reuse the old ranges\n                newHiddenAreas.push(this._hiddenRanges[k]);\n                k++;\n            }\n            else {\n                updateHiddenAreas = true;\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\n            }\n            lastCollapsedStart = startLineNumber;\n            lastCollapsedEnd = endLineNumber;\n        }\n        if (this._hasLineChanges || updateHiddenAreas || k < this._hiddenRanges.length) {\n            this.applyHiddenRanges(newHiddenAreas);\n        }\n    }\n    applyHiddenRanges(newHiddenAreas) {\n        this._hiddenRanges = newHiddenAreas;\n        this._hasLineChanges = false;\n        this._updateEventEmitter.fire(newHiddenAreas);\n    }\n    hasRanges() {\n        return this._hiddenRanges.length > 0;\n    }\n    isHidden(line) {\n        return findRange(this._hiddenRanges, line) !== null;\n    }\n    adjustSelections(selections) {\n        let hasChanges = false;\n        const editorModel = this._foldingModel.textModel;\n        let lastRange = null;\n        const adjustLine = (line) => {\n            if (!lastRange || !isInside(line, lastRange)) {\n                lastRange = findRange(this._hiddenRanges, line);\n            }\n            if (lastRange) {\n                return lastRange.startLineNumber - 1;\n            }\n            return null;\n        };\n        for (let i = 0, len = selections.length; i < len; i++) {\n            let selection = selections[i];\n            const adjustedStartLine = adjustLine(selection.startLineNumber);\n            if (adjustedStartLine) {\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\n                hasChanges = true;\n            }\n            const adjustedEndLine = adjustLine(selection.endLineNumber);\n            if (adjustedEndLine) {\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\n                hasChanges = true;\n            }\n            selections[i] = selection;\n        }\n        return hasChanges;\n    }\n    dispose() {\n        if (this.hiddenRanges.length > 0) {\n            this._hiddenRanges = [];\n            this._updateEventEmitter.fire(this._hiddenRanges);\n        }\n        if (this._foldingModelListener) {\n            this._foldingModelListener.dispose();\n            this._foldingModelListener = null;\n        }\n    }\n}\nfunction isInside(line, range) {\n    return line >= range.startLineNumber && line <= range.endLineNumber;\n}\nfunction findRange(ranges, line) {\n    const i = findFirstInSorted(ranges, r => line < r.startLineNumber) - 1;\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\n        return ranges[i];\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT = 5000;\nexport const ID_INDENT_PROVIDER = 'indent';\nexport class IndentRangeProvider {\n    constructor(editorModel, languageConfigurationService, maxFoldingRegions) {\n        this.editorModel = editorModel;\n        this.languageConfigurationService = languageConfigurationService;\n        this.maxFoldingRegions = maxFoldingRegions;\n        this.id = ID_INDENT_PROVIDER;\n    }\n    dispose() { }\n    compute(cancelationToken, notifyTooManyRegions) {\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules;\n        const offSide = foldingRules && !!foldingRules.offSide;\n        const markers = foldingRules && foldingRules.markers;\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers, this.maxFoldingRegions, notifyTooManyRegions));\n    }\n}\n// public only for testing\nexport class RangesCollector {\n    constructor(foldingRangesLimit, _notifyTooManyRegions) {\n        this._notifyTooManyRegions = _notifyTooManyRegions;\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._indentOccurrences = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    insertFirst(startLineNumber, endLineNumber, indent) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._length++;\n        if (indent < 1000) {\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\n        }\n    }\n    toIndentRanges(model) {\n        var _a;\n        if (this._length <= this._foldingRangesLimit) {\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\n                startIndexes[k] = this._startIndexes[i];\n                endIndexes[k] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n        else {\n            (_a = this._notifyTooManyRegions) === null || _a === void 0 ? void 0 : _a.call(this, this._foldingRangesLimit);\n            let entries = 0;\n            let maxIndent = this._indentOccurrences.length;\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\n                const n = this._indentOccurrences[i];\n                if (n) {\n                    if (n + entries > this._foldingRangesLimit) {\n                        maxIndent = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const tabSize = model.getOptions().tabSize;\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._foldingRangesLimit);\n            const endIndexes = new Uint32Array(this._foldingRangesLimit);\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\n                const startIndex = this._startIndexes[i];\n                const lineContent = model.getLineContent(startIndex);\n                const indent = computeIndentLevel(lineContent, tabSize);\n                if (indent < maxIndent || (indent === maxIndent && entries++ < this._foldingRangesLimit)) {\n                    startIndexes[k] = startIndex;\n                    endIndexes[k] = this._endIndexes[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n    }\n}\nexport function computeRanges(model, offSide, markers, foldingRangesLimit, notifyTooManyRegions) {\n    const tabSize = model.getOptions().tabSize;\n    foldingRangesLimit = foldingRangesLimit !== null && foldingRangesLimit !== void 0 ? foldingRangesLimit : MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT;\n    const result = new RangesCollector(foldingRangesLimit, notifyTooManyRegions);\n    let pattern = undefined;\n    if (markers) {\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\n    }\n    const previousRegions = [];\n    const line = model.getLineCount() + 1;\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\n    for (let line = model.getLineCount(); line > 0; line--) {\n        const lineContent = model.getLineContent(line);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        let previous = previousRegions[previousRegions.length - 1];\n        if (indent === -1) {\n            if (offSide) {\n                // for offSide languages, empty lines are associated to the previous block\n                // note: the next block is already written to the results, so this only\n                // impacts the end position of the block before\n                previous.endAbove = line;\n            }\n            continue; // only whitespace\n        }\n        let m;\n        if (pattern && (m = lineContent.match(pattern))) {\n            // folding pattern match\n            if (m[1]) { // start pattern match\n                // discard all regions until the folding pattern\n                let i = previousRegions.length - 1;\n                while (i > 0 && previousRegions[i].indent !== -2) {\n                    i--;\n                }\n                if (i > 0) {\n                    previousRegions.length = i + 1;\n                    previous = previousRegions[i];\n                    // new folding range from pattern, includes the end line\n                    result.insertFirst(line, previous.line, indent);\n                    previous.line = line;\n                    previous.indent = indent;\n                    previous.endAbove = line;\n                    continue;\n                }\n                else {\n                    // no end marker found, treat line as a regular line\n                }\n            }\n            else { // end pattern match\n                previousRegions.push({ indent: -2, endAbove: line, line });\n                continue;\n            }\n        }\n        if (previous.indent > indent) {\n            // discard all regions with larger indent\n            do {\n                previousRegions.pop();\n                previous = previousRegions[previousRegions.length - 1];\n            } while (previous.indent > indent);\n            // new folding range\n            const endLineNumber = previous.endAbove - 1;\n            if (endLineNumber - line >= 1) { // needs at east size 1\n                result.insertFirst(line, endLineNumber, indent);\n            }\n        }\n        if (previous.indent === indent) {\n            previous.endAbove = line;\n        }\n        else { // previous.indent < indent\n            // new region with a bigger indent\n            previousRegions.push({ indent, endAbove: line, line });\n        }\n    }\n    return result.toIndentRanges(model);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { localize } from '../../../../nls.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../platform/theme/common/themeService.js';\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\nexport const foldingManualCollapsedIcon = registerIcon('folding-manual-collapsed', foldingCollapsedIcon, localize('foldingManualCollapedIcon', 'Icon for manually collapsed ranges in the editor glyph margin.'));\nexport const foldingManualExpandedIcon = registerIcon('folding-manual-expanded', foldingExpandedIcon, localize('foldingManualExpandedIcon', 'Icon for manually expanded ranges in the editor glyph margin.'));\nexport class FoldingDecorationProvider {\n    constructor(editor) {\n        this.editor = editor;\n        this.showFoldingControls = 'mouseover';\n        this.showFoldingHighlights = true;\n    }\n    getDecorationOption(isCollapsed, isHidden, isManual) {\n        if (isHidden // is inside another collapsed region\n            || this.showFoldingControls === 'never') {\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\n        }\n        if (isCollapsed) {\n            return isManual ?\n                (this.showFoldingHighlights ? FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION)\n                : (this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION);\n        }\n        else if (this.showFoldingControls === 'mouseover') {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\n        }\n        else {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\n        }\n    }\n    changeDecorations(callback) {\n        return this.editor.changeDecorations(callback);\n    }\n    removeDecorations(decorationIds) {\n        this.editor.removeDecorations(decorationIds);\n    }\n}\nFoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n});\nFoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-auto-hide-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-hidden-range-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst foldingContext = {};\nexport const ID_SYNTAX_PROVIDER = 'syntax';\nexport class SyntaxRangeProvider {\n    constructor(editorModel, providers, handleFoldingRangesChange, limit) {\n        this.editorModel = editorModel;\n        this.providers = providers;\n        this.limit = limit;\n        this.id = ID_SYNTAX_PROVIDER;\n        for (const provider of providers) {\n            if (typeof provider.onDidChange === 'function') {\n                if (!this.disposables) {\n                    this.disposables = new DisposableStore();\n                }\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\n            }\n        }\n    }\n    compute(cancellationToken, notifyTooManyRegions) {\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\n            if (ranges) {\n                const res = sanitizeRanges(ranges, this.limit, notifyTooManyRegions);\n                return res;\n            }\n            return null;\n        });\n    }\n    dispose() {\n        var _a;\n        (_a = this.disposables) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n}\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\n    let rangeData = null;\n    const promises = providers.map((provider, i) => {\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\n            if (cancellationToken.isCancellationRequested) {\n                return;\n            }\n            if (Array.isArray(ranges)) {\n                if (!Array.isArray(rangeData)) {\n                    rangeData = [];\n                }\n                const nLines = model.getLineCount();\n                for (const r of ranges) {\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\n                    }\n                }\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(_ => {\n        return rangeData;\n    });\n}\nexport class RangesCollector {\n    constructor(foldingRangesLimit, _notifyTooManyRegions) {\n        this._notifyTooManyRegions = _notifyTooManyRegions;\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._nestingLevels = [];\n        this._nestingLevelCounts = [];\n        this._types = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._nestingLevels[index] = nestingLevel;\n        this._types[index] = type;\n        this._length++;\n        if (nestingLevel < 30) {\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\n        }\n    }\n    toIndentRanges() {\n        var _a;\n        if (this._length <= this._foldingRangesLimit) {\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = 0; i < this._length; i++) {\n                startIndexes[i] = this._startIndexes[i];\n                endIndexes[i] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\n        }\n        else {\n            (_a = this._notifyTooManyRegions) === null || _a === void 0 ? void 0 : _a.call(this, this._foldingRangesLimit);\n            let entries = 0;\n            let maxLevel = this._nestingLevelCounts.length;\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\n                const n = this._nestingLevelCounts[i];\n                if (n) {\n                    if (n + entries > this._foldingRangesLimit) {\n                        maxLevel = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const startIndexes = new Uint32Array(this._foldingRangesLimit);\n            const endIndexes = new Uint32Array(this._foldingRangesLimit);\n            const types = [];\n            for (let i = 0, k = 0; i < this._length; i++) {\n                const level = this._nestingLevels[i];\n                if (level < maxLevel || (level === maxLevel && entries++ < this._foldingRangesLimit)) {\n                    startIndexes[k] = this._startIndexes[i];\n                    endIndexes[k] = this._endIndexes[i];\n                    types[k] = this._types[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes, types);\n        }\n    }\n}\nexport function sanitizeRanges(rangeData, limit, notifyTooManyRegions) {\n    const sorted = rangeData.sort((d1, d2) => {\n        let diff = d1.start - d2.start;\n        if (diff === 0) {\n            diff = d1.rank - d2.rank;\n        }\n        return diff;\n    });\n    const collector = new RangesCollector(limit, notifyTooManyRegions);\n    let top = undefined;\n    const previous = [];\n    for (const entry of sorted) {\n        if (!top) {\n            top = entry;\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n        }\n        else {\n            if (entry.start > top.start) {\n                if (entry.end <= top.end) {\n                    previous.push(top);\n                    top = entry;\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n                else {\n                    if (entry.start > top.end) {\n                        do {\n                            top = previous.pop();\n                        } while (top && entry.start > top.end);\n                        if (top) {\n                            previous.push(top);\n                        }\n                        top = entry;\n                    }\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n            }\n        }\n    }\n    return collector.toIndentRanges();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, Delayer, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport * as types from '../../../../base/common/types.js';\nimport './folding.css';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { FoldingRangeKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingModel, getNextFoldLine, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, setCollapseStateAtLevel, setCollapseStateForMatchingLines, setCollapseStateForRest, setCollapseStateForType, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateUp, toggleCollapseState } from './foldingModel.js';\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\nimport { IndentRangeProvider } from './indentRangeProvider.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { editorSelectionBackground, iconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant, ThemeIcon } from '../../../../platform/theme/common/themeService.js';\nimport { foldingCollapsedIcon, FoldingDecorationProvider, foldingExpandedIcon, foldingManualCollapsedIcon, foldingManualExpandedIcon } from './foldingDecorations.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { SyntaxRangeProvider } from './syntaxRangeProvider.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport Severity from '../../../../base/common/severity.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\nlet FoldingController = class FoldingController extends Disposable {\n    constructor(editor, contextKeyService, languageConfigurationService, notificationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this._tooManyRegionsNotified = false;\n        this.localToDispose = this._register(new DisposableStore());\n        this.editor = editor;\n        const options = this.editor.getOptions();\n        this._isEnabled = options.get(39 /* EditorOption.folding */);\n        this._useFoldingProviders = options.get(40 /* EditorOption.foldingStrategy */) !== 'indentation';\n        this._unfoldOnClickAfterEndOfLine = options.get(44 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n        this._restoringViewState = false;\n        this._currentModelHasFoldedImports = false;\n        this._foldingImportsByDefault = options.get(42 /* EditorOption.foldingImportsByDefault */);\n        this._maxFoldingRegions = options.get(43 /* EditorOption.foldingMaximumRegions */);\n        this.updateDebounceInfo = languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider, 'Folding', { min: 200 });\n        this.foldingModel = null;\n        this.hiddenRangeModel = null;\n        this.rangeProvider = null;\n        this.foldingRegionPromise = null;\n        this.foldingModelPromise = null;\n        this.updateScheduler = null;\n        this.cursorChangedScheduler = null;\n        this.mouseDownInfo = null;\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n        this.foldingDecorationProvider.showFoldingControls = options.get(101 /* EditorOption.showFoldingControls */);\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(41 /* EditorOption.foldingHighlight */);\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\n        this.foldingEnabled.set(this._isEnabled);\n        this._notifyTooManyRegions = (maxFoldingRegions) => {\n            // Message will display once per time vscode runs. Once per file would be tricky.\n            if (!this._tooManyRegionsNotified) {\n                notificationService.notify({\n                    severity: Severity.Warning,\n                    sticky: true,\n                    message: nls.localize('maximum fold ranges', \"The number of foldable regions is limited to a maximum of {0}. Increase configuration option ['Folding Maximum Regions'](command:workbench.action.openSettings?[\\\"editor.foldingMaximumRegions\\\"]) to enable more.\", maxFoldingRegions)\n                });\n                this._tooManyRegionsNotified = true;\n            }\n        };\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(39 /* EditorOption.folding */)) {\n                this._isEnabled = this.editor.getOptions().get(39 /* EditorOption.folding */);\n                this.foldingEnabled.set(this._isEnabled);\n                this.onModelChanged();\n            }\n            if (e.hasChanged(43 /* EditorOption.foldingMaximumRegions */)) {\n                this._maxFoldingRegions = this.editor.getOptions().get(43 /* EditorOption.foldingMaximumRegions */);\n                this._tooManyRegionsNotified = false;\n                this.onModelChanged();\n            }\n            if (e.hasChanged(101 /* EditorOption.showFoldingControls */) || e.hasChanged(41 /* EditorOption.foldingHighlight */)) {\n                const options = this.editor.getOptions();\n                this.foldingDecorationProvider.showFoldingControls = options.get(101 /* EditorOption.showFoldingControls */);\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(41 /* EditorOption.foldingHighlight */);\n                this.triggerFoldingModelChanged();\n            }\n            if (e.hasChanged(40 /* EditorOption.foldingStrategy */)) {\n                this._useFoldingProviders = this.editor.getOptions().get(40 /* EditorOption.foldingStrategy */) !== 'indentation';\n                this.onFoldingStrategyChanged();\n            }\n            if (e.hasChanged(44 /* EditorOption.unfoldOnClickAfterEndOfLine */)) {\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(44 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n            }\n            if (e.hasChanged(42 /* EditorOption.foldingImportsByDefault */)) {\n                this._foldingImportsByDefault = this.editor.getOptions().get(42 /* EditorOption.foldingImportsByDefault */);\n            }\n        }));\n        this.onModelChanged();\n    }\n    static get(editor) {\n        return editor.getContribution(FoldingController.ID);\n    }\n    /**\n     * Store view state.\n     */\n    saveViewState() {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n            return {};\n        }\n        if (this.foldingModel) { // disposed ?\n            const collapsedRegions = this.foldingModel.getMemento();\n            const provider = this.rangeProvider ? this.rangeProvider.id : undefined;\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\n        }\n        return undefined;\n    }\n    /**\n     * Restore view state.\n     */\n    restoreViewState(state) {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\n            return;\n        }\n        if (!state || state.lineCount !== model.getLineCount()) {\n            return;\n        }\n        this._currentModelHasFoldedImports = !!state.foldedImports;\n        if (state.collapsedRegions && state.collapsedRegions.length > 0 && this.foldingModel) {\n            this._restoringViewState = true;\n            try {\n                this.foldingModel.applyMemento(state.collapsedRegions);\n            }\n            finally {\n                this._restoringViewState = false;\n            }\n        }\n    }\n    onModelChanged() {\n        this.localToDispose.clear();\n        const model = this.editor.getModel();\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n            // huge files get no view model, so they cannot support hidden areas\n            return;\n        }\n        this._currentModelHasFoldedImports = false;\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\n        this.localToDispose.add(this.foldingModel);\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n        this.localToDispose.add(this.hiddenRangeModel);\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\n        this.updateScheduler = new Delayer(this.updateDebounceInfo.get(model));\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\n        this.localToDispose.add(this.cursorChangedScheduler);\n        this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(() => this.onFoldingStrategyChanged()));\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\n        this.localToDispose.add(this.editor.onDidChangeModelContent(e => this.onDidChangeModelContent(e)));\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n        this.localToDispose.add({\n            dispose: () => {\n                if (this.foldingRegionPromise) {\n                    this.foldingRegionPromise.cancel();\n                    this.foldingRegionPromise = null;\n                }\n                if (this.updateScheduler) {\n                    this.updateScheduler.cancel();\n                }\n                this.updateScheduler = null;\n                this.foldingModel = null;\n                this.foldingModelPromise = null;\n                this.hiddenRangeModel = null;\n                this.cursorChangedScheduler = null;\n                if (this.rangeProvider) {\n                    this.rangeProvider.dispose();\n                }\n                this.rangeProvider = null;\n            }\n        });\n        this.triggerFoldingModelChanged();\n    }\n    onFoldingStrategyChanged() {\n        if (this.rangeProvider) {\n            this.rangeProvider.dispose();\n        }\n        this.rangeProvider = null;\n        this.triggerFoldingModelChanged();\n    }\n    getRangeProvider(editorModel) {\n        if (this.rangeProvider) {\n            return this.rangeProvider;\n        }\n        this.rangeProvider = new IndentRangeProvider(editorModel, this.languageConfigurationService, this._maxFoldingRegions); // fallback\n        if (this._useFoldingProviders && this.foldingModel) {\n            const foldingProviders = this.languageFeaturesService.foldingRangeProvider.ordered(this.foldingModel.textModel);\n            if (foldingProviders.length > 0) {\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, foldingProviders, () => this.triggerFoldingModelChanged(), this._maxFoldingRegions);\n            }\n        }\n        return this.rangeProvider;\n    }\n    getFoldingModel() {\n        return this.foldingModelPromise;\n    }\n    onDidChangeModelContent(e) {\n        var _a;\n        (_a = this.hiddenRangeModel) === null || _a === void 0 ? void 0 : _a.notifyChangeModelContent(e);\n        this.triggerFoldingModelChanged();\n    }\n    triggerFoldingModelChanged() {\n        if (this.updateScheduler) {\n            if (this.foldingRegionPromise) {\n                this.foldingRegionPromise.cancel();\n                this.foldingRegionPromise = null;\n            }\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\n                const foldingModel = this.foldingModel;\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\n                    return null;\n                }\n                const sw = new StopWatch(true);\n                const provider = this.getRangeProvider(foldingModel.textModel);\n                const foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token, this._notifyTooManyRegions));\n                return foldingRegionPromise.then(foldingRanges => {\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\n                        let scrollState;\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\n                            if (hasChanges) {\n                                scrollState = StableEditorScrollState.capture(this.editor);\n                                this._currentModelHasFoldedImports = hasChanges;\n                            }\n                        }\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\n                        const selections = this.editor.getSelections();\n                        const selectionLineNumbers = selections ? selections.map(s => s.startLineNumber) : [];\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\n                        scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this.editor);\n                        // update debounce info\n                        const newValue = this.updateDebounceInfo.update(foldingModel.textModel, sw.elapsed());\n                        if (this.updateScheduler) {\n                            this.updateScheduler.defaultDelay = newValue;\n                        }\n                    }\n                    return foldingModel;\n                });\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return null;\n            });\n        }\n    }\n    onHiddenRangesChanges(hiddenRanges) {\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\n            const selections = this.editor.getSelections();\n            if (selections) {\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\n                    this.editor.setSelections(selections);\n                }\n            }\n        }\n        this.editor.setHiddenAreas(hiddenRanges);\n    }\n    onCursorPositionChanged() {\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n            this.cursorChangedScheduler.schedule();\n        }\n    }\n    revealCursor() {\n        const foldingModel = this.getFoldingModel();\n        if (!foldingModel) {\n            return;\n        }\n        foldingModel.then(foldingModel => {\n            if (foldingModel) {\n                const selections = this.editor.getSelections();\n                if (selections && selections.length > 0) {\n                    const toToggle = [];\n                    for (const selection of selections) {\n                        const lineNumber = selection.selectionStartLineNumber;\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\n                        }\n                    }\n                    if (toToggle.length) {\n                        foldingModel.toggleCollapseState(toToggle);\n                        this.reveal(selections[0].getPosition());\n                    }\n                }\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    onEditorMouseDown(e) {\n        this.mouseDownInfo = null;\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\n            return;\n        }\n        if (!e.event.leftButton && !e.event.middleButton) {\n            return;\n        }\n        const range = e.target.range;\n        let iconClicked = false;\n        switch (e.target.type) {\n            case 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */: {\n                const data = e.target.detail;\n                const offsetLeftInGutter = e.target.element.offsetLeft;\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n                if (gutterOffsetX < 5) { // the whitespace between the border and the real folding icon border is 5px\n                    return;\n                }\n                iconClicked = true;\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\n                    const data = e.target.detail;\n                    if (!data.isAfterLines) {\n                        break;\n                    }\n                }\n                return;\n            }\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                if (this.hiddenRangeModel.hasRanges()) {\n                    const model = this.editor.getModel();\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\n                        break;\n                    }\n                }\n                return;\n            }\n            default:\n                return;\n        }\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n    }\n    onEditorMouseUp(e) {\n        const foldingModel = this.foldingModel;\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\n            return;\n        }\n        const lineNumber = this.mouseDownInfo.lineNumber;\n        const iconClicked = this.mouseDownInfo.iconClicked;\n        const range = e.target.range;\n        if (!range || range.startLineNumber !== lineNumber) {\n            return;\n        }\n        if (iconClicked) {\n            if (e.target.type !== 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n                return;\n            }\n        }\n        else {\n            const model = this.editor.getModel();\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\n                return;\n            }\n        }\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region && region.startLineNumber === lineNumber) {\n            const isCollapsed = region.isCollapsed;\n            if (iconClicked || isCollapsed) {\n                const surrounding = e.event.altKey;\n                let toToggle = [];\n                if (surrounding) {\n                    const filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\n                    const toMaybeToggle = foldingModel.getRegionsInside(null, filter);\n                    for (const r of toMaybeToggle) {\n                        if (r.isCollapsed) {\n                            toToggle.push(r);\n                        }\n                    }\n                    // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n                    if (toToggle.length === 0) {\n                        toToggle = toMaybeToggle;\n                    }\n                }\n                else {\n                    const recursive = e.event.middleButton || e.event.shiftKey;\n                    if (recursive) {\n                        for (const r of foldingModel.getRegionsInside(region)) {\n                            if (r.isCollapsed === isCollapsed) {\n                                toToggle.push(r);\n                            }\n                        }\n                    }\n                    // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n                    if (isCollapsed || !recursive || toToggle.length === 0) {\n                        toToggle.push(region);\n                    }\n                }\n                foldingModel.toggleCollapseState(toToggle);\n                this.reveal({ lineNumber, column: 1 });\n            }\n        }\n    }\n    reveal(position) {\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n    }\n};\nFoldingController.ID = 'editor.contrib.folding';\nFoldingController = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService),\n    __param(3, INotificationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], FoldingController);\nexport { FoldingController };\nclass FoldingAction extends EditorAction {\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const foldingController = FoldingController.get(editor);\n        if (!foldingController) {\n            return;\n        }\n        const foldingModelPromise = foldingController.getFoldingModel();\n        if (foldingModelPromise) {\n            this.reportTelemetry(accessor, editor);\n            return foldingModelPromise.then(foldingModel => {\n                if (foldingModel) {\n                    this.invoke(foldingController, foldingModel, editor, args, languageConfigurationService);\n                    const selection = editor.getSelection();\n                    if (selection) {\n                        foldingController.reveal(selection.getStartPosition());\n                    }\n                }\n            });\n        }\n    }\n    getSelectedLines(editor) {\n        const selections = editor.getSelections();\n        return selections ? selections.map(s => s.startLineNumber) : [];\n    }\n    getLineNumbers(args, editor) {\n        if (args && args.selectionLines) {\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\n        }\n        return this.getSelectedLines(editor);\n    }\n    run(_accessor, _editor) {\n    }\n}\nfunction foldingArgumentsConstraint(args) {\n    if (!types.isUndefined(args)) {\n        if (!types.isObject(args)) {\n            return false;\n        }\n        const foldingArgs = args;\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!types.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\n            return false;\n        }\n    }\n    return true;\n}\nclass UnfoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfold',\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\n            alias: 'Unfold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 89 /* KeyCode.BracketRight */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 89 /* KeyCode.BracketRight */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Unfold the content in the editor',\n                args: [\n                    {\n                        name: 'Unfold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                    'default': 1\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                    'default': 'down'\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const levels = args && args.levels || 1;\n        const lineNumbers = this.getLineNumbers(args, editor);\n        if (args && args.direction === 'up') {\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n        }\n        else {\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\n        }\n    }\n}\nclass UnFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldRecursively',\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\n            alias: 'Unfold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.BracketRight */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, _args) {\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\n    }\n}\nclass FoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.fold',\n            label: nls.localize('foldAction.label', \"Fold\"),\n            alias: 'Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 87 /* KeyCode.BracketLeft */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 87 /* KeyCode.BracketLeft */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Fold the content in the editor',\n                args: [\n                    {\n                        name: 'Fold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const lineNumbers = this.getLineNumbers(args, editor);\n        const levels = args && args.levels;\n        const direction = args && args.direction;\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n            setCollapseStateUp(foldingModel, true, lineNumbers);\n        }\n        else {\n            if (direction === 'up') {\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\n            }\n            else {\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\n            }\n        }\n    }\n}\nclass ToggleFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFold',\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\n            alias: 'Toggle Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, 1, selectedLines);\n    }\n}\nclass FoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldRecursively',\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\n            alias: 'Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.BracketLeft */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass FoldAllBlockCommentsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllBlockComments',\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\n            alias: 'Fold All Block Comments',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 85 /* KeyCode.Slash */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const comments = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;\n            if (comments && comments.blockCommentStartToken) {\n                const regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass FoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllMarkerRegions',\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\n            alias: 'Fold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 29 /* KeyCode.Digit8 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass UnfoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllMarkerRegions',\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\n            alias: 'Unfold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 30 /* KeyCode.Digit9 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\n            }\n        }\n    }\n}\nclass FoldAllRegionsExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllExcept',\n            label: nls.localize('foldAllExcept.label', \"Fold All Regions Except Selected\"),\n            alias: 'Fold All Regions Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 83 /* KeyCode.Minus */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, true, selectedLines);\n    }\n}\nclass UnfoldAllRegionsExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllExcept',\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Regions Except Selected\"),\n            alias: 'Unfold All Regions Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 81 /* KeyCode.Equal */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, false, selectedLines);\n    }\n}\nclass FoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAll',\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\n            alias: 'Fold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 21 /* KeyCode.Digit0 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, true);\n    }\n}\nclass UnfoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAll',\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\n            alias: 'Unfold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 40 /* KeyCode.KeyJ */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, false);\n    }\n}\nclass FoldLevelAction extends FoldingAction {\n    getFoldingLevel() {\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\n    }\n}\nFoldLevelAction.ID_PREFIX = 'editor.foldLevel';\nFoldLevelAction.ID = (level) => FoldLevelAction.ID_PREFIX + level;\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoParentFold',\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\n            alias: 'Go to Parent Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoPreviousFold',\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Folding Range\"),\n            alias: 'Go to Previous Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoNextFold',\n            label: nls.localize('gotoNextFold.label', \"Go to Next Folding Range\"),\n            alias: 'Go to Next Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\nclass FoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.createFoldingRangeFromSelection',\n            label: nls.localize('createManualFoldRange.label', \"Create Manual Folding Range from Selection\"),\n            alias: 'Create Folding Range from Selection',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 82 /* KeyCode.Comma */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        var _a;\n        const collapseRanges = [];\n        const selections = editor.getSelections();\n        if (selections) {\n            for (const selection of selections) {\n                let endLineNumber = selection.endLineNumber;\n                if (selection.endColumn === 1) {\n                    --endLineNumber;\n                }\n                if (endLineNumber > selection.startLineNumber) {\n                    collapseRanges.push({\n                        startLineNumber: selection.startLineNumber,\n                        endLineNumber: endLineNumber,\n                        type: undefined,\n                        isCollapsed: true,\n                        source: 1 /* FoldSource.userDefined */\n                    });\n                    editor.setSelection({\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: 1,\n                        endLineNumber: selection.startLineNumber,\n                        endColumn: 1\n                    });\n                }\n            }\n            if (collapseRanges.length > 0) {\n                collapseRanges.sort((a, b) => {\n                    return a.startLineNumber - b.startLineNumber;\n                });\n                const newRanges = FoldingRegions.sanitizeAndMerge(foldingModel.regions, collapseRanges, (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLineCount());\n                foldingModel.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n            }\n        }\n    }\n}\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.removeManualFoldingRanges',\n            label: nls.localize('removeManualFoldingRanges.label', \"Remove Manual Folding Ranges\"),\n            alias: 'Remove Manual Folding Ranges',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 84 /* KeyCode.Period */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(foldingController, foldingModel, editor) {\n        const selections = editor.getSelections();\n        if (selections) {\n            const ranges = [];\n            for (const selection of selections) {\n                const { startLineNumber, endLineNumber } = selection;\n                ranges.push(endLineNumber >= startLineNumber ? { startLineNumber, endLineNumber } : { endLineNumber, startLineNumber });\n            }\n            foldingModel.removeManualRanges(ranges);\n            foldingController.triggerFoldingModelChanged();\n        }\n    }\n}\nregisterEditorContribution(FoldingController.ID, FoldingController);\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllRegionsExceptAction);\nregisterEditorAction(UnfoldAllRegionsExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nfor (let i = 1; i <= 7; i++) {\n    registerInstantiatedEditorAction(new FoldLevelAction({\n        id: FoldLevelAction.ID(i),\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\n        alias: `Fold Level ${i}`,\n        precondition: CONTEXT_FOLDING_ENABLED,\n        kbOpts: {\n            kbExpr: EditorContextKeys.editorTextFocus,\n            primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | (21 /* KeyCode.Digit0 */ + i)),\n            weight: 100 /* KeybindingWeight.EditorContrib */\n        }\n    }));\n}\nexport const foldBackgroundBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hcDark: null, hcLight: null }, nls.localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\nexport const editorFoldForeground = registerColor('editorGutter.foldingControlForeground', { dark: iconForeground, light: iconForeground, hcDark: iconForeground, hcLight: iconForeground }, nls.localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\nregisterThemingParticipant((theme, collector) => {\n    const foldBackground = theme.getColor(foldBackgroundBackground);\n    if (foldBackground) {\n        collector.addRule(`.monaco-editor .folded-background { background-color: ${foldBackground}; }`);\n    }\n    const editorFoldColor = theme.getColor(editorFoldForeground);\n    if (editorFoldColor) {\n        collector.addRule(`\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingExpandedIcon)},\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingCollapsedIcon)},\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingManualExpandedIcon)},\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingManualCollapsedIcon)} {\n\t\t\tcolor: ${editorFoldColor} !important;\n\t\t}\n\t\t`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\n            alias: 'Editor Font Zoom In',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\n            alias: 'Editor Font Zoom Out',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\n            alias: 'Editor Font Zoom Reset',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { alertFormattingEdits, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(51 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(51 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                FormattingEdit.execute(this._editor, edits, true);\n                alertFormattingEdits(edits);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService)\n], FormatOnType);\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(50 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                const instaService = accessor.get(IInstantiationService);\n                const progressService = accessor.get(IEditorProgressService);\n                yield progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n            }\n        });\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.hasModel()) {\n                return;\n            }\n            const instaService = accessor.get(IInstantiationService);\n            const model = editor.getModel();\n            const ranges = editor.getSelections().map(range => {\n                return range.isEmpty()\n                    ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                    : range;\n            });\n            const progressService = accessor.get(IEditorProgressService);\n            yield progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n        });\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', (accessor) => __awaiter(void 0, void 0, void 0, function* () {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        yield commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        yield commandService.executeCommand('editor.action.formatSelection');\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { equals } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class TreeElement {\n    remove() {\n        var _a;\n        (_a = this.parent) === null || _a === void 0 ? void 0 : _a.children.delete(this.id);\n    }\n    static findId(candidate, container) {\n        // complex id-computation which contains the origin/extension,\n        // the parent path, and some dedupe logic when names collide\n        let candidateId;\n        if (typeof candidate === 'string') {\n            candidateId = `${container.id}/${candidate}`;\n        }\n        else {\n            candidateId = `${container.id}/${candidate.name}`;\n            if (container.children.get(candidateId) !== undefined) {\n                candidateId = `${container.id}/${candidate.name}_${candidate.range.startLineNumber}_${candidate.range.startColumn}`;\n            }\n        }\n        let id = candidateId;\n        for (let i = 0; container.children.get(id) !== undefined; i++) {\n            id = `${candidateId}_${i}`;\n        }\n        return id;\n    }\n    static empty(element) {\n        return element.children.size === 0;\n    }\n}\nexport class OutlineElement extends TreeElement {\n    constructor(id, parent, symbol) {\n        super();\n        this.id = id;\n        this.parent = parent;\n        this.symbol = symbol;\n        this.children = new Map();\n    }\n}\nexport class OutlineGroup extends TreeElement {\n    constructor(id, parent, label, order) {\n        super();\n        this.id = id;\n        this.parent = parent;\n        this.label = label;\n        this.order = order;\n        this.children = new Map();\n    }\n}\nexport class OutlineModel extends TreeElement {\n    constructor(uri) {\n        super();\n        this.uri = uri;\n        this.id = 'root';\n        this.parent = undefined;\n        this._groups = new Map();\n        this.children = new Map();\n        this.id = 'root';\n        this.parent = undefined;\n    }\n    static create(registry, textModel, token) {\n        const cts = new CancellationTokenSource(token);\n        const result = new OutlineModel(textModel.uri);\n        const provider = registry.ordered(textModel);\n        const promises = provider.map((provider, index) => {\n            var _a;\n            const id = TreeElement.findId(`provider_${index}`, result);\n            const group = new OutlineGroup(id, result, (_a = provider.displayName) !== null && _a !== void 0 ? _a : 'Unknown Outline Provider', index);\n            return Promise.resolve(provider.provideDocumentSymbols(textModel, cts.token)).then(result => {\n                for (const info of result || []) {\n                    OutlineModel._makeOutlineElement(info, group);\n                }\n                return group;\n            }, err => {\n                onUnexpectedExternalError(err);\n                return group;\n            }).then(group => {\n                if (!TreeElement.empty(group)) {\n                    result._groups.set(id, group);\n                }\n                else {\n                    group.remove();\n                }\n            });\n        });\n        const listener = registry.onDidChange(() => {\n            const newProvider = registry.ordered(textModel);\n            if (!equals(newProvider, provider)) {\n                cts.cancel();\n            }\n        });\n        return Promise.all(promises).then(() => {\n            if (cts.token.isCancellationRequested && !token.isCancellationRequested) {\n                return OutlineModel.create(registry, textModel, token);\n            }\n            else {\n                return result._compact();\n            }\n        }).finally(() => {\n            listener.dispose();\n        });\n    }\n    static _makeOutlineElement(info, container) {\n        const id = TreeElement.findId(info, container);\n        const res = new OutlineElement(id, container, info);\n        if (info.children) {\n            for (const childInfo of info.children) {\n                OutlineModel._makeOutlineElement(childInfo, res);\n            }\n        }\n        container.children.set(res.id, res);\n    }\n    _compact() {\n        let count = 0;\n        for (const [key, group] of this._groups) {\n            if (group.children.size === 0) { // empty\n                this._groups.delete(key);\n            }\n            else {\n                count += 1;\n            }\n        }\n        if (count !== 1) {\n            //\n            this.children = this._groups;\n        }\n        else {\n            // adopt all elements of the first group\n            const group = Iterable.first(this._groups.values());\n            for (const [, child] of group.children) {\n                child.parent = this;\n                this.children.set(child.id, child);\n            }\n        }\n        return this;\n    }\n    getTopLevelSymbols() {\n        const roots = [];\n        for (const child of this.children.values()) {\n            if (child instanceof OutlineElement) {\n                roots.push(child.symbol);\n            }\n            else {\n                roots.push(...Iterable.map(child.children.values(), child => child.symbol));\n            }\n        }\n        return roots.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n    }\n    asListOfDocumentSymbols() {\n        const roots = this.getTopLevelSymbols();\n        const bucket = [];\n        OutlineModel._flattenDocumentSymbols(bucket, roots, '');\n        return bucket.sort((a, b) => Position.compare(Range.getStartPosition(a.range), Range.getStartPosition(b.range)) || Position.compare(Range.getEndPosition(b.range), Range.getEndPosition(a.range)));\n    }\n    static _flattenDocumentSymbols(bucket, entries, overrideContainerLabel) {\n        for (const entry of entries) {\n            bucket.push({\n                kind: entry.kind,\n                tags: entry.tags,\n                name: entry.name,\n                detail: entry.detail,\n                containerName: entry.containerName || overrideContainerLabel,\n                range: entry.range,\n                selectionRange: entry.selectionRange,\n                children: undefined, // we flatten it...\n            });\n            // Recurse over children\n            if (entry.children) {\n                OutlineModel._flattenDocumentSymbols(bucket, entry.children, entry.name);\n            }\n        }\n    }\n}\nexport const IOutlineModelService = createDecorator('IOutlineModelService');\nlet OutlineModelService = class OutlineModelService {\n    constructor(_languageFeaturesService, debounces, modelService) {\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposables = new DisposableStore();\n        this._cache = new LRUCache(10, 0.7);\n        this._debounceInformation = debounces.for(_languageFeaturesService.documentSymbolProvider, 'DocumentSymbols', { min: 350 });\n        // don't cache outline models longer than their text model\n        this._disposables.add(modelService.onModelRemoved(textModel => {\n            this._cache.delete(textModel.id);\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    getOrCreate(textModel, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const registry = this._languageFeaturesService.documentSymbolProvider;\n            const provider = registry.ordered(textModel);\n            let data = this._cache.get(textModel.id);\n            if (!data || data.versionId !== textModel.getVersionId() || !equals(data.provider, provider)) {\n                const source = new CancellationTokenSource();\n                data = {\n                    versionId: textModel.getVersionId(),\n                    provider,\n                    promiseCnt: 0,\n                    source,\n                    promise: OutlineModel.create(registry, textModel, source.token),\n                    model: undefined,\n                };\n                this._cache.set(textModel.id, data);\n                const now = Date.now();\n                data.promise.then(outlineModel => {\n                    data.model = outlineModel;\n                    this._debounceInformation.update(textModel, Date.now() - now);\n                }).catch(_err => {\n                    this._cache.delete(textModel.id);\n                });\n            }\n            if (data.model) {\n                // resolved -> return data\n                return data.model;\n            }\n            // increase usage counter\n            data.promiseCnt += 1;\n            const listener = token.onCancellationRequested(() => {\n                // last -> cancel provider request, remove cached promise\n                if (--data.promiseCnt === 0) {\n                    data.source.cancel();\n                    this._cache.delete(textModel.id);\n                }\n            });\n            try {\n                return yield data.promise;\n            }\n            finally {\n                listener.dispose();\n            }\n        });\n    }\n};\nOutlineModelService = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, ILanguageFeatureDebounceService),\n    __param(2, IModelService)\n], OutlineModelService);\nexport { OutlineModelService };\nregisterSingleton(IOutlineModelService, OutlineModelService, true);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { IOutlineModelService } from './outlineModel.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nCommandsRegistry.registerCommand('_executeDocumentSymbolProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource] = args;\n        assertType(URI.isUri(resource));\n        const outlineService = accessor.get(IOutlineModelService);\n        const modelService = accessor.get(ITextModelService);\n        const reference = yield modelService.createModelReference(resource);\n        try {\n            return (yield outlineService.getOrCreate(reference.object.textEditorModel, CancellationToken.None)).getTopLevelSymbols();\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const inlineSuggestCommitId = 'editor.action.inlineSuggest.commit';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nexport function createDisposableRef(object, disposable) {\n    return {\n        object,\n        dispose: () => disposable === null || disposable === void 0 ? void 0 : disposable.dispose(),\n    };\n}\nexport function applyEdits(text, edits) {\n    const transformer = new PositionOffsetTransformer(text);\n    const offsetEdits = edits.map(e => {\n        const range = Range.lift(e.range);\n        return ({\n            startOffset: transformer.getOffset(range.getStartPosition()),\n            endOffset: transformer.getOffset(range.getEndPosition()),\n            text: e.text\n        });\n    });\n    offsetEdits.sort((a, b) => b.startOffset - a.startOffset);\n    for (const edit of offsetEdits) {\n        text = text.substring(0, edit.startOffset) + edit.text + text.substring(edit.endOffset);\n    }\n    return text;\n}\nclass PositionOffsetTransformer {\n    constructor(text) {\n        this.lineStartOffsetByLineIdx = [];\n        this.lineStartOffsetByLineIdx.push(0);\n        for (let i = 0; i < text.length; i++) {\n            if (text.charAt(i) === '\\n') {\n                this.lineStartOffsetByLineIdx.push(i + 1);\n            }\n        }\n    }\n    getOffset(position) {\n        return this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n    }\n}\nconst array = [];\nexport function getReadonlyEmptyArray() {\n    return array;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { applyEdits } from './utils.js';\nexport class GhostText {\n    constructor(lineNumber, parts, additionalReservedLineCount = 0) {\n        this.lineNumber = lineNumber;\n        this.parts = parts;\n        this.additionalReservedLineCount = additionalReservedLineCount;\n    }\n    renderForScreenReader(lineText) {\n        if (this.parts.length === 0) {\n            return '';\n        }\n        const lastPart = this.parts[this.parts.length - 1];\n        const cappedLineText = lineText.substr(0, lastPart.column - 1);\n        const text = applyEdits(cappedLineText, this.parts.map(p => ({\n            range: { startLineNumber: 1, endLineNumber: 1, startColumn: p.column, endColumn: p.column },\n            text: p.lines.join('\\n')\n        })));\n        return text.substring(this.parts[0].column - 1);\n    }\n    isEmpty() {\n        return this.parts.every(p => p.lines.length === 0);\n    }\n}\nexport class GhostTextPart {\n    constructor(column, lines, \n    /**\n     * Indicates if this part is a preview of an inline suggestion when a suggestion is previewed.\n    */\n    preview) {\n        this.column = column;\n        this.lines = lines;\n        this.preview = preview;\n    }\n}\nexport class GhostTextReplacement {\n    constructor(lineNumber, columnStart, length, newLines, additionalReservedLineCount = 0) {\n        this.lineNumber = lineNumber;\n        this.columnStart = columnStart;\n        this.length = length;\n        this.newLines = newLines;\n        this.additionalReservedLineCount = additionalReservedLineCount;\n        this.parts = [\n            new GhostTextPart(this.columnStart + this.length, this.newLines, false),\n        ];\n    }\n    renderForScreenReader(_lineText) {\n        return this.newLines.join('\\n');\n    }\n}\nexport class BaseGhostTextWidgetModel extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._expanded = undefined;\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(108 /* EditorOption.suggest */) && this._expanded === undefined) {\n                this.onDidChangeEmitter.fire();\n            }\n        }));\n    }\n    setExpanded(expanded) {\n        this._expanded = true;\n        this.onDidChangeEmitter.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LcsDiff } from '../../../../base/common/diff/diff.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { GhostText, GhostTextPart } from './ghostText.js';\nexport function minimizeInlineCompletion(model, inlineCompletion) {\n    if (!inlineCompletion) {\n        return inlineCompletion;\n    }\n    const valueToReplace = model.getValueInRange(inlineCompletion.range);\n    const commonPrefixLen = strings.commonPrefixLength(valueToReplace, inlineCompletion.insertText);\n    const startOffset = model.getOffsetAt(inlineCompletion.range.getStartPosition()) + commonPrefixLen;\n    const start = model.getPositionAt(startOffset);\n    const remainingValueToReplace = valueToReplace.substr(commonPrefixLen);\n    const commonSuffixLen = strings.commonSuffixLength(remainingValueToReplace, inlineCompletion.insertText);\n    const end = model.getPositionAt(Math.max(startOffset, model.getOffsetAt(inlineCompletion.range.getEndPosition()) - commonSuffixLen));\n    return {\n        range: Range.fromPositions(start, end),\n        insertText: inlineCompletion.insertText.substr(commonPrefixLen, inlineCompletion.insertText.length - commonPrefixLen - commonSuffixLen),\n        snippetInfo: inlineCompletion.snippetInfo,\n        filterText: inlineCompletion.filterText,\n        additionalTextEdits: inlineCompletion.additionalTextEdits,\n    };\n}\nexport function normalizedInlineCompletionsEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    return a.range.equalsRange(b.range) && a.insertText === b.insertText && a.command === b.command;\n}\n/**\n * @param previewSuffixLength Sets where to split `inlineCompletion.text`.\n * \tIf the text is `hello` and the suffix length is 2, the non-preview part is `hel` and the preview-part is `lo`.\n*/\nexport function inlineCompletionToGhostText(inlineCompletion, textModel, mode, cursorPosition, previewSuffixLength = 0) {\n    if (inlineCompletion.range.startLineNumber !== inlineCompletion.range.endLineNumber) {\n        // Only single line replacements are supported.\n        return undefined;\n    }\n    const sourceLine = textModel.getLineContent(inlineCompletion.range.startLineNumber);\n    const sourceIndentationLength = strings.getLeadingWhitespace(sourceLine).length;\n    const suggestionTouchesIndentation = inlineCompletion.range.startColumn - 1 <= sourceIndentationLength;\n    if (suggestionTouchesIndentation) {\n        // source:      [abc]\n        //                         ^^^^^^^^^ inlineCompletion.range\n        //              ^^^^^^^^^^ ^^^^^^ sourceIndentationLength\n        //                         ^^^^^^ replacedIndentation.length\n        //                               ^^^ rangeThatDoesNotReplaceIndentation\n        // inlineCompletion.text: 'foo'\n        //                         ^^ suggestionAddedIndentationLength\n        const suggestionAddedIndentationLength = strings.getLeadingWhitespace(inlineCompletion.insertText).length;\n        const replacedIndentation = sourceLine.substring(inlineCompletion.range.startColumn - 1, sourceIndentationLength);\n        const rangeThatDoesNotReplaceIndentation = Range.fromPositions(inlineCompletion.range.getStartPosition().delta(0, replacedIndentation.length), inlineCompletion.range.getEndPosition());\n        const suggestionWithoutIndentationChange = inlineCompletion.insertText.startsWith(replacedIndentation)\n            // Adds more indentation without changing existing indentation: We can add ghost text for this\n            ? inlineCompletion.insertText.substring(replacedIndentation.length)\n            // Changes or removes existing indentation. Only add ghost text for the non-indentation part.\n            : inlineCompletion.insertText.substring(suggestionAddedIndentationLength);\n        inlineCompletion = {\n            range: rangeThatDoesNotReplaceIndentation,\n            insertText: suggestionWithoutIndentationChange,\n            command: inlineCompletion.command,\n            snippetInfo: undefined,\n            filterText: inlineCompletion.filterText,\n            additionalTextEdits: inlineCompletion.additionalTextEdits,\n        };\n    }\n    // This is a single line string\n    const valueToBeReplaced = textModel.getValueInRange(inlineCompletion.range);\n    const changes = cachingDiff(valueToBeReplaced, inlineCompletion.insertText);\n    if (!changes) {\n        // No ghost text in case the diff would be too slow to compute\n        return undefined;\n    }\n    const lineNumber = inlineCompletion.range.startLineNumber;\n    const parts = new Array();\n    if (mode === 'prefix') {\n        const filteredChanges = changes.filter(c => c.originalLength === 0);\n        if (filteredChanges.length > 1 || filteredChanges.length === 1 && filteredChanges[0].originalStart !== valueToBeReplaced.length) {\n            // Prefixes only have a single change.\n            return undefined;\n        }\n    }\n    const previewStartInCompletionText = inlineCompletion.insertText.length - previewSuffixLength;\n    for (const c of changes) {\n        const insertColumn = inlineCompletion.range.startColumn + c.originalStart + c.originalLength;\n        if (mode === 'subwordSmart' && cursorPosition && cursorPosition.lineNumber === inlineCompletion.range.startLineNumber && insertColumn < cursorPosition.column) {\n            // No ghost text before cursor\n            return undefined;\n        }\n        if (c.originalLength > 0) {\n            return undefined;\n        }\n        if (c.modifiedLength === 0) {\n            continue;\n        }\n        const modifiedEnd = c.modifiedStart + c.modifiedLength;\n        const nonPreviewTextEnd = Math.max(c.modifiedStart, Math.min(modifiedEnd, previewStartInCompletionText));\n        const nonPreviewText = inlineCompletion.insertText.substring(c.modifiedStart, nonPreviewTextEnd);\n        const italicText = inlineCompletion.insertText.substring(nonPreviewTextEnd, Math.max(c.modifiedStart, modifiedEnd));\n        if (nonPreviewText.length > 0) {\n            const lines = strings.splitLines(nonPreviewText);\n            parts.push(new GhostTextPart(insertColumn, lines, false));\n        }\n        if (italicText.length > 0) {\n            const lines = strings.splitLines(italicText);\n            parts.push(new GhostTextPart(insertColumn, lines, true));\n        }\n    }\n    return new GhostText(lineNumber, parts, 0);\n}\nlet lastRequest = undefined;\nfunction cachingDiff(originalValue, newValue) {\n    if ((lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.originalValue) === originalValue && (lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.newValue) === newValue) {\n        return lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.changes;\n    }\n    else {\n        let changes = smartDiff(originalValue, newValue, true);\n        if (changes) {\n            const deletedChars = deletedCharacters(changes);\n            if (deletedChars > 0) {\n                // For performance reasons, don't compute diff if there is nothing to improve\n                const newChanges = smartDiff(originalValue, newValue, false);\n                if (newChanges && deletedCharacters(newChanges) < deletedChars) {\n                    // Disabling smartness seems to be better here\n                    changes = newChanges;\n                }\n            }\n        }\n        lastRequest = {\n            originalValue,\n            newValue,\n            changes\n        };\n        return changes;\n    }\n}\nfunction deletedCharacters(changes) {\n    let sum = 0;\n    for (const c of changes) {\n        sum += Math.max(c.originalLength - c.modifiedLength, 0);\n    }\n    return sum;\n}\n/**\n * When matching `if ()` with `if (f() = 1) { g(); }`,\n * align it like this:        `if (       )`\n * Not like this:\t\t\t  `if (  )`\n * Also not like this:\t\t  `if (             )`.\n *\n * The parenthesis are preprocessed to ensure that they match correctly.\n */\nfunction smartDiff(originalValue, newValue, smartBracketMatching) {\n    if (originalValue.length > 5000 || newValue.length > 5000) {\n        // We don't want to work on strings that are too big\n        return undefined;\n    }\n    function getMaxCharCode(val) {\n        let maxCharCode = 0;\n        for (let i = 0, len = val.length; i < len; i++) {\n            const charCode = val.charCodeAt(i);\n            if (charCode > maxCharCode) {\n                maxCharCode = charCode;\n            }\n        }\n        return maxCharCode;\n    }\n    const maxCharCode = Math.max(getMaxCharCode(originalValue), getMaxCharCode(newValue));\n    function getUniqueCharCode(id) {\n        if (id < 0) {\n            throw new Error('unexpected');\n        }\n        return maxCharCode + id + 1;\n    }\n    function getElements(source) {\n        let level = 0;\n        let group = 0;\n        const characters = new Int32Array(source.length);\n        for (let i = 0, len = source.length; i < len; i++) {\n            // TODO support more brackets\n            if (smartBracketMatching && source[i] === '(') {\n                const id = group * 100 + level;\n                characters[i] = getUniqueCharCode(2 * id);\n                level++;\n            }\n            else if (smartBracketMatching && source[i] === ')') {\n                level = Math.max(level - 1, 0);\n                const id = group * 100 + level;\n                characters[i] = getUniqueCharCode(2 * id + 1);\n                if (level === 0) {\n                    group++;\n                }\n            }\n            else {\n                characters[i] = source.charCodeAt(i);\n            }\n        }\n        return characters;\n    }\n    const elements1 = getElements(originalValue);\n    const elements2 = getElements(newValue);\n    return new LcsDiff({ getElements: () => elements1 }, { getElements: () => elements2 }).ComputeDiff(false).changes;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LanguageAgnosticBracketTokens } from './bracketPairsTree/brackets.js';\nimport { lengthAdd, lengthGetColumnCountIfZeroLineCount, lengthZero } from './bracketPairsTree/length.js';\nimport { parseDocument } from './bracketPairsTree/parser.js';\nimport { DenseKeyProvider } from './bracketPairsTree/smallImmutableSet.js';\nimport { TextBufferTokenizer } from './bracketPairsTree/tokenizer.js';\nexport function fixBracketsInLine(tokens, languageConfigurationService) {\n    const denseKeyProvider = new DenseKeyProvider();\n    const bracketTokens = new LanguageAgnosticBracketTokens(denseKeyProvider, (languageId) => languageConfigurationService.getLanguageConfiguration(languageId));\n    const tokenizer = new TextBufferTokenizer(new StaticTokenizerSource([tokens]), bracketTokens);\n    const node = parseDocument(tokenizer, [], undefined, true);\n    let str = '';\n    const line = tokens.getLineContent();\n    function processNode(node, offset) {\n        if (node.kind === 2 /* AstNodeKind.Pair */) {\n            processNode(node.openingBracket, offset);\n            offset = lengthAdd(offset, node.openingBracket.length);\n            if (node.child) {\n                processNode(node.child, offset);\n                offset = lengthAdd(offset, node.child.length);\n            }\n            if (node.closingBracket) {\n                processNode(node.closingBracket, offset);\n                offset = lengthAdd(offset, node.closingBracket.length);\n            }\n            else {\n                const singleLangBracketTokens = bracketTokens.getSingleLanguageBracketTokens(node.openingBracket.languageId);\n                const closingTokenText = singleLangBracketTokens.findClosingTokenText(node.openingBracket.bracketIds);\n                str += closingTokenText;\n            }\n        }\n        else if (node.kind === 3 /* AstNodeKind.UnexpectedClosingBracket */) {\n            // remove the bracket\n        }\n        else if (node.kind === 0 /* AstNodeKind.Text */ || node.kind === 1 /* AstNodeKind.Bracket */) {\n            str += line.substring(lengthGetColumnCountIfZeroLineCount(offset), lengthGetColumnCountIfZeroLineCount(lengthAdd(offset, node.length)));\n        }\n        else if (node.kind === 4 /* AstNodeKind.List */) {\n            for (const child of node.children) {\n                processNode(child, offset);\n                offset = lengthAdd(offset, child.length);\n            }\n        }\n    }\n    processNode(node, lengthZero);\n    return str;\n}\nclass StaticTokenizerSource {\n    constructor(lines) {\n        this.lines = lines;\n        this.tokenization = {\n            getLineTokens: (lineNumber) => {\n                return this.lines[lineNumber - 1];\n            }\n        };\n    }\n    getLineCount() {\n        return this.lines.length;\n    }\n    getLineLength(lineNumber) {\n        return this.lines[lineNumber - 1].getLineContent().length;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { CoreEditingCommands } from '../../../browser/coreCommands.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { BaseGhostTextWidgetModel, GhostTextReplacement } from './ghostText.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { inlineSuggestCommitId } from './consts.js';\nimport { inlineCompletionToGhostText } from './inlineCompletionToGhostText.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { fixBracketsInLine } from '../../../common/model/bracketPairsTextModelPart/fixBrackets.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { assertNever } from '../../../../base/common/types.js';\nimport { matchesSubString } from '../../../../base/common/filters.js';\nimport { getReadonlyEmptyArray } from './utils.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nlet InlineCompletionsModel = class InlineCompletionsModel extends Disposable {\n    constructor(editor, cache, commandService, languageConfigurationService, languageFeaturesService, debounceService, configurationService) {\n        super();\n        this.editor = editor;\n        this.cache = cache;\n        this.commandService = commandService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.debounceService = debounceService;\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        this.completionSession = this._register(new MutableDisposable());\n        this.active = false;\n        this.disposed = false;\n        this.debounceValue = this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider, 'InlineCompletionsDebounce', { min: 50, max: 50 });\n        this._register(commandService.onDidExecuteCommand((e) => {\n            // These commands don't trigger onDidType.\n            const commands = new Set([\n                CoreEditingCommands.Tab.id,\n                CoreEditingCommands.DeleteLeft.id,\n                CoreEditingCommands.DeleteRight.id,\n                inlineSuggestCommitId,\n                'acceptSelectedSuggestion',\n            ]);\n            if (commands.has(e.commandId) && editor.hasTextFocus()) {\n                this.handleUserInput();\n            }\n        }));\n        this._register(this.editor.onDidType((e) => {\n            this.handleUserInput();\n        }));\n        this._register(this.editor.onDidChangeCursorPosition((e) => {\n            if (e.reason === 3 /* CursorChangeReason.Explicit */ ||\n                this.session && !this.session.isValid) {\n                this.hide();\n            }\n        }));\n        this._register(toDisposable(() => {\n            this.disposed = true;\n        }));\n        this._register(this.editor.onDidBlurEditorWidget(() => {\n            // This is a hidden setting very useful for debugging\n            if (configurationService.getValue('editor.inlineSuggest.hideOnBlur')) {\n                return;\n            }\n            this.hide();\n        }));\n    }\n    handleUserInput() {\n        if (this.session && !this.session.isValid) {\n            this.hide();\n        }\n        setTimeout(() => {\n            if (this.disposed) {\n                return;\n            }\n            // Wait for the cursor update that happens in the same iteration loop iteration\n            this.startSessionIfTriggered();\n        }, 0);\n    }\n    get session() {\n        return this.completionSession.value;\n    }\n    get ghostText() {\n        var _a;\n        return (_a = this.session) === null || _a === void 0 ? void 0 : _a.ghostText;\n    }\n    get minReservedLineCount() {\n        return this.session ? this.session.minReservedLineCount : 0;\n    }\n    setExpanded(expanded) {\n        var _a;\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.setExpanded(expanded);\n    }\n    setActive(active) {\n        var _a;\n        this.active = active;\n        if (active) {\n            (_a = this.session) === null || _a === void 0 ? void 0 : _a.scheduleAutomaticUpdate();\n        }\n    }\n    startSessionIfTriggered() {\n        const suggestOptions = this.editor.getOption(57 /* EditorOption.inlineSuggest */);\n        if (!suggestOptions.enabled) {\n            return;\n        }\n        if (this.session && this.session.isValid) {\n            return;\n        }\n        this.trigger(InlineCompletionTriggerKind.Automatic);\n    }\n    trigger(triggerKind) {\n        if (this.completionSession.value) {\n            if (triggerKind === InlineCompletionTriggerKind.Explicit) {\n                void this.completionSession.value.ensureUpdateWithExplicitContext();\n            }\n            return;\n        }\n        this.completionSession.value = new InlineCompletionsSession(this.editor, this.editor.getPosition(), () => this.active, this.commandService, this.cache, triggerKind, this.languageConfigurationService, this.languageFeaturesService.inlineCompletionsProvider, this.debounceValue);\n        this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange(() => {\n            this.onDidChangeEmitter.fire();\n        }));\n    }\n    hide() {\n        this.completionSession.clear();\n        this.onDidChangeEmitter.fire();\n    }\n    commitCurrentSuggestion() {\n        var _a;\n        // Don't dispose the session, so that after committing, more suggestions are shown.\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.commitCurrentCompletion();\n    }\n    showNext() {\n        var _a;\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.showNextInlineCompletion();\n    }\n    showPrevious() {\n        var _a;\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.showPreviousInlineCompletion();\n    }\n    hasMultipleInlineCompletions() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield ((_a = this.session) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\n            return result !== undefined ? result : false;\n        });\n    }\n};\nInlineCompletionsModel = __decorate([\n    __param(2, ICommandService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IConfigurationService)\n], InlineCompletionsModel);\nexport { InlineCompletionsModel };\nexport class InlineCompletionsSession extends BaseGhostTextWidgetModel {\n    constructor(editor, triggerPosition, shouldUpdate, commandService, cache, initialTriggerKind, languageConfigurationService, registry, debounce) {\n        super(editor);\n        this.triggerPosition = triggerPosition;\n        this.shouldUpdate = shouldUpdate;\n        this.commandService = commandService;\n        this.cache = cache;\n        this.initialTriggerKind = initialTriggerKind;\n        this.languageConfigurationService = languageConfigurationService;\n        this.registry = registry;\n        this.debounce = debounce;\n        this.minReservedLineCount = 0;\n        this.updateOperation = this._register(new MutableDisposable());\n        this.updateSoon = this._register(new RunOnceScheduler(() => {\n            const triggerKind = this.initialTriggerKind;\n            // All subsequent triggers are automatic.\n            this.initialTriggerKind = InlineCompletionTriggerKind.Automatic;\n            return this.update(triggerKind);\n        }, 50));\n        this.filteredCompletions = [];\n        //#region Selection\n        // We use a semantic id to track the selection even if the cache changes.\n        this.currentlySelectedCompletionId = undefined;\n        let lastCompletionItem = undefined;\n        this._register(this.onDidChange(() => {\n            var _a;\n            const currentCompletion = this.currentCompletion;\n            if (currentCompletion && currentCompletion.sourceInlineCompletion !== lastCompletionItem) {\n                lastCompletionItem = currentCompletion.sourceInlineCompletion;\n                const provider = currentCompletion.sourceProvider;\n                (_a = provider.handleItemDidShow) === null || _a === void 0 ? void 0 : _a.call(provider, currentCompletion.sourceInlineCompletions, lastCompletionItem);\n            }\n        }));\n        this._register(toDisposable(() => {\n            this.cache.clear();\n        }));\n        this._register(this.editor.onDidChangeCursorPosition((e) => {\n            var _a;\n            if (e.reason === 3 /* CursorChangeReason.Explicit */) {\n                return;\n            }\n            // Ghost text depends on the cursor position\n            (_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.updateRanges();\n            if (this.cache.value) {\n                this.updateFilteredInlineCompletions();\n                this.onDidChangeEmitter.fire();\n            }\n        }));\n        this._register(this.editor.onDidChangeModelContent((e) => {\n            var _a;\n            // Call this in case `onDidChangeModelContent` calls us first.\n            (_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.updateRanges();\n            this.updateFilteredInlineCompletions();\n            this.scheduleAutomaticUpdate();\n        }));\n        this._register(this.registry.onDidChange(() => {\n            this.updateSoon.schedule(this.debounce.get(this.editor.getModel()));\n        }));\n        this.scheduleAutomaticUpdate();\n    }\n    updateFilteredInlineCompletions() {\n        if (!this.cache.value) {\n            this.filteredCompletions = [];\n            return;\n        }\n        const model = this.editor.getModel();\n        const cursorPosition = model.validatePosition(this.editor.getPosition());\n        this.filteredCompletions = this.cache.value.completions.filter(c => {\n            const originalValue = model.getValueInRange(c.synchronizedRange).toLowerCase();\n            const filterText = c.inlineCompletion.filterText.toLowerCase();\n            const indent = model.getLineIndentColumn(c.synchronizedRange.startLineNumber);\n            const cursorPosIndex = Math.max(0, cursorPosition.column - c.synchronizedRange.startColumn);\n            let filterTextBefore = filterText.substring(0, cursorPosIndex);\n            let filterTextAfter = filterText.substring(cursorPosIndex);\n            let originalValueBefore = originalValue.substring(0, cursorPosIndex);\n            let originalValueAfter = originalValue.substring(cursorPosIndex);\n            if (c.synchronizedRange.startColumn <= indent) {\n                // Remove indentation\n                originalValueBefore = originalValueBefore.trimStart();\n                if (originalValueBefore.length === 0) {\n                    originalValueAfter = originalValueAfter.trimStart();\n                }\n                filterTextBefore = filterTextBefore.trimStart();\n                if (filterTextBefore.length === 0) {\n                    filterTextAfter = filterTextAfter.trimStart();\n                }\n            }\n            return filterTextBefore.startsWith(originalValueBefore)\n                && matchesSubString(originalValueAfter, filterTextAfter);\n        });\n    }\n    fixAndGetIndexOfCurrentSelection() {\n        if (!this.currentlySelectedCompletionId || !this.cache.value) {\n            return 0;\n        }\n        if (this.cache.value.completions.length === 0) {\n            // don't reset the selection in this case\n            return 0;\n        }\n        const idx = this.filteredCompletions.findIndex(v => v.semanticId === this.currentlySelectedCompletionId);\n        if (idx === -1) {\n            // Reset the selection so that the selection does not jump back when it appears again\n            this.currentlySelectedCompletionId = undefined;\n            return 0;\n        }\n        return idx;\n    }\n    get currentCachedCompletion() {\n        if (!this.cache.value) {\n            return undefined;\n        }\n        return this.filteredCompletions[this.fixAndGetIndexOfCurrentSelection()];\n    }\n    showNextInlineCompletion() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.ensureUpdateWithExplicitContext();\n            const completions = this.filteredCompletions || [];\n            if (completions.length > 0) {\n                const newIdx = (this.fixAndGetIndexOfCurrentSelection() + 1) % completions.length;\n                this.currentlySelectedCompletionId = completions[newIdx].semanticId;\n            }\n            else {\n                this.currentlySelectedCompletionId = undefined;\n            }\n            this.onDidChangeEmitter.fire();\n        });\n    }\n    showPreviousInlineCompletion() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.ensureUpdateWithExplicitContext();\n            const completions = this.filteredCompletions || [];\n            if (completions.length > 0) {\n                const newIdx = (this.fixAndGetIndexOfCurrentSelection() + completions.length - 1) % completions.length;\n                this.currentlySelectedCompletionId = completions[newIdx].semanticId;\n            }\n            else {\n                this.currentlySelectedCompletionId = undefined;\n            }\n            this.onDidChangeEmitter.fire();\n        });\n    }\n    ensureUpdateWithExplicitContext() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.updateOperation.value) {\n                // Restart or wait for current update operation\n                if (this.updateOperation.value.triggerKind === InlineCompletionTriggerKind.Explicit) {\n                    yield this.updateOperation.value.promise;\n                }\n                else {\n                    yield this.update(InlineCompletionTriggerKind.Explicit);\n                }\n            }\n            else if (((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.triggerKind) !== InlineCompletionTriggerKind.Explicit) {\n                // Refresh cache\n                yield this.update(InlineCompletionTriggerKind.Explicit);\n            }\n        });\n    }\n    hasMultipleInlineCompletions() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.ensureUpdateWithExplicitContext();\n            return (((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions.length) || 0) > 1;\n        });\n    }\n    //#endregion\n    get ghostText() {\n        const currentCompletion = this.currentCompletion;\n        if (!currentCompletion) {\n            return undefined;\n        }\n        const cursorPosition = this.editor.getPosition();\n        if (currentCompletion.range.getEndPosition().isBefore(cursorPosition)) {\n            return undefined;\n        }\n        const mode = this.editor.getOptions().get(57 /* EditorOption.inlineSuggest */).mode;\n        const ghostText = inlineCompletionToGhostText(currentCompletion, this.editor.getModel(), mode, cursorPosition);\n        if (ghostText) {\n            if (ghostText.isEmpty()) {\n                return undefined;\n            }\n            return ghostText;\n        }\n        return new GhostTextReplacement(currentCompletion.range.startLineNumber, currentCompletion.range.startColumn, currentCompletion.range.endColumn - currentCompletion.range.startColumn, currentCompletion.insertText.split('\\n'), 0);\n    }\n    get currentCompletion() {\n        const completion = this.currentCachedCompletion;\n        if (!completion) {\n            return undefined;\n        }\n        return completion.toLiveInlineCompletion();\n    }\n    get isValid() {\n        return this.editor.getPosition().lineNumber === this.triggerPosition.lineNumber;\n    }\n    scheduleAutomaticUpdate() {\n        // Since updateSoon debounces, starvation can happen.\n        // To prevent stale cache, we clear the current update operation.\n        this.updateOperation.clear();\n        this.updateSoon.schedule(this.debounce.get(this.editor.getModel()));\n    }\n    update(triggerKind) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.shouldUpdate()) {\n                return;\n            }\n            const position = this.editor.getPosition();\n            const startTime = new Date();\n            const promise = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                let result;\n                try {\n                    result = yield provideInlineCompletions(this.registry, position, this.editor.getModel(), { triggerKind, selectedSuggestionInfo: undefined }, token, this.languageConfigurationService);\n                    const endTime = new Date();\n                    this.debounce.update(this.editor.getModel(), endTime.getTime() - startTime.getTime());\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                    return;\n                }\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                this.cache.setValue(this.editor, result, triggerKind);\n                this.updateFilteredInlineCompletions();\n                this.onDidChangeEmitter.fire();\n            }));\n            const operation = new UpdateOperation(promise, triggerKind);\n            this.updateOperation.value = operation;\n            yield promise;\n            if (this.updateOperation.value === operation) {\n                this.updateOperation.clear();\n            }\n        });\n    }\n    takeOwnership(disposable) {\n        this._register(disposable);\n    }\n    commitCurrentCompletion() {\n        const ghostText = this.ghostText;\n        if (!ghostText) {\n            // No ghost text was shown for this completion.\n            // Thus, we don't want to commit anything.\n            return;\n        }\n        const completion = this.currentCompletion;\n        if (completion) {\n            this.commit(completion);\n        }\n    }\n    commit(completion) {\n        var _a;\n        // Mark the cache as stale, but don't dispose it yet,\n        // otherwise command args might get disposed.\n        const cache = this.cache.clearAndLeak();\n        if (completion.snippetInfo) {\n            this.editor.executeEdits('inlineSuggestion.accept', [\n                EditOperation.replaceMove(completion.range, ''),\n                ...completion.additionalTextEdits\n            ]);\n            this.editor.setPosition(completion.snippetInfo.range.getStartPosition());\n            (_a = SnippetController2.get(this.editor)) === null || _a === void 0 ? void 0 : _a.insert(completion.snippetInfo.snippet);\n        }\n        else {\n            this.editor.executeEdits('inlineSuggestion.accept', [\n                EditOperation.replaceMove(completion.range, completion.insertText),\n                ...completion.additionalTextEdits\n            ]);\n        }\n        if (completion.command) {\n            this.commandService\n                .executeCommand(completion.command.id, ...(completion.command.arguments || []))\n                .finally(() => {\n                cache === null || cache === void 0 ? void 0 : cache.dispose();\n            })\n                .then(undefined, onUnexpectedExternalError);\n        }\n        else {\n            cache === null || cache === void 0 ? void 0 : cache.dispose();\n        }\n        this.onDidChangeEmitter.fire();\n    }\n    get commands() {\n        var _a;\n        const lists = new Set(((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions.map(c => c.inlineCompletion.sourceInlineCompletions)) || []);\n        return [...lists].flatMap(l => l.commands || []);\n    }\n}\nexport class UpdateOperation {\n    constructor(promise, triggerKind) {\n        this.promise = promise;\n        this.triggerKind = triggerKind;\n    }\n    dispose() {\n        this.promise.cancel();\n    }\n}\n/**\n * The cache keeps itself in sync with the editor.\n * It also owns the completions result and disposes it when the cache is diposed.\n*/\nexport class SynchronizedInlineCompletionsCache extends Disposable {\n    constructor(completionsSource, editor, onChange, triggerKind) {\n        super();\n        this.editor = editor;\n        this.onChange = onChange;\n        this.triggerKind = triggerKind;\n        this.isDisposing = false;\n        const decorationIds = editor.changeDecorations((changeAccessor) => {\n            return changeAccessor.deltaDecorations([], completionsSource.items.map(i => ({\n                range: i.range,\n                options: {\n                    description: 'inline-completion-tracking-range'\n                },\n            })));\n        });\n        this._register(toDisposable(() => {\n            this.isDisposing = true;\n            editor.removeDecorations(decorationIds);\n        }));\n        this.completions = completionsSource.items.map((c, idx) => new CachedInlineCompletion(c, decorationIds[idx]));\n        this._register(editor.onDidChangeModelContent(() => {\n            this.updateRanges();\n        }));\n        this._register(completionsSource);\n    }\n    updateRanges() {\n        if (this.isDisposing) {\n            return;\n        }\n        let hasChanged = false;\n        const model = this.editor.getModel();\n        for (const c of this.completions) {\n            const newRange = model.getDecorationRange(c.decorationId);\n            if (!newRange) {\n                onUnexpectedError(new Error('Decoration has no range'));\n                continue;\n            }\n            if (!c.synchronizedRange.equalsRange(newRange)) {\n                hasChanged = true;\n                c.synchronizedRange = newRange;\n            }\n        }\n        if (hasChanged) {\n            this.onChange();\n        }\n    }\n}\nclass CachedInlineCompletion {\n    constructor(inlineCompletion, decorationId) {\n        this.inlineCompletion = inlineCompletion;\n        this.decorationId = decorationId;\n        this.semanticId = JSON.stringify({\n            text: this.inlineCompletion.insertText,\n            abbreviation: this.inlineCompletion.filterText,\n            startLine: this.inlineCompletion.range.startLineNumber,\n            startColumn: this.inlineCompletion.range.startColumn,\n            command: this.inlineCompletion.command\n        });\n        this.synchronizedRange = inlineCompletion.range;\n    }\n    toLiveInlineCompletion() {\n        return {\n            insertText: this.inlineCompletion.insertText,\n            range: this.synchronizedRange,\n            command: this.inlineCompletion.command,\n            sourceProvider: this.inlineCompletion.sourceProvider,\n            sourceInlineCompletions: this.inlineCompletion.sourceInlineCompletions,\n            sourceInlineCompletion: this.inlineCompletion.sourceInlineCompletion,\n            snippetInfo: this.inlineCompletion.snippetInfo,\n            filterText: this.inlineCompletion.filterText,\n            additionalTextEdits: this.inlineCompletion.additionalTextEdits,\n        };\n    }\n}\nexport function provideInlineCompletions(registry, position, model, context, token = CancellationToken.None, languageConfigurationService) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const defaultReplaceRange = getDefaultRange(position, model);\n        const providers = registry.all(model);\n        const results = yield Promise.all(providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\n            const completions = yield Promise.resolve(provider.provideInlineCompletions(model, position, context, token)).catch(onUnexpectedExternalError);\n            return ({\n                completions,\n                provider,\n                dispose: () => {\n                    if (completions) {\n                        provider.freeInlineCompletions(completions);\n                    }\n                }\n            });\n        })));\n        const itemsByHash = new Map();\n        for (const result of results) {\n            const completions = result.completions;\n            if (!completions) {\n                continue;\n            }\n            for (const item of completions.items) {\n                let range = item.range ? Range.lift(item.range) : defaultReplaceRange;\n                if (range.startLineNumber !== range.endLineNumber) {\n                    // Ignore invalid ranges.\n                    continue;\n                }\n                let insertText;\n                let snippetInfo;\n                if (typeof item.insertText === 'string') {\n                    insertText = item.insertText;\n                    if (languageConfigurationService && item.completeBracketPairs) {\n                        insertText = closeBrackets(insertText, range.getStartPosition(), model, languageConfigurationService);\n                        // Modify range depending on if brackets are added or removed\n                        const diff = insertText.length - item.insertText.length;\n                        if (diff !== 0) {\n                            range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n                        }\n                    }\n                    snippetInfo = undefined;\n                }\n                else if ('snippet' in item.insertText) {\n                    const snippet = new SnippetParser().parse(item.insertText.snippet);\n                    insertText = snippet.toString();\n                    snippetInfo = {\n                        snippet: item.insertText.snippet,\n                        range: range\n                    };\n                }\n                else {\n                    assertNever(item.insertText);\n                }\n                const trackedItem = ({\n                    insertText,\n                    snippetInfo,\n                    range,\n                    command: item.command,\n                    sourceProvider: result.provider,\n                    sourceInlineCompletions: completions,\n                    sourceInlineCompletion: item,\n                    filterText: item.filterText || insertText,\n                    additionalTextEdits: item.additionalTextEdits || getReadonlyEmptyArray()\n                });\n                itemsByHash.set(JSON.stringify({ insertText, range: item.range }), trackedItem);\n            }\n        }\n        return {\n            items: [...itemsByHash.values()],\n            dispose: () => {\n                for (const result of results) {\n                    result.dispose();\n                }\n            },\n        };\n    });\n}\nfunction getDefaultRange(position, model) {\n    const word = model.getWordAtPosition(position);\n    const maxColumn = model.getLineMaxColumn(position.lineNumber);\n    // By default, always replace up until the end of the current line.\n    // This default might be subject to change!\n    return word\n        ? new Range(position.lineNumber, word.startColumn, position.lineNumber, maxColumn)\n        : Range.fromPositions(position, position.with(undefined, maxColumn));\n}\nfunction closeBrackets(text, position, model, languageConfigurationService) {\n    const lineStart = model.getLineContent(position.lineNumber).substring(0, position.column - 1);\n    const newLine = lineStart + text;\n    const newTokens = model.tokenization.tokenizeLineWithEdit(position, newLine.length - (position.column - 1), text);\n    const slicedTokens = newTokens === null || newTokens === void 0 ? void 0 : newTokens.sliceAndInflate(position.column - 1, newLine.length, 0);\n    if (!slicedTokens) {\n        return text;\n    }\n    const newText = fixBracketsInLine(slicedTokens, languageConfigurationService);\n    return newText;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LRUCache, TernarySearchTree } from '../../../../base/common/map.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nexport class Memory {\n    constructor(name) {\n        this.name = name;\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const topScore = items[0].score[0];\n        for (let i = 0; i < items.length; i++) {\n            const { score, completion: suggestion } = items[i];\n            if (score[0] !== topScore) {\n                // stop when leaving the group of top matches\n                break;\n            }\n            if (suggestion.preselect) {\n                // stop when seeing an auto-select-item\n                return i;\n            }\n        }\n        return 0;\n    }\n}\nexport class NoMemory extends Memory {\n    constructor() {\n        super('first');\n    }\n    memorize(model, pos, item) {\n        // no-op\n    }\n    toJSON() {\n        return undefined;\n    }\n    fromJSON() {\n        //\n    }\n}\nexport class LRUMemory extends Memory {\n    constructor() {\n        super('recentlyUsed');\n        this._cache = new LRUCache(300, 0.66);\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const key = `${model.getLanguageId()}/${item.textLabel}`;\n        this._cache.set(key, {\n            touch: this._seq++,\n            type: item.completion.kind,\n            insertText: item.completion.insertText\n        });\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\n        if (/\\s$/.test(lineSuffix)) {\n            return super.select(model, pos, items);\n        }\n        const topScore = items[0].score[0];\n        let indexPreselect = -1;\n        let indexRecency = -1;\n        let seq = -1;\n        for (let i = 0; i < items.length; i++) {\n            if (items[i].score[0] !== topScore) {\n                // consider only top items\n                break;\n            }\n            const key = `${model.getLanguageId()}/${items[i].textLabel}`;\n            const item = this._cache.peek(key);\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\n                seq = item.touch;\n                indexRecency = i;\n            }\n            if (items[i].completion.preselect && indexPreselect === -1) {\n                // stop when seeing an auto-select-item\n                return indexPreselect = i;\n            }\n        }\n        if (indexRecency !== -1) {\n            return indexRecency;\n        }\n        else if (indexPreselect !== -1) {\n            return indexPreselect;\n        }\n        else {\n            return 0;\n        }\n    }\n    toJSON() {\n        return this._cache.toJSON();\n    }\n    fromJSON(data) {\n        this._cache.clear();\n        const seq = 0;\n        for (const [key, value] of data) {\n            value.touch = seq;\n            value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n            this._cache.set(key, value);\n        }\n        this._seq = this._cache.size;\n    }\n}\nexport class PrefixMemory extends Memory {\n    constructor() {\n        super('recentlyUsedByPrefix');\n        this._trie = TernarySearchTree.forStrings();\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const { word } = model.getWordUntilPosition(pos);\n        const key = `${model.getLanguageId()}/${word}`;\n        this._trie.set(key, {\n            type: item.completion.kind,\n            insertText: item.completion.insertText,\n            touch: this._seq++\n        });\n    }\n    select(model, pos, items) {\n        const { word } = model.getWordUntilPosition(pos);\n        if (!word) {\n            return super.select(model, pos, items);\n        }\n        const key = `${model.getLanguageId()}/${word}`;\n        let item = this._trie.get(key);\n        if (!item) {\n            item = this._trie.findSubstr(key);\n        }\n        if (item) {\n            for (let i = 0; i < items.length; i++) {\n                const { kind, insertText } = items[i].completion;\n                if (kind === item.type && insertText === item.insertText) {\n                    return i;\n                }\n            }\n        }\n        return super.select(model, pos, items);\n    }\n    toJSON() {\n        const entries = [];\n        this._trie.forEach((value, key) => entries.push([key, value]));\n        // sort by last recently used (touch), then\n        // take the top 200 item and normalize their\n        // touch\n        entries\n            .sort((a, b) => -(a[1].touch - b[1].touch))\n            .forEach((value, i) => value[1].touch = i);\n        return entries.slice(0, 200);\n    }\n    fromJSON(data) {\n        this._trie.clear();\n        if (data.length > 0) {\n            this._seq = data[0][1].touch + 1;\n            for (const [key, value] of data) {\n                value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n                this._trie.set(key, value);\n            }\n        }\n    }\n}\nlet SuggestMemoryService = class SuggestMemoryService {\n    constructor(_storageService, _configService) {\n        this._storageService = _storageService;\n        this._configService = _configService;\n        this._disposables = new DisposableStore();\n        this._persistSoon = new RunOnceScheduler(() => this._saveState(), 500);\n        this._disposables.add(_storageService.onWillSaveState(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                this._saveState();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._persistSoon.dispose();\n    }\n    memorize(model, pos, item) {\n        this._withStrategy(model, pos).memorize(model, pos, item);\n        this._persistSoon.schedule();\n    }\n    select(model, pos, items) {\n        return this._withStrategy(model, pos).select(model, pos, items);\n    }\n    _withStrategy(model, pos) {\n        var _a;\n        const mode = this._configService.getValue('editor.suggestSelection', {\n            overrideIdentifier: model.getLanguageIdAtPosition(pos.lineNumber, pos.column),\n            resource: model.uri\n        });\n        if (((_a = this._strategy) === null || _a === void 0 ? void 0 : _a.name) !== mode) {\n            this._saveState();\n            const ctor = SuggestMemoryService._strategyCtors.get(mode) || NoMemory;\n            this._strategy = new ctor();\n            try {\n                const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n                const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n                const raw = this._storageService.get(`${SuggestMemoryService._storagePrefix}/${mode}`, scope);\n                if (raw) {\n                    this._strategy.fromJSON(JSON.parse(raw));\n                }\n            }\n            catch (e) {\n                // things can go wrong with JSON...\n            }\n        }\n        return this._strategy;\n    }\n    _saveState() {\n        if (this._strategy) {\n            const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n            const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n            const raw = JSON.stringify(this._strategy);\n            this._storageService.store(`${SuggestMemoryService._storagePrefix}/${this._strategy.name}`, raw, scope, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n};\nSuggestMemoryService._strategyCtors = new Map([\n    ['recentlyUsedByPrefix', PrefixMemory],\n    ['recentlyUsed', LRUMemory],\n    ['first', NoMemory]\n]);\nSuggestMemoryService._storagePrefix = 'suggest/memories';\nSuggestMemoryService = __decorate([\n    __param(0, IStorageService),\n    __param(1, IConfigurationService)\n], SuggestMemoryService);\nexport { SuggestMemoryService };\nexport const ISuggestMemoryService = createDecorator('ISuggestMemories');\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, true);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet WordContextKey = class WordContextKey {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._enabled = false;\n        this._ckAtEnd = WordContextKey.AtEnd.bindTo(contextKeyService);\n        this._configListener = this._editor.onDidChangeConfiguration(e => e.hasChanged(113 /* EditorOption.tabCompletion */) && this._update());\n        this._update();\n    }\n    dispose() {\n        var _a;\n        this._configListener.dispose();\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._ckAtEnd.reset();\n    }\n    _update() {\n        // only update this when tab completions are enabled\n        const enabled = this._editor.getOption(113 /* EditorOption.tabCompletion */) === 'on';\n        if (this._enabled === enabled) {\n            return;\n        }\n        this._enabled = enabled;\n        if (this._enabled) {\n            const checkForWordEnd = () => {\n                if (!this._editor.hasModel()) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                const model = this._editor.getModel();\n                const selection = this._editor.getSelection();\n                const word = model.getWordAtPosition(selection.getStartPosition());\n                if (!word) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\n            };\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\n            checkForWordEnd();\n        }\n        else if (this._selectionListener) {\n            this._ckAtEnd.reset();\n            this._selectionListener.dispose();\n            this._selectionListener = undefined;\n        }\n    }\n};\nWordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\nWordContextKey = __decorate([\n    __param(1, IContextKeyService)\n], WordContextKey);\nexport { WordContextKey };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet SuggestAlternatives = class SuggestAlternatives {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._index = 0;\n        this._ckOtherSuggestions = SuggestAlternatives.OtherSuggestions.bindTo(contextKeyService);\n    }\n    dispose() {\n        this.reset();\n    }\n    reset() {\n        var _a;\n        this._ckOtherSuggestions.reset();\n        (_a = this._listener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._model = undefined;\n        this._acceptNext = undefined;\n        this._ignore = false;\n    }\n    set({ model, index }, acceptNext) {\n        // no suggestions -> nothing to do\n        if (model.items.length === 0) {\n            this.reset();\n            return;\n        }\n        // no alternative suggestions -> nothing to do\n        const nextIndex = SuggestAlternatives._moveIndex(true, model, index);\n        if (nextIndex === index) {\n            this.reset();\n            return;\n        }\n        this._acceptNext = acceptNext;\n        this._model = model;\n        this._index = index;\n        this._listener = this._editor.onDidChangeCursorPosition(() => {\n            if (!this._ignore) {\n                this.reset();\n            }\n        });\n        this._ckOtherSuggestions.set(true);\n    }\n    static _moveIndex(fwd, model, index) {\n        let newIndex = index;\n        while (true) {\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\n            if (newIndex === index) {\n                break;\n            }\n            if (!model.items[newIndex].completion.additionalTextEdits) {\n                break;\n            }\n        }\n        return newIndex;\n    }\n    next() {\n        this._move(true);\n    }\n    prev() {\n        this._move(false);\n    }\n    _move(fwd) {\n        if (!this._model) {\n            // nothing to reason about\n            return;\n        }\n        try {\n            this._ignore = true;\n            this._index = SuggestAlternatives._moveIndex(fwd, this._model, this._index);\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\n        }\n        finally {\n            this._ignore = false;\n        }\n    }\n};\nSuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\nSuggestAlternatives = __decorate([\n    __param(1, IContextKeyService)\n], SuggestAlternatives);\nexport { SuggestAlternatives };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nexport class CommitCharacterController {\n    constructor(editor, widget, accept) {\n        this._disposables = new DisposableStore();\n        this._disposables.add(widget.onDidShow(() => this._onItem(widget.getFocusedItem())));\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\n        this._disposables.add(widget.onDidHide(this.reset, this));\n        this._disposables.add(editor.onWillType(text => {\n            if (this._active && !widget.isFrozen()) {\n                const ch = text.charCodeAt(text.length - 1);\n                if (this._active.acceptCharacters.has(ch) && editor.getOption(0 /* EditorOption.acceptSuggestionOnCommitCharacter */)) {\n                    accept(this._active.item);\n                }\n            }\n        }));\n    }\n    _onItem(selected) {\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\n            // no item or no commit characters\n            this.reset();\n            return;\n        }\n        if (this._active && this._active.item.item === selected.item) {\n            // still the same item\n            return;\n        }\n        // keep item and its commit characters\n        const acceptCharacters = new CharacterSet();\n        for (const ch of selected.item.completion.commitCharacters) {\n            if (ch.length > 0) {\n                acceptCharacters.add(ch.charCodeAt(0));\n            }\n        }\n        this._active = { acceptCharacters, item: selected };\n    }\n    reset() {\n        this._active = undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport class BracketSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = [];\n            for (const position of positions) {\n                const bucket = [];\n                result.push(bucket);\n                const ranges = new Map();\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\n            }\n            return result;\n        });\n    }\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findNextBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\n                break;\n            }\n            if (bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.bracketText;\n                // wait for closing\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.getClosedBrackets()[0].bracketText;\n                // process closing\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    let list = ranges.get(key);\n                    if (!list) {\n                        list = new LinkedList();\n                        ranges.set(key, list);\n                    }\n                    list.push(bracket.range);\n                }\n            }\n            pos = bracket.range.getEndPosition();\n        }\n    }\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findPrevBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\n                break;\n            }\n            if (!bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.getClosedBrackets()[0].bracketText;\n                // wait for opening\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.bracketText;\n                // opening\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    const list = ranges.get(key);\n                    if (list) {\n                        const closing = list.shift();\n                        if (list.size === 0) {\n                            ranges.delete(key);\n                        }\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\n                        bucket.push({ range: innerBracket });\n                        bucket.push({ range: outerBracket });\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\n                    }\n                }\n            }\n            pos = bracket.range.getStartPosition();\n        }\n    }\n    static _addBracketLeading(model, bracket, bucket) {\n        if (bracket.startLineNumber === bracket.endLineNumber) {\n            return;\n        }\n        // xxxxxxxx {\n        //\n        // }\n        const startLine = bracket.startLineNumber;\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\n        if (column !== 0 && column !== bracket.startColumn) {\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\n        }\n        // xxxxxxxx\n        // {\n        //\n        // }\n        const aboveLine = startLine - 1;\n        if (aboveLine > 0) {\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\n            }\n        }\n    }\n}\nBracketSelectionRangeProvider._maxDuration = 30;\nBracketSelectionRangeProvider._maxRounds = 2;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { binarySearch, isFalsyOrEmpty } from '../../../../base/common/arrays.js';\nimport { Range } from '../../../common/core/range.js';\nimport { BracketSelectionRangeProvider } from '../../smartSelect/browser/bracketSelections.js';\nexport class WordDistance {\n    static create(service, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.getOption(108 /* EditorOption.suggest */).localityBonus) {\n                return WordDistance.None;\n            }\n            if (!editor.hasModel()) {\n                return WordDistance.None;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!service.canComputeWordRanges(model.uri)) {\n                return WordDistance.None;\n            }\n            const [ranges] = yield new BracketSelectionRangeProvider().provideSelectionRanges(model, [position]);\n            if (ranges.length === 0) {\n                return WordDistance.None;\n            }\n            const wordRanges = yield service.computeWordRanges(model.uri, ranges[0].range);\n            if (!wordRanges) {\n                return WordDistance.None;\n            }\n            // remove current word\n            const wordUntilPos = model.getWordUntilPosition(position);\n            delete wordRanges[wordUntilPos.word];\n            return new class extends WordDistance {\n                distance(anchor, item) {\n                    if (!position.equals(editor.getPosition())) {\n                        return 0;\n                    }\n                    if (item.kind === 17 /* CompletionItemKind.Keyword */) {\n                        return 2 << 20;\n                    }\n                    const word = typeof item.label === 'string' ? item.label : item.label.label;\n                    const wordLines = wordRanges[word];\n                    if (isFalsyOrEmpty(wordLines)) {\n                        return 2 << 20;\n                    }\n                    const idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\n                    const bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\n                    let blockDistance = ranges.length;\n                    for (const range of ranges) {\n                        if (!Range.containsRange(range.range, bestWordRange)) {\n                            break;\n                        }\n                        blockDistance -= 1;\n                    }\n                    return blockDistance;\n                }\n            };\n        });\n    }\n}\nWordDistance.None = new class extends WordDistance {\n    distance() { return 0; }\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { quickSelect } from '../../../../base/common/arrays.js';\nimport { anyScore, fuzzyScore, FuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { compareIgnoreCase } from '../../../../base/common/strings.js';\nexport class LineContext {\n    constructor(leadingLineContent, characterCountDelta) {\n        this.leadingLineContent = leadingLineContent;\n        this.characterCountDelta = characterCountDelta;\n    }\n}\n/**\n * Sorted, filtered completion view model\n * */\nexport class CompletionModel {\n    constructor(items, column, lineContext, wordDistance, options, snippetSuggestions, fuzzyScoreOptions = FuzzyScoreOptions.default, clipboardText = undefined) {\n        this.clipboardText = clipboardText;\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\n        this._items = items;\n        this._column = column;\n        this._wordDistance = wordDistance;\n        this._options = options;\n        this._refilterKind = 1 /* Refilter.All */;\n        this._lineContext = lineContext;\n        this._fuzzyScoreOptions = fuzzyScoreOptions;\n        if (snippetSuggestions === 'top') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\n        }\n        else if (snippetSuggestions === 'bottom') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\n        }\n    }\n    get lineContext() {\n        return this._lineContext;\n    }\n    set lineContext(value) {\n        if (this._lineContext.leadingLineContent !== value.leadingLineContent\n            || this._lineContext.characterCountDelta !== value.characterCountDelta) {\n            this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Refilter.Incr */ : 1 /* Refilter.All */;\n            this._lineContext = value;\n        }\n    }\n    get items() {\n        this._ensureCachedState();\n        return this._filteredItems;\n    }\n    get allProvider() {\n        this._ensureCachedState();\n        return this._providerInfo.keys();\n    }\n    get incomplete() {\n        this._ensureCachedState();\n        const result = new Set();\n        for (const [provider, incomplete] of this._providerInfo) {\n            if (incomplete) {\n                result.add(provider);\n            }\n        }\n        return result;\n    }\n    adopt(except) {\n        const res = [];\n        for (let i = 0; i < this._items.length;) {\n            if (!except.has(this._items[i].provider)) {\n                res.push(this._items[i]);\n                // unordered removed\n                this._items[i] = this._items[this._items.length - 1];\n                this._items.pop();\n            }\n            else {\n                // continue with next item\n                i++;\n            }\n        }\n        this._refilterKind = 1 /* Refilter.All */;\n        return res;\n    }\n    get stats() {\n        this._ensureCachedState();\n        return this._stats;\n    }\n    _ensureCachedState() {\n        if (this._refilterKind !== 0 /* Refilter.Nothing */) {\n            this._createCachedState();\n        }\n    }\n    _createCachedState() {\n        this._providerInfo = new Map();\n        const labelLengths = [];\n        const { leadingLineContent, characterCountDelta } = this._lineContext;\n        let word = '';\n        let wordLow = '';\n        // incrementally filter less\n        const source = this._refilterKind === 1 /* Refilter.All */ ? this._items : this._filteredItems;\n        const target = [];\n        // picks a score function based on the number of\n        // items that we have to score/filter and based on the\n        // user-configuration\n        const scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\n        for (let i = 0; i < source.length; i++) {\n            const item = source[i];\n            if (item.isInvalid) {\n                continue; // SKIP invalid items\n            }\n            // collect all support, know if their result is incomplete\n            this._providerInfo.set(item.provider, Boolean(item.container.incomplete));\n            // 'word' is that remainder of the current line that we\n            // filter and score against. In theory each suggestion uses a\n            // different word, but in practice not - that's why we cache\n            const overwriteBefore = item.position.column - item.editStart.column;\n            const wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\n            if (word.length !== wordLen) {\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\n                wordLow = word.toLowerCase();\n            }\n            // remember the word against which this item was\n            // scored\n            item.word = word;\n            if (wordLen === 0) {\n                // when there is nothing to score against, don't\n                // event try to do. Use a const rank and rely on\n                // the fallback-sort using the initial sort order.\n                // use a score of `-100` because that is out of the\n                // bound of values `fuzzyScore` will return\n                item.score = FuzzyScore.Default;\n            }\n            else {\n                // skip word characters that are whitespace until\n                // we have hit the replace range (overwriteBefore)\n                let wordPos = 0;\n                while (wordPos < overwriteBefore) {\n                    const ch = word.charCodeAt(wordPos);\n                    if (ch === 32 /* CharCode.Space */ || ch === 9 /* CharCode.Tab */) {\n                        wordPos += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                if (wordPos >= wordLen) {\n                    // the wordPos at which scoring starts is the whole word\n                    // and therefore the same rules as not having a word apply\n                    item.score = FuzzyScore.Default;\n                }\n                else if (typeof item.completion.filterText === 'string') {\n                    // when there is a `filterText` it must match the `word`.\n                    // if it matches we check with the label to compute highlights\n                    // and if that doesn't yield a result we have no highlights,\n                    // despite having the match\n                    const match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    if (compareIgnoreCase(item.completion.filterText, item.textLabel) === 0) {\n                        // filterText and label are actually the same -> use good highlights\n                        item.score = match;\n                    }\n                    else {\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\n                        // of the filterText-match\n                        item.score = anyScore(word, wordLow, wordPos, item.textLabel, item.labelLow, 0);\n                        item.score[0] = match[0]; // use score from filterText\n                    }\n                }\n                else {\n                    // by default match `word` against the `label`\n                    const match = scoreFn(word, wordLow, wordPos, item.textLabel, item.labelLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    item.score = match;\n                }\n            }\n            item.idx = i;\n            item.distance = this._wordDistance.distance(item.position, item.completion);\n            target.push(item);\n            // update stats\n            labelLengths.push(item.textLabel.length);\n        }\n        this._filteredItems = target.sort(this._snippetCompareFn);\n        this._refilterKind = 0 /* Refilter.Nothing */;\n        this._stats = {\n            pLabelLen: labelLengths.length ?\n                quickSelect(labelLengths.length - .85, labelLengths, (a, b) => a - b)\n                : 0\n        };\n    }\n    static _compareCompletionItems(a, b) {\n        if (a.score[0] > b.score[0]) {\n            return -1;\n        }\n        else if (a.score[0] < b.score[0]) {\n            return 1;\n        }\n        else if (a.distance < b.distance) {\n            return -1;\n        }\n        else if (a.distance > b.distance) {\n            return 1;\n        }\n        else if (a.idx < b.idx) {\n            return -1;\n        }\n        else if (a.idx > b.idx) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static _compareCompletionItemsSnippetsDown(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n    static _compareCompletionItemsSnippetsUp(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace, isHighSurrogate, isLowSurrogate } from '../../../../base/common/strings.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CompletionModel } from './completionModel.js';\nimport { CompletionOptions, getSnippetSuggestSupport, getSuggestionComparator, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class LineContext {\n    constructor(model, position, auto, shy, noSelect) {\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n        this.leadingWord = model.getWordUntilPosition(position);\n        this.lineNumber = position.lineNumber;\n        this.column = position.column;\n        this.auto = auto;\n        this.shy = shy;\n        this.noSelect = noSelect;\n    }\n    static shouldAutoTrigger(editor) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const pos = editor.getPosition();\n        model.tokenization.tokenizeIfCheap(pos.lineNumber);\n        const word = model.getWordAtPosition(pos);\n        if (!word) {\n            return false;\n        }\n        if (word.endColumn !== pos.column) {\n            return false;\n        }\n        if (!isNaN(Number(word.word))) {\n            return false;\n        }\n        return true;\n    }\n}\nfunction isSuggestPreviewEnabled(editor) {\n    return editor.getOption(108 /* EditorOption.suggest */).preview;\n}\nfunction canShowQuickSuggest(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const allowQuickSuggestions = configurationService.getValue('editor.inlineSuggest.allowQuickSuggestions');\n    if (allowQuickSuggestions !== undefined) {\n        // Use setting if available.\n        return Boolean(allowQuickSuggestions);\n    }\n    // Don't allow if inline suggestions are visible and no suggest preview is configured.\n    // TODO disabled for copilot\n    return false && isSuggestPreviewEnabled(editor);\n}\nfunction canShowSuggestOnTriggerCharacters(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const allowQuickSuggestions = configurationService.getValue('editor.inlineSuggest.allowSuggestOnTriggerCharacters');\n    if (allowQuickSuggestions !== undefined) {\n        // Use setting if available.\n        return Boolean(allowQuickSuggestions);\n    }\n    // Don't allow if inline suggestions are visible and no suggest preview is configured.\n    // TODO disabled for copilot\n    return false && isSuggestPreviewEnabled(editor);\n}\nlet SuggestModel = class SuggestModel {\n    constructor(_editor, _editorWorkerService, _clipboardService, _telemetryService, _logService, _contextKeyService, _configurationService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._clipboardService = _clipboardService;\n        this._telemetryService = _telemetryService;\n        this._logService = _logService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._toDispose = new DisposableStore();\n        this._triggerCharacterListener = new DisposableStore();\n        this._triggerQuickSuggest = new TimeoutTimer();\n        this._state = 0 /* State.Idle */;\n        this._completionDisposables = new DisposableStore();\n        this._onDidCancel = new Emitter();\n        this._onDidTrigger = new Emitter();\n        this._onDidSuggest = new Emitter();\n        this.onDidCancel = this._onDidCancel.event;\n        this.onDidTrigger = this._onDidTrigger.event;\n        this.onDidSuggest = this._onDidSuggest.event;\n        this._telemetryGate = 0;\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\n        // wire up various listeners\n        this._toDispose.add(this._editor.onDidChangeModel(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeConfiguration(() => {\n            this._updateTriggerCharacters();\n        }));\n        this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(() => {\n            this._updateTriggerCharacters();\n            this._updateActiveSuggestSession();\n        }));\n        let editorIsComposing = false;\n        this._toDispose.add(this._editor.onDidCompositionStart(() => {\n            editorIsComposing = true;\n        }));\n        this._toDispose.add(this._editor.onDidCompositionEnd(() => {\n            editorIsComposing = false;\n            this._onCompositionEnd();\n        }));\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(e => {\n            // only trigger suggest when the editor isn't composing a character\n            if (!editorIsComposing) {\n                this._onCursorChange(e);\n            }\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelContent(() => {\n            // only filter completions when the editor isn't composing a character\n            // allow-any-unicode-next-line\n            // e.g.  + u makes  but just  cannot be used for filtering\n            if (!editorIsComposing) {\n                this._refilterCompletionItems();\n            }\n        }));\n        this._updateTriggerCharacters();\n    }\n    dispose() {\n        dispose(this._triggerCharacterListener);\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\n        this._toDispose.dispose();\n        this._completionDisposables.dispose();\n        this.cancel();\n    }\n    _updateTriggerCharacters() {\n        this._triggerCharacterListener.clear();\n        if (this._editor.getOption(83 /* EditorOption.readOnly */)\n            || !this._editor.hasModel()\n            || !this._editor.getOption(111 /* EditorOption.suggestOnTriggerCharacters */)) {\n            return;\n        }\n        const supportsByTriggerCharacter = new Map();\n        for (const support of this._languageFeaturesService.completionProvider.all(this._editor.getModel())) {\n            for (const ch of support.triggerCharacters || []) {\n                let set = supportsByTriggerCharacter.get(ch);\n                if (!set) {\n                    set = new Set();\n                    set.add(getSnippetSuggestSupport());\n                    supportsByTriggerCharacter.set(ch, set);\n                }\n                set.add(support);\n            }\n        }\n        const checkTriggerCharacter = (text) => {\n            if (!canShowSuggestOnTriggerCharacters(this._editor, this._contextKeyService, this._configurationService)) {\n                return;\n            }\n            if (LineContext.shouldAutoTrigger(this._editor)) {\n                // don't trigger by trigger characters when this is a case for quick suggest\n                return;\n            }\n            if (!text) {\n                // came here from the compositionEnd-event\n                const position = this._editor.getPosition();\n                const model = this._editor.getModel();\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n            }\n            let lastChar = '';\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\n                    lastChar = text.substr(text.length - 2);\n                }\n            }\n            else {\n                lastChar = text.charAt(text.length - 1);\n            }\n            const supports = supportsByTriggerCharacter.get(lastChar);\n            if (supports) {\n                // keep existing items that where not computed by the\n                // supports/providers that want to trigger now\n                const existing = this._completionModel\n                    ? { items: this._completionModel.adopt(supports), clipboardText: this._completionModel.clipboardText }\n                    : undefined;\n                this.trigger({ auto: true, shy: false, noSelect: false, triggerCharacter: lastChar }, Boolean(this._completionModel), supports, existing);\n            }\n        };\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(() => checkTriggerCharacter()));\n    }\n    // --- trigger/retrigger/cancel suggest\n    get state() {\n        return this._state;\n    }\n    cancel(retrigger = false) {\n        var _a;\n        if (this._state !== 0 /* State.Idle */) {\n            this._triggerQuickSuggest.cancel();\n            (_a = this._requestToken) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._requestToken = undefined;\n            this._state = 0 /* State.Idle */;\n            this._completionModel = undefined;\n            this._context = undefined;\n            this._onDidCancel.fire({ retrigger });\n        }\n    }\n    clear() {\n        this._completionDisposables.clear();\n    }\n    _updateActiveSuggestSession() {\n        if (this._state !== 0 /* State.Idle */) {\n            if (!this._editor.hasModel() || !this._languageFeaturesService.completionProvider.has(this._editor.getModel())) {\n                this.cancel();\n            }\n            else {\n                this.trigger({ auto: this._state === 2 /* State.Auto */, shy: false, noSelect: false }, true);\n            }\n        }\n    }\n    _onCursorChange(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const prevSelection = this._currentSelection;\n        this._currentSelection = this._editor.getSelection();\n        if (!e.selection.isEmpty()\n            || (e.reason !== 0 /* CursorChangeReason.NotSet */ && e.reason !== 3 /* CursorChangeReason.Explicit */)\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\n            // Early exit if nothing needs to be done!\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n            this.cancel();\n            return;\n        }\n        if (this._state === 0 /* State.Idle */ && e.reason === 0 /* CursorChangeReason.NotSet */) {\n            if (prevSelection.containsRange(this._currentSelection) || prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\n                // cursor did move RIGHT due to typing -> trigger quick suggest\n                this._doTriggerQuickSuggest();\n            }\n        }\n        else if (this._state !== 0 /* State.Idle */ && e.reason === 3 /* CursorChangeReason.Explicit */) {\n            // suggest is active and something like cursor keys are used to move\n            // the cursor. this means we can refilter at the new position\n            this._refilterCompletionItems();\n        }\n    }\n    _onCompositionEnd() {\n        // trigger or refilter when composition ends\n        if (this._state === 0 /* State.Idle */) {\n            this._doTriggerQuickSuggest();\n        }\n        else {\n            this._refilterCompletionItems();\n        }\n    }\n    _doTriggerQuickSuggest() {\n        var _a;\n        if (QuickSuggestionsOptions.isAllOff(this._editor.getOption(81 /* EditorOption.quickSuggestions */))) {\n            // not enabled\n            return;\n        }\n        if (this._editor.getOption(108 /* EditorOption.suggest */).snippetsPreventQuickSuggestions && ((_a = SnippetController2.get(this._editor)) === null || _a === void 0 ? void 0 : _a.isInSnippet())) {\n            // no quick suggestion when in snippet mode\n            return;\n        }\n        this.cancel();\n        this._triggerQuickSuggest.cancelAndSet(() => {\n            if (this._state !== 0 /* State.Idle */) {\n                return;\n            }\n            if (!LineContext.shouldAutoTrigger(this._editor)) {\n                return;\n            }\n            if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            const pos = this._editor.getPosition();\n            // validate enabled now\n            const config = this._editor.getOption(81 /* EditorOption.quickSuggestions */);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                return;\n            }\n            if (!QuickSuggestionsOptions.isAllOn(config)) {\n                // Check the type of the token that triggered this\n                model.tokenization.tokenizeIfCheap(pos.lineNumber);\n                const lineTokens = model.tokenization.getLineTokens(pos.lineNumber);\n                const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\n                if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'on') {\n                    return;\n                }\n            }\n            if (!canShowQuickSuggest(this._editor, this._contextKeyService, this._configurationService)) {\n                // do not trigger quick suggestions if inline suggestions are shown\n                return;\n            }\n            if (!this._languageFeaturesService.completionProvider.has(model)) {\n                return;\n            }\n            // we made it till here -> trigger now\n            this.trigger({ auto: true, shy: false, noSelect: false });\n        }, this._editor.getOption(82 /* EditorOption.quickSuggestionsDelay */));\n    }\n    _refilterCompletionItems() {\n        // Re-filter suggestions. This MUST run async because filtering/scoring\n        // uses the model content AND the cursor position. The latter is NOT\n        // updated when the document has changed (the event which drives this method)\n        // and therefore a little pause (next mirco task) is needed. See:\n        // https://stackoverflow.com/questions/25915634/difference-between-microtask-and-macrotask-within-an-event-loop-context#25933985\n        Promise.resolve().then(() => {\n            if (this._state === 0 /* State.Idle */) {\n                return;\n            }\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            const position = this._editor.getPosition();\n            const ctx = new LineContext(model, position, this._state === 2 /* State.Auto */, false, false);\n            this._onNewContext(ctx);\n        });\n    }\n    trigger(context, retrigger = false, onlyFrom, existing, noFilter) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const auto = context.auto;\n        const ctx = new LineContext(model, this._editor.getPosition(), auto, context.shy, context.noSelect);\n        // Cancel previous requests, change state & update UI\n        this.cancel(retrigger);\n        this._state = auto ? 2 /* State.Auto */ : 1 /* State.Manual */;\n        this._onDidTrigger.fire({ auto, shy: context.shy, position: this._editor.getPosition() });\n        // Capture context when request was sent\n        this._context = ctx;\n        // Build context for request\n        let suggestCtx = { triggerKind: (_a = context.triggerKind) !== null && _a !== void 0 ? _a : 0 /* CompletionTriggerKind.Invoke */ };\n        if (context.triggerCharacter) {\n            suggestCtx = {\n                triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                triggerCharacter: context.triggerCharacter\n            };\n        }\n        this._requestToken = new CancellationTokenSource();\n        // kind filter and snippet sort rules\n        const snippetSuggestions = this._editor.getOption(103 /* EditorOption.snippetSuggestions */);\n        let snippetSortOrder = 1 /* SnippetSortOrder.Inline */;\n        switch (snippetSuggestions) {\n            case 'top':\n                snippetSortOrder = 0 /* SnippetSortOrder.Top */;\n                break;\n            // \t that's the default anyways...\n            // case 'inline':\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\n            // \tbreak;\n            case 'bottom':\n                snippetSortOrder = 2 /* SnippetSortOrder.Bottom */;\n                break;\n        }\n        const { itemKind: itemKindFilter, showDeprecated } = SuggestModel._createSuggestFilter(this._editor);\n        const completionOptions = new CompletionOptions(snippetSortOrder, !noFilter ? itemKindFilter : new Set(), onlyFrom, showDeprecated);\n        const wordDistance = WordDistance.create(this._editorWorkerService, this._editor);\n        const completions = provideSuggestionItems(this._languageFeaturesService.completionProvider, model, this._editor.getPosition(), completionOptions, suggestCtx, this._requestToken.token);\n        Promise.all([completions, wordDistance]).then(([completions, wordDistance]) => __awaiter(this, void 0, void 0, function* () {\n            var _b;\n            (_b = this._requestToken) === null || _b === void 0 ? void 0 : _b.dispose();\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            let clipboardText = existing === null || existing === void 0 ? void 0 : existing.clipboardText;\n            if (!clipboardText && completions.needsClipboard) {\n                clipboardText = yield this._clipboardService.readText();\n            }\n            if (this._state === 0 /* State.Idle */) {\n                return;\n            }\n            const model = this._editor.getModel();\n            let items = completions.items;\n            if (existing) {\n                const cmpFn = getSuggestionComparator(snippetSortOrder);\n                items = items.concat(existing.items).sort(cmpFn);\n            }\n            const ctx = new LineContext(model, this._editor.getPosition(), auto, context.shy, context.noSelect);\n            this._completionModel = new CompletionModel(items, this._context.column, {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            }, wordDistance, this._editor.getOption(108 /* EditorOption.suggest */), this._editor.getOption(103 /* EditorOption.snippetSuggestions */), undefined, clipboardText);\n            // store containers so that they can be disposed later\n            this._completionDisposables.add(completions.disposable);\n            this._onNewContext(ctx);\n            // finally report telemetry about durations\n            this._reportDurationsTelemetry(completions.durations);\n        })).catch(onUnexpectedError);\n    }\n    _reportDurationsTelemetry(durations) {\n        if (this._telemetryGate++ % 230 !== 0) {\n            return;\n        }\n        setTimeout(() => {\n            this._telemetryService.publicLog2('suggest.durations.json', { data: JSON.stringify(durations) });\n            this._logService.debug('suggest.durations.json', durations);\n        });\n    }\n    static _createSuggestFilter(editor) {\n        // kind filter and snippet sort rules\n        const result = new Set();\n        // snippet setting\n        const snippetSuggestions = editor.getOption(103 /* EditorOption.snippetSuggestions */);\n        if (snippetSuggestions === 'none') {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        // type setting\n        const suggestOptions = editor.getOption(108 /* EditorOption.suggest */);\n        if (!suggestOptions.showMethods) {\n            result.add(0 /* CompletionItemKind.Method */);\n        }\n        if (!suggestOptions.showFunctions) {\n            result.add(1 /* CompletionItemKind.Function */);\n        }\n        if (!suggestOptions.showConstructors) {\n            result.add(2 /* CompletionItemKind.Constructor */);\n        }\n        if (!suggestOptions.showFields) {\n            result.add(3 /* CompletionItemKind.Field */);\n        }\n        if (!suggestOptions.showVariables) {\n            result.add(4 /* CompletionItemKind.Variable */);\n        }\n        if (!suggestOptions.showClasses) {\n            result.add(5 /* CompletionItemKind.Class */);\n        }\n        if (!suggestOptions.showStructs) {\n            result.add(6 /* CompletionItemKind.Struct */);\n        }\n        if (!suggestOptions.showInterfaces) {\n            result.add(7 /* CompletionItemKind.Interface */);\n        }\n        if (!suggestOptions.showModules) {\n            result.add(8 /* CompletionItemKind.Module */);\n        }\n        if (!suggestOptions.showProperties) {\n            result.add(9 /* CompletionItemKind.Property */);\n        }\n        if (!suggestOptions.showEvents) {\n            result.add(10 /* CompletionItemKind.Event */);\n        }\n        if (!suggestOptions.showOperators) {\n            result.add(11 /* CompletionItemKind.Operator */);\n        }\n        if (!suggestOptions.showUnits) {\n            result.add(12 /* CompletionItemKind.Unit */);\n        }\n        if (!suggestOptions.showValues) {\n            result.add(13 /* CompletionItemKind.Value */);\n        }\n        if (!suggestOptions.showConstants) {\n            result.add(14 /* CompletionItemKind.Constant */);\n        }\n        if (!suggestOptions.showEnums) {\n            result.add(15 /* CompletionItemKind.Enum */);\n        }\n        if (!suggestOptions.showEnumMembers) {\n            result.add(16 /* CompletionItemKind.EnumMember */);\n        }\n        if (!suggestOptions.showKeywords) {\n            result.add(17 /* CompletionItemKind.Keyword */);\n        }\n        if (!suggestOptions.showWords) {\n            result.add(18 /* CompletionItemKind.Text */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(19 /* CompletionItemKind.Color */);\n        }\n        if (!suggestOptions.showFiles) {\n            result.add(20 /* CompletionItemKind.File */);\n        }\n        if (!suggestOptions.showReferences) {\n            result.add(21 /* CompletionItemKind.Reference */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(22 /* CompletionItemKind.Customcolor */);\n        }\n        if (!suggestOptions.showFolders) {\n            result.add(23 /* CompletionItemKind.Folder */);\n        }\n        if (!suggestOptions.showTypeParameters) {\n            result.add(24 /* CompletionItemKind.TypeParameter */);\n        }\n        if (!suggestOptions.showSnippets) {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        if (!suggestOptions.showUsers) {\n            result.add(25 /* CompletionItemKind.User */);\n        }\n        if (!suggestOptions.showIssues) {\n            result.add(26 /* CompletionItemKind.Issue */);\n        }\n        return { itemKind: result, showDeprecated: suggestOptions.showDeprecated };\n    }\n    _onNewContext(ctx) {\n        if (!this._context) {\n            // happens when 24x7 IntelliSense is enabled and still in its delay\n            return;\n        }\n        if (ctx.lineNumber !== this._context.lineNumber) {\n            // e.g. happens when pressing Enter while IntelliSense is computed\n            this.cancel();\n            return;\n        }\n        if (getLeadingWhitespace(ctx.leadingLineContent) !== getLeadingWhitespace(this._context.leadingLineContent)) {\n            // cancel IntelliSense when line start changes\n            // happens when the current word gets outdented\n            this.cancel();\n            return;\n        }\n        if (ctx.column < this._context.column) {\n            // typed -> moved cursor LEFT -> retrigger if still on a word\n            if (ctx.leadingWord.word) {\n                this.trigger({ auto: this._context.auto, shy: false, noSelect: false }, true);\n            }\n            else {\n                this.cancel();\n            }\n            return;\n        }\n        if (!this._completionModel) {\n            // happens when IntelliSense is not yet computed\n            return;\n        }\n        if (ctx.leadingWord.word.length !== 0 && ctx.leadingWord.startColumn > this._context.leadingWord.startColumn) {\n            // started a new word while IntelliSense shows -> retrigger\n            // Select those providers have not contributed to this completion model and re-trigger completions for\n            // them. Also adopt the existing items and merge them into the new completion model\n            const inactiveProvider = new Set(this._languageFeaturesService.completionProvider.all(this._editor.getModel()));\n            for (const provider of this._completionModel.allProvider) {\n                inactiveProvider.delete(provider);\n            }\n            const items = this._completionModel.adopt(new Set());\n            this.trigger({ auto: this._context.auto, shy: false, noSelect: false }, true, inactiveProvider, { items, clipboardText: this._completionModel.clipboardText });\n            return;\n        }\n        if (ctx.column > this._context.column && this._completionModel.incomplete.size > 0 && ctx.leadingWord.word.length !== 0) {\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\n            const { incomplete } = this._completionModel;\n            const items = this._completionModel.adopt(incomplete);\n            this.trigger({ auto: this._state === 2 /* State.Auto */, shy: false, noSelect: false, triggerKind: 2 /* CompletionTriggerKind.TriggerForIncompleteCompletions */ }, true, incomplete, { items, clipboardText: this._completionModel.clipboardText });\n        }\n        else {\n            // typed -> moved cursor RIGHT -> update UI\n            const oldLineContext = this._completionModel.lineContext;\n            let isFrozen = false;\n            this._completionModel.lineContext = {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            };\n            if (this._completionModel.items.length === 0) {\n                if (LineContext.shouldAutoTrigger(this._editor) && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\n                    // retrigger when heading into a new word\n                    this.trigger({ auto: this._context.auto, shy: false, noSelect: false }, true);\n                    return;\n                }\n                if (!this._context.auto) {\n                    // freeze when IntelliSense was manually requested\n                    this._completionModel.lineContext = oldLineContext;\n                    isFrozen = this._completionModel.items.length > 0;\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\n                        // there were results before but now there aren't\n                        // and also we are not on a word anymore -> cancel\n                        this.cancel();\n                        return;\n                    }\n                }\n                else {\n                    // nothing left\n                    this.cancel();\n                    return;\n                }\n            }\n            this._onDidSuggest.fire({\n                completionModel: this._completionModel,\n                auto: this._context.auto,\n                shy: this._context.shy,\n                noSelect: this._context.noSelect,\n                isFrozen,\n            });\n        }\n    }\n};\nSuggestModel = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IClipboardService),\n    __param(3, ITelemetryService),\n    __param(4, ILogService),\n    __param(5, IContextKeyService),\n    __param(6, IConfigurationService),\n    __param(7, ILanguageFeaturesService)\n], SuggestModel);\nexport { SuggestModel };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n    constructor(editor, suggestModel) {\n        this._disposables = new DisposableStore();\n        this._lastOvertyped = [];\n        this._empty = true;\n        this._disposables.add(editor.onWillType(() => {\n            if (!this._empty) {\n                return;\n            }\n            if (!editor.hasModel()) {\n                return;\n            }\n            const selections = editor.getSelections();\n            const selectionsLength = selections.length;\n            // Check if it will overtype any selections\n            let willOvertype = false;\n            for (let i = 0; i < selectionsLength; i++) {\n                if (!selections[i].isEmpty()) {\n                    willOvertype = true;\n                    break;\n                }\n            }\n            if (!willOvertype) {\n                return;\n            }\n            this._lastOvertyped = [];\n            const model = editor.getModel();\n            for (let i = 0; i < selectionsLength; i++) {\n                const selection = selections[i];\n                // Check for overtyping capturer restrictions\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n                    return;\n                }\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\n            }\n            this._empty = false;\n        }));\n        this._disposables.add(suggestModel.onDidCancel(e => {\n            if (!this._empty && !e.retrigger) {\n                this._empty = true;\n            }\n        }));\n    }\n    getLastOvertypedInfo(idx) {\n        if (!this._empty && idx >= 0 && idx < this._lastOvertyped.length) {\n            return this._lastOvertyped[idx];\n        }\n        return undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nOvertypingCapturer._maxSelectionLength = 51200;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { suggestWidgetStatusbarMenu } from './suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            this.label.textContent = localize('ddd', '{0} ({1})', this._action.label, StatusBarViewItem.symbolPrintEnter(kb));\n        }\n    }\n    static symbolPrintEnter(kb) {\n        var _a;\n        return (_a = kb.getLabel()) === null || _a === void 0 ? void 0 : _a.replace(/\\benter\\b/gi, '\\u23CE');\n    }\n}\nlet SuggestWidgetStatus = class SuggestWidgetStatus {\n    constructor(container, instantiationService, _menuService, _contextKeyService) {\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._menuDisposables = new DisposableStore();\n        this.element = dom.append(container, dom.$('.suggest-status-bar'));\n        const actionViewItemProvider = (action => {\n            return action instanceof MenuItemAction ? instantiationService.createInstance(StatusBarViewItem, action, undefined) : undefined;\n        });\n        this._leftActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._rightActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._leftActions.domNode.classList.add('left');\n        this._rightActions.domNode.classList.add('right');\n    }\n    dispose() {\n        this._menuDisposables.dispose();\n        this.element.remove();\n    }\n    show() {\n        const menu = this._menuService.createMenu(suggestWidgetStatusbarMenu, this._contextKeyService);\n        const renderMenu = () => {\n            const left = [];\n            const right = [];\n            for (const [group, actions] of menu.getActions()) {\n                if (group === 'left') {\n                    left.push(...actions);\n                }\n                else {\n                    right.push(...actions);\n                }\n            }\n            this._leftActions.clear();\n            this._leftActions.push(left);\n            this._rightActions.clear();\n            this._rightActions.push(right);\n        };\n        this._menuDisposables.add(menu.onDidChange(() => renderMenu()));\n        this._menuDisposables.add(menu);\n    }\n    hide() {\n        this._menuDisposables.clear();\n    }\n};\nSuggestWidgetStatus = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IMenuService),\n    __param(3, IContextKeyService)\n], SuggestWidgetStatus);\nexport { SuggestWidgetStatus };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { localize } from '../../../../nls.js';\nimport { foreground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nexport const SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC',\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nregisterThemingParticipant((theme, collector) => {\n    const symbolIconArrayColor = theme.getColor(SYMBOL_ICON_ARRAY_FOREGROUND);\n    if (symbolIconArrayColor) {\n        collector.addRule(`${Codicon.symbolArray.cssSelector} { color: ${symbolIconArrayColor}; }`);\n    }\n    const symbolIconBooleanColor = theme.getColor(SYMBOL_ICON_BOOLEAN_FOREGROUND);\n    if (symbolIconBooleanColor) {\n        collector.addRule(`${Codicon.symbolBoolean.cssSelector} { color: ${symbolIconBooleanColor}; }`);\n    }\n    const symbolIconClassColor = theme.getColor(SYMBOL_ICON_CLASS_FOREGROUND);\n    if (symbolIconClassColor) {\n        collector.addRule(`${Codicon.symbolClass.cssSelector} { color: ${symbolIconClassColor}; }`);\n    }\n    const symbolIconMethodColor = theme.getColor(SYMBOL_ICON_METHOD_FOREGROUND);\n    if (symbolIconMethodColor) {\n        collector.addRule(`${Codicon.symbolMethod.cssSelector} { color: ${symbolIconMethodColor}; }`);\n    }\n    const symbolIconColorColor = theme.getColor(SYMBOL_ICON_COLOR_FOREGROUND);\n    if (symbolIconColorColor) {\n        collector.addRule(`${Codicon.symbolColor.cssSelector} { color: ${symbolIconColorColor}; }`);\n    }\n    const symbolIconConstantColor = theme.getColor(SYMBOL_ICON_CONSTANT_FOREGROUND);\n    if (symbolIconConstantColor) {\n        collector.addRule(`${Codicon.symbolConstant.cssSelector} { color: ${symbolIconConstantColor}; }`);\n    }\n    const symbolIconConstructorColor = theme.getColor(SYMBOL_ICON_CONSTRUCTOR_FOREGROUND);\n    if (symbolIconConstructorColor) {\n        collector.addRule(`${Codicon.symbolConstructor.cssSelector} { color: ${symbolIconConstructorColor}; }`);\n    }\n    const symbolIconEnumeratorColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_FOREGROUND);\n    if (symbolIconEnumeratorColor) {\n        collector.addRule(`\n\t\t\t${Codicon.symbolValue.cssSelector},${Codicon.symbolEnum.cssSelector} { color: ${symbolIconEnumeratorColor}; }`);\n    }\n    const symbolIconEnumeratorMemberColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND);\n    if (symbolIconEnumeratorMemberColor) {\n        collector.addRule(`${Codicon.symbolEnumMember.cssSelector} { color: ${symbolIconEnumeratorMemberColor}; }`);\n    }\n    const symbolIconEventColor = theme.getColor(SYMBOL_ICON_EVENT_FOREGROUND);\n    if (symbolIconEventColor) {\n        collector.addRule(`${Codicon.symbolEvent.cssSelector} { color: ${symbolIconEventColor}; }`);\n    }\n    const symbolIconFieldColor = theme.getColor(SYMBOL_ICON_FIELD_FOREGROUND);\n    if (symbolIconFieldColor) {\n        collector.addRule(`${Codicon.symbolField.cssSelector} { color: ${symbolIconFieldColor}; }`);\n    }\n    const symbolIconFileColor = theme.getColor(SYMBOL_ICON_FILE_FOREGROUND);\n    if (symbolIconFileColor) {\n        collector.addRule(`${Codicon.symbolFile.cssSelector} { color: ${symbolIconFileColor}; }`);\n    }\n    const symbolIconFolderColor = theme.getColor(SYMBOL_ICON_FOLDER_FOREGROUND);\n    if (symbolIconFolderColor) {\n        collector.addRule(`${Codicon.symbolFolder.cssSelector} { color: ${symbolIconFolderColor}; }`);\n    }\n    const symbolIconFunctionColor = theme.getColor(SYMBOL_ICON_FUNCTION_FOREGROUND);\n    if (symbolIconFunctionColor) {\n        collector.addRule(`${Codicon.symbolFunction.cssSelector} { color: ${symbolIconFunctionColor}; }`);\n    }\n    const symbolIconInterfaceColor = theme.getColor(SYMBOL_ICON_INTERFACE_FOREGROUND);\n    if (symbolIconInterfaceColor) {\n        collector.addRule(`${Codicon.symbolInterface.cssSelector} { color: ${symbolIconInterfaceColor}; }`);\n    }\n    const symbolIconKeyColor = theme.getColor(SYMBOL_ICON_KEY_FOREGROUND);\n    if (symbolIconKeyColor) {\n        collector.addRule(`${Codicon.symbolKey.cssSelector} { color: ${symbolIconKeyColor}; }`);\n    }\n    const symbolIconKeywordColor = theme.getColor(SYMBOL_ICON_KEYWORD_FOREGROUND);\n    if (symbolIconKeywordColor) {\n        collector.addRule(`${Codicon.symbolKeyword.cssSelector} { color: ${symbolIconKeywordColor}; }`);\n    }\n    const symbolIconModuleColor = theme.getColor(SYMBOL_ICON_MODULE_FOREGROUND);\n    if (symbolIconModuleColor) {\n        collector.addRule(`${Codicon.symbolModule.cssSelector} { color: ${symbolIconModuleColor}; }`);\n    }\n    const outlineNamespaceColor = theme.getColor(SYMBOL_ICON_NAMESPACE_FOREGROUND);\n    if (outlineNamespaceColor) {\n        collector.addRule(`${Codicon.symbolNamespace.cssSelector} { color: ${outlineNamespaceColor}; }`);\n    }\n    const symbolIconNullColor = theme.getColor(SYMBOL_ICON_NULL_FOREGROUND);\n    if (symbolIconNullColor) {\n        collector.addRule(`${Codicon.symbolNull.cssSelector} { color: ${symbolIconNullColor}; }`);\n    }\n    const symbolIconNumberColor = theme.getColor(SYMBOL_ICON_NUMBER_FOREGROUND);\n    if (symbolIconNumberColor) {\n        collector.addRule(`${Codicon.symbolNumber.cssSelector} { color: ${symbolIconNumberColor}; }`);\n    }\n    const symbolIconObjectColor = theme.getColor(SYMBOL_ICON_OBJECT_FOREGROUND);\n    if (symbolIconObjectColor) {\n        collector.addRule(`${Codicon.symbolObject.cssSelector} { color: ${symbolIconObjectColor}; }`);\n    }\n    const symbolIconOperatorColor = theme.getColor(SYMBOL_ICON_OPERATOR_FOREGROUND);\n    if (symbolIconOperatorColor) {\n        collector.addRule(`${Codicon.symbolOperator.cssSelector} { color: ${symbolIconOperatorColor}; }`);\n    }\n    const symbolIconPackageColor = theme.getColor(SYMBOL_ICON_PACKAGE_FOREGROUND);\n    if (symbolIconPackageColor) {\n        collector.addRule(`${Codicon.symbolPackage.cssSelector} { color: ${symbolIconPackageColor}; }`);\n    }\n    const symbolIconPropertyColor = theme.getColor(SYMBOL_ICON_PROPERTY_FOREGROUND);\n    if (symbolIconPropertyColor) {\n        collector.addRule(`${Codicon.symbolProperty.cssSelector} { color: ${symbolIconPropertyColor}; }`);\n    }\n    const symbolIconReferenceColor = theme.getColor(SYMBOL_ICON_REFERENCE_FOREGROUND);\n    if (symbolIconReferenceColor) {\n        collector.addRule(`${Codicon.symbolReference.cssSelector} { color: ${symbolIconReferenceColor}; }`);\n    }\n    const symbolIconSnippetColor = theme.getColor(SYMBOL_ICON_SNIPPET_FOREGROUND);\n    if (symbolIconSnippetColor) {\n        collector.addRule(`${Codicon.symbolSnippet.cssSelector} { color: ${symbolIconSnippetColor}; }`);\n    }\n    const symbolIconStringColor = theme.getColor(SYMBOL_ICON_STRING_FOREGROUND);\n    if (symbolIconStringColor) {\n        collector.addRule(`${Codicon.symbolString.cssSelector} { color: ${symbolIconStringColor}; }`);\n    }\n    const symbolIconStructColor = theme.getColor(SYMBOL_ICON_STRUCT_FOREGROUND);\n    if (symbolIconStructColor) {\n        collector.addRule(`${Codicon.symbolStruct.cssSelector} { color: ${symbolIconStructColor}; }`);\n    }\n    const symbolIconTextColor = theme.getColor(SYMBOL_ICON_TEXT_FOREGROUND);\n    if (symbolIconTextColor) {\n        collector.addRule(`${Codicon.symbolText.cssSelector} { color: ${symbolIconTextColor}; }`);\n    }\n    const symbolIconTypeParameterColor = theme.getColor(SYMBOL_ICON_TYPEPARAMETER_FOREGROUND);\n    if (symbolIconTypeParameterColor) {\n        collector.addRule(`${Codicon.symbolTypeParameter.cssSelector} { color: ${symbolIconTypeParameterColor}; }`);\n    }\n    const symbolIconUnitColor = theme.getColor(SYMBOL_ICON_UNIT_FOREGROUND);\n    if (symbolIconUnitColor) {\n        collector.addRule(`${Codicon.symbolUnit.cssSelector} { color: ${symbolIconUnitColor}; }`);\n    }\n    const symbolIconVariableColor = theme.getColor(SYMBOL_ICON_VARIABLE_FOREGROUND);\n    if (symbolIconVariableColor) {\n        collector.addRule(`${Codicon.symbolVariable.cssSelector} { color: ${symbolIconVariableColor}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Dimension } from '../../dom.js';\nimport { OrthogonalEdge, Sash } from '../sash/sash.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { DisposableStore } from '../../../common/lifecycle.js';\nexport class ResizableHTMLElement {\n    constructor() {\n        this._onDidWillResize = new Emitter();\n        this.onDidWillResize = this._onDidWillResize.event;\n        this._onDidResize = new Emitter();\n        this.onDidResize = this._onDidResize.event;\n        this._sashListener = new DisposableStore();\n        this._size = new Dimension(0, 0);\n        this._minSize = new Dimension(0, 0);\n        this._maxSize = new Dimension(Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER);\n        this.domNode = document.createElement('div');\n        this._eastSash = new Sash(this.domNode, { getVerticalSashLeft: () => this._size.width }, { orientation: 0 /* Orientation.VERTICAL */ });\n        this._westSash = new Sash(this.domNode, { getVerticalSashLeft: () => 0 }, { orientation: 0 /* Orientation.VERTICAL */ });\n        this._northSash = new Sash(this.domNode, { getHorizontalSashTop: () => 0 }, { orientation: 1 /* Orientation.HORIZONTAL */, orthogonalEdge: OrthogonalEdge.North });\n        this._southSash = new Sash(this.domNode, { getHorizontalSashTop: () => this._size.height }, { orientation: 1 /* Orientation.HORIZONTAL */, orthogonalEdge: OrthogonalEdge.South });\n        this._northSash.orthogonalStartSash = this._westSash;\n        this._northSash.orthogonalEndSash = this._eastSash;\n        this._southSash.orthogonalStartSash = this._westSash;\n        this._southSash.orthogonalEndSash = this._eastSash;\n        let currentSize;\n        let deltaY = 0;\n        let deltaX = 0;\n        this._sashListener.add(Event.any(this._northSash.onDidStart, this._eastSash.onDidStart, this._southSash.onDidStart, this._westSash.onDidStart)(() => {\n            if (currentSize === undefined) {\n                this._onDidWillResize.fire();\n                currentSize = this._size;\n                deltaY = 0;\n                deltaX = 0;\n            }\n        }));\n        this._sashListener.add(Event.any(this._northSash.onDidEnd, this._eastSash.onDidEnd, this._southSash.onDidEnd, this._westSash.onDidEnd)(() => {\n            if (currentSize !== undefined) {\n                currentSize = undefined;\n                deltaY = 0;\n                deltaX = 0;\n                this._onDidResize.fire({ dimension: this._size, done: true });\n            }\n        }));\n        this._sashListener.add(this._eastSash.onDidChange(e => {\n            if (currentSize) {\n                deltaX = e.currentX - e.startX;\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, east: true });\n            }\n        }));\n        this._sashListener.add(this._westSash.onDidChange(e => {\n            if (currentSize) {\n                deltaX = -(e.currentX - e.startX);\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, west: true });\n            }\n        }));\n        this._sashListener.add(this._northSash.onDidChange(e => {\n            if (currentSize) {\n                deltaY = -(e.currentY - e.startY);\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, north: true });\n            }\n        }));\n        this._sashListener.add(this._southSash.onDidChange(e => {\n            if (currentSize) {\n                deltaY = e.currentY - e.startY;\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, south: true });\n            }\n        }));\n        this._sashListener.add(Event.any(this._eastSash.onDidReset, this._westSash.onDidReset)(e => {\n            if (this._preferredSize) {\n                this.layout(this._size.height, this._preferredSize.width);\n                this._onDidResize.fire({ dimension: this._size, done: true });\n            }\n        }));\n        this._sashListener.add(Event.any(this._northSash.onDidReset, this._southSash.onDidReset)(e => {\n            if (this._preferredSize) {\n                this.layout(this._preferredSize.height, this._size.width);\n                this._onDidResize.fire({ dimension: this._size, done: true });\n            }\n        }));\n    }\n    dispose() {\n        this._northSash.dispose();\n        this._southSash.dispose();\n        this._eastSash.dispose();\n        this._westSash.dispose();\n        this._sashListener.dispose();\n        this._onDidResize.dispose();\n        this._onDidWillResize.dispose();\n        this.domNode.remove();\n    }\n    enableSashes(north, east, south, west) {\n        this._northSash.state = north ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n        this._eastSash.state = east ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n        this._southSash.state = south ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n        this._westSash.state = west ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n    }\n    layout(height = this.size.height, width = this.size.width) {\n        const { height: minHeight, width: minWidth } = this._minSize;\n        const { height: maxHeight, width: maxWidth } = this._maxSize;\n        height = Math.max(minHeight, Math.min(maxHeight, height));\n        width = Math.max(minWidth, Math.min(maxWidth, width));\n        const newSize = new Dimension(width, height);\n        if (!Dimension.equals(newSize, this._size)) {\n            this.domNode.style.height = height + 'px';\n            this.domNode.style.width = width + 'px';\n            this._size = newSize;\n            this._northSash.layout();\n            this._eastSash.layout();\n            this._southSash.layout();\n            this._westSash.layout();\n        }\n    }\n    clearSashHoverState() {\n        this._eastSash.clearSashHoverState();\n        this._westSash.clearSashHoverState();\n        this._northSash.clearSashHoverState();\n        this._southSash.clearSashHoverState();\n    }\n    get size() {\n        return this._size;\n    }\n    set maxSize(value) {\n        this._maxSize = value;\n    }\n    get maxSize() {\n        return this._maxSize;\n    }\n    set minSize(value) {\n        this._minSize = value;\n    }\n    get minSize() {\n        return this._minSize;\n    }\n    set preferredSize(value) {\n        this._preferredSize = value;\n    }\n    get preferredSize() {\n        return this._preferredSize;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport function canExpandCompletionItem(item) {\n    return !!item && Boolean(item.completion.documentation || item.completion.detail && item.completion.detail !== item.completion.label);\n}\nlet SuggestDetailsWidget = class SuggestDetailsWidget {\n    constructor(_editor, instaService) {\n        this._editor = _editor;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        this._onDidChangeContents = new Emitter();\n        this.onDidChangeContents = this._onDidChangeContents.event;\n        this._disposables = new DisposableStore();\n        this._renderDisposeable = new DisposableStore();\n        this._borderWidth = 1;\n        this._size = new dom.Dimension(330, 0);\n        this.domNode = dom.$('.suggest-details');\n        this.domNode.classList.add('no-docs');\n        this._markdownRenderer = instaService.createInstance(MarkdownRenderer, { editor: _editor });\n        this._body = dom.$('.body');\n        this._scrollbar = new DomScrollableElement(this._body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        dom.append(this.domNode, this._scrollbar.getDomNode());\n        this._disposables.add(this._scrollbar);\n        this._header = dom.append(this._body, dom.$('.header'));\n        this._close = dom.append(this._header, dom.$('span' + Codicon.close.cssSelector));\n        this._close.title = nls.localize('details.close', \"Close\");\n        this._type = dom.append(this._header, dom.$('p.type'));\n        this._docs = dom.append(this._body, dom.$('p.docs'));\n        this._configureFont();\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */)) {\n                this._configureFont();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._renderDisposeable.dispose();\n    }\n    _configureFont() {\n        const options = this._editor.getOptions();\n        const fontInfo = options.get(46 /* EditorOption.fontInfo */);\n        const fontFamily = fontInfo.getMassagedFontFamily();\n        const fontSize = options.get(109 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n        const lineHeight = options.get(110 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n        const fontWeight = fontInfo.fontWeight;\n        const fontSizePx = `${fontSize}px`;\n        const lineHeightPx = `${lineHeight}px`;\n        this.domNode.style.fontSize = fontSizePx;\n        this.domNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this.domNode.style.fontWeight = fontWeight;\n        this.domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        this._type.style.fontFamily = fontFamily;\n        this._close.style.height = lineHeightPx;\n        this._close.style.width = lineHeightPx;\n    }\n    getLayoutInfo() {\n        const lineHeight = this._editor.getOption(110 /* EditorOption.suggestLineHeight */) || this._editor.getOption(46 /* EditorOption.fontInfo */).lineHeight;\n        const borderWidth = this._borderWidth;\n        const borderHeight = borderWidth * 2;\n        return {\n            lineHeight,\n            borderWidth,\n            borderHeight,\n            verticalPadding: 22,\n            horizontalPadding: 14\n        };\n    }\n    renderLoading() {\n        this._type.textContent = nls.localize('loading', \"Loading...\");\n        this._docs.textContent = '';\n        this.domNode.classList.remove('no-docs', 'no-type');\n        this.layout(this.size.width, this.getLayoutInfo().lineHeight * 2);\n        this._onDidChangeContents.fire(this);\n    }\n    renderItem(item, explainMode) {\n        var _a, _b;\n        this._renderDisposeable.clear();\n        let { detail, documentation } = item.completion;\n        if (explainMode) {\n            let md = '';\n            md += `score: ${item.score[0]}\\n`;\n            md += `prefix: ${(_a = item.word) !== null && _a !== void 0 ? _a : '(no prefix)'}\\n`;\n            md += `word: ${item.completion.filterText ? item.completion.filterText + ' (filterText)' : item.textLabel}\\n`;\n            md += `distance: ${item.distance} (localityBonus-setting)\\n`;\n            md += `index: ${item.idx}, based on ${item.completion.sortText && `sortText: \"${item.completion.sortText}\"` || 'label'}\\n`;\n            md += `commit_chars: ${(_b = item.completion.commitCharacters) === null || _b === void 0 ? void 0 : _b.join('')}\\n`;\n            documentation = new MarkdownString().appendCodeblock('empty', md);\n            detail = `Provider: ${item.provider._debugDisplayName}`;\n        }\n        if (!explainMode && !canExpandCompletionItem(item)) {\n            this.clearContents();\n            return;\n        }\n        this.domNode.classList.remove('no-docs', 'no-type');\n        // --- details\n        if (detail) {\n            const cappedDetail = detail.length > 100000 ? `${detail.substr(0, 100000)}` : detail;\n            this._type.textContent = cappedDetail;\n            this._type.title = cappedDetail;\n            dom.show(this._type);\n            this._type.classList.toggle('auto-wrap', !/\\r?\\n^\\s+/gmi.test(cappedDetail));\n        }\n        else {\n            dom.clearNode(this._type);\n            this._type.title = '';\n            dom.hide(this._type);\n            this.domNode.classList.add('no-type');\n        }\n        // --- documentation\n        dom.clearNode(this._docs);\n        if (typeof documentation === 'string') {\n            this._docs.classList.remove('markdown-docs');\n            this._docs.textContent = documentation;\n        }\n        else if (documentation) {\n            this._docs.classList.add('markdown-docs');\n            dom.clearNode(this._docs);\n            const renderedContents = this._markdownRenderer.render(documentation);\n            this._docs.appendChild(renderedContents.element);\n            this._renderDisposeable.add(renderedContents);\n            this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(() => {\n                this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n                this._onDidChangeContents.fire(this);\n            }));\n        }\n        this.domNode.style.userSelect = 'text';\n        this.domNode.tabIndex = -1;\n        this._close.onmousedown = e => {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        this._close.onclick = e => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._onDidClose.fire();\n        };\n        this._body.scrollTop = 0;\n        this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n        this._onDidChangeContents.fire(this);\n    }\n    clearContents() {\n        this.domNode.classList.add('no-docs');\n        this._type.textContent = '';\n        this._docs.textContent = '';\n    }\n    get size() {\n        return this._size;\n    }\n    layout(width, height) {\n        const newSize = new dom.Dimension(width, height);\n        if (!dom.Dimension.equals(newSize, this._size)) {\n            this._size = newSize;\n            dom.size(this.domNode, width, height);\n        }\n        this._scrollbar.scanDomNode();\n    }\n    scrollDown(much = 8) {\n        this._body.scrollTop += much;\n    }\n    scrollUp(much = 8) {\n        this._body.scrollTop -= much;\n    }\n    scrollTop() {\n        this._body.scrollTop = 0;\n    }\n    scrollBottom() {\n        this._body.scrollTop = this._body.scrollHeight;\n    }\n    pageDown() {\n        this.scrollDown(80);\n    }\n    pageUp() {\n        this.scrollUp(80);\n    }\n    set borderWidth(width) {\n        this._borderWidth = width;\n    }\n    get borderWidth() {\n        return this._borderWidth;\n    }\n};\nSuggestDetailsWidget = __decorate([\n    __param(1, IInstantiationService)\n], SuggestDetailsWidget);\nexport { SuggestDetailsWidget };\nexport class SuggestDetailsOverlay {\n    constructor(widget, _editor) {\n        this.widget = widget;\n        this._editor = _editor;\n        this._disposables = new DisposableStore();\n        this._added = false;\n        this._preferAlignAtTop = true;\n        this._resizable = new ResizableHTMLElement();\n        this._resizable.domNode.classList.add('suggest-details-container');\n        this._resizable.domNode.appendChild(widget.domNode);\n        this._resizable.enableSashes(false, true, true, false);\n        let topLeftNow;\n        let sizeNow;\n        let deltaTop = 0;\n        let deltaLeft = 0;\n        this._disposables.add(this._resizable.onDidWillResize(() => {\n            topLeftNow = this._topLeft;\n            sizeNow = this._resizable.size;\n        }));\n        this._disposables.add(this._resizable.onDidResize(e => {\n            if (topLeftNow && sizeNow) {\n                this.widget.layout(e.dimension.width, e.dimension.height);\n                let updateTopLeft = false;\n                if (e.west) {\n                    deltaLeft = sizeNow.width - e.dimension.width;\n                    updateTopLeft = true;\n                }\n                if (e.north) {\n                    deltaTop = sizeNow.height - e.dimension.height;\n                    updateTopLeft = true;\n                }\n                if (updateTopLeft) {\n                    this._applyTopLeft({\n                        top: topLeftNow.top + deltaTop,\n                        left: topLeftNow.left + deltaLeft,\n                    });\n                }\n            }\n            if (e.done) {\n                topLeftNow = undefined;\n                sizeNow = undefined;\n                deltaTop = 0;\n                deltaLeft = 0;\n                this._userSize = e.dimension;\n            }\n        }));\n        this._disposables.add(this.widget.onDidChangeContents(() => {\n            var _a;\n            if (this._anchorBox) {\n                this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, this._preferAlignAtTop);\n            }\n        }));\n    }\n    dispose() {\n        this._resizable.dispose();\n        this._disposables.dispose();\n        this.hide();\n    }\n    getId() {\n        return 'suggest.details';\n    }\n    getDomNode() {\n        return this._resizable.domNode;\n    }\n    getPosition() {\n        return null;\n    }\n    show() {\n        if (!this._added) {\n            this._editor.addOverlayWidget(this);\n            this.getDomNode().style.position = 'fixed';\n            this._added = true;\n        }\n    }\n    hide(sessionEnded = false) {\n        this._resizable.clearSashHoverState();\n        if (this._added) {\n            this._editor.removeOverlayWidget(this);\n            this._added = false;\n            this._anchorBox = undefined;\n            this._topLeft = undefined;\n        }\n        if (sessionEnded) {\n            this._userSize = undefined;\n            this.widget.clearContents();\n        }\n    }\n    placeAtAnchor(anchor, preferAlignAtTop) {\n        var _a;\n        const anchorBox = anchor.getBoundingClientRect();\n        this._anchorBox = anchorBox;\n        this._preferAlignAtTop = preferAlignAtTop;\n        this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, preferAlignAtTop);\n    }\n    _placeAtAnchor(anchorBox, size, preferAlignAtTop) {\n        var _a;\n        const bodyBox = dom.getClientArea(document.body);\n        const info = this.widget.getLayoutInfo();\n        const defaultMinSize = new dom.Dimension(220, 2 * info.lineHeight);\n        const defaultTop = anchorBox.top;\n        // EAST\n        const eastPlacement = (function () {\n            const width = bodyBox.width - (anchorBox.left + anchorBox.width + info.borderWidth + info.horizontalPadding);\n            const left = -info.borderWidth + anchorBox.left + anchorBox.width;\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // WEST\n        const westPlacement = (function () {\n            const width = anchorBox.left - info.borderWidth - info.horizontalPadding;\n            const left = Math.max(info.horizontalPadding, anchorBox.left - size.width - info.borderWidth);\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // SOUTH\n        const southPacement = (function () {\n            const left = anchorBox.left;\n            const top = -info.borderWidth + anchorBox.top + anchorBox.height;\n            const maxSizeBottom = new dom.Dimension(anchorBox.width - info.borderHeight, bodyBox.height - anchorBox.top - anchorBox.height - info.verticalPadding);\n            return { top, left, fit: maxSizeBottom.height - size.height, maxSizeBottom, maxSizeTop: maxSizeBottom, minSize: defaultMinSize.with(maxSizeBottom.width) };\n        })();\n        // take first placement that fits or the first with \"least bad\" fit\n        const placements = [eastPlacement, westPlacement, southPacement];\n        const placement = (_a = placements.find(p => p.fit >= 0)) !== null && _a !== void 0 ? _a : placements.sort((a, b) => b.fit - a.fit)[0];\n        // top/bottom placement\n        const bottom = anchorBox.top + anchorBox.height - info.borderHeight;\n        let alignAtTop;\n        let height = size.height;\n        const maxHeight = Math.max(placement.maxSizeTop.height, placement.maxSizeBottom.height);\n        if (height > maxHeight) {\n            height = maxHeight;\n        }\n        let maxSize;\n        if (preferAlignAtTop) {\n            if (height <= placement.maxSizeTop.height) {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n            else {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n        }\n        else {\n            if (height <= placement.maxSizeBottom.height) {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n            else {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n        }\n        this._applyTopLeft({ left: placement.left, top: alignAtTop ? placement.top : bottom - height });\n        this.getDomNode().style.position = 'fixed';\n        this._resizable.enableSashes(!alignAtTop, placement === eastPlacement, alignAtTop, placement !== eastPlacement);\n        this._resizable.minSize = placement.minSize;\n        this._resizable.maxSize = maxSize;\n        this._resizable.layout(height, Math.min(maxSize.width, size.width));\n        this.widget.layout(this._resizable.size.width, this._resizable.size.height);\n    }\n    _applyTopLeft(topLeft) {\n        this._topLeft = topLeft;\n        this.getDomNode().style.left = `${this._topLeft.left}px`;\n        this.getDomNode().style.top = `${this._topLeft.top}px`;\n    }\n}\n","//#endregion\n//#region Utilities\nexport var FileKind;\n(function (FileKind) {\n    FileKind[FileKind[\"FILE\"] = 0] = \"FILE\";\n    FileKind[FileKind[\"FOLDER\"] = 1] = \"FOLDER\";\n    FileKind[FileKind[\"ROOT_FOLDER\"] = 2] = \"ROOT_FOLDER\";\n})(FileKind || (FileKind = {}));\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Schemas } from '../../../base/common/network.js';\nimport { DataUri } from '../../../base/common/resources.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../languages/modesRegistry.js';\nimport { FileKind } from '../../../platform/files/common/files.js';\nconst fileIconDirectoryRegex = /(?:\\/|^)(?:([^\\/]+)\\/)?([^\\/]+)$/;\nexport function getIconClasses(modelService, languageService, resource, fileKind) {\n    // we always set these base classes even if we do not have a path\n    const classes = fileKind === FileKind.ROOT_FOLDER ? ['rootfolder-icon'] : fileKind === FileKind.FOLDER ? ['folder-icon'] : ['file-icon'];\n    if (resource) {\n        // Get the path and name of the resource. For data-URIs, we need to parse specially\n        let name;\n        if (resource.scheme === Schemas.data) {\n            const metadata = DataUri.parseMetaData(resource);\n            name = metadata.get(DataUri.META_DATA_LABEL);\n        }\n        else {\n            const match = resource.path.match(fileIconDirectoryRegex);\n            if (match) {\n                name = cssEscape(match[2].toLowerCase());\n                if (match[1]) {\n                    classes.push(`${cssEscape(match[1].toLowerCase())}-name-dir-icon`); // parent directory\n                }\n            }\n            else {\n                name = cssEscape(resource.authority.toLowerCase());\n            }\n        }\n        // Folders\n        if (fileKind === FileKind.FOLDER) {\n            classes.push(`${name}-name-folder-icon`);\n        }\n        // Files\n        else {\n            // Name & Extension(s)\n            if (name) {\n                classes.push(`${name}-name-file-icon`);\n                classes.push(`name-file-icon`); // extra segment to increase file-name score\n                // Avoid doing an explosive combination of extensions for very long filenames\n                // (most file systems do not allow files > 255 length) with lots of `.` characters\n                // https://github.com/microsoft/vscode/issues/116199\n                if (name.length <= 255) {\n                    const dotSegments = name.split('.');\n                    for (let i = 1; i < dotSegments.length; i++) {\n                        classes.push(`${dotSegments.slice(i).join('.')}-ext-file-icon`); // add each combination of all found extensions if more than one\n                    }\n                }\n                classes.push(`ext-file-icon`); // extra segment to increase file-ext score\n            }\n            // Detected Mode\n            const detectedLanguageId = detectLanguageId(modelService, languageService, resource);\n            if (detectedLanguageId) {\n                classes.push(`${cssEscape(detectedLanguageId)}-lang-file-icon`);\n            }\n        }\n    }\n    return classes;\n}\nfunction detectLanguageId(modelService, languageService, resource) {\n    if (!resource) {\n        return null; // we need a resource at least\n    }\n    let languageId = null;\n    // Data URI: check for encoded metadata\n    if (resource.scheme === Schemas.data) {\n        const metadata = DataUri.parseMetaData(resource);\n        const mime = metadata.get(DataUri.META_DATA_MIME);\n        if (mime) {\n            languageId = languageService.getLanguageIdByMimeType(mime);\n        }\n    }\n    // Any other URI: check for model if existing\n    else {\n        const model = modelService.getModel(resource);\n        if (model) {\n            languageId = model.getLanguageId();\n        }\n    }\n    // only take if the language id is specific (aka no just plain text)\n    if (languageId && languageId !== PLAINTEXT_LANGUAGE_ID) {\n        return languageId;\n    }\n    // otherwise fallback to path based detection\n    return languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n}\nexport function cssEscape(str) {\n    return str.replace(/[\\11\\12\\14\\15\\40]/g, '/'); // HTML class names can not contain certain whitespace characters, use / instead, which doesn't exist in file names.\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar _a;\nimport { $, append, hide, show } from '../../../../base/browser/dom.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { Codicon, CSSIcon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { createMatches } from '../../../../base/common/filters.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { getIconClasses } from '../../../common/services/getIconClasses.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport * as nls from '../../../../nls.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IThemeService, ThemeIcon } from '../../../../platform/theme/common/themeService.js';\nimport { canExpandCompletionItem } from './suggestWidgetDetails.js';\nexport function getAriaId(index) {\n    return `suggest-aria-id:${index}`;\n}\nexport const suggestMoreInfoIcon = registerIcon('suggest-more-info', Codicon.chevronRight, nls.localize('suggestMoreInfoIcon', 'Icon for more information in the suggest widget.'));\nconst _completionItemColor = new (_a = class ColorExtractor {\n        extract(item, out) {\n            if (item.textLabel.match(ColorExtractor._regexStrict)) {\n                out[0] = item.textLabel;\n                return true;\n            }\n            if (item.completion.detail && item.completion.detail.match(ColorExtractor._regexStrict)) {\n                out[0] = item.completion.detail;\n                return true;\n            }\n            if (typeof item.completion.documentation === 'string') {\n                const match = ColorExtractor._regexRelaxed.exec(item.completion.documentation);\n                if (match && (match.index === 0 || match.index + match[0].length === item.completion.documentation.length)) {\n                    out[0] = match[0];\n                    return true;\n                }\n            }\n            return false;\n        }\n    },\n    _a._regexRelaxed = /(#([\\da-fA-F]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))/,\n    _a._regexStrict = new RegExp(`^${_a._regexRelaxed.source}$`, 'i'),\n    _a);\nlet ItemRenderer = class ItemRenderer {\n    constructor(_editor, _modelService, _languageService, _themeService) {\n        this._editor = _editor;\n        this._modelService = _modelService;\n        this._languageService = _languageService;\n        this._themeService = _themeService;\n        this._onDidToggleDetails = new Emitter();\n        this.onDidToggleDetails = this._onDidToggleDetails.event;\n        this.templateId = 'suggestion';\n    }\n    dispose() {\n        this._onDidToggleDetails.dispose();\n    }\n    renderTemplate(container) {\n        const data = Object.create(null);\n        data.disposables = new DisposableStore();\n        data.root = container;\n        data.root.classList.add('show-file-icons');\n        data.icon = append(container, $('.icon'));\n        data.colorspan = append(data.icon, $('span.colorspan'));\n        const text = append(container, $('.contents'));\n        const main = append(text, $('.main'));\n        data.iconContainer = append(main, $('.icon-label.codicon'));\n        data.left = append(main, $('span.left'));\n        data.right = append(main, $('span.right'));\n        data.iconLabel = new IconLabel(data.left, { supportHighlights: true, supportIcons: true });\n        data.disposables.add(data.iconLabel);\n        data.parametersLabel = append(data.left, $('span.signature-label'));\n        data.qualifierLabel = append(data.left, $('span.qualifier-label'));\n        data.detailsLabel = append(data.right, $('span.details-label'));\n        data.readMore = append(data.right, $('span.readMore' + ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));\n        data.readMore.title = nls.localize('readMore', \"Read More\");\n        const configureFont = () => {\n            const options = this._editor.getOptions();\n            const fontInfo = options.get(46 /* EditorOption.fontInfo */);\n            const fontFamily = fontInfo.getMassagedFontFamily();\n            const fontFeatureSettings = fontInfo.fontFeatureSettings;\n            const fontSize = options.get(109 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n            const lineHeight = options.get(110 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n            const fontWeight = fontInfo.fontWeight;\n            const letterSpacing = fontInfo.letterSpacing;\n            const fontSizePx = `${fontSize}px`;\n            const lineHeightPx = `${lineHeight}px`;\n            const letterSpacingPx = `${letterSpacing}px`;\n            data.root.style.fontSize = fontSizePx;\n            data.root.style.fontWeight = fontWeight;\n            data.root.style.letterSpacing = letterSpacingPx;\n            main.style.fontFamily = fontFamily;\n            main.style.fontFeatureSettings = fontFeatureSettings;\n            main.style.lineHeight = lineHeightPx;\n            data.icon.style.height = lineHeightPx;\n            data.icon.style.width = lineHeightPx;\n            data.readMore.style.height = lineHeightPx;\n            data.readMore.style.width = lineHeightPx;\n        };\n        configureFont();\n        data.disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */) || e.hasChanged(109 /* EditorOption.suggestFontSize */) || e.hasChanged(110 /* EditorOption.suggestLineHeight */)) {\n                configureFont();\n            }\n        }));\n        return data;\n    }\n    renderElement(element, index, data) {\n        const { completion } = element;\n        data.root.id = getAriaId(index);\n        data.colorspan.style.backgroundColor = '';\n        const labelOptions = {\n            labelEscapeNewLines: true,\n            matches: createMatches(element.score)\n        };\n        const color = [];\n        if (completion.kind === 19 /* CompletionItemKind.Color */ && _completionItemColor.extract(element, color)) {\n            // special logic for 'color' completion items\n            data.icon.className = 'icon customcolor';\n            data.iconContainer.className = 'icon hide';\n            data.colorspan.style.backgroundColor = color[0];\n        }\n        else if (completion.kind === 20 /* CompletionItemKind.File */ && this._themeService.getFileIconTheme().hasFileIcons) {\n            // special logic for 'file' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            const labelClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FILE);\n            const detailClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FILE);\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\n        }\n        else if (completion.kind === 23 /* CompletionItemKind.Folder */ && this._themeService.getFileIconTheme().hasFolderIcons) {\n            // special logic for 'folder' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            labelOptions.extraClasses = [\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FOLDER),\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FOLDER)\n            ].flat();\n        }\n        else {\n            // normal icon\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = '';\n            data.iconContainer.classList.add('suggest-icon', ...CSSIcon.asClassNameArray(CompletionItemKinds.toIcon(completion.kind)));\n        }\n        if (completion.tags && completion.tags.indexOf(1 /* CompletionItemTag.Deprecated */) >= 0) {\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\n            labelOptions.matches = [];\n        }\n        data.iconLabel.setLabel(element.textLabel, undefined, labelOptions);\n        if (typeof completion.label === 'string') {\n            data.parametersLabel.textContent = '';\n            data.detailsLabel.textContent = stripNewLines(completion.detail || '');\n            data.root.classList.add('string-label');\n        }\n        else {\n            data.parametersLabel.textContent = stripNewLines(completion.label.detail || '');\n            data.detailsLabel.textContent = stripNewLines(completion.label.description || '');\n            data.root.classList.remove('string-label');\n        }\n        if (this._editor.getOption(108 /* EditorOption.suggest */).showInlineDetails) {\n            show(data.detailsLabel);\n        }\n        else {\n            hide(data.detailsLabel);\n        }\n        if (canExpandCompletionItem(element)) {\n            data.right.classList.add('can-expand-details');\n            show(data.readMore);\n            data.readMore.onmousedown = e => {\n                e.stopPropagation();\n                e.preventDefault();\n            };\n            data.readMore.onclick = e => {\n                e.stopPropagation();\n                e.preventDefault();\n                this._onDidToggleDetails.fire();\n            };\n        }\n        else {\n            data.right.classList.remove('can-expand-details');\n            hide(data.readMore);\n            data.readMore.onmousedown = null;\n            data.readMore.onclick = null;\n        }\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables.dispose();\n    }\n};\nItemRenderer = __decorate([\n    __param(1, IModelService),\n    __param(2, ILanguageService),\n    __param(3, IThemeService)\n], ItemRenderer);\nexport { ItemRenderer };\nfunction stripNewLines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, '');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { attachListStyler } from '../../../../platform/theme/common/styler.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Context as SuggestContext } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\n/**\n * Suggest widget colors\n */\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hcDark: editorWidgetBackground, hcLight: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hcDark: editorWidgetBorder, hcLight: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hcDark: editorForeground, hcLight: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexport const editorSuggestWidgetSelectedForeground = registerColor('editorSuggestWidget.selectedForeground', { dark: quickInputListFocusForeground, light: quickInputListFocusForeground, hcDark: quickInputListFocusForeground, hcLight: quickInputListFocusForeground }, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedIconForeground = registerColor('editorSuggestWidget.selectedIconForeground', { dark: quickInputListFocusIconForeground, light: quickInputListFocusIconForeground, hcDark: quickInputListFocusIconForeground, hcLight: quickInputListFocusIconForeground }, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hcDark: quickInputListFocusBackground, hcLight: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hcDark: listHighlightForeground, hcLight: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nexport const editorSuggestWidgetHighlightFocusForeground = registerColor('editorSuggestWidget.focusHighlightForeground', { dark: listFocusHighlightForeground, light: listFocusHighlightForeground, hcDark: listFocusHighlightForeground, hcLight: listFocusHighlightForeground }, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nexport const editorSuggestWidgetStatusForeground = registerColor('editorSuggestWidgetStatus.foreground', { dark: transparent(editorSuggestWidgetForeground, .5), light: transparent(editorSuggestWidgetForeground, .5), hcDark: transparent(editorSuggestWidgetForeground, .5), hcLight: transparent(editorSuggestWidgetForeground, .5) }, nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\nclass PersistedWidgetSize {\n    constructor(_service, editor) {\n        this._service = _service;\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n    }\n    restore() {\n        var _a;\n        const raw = (_a = this._service.get(this._key, 0 /* StorageScope.PROFILE */)) !== null && _a !== void 0 ? _a : '';\n        try {\n            const obj = JSON.parse(raw);\n            if (dom.Dimension.is(obj)) {\n                return dom.Dimension.lift(obj);\n            }\n        }\n        catch (_b) {\n            // ignore\n        }\n        return undefined;\n    }\n    store(size) {\n        this._service.store(this._key, JSON.stringify(size), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n    }\n    reset() {\n        this._service.remove(this._key, 0 /* StorageScope.PROFILE */);\n    }\n}\nlet SuggestWidget = class SuggestWidget {\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n        this.editor = editor;\n        this._storageService = _storageService;\n        this._state = 0 /* State.Hidden */;\n        this._isAuto = false;\n        this._ignoreFocusEvents = false;\n        this._forceRenderingAbove = false;\n        this._explainMode = false;\n        this._showTimeout = new TimeoutTimer();\n        this._disposables = new DisposableStore();\n        this._onDidSelect = new Emitter();\n        this._onDidFocus = new Emitter();\n        this._onDidHide = new Emitter();\n        this._onDidShow = new Emitter();\n        this.onDidSelect = this._onDidSelect.event;\n        this.onDidFocus = this._onDidFocus.event;\n        this.onDidHide = this._onDidHide.event;\n        this.onDidShow = this._onDidShow.event;\n        this._onDetailsKeydown = new Emitter();\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\n        this.element = new ResizableHTMLElement();\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n        this._contentWidget = new SuggestContentWidget(this, editor);\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n        class ResizeState {\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n                this.persistedSize = persistedSize;\n                this.currentSize = currentSize;\n                this.persistHeight = persistHeight;\n                this.persistWidth = persistWidth;\n            }\n        }\n        let state;\n        this._disposables.add(this.element.onDidWillResize(() => {\n            this._contentWidget.lockPreference();\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\n        }));\n        this._disposables.add(this.element.onDidResize(e => {\n            var _a, _b, _c, _d;\n            this._resize(e.dimension.width, e.dimension.height);\n            if (state) {\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n            }\n            if (!e.done) {\n                return;\n            }\n            if (state) {\n                // only store width or height value that have changed and also\n                // only store changes that are above a certain threshold\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\n                const threshold = Math.round(itemHeight / 2);\n                let { width, height } = this.element.size;\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n                }\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n                }\n                this._persistedSize.store(new dom.Dimension(width, height));\n            }\n            // reset working state\n            this._contentWidget.unlockPreference();\n            state = undefined;\n        }));\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n        const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\n        details.onDidClose(this.toggleDetails, this, this._disposables);\n        this._details = new SuggestDetailsOverlay(details, this.editor);\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(108 /* EditorOption.suggest */).showIcons);\n        applyIconStyle();\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n        this._disposables.add(renderer);\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n        this._list = new List('SuggestWidget', this._listElement, {\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\n            getTemplateId: (_element) => 'suggestion'\n        }, [renderer], {\n            alwaysConsumeMouseWheel: true,\n            useShadows: false,\n            mouseSupport: false,\n            multipleSelectionSupport: false,\n            accessibilityProvider: {\n                getRole: () => 'option',\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n                getWidgetRole: () => 'listbox',\n                getAriaLabel: (item) => {\n                    let label = item.textLabel;\n                    if (typeof item.completion.label !== 'string') {\n                        const { detail, description } = item.completion.label;\n                        if (detail && description) {\n                            label = nls.localize('label.full', '{0}{1}, {2}', label, detail, description);\n                        }\n                        else if (detail) {\n                            label = nls.localize('label.detail', '{0}{1}', label, detail);\n                        }\n                        else if (description) {\n                            label = nls.localize('label.desc', '{0}, {1}', label, description);\n                        }\n                    }\n                    if (!item.isResolved || !this._isDetailsVisible()) {\n                        return label;\n                    }\n                    const { documentation, detail } = item.completion;\n                    const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n                    return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n                },\n            }\n        });\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(108 /* EditorOption.suggest */).showStatusBar);\n        applyStatusBarStyle();\n        this._disposables.add(attachListStyler(this._list, _themeService, {\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n            listInactiveFocusOutline: activeContrastBorder\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n        this._onThemeChange(_themeService.getColorTheme());\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(108 /* EditorOption.suggest */)) {\n                applyStatusBarStyle();\n                applyIconStyle();\n            }\n        }));\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetHasFocusedSuggestion = SuggestContext.HasFocusedSuggestion.bindTo(_contextKeyService);\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n            this._onDetailsKeydown.fire(e);\n        }));\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n    }\n    dispose() {\n        var _a;\n        this._details.widget.dispose();\n        this._details.dispose();\n        this._list.dispose();\n        this._status.dispose();\n        this._disposables.dispose();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._showTimeout.dispose();\n        this._contentWidget.dispose();\n        this.element.dispose();\n    }\n    _onEditorMouseDown(mouseEvent) {\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n            // Clicking inside details\n            this._details.widget.domNode.focus();\n        }\n        else {\n            // Clicking outside details and inside suggest\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\n                this.editor.focus();\n            }\n        }\n    }\n    _onCursorSelectionChanged() {\n        if (this._state !== 0 /* State.Hidden */) {\n            this._contentWidget.layout();\n        }\n    }\n    _onListMouseDownOrTap(e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this._select(e.element, e.index);\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            this._select(e.elements[0], e.indexes[0]);\n        }\n    }\n    _select(item, index) {\n        const completionModel = this._completionModel;\n        if (completionModel) {\n            this._onDidSelect.fire({ item, index, model: completionModel });\n            this.editor.focus();\n        }\n    }\n    _onThemeChange(theme) {\n        this._details.widget.borderWidth = isHighContrast(theme.type) ? 2 : 1;\n    }\n    _onListFocus(e) {\n        var _a;\n        if (this._ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this._currentSuggestionDetails) {\n                this._currentSuggestionDetails.cancel();\n                this._currentSuggestionDetails = undefined;\n                this._focusedItem = undefined;\n            }\n            this.editor.setAriaOptions({ activeDescendant: undefined });\n            this._ctxSuggestWidgetHasFocusedSuggestion.set(false);\n            return;\n        }\n        if (!this._completionModel) {\n            return;\n        }\n        this._ctxSuggestWidgetHasFocusedSuggestion.set(true);\n        const item = e.elements[0];\n        const index = e.indexes[0];\n        if (item !== this._focusedItem) {\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._currentSuggestionDetails = undefined;\n            this._focusedItem = item;\n            this._list.reveal(index);\n            this._currentSuggestionDetails = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                const loading = disposableTimeout(() => {\n                    if (this._isDetailsVisible()) {\n                        this.showDetails(true);\n                    }\n                }, 250);\n                const sub = token.onCancellationRequested(() => loading.dispose());\n                const result = yield item.resolve(token);\n                loading.dispose();\n                sub.dispose();\n                return result;\n            }));\n            this._currentSuggestionDetails.then(() => {\n                if (index >= this._list.length || item !== this._list.element(index)) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                this._ignoreFocusEvents = true;\n                this._list.splice(index, 1, [item]);\n                this._list.setFocus([index]);\n                this._ignoreFocusEvents = false;\n                if (this._isDetailsVisible()) {\n                    this.showDetails(false);\n                }\n                else {\n                    this.element.domNode.classList.remove('docs-side');\n                }\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n            }).catch(onUnexpectedError);\n        }\n        // emit an event\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\n    }\n    _setState(state) {\n        if (this._state === state) {\n            return;\n        }\n        this._state = state;\n        this.element.domNode.classList.toggle('frozen', state === 4 /* State.Frozen */);\n        this.element.domNode.classList.remove('message');\n        switch (state) {\n            case 0 /* State.Hidden */:\n                dom.hide(this._messageElement, this._listElement, this._status.element);\n                this._details.hide(true);\n                this._status.hide();\n                this._contentWidget.hide();\n                this._ctxSuggestWidgetVisible.reset();\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\n                this._ctxSuggestWidgetHasFocusedSuggestion.reset();\n                this._showTimeout.cancel();\n                this.element.domNode.classList.remove('visible');\n                this._list.splice(0, this._list.length);\n                this._focusedItem = undefined;\n                this._cappedHeight = undefined;\n                this._explainMode = false;\n                break;\n            case 1 /* State.Loading */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                break;\n            case 2 /* State.Empty */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                break;\n            case 3 /* State.Open */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 4 /* State.Frozen */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 5 /* State.Details */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._details.show();\n                this._show();\n                break;\n        }\n    }\n    _show() {\n        this._status.show();\n        this._contentWidget.show();\n        this._layout(this._persistedSize.restore());\n        this._ctxSuggestWidgetVisible.set(true);\n        this._showTimeout.cancelAndSet(() => {\n            this.element.domNode.classList.add('visible');\n            this._onDidShow.fire(this);\n        }, 100);\n    }\n    showTriggered(auto, delay) {\n        if (this._state !== 0 /* State.Hidden */) {\n            return;\n        }\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._isAuto = !!auto;\n        if (!this._isAuto) {\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* State.Loading */), delay);\n        }\n    }\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto) {\n        var _a, _b;\n        this._contentWidget.setPosition(this.editor.getPosition());\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._currentSuggestionDetails = undefined;\n        if (this._completionModel !== completionModel) {\n            this._completionModel = completionModel;\n        }\n        if (isFrozen && this._state !== 2 /* State.Empty */ && this._state !== 0 /* State.Hidden */) {\n            this._setState(4 /* State.Frozen */);\n            return;\n        }\n        const visibleCount = this._completionModel.items.length;\n        const isEmpty = visibleCount === 0;\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            this._setState(isAuto ? 0 /* State.Hidden */ : 2 /* State.Empty */);\n            this._completionModel = undefined;\n            return;\n        }\n        this._focusedItem = undefined;\n        this._list.splice(0, this._list.length, this._completionModel.items);\n        this._setState(isFrozen ? 4 /* State.Frozen */ : 3 /* State.Open */);\n        if (selectionIndex >= 0) {\n            this._list.reveal(selectionIndex, 0);\n            this._list.setFocus([selectionIndex]);\n        }\n        this._layout(this.element.size);\n        // Reset focus border\n        this._details.widget.domNode.classList.remove('focused');\n    }\n    selectNextPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageDown();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNextPage();\n                return true;\n        }\n    }\n    selectNext() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNext(1, true);\n                return true;\n        }\n    }\n    selectLast() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollBottom();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusLast();\n                return true;\n        }\n    }\n    selectPreviousPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageUp();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPreviousPage();\n                return true;\n        }\n    }\n    selectPrevious() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPrevious(1, true);\n                return false;\n        }\n    }\n    selectFirst() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollTop();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusFirst();\n                return true;\n        }\n    }\n    getFocusedItem() {\n        if (this._state !== 0 /* State.Hidden */\n            && this._state !== 2 /* State.Empty */\n            && this._state !== 1 /* State.Loading */\n            && this._completionModel) {\n            return {\n                item: this._list.getFocusedElements()[0],\n                index: this._list.getFocus()[0],\n                model: this._completionModel\n            };\n        }\n        return undefined;\n    }\n    toggleDetailsFocus() {\n        if (this._state === 5 /* State.Details */) {\n            this._setState(3 /* State.Open */);\n            this._details.widget.domNode.classList.remove('focused');\n        }\n        else if (this._state === 3 /* State.Open */ && this._isDetailsVisible()) {\n            this._setState(5 /* State.Details */);\n            this._details.widget.domNode.classList.add('focused');\n        }\n    }\n    toggleDetails() {\n        if (this._isDetailsVisible()) {\n            // hide details widget\n            this._ctxSuggestWidgetDetailsVisible.set(false);\n            this._setDetailsVisible(false);\n            this._details.hide();\n            this.element.domNode.classList.remove('shows-details');\n        }\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* State.Open */ || this._state === 5 /* State.Details */ || this._state === 4 /* State.Frozen */)) {\n            // show details widget (iff possible)\n            this._ctxSuggestWidgetDetailsVisible.set(true);\n            this._setDetailsVisible(true);\n            this.showDetails(false);\n        }\n    }\n    showDetails(loading) {\n        this._details.show();\n        if (loading) {\n            this._details.widget.renderLoading();\n        }\n        else {\n            this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n        }\n        this._positionDetails();\n        this.editor.focus();\n        this.element.domNode.classList.add('shows-details');\n    }\n    toggleExplainMode() {\n        if (this._list.getFocusedElements()[0]) {\n            this._explainMode = !this._explainMode;\n            if (!this._isDetailsVisible()) {\n                this.toggleDetails();\n            }\n            else {\n                this.showDetails(false);\n            }\n        }\n    }\n    resetPersistedSize() {\n        this._persistedSize.reset();\n    }\n    hideWidget() {\n        var _a;\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._setState(0 /* State.Hidden */);\n        this._onDidHide.fire(this);\n        this.element.clearSashHoverState();\n        // ensure that a reasonable widget height is persisted so that\n        // accidential \"resize-to-single-items\" cases aren't happening\n        const dim = this._persistedSize.restore();\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n        if (dim && dim.height < minPersistedHeight) {\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n        }\n    }\n    isFrozen() {\n        return this._state === 4 /* State.Frozen */;\n    }\n    _afterRender(position) {\n        if (position === null) {\n            if (this._isDetailsVisible()) {\n                this._details.hide(); //todo@jrieken soft-hide\n            }\n            return;\n        }\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // no special positioning when widget isn't showing list\n            return;\n        }\n        if (this._isDetailsVisible()) {\n            this._details.show();\n        }\n        this._positionDetails();\n    }\n    _layout(size) {\n        var _a, _b, _c;\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (!this.editor.getDomNode()) {\n            // happens when running tests\n            return;\n        }\n        const bodyBox = dom.getClientArea(document.body);\n        const info = this.getLayoutInfo();\n        if (!size) {\n            size = info.defaultSize;\n        }\n        let height = size.height;\n        let width = size.width;\n        // status bar\n        this._status.element.style.lineHeight = `${info.itemHeight}px`;\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // showing a message only\n            height = info.itemHeight + info.borderHeight;\n            width = info.defaultSize.width / 2;\n            this.element.enableSashes(false, false, false, false);\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n            this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n        else {\n            // showing items\n            // width math\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n            if (width > maxWidth) {\n                width = maxWidth;\n            }\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n            // height math\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n            const minHeight = info.itemHeight + info.statusBarHeight;\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n            const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n            const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n                // Restore the old (wanted) height when the current\n                // height is capped to fit\n                height = this._cappedHeight.wanted;\n            }\n            if (height < minHeight) {\n                height = minHeight;\n            }\n            if (height > maxHeight) {\n                height = maxHeight;\n            }\n            const forceRenderingAboveRequiredSpace = 150;\n            if (height > maxHeightBelow || (this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace)) {\n                this._contentWidget.setPreference(1 /* ContentWidgetPositionPreference.ABOVE */);\n                this.element.enableSashes(true, true, false, false);\n                maxHeight = maxHeightAbove;\n            }\n            else {\n                this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n                this.element.enableSashes(false, true, true, false);\n                maxHeight = maxHeightBelow;\n            }\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n            this.element.minSize = new dom.Dimension(220, minHeight);\n            // Know when the height was capped to fit and remember\n            // the wanted height for later. This is required when going\n            // left to widen suggestions.\n            this._cappedHeight = height === fullHeight\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\n                : undefined;\n        }\n        this._resize(width, height);\n    }\n    _resize(width, height) {\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\n        width = Math.min(maxWidth, width);\n        height = Math.min(maxHeight, height);\n        const { statusBarHeight } = this.getLayoutInfo();\n        this._list.layout(height - statusBarHeight, width);\n        this._listElement.style.height = `${height - statusBarHeight}px`;\n        this.element.layout(height, width);\n        this._contentWidget.layout();\n        this._positionDetails();\n    }\n    _positionDetails() {\n        var _a;\n        if (this._isDetailsVisible()) {\n            this._details.placeAtAnchor(this.element.domNode, ((_a = this._contentWidget.getPosition()) === null || _a === void 0 ? void 0 : _a.preference[0]) === 2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n    }\n    getLayoutInfo() {\n        const fontInfo = this.editor.getOption(46 /* EditorOption.fontInfo */);\n        const itemHeight = clamp(this.editor.getOption(110 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n        const statusBarHeight = !this.editor.getOption(108 /* EditorOption.suggest */).showStatusBar || this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */ ? 0 : itemHeight;\n        const borderWidth = this._details.widget.borderWidth;\n        const borderHeight = 2 * borderWidth;\n        return {\n            itemHeight,\n            statusBarHeight,\n            borderWidth,\n            borderHeight,\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n            verticalPadding: 22,\n            horizontalPadding: 14,\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n        };\n    }\n    _isDetailsVisible() {\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* StorageScope.PROFILE */, false);\n    }\n    _setDetailsVisible(value) {\n        this._storageService.store('expandSuggestionDocs', value, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n    }\n    forceRenderingAbove() {\n        if (!this._forceRenderingAbove) {\n            this._forceRenderingAbove = true;\n            this._layout(this._persistedSize.restore());\n        }\n    }\n    stopForceRenderingAbove() {\n        this._forceRenderingAbove = false;\n    }\n};\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = __decorate([\n    __param(1, IStorageService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IInstantiationService)\n], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n    constructor(_widget, _editor) {\n        this._widget = _widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._preferenceLocked = false;\n        this._added = false;\n        this._hidden = false;\n    }\n    dispose() {\n        if (this._added) {\n            this._added = false;\n            this._editor.removeContentWidget(this);\n        }\n    }\n    getId() {\n        return 'editor.widget.suggestWidget';\n    }\n    getDomNode() {\n        return this._widget.element.domNode;\n    }\n    show() {\n        this._hidden = false;\n        if (!this._added) {\n            this._added = true;\n            this._editor.addContentWidget(this);\n        }\n    }\n    hide() {\n        if (!this._hidden) {\n            this._hidden = true;\n            this.layout();\n        }\n    }\n    layout() {\n        this._editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this._hidden || !this._position || !this._preference) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [this._preference]\n        };\n    }\n    beforeRender() {\n        const { height, width } = this._widget.element.size;\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n    }\n    afterRender(position) {\n        this._widget._afterRender(position);\n    }\n    setPreference(preference) {\n        if (!this._preferenceLocked) {\n            this._preference = preference;\n        }\n    }\n    lockPreference() {\n        this._preferenceLocked = true;\n    }\n    unlockPreference() {\n        this._preferenceLocked = false;\n    }\n    setPosition(position) {\n        this._position = position;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IdleValue } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { SimpleKeybinding } from '../../../../base/common/keybindings.js';\nimport { DisposableStore, dispose, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isObject } from '../../../../base/common/types.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordContextKey } from './wordContextKey.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { SuggestAlternatives } from './suggestAlternatives.js';\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { OvertypingCapturer } from './suggestOvertypingCapturer.js';\nimport { SuggestWidget } from './suggestWidget.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { basename, extname } from '../../../../base/common/resources.js';\nimport { hash } from '../../../../base/common/hash.js';\n// sticky suggest widget which doesn't disappear on focus out and such\nconst _sticky = false;\n// _sticky = Boolean(\"true\"); // done \"weirdly\" so that a lint warning prevents you from pushing this\nclass LineSuffix {\n    constructor(_model, _position) {\n        this._model = _model;\n        this._position = _position;\n        // spy on what's happening right of the cursor. two cases:\n        // 1. end of line -> check that it's still end of line\n        // 2. mid of line -> add a marker and compute the delta\n        const maxColumn = _model.getLineMaxColumn(_position.lineNumber);\n        if (maxColumn !== _position.column) {\n            const offset = _model.getOffsetAt(_position);\n            const end = _model.getPositionAt(offset + 1);\n            this._marker = _model.deltaDecorations([], [{\n                    range: Range.fromPositions(_position, end),\n                    options: { description: 'suggest-line-suffix', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */ }\n                }]);\n        }\n    }\n    dispose() {\n        if (this._marker && !this._model.isDisposed()) {\n            this._model.deltaDecorations(this._marker, []);\n        }\n    }\n    delta(position) {\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\n            // bail out early if things seems fishy\n            return 0;\n        }\n        // read the marker (in case suggest was triggered at line end) or compare\n        // the cursor to the line end.\n        if (this._marker) {\n            const range = this._model.getDecorationRange(this._marker[0]);\n            const end = this._model.getOffsetAt(range.getStartPosition());\n            return end - this._model.getOffsetAt(position);\n        }\n        else {\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\n        }\n    }\n}\nlet SuggestController = class SuggestController {\n    constructor(editor, _memoryService, _commandService, _contextKeyService, _instantiationService, _logService, _telemetryService) {\n        this._memoryService = _memoryService;\n        this._commandService = _commandService;\n        this._contextKeyService = _contextKeyService;\n        this._instantiationService = _instantiationService;\n        this._logService = _logService;\n        this._telemetryService = _telemetryService;\n        this._lineSuffix = new MutableDisposable();\n        this._toDispose = new DisposableStore();\n        this._selectors = new PriorityRegistry(s => s.priority);\n        this._telemetryGate = 0;\n        this.editor = editor;\n        this.model = _instantiationService.createInstance(SuggestModel, this.editor);\n        // context key: update insert/replace mode\n        const ctxInsertMode = SuggestContext.InsertMode.bindTo(_contextKeyService);\n        ctxInsertMode.set(editor.getOption(108 /* EditorOption.suggest */).insertMode);\n        this.model.onDidTrigger(() => ctxInsertMode.set(editor.getOption(108 /* EditorOption.suggest */).insertMode));\n        this.widget = this._toDispose.add(new IdleValue(() => {\n            const widget = this._instantiationService.createInstance(SuggestWidget, this.editor);\n            this._toDispose.add(widget);\n            this._toDispose.add(widget.onDidSelect(item => this._insertSuggestion(item, 0), this));\n            // Wire up logic to accept a suggestion on certain characters\n            const commitCharacterController = new CommitCharacterController(this.editor, widget, item => this._insertSuggestion(item, 2 /* InsertFlags.NoAfterUndoStop */));\n            this._toDispose.add(commitCharacterController);\n            this._toDispose.add(this.model.onDidSuggest(e => {\n                if (e.completionModel.items.length === 0) {\n                    commitCharacterController.reset();\n                }\n            }));\n            // Wire up makes text edit context key\n            const ctxMakesTextEdit = SuggestContext.MakesTextEdit.bindTo(this._contextKeyService);\n            const ctxHasInsertAndReplace = SuggestContext.HasInsertAndReplaceRange.bindTo(this._contextKeyService);\n            const ctxCanResolve = SuggestContext.CanResolve.bindTo(this._contextKeyService);\n            this._toDispose.add(toDisposable(() => {\n                ctxMakesTextEdit.reset();\n                ctxHasInsertAndReplace.reset();\n                ctxCanResolve.reset();\n            }));\n            this._toDispose.add(widget.onDidFocus(({ item }) => {\n                // (ctx: makesTextEdit)\n                const position = this.editor.getPosition();\n                const startColumn = item.editStart.column;\n                const endColumn = position.column;\n                let value = true;\n                if (this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */) === 'smart'\n                    && this.model.state === 2 /* State.Auto */\n                    && !item.completion.additionalTextEdits\n                    && !(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                    && endColumn - startColumn === item.completion.insertText.length) {\n                    const oldText = this.editor.getModel().getValueInRange({\n                        startLineNumber: position.lineNumber,\n                        startColumn,\n                        endLineNumber: position.lineNumber,\n                        endColumn\n                    });\n                    value = oldText !== item.completion.insertText;\n                }\n                ctxMakesTextEdit.set(value);\n                // (ctx: hasInsertAndReplaceRange)\n                ctxHasInsertAndReplace.set(!Position.equals(item.editInsertEnd, item.editReplaceEnd));\n                // (ctx: canResolve)\n                ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem) || Boolean(item.completion.documentation) || item.completion.detail !== item.completion.label);\n            }));\n            this._toDispose.add(widget.onDetailsKeyDown(e => {\n                // cmd + c on macOS, ctrl + c on Win / Linux\n                if (e.toKeybinding().equals(new SimpleKeybinding(true, false, false, false, 33 /* KeyCode.KeyC */)) ||\n                    (platform.isMacintosh && e.toKeybinding().equals(new SimpleKeybinding(false, false, false, true, 33 /* KeyCode.KeyC */)))) {\n                    e.stopPropagation();\n                    return;\n                }\n                if (!e.toKeybinding().isModifierKey()) {\n                    this.editor.focus();\n                }\n            }));\n            return widget;\n        }));\n        // Wire up text overtyping capture\n        this._overtypingCapturer = this._toDispose.add(new IdleValue(() => {\n            return this._toDispose.add(new OvertypingCapturer(this.editor, this.model));\n        }));\n        this._alternatives = this._toDispose.add(new IdleValue(() => {\n            return this._toDispose.add(new SuggestAlternatives(this.editor, this._contextKeyService));\n        }));\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\n        this._toDispose.add(this.model.onDidTrigger(e => {\n            this.widget.value.showTriggered(e.auto, e.shy ? 250 : 50);\n            this._lineSuffix.value = new LineSuffix(this.editor.getModel(), e.position);\n        }));\n        this._toDispose.add(this.model.onDidSuggest(e => {\n            if (e.shy) {\n                return;\n            }\n            let index = -1;\n            if (!e.noSelect) {\n                for (const selector of this._selectors.itemsOrderedByPriorityDesc) {\n                    index = selector.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\n                    if (index !== -1) {\n                        break;\n                    }\n                }\n                if (index === -1) {\n                    index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\n                }\n            }\n            this.widget.value.showSuggestions(e.completionModel, index, e.isFrozen, e.auto);\n        }));\n        this._toDispose.add(this.model.onDidCancel(e => {\n            if (!e.retrigger) {\n                this.widget.value.hideWidget();\n            }\n        }));\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(() => {\n            if (!_sticky) {\n                this.model.cancel();\n                this.model.clear();\n            }\n        }));\n        // Manage the acceptSuggestionsOnEnter context key\n        const acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\n        const updateFromConfig = () => {\n            const acceptSuggestionOnEnter = this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */);\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\n        };\n        this._toDispose.add(this.editor.onDidChangeConfiguration(() => updateFromConfig()));\n        updateFromConfig();\n    }\n    static get(editor) {\n        return editor.getContribution(SuggestController.ID);\n    }\n    dispose() {\n        this._alternatives.dispose();\n        this._toDispose.dispose();\n        this.widget.dispose();\n        this.model.dispose();\n        this._lineSuffix.dispose();\n    }\n    _insertSuggestion(event, flags) {\n        if (!event || !event.item) {\n            this._alternatives.value.reset();\n            this.model.cancel();\n            this.model.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const snippetController = SnippetController2.get(this.editor);\n        if (!snippetController) {\n            return;\n        }\n        const model = this.editor.getModel();\n        const modelVersionNow = model.getAlternativeVersionId();\n        const { item } = event;\n        //\n        const tasks = [];\n        const cts = new CancellationTokenSource();\n        // pushing undo stops *before* additional text edits and\n        // *after* the main edit\n        if (!(flags & 1 /* InsertFlags.NoBeforeUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\n        const info = this.getOverwriteInfo(item, Boolean(flags & 8 /* InsertFlags.AlternativeOverwriteConfig */));\n        // keep item in memory\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\n        if (Array.isArray(item.completion.additionalTextEdits)) {\n            // sync additional edits\n            const scrollState = StableEditorScrollState.capture(this.editor);\n            this.editor.executeEdits('suggestController.additionalTextEdits.sync', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n            scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n        }\n        else if (!item.isResolved) {\n            // async additional edits\n            const sw = new StopWatch(true);\n            let position;\n            const docListener = model.onDidChangeContent(e => {\n                if (e.isFlush) {\n                    cts.cancel();\n                    docListener.dispose();\n                    return;\n                }\n                for (const change of e.changes) {\n                    const thisPosition = Range.getEndPosition(change.range);\n                    if (!position || Position.isBefore(thisPosition, position)) {\n                        position = thisPosition;\n                    }\n                }\n            });\n            const oldFlags = flags;\n            flags |= 2 /* InsertFlags.NoAfterUndoStop */;\n            let didType = false;\n            const typeListener = this.editor.onWillType(() => {\n                typeListener.dispose();\n                didType = true;\n                if (!(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n            });\n            tasks.push(item.resolve(cts.token).then(() => {\n                if (!item.completion.additionalTextEdits || cts.token.isCancellationRequested) {\n                    return false;\n                }\n                if (position && item.completion.additionalTextEdits.some(edit => Position.isBefore(position, Range.getStartPosition(edit.range)))) {\n                    return false;\n                }\n                if (didType) {\n                    this.editor.pushUndoStop();\n                }\n                const scrollState = StableEditorScrollState.capture(this.editor);\n                this.editor.executeEdits('suggestController.additionalTextEdits.async', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n                scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n                if (didType || !(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n                return true;\n            }).then(applied => {\n                this._logService.trace('[suggest] async resolving of edits DONE (ms, applied?)', sw.elapsed(), applied);\n                docListener.dispose();\n                typeListener.dispose();\n            }));\n        }\n        let { insertText } = item.completion;\n        if (!(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)) {\n            insertText = SnippetParser.escape(insertText);\n        }\n        snippetController.insert(insertText, {\n            overwriteBefore: info.overwriteBefore,\n            overwriteAfter: info.overwriteAfter,\n            undoStopBefore: false,\n            undoStopAfter: false,\n            adjustWhitespace: !(item.completion.insertTextRules & 1 /* CompletionItemInsertTextRule.KeepWhitespace */),\n            clipboardText: event.model.clipboardText,\n            overtypingCapturer: this._overtypingCapturer.value\n        });\n        if (!(flags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        if (!item.completion.command) {\n            // done\n            this.model.cancel();\n        }\n        else if (item.completion.command.id === TriggerSuggestAction.id) {\n            // retigger\n            this.model.trigger({ auto: true, shy: false, noSelect: false }, true);\n        }\n        else {\n            // exec command, done\n            tasks.push(this._commandService.executeCommand(item.completion.command.id, ...(item.completion.command.arguments ? [...item.completion.command.arguments] : [])).catch(onUnexpectedError));\n            this.model.cancel();\n        }\n        if (flags & 4 /* InsertFlags.KeepAlternativeSuggestions */) {\n            this._alternatives.value.set(event, next => {\n                // cancel resolving of additional edits\n                cts.cancel();\n                // this is not so pretty. when inserting the 'next'\n                // suggestion we undo until we are at the state at\n                // which we were before inserting the previous suggestion...\n                while (model.canUndo()) {\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\n                        model.undo();\n                    }\n                    this._insertSuggestion(next, 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */ | (flags & 8 /* InsertFlags.AlternativeOverwriteConfig */ ? 8 /* InsertFlags.AlternativeOverwriteConfig */ : 0));\n                    break;\n                }\n            });\n        }\n        this._alertCompletionItem(item);\n        // clear only now - after all tasks are done\n        Promise.all(tasks).finally(() => {\n            this._reportSuggestionAcceptedTelemetry(item, model, event);\n            this.model.clear();\n            cts.dispose();\n        });\n    }\n    _reportSuggestionAcceptedTelemetry(item, model, acceptedSuggestion) {\n        var _a;\n        if (this._telemetryGate++ % 100 !== 0) {\n            return;\n        }\n        // _debugDisplayName looks like `vscode.css-language-features(/-:)`, where the last bit is the trigger chars\n        // normalize it to just the extension ID and lowercase\n        const providerId = item.extensionId ? item.extensionId.value : ((_a = acceptedSuggestion.item.provider._debugDisplayName) !== null && _a !== void 0 ? _a : 'unknown').split('(', 1)[0].toLowerCase();\n        this._telemetryService.publicLog2('suggest.acceptedSuggestion', {\n            providerId,\n            kind: item.completion.kind,\n            basenameHash: hash(basename(model.uri)).toString(16),\n            languageId: model.getLanguageId(),\n            fileExtension: extname(model.uri),\n        });\n    }\n    getOverwriteInfo(item, toggleMode) {\n        assertType(this.editor.hasModel());\n        let replace = this.editor.getOption(108 /* EditorOption.suggest */).insertMode === 'replace';\n        if (toggleMode) {\n            replace = !replace;\n        }\n        const overwriteBefore = item.position.column - item.editStart.column;\n        const overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\n        const columnDelta = this.editor.getPosition().column - item.position.column;\n        const suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\n        return {\n            overwriteBefore: overwriteBefore + columnDelta,\n            overwriteAfter: overwriteAfter + suffixDelta\n        };\n    }\n    _alertCompletionItem(item) {\n        if (isNonEmptyArray(item.completion.additionalTextEdits)) {\n            const msg = nls.localize('aria.alert.snippet', \"Accepting '{0}' made {1} additional edits\", item.textLabel, item.completion.additionalTextEdits.length);\n            alert(msg);\n        }\n    }\n    triggerSuggest(onlyFrom, auto, noFilter, noSelect) {\n        if (this.editor.hasModel()) {\n            this.model.trigger({ auto: auto !== null && auto !== void 0 ? auto : false, shy: false, noSelect: noSelect !== null && noSelect !== void 0 ? noSelect : false }, false, onlyFrom, undefined, noFilter);\n            this.editor.revealPosition(this.editor.getPosition(), 0 /* ScrollType.Smooth */);\n            this.editor.focus();\n        }\n    }\n    triggerSuggestAndAcceptBest(arg) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const positionNow = this.editor.getPosition();\n        const fallback = () => {\n            if (positionNow.equals(this.editor.getPosition())) {\n                this._commandService.executeCommand(arg.fallback);\n            }\n        };\n        const makesTextEdit = (item) => {\n            if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */ || item.completion.additionalTextEdits) {\n                // snippet, other editor -> makes edit\n                return true;\n            }\n            const position = this.editor.getPosition();\n            const startColumn = item.editStart.column;\n            const endColumn = position.column;\n            if (endColumn - startColumn !== item.completion.insertText.length) {\n                // unequal lengths -> makes edit\n                return true;\n            }\n            const textNow = this.editor.getModel().getValueInRange({\n                startLineNumber: position.lineNumber,\n                startColumn,\n                endLineNumber: position.lineNumber,\n                endColumn\n            });\n            // unequal text -> makes edit\n            return textNow !== item.completion.insertText;\n        };\n        Event.once(this.model.onDidTrigger)(_ => {\n            // wait for trigger because only then the cancel-event is trustworthy\n            const listener = [];\n            Event.any(this.model.onDidTrigger, this.model.onDidCancel)(() => {\n                // retrigger or cancel -> try to type default text\n                dispose(listener);\n                fallback();\n            }, undefined, listener);\n            this.model.onDidSuggest(({ completionModel }) => {\n                dispose(listener);\n                if (completionModel.items.length === 0) {\n                    fallback();\n                    return;\n                }\n                const index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), completionModel.items);\n                const item = completionModel.items[index];\n                if (!makesTextEdit(item)) {\n                    fallback();\n                    return;\n                }\n                this.editor.pushUndoStop();\n                this._insertSuggestion({ index, item, model: completionModel }, 4 /* InsertFlags.KeepAlternativeSuggestions */ | 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */);\n            }, undefined, listener);\n        });\n        this.model.trigger({ auto: false, shy: true, noSelect: false });\n        this.editor.revealPosition(positionNow, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    acceptSelectedSuggestion(keepAlternativeSuggestions, alternativeOverwriteConfig) {\n        const item = this.widget.value.getFocusedItem();\n        let flags = 0;\n        if (keepAlternativeSuggestions) {\n            flags |= 4 /* InsertFlags.KeepAlternativeSuggestions */;\n        }\n        if (alternativeOverwriteConfig) {\n            flags |= 8 /* InsertFlags.AlternativeOverwriteConfig */;\n        }\n        this._insertSuggestion(item, flags);\n    }\n    acceptNextSuggestion() {\n        this._alternatives.value.next();\n    }\n    acceptPrevSuggestion() {\n        this._alternatives.value.prev();\n    }\n    cancelSuggestWidget() {\n        this.model.cancel();\n        this.model.clear();\n        this.widget.value.hideWidget();\n    }\n    selectNextSuggestion() {\n        this.widget.value.selectNext();\n    }\n    selectNextPageSuggestion() {\n        this.widget.value.selectNextPage();\n    }\n    selectLastSuggestion() {\n        this.widget.value.selectLast();\n    }\n    selectPrevSuggestion() {\n        this.widget.value.selectPrevious();\n    }\n    selectPrevPageSuggestion() {\n        this.widget.value.selectPreviousPage();\n    }\n    selectFirstSuggestion() {\n        this.widget.value.selectFirst();\n    }\n    toggleSuggestionDetails() {\n        this.widget.value.toggleDetails();\n    }\n    toggleExplainMode() {\n        this.widget.value.toggleExplainMode();\n    }\n    toggleSuggestionFocus() {\n        this.widget.value.toggleDetailsFocus();\n    }\n    resetWidgetSize() {\n        this.widget.value.resetPersistedSize();\n    }\n    forceRenderingAbove() {\n        this.widget.value.forceRenderingAbove();\n    }\n    stopForceRenderingAbove() {\n        if (!this.widget.isInitialized) {\n            // This method has no effect if the widget is not initialized yet.\n            return;\n        }\n        this.widget.value.stopForceRenderingAbove();\n    }\n    registerSelector(selector) {\n        return this._selectors.register(selector);\n    }\n};\nSuggestController.ID = 'editor.contrib.suggestController';\nSuggestController = __decorate([\n    __param(1, ISuggestMemoryService),\n    __param(2, ICommandService),\n    __param(3, IContextKeyService),\n    __param(4, IInstantiationService),\n    __param(5, ILogService),\n    __param(6, ITelemetryService)\n], SuggestController);\nexport { SuggestController };\nclass PriorityRegistry {\n    constructor(prioritySelector) {\n        this.prioritySelector = prioritySelector;\n        this._items = new Array();\n    }\n    register(value) {\n        if (this._items.indexOf(value) !== -1) {\n            throw new Error('Value is already registered');\n        }\n        this._items.push(value);\n        this._items.sort((s1, s2) => this.prioritySelector(s2) - this.prioritySelector(s1));\n        return {\n            dispose: () => {\n                const idx = this._items.indexOf(value);\n                if (idx >= 0) {\n                    this._items.splice(idx, 1);\n                }\n            }\n        };\n    }\n    get itemsOrderedByPriorityDesc() {\n        return this._items;\n    }\n}\nexport class TriggerSuggestAction extends EditorAction {\n    constructor() {\n        super({\n            id: TriggerSuggestAction.id,\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\n            alias: 'Trigger Suggest',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        const controller = SuggestController.get(editor);\n        if (!controller) {\n            return;\n        }\n        let auto;\n        let noSelect;\n        if (args && typeof args === 'object') {\n            if (args.auto === true) {\n                auto = true;\n            }\n            if (args.noSelection === true) {\n                noSelect = true;\n            }\n        }\n        controller.triggerSuggest(undefined, auto, undefined, noSelect);\n    }\n}\nTriggerSuggestAction.id = 'editor.action.triggerSuggest';\nregisterEditorContribution(SuggestController.ID, SuggestController);\nregisterEditorAction(TriggerSuggestAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 90;\nconst SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler(x) {\n        x.acceptSelectedSuggestion(true, false);\n    },\n    kbOpts: [{\n            // normal tab\n            primary: 2 /* KeyCode.Tab */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\n            weight,\n        }, {\n            // accept on enter has special rules\n            primary: 3 /* KeyCode.Enter */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\n            weight,\n        }],\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: SuggestContext.HasInsertAndReplaceRange.toNegated()\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert'))\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.replace', \"Replace\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace'))\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptAlternativeSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.HasFocusedSuggestion),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n        secondary: [1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */],\n    },\n    handler(x) {\n        x.acceptSelectedSuggestion(false, true);\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert')),\n            title: nls.localize('accept.replace', \"Replace\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace')),\n            title: nls.localize('accept.insert', \"Insert\")\n        }]\n}));\n// continue to support the old command\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\nregisterEditorCommand(new SuggestCommand({\n    id: 'hideSuggestWidget',\n    precondition: SuggestContext.Visible,\n    handler: x => x.cancelSuggestWidget(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\n    handler: c => c.selectNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\n    handler: c => c.selectNextPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 12 /* KeyCode.PageDown */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectLastSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\n    handler: c => c.selectLastSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\n    handler: c => c.selectPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\n    handler: c => c.selectPrevPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 11 /* KeyCode.PageUp */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectFirstSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\n    handler: c => c.selectFirstSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionDetails',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleSuggestionDetails(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible, SuggestContext.CanResolve),\n            title: nls.localize('detail.more', \"show less\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible.toNegated(), SuggestContext.CanResolve),\n            title: nls.localize('detail.less', \"show more\")\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleExplainMode',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleExplainMode(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 85 /* KeyCode.Slash */,\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionFocus',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleSuggestionFocus(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */,\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */ }\n    }\n}));\n//#region tab completions\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertBestCompletion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: (x, arg) => {\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? Object.assign({ fallback: 'tab' }, arg) : { fallback: 'tab' });\n    },\n    kbOpts: {\n        weight,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertNextSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertPrevSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.resetSuggestSize',\n            label: nls.localize('suggest.reset.label', \"Reset Suggest Widget Size\"),\n            alias: 'Reset Suggest Widget Size',\n            precondition: undefined\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        (_a = SuggestController.get(editor)) === null || _a === void 0 ? void 0 : _a.resetWidgetSize();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { compareBy, findMaxBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { SnippetSession } from '../../snippet/browser/snippetSession.js';\nimport { SuggestController } from '../../suggest/browser/suggestController.js';\nimport { minimizeInlineCompletion, normalizedInlineCompletionsEquals } from './inlineCompletionToGhostText.js';\nexport class SuggestWidgetInlineCompletionProvider extends Disposable {\n    constructor(editor, suggestControllerPreselector) {\n        super();\n        this.editor = editor;\n        this.suggestControllerPreselector = suggestControllerPreselector;\n        this.isSuggestWidgetVisible = false;\n        this.isShiftKeyPressed = false;\n        this._isActive = false;\n        this._currentSuggestItemInfo = undefined;\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        // This delay fixes a suggest widget issue when typing \".\" immediately restarts the suggestion session.\n        this.setInactiveDelayed = this._register(new RunOnceScheduler(() => {\n            if (!this.isSuggestWidgetVisible) {\n                if (this._isActive) {\n                    this._isActive = false;\n                    this.onDidChangeEmitter.fire();\n                }\n            }\n        }, 100));\n        // See the command acceptAlternativeSelectedSuggestion that is bound to shift+tab\n        this._register(editor.onKeyDown(e => {\n            if (e.shiftKey && !this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = true;\n                this.update(this._isActive);\n            }\n        }));\n        this._register(editor.onKeyUp(e => {\n            if (e.shiftKey && this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = false;\n                this.update(this._isActive);\n            }\n        }));\n        const suggestController = SuggestController.get(this.editor);\n        if (suggestController) {\n            this._register(suggestController.registerSelector({\n                priority: 100,\n                select: (model, pos, suggestItems) => {\n                    const textModel = this.editor.getModel();\n                    const normalizedItemToPreselect = minimizeInlineCompletion(textModel, this.suggestControllerPreselector());\n                    if (!normalizedItemToPreselect) {\n                        return -1;\n                    }\n                    const position = Position.lift(pos);\n                    const candidates = suggestItems\n                        .map((suggestItem, index) => {\n                        const inlineSuggestItem = suggestionToSuggestItemInfo(suggestController, position, suggestItem, this.isShiftKeyPressed);\n                        const normalizedSuggestItem = minimizeInlineCompletion(textModel, inlineSuggestItem === null || inlineSuggestItem === void 0 ? void 0 : inlineSuggestItem.normalizedInlineCompletion);\n                        if (!normalizedSuggestItem) {\n                            return undefined;\n                        }\n                        const valid = rangeStartsWith(normalizedItemToPreselect.range, normalizedSuggestItem.range) &&\n                            normalizedItemToPreselect.insertText.startsWith(normalizedSuggestItem.insertText);\n                        return { index, valid, prefixLength: normalizedSuggestItem.insertText.length, suggestItem };\n                    })\n                        .filter(item => item && item.valid);\n                    const result = findMaxBy(candidates, compareBy(s => s.prefixLength, numberComparator));\n                    return result ? result.index : -1;\n                }\n            }));\n            let isBoundToSuggestWidget = false;\n            const bindToSuggestWidget = () => {\n                if (isBoundToSuggestWidget) {\n                    return;\n                }\n                isBoundToSuggestWidget = true;\n                this._register(suggestController.widget.value.onDidShow(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n                this._register(suggestController.widget.value.onDidHide(() => {\n                    this.isSuggestWidgetVisible = false;\n                    this.setInactiveDelayed.schedule();\n                    this.update(this._isActive);\n                }));\n                this._register(suggestController.widget.value.onDidFocus(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n            };\n            this._register(Event.once(suggestController.model.onDidTrigger)(e => {\n                bindToSuggestWidget();\n            }));\n        }\n        this.update(this._isActive);\n    }\n    /**\n     * Returns undefined if the suggest widget is not active.\n    */\n    get state() {\n        if (!this._isActive) {\n            return undefined;\n        }\n        return { selectedItem: this._currentSuggestItemInfo };\n    }\n    update(newActive) {\n        const newInlineCompletion = this.getSuggestItemInfo();\n        let shouldFire = false;\n        if (!suggestItemInfoEquals(this._currentSuggestItemInfo, newInlineCompletion)) {\n            this._currentSuggestItemInfo = newInlineCompletion;\n            shouldFire = true;\n        }\n        if (this._isActive !== newActive) {\n            this._isActive = newActive;\n            shouldFire = true;\n        }\n        if (shouldFire) {\n            this.onDidChangeEmitter.fire();\n        }\n    }\n    getSuggestItemInfo() {\n        const suggestController = SuggestController.get(this.editor);\n        if (!suggestController) {\n            return undefined;\n        }\n        if (!this.isSuggestWidgetVisible) {\n            return undefined;\n        }\n        const focusedItem = suggestController.widget.value.getFocusedItem();\n        if (!focusedItem) {\n            return undefined;\n        }\n        // TODO: item.isResolved\n        return suggestionToSuggestItemInfo(suggestController, this.editor.getPosition(), focusedItem.item, this.isShiftKeyPressed);\n    }\n    stopForceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        if (suggestController) {\n            suggestController.stopForceRenderingAbove();\n        }\n    }\n    forceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        if (suggestController) {\n            suggestController.forceRenderingAbove();\n        }\n    }\n}\nexport function rangeStartsWith(rangeToTest, prefix) {\n    return (prefix.startLineNumber === rangeToTest.startLineNumber &&\n        prefix.startColumn === rangeToTest.startColumn &&\n        (prefix.endLineNumber < rangeToTest.endLineNumber ||\n            (prefix.endLineNumber === rangeToTest.endLineNumber &&\n                prefix.endColumn <= rangeToTest.endColumn)));\n}\nfunction suggestItemInfoEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    return a.completionItemKind === b.completionItemKind &&\n        a.isSnippetText === b.isSnippetText &&\n        normalizedInlineCompletionsEquals(a.normalizedInlineCompletion, b.normalizedInlineCompletion);\n}\nfunction suggestionToSuggestItemInfo(suggestController, position, item, toggleMode) {\n    // additionalTextEdits might not be resolved here, this could be problematic.\n    if (Array.isArray(item.completion.additionalTextEdits) && item.completion.additionalTextEdits.length > 0) {\n        // cannot represent additional text edits. TODO: Now we can.\n        return {\n            completionItemKind: item.completion.kind,\n            isSnippetText: false,\n            normalizedInlineCompletion: {\n                // Dummy element, so that space is reserved, but no text is shown\n                range: Range.fromPositions(position, position),\n                insertText: '',\n                filterText: '',\n                snippetInfo: undefined,\n                additionalTextEdits: [],\n            },\n        };\n    }\n    let { insertText } = item.completion;\n    let isSnippetText = false;\n    if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */) {\n        const snippet = new SnippetParser().parse(insertText);\n        const model = suggestController.editor.getModel();\n        // Ignore snippets that are too large.\n        // Adjust whitespace is expensive for them.\n        if (snippet.children.length > 100) {\n            return undefined;\n        }\n        SnippetSession.adjustWhitespace(model, position, snippet, true, true);\n        insertText = snippet.toString();\n        isSnippetText = true;\n    }\n    const info = suggestController.getOverwriteInfo(item, toggleMode);\n    return {\n        isSnippetText,\n        completionItemKind: item.completion.kind,\n        normalizedInlineCompletion: {\n            insertText: insertText,\n            filterText: insertText,\n            range: Range.fromPositions(position.delta(0, -info.overwriteBefore), position.delta(0, Math.max(info.overwriteAfter, 0))),\n            snippetInfo: undefined,\n            additionalTextEdits: [],\n        }\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { BaseGhostTextWidgetModel, GhostText } from './ghostText.js';\nimport { provideInlineCompletions, UpdateOperation } from './inlineCompletionsModel.js';\nimport { inlineCompletionToGhostText, minimizeInlineCompletion } from './inlineCompletionToGhostText.js';\nimport { SuggestWidgetInlineCompletionProvider } from './suggestWidgetInlineCompletionProvider.js';\nlet SuggestWidgetPreviewModel = class SuggestWidgetPreviewModel extends BaseGhostTextWidgetModel {\n    constructor(editor, cache, languageFeaturesService) {\n        super(editor);\n        this.cache = cache;\n        this.languageFeaturesService = languageFeaturesService;\n        this.suggestionInlineCompletionSource = this._register(new SuggestWidgetInlineCompletionProvider(this.editor, \n        // Use the first cache item (if any) as preselection.\n        () => { var _a, _b; return (_b = (_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions[0]) === null || _b === void 0 ? void 0 : _b.toLiveInlineCompletion(); }));\n        this.updateOperation = this._register(new MutableDisposable());\n        this.updateCacheSoon = this._register(new RunOnceScheduler(() => this.updateCache(), 50));\n        this.minReservedLineCount = 0;\n        this._register(this.suggestionInlineCompletionSource.onDidChange(() => {\n            if (!this.editor.hasModel()) {\n                // onDidChange might be called when calling setModel on the editor, before we are disposed.\n                return;\n            }\n            this.updateCacheSoon.schedule();\n            const suggestWidgetState = this.suggestionInlineCompletionSource.state;\n            if (!suggestWidgetState) {\n                this.minReservedLineCount = 0;\n            }\n            const newGhostText = this.ghostText;\n            if (newGhostText) {\n                this.minReservedLineCount = Math.max(this.minReservedLineCount, sum(newGhostText.parts.map(p => p.lines.length - 1)));\n            }\n            if (this.minReservedLineCount >= 1) {\n                this.suggestionInlineCompletionSource.forceRenderingAbove();\n            }\n            else {\n                this.suggestionInlineCompletionSource.stopForceRenderingAbove();\n            }\n            this.onDidChangeEmitter.fire();\n        }));\n        this._register(this.cache.onDidChange(() => {\n            this.onDidChangeEmitter.fire();\n        }));\n        this._register(this.editor.onDidChangeCursorPosition((e) => {\n            this.minReservedLineCount = 0;\n            this.updateCacheSoon.schedule();\n            this.onDidChangeEmitter.fire();\n        }));\n        this._register(toDisposable(() => this.suggestionInlineCompletionSource.stopForceRenderingAbove()));\n    }\n    get isActive() {\n        return this.suggestionInlineCompletionSource.state !== undefined;\n    }\n    isSuggestionPreviewEnabled() {\n        const suggestOptions = this.editor.getOption(108 /* EditorOption.suggest */);\n        return suggestOptions.preview;\n    }\n    updateCache() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const state = this.suggestionInlineCompletionSource.state;\n            if (!state || !state.selectedItem) {\n                return;\n            }\n            const info = {\n                text: state.selectedItem.normalizedInlineCompletion.insertText,\n                range: state.selectedItem.normalizedInlineCompletion.range,\n                isSnippetText: state.selectedItem.isSnippetText,\n                completionKind: state.selectedItem.completionItemKind,\n            };\n            const position = this.editor.getPosition();\n            if (state.selectedItem.isSnippetText ||\n                state.selectedItem.completionItemKind === 27 /* CompletionItemKind.Snippet */ ||\n                state.selectedItem.completionItemKind === 20 /* CompletionItemKind.File */ ||\n                state.selectedItem.completionItemKind === 23 /* CompletionItemKind.Folder */) {\n                // Don't ask providers for these types of suggestions.\n                this.cache.clear();\n                return;\n            }\n            const promise = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                let result;\n                try {\n                    result = yield provideInlineCompletions(this.languageFeaturesService.inlineCompletionsProvider, position, this.editor.getModel(), { triggerKind: InlineCompletionTriggerKind.Automatic, selectedSuggestionInfo: info }, token);\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                    return;\n                }\n                if (token.isCancellationRequested) {\n                    result.dispose();\n                    return;\n                }\n                this.cache.setValue(this.editor, result, InlineCompletionTriggerKind.Automatic);\n                this.onDidChangeEmitter.fire();\n            }));\n            const operation = new UpdateOperation(promise, InlineCompletionTriggerKind.Automatic);\n            this.updateOperation.value = operation;\n            yield promise;\n            if (this.updateOperation.value === operation) {\n                this.updateOperation.clear();\n            }\n        });\n    }\n    get ghostText() {\n        var _a, _b, _c;\n        const isSuggestionPreviewEnabled = this.isSuggestionPreviewEnabled();\n        const model = this.editor.getModel();\n        const augmentedCompletion = minimizeInlineCompletion(model, (_b = (_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions[0]) === null || _b === void 0 ? void 0 : _b.toLiveInlineCompletion());\n        const suggestWidgetState = this.suggestionInlineCompletionSource.state;\n        const suggestInlineCompletion = minimizeInlineCompletion(model, (_c = suggestWidgetState === null || suggestWidgetState === void 0 ? void 0 : suggestWidgetState.selectedItem) === null || _c === void 0 ? void 0 : _c.normalizedInlineCompletion);\n        const isAugmentedCompletionValid = augmentedCompletion\n            && suggestInlineCompletion\n            && augmentedCompletion.insertText.startsWith(suggestInlineCompletion.insertText)\n            && augmentedCompletion.range.equalsRange(suggestInlineCompletion.range);\n        if (!isSuggestionPreviewEnabled && !isAugmentedCompletionValid) {\n            return undefined;\n        }\n        // If the augmented completion is not valid and there is no suggest inline completion, we still show the augmented completion.\n        const finalCompletion = isAugmentedCompletionValid ? augmentedCompletion : (suggestInlineCompletion || augmentedCompletion);\n        const inlineCompletionPreviewLength = isAugmentedCompletionValid ? finalCompletion.insertText.length - suggestInlineCompletion.insertText.length : 0;\n        const newGhostText = this.toGhostText(finalCompletion, inlineCompletionPreviewLength);\n        return newGhostText;\n    }\n    toGhostText(completion, inlineCompletionPreviewLength) {\n        const mode = this.editor.getOptions().get(108 /* EditorOption.suggest */).previewMode;\n        return completion\n            ? (inlineCompletionToGhostText(completion, this.editor.getModel(), mode, this.editor.getPosition(), inlineCompletionPreviewLength) ||\n                // Show an invisible ghost text to reserve space\n                new GhostText(completion.range.endLineNumber, [], this.minReservedLineCount))\n            : undefined;\n    }\n};\nSuggestWidgetPreviewModel = __decorate([\n    __param(2, ILanguageFeaturesService)\n], SuggestWidgetPreviewModel);\nexport { SuggestWidgetPreviewModel };\nfunction sum(arr) {\n    return arr.reduce((a, b) => a + b, 0);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { InlineCompletionsModel, SynchronizedInlineCompletionsCache } from './inlineCompletionsModel.js';\nimport { SuggestWidgetPreviewModel } from './suggestWidgetPreviewModel.js';\nimport { createDisposableRef } from './utils.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport class DelegatingModel extends Disposable {\n    constructor() {\n        super(...arguments);\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        this.hasCachedGhostText = false;\n        this.currentModelRef = this._register(new MutableDisposable());\n    }\n    get targetModel() {\n        var _a;\n        return (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object;\n    }\n    setTargetModel(model) {\n        var _a;\n        if (((_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === model) {\n            return;\n        }\n        this.currentModelRef.clear();\n        this.currentModelRef.value = model ? createDisposableRef(model, model.onDidChange(() => {\n            this.hasCachedGhostText = false;\n            this.onDidChangeEmitter.fire();\n        })) : undefined;\n        this.hasCachedGhostText = false;\n        this.onDidChangeEmitter.fire();\n    }\n    get ghostText() {\n        var _a, _b;\n        if (!this.hasCachedGhostText) {\n            this.cachedGhostText = (_b = (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === null || _b === void 0 ? void 0 : _b.ghostText;\n            this.hasCachedGhostText = true;\n        }\n        return this.cachedGhostText;\n    }\n    setExpanded(expanded) {\n        var _a;\n        (_a = this.targetModel) === null || _a === void 0 ? void 0 : _a.setExpanded(expanded);\n    }\n    get minReservedLineCount() {\n        return this.targetModel ? this.targetModel.minReservedLineCount : 0;\n    }\n}\n/**\n * A ghost text model that is both driven by inline completions and the suggest widget.\n*/\nlet GhostTextModel = class GhostTextModel extends DelegatingModel {\n    constructor(editor, instantiationService) {\n        super();\n        this.editor = editor;\n        this.instantiationService = instantiationService;\n        this.sharedCache = this._register(new SharedInlineCompletionCache());\n        this.suggestWidgetAdapterModel = this._register(this.instantiationService.createInstance(SuggestWidgetPreviewModel, this.editor, this.sharedCache));\n        this.inlineCompletionsModel = this._register(this.instantiationService.createInstance(InlineCompletionsModel, this.editor, this.sharedCache));\n        this._register(this.suggestWidgetAdapterModel.onDidChange(() => {\n            this.updateModel();\n        }));\n        this.updateModel();\n    }\n    get activeInlineCompletionsModel() {\n        if (this.targetModel === this.inlineCompletionsModel) {\n            return this.inlineCompletionsModel;\n        }\n        return undefined;\n    }\n    updateModel() {\n        this.setTargetModel(this.suggestWidgetAdapterModel.isActive\n            ? this.suggestWidgetAdapterModel\n            : this.inlineCompletionsModel);\n        this.inlineCompletionsModel.setActive(this.targetModel === this.inlineCompletionsModel);\n    }\n    shouldShowHoverAt(hoverRange) {\n        var _a;\n        const ghostText = (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.ghostText;\n        if (ghostText) {\n            return ghostText.parts.some(p => hoverRange.containsPosition(new Position(ghostText.lineNumber, p.column)));\n        }\n        return false;\n    }\n    triggerInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.trigger(InlineCompletionTriggerKind.Explicit);\n    }\n    commitInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.commitCurrentSuggestion();\n    }\n    hideInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hide();\n    }\n    showNextInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showNext();\n    }\n    showPreviousInlineCompletion() {\n        var _a;\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showPrevious();\n    }\n    hasMultipleInlineCompletions() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield ((_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\n            return result !== undefined ? result : false;\n        });\n    }\n};\nGhostTextModel = __decorate([\n    __param(1, IInstantiationService)\n], GhostTextModel);\nexport { GhostTextModel };\nexport class SharedInlineCompletionCache extends Disposable {\n    constructor() {\n        super(...arguments);\n        this.onDidChangeEmitter = new Emitter();\n        this.onDidChange = this.onDidChangeEmitter.event;\n        this.cache = this._register(new MutableDisposable());\n    }\n    get value() {\n        return this.cache.value;\n    }\n    setValue(editor, completionsSource, triggerKind) {\n        this.cache.value = new SynchronizedInlineCompletionsCache(completionsSource, editor, () => this.onDidChangeEmitter.fire(), triggerKind);\n    }\n    clearAndLeak() {\n        return this.cache.clearAndLeak();\n    }\n    clear() {\n        this.cache.clear();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar _a;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './ghostText.css';\nimport { applyFontInfo } from '../../../browser/config/domFontInfo.js';\nimport { EditorFontLigatures } from '../../../common/config/editorOptions.js';\nimport { LineTokens } from '../../../common/tokens/lineTokens.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { createStringBuilder } from '../../../common/core/stringBuilder.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ghostTextBackground, ghostTextBorder, ghostTextForeground } from '../../../common/core/editorColorRegistry.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { GhostTextReplacement } from './ghostText.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nconst ttPolicy = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('editorGhostText', { createHTML: value => value });\nlet GhostTextWidget = class GhostTextWidget extends Disposable {\n    constructor(editor, model, instantiationService, languageService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.instantiationService = instantiationService;\n        this.languageService = languageService;\n        this.disposed = false;\n        this.partsWidget = this._register(this.instantiationService.createInstance(DecorationsWidget, this.editor));\n        this.additionalLinesWidget = this._register(new AdditionalLinesWidget(this.editor, this.languageService.languageIdCodec));\n        this.viewMoreContentWidget = undefined;\n        this.replacementDecoration = this._register(new DisposableDecorations(this.editor));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(29 /* EditorOption.disableMonospaceOptimizations */)\n                || e.hasChanged(107 /* EditorOption.stopRenderingLineAfter */)\n                || e.hasChanged(90 /* EditorOption.renderWhitespace */)\n                || e.hasChanged(85 /* EditorOption.renderControlCharacters */)\n                || e.hasChanged(47 /* EditorOption.fontLigatures */)\n                || e.hasChanged(46 /* EditorOption.fontInfo */)\n                || e.hasChanged(61 /* EditorOption.lineHeight */)) {\n                this.update();\n            }\n        }));\n        this._register(toDisposable(() => {\n            var _a;\n            this.disposed = true;\n            this.update();\n            (_a = this.viewMoreContentWidget) === null || _a === void 0 ? void 0 : _a.dispose();\n            this.viewMoreContentWidget = undefined;\n        }));\n        this._register(model.onDidChange(() => {\n            this.update();\n        }));\n        this.update();\n    }\n    shouldShowHoverAtViewZone(viewZoneId) {\n        return (this.additionalLinesWidget.viewZoneId === viewZoneId);\n    }\n    update() {\n        var _a;\n        const ghostText = this.model.ghostText;\n        if (!this.editor.hasModel() || !ghostText || this.disposed) {\n            this.partsWidget.clear();\n            this.additionalLinesWidget.clear();\n            this.replacementDecoration.clear();\n            return;\n        }\n        const inlineTexts = new Array();\n        const additionalLines = new Array();\n        function addToAdditionalLines(lines, className) {\n            if (additionalLines.length > 0) {\n                const lastLine = additionalLines[additionalLines.length - 1];\n                if (className) {\n                    lastLine.decorations.push(new LineDecoration(lastLine.content.length + 1, lastLine.content.length + 1 + lines[0].length, className, 0 /* InlineDecorationType.Regular */));\n                }\n                lastLine.content += lines[0];\n                lines = lines.slice(1);\n            }\n            for (const line of lines) {\n                additionalLines.push({\n                    content: line,\n                    decorations: className ? [new LineDecoration(1, line.length + 1, className, 0 /* InlineDecorationType.Regular */)] : []\n                });\n            }\n        }\n        if (ghostText instanceof GhostTextReplacement) {\n            this.replacementDecoration.setDecorations([\n                {\n                    range: new Range(ghostText.lineNumber, ghostText.columnStart, ghostText.lineNumber, ghostText.columnStart + ghostText.length),\n                    options: {\n                        inlineClassName: 'inline-completion-text-to-replace',\n                        description: 'GhostTextReplacement'\n                    }\n                },\n            ]);\n        }\n        else {\n            this.replacementDecoration.setDecorations([]);\n        }\n        const textBufferLine = this.editor.getModel().getLineContent(ghostText.lineNumber);\n        let hiddenTextStartColumn = undefined;\n        let lastIdx = 0;\n        for (const part of ghostText.parts) {\n            let lines = part.lines;\n            if (hiddenTextStartColumn === undefined) {\n                inlineTexts.push({\n                    column: part.column,\n                    text: lines[0],\n                    preview: part.preview,\n                });\n                lines = lines.slice(1);\n            }\n            else {\n                addToAdditionalLines([textBufferLine.substring(lastIdx, part.column - 1)], undefined);\n            }\n            if (lines.length > 0) {\n                addToAdditionalLines(lines, 'ghost-text');\n                if (hiddenTextStartColumn === undefined && part.column <= textBufferLine.length) {\n                    hiddenTextStartColumn = part.column;\n                }\n            }\n            lastIdx = part.column - 1;\n        }\n        if (hiddenTextStartColumn !== undefined) {\n            addToAdditionalLines([textBufferLine.substring(lastIdx)], undefined);\n        }\n        this.partsWidget.setParts(ghostText.lineNumber, inlineTexts, hiddenTextStartColumn !== undefined ? { column: hiddenTextStartColumn, length: textBufferLine.length + 1 - hiddenTextStartColumn } : undefined);\n        this.additionalLinesWidget.updateLines(ghostText.lineNumber, additionalLines, ghostText.additionalReservedLineCount);\n        if (0 < 0) {\n            // Not supported at the moment, condition is always false.\n            this.viewMoreContentWidget = this.renderViewMoreLines(new Position(ghostText.lineNumber, this.editor.getModel().getLineMaxColumn(ghostText.lineNumber)), '', 0);\n        }\n        else {\n            (_a = this.viewMoreContentWidget) === null || _a === void 0 ? void 0 : _a.dispose();\n            this.viewMoreContentWidget = undefined;\n        }\n    }\n    renderViewMoreLines(position, firstLineText, remainingLinesLength) {\n        const fontInfo = this.editor.getOption(46 /* EditorOption.fontInfo */);\n        const domNode = document.createElement('div');\n        domNode.className = 'suggest-preview-additional-widget';\n        applyFontInfo(domNode, fontInfo);\n        const spacer = document.createElement('span');\n        spacer.className = 'content-spacer';\n        spacer.append(firstLineText);\n        domNode.append(spacer);\n        const newline = document.createElement('span');\n        newline.className = 'content-newline suggest-preview-text';\n        newline.append('  ');\n        domNode.append(newline);\n        const disposableStore = new DisposableStore();\n        const button = document.createElement('div');\n        button.className = 'button suggest-preview-text';\n        button.append(`+${remainingLinesLength} lines`);\n        disposableStore.add(dom.addStandardDisposableListener(button, 'mousedown', (e) => {\n            var _a;\n            (_a = this.model) === null || _a === void 0 ? void 0 : _a.setExpanded(true);\n            e.preventDefault();\n            this.editor.focus();\n        }));\n        domNode.append(button);\n        return new ViewMoreLinesContentWidget(this.editor, position, domNode, disposableStore);\n    }\n};\nGhostTextWidget = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, ILanguageService)\n], GhostTextWidget);\nexport { GhostTextWidget };\nclass DisposableDecorations {\n    constructor(editor) {\n        this.editor = editor;\n        this.decorationIds = [];\n    }\n    setDecorations(decorations) {\n        // Using change decorations ensures that we update the id's before some event handler is called.\n        this.editor.changeDecorations(accessor => {\n            this.decorationIds = accessor.deltaDecorations(this.decorationIds, decorations);\n        });\n    }\n    clear() {\n        this.setDecorations([]);\n    }\n    dispose() {\n        this.clear();\n    }\n}\nclass DecorationsWidget {\n    constructor(editor) {\n        this.editor = editor;\n        this.decorationIds = [];\n    }\n    dispose() {\n        this.clear();\n    }\n    clear() {\n        // Using change decorations ensures that we update the id's before some event handler is called.\n        this.editor.changeDecorations(accessor => {\n            this.decorationIds = accessor.deltaDecorations(this.decorationIds, []);\n        });\n    }\n    setParts(lineNumber, parts, hiddenText) {\n        const textModel = this.editor.getModel();\n        if (!textModel) {\n            return;\n        }\n        const hiddenTextDecorations = new Array();\n        if (hiddenText) {\n            hiddenTextDecorations.push({\n                range: Range.fromPositions(new Position(lineNumber, hiddenText.column), new Position(lineNumber, hiddenText.column + hiddenText.length)),\n                options: {\n                    inlineClassName: 'ghost-text-hidden',\n                    description: 'ghost-text-hidden',\n                }\n            });\n        }\n        // Using change decorations ensures that we update the id's before some event handler is called.\n        this.editor.changeDecorations(accessor => {\n            this.decorationIds = accessor.deltaDecorations(this.decorationIds, parts.map(p => {\n                return ({\n                    range: Range.fromPositions(new Position(lineNumber, p.column)),\n                    options: {\n                        description: 'ghost-text',\n                        after: { content: p.text, inlineClassName: p.preview ? 'ghost-text-decoration-preview' : 'ghost-text-decoration', cursorStops: InjectedTextCursorStops.Left },\n                        showIfCollapsed: true,\n                    }\n                });\n            }).concat(hiddenTextDecorations));\n        });\n    }\n}\nclass AdditionalLinesWidget {\n    constructor(editor, languageIdCodec) {\n        this.editor = editor;\n        this.languageIdCodec = languageIdCodec;\n        this._viewZoneId = undefined;\n    }\n    get viewZoneId() { return this._viewZoneId; }\n    dispose() {\n        this.clear();\n    }\n    clear() {\n        this.editor.changeViewZones((changeAccessor) => {\n            if (this._viewZoneId) {\n                changeAccessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n            }\n        });\n    }\n    updateLines(lineNumber, additionalLines, minReservedLineCount) {\n        const textModel = this.editor.getModel();\n        if (!textModel) {\n            return;\n        }\n        const { tabSize } = textModel.getOptions();\n        this.editor.changeViewZones((changeAccessor) => {\n            if (this._viewZoneId) {\n                changeAccessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n            }\n            const heightInLines = Math.max(additionalLines.length, minReservedLineCount);\n            if (heightInLines > 0) {\n                const domNode = document.createElement('div');\n                renderLines(domNode, tabSize, additionalLines, this.editor.getOptions(), this.languageIdCodec);\n                this._viewZoneId = changeAccessor.addZone({\n                    afterLineNumber: lineNumber,\n                    heightInLines: heightInLines,\n                    domNode,\n                    afterColumnAffinity: 1 /* PositionAffinity.Right */\n                });\n            }\n        });\n    }\n}\nfunction renderLines(domNode, tabSize, lines, opts, languageIdCodec) {\n    const disableMonospaceOptimizations = opts.get(29 /* EditorOption.disableMonospaceOptimizations */);\n    const stopRenderingLineAfter = opts.get(107 /* EditorOption.stopRenderingLineAfter */);\n    // To avoid visual confusion, we don't want to render visible whitespace\n    const renderWhitespace = 'none';\n    const renderControlCharacters = opts.get(85 /* EditorOption.renderControlCharacters */);\n    const fontLigatures = opts.get(47 /* EditorOption.fontLigatures */);\n    const fontInfo = opts.get(46 /* EditorOption.fontInfo */);\n    const lineHeight = opts.get(61 /* EditorOption.lineHeight */);\n    const sb = createStringBuilder(10000);\n    sb.appendASCIIString('<div class=\"suggest-preview-text\">');\n    for (let i = 0, len = lines.length; i < len; i++) {\n        const lineData = lines[i];\n        const line = lineData.content;\n        sb.appendASCIIString('<div class=\"view-line');\n        sb.appendASCIIString('\" style=\"top:');\n        sb.appendASCIIString(String(i * lineHeight));\n        sb.appendASCIIString('px;width:1000000px;\">');\n        const isBasicASCII = strings.isBasicASCII(line);\n        const containsRTL = strings.containsRTL(line);\n        const lineTokens = LineTokens.createEmpty(line, languageIdCodec);\n        renderViewLine(new RenderLineInput((fontInfo.isMonospace && !disableMonospaceOptimizations), fontInfo.canUseHalfwidthRightwardsArrow, line, false, isBasicASCII, containsRTL, 0, lineTokens, lineData.decorations, tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, fontInfo.wsmiddotWidth, stopRenderingLineAfter, renderWhitespace, renderControlCharacters, fontLigatures !== EditorFontLigatures.OFF, null), sb);\n        sb.appendASCIIString('</div>');\n    }\n    sb.appendASCIIString('</div>');\n    applyFontInfo(domNode, fontInfo);\n    const html = sb.build();\n    const trustedhtml = ttPolicy ? ttPolicy.createHTML(html) : html;\n    domNode.innerHTML = trustedhtml;\n}\nclass ViewMoreLinesContentWidget extends Disposable {\n    constructor(editor, position, domNode, disposableStore) {\n        super();\n        this.editor = editor;\n        this.position = position;\n        this.domNode = domNode;\n        this.allowEditorOverflow = false;\n        this.suppressMouseDown = false;\n        this._register(disposableStore);\n        this._register(toDisposable(() => {\n            this.editor.removeContentWidget(this);\n        }));\n        this.editor.addContentWidget(this);\n    }\n    getId() {\n        return 'editor.widget.viewMoreLinesWidget';\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    getPosition() {\n        return {\n            position: this.position,\n            preference: [0 /* ContentWidgetPositionPreference.EXACT */]\n        };\n    }\n}\nregisterThemingParticipant((theme, collector) => {\n    const foreground = theme.getColor(ghostTextForeground);\n    if (foreground) {\n        // `!important` ensures that other decorations don't cause a style conflict (#132017).\n        collector.addRule(`.monaco-editor .ghost-text-decoration { color: ${foreground.toString()} !important; }`);\n        collector.addRule(`.monaco-editor .ghost-text-decoration-preview { color: ${foreground.toString()} !important; }`);\n        collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { color: ${foreground.toString()} !important; }`);\n    }\n    const background = theme.getColor(ghostTextBackground);\n    if (background) {\n        collector.addRule(`.monaco-editor .ghost-text-decoration { background-color: ${background.toString()}; }`);\n        collector.addRule(`.monaco-editor .ghost-text-decoration-preview { background-color: ${background.toString()}; }`);\n        collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { background-color: ${background.toString()}; }`);\n    }\n    const border = theme.getColor(ghostTextBorder);\n    if (border) {\n        collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ${border}; }`);\n        collector.addRule(`.monaco-editor .ghost-text-decoration { border: 1px solid ${border}; }`);\n        collector.addRule(`.monaco-editor .ghost-text-decoration-preview { border: 1px solid ${border}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { firstNonWhitespaceIndex } from '../../../../base/common/strings.js';\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { CursorColumns } from '../../../common/core/cursorColumns.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { GhostTextModel } from './ghostTextModel.js';\nimport { GhostTextWidget } from './ghostTextWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nlet GhostTextController = class GhostTextController extends Disposable {\n    constructor(editor, instantiationService) {\n        super();\n        this.editor = editor;\n        this.instantiationService = instantiationService;\n        this.triggeredExplicitly = false;\n        this.activeController = this._register(new MutableDisposable());\n        this.activeModelDidChangeEmitter = this._register(new Emitter());\n        this._register(this.editor.onDidChangeModel(() => {\n            this.updateModelController();\n        }));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(108 /* EditorOption.suggest */)) {\n                this.updateModelController();\n            }\n            if (e.hasChanged(57 /* EditorOption.inlineSuggest */)) {\n                this.updateModelController();\n            }\n        }));\n        this.updateModelController();\n    }\n    static get(editor) {\n        return editor.getContribution(GhostTextController.ID);\n    }\n    get activeModel() {\n        var _a;\n        return (_a = this.activeController.value) === null || _a === void 0 ? void 0 : _a.model;\n    }\n    // Don't call this method when not necessary. It will recreate the activeController.\n    updateModelController() {\n        const suggestOptions = this.editor.getOption(108 /* EditorOption.suggest */);\n        const inlineSuggestOptions = this.editor.getOption(57 /* EditorOption.inlineSuggest */);\n        this.activeController.value = undefined;\n        // ActiveGhostTextController is only created if one of those settings is set or if the inline completions are triggered explicitly.\n        this.activeController.value =\n            this.editor.hasModel() && (suggestOptions.preview || inlineSuggestOptions.enabled || this.triggeredExplicitly)\n                ? this.instantiationService.createInstance(ActiveGhostTextController, this.editor)\n                : undefined;\n        this.activeModelDidChangeEmitter.fire();\n    }\n    shouldShowHoverAt(hoverRange) {\n        var _a;\n        return ((_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.shouldShowHoverAt(hoverRange)) || false;\n    }\n    shouldShowHoverAtViewZone(viewZoneId) {\n        var _a, _b;\n        return ((_b = (_a = this.activeController.value) === null || _a === void 0 ? void 0 : _a.widget) === null || _b === void 0 ? void 0 : _b.shouldShowHoverAtViewZone(viewZoneId)) || false;\n    }\n    trigger() {\n        var _a;\n        this.triggeredExplicitly = true;\n        if (!this.activeController.value) {\n            this.updateModelController();\n        }\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.triggerInlineCompletion();\n    }\n    commit() {\n        var _a;\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.commitInlineCompletion();\n    }\n    hide() {\n        var _a;\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.hideInlineCompletion();\n    }\n    showNextInlineCompletion() {\n        var _a;\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.showNextInlineCompletion();\n    }\n    showPreviousInlineCompletion() {\n        var _a;\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.showPreviousInlineCompletion();\n    }\n    hasMultipleInlineCompletions() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield ((_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\n            return result !== undefined ? result : false;\n        });\n    }\n};\nGhostTextController.inlineSuggestionVisible = new RawContextKey('inlineSuggestionVisible', false, nls.localize('inlineSuggestionVisible', \"Whether an inline suggestion is visible\"));\nGhostTextController.inlineSuggestionHasIndentation = new RawContextKey('inlineSuggestionHasIndentation', false, nls.localize('inlineSuggestionHasIndentation', \"Whether the inline suggestion starts with whitespace\"));\nGhostTextController.inlineSuggestionHasIndentationLessThanTabSize = new RawContextKey('inlineSuggestionHasIndentationLessThanTabSize', true, nls.localize('inlineSuggestionHasIndentationLessThanTabSize', \"Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab\"));\nGhostTextController.ID = 'editor.contrib.ghostTextController';\nGhostTextController = __decorate([\n    __param(1, IInstantiationService)\n], GhostTextController);\nexport { GhostTextController };\nclass GhostTextContextKeys {\n    constructor(contextKeyService) {\n        this.contextKeyService = contextKeyService;\n        this.inlineCompletionVisible = GhostTextController.inlineSuggestionVisible.bindTo(this.contextKeyService);\n        this.inlineCompletionSuggestsIndentation = GhostTextController.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);\n        this.inlineCompletionSuggestsIndentationLessThanTabSize = GhostTextController.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService);\n    }\n}\n/**\n * The controller for a text editor with an initialized text model.\n * Must be disposed as soon as the model detaches from the editor.\n*/\nlet ActiveGhostTextController = class ActiveGhostTextController extends Disposable {\n    constructor(editor, instantiationService, contextKeyService) {\n        super();\n        this.editor = editor;\n        this.instantiationService = instantiationService;\n        this.contextKeyService = contextKeyService;\n        this.contextKeys = new GhostTextContextKeys(this.contextKeyService);\n        this.model = this._register(this.instantiationService.createInstance(GhostTextModel, this.editor));\n        this.widget = this._register(this.instantiationService.createInstance(GhostTextWidget, this.editor, this.model));\n        this._register(toDisposable(() => {\n            this.contextKeys.inlineCompletionVisible.set(false);\n            this.contextKeys.inlineCompletionSuggestsIndentation.set(false);\n            this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(true);\n        }));\n        this._register(this.model.onDidChange(() => {\n            this.updateContextKeys();\n        }));\n        this.updateContextKeys();\n    }\n    updateContextKeys() {\n        var _a;\n        this.contextKeys.inlineCompletionVisible.set(((_a = this.model.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.ghostText) !== undefined);\n        let startsWithIndentation = false;\n        let startsWithIndentationLessThanTabSize = true;\n        const ghostText = this.model.inlineCompletionsModel.ghostText;\n        if (!!this.model.activeInlineCompletionsModel && ghostText && ghostText.parts.length > 0) {\n            const { column, lines } = ghostText.parts[0];\n            const firstLine = lines[0];\n            const indentationEndColumn = this.editor.getModel().getLineIndentColumn(ghostText.lineNumber);\n            const inIndentation = column <= indentationEndColumn;\n            if (inIndentation) {\n                let firstNonWsIdx = firstNonWhitespaceIndex(firstLine);\n                if (firstNonWsIdx === -1) {\n                    firstNonWsIdx = firstLine.length - 1;\n                }\n                startsWithIndentation = firstNonWsIdx > 0;\n                const tabSize = this.editor.getModel().getOptions().tabSize;\n                const visibleColumnIndentation = CursorColumns.visibleColumnFromColumn(firstLine, firstNonWsIdx + 1, tabSize);\n                startsWithIndentationLessThanTabSize = visibleColumnIndentation < tabSize;\n            }\n        }\n        this.contextKeys.inlineCompletionSuggestsIndentation.set(startsWithIndentation);\n        this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(startsWithIndentationLessThanTabSize);\n    }\n};\nActiveGhostTextController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService)\n], ActiveGhostTextController);\nexport { ActiveGhostTextController };\nexport class ShowNextInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: ShowNextInlineSuggestionAction.ID,\n            label: nls.localize('action.inlineSuggest.showNext', \"Show Next Inline Suggestion\"),\n            alias: 'Show Next Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, GhostTextController.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 89 /* KeyCode.BracketRight */,\n            },\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = GhostTextController.get(editor);\n            if (controller) {\n                controller.showNextInlineCompletion();\n                editor.focus();\n            }\n        });\n    }\n}\nShowNextInlineSuggestionAction.ID = 'editor.action.inlineSuggest.showNext';\nexport class ShowPreviousInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: ShowPreviousInlineSuggestionAction.ID,\n            label: nls.localize('action.inlineSuggest.showPrevious', \"Show Previous Inline Suggestion\"),\n            alias: 'Show Previous Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, GhostTextController.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 87 /* KeyCode.BracketLeft */,\n            },\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = GhostTextController.get(editor);\n            if (controller) {\n                controller.showPreviousInlineCompletion();\n                editor.focus();\n            }\n        });\n    }\n}\nShowPreviousInlineSuggestionAction.ID = 'editor.action.inlineSuggest.showPrevious';\nexport class TriggerInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.trigger',\n            label: nls.localize('action.inlineSuggest.trigger', \"Trigger Inline Suggestion\"),\n            alias: 'Trigger Inline Suggestion',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = GhostTextController.get(editor);\n            if (controller) {\n                controller.trigger();\n            }\n        });\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { GhostTextController, ShowNextInlineSuggestionAction, ShowPreviousInlineSuggestionAction } from './ghostTextController.js';\nimport * as nls from '../../../../nls.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { inlineSuggestCommitId } from './consts.js';\nexport class InlineCompletionsHover {\n    constructor(owner, range, controller) {\n        this.owner = owner;\n        this.range = range;\n        this.controller = controller;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n    hasMultipleSuggestions() {\n        return this.controller.hasMultipleInlineCompletions();\n    }\n    get commands() {\n        var _a, _b, _c;\n        return ((_c = (_b = (_a = this.controller.activeModel) === null || _a === void 0 ? void 0 : _a.activeInlineCompletionsModel) === null || _b === void 0 ? void 0 : _b.completionSession.value) === null || _c === void 0 ? void 0 : _c.commands) || [];\n    }\n}\nlet InlineCompletionsHoverParticipant = class InlineCompletionsHoverParticipant {\n    constructor(_editor, _commandService, _menuService, _contextKeyService, _languageService, _openerService, accessibilityService) {\n        this._editor = _editor;\n        this._commandService = _commandService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this.accessibilityService = accessibilityService;\n        this.hoverOrdinal = 3;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        const controller = GhostTextController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        const target = mouseEvent.target;\n        if (target.type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */) {\n            // handle the case where the mouse is over the view zone\n            const viewZoneData = target.detail;\n            if (controller.shouldShowHoverAtViewZone(viewZoneData.viewZoneId)) {\n                return new HoverForeignElementAnchor(1000, this, Range.fromPositions(viewZoneData.positionBefore || viewZoneData.position, viewZoneData.positionBefore || viewZoneData.position));\n            }\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            // handle the case where the mouse is over the empty portion of a line following ghost text\n            if (controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range);\n            }\n        }\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            // handle the case where the mouse is directly over ghost text\n            const mightBeForeignElement = target.detail.mightBeForeignElement;\n            if (mightBeForeignElement && controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range);\n            }\n        }\n        return null;\n    }\n    computeSync(anchor, lineDecorations) {\n        const controller = GhostTextController.get(this._editor);\n        if (controller && controller.shouldShowHoverAt(anchor.range)) {\n            return [new InlineCompletionsHover(this, anchor.range, controller)];\n        }\n        return [];\n    }\n    renderHoverParts(context, hoverParts) {\n        const disposableStore = new DisposableStore();\n        const part = hoverParts[0];\n        if (this.accessibilityService.isScreenReaderOptimized()) {\n            this.renderScreenReaderText(context, part, disposableStore);\n        }\n        // TODO@hediet: deprecate MenuId.InlineCompletionsActions\n        const menu = disposableStore.add(this._menuService.createMenu(MenuId.InlineCompletionsActions, this._contextKeyService));\n        const previousAction = context.statusBar.addAction({\n            label: nls.localize('showNextInlineSuggestion', \"Next\"),\n            commandId: ShowNextInlineSuggestionAction.ID,\n            run: () => this._commandService.executeCommand(ShowNextInlineSuggestionAction.ID)\n        });\n        const nextAction = context.statusBar.addAction({\n            label: nls.localize('showPreviousInlineSuggestion', \"Previous\"),\n            commandId: ShowPreviousInlineSuggestionAction.ID,\n            run: () => this._commandService.executeCommand(ShowPreviousInlineSuggestionAction.ID)\n        });\n        context.statusBar.addAction({\n            label: nls.localize('acceptInlineSuggestion', \"Accept\"),\n            commandId: inlineSuggestCommitId,\n            run: () => this._commandService.executeCommand(inlineSuggestCommitId)\n        });\n        const actions = [previousAction, nextAction];\n        for (const action of actions) {\n            action.setEnabled(false);\n        }\n        part.hasMultipleSuggestions().then(hasMore => {\n            for (const action of actions) {\n                action.setEnabled(hasMore);\n            }\n        });\n        for (const command of part.commands) {\n            context.statusBar.addAction({\n                label: command.title,\n                commandId: command.id,\n                run: () => this._commandService.executeCommand(command.id, ...(command.arguments || []))\n            });\n        }\n        for (const [_, group] of menu.getActions()) {\n            for (const action of group) {\n                if (action instanceof MenuItemAction) {\n                    context.statusBar.addAction({\n                        label: action.label,\n                        commandId: action.item.id,\n                        run: () => this._commandService.executeCommand(action.item.id)\n                    });\n                }\n            }\n        }\n        return disposableStore;\n    }\n    renderScreenReaderText(context, part, disposableStore) {\n        var _a, _b;\n        const $ = dom.$;\n        const markdownHoverElement = $('div.hover-row.markdown-hover');\n        const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n        const renderer = disposableStore.add(new MarkdownRenderer({ editor: this._editor }, this._languageService, this._openerService));\n        const render = (code) => {\n            disposableStore.add(renderer.onDidRenderAsync(() => {\n                hoverContentsElement.className = 'hover-contents code-hover-contents';\n                context.onContentsChanged();\n            }));\n            const inlineSuggestionAvailable = nls.localize('inlineSuggestionFollows', \"Suggestion:\");\n            const renderedContents = disposableStore.add(renderer.render(new MarkdownString().appendText(inlineSuggestionAvailable).appendCodeblock('text', code)));\n            hoverContentsElement.replaceChildren(renderedContents.element);\n        };\n        const ghostText = (_b = (_a = part.controller.activeModel) === null || _a === void 0 ? void 0 : _a.inlineCompletionsModel) === null || _b === void 0 ? void 0 : _b.ghostText;\n        if (ghostText) {\n            const lineText = this._editor.getModel().getLineContent(ghostText.lineNumber);\n            render(ghostText.renderForScreenReader(lineText));\n        }\n        context.fragment.appendChild(markdownHoverElement);\n    }\n};\nInlineCompletionsHoverParticipant = __decorate([\n    __param(1, ICommandService),\n    __param(2, IMenuService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageService),\n    __param(5, IOpenerService),\n    __param(6, IAccessibilityService)\n], InlineCompletionsHoverParticipant);\nexport { InlineCompletionsHoverParticipant };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { inlineSuggestCommitId } from './consts.js';\nimport { GhostTextController, ShowNextInlineSuggestionAction, ShowPreviousInlineSuggestionAction, TriggerInlineSuggestionAction } from './ghostTextController.js';\nimport { InlineCompletionsHoverParticipant } from './ghostTextHoverParticipant.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nregisterEditorContribution(GhostTextController.ID, GhostTextController);\nregisterEditorAction(TriggerInlineSuggestionAction);\nregisterEditorAction(ShowNextInlineSuggestionAction);\nregisterEditorAction(ShowPreviousInlineSuggestionAction);\nHoverParticipantRegistry.register(InlineCompletionsHoverParticipant);\nconst GhostTextCommand = EditorCommand.bindToContribution(GhostTextController.get);\nexport const commitInlineSuggestionAction = new GhostTextCommand({\n    id: inlineSuggestCommitId,\n    precondition: GhostTextController.inlineSuggestionVisible,\n    handler(x) {\n        x.commit();\n        x.editor.focus();\n    }\n});\nregisterEditorCommand(commitInlineSuggestionAction);\nKeybindingsRegistry.registerKeybindingRule({\n    primary: 2 /* KeyCode.Tab */,\n    weight: 200,\n    id: commitInlineSuggestionAction.id,\n    when: ContextKeyExpr.and(commitInlineSuggestionAction.precondition, EditorContextKeys.tabMovesFocus.toNegated(), GhostTextController.inlineSuggestionHasIndentationLessThanTabSize),\n});\nregisterEditorCommand(new GhostTextCommand({\n    id: 'editor.action.inlineSuggest.hide',\n    precondition: GhostTextController.inlineSuggestionVisible,\n    kbOpts: {\n        weight: 100,\n        primary: 9 /* KeyCode.Escape */,\n    },\n    handler(x) {\n        x.hide();\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function getSpaceCnt(str, tabSize) {\n    let spacesCnt = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str.charAt(i) === '\\t') {\n            spacesCnt += tabSize;\n        }\n        else {\n            spacesCnt++;\n        }\n    }\n    return spacesCnt;\n}\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\n    let result = '';\n    if (!insertSpaces) {\n        const tabsCnt = Math.floor(spacesCnt / tabSize);\n        spacesCnt = spacesCnt % tabSize;\n        for (let i = 0; i < tabsCnt; i++) {\n            result += '\\t';\n        }\n    }\n    for (let i = 0; i < spacesCnt; i++) {\n        result += ' ';\n    }\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport * as indentUtils from './indentUtils.js';\nimport * as nls from '../../../../nls.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { normalizeIndentation } from '../../../common/core/indentation.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nexport function getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber, inheritedIndent) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return [];\n    }\n    const indentationRules = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).indentationRules;\n    if (!indentationRules) {\n        return [];\n    }\n    endLineNumber = Math.min(endLineNumber, model.getLineCount());\n    // Skip `unIndentedLinePattern` lines\n    while (startLineNumber <= endLineNumber) {\n        if (!indentationRules.unIndentedLinePattern) {\n            break;\n        }\n        const text = model.getLineContent(startLineNumber);\n        if (!indentationRules.unIndentedLinePattern.test(text)) {\n            break;\n        }\n        startLineNumber++;\n    }\n    if (startLineNumber > endLineNumber - 1) {\n        return [];\n    }\n    const { tabSize, indentSize, insertSpaces } = model.getOptions();\n    const shiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.shiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const unshiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.unshiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const indentEdits = [];\n    // indentation being passed to lines below\n    let globalIndent;\n    // Calculate indentation for the first line\n    // If there is no passed-in indentation, we use the indentation of the first line as base.\n    const currentLineText = model.getLineContent(startLineNumber);\n    let adjustedLineContent = currentLineText;\n    if (inheritedIndent !== undefined && inheritedIndent !== null) {\n        globalIndent = inheritedIndent;\n        const oldIndentation = strings.getLeadingWhitespace(currentLineText);\n        adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = unshiftIndent(globalIndent);\n            adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        }\n        if (currentLineText !== adjustedLineContent) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(startLineNumber, 1, startLineNumber, oldIndentation.length + 1), normalizeIndentation(globalIndent, indentSize, insertSpaces)));\n        }\n    }\n    else {\n        globalIndent = strings.getLeadingWhitespace(currentLineText);\n    }\n    // idealIndentForNextLine doesn't equal globalIndent when there is a line matching `indentNextLinePattern`.\n    let idealIndentForNextLine = globalIndent;\n    if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        globalIndent = shiftIndent(globalIndent);\n    }\n    else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n    }\n    startLineNumber++;\n    // Calculate indentation adjustment for all following lines\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        const text = model.getLineContent(lineNumber);\n        const oldIndentation = strings.getLeadingWhitespace(text);\n        const adjustedLineContent = idealIndentForNextLine + text.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = unshiftIndent(idealIndentForNextLine);\n            globalIndent = unshiftIndent(globalIndent);\n        }\n        if (oldIndentation !== idealIndentForNextLine) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(lineNumber, 1, lineNumber, oldIndentation.length + 1), normalizeIndentation(idealIndentForNextLine, indentSize, insertSpaces)));\n        }\n        // calculate idealIndentForNextLine\n        if (indentationRules.unIndentedLinePattern && indentationRules.unIndentedLinePattern.test(text)) {\n            // In reindent phase, if the line matches `unIndentedLinePattern` we inherit indentation from above lines\n            // but don't change globalIndent and idealIndentForNextLine.\n            continue;\n        }\n        else if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = shiftIndent(globalIndent);\n            idealIndentForNextLine = globalIndent;\n        }\n        else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        }\n        else {\n            idealIndentForNextLine = globalIndent;\n        }\n    }\n    return indentEdits;\n}\nexport class IndentationToSpacesAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToSpacesAction.ID,\n            label: nls.localize('indentationToSpaces', \"Convert Indentation to Spaces\"),\n            alias: 'Convert Indentation to Spaces',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToSpacesCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: true\n        });\n    }\n}\nIndentationToSpacesAction.ID = 'editor.action.indentationToSpaces';\nexport class IndentationToTabsAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToTabsAction.ID,\n            label: nls.localize('indentationToTabs', \"Convert Indentation to Tabs\"),\n            alias: 'Convert Indentation to Tabs',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToTabsCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: false\n        });\n    }\n}\nIndentationToTabsAction.ID = 'editor.action.indentationToTabs';\nexport class ChangeIndentationSizeAction extends EditorAction {\n    constructor(insertSpaces, opts) {\n        super(opts);\n        this.insertSpaces = insertSpaces;\n    }\n    run(accessor, editor) {\n        const quickInputService = accessor.get(IQuickInputService);\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        const picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\n            id: n.toString(),\n            label: n.toString(),\n            // add description for tabSize value set in the configuration\n            description: n === creationOpts.tabSize ? nls.localize('configuredTabSize', \"Configured Tab Size\") : undefined\n        }));\n        // auto focus the tabSize set for the current editor\n        const autoFocusIndex = Math.min(model.getOptions().tabSize - 1, 7);\n        setTimeout(() => {\n            quickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\"), activeItem: picks[autoFocusIndex] }).then(pick => {\n                if (pick) {\n                    if (model && !model.isDisposed()) {\n                        model.updateOptions({\n                            tabSize: parseInt(pick.label, 10),\n                            insertSpaces: this.insertSpaces\n                        });\n                    }\n                }\n            });\n        }, 50 /* quick input is sensitive to being opened so soon after another */);\n    }\n}\nexport class IndentUsingTabs extends ChangeIndentationSizeAction {\n    constructor() {\n        super(false, {\n            id: IndentUsingTabs.ID,\n            label: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\n            alias: 'Indent Using Tabs',\n            precondition: undefined\n        });\n    }\n}\nIndentUsingTabs.ID = 'editor.action.indentUsingTabs';\nexport class IndentUsingSpaces extends ChangeIndentationSizeAction {\n    constructor() {\n        super(true, {\n            id: IndentUsingSpaces.ID,\n            label: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\n            alias: 'Indent Using Spaces',\n            precondition: undefined\n        });\n    }\n}\nIndentUsingSpaces.ID = 'editor.action.indentUsingSpaces';\nexport class DetectIndentation extends EditorAction {\n    constructor() {\n        super({\n            id: DetectIndentation.ID,\n            label: nls.localize('detectIndentation', \"Detect Indentation from Content\"),\n            alias: 'Detect Indentation from Content',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        model.detectIndentation(creationOpts.insertSpaces, creationOpts.tabSize);\n    }\n}\nDetectIndentation.ID = 'editor.action.detectIndentation';\nexport class ReindentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentlines',\n            label: nls.localize('editor.reindentlines', \"Reindent Lines\"),\n            alias: 'Reindent Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const edits = getReindentEditOperations(model, languageConfigurationService, 1, model.getLineCount());\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class ReindentSelectedLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentselectedlines',\n            label: nls.localize('editor.reindentselectedlines', \"Reindent Selected Lines\"),\n            alias: 'Reindent Selected Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const edits = [];\n        for (const selection of selections) {\n            let startLineNumber = selection.startLineNumber;\n            let endLineNumber = selection.endLineNumber;\n            if (startLineNumber !== endLineNumber && selection.endColumn === 1) {\n                endLineNumber--;\n            }\n            if (startLineNumber === 1) {\n                if (startLineNumber === endLineNumber) {\n                    continue;\n                }\n            }\n            else {\n                startLineNumber--;\n            }\n            const editOperations = getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber);\n            edits.push(...editOperations);\n        }\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class AutoIndentOnPasteCommand {\n    constructor(edits, initialSelection) {\n        this._initialSelection = initialSelection;\n        this._edits = [];\n        this._selectionId = null;\n        for (const edit of edits) {\n            if (edit.range && typeof edit.text === 'string') {\n                this._edits.push(edit);\n            }\n        }\n    }\n    getEditOperations(model, builder) {\n        for (const edit of this._edits) {\n            builder.addEditOperation(Range.lift(edit.range), edit.text);\n        }\n        let selectionIsSet = false;\n        if (Array.isArray(this._edits) && this._edits.length === 1 && this._initialSelection.isEmpty()) {\n            if (this._edits[0].range.startColumn === this._initialSelection.endColumn &&\n                this._edits[0].range.startLineNumber === this._initialSelection.endLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, true);\n            }\n            else if (this._edits[0].range.endColumn === this._initialSelection.startColumn &&\n                this._edits[0].range.endLineNumber === this._initialSelection.startLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, false);\n            }\n        }\n        if (!selectionIsSet) {\n            this._selectionId = builder.trackSelection(this._initialSelection);\n        }\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\nlet AutoIndentOnPaste = class AutoIndentOnPaste {\n    constructor(editor, _languageConfigurationService) {\n        this.editor = editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this.callOnDispose = new DisposableStore();\n        this.callOnModel = new DisposableStore();\n        this.callOnDispose.add(editor.onDidChangeConfiguration(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModel(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModelLanguage(() => this.update()));\n    }\n    update() {\n        // clean up\n        this.callOnModel.clear();\n        // we are disabled\n        if (this.editor.getOption(9 /* EditorOption.autoIndent */) < 4 /* EditorAutoIndentStrategy.Full */ || this.editor.getOption(50 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        this.callOnModel.add(this.editor.onDidPaste(({ range }) => {\n            this.trigger(range);\n        }));\n    }\n    trigger(range) {\n        const selections = this.editor.getSelections();\n        if (selections === null || selections.length > 1) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!model.tokenization.isCheapToTokenize(range.getStartPosition().lineNumber)) {\n            return;\n        }\n        const autoIndent = this.editor.getOption(9 /* EditorOption.autoIndent */);\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const textEdits = [];\n        const indentConverter = {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n        let startLineNumber = range.startLineNumber;\n        while (startLineNumber <= range.endLineNumber) {\n            if (this.shouldIgnoreLine(model, startLineNumber)) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber > range.endLineNumber) {\n            return;\n        }\n        let firstLineText = model.getLineContent(startLineNumber);\n        if (!/\\S/.test(firstLineText.substring(0, range.startColumn - 1))) {\n            const indentOfFirstLine = getGoodIndentForLine(autoIndent, model, model.getLanguageId(), startLineNumber, indentConverter, this._languageConfigurationService);\n            if (indentOfFirstLine !== null) {\n                const oldIndentation = strings.getLeadingWhitespace(firstLineText);\n                const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                if (newSpaceCnt !== oldSpaceCnt) {\n                    const newIndent = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                    textEdits.push({\n                        range: new Range(startLineNumber, 1, startLineNumber, oldIndentation.length + 1),\n                        text: newIndent\n                    });\n                    firstLineText = newIndent + firstLineText.substr(oldIndentation.length);\n                }\n                else {\n                    const indentMetadata = getIndentMetadata(model, startLineNumber, this._languageConfigurationService);\n                    if (indentMetadata === 0 || indentMetadata === 8 /* IndentConsts.UNINDENT_MASK */) {\n                        // we paste content into a line where only contains whitespaces\n                        // after pasting, the indentation of the first line is already correct\n                        // the first line doesn't match any indentation rule\n                        // then no-op.\n                        return;\n                    }\n                }\n            }\n        }\n        const firstLineNumber = startLineNumber;\n        // ignore empty or ignored lines\n        while (startLineNumber < range.endLineNumber) {\n            if (!/\\S/.test(model.getLineContent(startLineNumber + 1))) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber !== range.endLineNumber) {\n            const virtualModel = {\n                tokenization: {\n                    getLineTokens: (lineNumber) => {\n                        return model.tokenization.getLineTokens(lineNumber);\n                    },\n                    getLanguageId: () => {\n                        return model.getLanguageId();\n                    },\n                    getLanguageIdAtPosition: (lineNumber, column) => {\n                        return model.getLanguageIdAtPosition(lineNumber, column);\n                    },\n                },\n                getLineContent: (lineNumber) => {\n                    if (lineNumber === firstLineNumber) {\n                        return firstLineText;\n                    }\n                    else {\n                        return model.getLineContent(lineNumber);\n                    }\n                }\n            };\n            const indentOfSecondLine = getGoodIndentForLine(autoIndent, virtualModel, model.getLanguageId(), startLineNumber + 1, indentConverter, this._languageConfigurationService);\n            if (indentOfSecondLine !== null) {\n                const newSpaceCntOfSecondLine = indentUtils.getSpaceCnt(indentOfSecondLine, tabSize);\n                const oldSpaceCntOfSecondLine = indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber + 1)), tabSize);\n                if (newSpaceCntOfSecondLine !== oldSpaceCntOfSecondLine) {\n                    const spaceCntOffset = newSpaceCntOfSecondLine - oldSpaceCntOfSecondLine;\n                    for (let i = startLineNumber + 1; i <= range.endLineNumber; i++) {\n                        const lineContent = model.getLineContent(i);\n                        const originalIndent = strings.getLeadingWhitespace(lineContent);\n                        const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n                        const newSpacesCnt = originalSpacesCnt + spaceCntOffset;\n                        const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n                        if (newIndent !== originalIndent) {\n                            textEdits.push({\n                                range: new Range(i, 1, i, originalIndent.length + 1),\n                                text: newIndent\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if (textEdits.length > 0) {\n            this.editor.pushUndoStop();\n            const cmd = new AutoIndentOnPasteCommand(textEdits, this.editor.getSelection());\n            this.editor.executeCommand('autoIndentOnPaste', cmd);\n            this.editor.pushUndoStop();\n        }\n    }\n    shouldIgnoreLine(model, lineNumber) {\n        model.tokenization.forceTokenization(lineNumber);\n        const nonWhitespaceColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (nonWhitespaceColumn === 0) {\n            return true;\n        }\n        const tokens = model.tokenization.getLineTokens(lineNumber);\n        if (tokens.getCount() > 0) {\n            const firstNonWhitespaceTokenIndex = tokens.findTokenIndexAtOffset(nonWhitespaceColumn);\n            if (firstNonWhitespaceTokenIndex >= 0 && tokens.getStandardTokenType(firstNonWhitespaceTokenIndex) === 1 /* StandardTokenType.Comment */) {\n                return true;\n            }\n        }\n        return false;\n    }\n    dispose() {\n        this.callOnDispose.dispose();\n        this.callOnModel.dispose();\n    }\n};\nAutoIndentOnPaste.ID = 'editor.contrib.autoIndentOnPaste';\nAutoIndentOnPaste = __decorate([\n    __param(1, ILanguageConfigurationService)\n], AutoIndentOnPaste);\nexport { AutoIndentOnPaste };\nfunction getIndentationEditOperations(model, builder, tabSize, tabsToSpaces) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return;\n    }\n    let spaces = '';\n    for (let i = 0; i < tabSize; i++) {\n        spaces += ' ';\n    }\n    const spacesRegExp = new RegExp(spaces, 'gi');\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        let lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (lastIndentationColumn === 0) {\n            lastIndentationColumn = model.getLineMaxColumn(lineNumber);\n        }\n        if (lastIndentationColumn === 1) {\n            continue;\n        }\n        const originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\n        const originalIndentation = model.getValueInRange(originalIndentationRange);\n        const newIndentation = (tabsToSpaces\n            ? originalIndentation.replace(/\\t/ig, spaces)\n            : originalIndentation.replace(spacesRegExp, '\\t'));\n        builder.addEditOperation(originalIndentationRange, newIndentation);\n    }\n}\nexport class IndentationToSpacesCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, true);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nexport class IndentationToTabsCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, false);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nregisterEditorContribution(AutoIndentOnPaste.ID, AutoIndentOnPaste);\nregisterEditorAction(IndentationToSpacesAction);\nregisterEditorAction(IndentationToTabsAction);\nregisterEditorAction(IndentUsingTabs);\nregisterEditorAction(IndentUsingSpaces);\nregisterEditorAction(DetectIndentation);\nregisterEditorAction(ReindentLinesAction);\nregisterEditorAction(ReindentSelectedLinesAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { URI } from '../../../../base/common/uri.js';\nexport class InlayHintAnchor {\n    constructor(range, direction) {\n        this.range = range;\n        this.direction = direction;\n    }\n}\nexport class InlayHintItem {\n    constructor(hint, anchor, provider) {\n        this.hint = hint;\n        this.anchor = anchor;\n        this.provider = provider;\n        this._isResolved = false;\n    }\n    with(delta) {\n        const result = new InlayHintItem(this.hint, delta.anchor, this.provider);\n        result._isResolved = this._isResolved;\n        result._currentResolve = this._currentResolve;\n        return result;\n    }\n    resolve(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof this.provider.resolveInlayHint !== 'function') {\n                return;\n            }\n            if (this._currentResolve) {\n                // wait for an active resolve operation and try again\n                // when that's done.\n                yield this._currentResolve;\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                return this.resolve(token);\n            }\n            if (!this._isResolved) {\n                this._currentResolve = this._doResolve(token)\n                    .finally(() => this._currentResolve = undefined);\n            }\n            yield this._currentResolve;\n        });\n    }\n    _doResolve(token) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const newHint = yield Promise.resolve(this.provider.resolveInlayHint(this.hint, token));\n                this.hint.tooltip = (_a = newHint === null || newHint === void 0 ? void 0 : newHint.tooltip) !== null && _a !== void 0 ? _a : this.hint.tooltip;\n                this.hint.label = (_b = newHint === null || newHint === void 0 ? void 0 : newHint.label) !== null && _b !== void 0 ? _b : this.hint.label;\n                this._isResolved = true;\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n                this._isResolved = false;\n            }\n        });\n    }\n}\nexport class InlayHintsFragments {\n    constructor(ranges, data, model) {\n        this._disposables = new DisposableStore();\n        this.ranges = ranges;\n        this.provider = new Set();\n        const items = [];\n        for (const [list, provider] of data) {\n            this._disposables.add(list);\n            this.provider.add(provider);\n            for (const hint of list.hints) {\n                // compute the range to which the item should be attached to\n                const position = model.validatePosition(hint.position);\n                let direction = 'before';\n                const wordRange = InlayHintsFragments._getRangeAtPosition(model, position);\n                let range;\n                if (wordRange.getStartPosition().isBefore(position)) {\n                    range = Range.fromPositions(wordRange.getStartPosition(), position);\n                    direction = 'after';\n                }\n                else {\n                    range = Range.fromPositions(position, wordRange.getEndPosition());\n                    direction = 'before';\n                }\n                items.push(new InlayHintItem(hint, new InlayHintAnchor(range, direction), provider));\n            }\n        }\n        this.items = items.sort((a, b) => Position.compare(a.hint.position, b.hint.position));\n    }\n    static create(registry, model, ranges, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const data = [];\n            const promises = registry.ordered(model).reverse().map(provider => ranges.map((range) => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    const result = yield provider.provideInlayHints(model, range, token);\n                    if (result === null || result === void 0 ? void 0 : result.hints.length) {\n                        data.push([result, provider]);\n                    }\n                }\n                catch (err) {\n                    onUnexpectedExternalError(err);\n                }\n            })));\n            yield Promise.all(promises.flat());\n            if (token.isCancellationRequested || model.isDisposed()) {\n                throw new CancellationError();\n            }\n            return new InlayHintsFragments(ranges, data, model);\n        });\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    static _getRangeAtPosition(model, position) {\n        const line = position.lineNumber;\n        const word = model.getWordAtPosition(position);\n        if (word) {\n            // always prefer the word range\n            return new Range(line, word.startColumn, line, word.endColumn);\n        }\n        model.tokenization.tokenizeIfCheap(line);\n        const tokens = model.tokenization.getLineTokens(line);\n        const offset = position.column - 1;\n        const idx = tokens.findTokenIndexAtOffset(offset);\n        let start = tokens.getStartOffset(idx);\n        let end = tokens.getEndOffset(idx);\n        if (end - start === 1) {\n            // single character token, when at its end try leading/trailing token instead\n            if (start === offset && idx > 1) {\n                // leading token\n                start = tokens.getStartOffset(idx - 1);\n                end = tokens.getEndOffset(idx - 1);\n            }\n            else if (end === offset && idx < tokens.getCount() - 1) {\n                // trailing token\n                start = tokens.getStartOffset(idx + 1);\n                end = tokens.getEndOffset(idx + 1);\n            }\n        }\n        return new Range(line, start + 1, line, end + 1);\n    }\n}\nexport function asCommandLink(command) {\n    return URI.from({\n        scheme: Schemas.command,\n        path: command.id,\n        query: command.arguments && encodeURIComponent(JSON.stringify(command.arguments))\n    }).toString();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Action, Separator } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { EditorExtensionsRegistry } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { DefinitionAction, SymbolNavigationAction, SymbolNavigationAnchor } from '../../gotoSymbol/browser/goToCommands.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport { isIMenuItem, MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nexport function showGoToContextMenu(accessor, editor, anchor, part) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n        const resolverService = accessor.get(ITextModelService);\n        const contextMenuService = accessor.get(IContextMenuService);\n        const commandService = accessor.get(ICommandService);\n        const instaService = accessor.get(IInstantiationService);\n        const notificationService = accessor.get(INotificationService);\n        yield part.item.resolve(CancellationToken.None);\n        if (!part.part.location) {\n            return;\n        }\n        const location = part.part.location;\n        const menuActions = [];\n        // from all registered (not active) context menu actions select those\n        // that are a symbol navigation action\n        const filter = new Set(MenuRegistry.getMenuItems(MenuId.EditorContext)\n            .map(item => isIMenuItem(item) ? item.command.id : ''));\n        for (const delegate of EditorExtensionsRegistry.getEditorActions()) {\n            if (delegate instanceof SymbolNavigationAction && filter.has(delegate.id)) {\n                menuActions.push(new Action(delegate.id, delegate.label, undefined, true, () => __awaiter(this, void 0, void 0, function* () {\n                    const ref = yield resolverService.createModelReference(location.uri);\n                    try {\n                        yield instaService.invokeFunction(delegate.run.bind(delegate), editor, new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range)));\n                    }\n                    finally {\n                        ref.dispose();\n                    }\n                })));\n            }\n        }\n        if (part.part.command) {\n            const { command } = part.part;\n            menuActions.push(new Separator());\n            menuActions.push(new Action(command.id, command.title, undefined, true, () => __awaiter(this, void 0, void 0, function* () {\n                var _b;\n                try {\n                    yield commandService.executeCommand(command.id, ...((_b = command.arguments) !== null && _b !== void 0 ? _b : []));\n                }\n                catch (err) {\n                    notificationService.notify({\n                        severity: Severity.Error,\n                        source: part.item.provider.displayName,\n                        message: err\n                    });\n                }\n            })));\n        }\n        // show context menu\n        const useShadowDOM = editor.getOption(117 /* EditorOption.useShadowDOM */);\n        contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? (_a = editor.getDomNode()) !== null && _a !== void 0 ? _a : undefined : undefined,\n            getAnchor: () => {\n                const box = dom.getDomNodePagePosition(anchor);\n                return { x: box.left, y: box.top + box.height + 8 };\n            },\n            getActions: () => menuActions,\n            onHide: () => {\n                editor.focus();\n            },\n            autoSelectFirstItem: true,\n        });\n    });\n}\nexport function goToDefinitionWithLocation(accessor, event, editor, location) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const resolverService = accessor.get(ITextModelService);\n        const ref = yield resolverService.createModelReference(location.uri);\n        yield editor.invokeWithinContext((accessor) => __awaiter(this, void 0, void 0, function* () {\n            const openToSide = event.hasSideBySideModifier;\n            const contextKeyService = accessor.get(IContextKeyService);\n            const isInPeek = PeekContext.inPeekEditor.getValue(contextKeyService);\n            const canPeek = !openToSide && editor.getOption(80 /* EditorOption.definitionLinkOpensInPeek */) && !isInPeek;\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\n            return action.run(accessor, editor, { model: ref.object.textEditorModel, position: Range.getStartPosition(location.range) });\n        }));\n        ref.dispose();\n    });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { ModifierKeyEmitter } from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as languages from '../../../common/languages.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { InlayHintAnchor, InlayHintsFragments } from './inlayHints.js';\nimport { goToDefinitionWithLocation, showGoToContextMenu } from './inlayHintsLocations.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport * as colors from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n// --- hint caching service (per session)\nclass InlayHintsCache {\n    constructor() {\n        this._entries = new LRUCache(50);\n    }\n    get(model) {\n        const key = InlayHintsCache._key(model);\n        return this._entries.get(key);\n    }\n    set(model, value) {\n        const key = InlayHintsCache._key(model);\n        this._entries.set(key, value);\n    }\n    static _key(model) {\n        return `${model.uri.toString()}/${model.getVersionId()}`;\n    }\n}\nconst IInlayHintsCache = createDecorator('IInlayHintsCache');\nregisterSingleton(IInlayHintsCache, InlayHintsCache, true);\n// --- rendered label\nexport class RenderedInlayHintLabelPart {\n    constructor(item, index) {\n        this.item = item;\n        this.index = index;\n    }\n    get part() {\n        const label = this.item.hint.label;\n        if (typeof label === 'string') {\n            return { label };\n        }\n        else {\n            return label[this.index];\n        }\n    }\n}\nclass ActiveInlayHintInfo {\n    constructor(part, hasTriggerModifier) {\n        this.part = part;\n        this.hasTriggerModifier = hasTriggerModifier;\n    }\n}\n// --- controller\nlet InlayHintsController = class InlayHintsController {\n    constructor(_editor, _languageFeaturesService, _featureDebounce, _inlayHintsCache, _commandService, _notificationService, _instaService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._inlayHintsCache = _inlayHintsCache;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._instaService = _instaService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._decorationsMetadata = new Map();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._activeRenderMode = 0 /* RenderMode.Normal */;\n        this._debounceInfo = _featureDebounce.for(_languageFeaturesService.inlayHintsProvider, 'InlayHint', { min: 25 });\n        this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(129 /* EditorOption.inlayHints */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    static get(editor) {\n        var _a;\n        return (_a = editor.getContribution(InlayHintsController.ID)) !== null && _a !== void 0 ? _a : undefined;\n    }\n    dispose() {\n        this._sessionDisposables.dispose();\n        this._removeAllDecorations();\n        this._disposables.dispose();\n    }\n    _update() {\n        this._sessionDisposables.clear();\n        this._removeAllDecorations();\n        const options = this._editor.getOption(129 /* EditorOption.inlayHints */);\n        if (options.enabled === 'off') {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.inlayHintsProvider.has(model)) {\n            return;\n        }\n        // iff possible, quickly update from cache\n        const cached = this._inlayHintsCache.get(model);\n        if (cached) {\n            this._updateHintsDecorators([model.getFullModelRange()], cached);\n        }\n        this._sessionDisposables.add(toDisposable(() => {\n            // cache items when switching files etc\n            if (!model.isDisposed()) {\n                this._cacheHintsForFastRestore(model);\n            }\n        }));\n        let cts;\n        const watchedProviders = new Set();\n        const scheduler = new RunOnceScheduler(() => __awaiter(this, void 0, void 0, function* () {\n            const t1 = Date.now();\n            cts === null || cts === void 0 ? void 0 : cts.dispose(true);\n            cts = new CancellationTokenSource();\n            const listener = model.onWillDispose(() => cts === null || cts === void 0 ? void 0 : cts.cancel());\n            try {\n                const myToken = cts.token;\n                const inlayHints = yield InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider, model, this._getHintsRanges(), myToken);\n                scheduler.delay = this._debounceInfo.update(model, Date.now() - t1);\n                if (myToken.isCancellationRequested) {\n                    inlayHints.dispose();\n                    return;\n                }\n                // listen to provider changes\n                for (const provider of inlayHints.provider) {\n                    if (typeof provider.onDidChangeInlayHints === 'function' && !watchedProviders.has(provider)) {\n                        watchedProviders.add(provider);\n                        this._sessionDisposables.add(provider.onDidChangeInlayHints(() => {\n                            if (!scheduler.isScheduled()) { // ignore event when request is already scheduled\n                                scheduler.schedule();\n                            }\n                        }));\n                    }\n                }\n                this._sessionDisposables.add(inlayHints);\n                this._updateHintsDecorators(inlayHints.ranges, inlayHints.items);\n                this._cacheHintsForFastRestore(model);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                cts.dispose();\n                listener.dispose();\n            }\n        }), this._debounceInfo.get(model));\n        this._sessionDisposables.add(scheduler);\n        this._sessionDisposables.add(toDisposable(() => cts === null || cts === void 0 ? void 0 : cts.dispose(true)));\n        scheduler.schedule(0);\n        this._sessionDisposables.add(this._editor.onDidScrollChange((e) => {\n            // update when scroll position changes\n            // uses scrollTopChanged has weak heuristic to differenatiate between scrolling due to\n            // typing or due to \"actual\" scrolling\n            if (e.scrollTopChanged || !scheduler.isScheduled()) {\n                scheduler.schedule();\n            }\n        }));\n        this._sessionDisposables.add(this._editor.onDidChangeModelContent((e) => {\n            // update less aggressive when typing\n            const delay = Math.max(scheduler.delay, 1250);\n            scheduler.schedule(delay);\n        }));\n        if (options.enabled === 'on') {\n            // different \"on\" modes: always\n            this._activeRenderMode = 0 /* RenderMode.Normal */;\n        }\n        else {\n            // different \"on\" modes: offUnlessPressed, or onUnlessPressed\n            let defaultMode;\n            let altMode;\n            if (options.enabled === 'onUnlessPressed') {\n                defaultMode = 0 /* RenderMode.Normal */;\n                altMode = 1 /* RenderMode.Invisible */;\n            }\n            else {\n                defaultMode = 1 /* RenderMode.Invisible */;\n                altMode = 0 /* RenderMode.Normal */;\n            }\n            this._activeRenderMode = defaultMode;\n            this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(e => {\n                if (!this._editor.hasModel()) {\n                    return;\n                }\n                const newRenderMode = e.altKey && e.ctrlKey ? altMode : defaultMode;\n                if (newRenderMode !== this._activeRenderMode) {\n                    this._activeRenderMode = newRenderMode;\n                    const model = this._editor.getModel();\n                    const copies = this._copyInlayHintsWithCurrentAnchor(model);\n                    this._updateHintsDecorators([model.getFullModelRange()], copies);\n                    scheduler.schedule(0);\n                }\n            }));\n        }\n        // mouse gestures\n        this._sessionDisposables.add(this._installDblClickGesture(() => scheduler.schedule(0)));\n        this._sessionDisposables.add(this._installLinkGesture());\n        this._sessionDisposables.add(this._installContextMenu());\n    }\n    _installLinkGesture() {\n        const store = new DisposableStore();\n        const gesture = store.add(new ClickLinkGesture(this._editor));\n        // let removeHighlight = () => { };\n        const sessionStore = new DisposableStore();\n        store.add(sessionStore);\n        store.add(gesture.onMouseMoveOrRelevantKeyDown(e => {\n            const [mouseEvent] = e;\n            const labelPart = this._getInlayHintLabelPart(mouseEvent);\n            const model = this._editor.getModel();\n            if (!labelPart || !model) {\n                sessionStore.clear();\n                return;\n            }\n            // resolve the item\n            const cts = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cts.dispose(true)));\n            labelPart.item.resolve(cts.token);\n            // render link => when the modifier is pressed and when there is a command or location\n            this._activeInlayHintPart = labelPart.part.command || labelPart.part.location\n                ? new ActiveInlayHintInfo(labelPart, mouseEvent.hasTriggerModifier)\n                : undefined;\n            const lineNumber = labelPart.item.hint.position.lineNumber;\n            const range = new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber));\n            const lineHints = this._getInlineHintsForRange(range);\n            this._updateHintsDecorators([range], lineHints);\n            sessionStore.add(toDisposable(() => {\n                this._activeInlayHintPart = undefined;\n                this._updateHintsDecorators([range], lineHints);\n            }));\n        }));\n        store.add(gesture.onCancel(() => sessionStore.clear()));\n        store.add(gesture.onExecute((e) => __awaiter(this, void 0, void 0, function* () {\n            const label = this._getInlayHintLabelPart(e);\n            if (label) {\n                const part = label.part;\n                if (part.location) {\n                    // location -> execute go to def\n                    this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, part.location);\n                }\n                else if (languages.Command.is(part.command)) {\n                    // command -> execute it\n                    yield this._invokeCommand(part.command, label.item);\n                }\n            }\n        })));\n        return store;\n    }\n    _getInlineHintsForRange(range) {\n        const lineHints = new Set();\n        for (const data of this._decorationsMetadata.values()) {\n            if (range.containsRange(data.item.anchor.range)) {\n                lineHints.add(data.item);\n            }\n        }\n        return Array.from(lineHints);\n    }\n    _installDblClickGesture(updateInlayHints) {\n        return this._editor.onMouseUp((e) => __awaiter(this, void 0, void 0, function* () {\n            if (e.event.detail !== 2) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (!part) {\n                return;\n            }\n            e.event.preventDefault();\n            yield part.item.resolve(CancellationToken.None);\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                const edits = part.item.hint.textEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text));\n                this._editor.executeEdits('inlayHint.default', edits);\n                updateInlayHints();\n            }\n        }));\n    }\n    _installContextMenu() {\n        return this._editor.onContextMenu((e) => __awaiter(this, void 0, void 0, function* () {\n            if (!(e.event.target instanceof HTMLElement)) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (part) {\n                yield this._instaService.invokeFunction(showGoToContextMenu, this._editor, e.event.target, part);\n            }\n        }));\n    }\n    _getInlayHintLabelPart(e) {\n        var _a;\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return undefined;\n        }\n        const options = (_a = e.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (options instanceof ModelDecorationInjectedTextOptions && (options === null || options === void 0 ? void 0 : options.attachedData) instanceof RenderedInlayHintLabelPart) {\n            return options.attachedData;\n        }\n        return undefined;\n    }\n    _invokeCommand(command, item) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n            }\n            catch (err) {\n                this._notificationService.notify({\n                    severity: Severity.Error,\n                    source: item.provider.displayName,\n                    message: err\n                });\n            }\n        });\n    }\n    _cacheHintsForFastRestore(model) {\n        const hints = this._copyInlayHintsWithCurrentAnchor(model);\n        this._inlayHintsCache.set(model, hints);\n    }\n    // return inlay hints but with an anchor that reflects \"updates\"\n    // that happened after receiving them, e.g adding new lines before a hint\n    _copyInlayHintsWithCurrentAnchor(model) {\n        const items = new Map();\n        for (const [id, obj] of this._decorationsMetadata) {\n            if (items.has(obj.item)) {\n                // an inlay item can be rendered as multiple decorations\n                // but they will all uses the same range\n                continue;\n            }\n            const range = model.getDecorationRange(id);\n            if (range) {\n                // update range with whatever the editor has tweaked it to\n                const anchor = new InlayHintAnchor(range, obj.item.anchor.direction);\n                const copy = obj.item.with({ anchor });\n                items.set(obj.item, copy);\n            }\n        }\n        return Array.from(items.values());\n    }\n    _getHintsRanges() {\n        const extra = 30;\n        const model = this._editor.getModel();\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        const result = [];\n        for (const range of visibleRanges.sort(Range.compareRangesUsingStarts)) {\n            const extendedRange = model.validateRange(new Range(range.startLineNumber - extra, range.startColumn, range.endLineNumber + extra, range.endColumn));\n            if (result.length === 0 || !Range.areIntersectingOrTouching(result[result.length - 1], extendedRange)) {\n                result.push(extendedRange);\n            }\n            else {\n                result[result.length - 1] = Range.plusRange(result[result.length - 1], extendedRange);\n            }\n        }\n        return result;\n    }\n    _updateHintsDecorators(ranges, items) {\n        var _a, _b;\n        // utils to collect/create injected text decorations\n        const newDecorationsData = [];\n        const addInjectedText = (item, ref, content, cursorStops, attachedData) => {\n            const opts = {\n                content,\n                inlineClassNameAffectsLetterSpacing: true,\n                inlineClassName: ref.className,\n                cursorStops,\n                attachedData\n            };\n            newDecorationsData.push({\n                item,\n                classNameRef: ref,\n                decoration: {\n                    range: item.anchor.range,\n                    options: {\n                        // className: \"rangeHighlight\", // DEBUG highlight to see to what range a hint is attached\n                        description: 'InlayHint',\n                        showIfCollapsed: item.anchor.range.isEmpty(),\n                        collapseOnReplaceEdit: !item.anchor.range.isEmpty(),\n                        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n                        [item.anchor.direction]: this._activeRenderMode === 0 /* RenderMode.Normal */ ? opts : undefined\n                    }\n                }\n            });\n        };\n        const addInjectedWhitespace = (item, isLast) => {\n            const marginRule = this._ruleFactory.createClassNameRef({\n                width: `${(fontSize / 3) | 0}px`,\n                display: 'inline-block'\n            });\n            addInjectedText(item, marginRule, '\\u200a', isLast ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None);\n        };\n        //\n        const { fontSize, fontFamily, padding, isUniform } = this._getLayoutInfo();\n        const fontFamilyVar = '--code-editorInlayHintsFontFamily';\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\n        for (const item of items) {\n            // whitespace leading the actual label\n            if (item.hint.paddingLeft) {\n                addInjectedWhitespace(item, false);\n            }\n            // the label with its parts\n            const parts = typeof item.hint.label === 'string'\n                ? [{ label: item.hint.label }]\n                : item.hint.label;\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n                const isFirst = i === 0;\n                const isLast = i === parts.length - 1;\n                const cssProperties = {\n                    fontSize: `${fontSize}px`,\n                    fontFamily: `var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,\n                    verticalAlign: isUniform ? 'baseline' : 'middle',\n                };\n                if (isNonEmptyArray(item.hint.textEdits)) {\n                    cssProperties.cursor = 'default';\n                }\n                this._fillInColors(cssProperties, item.hint);\n                if ((part.command || part.location) && ((_a = this._activeInlayHintPart) === null || _a === void 0 ? void 0 : _a.part.item) === item && this._activeInlayHintPart.part.index === i) {\n                    // active link!\n                    cssProperties.textDecoration = 'underline';\n                    if (this._activeInlayHintPart.hasTriggerModifier) {\n                        cssProperties.color = themeColorFromId(colors.editorActiveLinkForeground);\n                        cssProperties.cursor = 'pointer';\n                    }\n                }\n                if (padding) {\n                    if (isFirst && isLast) {\n                        // only element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isFirst) {\n                        // first element\n                        cssProperties.padding = `1px 0 1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px 0 0 ${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isLast) {\n                        // last element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px 1px 0`;\n                        cssProperties.borderRadius = `0 ${(fontSize / 4) | 0}px ${(fontSize / 4) | 0}px 0`;\n                    }\n                    else {\n                        cssProperties.padding = `1px 0 1px 0`;\n                    }\n                }\n                addInjectedText(item, this._ruleFactory.createClassNameRef(cssProperties), fixSpace(part.label), isLast && !item.hint.paddingRight ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None, new RenderedInlayHintLabelPart(item, i));\n            }\n            // whitespace trailing the actual label\n            if (item.hint.paddingRight) {\n                addInjectedWhitespace(item, true);\n            }\n            if (newDecorationsData.length > InlayHintsController._MAX_DECORATORS) {\n                break;\n            }\n        }\n        // collect all decoration ids that are affected by the ranges\n        // and only update those decorations\n        const decorationIdsToReplace = [];\n        for (const range of ranges) {\n            for (const { id } of (_b = this._editor.getDecorationsInRange(range)) !== null && _b !== void 0 ? _b : []) {\n                const metadata = this._decorationsMetadata.get(id);\n                if (metadata) {\n                    decorationIdsToReplace.push(id);\n                    metadata.classNameRef.dispose();\n                    this._decorationsMetadata.delete(id);\n                }\n            }\n        }\n        this._editor.changeDecorations(accessor => {\n            const newDecorationIds = accessor.deltaDecorations(decorationIdsToReplace, newDecorationsData.map(d => d.decoration));\n            for (let i = 0; i < newDecorationIds.length; i++) {\n                const data = newDecorationsData[i];\n                this._decorationsMetadata.set(newDecorationIds[i], data);\n            }\n        });\n    }\n    _fillInColors(props, hint) {\n        if (hint.kind === languages.InlayHintKind.Parameter) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintParameterBackground);\n            props.color = themeColorFromId(colors.editorInlayHintParameterForeground);\n        }\n        else if (hint.kind === languages.InlayHintKind.Type) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintTypeBackground);\n            props.color = themeColorFromId(colors.editorInlayHintTypeForeground);\n        }\n        else {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintBackground);\n            props.color = themeColorFromId(colors.editorInlayHintForeground);\n        }\n    }\n    _getLayoutInfo() {\n        const options = this._editor.getOption(129 /* EditorOption.inlayHints */);\n        const padding = options.padding;\n        const editorFontSize = this._editor.getOption(48 /* EditorOption.fontSize */);\n        const editorFontFamily = this._editor.getOption(45 /* EditorOption.fontFamily */);\n        let fontSize = options.fontSize;\n        if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\n            fontSize = editorFontSize;\n        }\n        const fontFamily = options.fontFamily || editorFontFamily;\n        const isUniform = !padding\n            && fontFamily === editorFontFamily\n            && fontSize === editorFontSize;\n        return { fontSize, fontFamily, padding, isUniform };\n    }\n    _removeAllDecorations() {\n        this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));\n        for (const obj of this._decorationsMetadata.values()) {\n            obj.classNameRef.dispose();\n        }\n        this._decorationsMetadata.clear();\n    }\n};\nInlayHintsController.ID = 'editor.contrib.InlayHints';\nInlayHintsController._MAX_DECORATORS = 1500;\nInlayHintsController = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, IInlayHintsCache),\n    __param(4, ICommandService),\n    __param(5, INotificationService),\n    __param(6, IInstantiationService)\n], InlayHintsController);\nexport { InlayHintsController };\n// Prevents the view from potentially visible whitespace\nfunction fixSpace(str) {\n    const noBreakWhitespace = '\\xa0';\n    return str.replace(/[ \\t]/g, noBreakWhitespace);\n}\nCommandsRegistry.registerCommand('_executeInlayHintProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, range] = args;\n    assertType(URI.isUri(uri));\n    assertType(Range.isIRange(range));\n    const { inlayHintsProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const model = yield InlayHintsFragments.create(inlayHintsProvider, ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\n        const result = model.items.map(i => i.hint);\n        setTimeout(() => model.dispose(), 0); // dispose after sending to ext host\n        return result;\n    }\n    finally {\n        ref.dispose();\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var m = o[Symbol.asyncIterator], i;\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { getHover } from '../../hover/browser/getHover.js';\nimport { MarkdownHover, MarkdownHoverParticipant } from '../../hover/browser/markdownHoverParticipant.js';\nimport { RenderedInlayHintLabelPart, InlayHintsController } from './inlayHintsController.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { asCommandLink } from './inlayHints.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nclass InlayHintsHoverAnchor extends HoverForeignElementAnchor {\n    constructor(part, owner) {\n        super(10, owner, part.item.anchor.range);\n        this.part = part;\n    }\n}\nlet InlayHintsHover = class InlayHintsHover extends MarkdownHoverParticipant {\n    constructor(editor, languageService, openerService, configurationService, _resolverService, languageFeaturesService) {\n        super(editor, languageService, openerService, configurationService, languageFeaturesService);\n        this._resolverService = _resolverService;\n        this.hoverOrdinal = 6;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        var _a;\n        const controller = InlayHintsController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        if (mouseEvent.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return null;\n        }\n        const options = (_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (!(options instanceof ModelDecorationInjectedTextOptions && options.attachedData instanceof RenderedInlayHintLabelPart)) {\n            return null;\n        }\n        return new InlayHintsHoverAnchor(options.attachedData, this);\n    }\n    computeSync() {\n        return [];\n    }\n    computeAsync(anchor, _lineDecorations, token) {\n        if (!(anchor instanceof InlayHintsHoverAnchor)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        return new AsyncIterableObject((executor) => __awaiter(this, void 0, void 0, function* () {\n            var e_1, _a;\n            const { part } = anchor;\n            yield part.item.resolve(token);\n            if (token.isCancellationRequested) {\n                return;\n            }\n            // (1) Inlay Tooltip\n            let itemTooltip;\n            if (typeof part.item.hint.tooltip === 'string') {\n                itemTooltip = new MarkdownString().appendText(part.item.hint.tooltip);\n            }\n            else if (part.item.hint.tooltip) {\n                itemTooltip = part.item.hint.tooltip;\n            }\n            if (itemTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [itemTooltip], 0));\n            }\n            // (1.2) Inlay dbl-click gesture\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(localize('hint.dbl', \"Double click to insert\"))], 10001));\n            }\n            // (2) Inlay Label Part Tooltip\n            let partTooltip;\n            if (typeof part.part.tooltip === 'string') {\n                partTooltip = new MarkdownString().appendText(part.part.tooltip);\n            }\n            else if (part.part.tooltip) {\n                partTooltip = part.part.tooltip;\n            }\n            if (partTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [partTooltip], 1));\n            }\n            // (2.2) Inlay Label Part Help Hover\n            if (part.part.location || part.part.command) {\n                let linkHint;\n                const useMetaKey = this._editor.getOption(72 /* EditorOption.multiCursorModifier */) === 'altKey';\n                const kb = useMetaKey\n                    ? platform.isMacintosh\n                        ? localize('links.navigate.kb.meta.mac', \"cmd + click\")\n                        : localize('links.navigate.kb.meta', \"ctrl + click\")\n                    : platform.isMacintosh\n                        ? localize('links.navigate.kb.alt.mac', \"option + click\")\n                        : localize('links.navigate.kb.alt', \"alt + click\");\n                if (part.part.location && part.part.command) {\n                    linkHint = new MarkdownString().appendText(localize('hint.defAndCommand', 'Go to Definition ({0}), right click for more', kb));\n                }\n                else if (part.part.location) {\n                    linkHint = new MarkdownString().appendText(localize('hint.def', 'Go to Definition ({0})', kb));\n                }\n                else if (part.part.command) {\n                    linkHint = new MarkdownString(`[${localize('hint.cmd', \"Execute Command\")}](${asCommandLink(part.part.command)} \"${part.part.command.title}\") (${kb})`, { isTrusted: true });\n                }\n                if (linkHint) {\n                    executor.emitOne(new MarkdownHover(this, anchor.range, [linkHint], 10000));\n                }\n            }\n            // (3) Inlay Label Part Location tooltip\n            const iterable = yield this._resolveInlayHintLabelPartHover(part, token);\n            try {\n                for (var iterable_1 = __asyncValues(iterable), iterable_1_1; iterable_1_1 = yield iterable_1.next(), !iterable_1_1.done;) {\n                    const item = iterable_1_1.value;\n                    executor.emitOne(item);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) yield _a.call(iterable_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }));\n    }\n    _resolveInlayHintLabelPartHover(part, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!part.part.location) {\n                return AsyncIterableObject.EMPTY;\n            }\n            const { uri, range } = part.part.location;\n            const ref = yield this._resolverService.createModelReference(uri);\n            try {\n                const model = ref.object.textEditorModel;\n                if (!this._languageFeaturesService.hoverProvider.has(model)) {\n                    return AsyncIterableObject.EMPTY;\n                }\n                return getHover(this._languageFeaturesService.hoverProvider, model, new Position(range.startLineNumber, range.startColumn), token)\n                    .filter(item => !isEmptyMarkdownString(item.hover.contents))\n                    .map(item => new MarkdownHover(this, part.item.anchor.range, item.hover.contents, 2 + item.ordinal));\n            }\n            finally {\n                ref.dispose();\n            }\n        });\n    }\n};\nInlayHintsHover = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ITextModelService),\n    __param(5, ILanguageFeaturesService)\n], InlayHintsHover);\nexport { InlayHintsHover };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { InlayHintsController } from './inlayHintsController.js';\nimport { InlayHintsHover } from './inlayHintsHover.js';\nregisterEditorContribution(InlayHintsController.ID, InlayHintsController);\nHoverParticipantRegistry.register(InlayHintsHover);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Selection } from '../../../common/core/selection.js';\nexport class InPlaceReplaceCommand {\n    constructor(editRange, originalSelection, text) {\n        this._editRange = editRange;\n        this._originalSelection = originalSelection;\n        this._text = text;\n    }\n    getEditOperations(model, builder) {\n        builder.addTrackedEditOperation(this._editRange, this._text);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        const srcRange = inverseEditOperations[0].range;\n        if (!this._originalSelection.isEmpty()) {\n            // Preserve selection and extends to typed text\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\n        }\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { EditorState } from '../../editorState/browser/editorState.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { editorBracketMatchBorder } from '../../../common/core/editorColorRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\nlet InPlaceReplaceController = class InPlaceReplaceController {\n    constructor(editor, editorWorkerService) {\n        this.editor = editor;\n        this.editorWorkerService = editorWorkerService;\n        this.decorations = this.editor.createDecorationsCollection();\n    }\n    static get(editor) {\n        return editor.getContribution(InPlaceReplaceController.ID);\n    }\n    dispose() {\n    }\n    run(source, up) {\n        // cancel any pending request\n        if (this.currentRequest) {\n            this.currentRequest.cancel();\n        }\n        const editorSelection = this.editor.getSelection();\n        const model = this.editor.getModel();\n        if (!model || !editorSelection) {\n            return undefined;\n        }\n        let selection = editorSelection;\n        if (selection.startLineNumber !== selection.endLineNumber) {\n            // Can't accept multiline selection\n            return undefined;\n        }\n        const state = new EditorState(this.editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const modelURI = model.uri;\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\n            return Promise.resolve(undefined);\n        }\n        this.currentRequest = createCancelablePromise(token => this.editorWorkerService.navigateValueSet(modelURI, selection, up));\n        return this.currentRequest.then(result => {\n            if (!result || !result.range || !result.value) {\n                // No proper result\n                return;\n            }\n            if (!state.validate(this.editor)) {\n                // state has changed\n                return;\n            }\n            // Selection\n            const editRange = Range.lift(result.range);\n            let highlightRange = result.range;\n            const diff = result.value.length - (selection.endColumn - selection.startColumn);\n            // highlight\n            highlightRange = {\n                startLineNumber: highlightRange.startLineNumber,\n                startColumn: highlightRange.startColumn,\n                endLineNumber: highlightRange.endLineNumber,\n                endColumn: highlightRange.startColumn + result.value.length\n            };\n            if (diff > 1) {\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\n            }\n            // Insert new text\n            const command = new InPlaceReplaceCommand(editRange, selection, result.value);\n            this.editor.pushUndoStop();\n            this.editor.executeCommand(source, command);\n            this.editor.pushUndoStop();\n            // add decoration\n            this.decorations.set([{\n                    range: highlightRange,\n                    options: InPlaceReplaceController.DECORATION\n                }]);\n            // remove decoration after delay\n            if (this.decorationRemover) {\n                this.decorationRemover.cancel();\n            }\n            this.decorationRemover = timeout(350);\n            this.decorationRemover.then(() => this.decorations.clear()).catch(onUnexpectedError);\n        }).catch(onUnexpectedError);\n    }\n};\nInPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\nInPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\n    description: 'in-place-replace',\n    className: 'valueSetReplacement'\n});\nInPlaceReplaceController = __decorate([\n    __param(1, IEditorWorkerService)\n], InPlaceReplaceController);\nclass InPlaceReplaceUp extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.up',\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\n            alias: 'Replace with Previous Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 82 /* KeyCode.Comma */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, true);\n    }\n}\nclass InPlaceReplaceDown extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.down',\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\n            alias: 'Replace with Next Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 84 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, false);\n    }\n}\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController);\nregisterEditorAction(InPlaceReplaceUp);\nregisterEditorAction(InPlaceReplaceDown);\nregisterThemingParticipant((theme, collector) => {\n    const border = theme.getColor(editorBracketMatchBorder);\n    if (border) {\n        collector.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${border}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { CursorMoveCommands } from '../../../common/cursor/cursorMoveCommands.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nexport class ExpandLineSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'expandLineSelection',\n            label: nls.localize('expandLineSelection', \"Expand Line Selection\"),\n            alias: 'Expand Line Selection',\n            precondition: undefined,\n            kbOpts: {\n                weight: 0 /* KeybindingWeight.EditorCore */,\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */\n            },\n        });\n    }\n    run(_accessor, editor, args) {\n        args = args || {};\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        viewModel.model.pushStackElement();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.expandLineSelection(viewModel, viewModel.getCursorStates()));\n        viewModel.revealPrimaryCursor(args.source, true);\n    }\n}\nregisterEditorAction(ExpandLineSelectionAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../base/common/strings.js';\nimport { EditOperation } from '../core/editOperation.js';\nimport { Range } from '../core/range.js';\nexport class TrimTrailingWhitespaceCommand {\n    constructor(selection, cursors) {\n        this._selection = selection;\n        this._cursors = cursors;\n        this._selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        const ops = trimTrailingWhitespace(model, this._cursors);\n        for (let i = 0, len = ops.length; i < len; i++) {\n            const op = ops[i];\n            builder.addEditOperation(op.range, op.text);\n        }\n        this._selectionId = builder.trackSelection(this._selection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\n/**\n * Generate commands for trimming trailing whitespace on a model and ignore lines on which cursors are sitting.\n */\nexport function trimTrailingWhitespace(model, cursors) {\n    // Sort cursors ascending\n    cursors.sort((a, b) => {\n        if (a.lineNumber === b.lineNumber) {\n            return a.column - b.column;\n        }\n        return a.lineNumber - b.lineNumber;\n    });\n    // Reduce multiple cursors on the same line and only keep the last one on the line\n    for (let i = cursors.length - 2; i >= 0; i--) {\n        if (cursors[i].lineNumber === cursors[i + 1].lineNumber) {\n            // Remove cursor at `i`\n            cursors.splice(i, 1);\n        }\n    }\n    const r = [];\n    let rLen = 0;\n    let cursorIndex = 0;\n    const cursorLen = cursors.length;\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        const lineContent = model.getLineContent(lineNumber);\n        const maxLineColumn = lineContent.length + 1;\n        let minEditColumn = 0;\n        if (cursorIndex < cursorLen && cursors[cursorIndex].lineNumber === lineNumber) {\n            minEditColumn = cursors[cursorIndex].column;\n            cursorIndex++;\n            if (minEditColumn === maxLineColumn) {\n                // The cursor is at the end of the line => no edits for sure on this line\n                continue;\n            }\n        }\n        if (lineContent.length === 0) {\n            continue;\n        }\n        const lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\n        let fromColumn = 0;\n        if (lastNonWhitespaceIndex === -1) {\n            // Entire line is whitespace\n            fromColumn = 1;\n        }\n        else if (lastNonWhitespaceIndex !== lineContent.length - 1) {\n            // There is trailing whitespace\n            fromColumn = lastNonWhitespaceIndex + 2;\n        }\n        else {\n            // There is no trailing whitespace\n            continue;\n        }\n        fromColumn = Math.max(minEditColumn, fromColumn);\n        r[rLen++] = EditOperation.delete(new Range(lineNumber, fromColumn, lineNumber, maxLineColumn));\n    }\n    return r;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class CopyLinesCommand {\n    constructor(selection, isCopyingDown, noop) {\n        this._selection = selection;\n        this._isCopyingDown = isCopyingDown;\n        this._noop = noop || false;\n        this._selectionDirection = 0 /* SelectionDirection.LTR */;\n        this._selectionId = null;\n        this._startLineNumberDelta = 0;\n        this._endLineNumberDelta = 0;\n    }\n    getEditOperations(model, builder) {\n        let s = this._selection;\n        this._startLineNumberDelta = 0;\n        this._endLineNumberDelta = 0;\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._endLineNumberDelta = 1;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const sourceLines = [];\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\n            sourceLines.push(model.getLineContent(i));\n        }\n        const sourceText = sourceLines.join('\\n');\n        if (sourceText === '') {\n            // Duplicating empty line\n            if (this._isCopyingDown) {\n                this._startLineNumberDelta++;\n                this._endLineNumberDelta++;\n            }\n        }\n        if (this._noop) {\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber + 1, 1), s.endLineNumber === model.getLineCount() ? '' : '\\n');\n        }\n        else {\n            if (!this._isCopyingDown) {\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\n            }\n            else {\n                builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n        this._selectionDirection = this._selection.getDirection();\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\n            let startLineNumber = result.startLineNumber;\n            let startColumn = result.startColumn;\n            let endLineNumber = result.endLineNumber;\n            let endColumn = result.endColumn;\n            if (this._startLineNumberDelta !== 0) {\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\n                startColumn = 1;\n            }\n            if (this._endLineNumberDelta !== 0) {\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\n                endColumn = 1;\n            }\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as strings from '../../../../base/common/strings.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IndentAction } from '../../../common/languages/languageConfiguration.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as indentUtils from '../../indentation/browser/indentUtils.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nimport { getEnterAction } from '../../../common/languages/enterAction.js';\nlet MoveLinesCommand = class MoveLinesCommand {\n    constructor(selection, isMovingDown, autoIndent, _languageConfigurationService) {\n        this._languageConfigurationService = _languageConfigurationService;\n        this._selection = selection;\n        this._isMovingDown = isMovingDown;\n        this._autoIndent = autoIndent;\n        this._selectionId = null;\n        this._moveEndLineSelectionShrink = false;\n    }\n    getEditOperations(model, builder) {\n        const modelLineCount = model.getLineCount();\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\n            this._selectionId = builder.trackSelection(this._selection);\n            return;\n        }\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\n            this._selectionId = builder.trackSelection(this._selection);\n            return;\n        }\n        this._moveEndPositionDown = false;\n        let s = this._selection;\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._moveEndPositionDown = true;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\n        const virtualModel = {\n            tokenization: {\n                getLineTokens: (lineNumber) => {\n                    return model.tokenization.getLineTokens(lineNumber);\n                },\n                getLanguageId: () => {\n                    return model.getLanguageId();\n                },\n                getLanguageIdAtPosition: (lineNumber, column) => {\n                    return model.getLanguageIdAtPosition(lineNumber, column);\n                },\n            },\n            getLineContent: null,\n        };\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\n            // Current line is empty\n            const lineNumber = s.startLineNumber;\n            const otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\n                // Other line number is empty too, so no editing is needed\n                // Add a no-op to force running by the model\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\n            }\n            else {\n                // Type content from other line number on line number\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\n                // Remove content from other line number\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\n            }\n            // Track selection at the other line number\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\n        }\n        else {\n            let movingLineNumber;\n            let movingLineText;\n            if (this._isMovingDown) {\n                movingLineNumber = s.endLineNumber + 1;\n                movingLineText = model.getLineContent(movingLineNumber);\n                // Delete line that needs to be moved\n                builder.addEditOperation(new Range(movingLineNumber - 1, model.getLineMaxColumn(movingLineNumber - 1), movingLineNumber, model.getLineMaxColumn(movingLineNumber)), null);\n                let insertingText = movingLineText;\n                if (this.shouldAutoIndent(model, s)) {\n                    const movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber, s.startLineNumber - 1);\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\n                    if (movingLineMatchResult !== null) {\n                        const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\n                        const newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                        const newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                        insertingText = newIndentation + this.trimLeft(movingLineText);\n                    }\n                    else {\n                        // no enter rule matches, let's check indentatin rules then.\n                        virtualModel.getLineContent = (lineNumber) => {\n                            if (lineNumber === s.startLineNumber) {\n                                return model.getLineContent(movingLineNumber);\n                            }\n                            else {\n                                return model.getLineContent(lineNumber);\n                            }\n                        };\n                        const indentOfMovingLine = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber, indentConverter, this._languageConfigurationService);\n                        if (indentOfMovingLine !== null) {\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                                insertingText = newIndentation + this.trimLeft(movingLineText);\n                            }\n                        }\n                    }\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\n                    // to s.startLineNumber\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\n                    const ret = this.matchEnterRuleMovingDown(model, indentConverter, tabSize, s.startLineNumber, movingLineNumber, insertingText);\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\n                    if (ret !== null) {\n                        if (ret !== 0) {\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\n                        }\n                    }\n                    else {\n                        // it doesn't match onEnter rules, let's check indentation rules then.\n                        virtualModel.getLineContent = (lineNumber) => {\n                            if (lineNumber === s.startLineNumber) {\n                                return insertingText;\n                            }\n                            else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\n                                return model.getLineContent(lineNumber - 1);\n                            }\n                            else {\n                                return model.getLineContent(lineNumber);\n                            }\n                        };\n                        const newIndentatOfMovingBlock = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber + 1, indentConverter, this._languageConfigurationService);\n                        if (newIndentatOfMovingBlock !== null) {\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\n                            }\n                        }\n                    }\n                }\n                else {\n                    // Insert line that needs to be moved before\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\n                }\n            }\n            else {\n                movingLineNumber = s.startLineNumber - 1;\n                movingLineText = model.getLineContent(movingLineNumber);\n                // Delete line that needs to be moved\n                builder.addEditOperation(new Range(movingLineNumber, 1, movingLineNumber + 1, 1), null);\n                // Insert line that needs to be moved after\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\n                if (this.shouldAutoIndent(model, s)) {\n                    virtualModel.getLineContent = (lineNumber) => {\n                        if (lineNumber === movingLineNumber) {\n                            return model.getLineContent(s.startLineNumber);\n                        }\n                        else {\n                            return model.getLineContent(lineNumber);\n                        }\n                    };\n                    const ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\n                    if (ret !== null) {\n                        if (ret !== 0) {\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\n                        }\n                    }\n                    else {\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\n                        const indentOfFirstLine = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber, indentConverter, this._languageConfigurationService);\n                        if (indentOfFirstLine !== null) {\n                            // adjust the indentation of the moving block\n                            const oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n    }\n    buildIndentConverter(tabSize, indentSize, insertSpaces) {\n        return {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n    }\n    parseEnterResult(model, indentConverter, tabSize, line, enter) {\n        if (enter) {\n            let enterPrefix = enter.indentation;\n            if (enter.indentAction === IndentAction.None) {\n                enterPrefix = enter.indentation + enter.appendText;\n            }\n            else if (enter.indentAction === IndentAction.Indent) {\n                enterPrefix = enter.indentation + enter.appendText;\n            }\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\n                enterPrefix = enter.indentation;\n            }\n            else if (enter.indentAction === IndentAction.Outdent) {\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\n            }\n            const movingLineText = model.getLineContent(line);\n            if (this.trimLeft(movingLineText).indexOf(this.trimLeft(enterPrefix)) >= 0) {\n                const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\n                let newIndentation = strings.getLeadingWhitespace(enterPrefix);\n                const indentMetadataOfMovelingLine = getIndentMetadata(model, line, this._languageConfigurationService);\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* IndentConsts.DECREASE_MASK */) {\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\n                }\n                const newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                return newSpaceCnt - oldSpaceCnt;\n            }\n        }\n        return null;\n    }\n    /**\n     *\n     * @param model\n     * @param indentConverter\n     * @param tabSize\n     * @param line the line moving down\n     * @param futureAboveLineNumber the line which will be at the `line` position\n     * @param futureAboveLineText\n     */\n    matchEnterRuleMovingDown(model, indentConverter, tabSize, line, futureAboveLineNumber, futureAboveLineText) {\n        if (strings.lastNonWhitespaceIndex(futureAboveLineText) >= 0) {\n            // break\n            const maxColumn = model.getLineMaxColumn(futureAboveLineNumber);\n            const enter = getEnterAction(this._autoIndent, model, new Range(futureAboveLineNumber, maxColumn, futureAboveLineNumber, maxColumn), this._languageConfigurationService);\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n        }\n        else {\n            // go upwards, starting from `line - 1`\n            let validPrecedingLine = line - 1;\n            while (validPrecedingLine >= 1) {\n                const lineContent = model.getLineContent(validPrecedingLine);\n                const nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\n                if (nonWhitespaceIdx >= 0) {\n                    break;\n                }\n                validPrecedingLine--;\n            }\n            if (validPrecedingLine < 1 || line > model.getLineCount()) {\n                return null;\n            }\n            const maxColumn = model.getLineMaxColumn(validPrecedingLine);\n            const enter = getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn), this._languageConfigurationService);\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n        }\n    }\n    matchEnterRule(model, indentConverter, tabSize, line, oneLineAbove, previousLineText) {\n        let validPrecedingLine = oneLineAbove;\n        while (validPrecedingLine >= 1) {\n            // ship empty lines as empty lines just inherit indentation\n            let lineContent;\n            if (validPrecedingLine === oneLineAbove && previousLineText !== undefined) {\n                lineContent = previousLineText;\n            }\n            else {\n                lineContent = model.getLineContent(validPrecedingLine);\n            }\n            const nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\n            if (nonWhitespaceIdx >= 0) {\n                break;\n            }\n            validPrecedingLine--;\n        }\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\n            return null;\n        }\n        const maxColumn = model.getLineMaxColumn(validPrecedingLine);\n        const enter = getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn), this._languageConfigurationService);\n        return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n    }\n    trimLeft(str) {\n        return str.replace(/^\\s+/, '');\n    }\n    shouldAutoIndent(model, selection) {\n        if (this._autoIndent < 4 /* EditorAutoIndentStrategy.Full */) {\n            return false;\n        }\n        // if it's not easy to tokenize, we stop auto indent.\n        if (!model.tokenization.isCheapToTokenize(selection.startLineNumber)) {\n            return false;\n        }\n        const languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\n        const languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\n            return false;\n        }\n        if (this._languageConfigurationService.getLanguageConfiguration(languageAtSelectionStart).indentRulesSupport === null) {\n            return false;\n        }\n        return true;\n    }\n    getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, offset) {\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\n            const lineContent = model.getLineContent(i);\n            const originalIndent = strings.getLeadingWhitespace(lineContent);\n            const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n            const newSpacesCnt = originalSpacesCnt + offset;\n            const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n            if (newIndent !== originalIndent) {\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\n                    // as users select part of the original indent white spaces\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\n                    this._moveEndLineSelectionShrink = true;\n                }\n            }\n        }\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._moveEndPositionDown) {\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\n        }\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\n            result = result.setEndPosition(result.endLineNumber, 2);\n        }\n        return result;\n    }\n};\nMoveLinesCommand = __decorate([\n    __param(3, ILanguageConfigurationService)\n], MoveLinesCommand);\nexport { MoveLinesCommand };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nexport class SortLinesCommand {\n    constructor(selection, descending) {\n        this.selection = selection;\n        this.descending = descending;\n        this.selectionId = null;\n    }\n    static getCollator() {\n        if (!SortLinesCommand._COLLATOR) {\n            SortLinesCommand._COLLATOR = new Intl.Collator();\n        }\n        return SortLinesCommand._COLLATOR;\n    }\n    getEditOperations(model, builder) {\n        const op = sortLines(model, this.selection, this.descending);\n        if (op) {\n            builder.addEditOperation(op.range, op.text);\n        }\n        this.selectionId = builder.trackSelection(this.selection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n    static canRun(model, selection, descending) {\n        if (model === null) {\n            return false;\n        }\n        const data = getSortData(model, selection, descending);\n        if (!data) {\n            return false;\n        }\n        for (let i = 0, len = data.before.length; i < len; i++) {\n            if (data.before[i] !== data.after[i]) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\nSortLinesCommand._COLLATOR = null;\nfunction getSortData(model, selection, descending) {\n    const startLineNumber = selection.startLineNumber;\n    let endLineNumber = selection.endLineNumber;\n    if (selection.endColumn === 1) {\n        endLineNumber--;\n    }\n    // Nothing to sort if user didn't select anything.\n    if (startLineNumber >= endLineNumber) {\n        return null;\n    }\n    const linesToSort = [];\n    // Get the contents of the selection to be sorted.\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        linesToSort.push(model.getLineContent(lineNumber));\n    }\n    let sorted = linesToSort.slice(0);\n    sorted.sort(SortLinesCommand.getCollator().compare);\n    // If descending, reverse the order.\n    if (descending === true) {\n        sorted = sorted.reverse();\n    }\n    return {\n        startLineNumber: startLineNumber,\n        endLineNumber: endLineNumber,\n        before: linesToSort,\n        after: sorted\n    };\n}\n/**\n * Generate commands for sorting lines on a model.\n */\nfunction sortLines(model, selection, descending) {\n    const data = getSortData(model, selection, descending);\n    if (!data) {\n        return null;\n    }\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { CoreEditingCommands } from '../../../browser/coreCommands.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../../common/commands/replaceCommand.js';\nimport { TrimTrailingWhitespaceCommand } from '../../../common/commands/trimTrailingWhitespaceCommand.js';\nimport { TypeOperations } from '../../../common/cursor/cursorTypeOperations.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CopyLinesCommand } from './copyLinesCommand.js';\nimport { MoveLinesCommand } from './moveLinesCommand.js';\nimport { SortLinesCommand } from './sortLinesCommand.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\n// copy lines\nclass AbstractCopyLinesAction extends EditorAction {\n    constructor(down, opts) {\n        super(opts);\n        this.down = down;\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignore: false }));\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        // Remove selections that would result in copying the same line\n        let prev = selections[0];\n        for (let i = 1; i < selections.length; i++) {\n            const curr = selections[i];\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\n                // these two selections would copy the same line\n                if (prev.index < curr.index) {\n                    // prev wins\n                    curr.ignore = true;\n                }\n                else {\n                    // curr wins\n                    prev.ignore = true;\n                    prev = curr;\n                }\n            }\n        }\n        const commands = [];\n        for (const selection of selections) {\n            commands.push(new CopyLinesCommand(selection.selection, this.down, selection.ignore));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass CopyLinesUpAction extends AbstractCopyLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.copyLinesUpAction',\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\n            alias: 'Copy Line Up',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\n                order: 1\n            }\n        });\n    }\n}\nclass CopyLinesDownAction extends AbstractCopyLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.copyLinesDownAction',\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\n            alias: 'Copy Line Down',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\n                order: 2\n            }\n        });\n    }\n}\nexport class DuplicateSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.duplicateSelection',\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\n            alias: 'Duplicate Selection',\n            precondition: EditorContextKeys.writable,\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\n                order: 5\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commands = [];\n        const selections = editor.getSelections();\n        const model = editor.getModel();\n        for (const selection of selections) {\n            if (selection.isEmpty()) {\n                commands.push(new CopyLinesCommand(selection, true));\n            }\n            else {\n                const insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\n// move lines\nclass AbstractMoveLinesAction extends EditorAction {\n    constructor(down, opts) {\n        super(opts);\n        this.down = down;\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const commands = [];\n        const selections = editor.getSelections() || [];\n        const autoIndent = editor.getOption(9 /* EditorOption.autoIndent */);\n        for (const selection of selections) {\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent, languageConfigurationService));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass MoveLinesUpAction extends AbstractMoveLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.moveLinesUpAction',\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\n            alias: 'Move Line Up',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                linux: { primary: 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\n                order: 3\n            }\n        });\n    }\n}\nclass MoveLinesDownAction extends AbstractMoveLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.moveLinesDownAction',\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\n            alias: 'Move Line Down',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                linux: { primary: 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\n                order: 4\n            }\n        });\n    }\n}\nexport class AbstractSortLinesAction extends EditorAction {\n    constructor(descending, opts) {\n        super(opts);\n        this.descending = descending;\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections() || [];\n        for (const selection of selections) {\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\n                return;\n            }\n        }\n        const commands = [];\n        for (let i = 0, len = selections.length; i < len; i++) {\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class SortLinesAscendingAction extends AbstractSortLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.sortLinesAscending',\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\n            alias: 'Sort Lines Ascending',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class SortLinesDescendingAction extends AbstractSortLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.sortLinesDescending',\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\n            alias: 'Sort Lines Descending',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteDuplicateLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.removeDuplicateLines',\n            label: nls.localize('lines.deleteDuplicates', \"Delete Duplicate Lines\"),\n            alias: 'Delete Duplicate Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n            return;\n        }\n        const edits = [];\n        const endCursorState = [];\n        let linesDeleted = 0;\n        for (const selection of editor.getSelections()) {\n            const uniqueLines = new Set();\n            const lines = [];\n            for (let i = selection.startLineNumber; i <= selection.endLineNumber; i++) {\n                const line = model.getLineContent(i);\n                if (uniqueLines.has(line)) {\n                    continue;\n                }\n                lines.push(line);\n                uniqueLines.add(line);\n            }\n            const selectionToReplace = new Selection(selection.startLineNumber, 1, selection.endLineNumber, model.getLineMaxColumn(selection.endLineNumber));\n            const adjustedSelectionStart = selection.startLineNumber - linesDeleted;\n            const finalSelection = new Selection(adjustedSelectionStart, 1, adjustedSelectionStart + lines.length - 1, lines[lines.length - 1].length);\n            edits.push(EditOperation.replace(selectionToReplace, lines.join('\\n')));\n            endCursorState.push(finalSelection);\n            linesDeleted += (selection.endLineNumber - selection.startLineNumber + 1) - lines.length;\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class TrimTrailingWhitespaceAction extends EditorAction {\n    constructor() {\n        super({\n            id: TrimTrailingWhitespaceAction.ID,\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\n            alias: 'Trim Trailing Whitespace',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        let cursors = [];\n        if (args.reason === 'auto-save') {\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\n            // It is very convenient for the editor config extension to invoke this action.\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\n            cursors = (editor.getSelections() || []).map(s => new Position(s.positionLineNumber, s.positionColumn));\n        }\n        const selection = editor.getSelection();\n        if (selection === null) {\n            return;\n        }\n        const command = new TrimTrailingWhitespaceCommand(selection, cursors);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n    }\n}\nTrimTrailingWhitespaceAction.ID = 'editor.action.trimTrailingWhitespace';\nexport class DeleteLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.deleteLines',\n            label: nls.localize('lines.delete', \"Delete Line\"),\n            alias: 'Delete Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 41 /* KeyCode.KeyK */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const ops = this._getLinesToRemove(editor);\n        const model = editor.getModel();\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n            // Model is empty\n            return;\n        }\n        let linesDeleted = 0;\n        const edits = [];\n        const cursorState = [];\n        for (let i = 0, len = ops.length; i < len; i++) {\n            const op = ops[i];\n            let startLineNumber = op.startLineNumber;\n            let endLineNumber = op.endLineNumber;\n            let startColumn = 1;\n            let endColumn = model.getLineMaxColumn(endLineNumber);\n            if (endLineNumber < model.getLineCount()) {\n                endLineNumber += 1;\n                endColumn = 1;\n            }\n            else if (startLineNumber > 1) {\n                startLineNumber -= 1;\n                startColumn = model.getLineMaxColumn(startLineNumber);\n            }\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, cursorState);\n        editor.pushUndoStop();\n    }\n    _getLinesToRemove(editor) {\n        // Construct delete operations\n        const operations = editor.getSelections().map((s) => {\n            let endLineNumber = s.endLineNumber;\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n                endLineNumber -= 1;\n            }\n            return {\n                startLineNumber: s.startLineNumber,\n                selectionStartColumn: s.selectionStartColumn,\n                endLineNumber: endLineNumber,\n                positionColumn: s.positionColumn\n            };\n        });\n        // Sort delete operations\n        operations.sort((a, b) => {\n            if (a.startLineNumber === b.startLineNumber) {\n                return a.endLineNumber - b.endLineNumber;\n            }\n            return a.startLineNumber - b.startLineNumber;\n        });\n        // Merge delete operations which are adjacent or overlapping\n        const mergedOperations = [];\n        let previousOperation = operations[0];\n        for (let i = 1; i < operations.length; i++) {\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\n                // Merge current operations into the previous one\n                previousOperation.endLineNumber = operations[i].endLineNumber;\n            }\n            else {\n                // Push previous operation\n                mergedOperations.push(previousOperation);\n                previousOperation = operations[i];\n            }\n        }\n        // Push the last operation\n        mergedOperations.push(previousOperation);\n        return mergedOperations;\n    }\n}\nexport class IndentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.indentLines',\n            label: nls.localize('lines.indent', \"Indent Line\"),\n            alias: 'Indent Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.BracketRight */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.indent(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n        editor.pushUndoStop();\n    }\n}\nclass OutdentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.outdentLines',\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\n            alias: 'Outdent Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.BracketLeft */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\n    }\n}\nexport class InsertLineBeforeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertLineBefore',\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\n            alias: 'Insert Line Above',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.lineInsertBefore(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n    }\n}\nexport class InsertLineAfterAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertLineAfter',\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\n            alias: 'Insert Line Below',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.lineInsertAfter(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n    }\n}\nexport class AbstractDeleteAllToBoundaryAction extends EditorAction {\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const primaryCursor = editor.getSelection();\n        const rangesToDelete = this._getRangesToDelete(editor);\n        // merge overlapping selections\n        const effectiveRanges = [];\n        for (let i = 0, count = rangesToDelete.length - 1; i < count; i++) {\n            const range = rangesToDelete[i];\n            const nextRange = rangesToDelete[i + 1];\n            if (Range.intersectRanges(range, nextRange) === null) {\n                effectiveRanges.push(range);\n            }\n            else {\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\n            }\n        }\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\n        const endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\n        const edits = effectiveRanges.map(range => {\n            return EditOperation.replace(range, '');\n        });\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction {\n    constructor() {\n        super({\n            id: 'deleteAllLeft',\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\n            alias: 'Delete All Left',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _getEndCursorState(primaryCursor, rangesToDelete) {\n        let endPrimaryCursor = null;\n        const endCursorState = [];\n        let deletedLines = 0;\n        rangesToDelete.forEach(range => {\n            let endCursor;\n            if (range.endColumn === 1 && deletedLines > 0) {\n                const newStartLine = range.startLineNumber - deletedLines;\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\n            }\n            else {\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\n            }\n            deletedLines += range.endLineNumber - range.startLineNumber;\n            if (range.intersectRanges(primaryCursor)) {\n                endPrimaryCursor = endCursor;\n            }\n            else {\n                endCursorState.push(endCursor);\n            }\n        });\n        if (endPrimaryCursor) {\n            endCursorState.unshift(endPrimaryCursor);\n        }\n        return endCursorState;\n    }\n    _getRangesToDelete(editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return [];\n        }\n        let rangesToDelete = selections;\n        const model = editor.getModel();\n        if (model === null) {\n            return [];\n        }\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\n        rangesToDelete = rangesToDelete.map(selection => {\n            if (selection.isEmpty()) {\n                if (selection.startColumn === 1) {\n                    const deleteFromLine = Math.max(1, selection.startLineNumber - 1);\n                    const deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineContent(deleteFromLine).length + 1;\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\n                }\n                else {\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\n                }\n            }\n            else {\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\n            }\n        });\n        return rangesToDelete;\n    }\n}\nexport class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction {\n    constructor() {\n        super({\n            id: 'deleteAllRight',\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\n            alias: 'Delete All Right',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 41 /* KeyCode.KeyK */, secondary: [2048 /* KeyMod.CtrlCmd */ | 20 /* KeyCode.Delete */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _getEndCursorState(primaryCursor, rangesToDelete) {\n        let endPrimaryCursor = null;\n        const endCursorState = [];\n        for (let i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\n            const range = rangesToDelete[i];\n            const endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\n            if (range.intersectRanges(primaryCursor)) {\n                endPrimaryCursor = endCursor;\n            }\n            else {\n                endCursorState.push(endCursor);\n            }\n        }\n        if (endPrimaryCursor) {\n            endCursorState.unshift(endPrimaryCursor);\n        }\n        return endCursorState;\n    }\n    _getRangesToDelete(editor) {\n        const model = editor.getModel();\n        if (model === null) {\n            return [];\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return [];\n        }\n        const rangesToDelete = selections.map((sel) => {\n            if (sel.isEmpty()) {\n                const maxColumn = model.getLineMaxColumn(sel.startLineNumber);\n                if (sel.startColumn === maxColumn) {\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\n                }\n                else {\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\n                }\n            }\n            return sel;\n        });\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\n        return rangesToDelete;\n    }\n}\nexport class JoinLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.joinLines',\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\n            alias: 'Join Lines',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 40 /* KeyCode.KeyJ */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        let primaryCursor = editor.getSelection();\n        if (primaryCursor === null) {\n            return;\n        }\n        selections.sort(Range.compareRangesUsingStarts);\n        const reducedSelections = [];\n        const lastSelection = selections.reduce((previousValue, currentValue) => {\n            if (previousValue.isEmpty()) {\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\n                    if (primaryCursor.equalsSelection(previousValue)) {\n                        primaryCursor = currentValue;\n                    }\n                    return currentValue;\n                }\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\n                    reducedSelections.push(previousValue);\n                    return currentValue;\n                }\n                else {\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\n                }\n            }\n            else {\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\n                    reducedSelections.push(previousValue);\n                    return currentValue;\n                }\n                else {\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\n                }\n            }\n        });\n        reducedSelections.push(lastSelection);\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const edits = [];\n        const endCursorState = [];\n        let endPrimaryCursor = primaryCursor;\n        let lineOffset = 0;\n        for (let i = 0, len = reducedSelections.length; i < len; i++) {\n            const selection = reducedSelections[i];\n            const startLineNumber = selection.startLineNumber;\n            const startColumn = 1;\n            let columnDeltaOffset = 0;\n            let endLineNumber, endColumn;\n            const selectionEndPositionOffset = model.getLineContent(selection.endLineNumber).length - selection.endColumn;\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\n                const position = selection.getStartPosition();\n                if (position.lineNumber < model.getLineCount()) {\n                    endLineNumber = startLineNumber + 1;\n                    endColumn = model.getLineMaxColumn(endLineNumber);\n                }\n                else {\n                    endLineNumber = position.lineNumber;\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\n                }\n            }\n            else {\n                endLineNumber = selection.endLineNumber;\n                endColumn = model.getLineMaxColumn(endLineNumber);\n            }\n            let trimmedLinesContent = model.getLineContent(startLineNumber);\n            for (let i = startLineNumber + 1; i <= endLineNumber; i++) {\n                const lineText = model.getLineContent(i);\n                const firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i);\n                if (firstNonWhitespaceIdx >= 1) {\n                    let insertSpace = true;\n                    if (trimmedLinesContent === '') {\n                        insertSpace = false;\n                    }\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\n                        insertSpace = false;\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\n                    }\n                    const lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\n                    if (insertSpace) {\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\n                    }\n                    else {\n                        columnDeltaOffset = lineTextWithoutIndent.length;\n                    }\n                }\n                else {\n                    columnDeltaOffset = 0;\n                }\n            }\n            const deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\n            if (!deleteSelection.isEmpty()) {\n                let resultSelection;\n                if (selection.isEmpty()) {\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\n                }\n                else {\n                    if (selection.startLineNumber === selection.endLineNumber) {\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\n                    }\n                    else {\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\n                    }\n                }\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\n                    endPrimaryCursor = resultSelection;\n                }\n                else {\n                    endCursorState.push(resultSelection);\n                }\n            }\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\n        }\n        endCursorState.unshift(endPrimaryCursor);\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class TransposeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.transpose',\n            label: nls.localize('editor.transpose', \"Transpose characters around the cursor\"),\n            alias: 'Transpose characters around the cursor',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const commands = [];\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            if (!selection.isEmpty()) {\n                continue;\n            }\n            const cursor = selection.getStartPosition();\n            const maxColumn = model.getLineMaxColumn(cursor.lineNumber);\n            if (cursor.column >= maxColumn) {\n                if (cursor.lineNumber === model.getLineCount()) {\n                    continue;\n                }\n                // The cursor is at the end of current line and current line is not empty\n                // then we transpose the character before the cursor and the line break if there is any following line.\n                const deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\n                const chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\n            }\n            else {\n                const deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\n                const chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class AbstractCaseAction extends EditorAction {\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const wordSeparators = editor.getOption(119 /* EditorOption.wordSeparators */);\n        const textEdits = [];\n        for (const selection of selections) {\n            if (selection.isEmpty()) {\n                const cursor = selection.getStartPosition();\n                const word = editor.getConfiguredWordAtPosition(cursor);\n                if (!word) {\n                    continue;\n                }\n                const wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\n                const text = model.getValueInRange(wordRange);\n                textEdits.push(EditOperation.replace(wordRange, this._modifyText(text, wordSeparators)));\n            }\n            else {\n                const text = model.getValueInRange(selection);\n                textEdits.push(EditOperation.replace(selection, this._modifyText(text, wordSeparators)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, textEdits);\n        editor.pushUndoStop();\n    }\n}\nexport class UpperCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToUppercase',\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\n            alias: 'Transform to Uppercase',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        return text.toLocaleUpperCase();\n    }\n}\nexport class LowerCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToLowercase',\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\n            alias: 'Transform to Lowercase',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        return text.toLocaleLowerCase();\n    }\n}\nclass BackwardsCompatibleRegExp {\n    constructor(_pattern, _flags) {\n        this._pattern = _pattern;\n        this._flags = _flags;\n        this._actual = null;\n        this._evaluated = false;\n    }\n    get() {\n        if (!this._evaluated) {\n            this._evaluated = true;\n            try {\n                this._actual = new RegExp(this._pattern, this._flags);\n            }\n            catch (err) {\n                // this browser does not support this regular expression\n            }\n        }\n        return this._actual;\n    }\n    isSupported() {\n        return (this.get() !== null);\n    }\n}\nexport class TitleCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToTitlecase',\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\n            alias: 'Transform to Title Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const titleBoundary = TitleCaseAction.titleBoundary.get();\n        if (!titleBoundary) {\n            // cannot support this\n            return text;\n        }\n        return text\n            .toLocaleLowerCase()\n            .replace(titleBoundary, (b) => b.toLocaleUpperCase());\n    }\n}\nTitleCaseAction.titleBoundary = new BackwardsCompatibleRegExp('(^|[^\\\\p{L}\\\\p{N}\\']|((^|\\\\P{L})\\'))\\\\p{L}', 'gmu');\nexport class SnakeCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToSnakecase',\n            label: nls.localize('editor.transformToSnakecase', \"Transform to Snake Case\"),\n            alias: 'Transform to Snake Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const caseBoundary = SnakeCaseAction.caseBoundary.get();\n        const singleLetters = SnakeCaseAction.singleLetters.get();\n        if (!caseBoundary || !singleLetters) {\n            // cannot support this\n            return text;\n        }\n        return (text\n            .replace(caseBoundary, '$1_$2')\n            .replace(singleLetters, '$1_$2$3')\n            .toLocaleLowerCase());\n    }\n}\nSnakeCaseAction.caseBoundary = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu');\nSnakeCaseAction.singleLetters = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu})(\\\\p{Ll})', 'gmu');\nexport class KebabCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToKebabcase',\n            label: nls.localize('editor.transformToKebabcase', 'Transform to Kebab Case'),\n            alias: 'Transform to Kebab Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    static isSupported() {\n        const areAllRegexpsSupported = [\n            this.caseBoundary,\n            this.singleLetters,\n            this.underscoreBoundary,\n        ].every((regexp) => regexp.isSupported());\n        return areAllRegexpsSupported;\n    }\n    _modifyText(text, _) {\n        const caseBoundary = KebabCaseAction.caseBoundary.get();\n        const singleLetters = KebabCaseAction.singleLetters.get();\n        const underscoreBoundary = KebabCaseAction.underscoreBoundary.get();\n        if (!caseBoundary || !singleLetters || !underscoreBoundary) {\n            // one or more regexps aren't supported\n            return text;\n        }\n        return text\n            .replace(underscoreBoundary, '$1-$3')\n            .replace(caseBoundary, '$1-$2')\n            .replace(singleLetters, '$1-$2')\n            .toLocaleLowerCase();\n    }\n}\nKebabCaseAction.caseBoundary = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu');\nKebabCaseAction.singleLetters = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu}\\\\p{Ll})', 'gmu');\nKebabCaseAction.underscoreBoundary = new BackwardsCompatibleRegExp('(\\\\S)(_)(\\\\S)', 'gm');\nregisterEditorAction(CopyLinesUpAction);\nregisterEditorAction(CopyLinesDownAction);\nregisterEditorAction(DuplicateSelectionAction);\nregisterEditorAction(MoveLinesUpAction);\nregisterEditorAction(MoveLinesDownAction);\nregisterEditorAction(SortLinesAscendingAction);\nregisterEditorAction(SortLinesDescendingAction);\nregisterEditorAction(DeleteDuplicateLinesAction);\nregisterEditorAction(TrimTrailingWhitespaceAction);\nregisterEditorAction(DeleteLinesAction);\nregisterEditorAction(IndentLinesAction);\nregisterEditorAction(OutdentLinesAction);\nregisterEditorAction(InsertLineBeforeAction);\nregisterEditorAction(InsertLineAfterAction);\nregisterEditorAction(DeleteAllLeftAction);\nregisterEditorAction(DeleteAllRightAction);\nregisterEditorAction(JoinLinesAction);\nregisterEditorAction(TransposeAction);\nregisterEditorAction(UpperCaseAction);\nregisterEditorAction(LowerCaseAction);\nif (SnakeCaseAction.caseBoundary.isSupported() && SnakeCaseAction.singleLetters.isSupported()) {\n    registerEditorAction(SnakeCaseAction);\n}\nif (TitleCaseAction.titleBoundary.isSupported()) {\n    registerEditorAction(TitleCaseAction);\n}\nif (KebabCaseAction.isSupported()) {\n    registerEditorAction(KebabCaseAction);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, Delayer, first } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { isCancellationError, onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nexport const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE = new RawContextKey('LinkedEditingInputVisible', false);\nconst DECORATION_CLASS_NAME = 'linked-editing-decoration';\nlet LinkedEditingContribution = class LinkedEditingContribution extends Disposable {\n    constructor(editor, contextKeyService, languageFeaturesService, languageConfigurationService, languageFeatureDebounceService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._syncRangesToken = 0;\n        this._localToDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._providers = languageFeaturesService.linkedEditingRangeProvider;\n        this._enabled = false;\n        this._visibleContextKey = CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._debounceInformation = languageFeatureDebounceService.for(this._providers, 'Linked Editing', { min: 200 });\n        this._currentDecorations = this._editor.createDecorationsCollection();\n        this._languageWordPattern = null;\n        this._currentWordPattern = null;\n        this._ignoreChangeEvent = false;\n        this._localToDispose = this._register(new DisposableStore());\n        this._rangeUpdateTriggerPromise = null;\n        this._rangeSyncTriggerPromise = null;\n        this._currentRequest = null;\n        this._currentRequestPosition = null;\n        this._currentRequestModelVersion = null;\n        this._register(this._editor.onDidChangeModel(() => this.reinitialize(true)));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(64 /* EditorOption.linkedEditing */) || e.hasChanged(84 /* EditorOption.renameOnType */)) {\n                this.reinitialize(false);\n            }\n        }));\n        this._register(this._providers.onDidChange(() => this.reinitialize(false)));\n        this._register(this._editor.onDidChangeModelLanguage(() => this.reinitialize(true)));\n        this.reinitialize(true);\n    }\n    static get(editor) {\n        return editor.getContribution(LinkedEditingContribution.ID);\n    }\n    reinitialize(forceRefresh) {\n        const model = this._editor.getModel();\n        const isEnabled = model !== null && (this._editor.getOption(64 /* EditorOption.linkedEditing */) || this._editor.getOption(84 /* EditorOption.renameOnType */)) && this._providers.has(model);\n        if (isEnabled === this._enabled && !forceRefresh) {\n            return;\n        }\n        this._enabled = isEnabled;\n        this.clearRanges();\n        this._localToDispose.clear();\n        if (!isEnabled || model === null) {\n            return;\n        }\n        this._localToDispose.add(Event.runAndSubscribe(model.onDidChangeLanguageConfiguration, () => {\n            this._languageWordPattern = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n        }));\n        const rangeUpdateScheduler = new Delayer(this._debounceInformation.get(model));\n        const triggerRangeUpdate = () => {\n            var _a;\n            this._rangeUpdateTriggerPromise = rangeUpdateScheduler.trigger(() => this.updateRanges(), (_a = this._debounceDuration) !== null && _a !== void 0 ? _a : this._debounceInformation.get(model));\n        };\n        const rangeSyncScheduler = new Delayer(0);\n        const triggerRangeSync = (token) => {\n            this._rangeSyncTriggerPromise = rangeSyncScheduler.trigger(() => this._syncRanges(token));\n        };\n        this._localToDispose.add(this._editor.onDidChangeCursorPosition(() => {\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (!this._ignoreChangeEvent) {\n                if (this._currentDecorations.length > 0) {\n                    const referenceRange = this._currentDecorations.getRange(0);\n                    if (referenceRange && e.changes.every(c => referenceRange.intersectRanges(c.range))) {\n                        triggerRangeSync(this._syncRangesToken);\n                        return;\n                    }\n                }\n            }\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add({\n            dispose: () => {\n                rangeUpdateScheduler.dispose();\n                rangeSyncScheduler.dispose();\n            }\n        });\n        this.updateRanges();\n    }\n    _syncRanges(token) {\n        // dalayed invocation, make sure we're still on\n        if (!this._editor.hasModel() || token !== this._syncRangesToken || this._currentDecorations.length === 0) {\n            // nothing to do\n            return;\n        }\n        const model = this._editor.getModel();\n        const referenceRange = this._currentDecorations.getRange(0);\n        if (!referenceRange || referenceRange.startLineNumber !== referenceRange.endLineNumber) {\n            return this.clearRanges();\n        }\n        const referenceValue = model.getValueInRange(referenceRange);\n        if (this._currentWordPattern) {\n            const match = referenceValue.match(this._currentWordPattern);\n            const matchLength = match ? match[0].length : 0;\n            if (matchLength !== referenceValue.length) {\n                return this.clearRanges();\n            }\n        }\n        const edits = [];\n        for (let i = 1, len = this._currentDecorations.length; i < len; i++) {\n            const mirrorRange = this._currentDecorations.getRange(i);\n            if (!mirrorRange) {\n                continue;\n            }\n            if (mirrorRange.startLineNumber !== mirrorRange.endLineNumber) {\n                edits.push({\n                    range: mirrorRange,\n                    text: referenceValue\n                });\n            }\n            else {\n                let oldValue = model.getValueInRange(mirrorRange);\n                let newValue = referenceValue;\n                let rangeStartColumn = mirrorRange.startColumn;\n                let rangeEndColumn = mirrorRange.endColumn;\n                const commonPrefixLength = strings.commonPrefixLength(oldValue, newValue);\n                rangeStartColumn += commonPrefixLength;\n                oldValue = oldValue.substr(commonPrefixLength);\n                newValue = newValue.substr(commonPrefixLength);\n                const commonSuffixLength = strings.commonSuffixLength(oldValue, newValue);\n                rangeEndColumn -= commonSuffixLength;\n                oldValue = oldValue.substr(0, oldValue.length - commonSuffixLength);\n                newValue = newValue.substr(0, newValue.length - commonSuffixLength);\n                if (rangeStartColumn !== rangeEndColumn || newValue.length !== 0) {\n                    edits.push({\n                        range: new Range(mirrorRange.startLineNumber, rangeStartColumn, mirrorRange.endLineNumber, rangeEndColumn),\n                        text: newValue\n                    });\n                }\n            }\n        }\n        if (edits.length === 0) {\n            return;\n        }\n        try {\n            this._editor.popUndoStop();\n            this._ignoreChangeEvent = true;\n            const prevEditOperationType = this._editor._getViewModel().getPrevEditOperationType();\n            this._editor.executeEdits('linkedEditing', edits);\n            this._editor._getViewModel().setPrevEditOperationType(prevEditOperationType);\n        }\n        finally {\n            this._ignoreChangeEvent = false;\n        }\n    }\n    dispose() {\n        this.clearRanges();\n        super.dispose();\n    }\n    clearRanges() {\n        this._visibleContextKey.set(false);\n        this._currentDecorations.clear();\n        if (this._currentRequest) {\n            this._currentRequest.cancel();\n            this._currentRequest = null;\n            this._currentRequestPosition = null;\n        }\n    }\n    updateRanges(force = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                this.clearRanges();\n                return;\n            }\n            const position = this._editor.getPosition();\n            if (!this._enabled && !force || this._editor.getSelections().length > 1) {\n                // disabled or multicursor\n                this.clearRanges();\n                return;\n            }\n            const model = this._editor.getModel();\n            const modelVersionId = model.getVersionId();\n            if (this._currentRequestPosition && this._currentRequestModelVersion === modelVersionId) {\n                if (position.equals(this._currentRequestPosition)) {\n                    return; // same position\n                }\n                if (this._currentDecorations.length > 0) {\n                    const range = this._currentDecorations.getRange(0);\n                    if (range && range.containsPosition(position)) {\n                        return; // just moving inside the existing primary range\n                    }\n                }\n            }\n            this._currentRequestPosition = position;\n            this._currentRequestModelVersion = modelVersionId;\n            const request = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    const sw = new StopWatch(false);\n                    const response = yield getLinkedEditingRanges(this._providers, model, position, token);\n                    this._debounceInformation.update(model, sw.elapsed());\n                    if (request !== this._currentRequest) {\n                        return;\n                    }\n                    this._currentRequest = null;\n                    if (modelVersionId !== model.getVersionId()) {\n                        return;\n                    }\n                    let ranges = [];\n                    if (response === null || response === void 0 ? void 0 : response.ranges) {\n                        ranges = response.ranges;\n                    }\n                    this._currentWordPattern = (response === null || response === void 0 ? void 0 : response.wordPattern) || this._languageWordPattern;\n                    let foundReferenceRange = false;\n                    for (let i = 0, len = ranges.length; i < len; i++) {\n                        if (Range.containsPosition(ranges[i], position)) {\n                            foundReferenceRange = true;\n                            if (i !== 0) {\n                                const referenceRange = ranges[i];\n                                ranges.splice(i, 1);\n                                ranges.unshift(referenceRange);\n                            }\n                            break;\n                        }\n                    }\n                    if (!foundReferenceRange) {\n                        // Cannot do linked editing if the ranges are not where the cursor is...\n                        this.clearRanges();\n                        return;\n                    }\n                    const decorations = ranges.map(range => ({ range: range, options: LinkedEditingContribution.DECORATION }));\n                    this._visibleContextKey.set(true);\n                    this._currentDecorations.set(decorations);\n                    this._syncRangesToken++; // cancel any pending syncRanges call\n                }\n                catch (err) {\n                    if (!isCancellationError(err)) {\n                        onUnexpectedError(err);\n                    }\n                    if (this._currentRequest === request || !this._currentRequest) {\n                        // stop if we are still the latest request\n                        this.clearRanges();\n                    }\n                }\n            }));\n            this._currentRequest = request;\n            return request;\n        });\n    }\n};\nLinkedEditingContribution.ID = 'editor.contrib.linkedEditing';\nLinkedEditingContribution.DECORATION = ModelDecorationOptions.register({\n    description: 'linked-editing',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    className: DECORATION_CLASS_NAME\n});\nLinkedEditingContribution = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeatureDebounceService)\n], LinkedEditingContribution);\nexport { LinkedEditingContribution };\nexport class LinkedEditingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.linkedEditing',\n            label: nls.localize('linkedEditing.label', \"Start Linked Editing\"),\n            alias: 'Start Linked Editing',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(_accessor, editor) {\n        const controller = LinkedEditingContribution.get(editor);\n        if (controller) {\n            return Promise.resolve(controller.updateRanges(true));\n        }\n        return Promise.resolve();\n    }\n}\nconst LinkedEditingCommand = EditorCommand.bindToContribution(LinkedEditingContribution.get);\nregisterEditorCommand(new LinkedEditingCommand({\n    id: 'cancelLinkedEditingInput',\n    precondition: CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,\n    handler: x => x.clearRanges(),\n    kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nfunction getLinkedEditingRanges(providers, model, position, token) {\n    const orderedByScore = providers.ordered(model);\n    // in order of score ask the linked editing range provider\n    // until someone response with a good result\n    // (good = not null)\n    return first(orderedByScore.map(provider => () => __awaiter(this, void 0, void 0, function* () {\n        try {\n            return yield provider.provideLinkedEditingRanges(model, position, token);\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n            return undefined;\n        }\n    })), result => !!result && arrays.isNonEmptyArray(result === null || result === void 0 ? void 0 : result.ranges));\n}\nexport const editorLinkedEditingBackground = registerColor('editor.linkedEditingBackground', { dark: Color.fromHex('#f00').transparent(0.3), light: Color.fromHex('#f00').transparent(0.3), hcDark: Color.fromHex('#f00').transparent(0.3), hcLight: Color.white }, nls.localize('editorLinkedEditingBackground', 'Background color when the editor auto renames on type.'));\nregisterThemingParticipant((theme, collector) => {\n    const editorLinkedEditingBackgroundColor = theme.getColor(editorLinkedEditingBackground);\n    if (editorLinkedEditingBackgroundColor) {\n        collector.addRule(`.monaco-editor .${DECORATION_CLASS_NAME} { background: ${editorLinkedEditingBackgroundColor}; border-left-color: ${editorLinkedEditingBackgroundColor}; }`);\n    }\n});\nregisterModelAndPositionCommand('_executeLinkedEditingProvider', (_accessor, model, position) => {\n    const { linkedEditingRangeProvider } = _accessor.get(ILanguageFeaturesService);\n    return getLinkedEditingRanges(linkedEditingRangeProvider, model, position, CancellationToken.None);\n});\nregisterEditorContribution(LinkedEditingContribution.ID, LinkedEditingContribution);\nregisterEditorAction(LinkedEditingAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class Link {\n    constructor(link, provider) {\n        this._link = link;\n        this._provider = provider;\n    }\n    toJSON() {\n        return {\n            range: this.range,\n            url: this.url,\n            tooltip: this.tooltip\n        };\n    }\n    get range() {\n        return this._link.range;\n    }\n    get url() {\n        return this._link.url;\n    }\n    get tooltip() {\n        return this._link.tooltip;\n    }\n    resolve(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._link.url) {\n                return this._link.url;\n            }\n            if (typeof this._provider.resolveLink === 'function') {\n                return Promise.resolve(this._provider.resolveLink(this._link, token)).then(value => {\n                    this._link = value || this._link;\n                    if (this._link.url) {\n                        // recurse\n                        return this.resolve(token);\n                    }\n                    return Promise.reject(new Error('missing'));\n                });\n            }\n            return Promise.reject(new Error('missing'));\n        });\n    }\n}\nexport class LinksList {\n    constructor(tuples) {\n        this._disposables = new DisposableStore();\n        let links = [];\n        for (const [list, provider] of tuples) {\n            // merge all links\n            const newLinks = list.links.map(link => new Link(link, provider));\n            links = LinksList._union(links, newLinks);\n            // register disposables\n            if (isDisposable(list)) {\n                this._disposables.add(list);\n            }\n        }\n        this.links = links;\n    }\n    dispose() {\n        this._disposables.dispose();\n        this.links.length = 0;\n    }\n    static _union(oldLinks, newLinks) {\n        // reunite oldLinks with newLinks and remove duplicates\n        const result = [];\n        let oldIndex;\n        let oldLen;\n        let newIndex;\n        let newLen;\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\n            const oldLink = oldLinks[oldIndex];\n            const newLink = newLinks[newIndex];\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\n                // Remove the oldLink\n                oldIndex++;\n                continue;\n            }\n            const comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\n            if (comparisonResult < 0) {\n                // oldLink is before\n                result.push(oldLink);\n                oldIndex++;\n            }\n            else {\n                // newLink is before\n                result.push(newLink);\n                newIndex++;\n            }\n        }\n        for (; oldIndex < oldLen; oldIndex++) {\n            result.push(oldLinks[oldIndex]);\n        }\n        for (; newIndex < newLen; newIndex++) {\n            result.push(newLinks[newIndex]);\n        }\n        return result;\n    }\n}\nexport function getLinks(providers, model, token) {\n    const lists = [];\n    // ask all providers for links in parallel\n    const promises = providers.ordered(model).reverse().map((provider, i) => {\n        return Promise.resolve(provider.provideLinks(model, token)).then(result => {\n            if (result) {\n                lists[i] = [result, provider];\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(() => {\n        const result = new LinksList(coalesce(lists));\n        if (!token.isCancellationRequested) {\n            return result;\n        }\n        result.dispose();\n        return new LinksList([]);\n    });\n}\nCommandsRegistry.registerCommand('_executeLinkProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    let [uri, resolveCount] = args;\n    assertType(uri instanceof URI);\n    if (typeof resolveCount !== 'number') {\n        resolveCount = 0;\n    }\n    const { linkProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return [];\n    }\n    const list = yield getLinks(linkProvider, model, CancellationToken.None);\n    if (!list) {\n        return [];\n    }\n    // resolve links\n    for (let i = 0; i < Math.min(resolveCount, list.links.length); i++) {\n        yield list.links[i].resolve(CancellationToken.None);\n    }\n    const result = list.links.slice(0);\n    list.dispose();\n    return result;\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport './links.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { getLinks } from './getLinks.js';\nimport * as nls from '../../../../nls.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { editorActiveLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nlet LinkDetector = class LinkDetector extends Disposable {\n    constructor(editor, openerService, notificationService, languageFeaturesService, languageFeatureDebounceService) {\n        super();\n        this.editor = editor;\n        this.openerService = openerService;\n        this.notificationService = notificationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.providers = this.languageFeaturesService.linkProvider;\n        this.debounceInformation = languageFeatureDebounceService.for(this.providers, 'Links', { min: 1000, max: 4000 });\n        this.computeLinks = this._register(new RunOnceScheduler(() => this.computeLinksNow(), 1000));\n        this.computePromise = null;\n        this.activeLinksList = null;\n        this.currentOccurrences = {};\n        this.activeLinkDecorationId = null;\n        const clickLinkGesture = this._register(new ClickLinkGesture(editor));\n        this._register(clickLinkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this._onEditorMouseMove(mouseEvent, keyboardEvent);\n        }));\n        this._register(clickLinkGesture.onExecute((e) => {\n            this.onEditorMouseUp(e);\n        }));\n        this._register(clickLinkGesture.onCancel((e) => {\n            this.cleanUpActiveLinkDecoration();\n        }));\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (!e.hasChanged(65 /* EditorOption.links */)) {\n                return;\n            }\n            // Remove any links (for the getting disabled case)\n            this.updateDecorations([]);\n            // Stop any computation (for the getting disabled case)\n            this.stop();\n            // Start computing (for the getting enabled case)\n            this.computeLinks.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            if (!this.editor.hasModel()) {\n                return;\n            }\n            this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()));\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this.currentOccurrences = {};\n            this.activeLinkDecorationId = null;\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelLanguage((e) => {\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this._register(this.providers.onDidChange((e) => {\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this.computeLinks.schedule(0);\n    }\n    static get(editor) {\n        return editor.getContribution(LinkDetector.ID);\n    }\n    computeLinksNow() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.editor.hasModel() || !this.editor.getOption(65 /* EditorOption.links */)) {\n                return;\n            }\n            const model = this.editor.getModel();\n            if (!this.providers.has(model)) {\n                return;\n            }\n            if (this.activeLinksList) {\n                this.activeLinksList.dispose();\n                this.activeLinksList = null;\n            }\n            this.computePromise = createCancelablePromise(token => getLinks(this.providers, model, token));\n            try {\n                const sw = new StopWatch(false);\n                this.activeLinksList = yield this.computePromise;\n                this.debounceInformation.update(model, sw.elapsed());\n                if (model.isDisposed()) {\n                    return;\n                }\n                this.updateDecorations(this.activeLinksList.links);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                this.computePromise = null;\n            }\n        });\n    }\n    updateDecorations(links) {\n        const useMetaKey = (this.editor.getOption(72 /* EditorOption.multiCursorModifier */) === 'altKey');\n        const oldDecorations = [];\n        const keys = Object.keys(this.currentOccurrences);\n        for (const decorationId of keys) {\n            const occurence = this.currentOccurrences[decorationId];\n            oldDecorations.push(occurence.decorationId);\n        }\n        const newDecorations = [];\n        if (links) {\n            // Not sure why this is sometimes null\n            for (const link of links) {\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\n            }\n        }\n        this.editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations(oldDecorations, newDecorations);\n            this.currentOccurrences = {};\n            this.activeLinkDecorationId = null;\n            for (let i = 0, len = decorations.length; i < len; i++) {\n                const occurence = new LinkOccurrence(links[i], decorations[i]);\n                this.currentOccurrences[occurence.decorationId] = occurence;\n            }\n        });\n    }\n    _onEditorMouseMove(mouseEvent, withKey) {\n        const useMetaKey = (this.editor.getOption(72 /* EditorOption.multiCursorModifier */) === 'altKey');\n        if (this.isEnabled(mouseEvent, withKey)) {\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\n            const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n            if (occurrence) {\n                this.editor.changeDecorations((changeAccessor) => {\n                    occurrence.activate(changeAccessor, useMetaKey);\n                    this.activeLinkDecorationId = occurrence.decorationId;\n                });\n            }\n        }\n        else {\n            this.cleanUpActiveLinkDecoration();\n        }\n    }\n    cleanUpActiveLinkDecoration() {\n        const useMetaKey = (this.editor.getOption(72 /* EditorOption.multiCursorModifier */) === 'altKey');\n        if (this.activeLinkDecorationId) {\n            const occurrence = this.currentOccurrences[this.activeLinkDecorationId];\n            if (occurrence) {\n                this.editor.changeDecorations((changeAccessor) => {\n                    occurrence.deactivate(changeAccessor, useMetaKey);\n                });\n            }\n            this.activeLinkDecorationId = null;\n        }\n    }\n    onEditorMouseUp(mouseEvent) {\n        if (!this.isEnabled(mouseEvent)) {\n            return;\n        }\n        const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n        if (!occurrence) {\n            return;\n        }\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\n    }\n    openLinkOccurrence(occurrence, openToSide, fromUserGesture = false) {\n        if (!this.openerService) {\n            return;\n        }\n        const { link } = occurrence;\n        link.resolve(CancellationToken.None).then(uri => {\n            // Support for relative file URIs of the shape file://./relativeFile.txt or file:///./relativeFile.txt\n            if (typeof uri === 'string' && this.editor.hasModel()) {\n                const modelUri = this.editor.getModel().uri;\n                if (modelUri.scheme === Schemas.file && uri.startsWith(`${Schemas.file}:`)) {\n                    const parsedUri = URI.parse(uri);\n                    if (parsedUri.scheme === Schemas.file) {\n                        const fsPath = resources.originalFSPath(parsedUri);\n                        let relativePath = null;\n                        if (fsPath.startsWith('/./')) {\n                            relativePath = `.${fsPath.substr(1)}`;\n                        }\n                        else if (fsPath.startsWith('//./')) {\n                            relativePath = `.${fsPath.substr(2)}`;\n                        }\n                        if (relativePath) {\n                            uri = resources.joinPath(modelUri, relativePath);\n                        }\n                    }\n                }\n            }\n            return this.openerService.open(uri, { openToSide, fromUserGesture, allowContributedOpeners: true, allowCommands: true, fromWorkspace: true });\n        }, err => {\n            const messageOrError = err instanceof Error ? err.message : err;\n            // different error cases\n            if (messageOrError === 'invalid') {\n                this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\n            }\n            else if (messageOrError === 'missing') {\n                this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\n            }\n            else {\n                onUnexpectedError(err);\n            }\n        });\n    }\n    getLinkOccurrence(position) {\n        if (!this.editor.hasModel() || !position) {\n            return null;\n        }\n        const decorations = this.editor.getModel().getDecorationsInRange({\n            startLineNumber: position.lineNumber,\n            startColumn: position.column,\n            endLineNumber: position.lineNumber,\n            endColumn: position.column\n        }, 0, true);\n        for (const decoration of decorations) {\n            const currentOccurrence = this.currentOccurrences[decoration.id];\n            if (currentOccurrence) {\n                return currentOccurrence;\n            }\n        }\n        return null;\n    }\n    isEnabled(mouseEvent, withKey) {\n        return Boolean((mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */)\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\n    }\n    stop() {\n        var _a;\n        this.computeLinks.cancel();\n        if (this.activeLinksList) {\n            (_a = this.activeLinksList) === null || _a === void 0 ? void 0 : _a.dispose();\n            this.activeLinksList = null;\n        }\n        if (this.computePromise) {\n            this.computePromise.cancel();\n            this.computePromise = null;\n        }\n    }\n    dispose() {\n        super.dispose();\n        this.stop();\n    }\n};\nLinkDetector.ID = 'editor.linkDetector';\nLinkDetector = __decorate([\n    __param(1, IOpenerService),\n    __param(2, INotificationService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ILanguageFeatureDebounceService)\n], LinkDetector);\nexport { LinkDetector };\nconst decoration = {\n    general: ModelDecorationOptions.register({\n        description: 'detected-link',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        collapseOnReplaceEdit: true,\n        inlineClassName: 'detected-link'\n    }),\n    active: ModelDecorationOptions.register({\n        description: 'detected-link-active',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        collapseOnReplaceEdit: true,\n        inlineClassName: 'detected-link-active'\n    })\n};\nclass LinkOccurrence {\n    constructor(link, decorationId) {\n        this.link = link;\n        this.decorationId = decorationId;\n    }\n    static decoration(link, useMetaKey) {\n        return {\n            range: link.range,\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\n        };\n    }\n    static _getOptions(link, useMetaKey, isActive) {\n        const options = Object.assign({}, (isActive ? decoration.active : decoration.general));\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\n        return options;\n    }\n    activate(changeAccessor, useMetaKey) {\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\n    }\n    deactivate(changeAccessor, useMetaKey) {\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\n    }\n}\nfunction getHoverMessage(link, useMetaKey) {\n    const executeCmd = link.url && /^command:/i.test(link.url.toString());\n    const label = link.tooltip\n        ? link.tooltip\n        : executeCmd\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\n            : nls.localize('links.navigate.follow', 'Follow link');\n    const kb = useMetaKey\n        ? platform.isMacintosh\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\n        : platform.isMacintosh\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\n    if (link.url) {\n        let nativeLabel = '';\n        if (/^command:/i.test(link.url.toString())) {\n            // Don't show complete command arguments in the native tooltip\n            const match = link.url.toString().match(/^command:([^?#]+)/);\n            if (match) {\n                const commandId = match[1];\n                nativeLabel = nls.localize('tooltip.explanation', \"Execute command {0}\", commandId);\n            }\n        }\n        const hoverMessage = new MarkdownString('', true)\n            .appendLink(link.url.toString(true).replace(/ /g, '%20'), label, nativeLabel)\n            .appendMarkdown(` (${kb})`);\n        return hoverMessage;\n    }\n    else {\n        return new MarkdownString().appendText(`${label} (${kb})`);\n    }\n}\nclass OpenLinkAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.openLink',\n            label: nls.localize('label', \"Open Link\"),\n            alias: 'Open Link',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const linkDetector = LinkDetector.get(editor);\n        if (!linkDetector) {\n            return;\n        }\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        for (const sel of selections) {\n            const link = linkDetector.getLinkOccurrence(sel.getEndPosition());\n            if (link) {\n                linkDetector.openLinkOccurrence(link, false);\n            }\n        }\n    }\n}\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\nregisterEditorAction(OpenLinkAction);\nregisterThemingParticipant((theme, collector) => {\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n    if (activeLinkForeground) {\n        collector.addRule(`.monaco-editor .detected-link-active { color: ${activeLinkForeground} !important; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { CursorMoveCommands } from '../../../common/cursor/cursorMoveCommands.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane, MinimapPosition } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { CommonFindController } from '../../find/browser/findController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { overviewRulerSelectionHighlightForeground, minimapSelectionOccurrenceHighlight } from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nfunction announceCursorChange(previousCursorState, cursorState) {\n    const cursorDiff = cursorState.filter(cs => !previousCursorState.find(pcs => pcs.equals(cs)));\n    if (cursorDiff.length >= 1) {\n        const cursorPositions = cursorDiff.map(cs => `line ${cs.viewState.position.lineNumber} column ${cs.viewState.position.column}`).join(', ');\n        const msg = cursorDiff.length === 1 ? nls.localize('cursorAdded', \"Cursor added: {0}\", cursorPositions) : nls.localize('cursorsAdded', \"Cursors added: {0}\", cursorPositions);\n        status(msg);\n    }\n}\nexport class InsertCursorAbove extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorAbove',\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\n            alias: 'Add Cursor Above',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                linux: {\n                    primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                    secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */]\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\n                order: 2\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let useLogicalLine = true;\n        if (args && args.logicalLine === false) {\n            useLogicalLine = false;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = viewModel.getCursorStates();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.addCursorUp(viewModel, previousCursorState, useLogicalLine));\n        viewModel.revealTopMostCursor(args.source);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class InsertCursorBelow extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorBelow',\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\n            alias: 'Add Cursor Below',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                linux: {\n                    primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                    secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */]\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\n                order: 3\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let useLogicalLine = true;\n        if (args && args.logicalLine === false) {\n            useLogicalLine = false;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = viewModel.getCursorStates();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.addCursorDown(viewModel, previousCursorState, useLogicalLine));\n        viewModel.revealBottomMostCursor(args.source);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtEndOfEachLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\n            alias: 'Add Cursors to Line Ends',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 39 /* KeyCode.KeyI */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\n                order: 4\n            }\n        });\n    }\n    getCursorsForSelection(selection, model, result) {\n        if (selection.isEmpty()) {\n            return;\n        }\n        for (let i = selection.startLineNumber; i < selection.endLineNumber; i++) {\n            const currentLineMaxColumn = model.getLineMaxColumn(i);\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\n        }\n        if (selection.endColumn > 1) {\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\n        }\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        const newSelections = [];\n        selections.forEach((sel) => this.getCursorsForSelection(sel, model, newSelections));\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtEndOfLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.addCursorsToBottom',\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\n            alias: 'Add Cursors To Bottom',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        const lineCount = editor.getModel().getLineCount();\n        const newSelections = [];\n        for (let i = selections[0].startLineNumber; i <= lineCount; i++) {\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\n        }\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtTopOfLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.addCursorsToTop',\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\n            alias: 'Add Cursors To Top',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        const newSelections = [];\n        for (let i = selections[0].startLineNumber; i >= 1; i--) {\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\n        }\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class MultiCursorSessionResult {\n    constructor(selections, revealRange, revealScrollType) {\n        this.selections = selections;\n        this.revealRange = revealRange;\n        this.revealScrollType = revealScrollType;\n    }\n}\nexport class MultiCursorSession {\n    constructor(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\n        this._editor = _editor;\n        this.findController = findController;\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\n        this.searchText = searchText;\n        this.wholeWord = wholeWord;\n        this.matchCase = matchCase;\n        this.currentMatch = currentMatch;\n    }\n    static create(editor, findController) {\n        if (!editor.hasModel()) {\n            return null;\n        }\n        const findState = findController.getState();\n        // Find widget owns entirely what we search for if:\n        //  - focus is not in the editor (i.e. it is in the find widget)\n        //  - and the search widget is visible\n        //  - and the search string is non-empty\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\n            // Find widget owns what is searched for\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\n        }\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\n        let isDisconnectedFromFindController = false;\n        let wholeWord;\n        let matchCase;\n        const selections = editor.getSelections();\n        if (selections.length === 1 && selections[0].isEmpty()) {\n            isDisconnectedFromFindController = true;\n            wholeWord = true;\n            matchCase = true;\n        }\n        else {\n            wholeWord = findState.wholeWord;\n            matchCase = findState.matchCase;\n        }\n        // Selection owns what is searched for\n        const s = editor.getSelection();\n        let searchText;\n        let currentMatch = null;\n        if (s.isEmpty()) {\n            // selection is empty => expand to current word\n            const word = editor.getConfiguredWordAtPosition(s.getStartPosition());\n            if (!word) {\n                return null;\n            }\n            searchText = word.word;\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\n        }\n        else {\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\n        }\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\n    }\n    addSelectionToNextFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const nextMatch = this._getNextMatch();\n        if (!nextMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* ScrollType.Smooth */);\n    }\n    moveSelectionToNextFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const nextMatch = this._getNextMatch();\n        if (!nextMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* ScrollType.Smooth */);\n    }\n    _getNextMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        if (this.currentMatch) {\n            const result = this.currentMatch;\n            this.currentMatch = null;\n            return result;\n        }\n        this.findController.highlightFindOptions();\n        const allSelections = this._editor.getSelections();\n        const lastAddedSelection = allSelections[allSelections.length - 1];\n        const nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false);\n        if (!nextMatch) {\n            return null;\n        }\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\n    }\n    addSelectionToPreviousFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const previousMatch = this._getPreviousMatch();\n        if (!previousMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* ScrollType.Smooth */);\n    }\n    moveSelectionToPreviousFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const previousMatch = this._getPreviousMatch();\n        if (!previousMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* ScrollType.Smooth */);\n    }\n    _getPreviousMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        if (this.currentMatch) {\n            const result = this.currentMatch;\n            this.currentMatch = null;\n            return result;\n        }\n        this.findController.highlightFindOptions();\n        const allSelections = this._editor.getSelections();\n        const lastAddedSelection = allSelections[allSelections.length - 1];\n        const previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false);\n        if (!previousMatch) {\n            return null;\n        }\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\n    }\n    selectAll(searchScope) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this.findController.highlightFindOptions();\n        const editorModel = this._editor.getModel();\n        if (searchScope) {\n            return editorModel.findMatches(this.searchText, searchScope, false, this.matchCase, this.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        }\n        return editorModel.findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n    }\n}\nexport class MultiCursorSelectionController extends Disposable {\n    constructor(editor) {\n        super();\n        this._sessionDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._ignoreSelectionChange = false;\n        this._session = null;\n    }\n    static get(editor) {\n        return editor.getContribution(MultiCursorSelectionController.ID);\n    }\n    dispose() {\n        this._endSession();\n        super.dispose();\n    }\n    _beginSessionIfNeeded(findController) {\n        if (!this._session) {\n            // Create a new session\n            const session = MultiCursorSession.create(this._editor, findController);\n            if (!session) {\n                return;\n            }\n            this._session = session;\n            const newState = { searchString: this._session.searchText };\n            if (this._session.isDisconnectedFromFindController) {\n                newState.wholeWordOverride = 1 /* FindOptionOverride.True */;\n                newState.matchCaseOverride = 1 /* FindOptionOverride.True */;\n                newState.isRegexOverride = 2 /* FindOptionOverride.False */;\n            }\n            findController.getState().change(newState, false);\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e) => {\n                if (this._ignoreSelectionChange) {\n                    return;\n                }\n                this._endSession();\n            }));\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(() => {\n                this._endSession();\n            }));\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange((e) => {\n                if (e.matchCase || e.wholeWord) {\n                    this._endSession();\n                }\n            }));\n        }\n    }\n    _endSession() {\n        this._sessionDispose.clear();\n        if (this._session && this._session.isDisconnectedFromFindController) {\n            const newState = {\n                wholeWordOverride: 0 /* FindOptionOverride.NotSet */,\n                matchCaseOverride: 0 /* FindOptionOverride.NotSet */,\n                isRegexOverride: 0 /* FindOptionOverride.NotSet */,\n            };\n            this._session.findController.getState().change(newState, false);\n        }\n        this._session = null;\n    }\n    _setSelections(selections) {\n        this._ignoreSelectionChange = true;\n        this._editor.setSelections(selections);\n        this._ignoreSelectionChange = false;\n    }\n    _expandEmptyToWord(model, selection) {\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const word = this._editor.getConfiguredWordAtPosition(selection.getStartPosition());\n        if (!word) {\n            return selection;\n        }\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n    }\n    _applySessionResult(result) {\n        if (!result) {\n            return;\n        }\n        this._setSelections(result.selections);\n        if (result.revealRange) {\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\n        }\n    }\n    getSession(findController) {\n        return this._session;\n    }\n    addSelectionToNextFindMatch(findController) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._session) {\n            // If there are multiple cursors, handle the case where they do not all select the same text.\n            const allSelections = this._editor.getSelections();\n            if (allSelections.length > 1) {\n                const findState = findController.getState();\n                const matchCase = findState.matchCase;\n                const selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\n                if (!selectionsContainSameText) {\n                    const model = this._editor.getModel();\n                    const resultingSelections = [];\n                    for (let i = 0, len = allSelections.length; i < len; i++) {\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\n                    }\n                    this._editor.setSelections(resultingSelections);\n                    return;\n                }\n            }\n        }\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\n        }\n    }\n    addSelectionToPreviousFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\n        }\n    }\n    moveSelectionToNextFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\n        }\n    }\n    moveSelectionToPreviousFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\n        }\n    }\n    selectAll(findController) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        let matches = null;\n        const findState = findController.getState();\n        // Special case: find widget owns entirely what we search for if:\n        // - focus is not in the editor (i.e. it is in the find widget)\n        // - and the search widget is visible\n        // - and the search string is non-empty\n        // - and we're searching for a regex\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\n            const editorModel = this._editor.getModel();\n            if (findState.searchScope) {\n                matches = editorModel.findMatches(findState.searchString, findState.searchScope, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n            }\n            else {\n                matches = editorModel.findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(119 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n            }\n        }\n        else {\n            this._beginSessionIfNeeded(findController);\n            if (!this._session) {\n                return;\n            }\n            matches = this._session.selectAll(findState.searchScope);\n        }\n        if (matches.length > 0) {\n            const editorSelection = this._editor.getSelection();\n            // Have the primary cursor remain the one where the action was invoked\n            for (let i = 0, len = matches.length; i < len; i++) {\n                const match = matches[i];\n                const intersection = match.range.intersectRanges(editorSelection);\n                if (intersection) {\n                    // bingo!\n                    matches[i] = matches[0];\n                    matches[0] = match;\n                    break;\n                }\n            }\n            this._setSelections(matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn)));\n        }\n    }\n}\nMultiCursorSelectionController.ID = 'editor.contrib.multiCursorController';\nexport class MultiCursorSelectionControllerAction extends EditorAction {\n    run(accessor, editor) {\n        const multiCursorController = MultiCursorSelectionController.get(editor);\n        if (!multiCursorController) {\n            return;\n        }\n        const findController = CommonFindController.get(editor);\n        if (!findController) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel) {\n            const previousCursorState = viewModel.getCursorStates();\n            this._run(multiCursorController, findController);\n            announceCursorChange(previousCursorState, viewModel.getCursorStates());\n        }\n    }\n}\nexport class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.addSelectionToNextFindMatch',\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\n            alias: 'Add Selection To Next Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 34 /* KeyCode.KeyD */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\n                order: 5\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.addSelectionToNextFindMatch(findController);\n    }\n}\nexport class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.addSelectionToPreviousFindMatch',\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\n            alias: 'Add Selection To Previous Find Match',\n            precondition: undefined,\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\n                order: 6\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\n    }\n}\nexport class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.moveSelectionToNextFindMatch',\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\n            alias: 'Move Last Selection To Next Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 34 /* KeyCode.KeyD */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.moveSelectionToNextFindMatch(findController);\n    }\n}\nexport class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\n            alias: 'Move Last Selection To Previous Find Match',\n            precondition: undefined\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\n    }\n}\nexport class SelectHighlightsAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectHighlights',\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\n            alias: 'Select All Occurrences of Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 42 /* KeyCode.KeyL */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\n                order: 7\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.selectAll(findController);\n    }\n}\nexport class CompatChangeAll extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.changeAll',\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\n            alias: 'Change All Occurrences',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.2\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.selectAll(findController);\n    }\n}\nclass SelectionHighlighterState {\n    constructor(_model, _searchText, _matchCase, _wordSeparators, prevState) {\n        this._model = _model;\n        this._searchText = _searchText;\n        this._matchCase = _matchCase;\n        this._wordSeparators = _wordSeparators;\n        this._modelVersionId = this._model.getVersionId();\n        this._cachedFindMatches = null;\n        if (prevState\n            && this._model === prevState._model\n            && this._searchText === prevState._searchText\n            && this._matchCase === prevState._matchCase\n            && this._wordSeparators === prevState._wordSeparators\n            && this._modelVersionId === prevState._modelVersionId) {\n            this._cachedFindMatches = prevState._cachedFindMatches;\n        }\n    }\n    findMatches() {\n        if (this._cachedFindMatches === null) {\n            this._cachedFindMatches = this._model.findMatches(this._searchText, true, false, this._matchCase, this._wordSeparators, false).map(m => m.range);\n            this._cachedFindMatches.sort(Range.compareRangesUsingStarts);\n        }\n        return this._cachedFindMatches;\n    }\n}\nlet SelectionHighlighter = class SelectionHighlighter extends Disposable {\n    constructor(editor, _languageFeaturesService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this.editor = editor;\n        this._isEnabled = editor.getOption(99 /* EditorOption.selectionHighlight */);\n        this._decorations = editor.createDecorationsCollection();\n        this.updateSoon = this._register(new RunOnceScheduler(() => this._update(), 300));\n        this.state = null;\n        this._register(editor.onDidChangeConfiguration((e) => {\n            this._isEnabled = editor.getOption(99 /* EditorOption.selectionHighlight */);\n        }));\n        this._register(editor.onDidChangeCursorSelection((e) => {\n            if (!this._isEnabled) {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            if (e.selection.isEmpty()) {\n                if (e.reason === 3 /* CursorChangeReason.Explicit */) {\n                    if (this.state) {\n                        // no longer valid\n                        this._setState(null);\n                    }\n                    this.updateSoon.schedule();\n                }\n                else {\n                    this._setState(null);\n                }\n            }\n            else {\n                this._update();\n            }\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this._setState(null);\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            if (this._isEnabled) {\n                this.updateSoon.schedule();\n            }\n        }));\n        const findController = CommonFindController.get(editor);\n        if (findController) {\n            this._register(findController.getState().onFindReplaceStateChange((e) => {\n                this._update();\n            }));\n        }\n    }\n    _update() {\n        this._setState(SelectionHighlighter._createState(this.state, this._isEnabled, this.editor));\n    }\n    static _createState(oldState, isEnabled, editor) {\n        if (!isEnabled) {\n            return null;\n        }\n        if (!editor.hasModel()) {\n            return null;\n        }\n        const s = editor.getSelection();\n        if (s.startLineNumber !== s.endLineNumber) {\n            // multiline forbidden for perf reasons\n            return null;\n        }\n        const multiCursorController = MultiCursorSelectionController.get(editor);\n        if (!multiCursorController) {\n            return null;\n        }\n        const findController = CommonFindController.get(editor);\n        if (!findController) {\n            return null;\n        }\n        let r = multiCursorController.getSession(findController);\n        if (!r) {\n            const allSelections = editor.getSelections();\n            if (allSelections.length > 1) {\n                const findState = findController.getState();\n                const matchCase = findState.matchCase;\n                const selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\n                if (!selectionsContainSameText) {\n                    return null;\n                }\n            }\n            r = MultiCursorSession.create(editor, findController);\n        }\n        if (!r) {\n            return null;\n        }\n        if (r.currentMatch) {\n            // This is an empty selection\n            // Do not interfere with semantic word highlighting in the no selection case\n            return null;\n        }\n        if (/^[ \\t]+$/.test(r.searchText)) {\n            // whitespace only selection\n            return null;\n        }\n        if (r.searchText.length > 200) {\n            // very long selection\n            return null;\n        }\n        // TODO: better handling of this case\n        const findState = findController.getState();\n        const caseSensitive = findState.matchCase;\n        // Return early if the find widget shows the exact same matches\n        if (findState.isRevealed) {\n            let findStateSearchString = findState.searchString;\n            if (!caseSensitive) {\n                findStateSearchString = findStateSearchString.toLowerCase();\n            }\n            let mySearchString = r.searchText;\n            if (!caseSensitive) {\n                mySearchString = mySearchString.toLowerCase();\n            }\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\n                return null;\n            }\n        }\n        return new SelectionHighlighterState(editor.getModel(), r.searchText, r.matchCase, r.wholeWord ? editor.getOption(119 /* EditorOption.wordSeparators */) : null, oldState);\n    }\n    _setState(newState) {\n        this.state = newState;\n        if (!this.state) {\n            this._decorations.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (model.isTooLargeForTokenization()) {\n            // the file is too large, so searching word under cursor in the whole document would be blocking the UI.\n            return;\n        }\n        const allMatches = this.state.findMatches();\n        const selections = this.editor.getSelections();\n        selections.sort(Range.compareRangesUsingStarts);\n        // do not overlap with selection (issue #64 and #512)\n        const matches = [];\n        for (let i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\n            const match = allMatches[i];\n            if (j >= lenJ) {\n                // finished all editor selections\n                matches.push(match);\n                i++;\n            }\n            else {\n                const cmp = Range.compareRangesUsingStarts(match, selections[j]);\n                if (cmp < 0) {\n                    // match is before sel\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\n                        matches.push(match);\n                    }\n                    i++;\n                }\n                else if (cmp > 0) {\n                    // sel is before match\n                    j++;\n                }\n                else {\n                    // sel is equal to match\n                    i++;\n                    j++;\n                }\n            }\n        }\n        const hasFindOccurrences = this._languageFeaturesService.documentHighlightProvider.has(model) && this.editor.getOption(74 /* EditorOption.occurrencesHighlight */);\n        const decorations = matches.map(r => {\n            return {\n                range: r,\n                // Show in overviewRuler only if model has no semantic highlighting\n                options: (hasFindOccurrences ? SelectionHighlighter._SELECTION_HIGHLIGHT : SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW)\n            };\n        });\n        this._decorations.set(decorations);\n    }\n    dispose() {\n        this._setState(null);\n        super.dispose();\n    }\n};\nSelectionHighlighter.ID = 'editor.contrib.selectionHighlighter';\nSelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW = ModelDecorationOptions.register({\n    description: 'selection-highlight-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerSelectionHighlightForeground),\n        position: OverviewRulerLane.Center\n    }\n});\nSelectionHighlighter._SELECTION_HIGHLIGHT = ModelDecorationOptions.register({\n    description: 'selection-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n});\nSelectionHighlighter = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SelectionHighlighter);\nexport { SelectionHighlighter };\nfunction modelRangesContainSameText(model, ranges, matchCase) {\n    const selectedText = getValueInRange(model, ranges[0], !matchCase);\n    for (let i = 1, len = ranges.length; i < len; i++) {\n        const range = ranges[i];\n        if (range.isEmpty()) {\n            return false;\n        }\n        const thisSelectedText = getValueInRange(model, range, !matchCase);\n        if (selectedText !== thisSelectedText) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction getValueInRange(model, range, toLowerCase) {\n    const text = model.getValueInRange(range);\n    return (toLowerCase ? text.toLowerCase() : text);\n}\nexport class FocusNextCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.focusNextCursor',\n            label: nls.localize('mutlicursor.focusNextCursor', \"Focus Next Cursor\"),\n            description: {\n                description: nls.localize('mutlicursor.focusNextCursor.description', \"Focuses the next cursor\"),\n                args: [],\n            },\n            alias: 'Focus Next Cursor',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = Array.from(viewModel.getCursorStates());\n        const firstCursor = previousCursorState.shift();\n        if (!firstCursor) {\n            return;\n        }\n        previousCursorState.push(firstCursor);\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, previousCursorState);\n        viewModel.revealPrimaryCursor(args.source, true);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class FocusPreviousCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.focusPreviousCursor',\n            label: nls.localize('mutlicursor.focusPreviousCursor', \"Focus Previous Cursor\"),\n            description: {\n                description: nls.localize('mutlicursor.focusPreviousCursor.description', \"Focuses the previous cursor\"),\n                args: [],\n            },\n            alias: 'Focus Previous Cursor',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = Array.from(viewModel.getCursorStates());\n        const firstCursor = previousCursorState.pop();\n        if (!firstCursor) {\n            return;\n        }\n        previousCursorState.unshift(firstCursor);\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, previousCursorState);\n        viewModel.revealPrimaryCursor(args.source, true);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController);\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter);\nregisterEditorAction(InsertCursorAbove);\nregisterEditorAction(InsertCursorBelow);\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\nregisterEditorAction(AddSelectionToNextFindMatchAction);\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\nregisterEditorAction(SelectHighlightsAction);\nregisterEditorAction(CompatChangeAll);\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\nregisterEditorAction(FocusNextCursor);\nregisterEditorAction(FocusPreviousCursor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport * as languages from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const Context = {\n    Visible: new RawContextKey('parameterHintsVisible', false),\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\n};\nexport function provideSignatureHelp(registry, model, position, context, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const supports = registry.ordered(model);\n        for (const support of supports) {\n            try {\n                const result = yield support.provideSignatureHelp(model, position, token, context);\n                if (result) {\n                    return result;\n                }\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }\n        return undefined;\n    });\n}\nCommandsRegistry.registerCommand('_executeSignatureHelpProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, position, triggerCharacter] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = yield provideSignatureHelp(languageFeaturesService.signatureHelpProvider, ref.object.textEditorModel, Position.lift(position), {\n            triggerKind: languages.SignatureHelpTriggerKind.Invoke,\n            isRetrigger: false,\n            triggerCharacter,\n        }, CancellationToken.None);\n        if (!result) {\n            return undefined;\n        }\n        setTimeout(() => result.dispose(), 0);\n        return result.value;\n    }\n    finally {\n        ref.dispose();\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport * as languages from '../../../common/languages.js';\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\nvar ParameterHintState;\n(function (ParameterHintState) {\n    ParameterHintState.Default = { type: 0 /* Type.Default */ };\n    class Pending {\n        constructor(request, previouslyActiveHints) {\n            this.request = request;\n            this.previouslyActiveHints = previouslyActiveHints;\n            this.type = 2 /* Type.Pending */;\n        }\n    }\n    ParameterHintState.Pending = Pending;\n    class Active {\n        constructor(hints) {\n            this.hints = hints;\n            this.type = 1 /* Type.Active */;\n        }\n    }\n    ParameterHintState.Active = Active;\n})(ParameterHintState || (ParameterHintState = {}));\nexport class ParameterHintsModel extends Disposable {\n    constructor(editor, providers, delay = ParameterHintsModel.DEFAULT_DELAY) {\n        super();\n        this._onChangedHints = this._register(new Emitter());\n        this.onChangedHints = this._onChangedHints.event;\n        this.triggerOnType = false;\n        this._state = ParameterHintState.Default;\n        this._pendingTriggers = [];\n        this._lastSignatureHelpResult = this._register(new MutableDisposable());\n        this.triggerChars = new CharacterSet();\n        this.retriggerChars = new CharacterSet();\n        this.triggerId = 0;\n        this.editor = editor;\n        this.providers = providers;\n        this.throttledDelayer = new Delayer(delay);\n        this._register(this.editor.onDidBlurEditorWidget(() => this.cancel()));\n        this._register(this.editor.onDidChangeConfiguration(() => this.onEditorConfigurationChange()));\n        this._register(this.editor.onDidChangeModel(e => this.onModelChanged()));\n        this._register(this.editor.onDidChangeModelLanguage(_ => this.onModelChanged()));\n        this._register(this.editor.onDidChangeCursorSelection(e => this.onCursorChange(e)));\n        this._register(this.editor.onDidChangeModelContent(e => this.onModelContentChange()));\n        this._register(this.providers.onDidChange(this.onModelChanged, this));\n        this._register(this.editor.onDidType(text => this.onDidType(text)));\n        this.onEditorConfigurationChange();\n        this.onModelChanged();\n    }\n    get state() { return this._state; }\n    set state(value) {\n        if (this._state.type === 2 /* ParameterHintState.Type.Pending */) {\n            this._state.request.cancel();\n        }\n        this._state = value;\n    }\n    cancel(silent = false) {\n        this.state = ParameterHintState.Default;\n        this.throttledDelayer.cancel();\n        if (!silent) {\n            this._onChangedHints.fire(undefined);\n        }\n    }\n    trigger(context, delay) {\n        const model = this.editor.getModel();\n        if (!model || !this.providers.has(model)) {\n            return;\n        }\n        const triggerId = ++this.triggerId;\n        this._pendingTriggers.push(context);\n        this.throttledDelayer.trigger(() => {\n            return this.doTrigger(triggerId);\n        }, delay)\n            .catch(onUnexpectedError);\n    }\n    next() {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        const length = this.state.hints.signatures.length;\n        const activeSignature = this.state.hints.activeSignature;\n        const last = (activeSignature % length) === (length - 1);\n        const cycle = this.editor.getOption(78 /* EditorOption.parameterHints */).cycle;\n        // If there is only one signature, or we're on last signature of list\n        if ((length < 2 || last) && !cycle) {\n            this.cancel();\n            return;\n        }\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\n    }\n    previous() {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        const length = this.state.hints.signatures.length;\n        const activeSignature = this.state.hints.activeSignature;\n        const first = activeSignature === 0;\n        const cycle = this.editor.getOption(78 /* EditorOption.parameterHints */).cycle;\n        // If there is only one signature, or we're on first signature of list\n        if ((length < 2 || first) && !cycle) {\n            this.cancel();\n            return;\n        }\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\n    }\n    updateActiveSignature(activeSignature) {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        this.state = new ParameterHintState.Active(Object.assign(Object.assign({}, this.state.hints), { activeSignature }));\n        this._onChangedHints.fire(this.state.hints);\n    }\n    doTrigger(triggerId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const isRetrigger = this.state.type === 1 /* ParameterHintState.Type.Active */ || this.state.type === 2 /* ParameterHintState.Type.Pending */;\n            const activeSignatureHelp = this.getLastActiveHints();\n            this.cancel(true);\n            if (this._pendingTriggers.length === 0) {\n                return false;\n            }\n            const context = this._pendingTriggers.reduce(mergeTriggerContexts);\n            this._pendingTriggers = [];\n            const triggerContext = {\n                triggerKind: context.triggerKind,\n                triggerCharacter: context.triggerCharacter,\n                isRetrigger: isRetrigger,\n                activeSignatureHelp: activeSignatureHelp\n            };\n            if (!this.editor.hasModel()) {\n                return false;\n            }\n            const model = this.editor.getModel();\n            const position = this.editor.getPosition();\n            this.state = new ParameterHintState.Pending(createCancelablePromise(token => provideSignatureHelp(this.providers, model, position, triggerContext, token)), activeSignatureHelp);\n            try {\n                const result = yield this.state.request;\n                // Check that we are still resolving the correct signature help\n                if (triggerId !== this.triggerId) {\n                    result === null || result === void 0 ? void 0 : result.dispose();\n                    return false;\n                }\n                if (!result || !result.value.signatures || result.value.signatures.length === 0) {\n                    result === null || result === void 0 ? void 0 : result.dispose();\n                    this._lastSignatureHelpResult.clear();\n                    this.cancel();\n                    return false;\n                }\n                else {\n                    this.state = new ParameterHintState.Active(result.value);\n                    this._lastSignatureHelpResult.value = result;\n                    this._onChangedHints.fire(this.state.hints);\n                    return true;\n                }\n            }\n            catch (error) {\n                if (triggerId === this.triggerId) {\n                    this.state = ParameterHintState.Default;\n                }\n                onUnexpectedError(error);\n                return false;\n            }\n        });\n    }\n    getLastActiveHints() {\n        switch (this.state.type) {\n            case 1 /* ParameterHintState.Type.Active */: return this.state.hints;\n            case 2 /* ParameterHintState.Type.Pending */: return this.state.previouslyActiveHints;\n            default: return undefined;\n        }\n    }\n    get isTriggered() {\n        return this.state.type === 1 /* ParameterHintState.Type.Active */\n            || this.state.type === 2 /* ParameterHintState.Type.Pending */\n            || this.throttledDelayer.isTriggered();\n    }\n    onModelChanged() {\n        this.cancel();\n        // Update trigger characters\n        this.triggerChars = new CharacterSet();\n        this.retriggerChars = new CharacterSet();\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const support of this.providers.ordered(model)) {\n            for (const ch of support.signatureHelpTriggerCharacters || []) {\n                this.triggerChars.add(ch.charCodeAt(0));\n                // All trigger characters are also considered retrigger characters\n                this.retriggerChars.add(ch.charCodeAt(0));\n            }\n            for (const ch of support.signatureHelpRetriggerCharacters || []) {\n                this.retriggerChars.add(ch.charCodeAt(0));\n            }\n        }\n    }\n    onDidType(text) {\n        if (!this.triggerOnType) {\n            return;\n        }\n        const lastCharIndex = text.length - 1;\n        const triggerCharCode = text.charCodeAt(lastCharIndex);\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\n            this.trigger({\n                triggerKind: languages.SignatureHelpTriggerKind.TriggerCharacter,\n                triggerCharacter: text.charAt(lastCharIndex),\n            });\n        }\n    }\n    onCursorChange(e) {\n        if (e.source === 'mouse') {\n            this.cancel();\n        }\n        else if (this.isTriggered) {\n            this.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n        }\n    }\n    onModelContentChange() {\n        if (this.isTriggered) {\n            this.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n        }\n    }\n    onEditorConfigurationChange() {\n        this.triggerOnType = this.editor.getOption(78 /* EditorOption.parameterHints */).enabled;\n        if (!this.triggerOnType) {\n            this.cancel();\n        }\n    }\n    dispose() {\n        this.cancel(true);\n        super.dispose();\n    }\n}\nParameterHintsModel.DEFAULT_DELAY = 120; // ms\nfunction mergeTriggerContexts(previous, current) {\n    switch (current.triggerKind) {\n        case languages.SignatureHelpTriggerKind.Invoke:\n            // Invoke overrides previous triggers.\n            return current;\n        case languages.SignatureHelpTriggerKind.ContentChange:\n            // Ignore content changes triggers\n            return previous;\n        case languages.SignatureHelpTriggerKind.TriggerCharacter:\n        default:\n            return current;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport { assertIsDefined } from '../../../../base/common/types.js';\nimport './parameterHints.css';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { ParameterHintsModel } from './parameterHintsModel.js';\nimport { Context } from './provideSignatureHelp.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { editorHoverBackground, editorHoverBorder, editorHoverForeground, listHighlightForeground, registerColor, textCodeBlockBackground, textLinkActiveForeground, textLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { registerThemingParticipant, ThemeIcon } from '../../../../platform/theme/common/themeService.js';\nconst $ = dom.$;\nconst parameterHintsNextIcon = registerIcon('parameter-hints-next', Codicon.chevronDown, nls.localize('parameterHintsNextIcon', 'Icon for show next parameter hint.'));\nconst parameterHintsPreviousIcon = registerIcon('parameter-hints-previous', Codicon.chevronUp, nls.localize('parameterHintsPreviousIcon', 'Icon for show previous parameter hint.'));\nlet ParameterHintsWidget = class ParameterHintsWidget extends Disposable {\n    constructor(editor, contextKeyService, openerService, languageService, languageFeaturesService) {\n        super();\n        this.editor = editor;\n        this.renderDisposeables = this._register(new DisposableStore());\n        this.visible = false;\n        this.announcedLabel = null;\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.markdownRenderer = this._register(new MarkdownRenderer({ editor }, languageService, openerService));\n        this.model = this._register(new ParameterHintsModel(editor, languageFeaturesService.signatureHelpProvider));\n        this.keyVisible = Context.Visible.bindTo(contextKeyService);\n        this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\n        this._register(this.model.onChangedHints(newParameterHints => {\n            if (newParameterHints) {\n                this.show();\n                this.render(newParameterHints);\n            }\n            else {\n                this.hide();\n            }\n        }));\n    }\n    createParameterHintDOMNodes() {\n        const element = $('.editor-widget.parameter-hints-widget');\n        const wrapper = dom.append(element, $('.phwrapper'));\n        wrapper.tabIndex = -1;\n        const controls = dom.append(wrapper, $('.controls'));\n        const previous = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsPreviousIcon)));\n        const overloads = dom.append(controls, $('.overloads'));\n        const next = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsNextIcon)));\n        this._register(dom.addDisposableListener(previous, 'click', e => {\n            dom.EventHelper.stop(e);\n            this.previous();\n        }));\n        this._register(dom.addDisposableListener(next, 'click', e => {\n            dom.EventHelper.stop(e);\n            this.next();\n        }));\n        const body = $('.body');\n        const scrollbar = new DomScrollableElement(body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        this._register(scrollbar);\n        wrapper.appendChild(scrollbar.getDomNode());\n        const signature = dom.append(body, $('.signature'));\n        const docs = dom.append(body, $('.docs'));\n        element.style.userSelect = 'text';\n        this.domNodes = {\n            element,\n            signature,\n            overloads,\n            docs,\n            scrollbar,\n        };\n        this.editor.addContentWidget(this);\n        this.hide();\n        this._register(this.editor.onDidChangeCursorSelection(e => {\n            if (this.visible) {\n                this.editor.layoutContentWidget(this);\n            }\n        }));\n        const updateFont = () => {\n            if (!this.domNodes) {\n                return;\n            }\n            const fontInfo = this.editor.getOption(46 /* EditorOption.fontInfo */);\n            this.domNodes.element.style.fontSize = `${fontInfo.fontSize}px`;\n            this.domNodes.element.style.lineHeight = `${fontInfo.lineHeight / fontInfo.fontSize}`;\n        };\n        updateFont();\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\n            .filter(e => e.hasChanged(46 /* EditorOption.fontInfo */))\n            .on(updateFont, null));\n        this._register(this.editor.onDidLayoutChange(e => this.updateMaxHeight()));\n        this.updateMaxHeight();\n    }\n    show() {\n        if (this.visible) {\n            return;\n        }\n        if (!this.domNodes) {\n            this.createParameterHintDOMNodes();\n        }\n        this.keyVisible.set(true);\n        this.visible = true;\n        setTimeout(() => {\n            var _a;\n            (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.element.classList.add('visible');\n        }, 100);\n        this.editor.layoutContentWidget(this);\n    }\n    hide() {\n        var _a;\n        this.renderDisposeables.clear();\n        if (!this.visible) {\n            return;\n        }\n        this.keyVisible.reset();\n        this.visible = false;\n        this.announcedLabel = null;\n        (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.element.classList.remove('visible');\n        this.editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this.visible) {\n            return {\n                position: this.editor.getPosition(),\n                preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */]\n            };\n        }\n        return null;\n    }\n    render(hints) {\n        var _a;\n        this.renderDisposeables.clear();\n        if (!this.domNodes) {\n            return;\n        }\n        const multiple = hints.signatures.length > 1;\n        this.domNodes.element.classList.toggle('multiple', multiple);\n        this.keyMultipleSignatures.set(multiple);\n        this.domNodes.signature.innerText = '';\n        this.domNodes.docs.innerText = '';\n        const signature = hints.signatures[hints.activeSignature];\n        if (!signature) {\n            return;\n        }\n        const code = dom.append(this.domNodes.signature, $('.code'));\n        const fontInfo = this.editor.getOption(46 /* EditorOption.fontInfo */);\n        code.style.fontSize = `${fontInfo.fontSize}px`;\n        code.style.fontFamily = fontInfo.fontFamily;\n        const hasParameters = signature.parameters.length > 0;\n        const activeParameterIndex = (_a = signature.activeParameter) !== null && _a !== void 0 ? _a : hints.activeParameter;\n        if (!hasParameters) {\n            const label = dom.append(code, $('span'));\n            label.textContent = signature.label;\n        }\n        else {\n            this.renderParameters(code, signature, activeParameterIndex);\n        }\n        const activeParameter = signature.parameters[activeParameterIndex];\n        if (activeParameter === null || activeParameter === void 0 ? void 0 : activeParameter.documentation) {\n            const documentation = $('span.documentation');\n            if (typeof activeParameter.documentation === 'string') {\n                documentation.textContent = activeParameter.documentation;\n            }\n            else {\n                const renderedContents = this.renderMarkdownDocs(activeParameter.documentation);\n                documentation.appendChild(renderedContents.element);\n            }\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\n        }\n        if (signature.documentation === undefined) {\n            /** no op */\n        }\n        else if (typeof signature.documentation === 'string') {\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\n        }\n        else {\n            const renderedContents = this.renderMarkdownDocs(signature.documentation);\n            dom.append(this.domNodes.docs, renderedContents.element);\n        }\n        const hasDocs = this.hasDocs(signature, activeParameter);\n        this.domNodes.signature.classList.toggle('has-docs', hasDocs);\n        this.domNodes.docs.classList.toggle('empty', !hasDocs);\n        this.domNodes.overloads.textContent =\n            String(hints.activeSignature + 1).padStart(hints.signatures.length.toString().length, '0') + '/' + hints.signatures.length;\n        if (activeParameter) {\n            let labelToAnnounce = '';\n            const param = signature.parameters[activeParameterIndex];\n            if (Array.isArray(param.label)) {\n                labelToAnnounce = signature.label.substring(param.label[0], param.label[1]);\n            }\n            else {\n                labelToAnnounce = param.label;\n            }\n            if (param.documentation) {\n                labelToAnnounce += typeof param.documentation === 'string' ? `, ${param.documentation}` : `, ${param.documentation.value}`;\n            }\n            if (signature.documentation) {\n                labelToAnnounce += typeof signature.documentation === 'string' ? `, ${signature.documentation}` : `, ${signature.documentation.value}`;\n            }\n            // Select method gets called on every user type while parameter hints are visible.\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\n            if (this.announcedLabel !== labelToAnnounce) {\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\n                this.announcedLabel = labelToAnnounce;\n            }\n        }\n        this.editor.layoutContentWidget(this);\n        this.domNodes.scrollbar.scanDomNode();\n    }\n    renderMarkdownDocs(markdown) {\n        const renderedContents = this.renderDisposeables.add(this.markdownRenderer.render(markdown, {\n            asyncRenderCallback: () => {\n                var _a;\n                (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.scrollbar.scanDomNode();\n            }\n        }));\n        renderedContents.element.classList.add('markdown-docs');\n        return renderedContents;\n    }\n    hasDocs(signature, activeParameter) {\n        if (activeParameter && typeof activeParameter.documentation === 'string' && assertIsDefined(activeParameter.documentation).length > 0) {\n            return true;\n        }\n        if (activeParameter && typeof activeParameter.documentation === 'object' && assertIsDefined(activeParameter.documentation).value.length > 0) {\n            return true;\n        }\n        if (signature.documentation && typeof signature.documentation === 'string' && assertIsDefined(signature.documentation).length > 0) {\n            return true;\n        }\n        if (signature.documentation && typeof signature.documentation === 'object' && assertIsDefined(signature.documentation.value).length > 0) {\n            return true;\n        }\n        return false;\n    }\n    renderParameters(parent, signature, activeParameterIndex) {\n        const [start, end] = this.getParameterLabelOffsets(signature, activeParameterIndex);\n        const beforeSpan = document.createElement('span');\n        beforeSpan.textContent = signature.label.substring(0, start);\n        const paramSpan = document.createElement('span');\n        paramSpan.textContent = signature.label.substring(start, end);\n        paramSpan.className = 'parameter active';\n        const afterSpan = document.createElement('span');\n        afterSpan.textContent = signature.label.substring(end);\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\n    }\n    getParameterLabelOffsets(signature, paramIdx) {\n        const param = signature.parameters[paramIdx];\n        if (!param) {\n            return [0, 0];\n        }\n        else if (Array.isArray(param.label)) {\n            return param.label;\n        }\n        else if (!param.label.length) {\n            return [0, 0];\n        }\n        else {\n            const regex = new RegExp(`(\\\\W|^)${escapeRegExpCharacters(param.label)}(?=\\\\W|$)`, 'g');\n            regex.test(signature.label);\n            const idx = regex.lastIndex - param.label.length;\n            return idx >= 0\n                ? [idx, regex.lastIndex]\n                : [0, 0];\n        }\n    }\n    next() {\n        this.editor.focus();\n        this.model.next();\n    }\n    previous() {\n        this.editor.focus();\n        this.model.previous();\n    }\n    cancel() {\n        this.model.cancel();\n    }\n    getDomNode() {\n        if (!this.domNodes) {\n            this.createParameterHintDOMNodes();\n        }\n        return this.domNodes.element;\n    }\n    getId() {\n        return ParameterHintsWidget.ID;\n    }\n    trigger(context) {\n        this.model.trigger(context, 0);\n    }\n    updateMaxHeight() {\n        if (!this.domNodes) {\n            return;\n        }\n        const height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\n        const maxHeight = `${height}px`;\n        this.domNodes.element.style.maxHeight = maxHeight;\n        const wrapper = this.domNodes.element.getElementsByClassName('phwrapper');\n        if (wrapper.length) {\n            wrapper[0].style.maxHeight = maxHeight;\n        }\n    }\n};\nParameterHintsWidget.ID = 'editor.widget.parameterHintsWidget';\nParameterHintsWidget = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageService),\n    __param(4, ILanguageFeaturesService)\n], ParameterHintsWidget);\nexport { ParameterHintsWidget };\nexport const editorHoverWidgetHighlightForeground = registerColor('editorHoverWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hcDark: listHighlightForeground, hcLight: listHighlightForeground }, nls.localize('editorHoverWidgetHighlightForeground', 'Foreground color of the active item in the parameter hint.'));\nregisterThemingParticipant((theme, collector) => {\n    const border = theme.getColor(editorHoverBorder);\n    if (border) {\n        const borderWidth = isHighContrast(theme.type) ? 2 : 1;\n        collector.addRule(`.monaco-editor .parameter-hints-widget { border: ${borderWidth}px solid ${border}; }`);\n        collector.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${border.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${border.transparent(0.5)}; }`);\n    }\n    const background = theme.getColor(editorHoverBackground);\n    if (background) {\n        collector.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${background}; }`);\n    }\n    const link = theme.getColor(textLinkForeground);\n    if (link) {\n        collector.addRule(`.monaco-editor .parameter-hints-widget a { color: ${link}; }`);\n    }\n    const linkHover = theme.getColor(textLinkActiveForeground);\n    if (linkHover) {\n        collector.addRule(`.monaco-editor .parameter-hints-widget a:hover { color: ${linkHover}; }`);\n    }\n    const foreground = theme.getColor(editorHoverForeground);\n    if (foreground) {\n        collector.addRule(`.monaco-editor .parameter-hints-widget { color: ${foreground}; }`);\n    }\n    const codeBackground = theme.getColor(textCodeBlockBackground);\n    if (codeBackground) {\n        collector.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${codeBackground}; }`);\n    }\n    const parameterHighlightColor = theme.getColor(editorHoverWidgetHighlightForeground);\n    if (parameterHighlightColor) {\n        collector.addRule(`.monaco-editor .parameter-hints-widget .parameter.active { color: ${parameterHighlightColor}}`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as languages from '../../../common/languages.js';\nimport { Context } from './provideSignatureHelp.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\nlet ParameterHintsController = class ParameterHintsController extends Disposable {\n    constructor(editor, instantiationService) {\n        super();\n        this.editor = editor;\n        this.widget = this._register(instantiationService.createInstance(ParameterHintsWidget, this.editor));\n    }\n    static get(editor) {\n        return editor.getContribution(ParameterHintsController.ID);\n    }\n    cancel() {\n        this.widget.cancel();\n    }\n    previous() {\n        this.widget.previous();\n    }\n    next() {\n        this.widget.next();\n    }\n    trigger(context) {\n        this.widget.trigger(context);\n    }\n};\nParameterHintsController.ID = 'editor.controller.parameterHints';\nParameterHintsController = __decorate([\n    __param(1, IInstantiationService)\n], ParameterHintsController);\nexport class TriggerParameterHintsAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.triggerParameterHints',\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\n            alias: 'Trigger Parameter Hints',\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 10 /* KeyCode.Space */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = ParameterHintsController.get(editor);\n        if (controller) {\n            controller.trigger({\n                triggerKind: languages.SignatureHelpTriggerKind.Invoke\n            });\n        }\n    }\n}\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController);\nregisterEditorAction(TriggerParameterHintsAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 75;\nconst ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'closeParameterHints',\n    precondition: Context.Visible,\n    handler: x => x.cancel(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'showPrevParameterHint',\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\n    handler: x => x.previous(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'showNextParameterHint',\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\n    handler: x => x.next(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './renameInputField.css';\nimport { Position } from '../../../common/core/position.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nlet RenameInputField = class RenameInputField {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._disposables = new DisposableStore();\n        this.allowEditorOverflow = true;\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._input = document.createElement('input');\n            this._input.className = 'rename-input';\n            this._input.type = 'text';\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._domNode.appendChild(this._input);\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            const updateLabel = () => {\n                var _a, _b;\n                const [accept, preview] = this._acceptKeybindings;\n                this._keybindingService.lookupKeybinding(accept);\n                this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n            };\n            updateLabel();\n            this._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel));\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        var _a, _b, _c, _d;\n        if (!this._input || !this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\n        const border = theme.getColor(inputBorder);\n        this._input.style.borderWidth = border ? '1px' : '0px';\n        this._input.style.borderStyle = border ? 'solid' : 'none';\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\n    }\n    _updateFont() {\n        if (!this._input || !this._label) {\n            return;\n        }\n        const fontInfo = this._editor.getOption(46 /* EditorOption.fontInfo */);\n        this._input.style.fontFamily = fontInfo.fontFamily;\n        this._input.style.fontWeight = fontInfo.fontWeight;\n        this._input.style.fontSize = `${fontInfo.fontSize}px`;\n        this._label.style.fontSize = `${fontInfo.fontSize * 0.8}px`;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    afterRender(position) {\n        if (!position) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true);\n        }\n    }\n    acceptInput(wantsPreview) {\n        var _a;\n        (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n    }\n    cancelInput(focusEditor) {\n        var _a;\n        (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n    }\n    getInput(where, value, selectionStart, selectionEnd, supportPreview, token) {\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._input.value = value;\n        this._input.setAttribute('selectionStart', selectionStart.toString());\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\n        const disposeOnDone = new DisposableStore();\n        return new Promise(resolve => {\n            this._currentCancelInput = (focusEditor) => {\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve(focusEditor);\n                return true;\n            };\n            this._currentAcceptInput = (wantsPreview) => {\n                if (this._input.value.trim().length === 0 || this._input.value === value) {\n                    // empty or whitespace only or not changed\n                    this.cancelInput(true);\n                    return;\n                }\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve({\n                    newName: this._input.value,\n                    wantsPreview: supportPreview && wantsPreview\n                });\n            };\n            disposeOnDone.add(token.onCancellationRequested(() => this.cancelInput(true)));\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => this.cancelInput(false)));\n            this._show();\n        }).finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n    }\n    _show() {\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        setTimeout(() => {\n            this._input.focus();\n            this._input.setSelectionRange(parseInt(this._input.getAttribute('selectionStart')), parseInt(this._input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    _hide() {\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n};\nRenameInputField = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService)\n], RenameInputField);\nexport { RenameInputField };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { IdleValue, raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService, ResourceEdit } from '../../../browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ITextResourceConfigurationService } from '../../../common/services/textResourceConfiguration.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { CONTEXT_RENAME_INPUT_VISIBLE, RenameInputField } from './renameInputField.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nclass RenameSkeleton {\n    constructor(model, position, registry) {\n        this.model = model;\n        this.position = position;\n        this._providerRenameIdx = 0;\n        this._providers = registry.ordered(model);\n    }\n    hasProvider() {\n        return this._providers.length > 0;\n    }\n    resolveRenameLocation(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const rejects = [];\n            for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\n                const provider = this._providers[this._providerRenameIdx];\n                if (!provider.resolveRenameLocation) {\n                    break;\n                }\n                const res = yield provider.resolveRenameLocation(this.model, this.position, token);\n                if (!res) {\n                    continue;\n                }\n                if (res.rejectReason) {\n                    rejects.push(res.rejectReason);\n                    continue;\n                }\n                return res;\n            }\n            const word = this.model.getWordAtPosition(this.position);\n            if (!word) {\n                return {\n                    range: Range.fromPositions(this.position),\n                    text: '',\n                    rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n                };\n            }\n            return {\n                range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\n                text: word.word,\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n            };\n        });\n    }\n    provideRenameEdits(newName, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\n        });\n    }\n    _provideRenameEdits(newName, i, rejects, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = this._providers[i];\n            if (!provider) {\n                return {\n                    edits: [],\n                    rejectReason: rejects.join('\\n')\n                };\n            }\n            const result = yield provider.provideRenameEdits(this.model, this.position, newName, token);\n            if (!result) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\n            }\n            else if (result.rejectReason) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\n            }\n            return result;\n        });\n    }\n}\nexport function rename(registry, model, position, newName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const skeleton = new RenameSkeleton(model, position, registry);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            return { edits: [], rejectReason: loc.rejectReason };\n        }\n        return skeleton.provideRenameEdits(newName, CancellationToken.None);\n    });\n}\n// ---  register actions and commands\nlet RenameController = class RenameController {\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService, _languageFeaturesService) {\n        this.editor = editor;\n        this._instaService = _instaService;\n        this._notificationService = _notificationService;\n        this._bulkEditService = _bulkEditService;\n        this._progressService = _progressService;\n        this._logService = _logService;\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposableStore = new DisposableStore();\n        this._cts = new CancellationTokenSource();\n        this._renameInputField = this._disposableStore.add(new IdleValue(() => this._disposableStore.add(this._instaService.createInstance(RenameInputField, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']))));\n    }\n    static get(editor) {\n        return editor.getContribution(RenameController.ID);\n    }\n    dispose() {\n        this._disposableStore.dispose();\n        this._cts.dispose(true);\n    }\n    run() {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            this._cts.dispose(true);\n            if (!this.editor.hasModel()) {\n                return undefined;\n            }\n            const position = this.editor.getPosition();\n            const skeleton = new RenameSkeleton(this.editor.getModel(), position, this._languageFeaturesService.renameProvider);\n            if (!skeleton.hasProvider()) {\n                return undefined;\n            }\n            this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */);\n            // resolve rename location\n            let loc;\n            try {\n                const resolveLocationOperation = skeleton.resolveRenameLocation(this._cts.token);\n                this._progressService.showWhile(resolveLocationOperation, 250);\n                loc = yield resolveLocationOperation;\n            }\n            catch (e) {\n                (_a = MessageController.get(this.editor)) === null || _a === void 0 ? void 0 : _a.showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\n                return undefined;\n            }\n            if (!loc) {\n                return undefined;\n            }\n            if (loc.rejectReason) {\n                (_b = MessageController.get(this.editor)) === null || _b === void 0 ? void 0 : _b.showMessage(loc.rejectReason, position);\n                return undefined;\n            }\n            if (this._cts.token.isCancellationRequested) {\n                return undefined;\n            }\n            this._cts.dispose();\n            this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, loc.range);\n            // do rename at location\n            const selection = this.editor.getSelection();\n            let selectionStart = 0;\n            let selectionEnd = loc.text.length;\n            if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\n                selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\n                selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\n            }\n            const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\n            const inputFieldResult = yield this._renameInputField.value.getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview, this._cts.token);\n            // no result, only hint to focus the editor or not\n            if (typeof inputFieldResult === 'boolean') {\n                if (inputFieldResult) {\n                    this.editor.focus();\n                }\n                return undefined;\n            }\n            this.editor.focus();\n            const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, this._cts.token), this._cts.token).then((renameResult) => __awaiter(this, void 0, void 0, function* () {\n                if (!renameResult || !this.editor.hasModel()) {\n                    return;\n                }\n                if (renameResult.rejectReason) {\n                    this._notificationService.info(renameResult.rejectReason);\n                    return;\n                }\n                // collapse selection to active end\n                this.editor.setSelection(Range.fromPositions(this.editor.getSelection().getPosition()));\n                this._bulkEditService.apply(ResourceEdit.convert(renameResult), {\n                    editor: this.editor,\n                    showPreview: inputFieldResult.wantsPreview,\n                    label: nls.localize('label', \"Renaming '{0}' to '{1}'\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    code: 'undoredo.rename',\n                    quotableLabel: nls.localize('quotableLabel', \"Renaming {0} to {1}\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    respectAutoSaveConfig: true\n                }).then(result => {\n                    if (result.ariaSummary) {\n                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\n                    }\n                }).catch(err => {\n                    this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\n                    this._logService.error(err);\n                });\n            }), err => {\n                this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\n                this._logService.error(err);\n            });\n            this._progressService.showWhile(renameOperation, 250);\n            return renameOperation;\n        });\n    }\n    acceptRenameInput(wantsPreview) {\n        this._renameInputField.value.acceptInput(wantsPreview);\n    }\n    cancelRenameInput() {\n        this._renameInputField.value.cancelInput(true);\n    }\n};\nRenameController.ID = 'editor.contrib.renameController';\nRenameController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, INotificationService),\n    __param(3, IBulkEditService),\n    __param(4, IEditorProgressService),\n    __param(5, ILogService),\n    __param(6, ITextResourceConfigurationService),\n    __param(7, ILanguageFeaturesService)\n], RenameController);\n// ---- action implementation\nexport class RenameAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.rename',\n            label: nls.localize('rename.label', \"Rename Symbol\"),\n            alias: 'Rename Symbol',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.1\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(accessor, editor) {\n        const controller = RenameController.get(editor);\n        if (controller) {\n            return controller.run();\n        }\n        return Promise.resolve();\n    }\n}\nregisterEditorContribution(RenameController.ID, RenameController);\nregisterEditorAction(RenameAction);\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.acceptRenameInput(false),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInputWithPreview',\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\n    handler: x => x.acceptRenameInput(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 1024 /* KeyMod.Shift */ + 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'cancelRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.cancelRenameInput(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n// ---- api bridge command\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (accessor, model, position, ...args) {\n    const [newName] = args;\n    assertType(typeof newName === 'string');\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    return rename(renameProvider, model, position, newName);\n});\nregisterModelAndPositionCommand('_executePrepareRename', function (accessor, model, position) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { renameProvider } = accessor.get(ILanguageFeaturesService);\n        const skeleton = new RenameSkeleton(model, position, renameProvider);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            throw new Error(loc.rejectReason);\n        }\n        return loc;\n    });\n});\n//todo@jrieken use editor options world\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    id: 'editor',\n    properties: {\n        'editor.rename.enablePreview': {\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\n            default: true,\n            type: 'boolean'\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a;\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineModel, OutlineElement } from '../../documentSymbols/browser/outlineModel.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createStringBuilder } from '../../../common/core/stringBuilder.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Position } from '../../../common/core/position.js';\nlet StickyScrollController = class StickyScrollController extends Disposable {\n    constructor(editor, _languageFeaturesService) {\n        super();\n        this._sessionStore = new DisposableStore();\n        this._ranges = [];\n        this._rangesVersionId = 0;\n        this._editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(34 /* EditorOption.experimental */)) {\n                this.onConfigurationChange();\n            }\n        }));\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(true), 50));\n        this.onConfigurationChange();\n    }\n    onConfigurationChange() {\n        const options = this._editor.getOption(34 /* EditorOption.experimental */);\n        if (options.stickyScroll.enabled === false) {\n            this.stickyScrollWidget.emptyRootNode();\n            this._editor.removeOverlayWidget(this.stickyScrollWidget);\n            this._sessionStore.clear();\n            return;\n        }\n        else {\n            this._editor.addOverlayWidget(this.stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidChangeModel(() => this._update(true)));\n            this._sessionStore.add(this._editor.onDidScrollChange(() => this._update(false)));\n            this._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this._update(true)));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n            this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this._update(true)));\n            this._update(true);\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this.stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            this._update(false);\n        }\n    }\n    _update(updateOutline = false) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (updateOutline) {\n                (_a = this._cts) === null || _a === void 0 ? void 0 : _a.dispose(true);\n                this._cts = new CancellationTokenSource();\n                yield this._updateOutlineModel(this._cts.token);\n            }\n            const hiddenRanges = (_b = this._editor._getViewModel()) === null || _b === void 0 ? void 0 : _b.getHiddenAreas();\n            if (hiddenRanges) {\n                for (const hiddenRange of hiddenRanges) {\n                    this._ranges = this._ranges.filter(range => { return !(range[0] >= hiddenRange.startLineNumber && range[1] <= hiddenRange.endLineNumber + 1); });\n                }\n            }\n            this._renderStickyScroll();\n        });\n    }\n    _findLineRanges(outlineElement, depth) {\n        if (outlineElement === null || outlineElement === void 0 ? void 0 : outlineElement.children.size) {\n            let didRecursion = false;\n            for (const outline of outlineElement === null || outlineElement === void 0 ? void 0 : outlineElement.children.values()) {\n                const kind = outline.symbol.kind;\n                if (kind === 4 /* SymbolKind.Class */ || kind === 8 /* SymbolKind.Constructor */ || kind === 11 /* SymbolKind.Function */ || kind === 10 /* SymbolKind.Interface */ || kind === 5 /* SymbolKind.Method */ || kind === 1 /* SymbolKind.Module */) {\n                    didRecursion = true;\n                    this._findLineRanges(outline, depth + 1);\n                }\n            }\n            if (!didRecursion) {\n                this._addOutlineRanges(outlineElement, depth);\n            }\n        }\n        else {\n            this._addOutlineRanges(outlineElement, depth);\n        }\n    }\n    _addOutlineRanges(outlineElement, depth) {\n        let currentStartLine = 0;\n        let currentEndLine = 0;\n        while (outlineElement) {\n            const kind = outlineElement.symbol.kind;\n            if (kind === 4 /* SymbolKind.Class */ || kind === 8 /* SymbolKind.Constructor */ || kind === 11 /* SymbolKind.Function */ || kind === 10 /* SymbolKind.Interface */ || kind === 5 /* SymbolKind.Method */ || kind === 1 /* SymbolKind.Module */) {\n                currentStartLine = outlineElement === null || outlineElement === void 0 ? void 0 : outlineElement.symbol.range.startLineNumber;\n                currentEndLine = outlineElement === null || outlineElement === void 0 ? void 0 : outlineElement.symbol.range.endLineNumber;\n                this._ranges.push([currentStartLine, currentEndLine, depth]);\n                depth--;\n            }\n            if (outlineElement.parent instanceof OutlineElement) {\n                outlineElement = outlineElement.parent;\n            }\n            else {\n                break;\n            }\n        }\n    }\n    _updateOutlineModel(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.hasModel()) {\n                const model = this._editor.getModel();\n                const modelVersionId = model.getVersionId();\n                const outlineModel = yield OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, model, token);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                this._ranges = [];\n                this._rangesVersionId = modelVersionId;\n                for (const outline of outlineModel.children.values()) {\n                    if (outline instanceof OutlineElement) {\n                        const kind = outline.symbol.kind;\n                        if (kind === 4 /* SymbolKind.Class */ || kind === 8 /* SymbolKind.Constructor */ || kind === 11 /* SymbolKind.Function */ || kind === 10 /* SymbolKind.Interface */ || kind === 5 /* SymbolKind.Method */ || kind === 1 /* SymbolKind.Module */) {\n                            this._findLineRanges(outline, 1);\n                        }\n                        else {\n                            this._findLineRanges(outline, 0);\n                        }\n                    }\n                    this._ranges = this._ranges.sort(function (a, b) {\n                        if (a[0] !== b[0]) {\n                            return a[0] - b[0];\n                        }\n                        else if (a[1] !== b[1]) {\n                            return b[1] - a[1];\n                        }\n                        else {\n                            return a[2] - b[2];\n                        }\n                    });\n                    let previous = [];\n                    for (const [index, arr] of this._ranges.entries()) {\n                        const [start, end, _depth] = arr;\n                        if (previous[0] === start && previous[1] === end) {\n                            this._ranges.splice(index, 1);\n                        }\n                        else {\n                            previous = arr;\n                        }\n                    }\n                }\n            }\n        });\n    }\n    _renderStickyScroll() {\n        if (!(this._editor.hasModel())) {\n            return;\n        }\n        const lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */);\n        const model = this._editor.getModel();\n        if (this._rangesVersionId !== model.getVersionId()) {\n            // Old _ranges not updated yet\n            return;\n        }\n        const scrollTop = this._editor.getScrollTop();\n        this.stickyScrollWidget.emptyRootNode();\n        const beginningLinesConsidered = new Set();\n        for (const [index, arr] of this._ranges.entries()) {\n            const [start, end, depth] = arr;\n            if (end - start > 0 && model.getLineContent(start) !== '') {\n                const topOfElementAtDepth = (depth - 1) * lineHeight;\n                const bottomOfElementAtDepth = depth * lineHeight;\n                const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                if (!beginningLinesConsidered.has(start)) {\n                    if (topOfElementAtDepth >= topOfEndLine - 1 && topOfElementAtDepth < bottomOfEndLine - 2) {\n                        beginningLinesConsidered.add(start);\n                        this.stickyScrollWidget.pushCodeLine(new StickyScrollCodeLine(start, depth, this._editor, -1, bottomOfEndLine - bottomOfElementAtDepth));\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth < bottomOfEndLine - 1) {\n                        beginningLinesConsidered.add(start);\n                        this.stickyScrollWidget.pushCodeLine(new StickyScrollCodeLine(start, depth, this._editor, 0, 0));\n                    }\n                }\n                else {\n                    this._ranges.splice(index, 1);\n                }\n            }\n        }\n        this.stickyScrollWidget.updateRootNode();\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = __decorate([\n    __param(1, ILanguageFeaturesService)\n], StickyScrollController);\nconst _ttPolicy = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('stickyScrollViewLayer', { createHTML: value => value });\nclass StickyScrollCodeLine {\n    constructor(_lineNumber, _depth, _editor, _zIndex, _relativePosition) {\n        this._lineNumber = _lineNumber;\n        this._depth = _depth;\n        this._editor = _editor;\n        this._zIndex = _zIndex;\n        this._relativePosition = _relativePosition;\n        this.effectiveLineHeight = 0;\n        this.effectiveLineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */) + this._relativePosition;\n    }\n    get lineNumber() {\n        return this._lineNumber;\n    }\n    getDomNode() {\n        const root = document.createElement('div');\n        const viewModel = this._editor._getViewModel();\n        const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(this._lineNumber, 1)).lineNumber;\n        const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n        let actualInlineDecorations;\n        try {\n            actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n        }\n        catch (err) {\n            actualInlineDecorations = [];\n        }\n        const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 100, 'none', true, true, null);\n        const sb = createStringBuilder(400);\n        renderViewLine(renderLineInput, sb);\n        let newLine;\n        if (_ttPolicy) {\n            newLine = _ttPolicy.createHTML(sb.build());\n        }\n        else {\n            newLine = sb.build();\n        }\n        const lineHTMLNode = document.createElement('span');\n        lineHTMLNode.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n        lineHTMLNode.style.overflow = 'hidden';\n        lineHTMLNode.style.whiteSpace = 'nowrap';\n        lineHTMLNode.style.display = 'inline-block';\n        lineHTMLNode.style.lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */).toString() + 'px';\n        lineHTMLNode.innerHTML = newLine;\n        const lineNumberHTMLNode = document.createElement('span');\n        lineNumberHTMLNode.style.width = this._editor.getLayoutInfo().contentLeft.toString() + 'px';\n        lineNumberHTMLNode.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n        lineNumberHTMLNode.style.color = 'var(--vscode-editorLineNumber-foreground)';\n        lineNumberHTMLNode.style.display = 'inline-block';\n        lineNumberHTMLNode.style.lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */).toString() + 'px';\n        const innerLineNumberHTML = document.createElement('span');\n        innerLineNumberHTML.innerText = this._lineNumber.toString();\n        innerLineNumberHTML.style.paddingLeft = this._editor.getLayoutInfo().lineNumbersLeft.toString() + 'px';\n        innerLineNumberHTML.style.width = this._editor.getLayoutInfo().lineNumbersWidth.toString() + 'px';\n        innerLineNumberHTML.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n        innerLineNumberHTML.style.textAlign = 'right';\n        innerLineNumberHTML.style.float = 'left';\n        innerLineNumberHTML.style.lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */).toString() + 'px';\n        lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n        root.onclick = e => {\n            e.stopPropagation();\n            e.preventDefault();\n            this._editor.revealPosition({ lineNumber: this._lineNumber - this._depth + 1, column: 1 });\n        };\n        root.onmouseover = e => {\n            innerLineNumberHTML.style.background = `var(--vscode-editorStickyScrollHover-background)`;\n            lineHTMLNode.style.backgroundColor = `var(--vscode-editorStickyScrollHover-background)`;\n            lineNumberHTMLNode.style.backgroundColor = `var(--vscode-editorStickyScrollHover-background)`;\n            root.style.backgroundColor = `var(--vscode-editorStickyScrollHover-background)`;\n            innerLineNumberHTML.style.cursor = `pointer`;\n            lineHTMLNode.style.cursor = `pointer`;\n            root.style.cursor = `pointer`;\n            lineNumberHTMLNode.style.cursor = `pointer`;\n        };\n        root.onmouseleave = e => {\n            innerLineNumberHTML.style.background = `var(--vscode-editorStickyScroll-background)`;\n            lineHTMLNode.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n            lineNumberHTMLNode.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n            root.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n        };\n        this._editor.applyFontInfo(lineHTMLNode);\n        this._editor.applyFontInfo(innerLineNumberHTML);\n        root.appendChild(lineNumberHTMLNode);\n        root.appendChild(lineHTMLNode);\n        root.style.zIndex = this._zIndex.toString();\n        root.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n        root.style.overflow = 'hidden';\n        root.style.whiteSpace = 'nowrap';\n        root.style.width = '100%';\n        root.style.lineHeight = this._editor.getOption(61 /* EditorOption.lineHeight */).toString() + 'px';\n        root.style.height = this._editor.getOption(61 /* EditorOption.lineHeight */).toString() + 'px';\n        // Special case for last line of sticky scroll\n        if (this._relativePosition) {\n            root.style.position = 'relative';\n            root.style.top = this._relativePosition + 'px';\n            root.style.width = '100%';\n        }\n        return root;\n    }\n}\nclass StickyScrollWidget {\n    constructor(_editor) {\n        this._editor = _editor;\n        this.arrayOfCodeLines = [];\n        this.rootDomNode = document.createElement('div');\n        this.rootDomNode = document.createElement('div');\n        this.rootDomNode.style.width = '100%';\n        this.rootDomNode.style.boxShadow = `var(--vscode-scrollbar-shadow) 0 6px 6px -6px`;\n    }\n    getCurrentLines() {\n        const widgetLineRange = [];\n        for (const codeLine of this.arrayOfCodeLines) {\n            widgetLineRange.push(codeLine.lineNumber);\n        }\n        return widgetLineRange;\n    }\n    pushCodeLine(codeLine) {\n        this.arrayOfCodeLines.push(codeLine);\n    }\n    updateRootNode() {\n        let widgetHeight = 0;\n        for (const line of this.arrayOfCodeLines) {\n            widgetHeight += line.effectiveLineHeight;\n            this.rootDomNode.appendChild(line.getDomNode());\n        }\n        this.rootDomNode.style.height = widgetHeight.toString() + 'px';\n    }\n    emptyRootNode() {\n        this.arrayOfCodeLines.length = 0;\n        dom.clearNode(this.rootDomNode);\n    }\n    getId() {\n        return 'editor.contrib.stickyScrollWidget';\n    }\n    getDomNode() {\n        this.rootDomNode.style.zIndex = '2';\n        this.rootDomNode.style.backgroundColor = `var(--vscode-editorStickyScroll-background)`;\n        return this.rootDomNode;\n    }\n    getPosition() {\n        return {\n            preference: null\n        };\n    }\n}\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isLowerAsciiLetter, isUpperAsciiLetter } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nexport class WordSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            this._addInWordRanges(bucket, model, position);\n            this._addWordRanges(bucket, model, position);\n            this._addWhitespaceLine(bucket, model, position);\n            bucket.push({ range: model.getFullModelRange() });\n        }\n        return result;\n    }\n    _addInWordRanges(bucket, model, pos) {\n        const obj = model.getWordAtPosition(pos);\n        if (!obj) {\n            return;\n        }\n        const { word, startColumn } = obj;\n        const offset = pos.column - startColumn;\n        let start = offset;\n        let end = offset;\n        let lastCh = 0;\n        // LEFT anchor (start)\n        for (; start >= 0; start--) {\n            const ch = word.charCodeAt(start);\n            if ((start !== offset) && (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */)) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            lastCh = ch;\n        }\n        start += 1;\n        // RIGHT anchor (end)\n        for (; end < word.length; end++) {\n            const ch = word.charCodeAt(end);\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            else if (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            lastCh = ch;\n        }\n        if (start < end) {\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\n        }\n    }\n    _addWordRanges(bucket, model, pos) {\n        const word = model.getWordAtPosition(pos);\n        if (word) {\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\n        }\n    }\n    _addWhitespaceLine(bucket, model, pos) {\n        if (model.getLineLength(pos.lineNumber) > 0\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\nimport { WordSelectionRangeProvider } from './wordSelections.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nclass SelectionRanges {\n    constructor(index, ranges) {\n        this.index = index;\n        this.ranges = ranges;\n    }\n    mov(fwd) {\n        const index = this.index + (fwd ? 1 : -1);\n        if (index < 0 || index >= this.ranges.length) {\n            return this;\n        }\n        const res = new SelectionRanges(index, this.ranges);\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\n            // next range equals this range, retry with next-next\n            return res.mov(fwd);\n        }\n        return res;\n    }\n}\nlet SmartSelectController = class SmartSelectController {\n    constructor(_editor, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._ignoreSelection = false;\n    }\n    static get(editor) {\n        return editor.getContribution(SmartSelectController.ID);\n    }\n    dispose() {\n        var _a;\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    run(forward) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            const selections = this._editor.getSelections();\n            const model = this._editor.getModel();\n            if (!this._state) {\n                yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider, model, selections.map(s => s.getPosition()), this._editor.getOption(104 /* EditorOption.smartSelect */), CancellationToken.None).then(ranges => {\n                    var _a;\n                    if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\n                        // invalid result\n                        return;\n                    }\n                    if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\n                        // invalid editor state\n                        return;\n                    }\n                    for (let i = 0; i < ranges.length; i++) {\n                        ranges[i] = ranges[i].filter(range => {\n                            // filter ranges inside the selection\n                            return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\n                        });\n                        // prepend current selection\n                        ranges[i].unshift(selections[i]);\n                    }\n                    this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\n                    // listen to caret move and forget about state\n                    (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                    this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\n                        var _a;\n                        if (!this._ignoreSelection) {\n                            (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                            this._state = undefined;\n                        }\n                    });\n                });\n            }\n            if (!this._state) {\n                // no state\n                return;\n            }\n            this._state = this._state.map(state => state.mov(forward));\n            const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\n            this._ignoreSelection = true;\n            try {\n                this._editor.setSelections(newSelections);\n            }\n            finally {\n                this._ignoreSelection = false;\n            }\n        });\n    }\n};\nSmartSelectController.ID = 'editor.contrib.smartSelectController';\nSmartSelectController = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SmartSelectController);\nclass AbstractSmartSelect extends EditorAction {\n    constructor(forward, opts) {\n        super(opts);\n        this._forward = forward;\n    }\n    run(_accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = SmartSelectController.get(editor);\n            if (controller) {\n                yield controller.run(this._forward);\n            }\n        });\n    }\n}\nclass GrowSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(true, {\n            id: 'editor.action.smartSelect.expand',\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\n            alias: 'Expand Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\n                order: 2\n            }\n        });\n    }\n}\n// renamed command id\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\nclass ShrinkSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(false, {\n            id: 'editor.action.smartSelect.shrink',\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\n            alias: 'Shrink Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\n                order: 3\n            }\n        });\n    }\n}\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController);\nregisterEditorAction(GrowSelectionAction);\nregisterEditorAction(ShrinkSelectionAction);\nexport function provideSelectionRanges(registry, model, positions, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = registry.all(model)\n            .concat(new WordSelectionRangeProvider()); // ALWAYS have word based selection range\n        if (providers.length === 1) {\n            // add word selection and bracket selection when no provider exists\n            providers.unshift(new BracketSelectionRangeProvider());\n        }\n        const work = [];\n        const allRawRanges = [];\n        for (const provider of providers) {\n            work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\n                if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\n                    for (let i = 0; i < positions.length; i++) {\n                        if (!allRawRanges[i]) {\n                            allRawRanges[i] = [];\n                        }\n                        for (const oneProviderRanges of allProviderRanges[i]) {\n                            if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\n                                allRawRanges[i].push(Range.lift(oneProviderRanges.range));\n                            }\n                        }\n                    }\n                }\n            }, onUnexpectedExternalError));\n        }\n        yield Promise.all(work);\n        return allRawRanges.map(oneRawRanges => {\n            if (oneRawRanges.length === 0) {\n                return [];\n            }\n            // sort all by start/end position\n            oneRawRanges.sort((a, b) => {\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\n                    return 1;\n                }\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\n                    return 1;\n                }\n                else {\n                    return 0;\n                }\n            });\n            // remove ranges that don't contain the former range or that are equal to the\n            // former range\n            const oneRanges = [];\n            let last;\n            for (const range of oneRawRanges) {\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\n                    oneRanges.push(range);\n                    last = range;\n                }\n            }\n            if (!options.selectLeadingAndTrailingWhitespace) {\n                return oneRanges;\n            }\n            // add ranges that expand trivia at line starts and ends whenever a range\n            // wraps onto the a new line\n            const oneRangesWithTrivia = [oneRanges[0]];\n            for (let i = 1; i < oneRanges.length; i++) {\n                const prev = oneRanges[i - 1];\n                const cur = oneRanges[i];\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\n                    // add line/block range without leading/failing whitespace\n                    const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\n                    }\n                    // add line/block range\n                    const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\n                        oneRangesWithTrivia.push(rangeFull);\n                    }\n                }\n                oneRangesWithTrivia.push(cur);\n            }\n            return oneRangesWithTrivia;\n        });\n    });\n}\nCommandsRegistry.registerCommand('_executeSelectionRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, positions] = args;\n        assertType(URI.isUri(resource));\n        const registry = accessor.get(ILanguageFeaturesService).selectionRangeProvider;\n        const reference = yield accessor.get(ITextModelService).createModelReference(resource);\n        try {\n            return provideSelectionRanges(registry, reference.object.textEditorModel, positions, { selectLeadingAndTrailingWhitespace: true }, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { RefCountedDisposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CompletionItemInsertTextRule } from '../../../common/standalone/standaloneEnums.js';\nimport { CompletionModel, LineContext } from './completionModel.js';\nimport { CompletionOptions, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass SuggestInlineCompletion {\n    constructor(range, insertText, filterText, additionalTextEdits, command, completion) {\n        this.range = range;\n        this.insertText = insertText;\n        this.filterText = filterText;\n        this.additionalTextEdits = additionalTextEdits;\n        this.command = command;\n        this.completion = completion;\n    }\n}\nlet InlineCompletionResults = class InlineCompletionResults extends RefCountedDisposable {\n    constructor(model, line, word, completionModel, completions, _suggestMemoryService) {\n        super(completions.disposable);\n        this.model = model;\n        this.line = line;\n        this.word = word;\n        this.completionModel = completionModel;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    canBeReused(model, line, word) {\n        return this.model === model // same model\n            && this.line === line\n            && this.word.word.length > 0\n            && this.word.startColumn === word.startColumn && this.word.endColumn < word.endColumn // same word\n            && this.completionModel.incomplete.size === 0; // no incomplete results\n    }\n    get items() {\n        var _a;\n        const result = [];\n        // Split items by preselected index. This ensures the memory-selected item shows first and that better/worst\n        // ranked items are before/after\n        const { items } = this.completionModel;\n        const selectedIndex = this._suggestMemoryService.select(this.model, { lineNumber: this.line, column: this.word.endColumn + this.completionModel.lineContext.characterCountDelta }, items);\n        const first = Iterable.slice(items, selectedIndex);\n        const second = Iterable.slice(items, 0, selectedIndex);\n        let resolveCount = 5;\n        for (const item of Iterable.concat(first, second)) {\n            if (item.score === FuzzyScore.Default) {\n                // skip items that have no overlap\n                continue;\n            }\n            const range = new Range(item.editStart.lineNumber, item.editStart.column, item.editInsertEnd.lineNumber, item.editInsertEnd.column + this.completionModel.lineContext.characterCountDelta // end PLUS character delta\n            );\n            const insertText = item.completion.insertTextRules && (item.completion.insertTextRules & CompletionItemInsertTextRule.InsertAsSnippet)\n                ? { snippet: item.completion.insertText }\n                : item.completion.insertText;\n            result.push(new SuggestInlineCompletion(range, insertText, (_a = item.filterTextLow) !== null && _a !== void 0 ? _a : item.labelLow, item.completion.additionalTextEdits, item.completion.command, item));\n            // resolve the first N suggestions eagerly\n            if (resolveCount-- >= 0) {\n                item.resolve(CancellationToken.None);\n            }\n        }\n        return result;\n    }\n};\nInlineCompletionResults = __decorate([\n    __param(5, ISuggestMemoryService)\n], InlineCompletionResults);\nlet SuggestInlineCompletions = class SuggestInlineCompletions {\n    constructor(_getEditorOption, _languageFeatureService, _clipboardService, _suggestMemoryService) {\n        this._getEditorOption = _getEditorOption;\n        this._languageFeatureService = _languageFeatureService;\n        this._clipboardService = _clipboardService;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    provideInlineCompletions(model, position, context, token) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (context.selectedSuggestionInfo) {\n                return;\n            }\n            const config = this._getEditorOption(81 /* EditorOption.quickSuggestions */, model);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                // quick suggest is off (for this model/language)\n                return;\n            }\n            model.tokenization.tokenizeIfCheap(position.lineNumber);\n            const lineTokens = model.tokenization.getLineTokens(position.lineNumber);\n            const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(position.column - 1 - 1, 0)));\n            if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'inline') {\n                // quick suggest is off (for this token)\n                return undefined;\n            }\n            // We consider non-empty leading words and trigger characters. The latter only\n            // when no word is being typed (word characters superseed trigger characters)\n            let wordInfo = model.getWordAtPosition(position);\n            let triggerCharacterInfo;\n            if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word)) {\n                triggerCharacterInfo = this._getTriggerCharacterInfo(model, position);\n            }\n            if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word) && !triggerCharacterInfo) {\n                // not at word, not a trigger character\n                return;\n            }\n            // ensure that we have word information and that we are at the end of a word\n            // otherwise we stop because we don't want to do quick suggestions inside words\n            if (!wordInfo) {\n                wordInfo = model.getWordUntilPosition(position);\n            }\n            if (wordInfo.endColumn !== position.column) {\n                return;\n            }\n            let result;\n            const leadingLineContents = model.getValueInRange(new Range(position.lineNumber, 1, position.lineNumber, position.column));\n            if (!triggerCharacterInfo && ((_a = this._lastResult) === null || _a === void 0 ? void 0 : _a.canBeReused(model, position.lineNumber, wordInfo))) {\n                // reuse a previous result iff possible, only a refilter is needed\n                // TODO@jrieken this can be improved further and only incomplete results can be updated\n                // console.log(`REUSE with ${wordInfo.word}`);\n                const newLineContext = new LineContext(leadingLineContents, position.column - this._lastResult.word.endColumn);\n                this._lastResult.completionModel.lineContext = newLineContext;\n                this._lastResult.acquire();\n                result = this._lastResult;\n            }\n            else {\n                // refesh model is required\n                const completions = yield provideSuggestionItems(this._languageFeatureService.completionProvider, model, position, new CompletionOptions(undefined, undefined, triggerCharacterInfo === null || triggerCharacterInfo === void 0 ? void 0 : triggerCharacterInfo.providers), triggerCharacterInfo && { triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */, triggerCharacter: triggerCharacterInfo.ch }, token);\n                let clipboardText;\n                if (completions.needsClipboard) {\n                    clipboardText = yield this._clipboardService.readText();\n                }\n                const completionModel = new CompletionModel(completions.items, position.column, new LineContext(leadingLineContents, 0), WordDistance.None, this._getEditorOption(108 /* EditorOption.suggest */, model), this._getEditorOption(103 /* EditorOption.snippetSuggestions */, model), { boostFullMatch: false, firstMatchCanBeWeak: false }, clipboardText);\n                result = new InlineCompletionResults(model, position.lineNumber, wordInfo, completionModel, completions, this._suggestMemoryService);\n            }\n            this._lastResult = result;\n            return result;\n        });\n    }\n    handleItemDidShow(_completions, item) {\n        item.completion.resolve(CancellationToken.None);\n    }\n    freeInlineCompletions(result) {\n        result.release();\n    }\n    _getTriggerCharacterInfo(model, position) {\n        var _a;\n        const ch = model.getValueInRange(Range.fromPositions({ lineNumber: position.lineNumber, column: position.column - 1 }, position));\n        const providers = new Set();\n        for (const provider of this._languageFeatureService.completionProvider.all(model)) {\n            if ((_a = provider.triggerCharacters) === null || _a === void 0 ? void 0 : _a.includes(ch)) {\n                providers.add(provider);\n            }\n        }\n        if (providers.size === 0) {\n            return undefined;\n        }\n        return { providers, ch };\n    }\n};\nSuggestInlineCompletions = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IClipboardService),\n    __param(3, ISuggestMemoryService)\n], SuggestInlineCompletions);\nexport { SuggestInlineCompletions };\nlet EditorContribution = class EditorContribution {\n    constructor(_editor, languageFeatureService, editorService, instaService) {\n        // HACK - way to contribute something only once\n        if (++EditorContribution._counter === 1) {\n            const provider = instaService.createInstance(SuggestInlineCompletions, (id, model) => {\n                var _a;\n                // HACK - reuse the editor options world outside from a \"normal\" contribution\n                const editor = (_a = editorService.listCodeEditors().find(editor => editor.getModel() === model)) !== null && _a !== void 0 ? _a : _editor;\n                return editor.getOption(id);\n            });\n            EditorContribution._disposable = languageFeatureService.inlineCompletionsProvider.register('*', provider);\n        }\n    }\n    dispose() {\n        var _a;\n        if (--EditorContribution._counter === 0) {\n            (_a = EditorContribution._disposable) === null || _a === void 0 ? void 0 : _a.dispose();\n            EditorContribution._disposable = undefined;\n        }\n    }\n};\nEditorContribution._counter = 0;\nEditorContribution = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ICodeEditorService),\n    __param(3, IInstantiationService)\n], EditorContribution);\nregisterEditorContribution('suggest.inlineCompletionsProvider', EditorContribution);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport * as nls from '../../../../nls.js';\nclass ForceRetokenizeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.forceRetokenize',\n            label: nls.localize('forceRetokenize', \"Developer: Force Retokenize\"),\n            alias: 'Developer: Force Retokenize',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        model.tokenization.resetTokenization();\n        const sw = new StopWatch(true);\n        model.tokenization.forceTokenization(model.getLineCount());\n        sw.stop();\n        console.log(`tokenization took ${sw.elapsed()}`);\n    }\n}\nregisterEditorAction(ForceRetokenizeAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { TabFocus } from '../../../browser/config/tabFocus.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport * as nls from '../../../../nls.js';\nexport class ToggleTabFocusModeAction extends EditorAction {\n    constructor() {\n        super({\n            id: ToggleTabFocusModeAction.ID,\n            label: nls.localize({ key: 'toggle.tabMovesFocus', comment: ['Turn on/off use of tab key for moving focus around VS Code'] }, \"Toggle Tab Key Moves Focus\"),\n            alias: 'Toggle Tab Key Moves Focus',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 43 /* KeyCode.KeyM */,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 43 /* KeyCode.KeyM */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const oldValue = TabFocus.getTabFocusMode();\n        const newValue = !oldValue;\n        TabFocus.setTabFocusMode(newValue);\n        if (newValue) {\n            alert(nls.localize('toggle.tabMovesFocus.on', \"Pressing Tab will now move focus to the next focusable element\"));\n        }\n        else {\n            alert(nls.localize('toggle.tabMovesFocus.off', \"Pressing Tab will now insert the tab character\"));\n        }\n    }\n}\nToggleTabFocusModeAction.ID = 'editor.action.toggleTabFocusMode';\nregisterEditorAction(ToggleTabFocusModeAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { $, append, EventHelper } from '../../../base/browser/dom.js';\nimport { DomEmitter } from '../../../base/browser/event.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { EventType as TouchEventType, Gesture } from '../../../base/browser/touch.js';\nimport { Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { IOpenerService } from '../common/opener.js';\nimport { textLinkActiveForeground, textLinkForeground } from '../../theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../theme/common/themeService.js';\nlet Link = class Link extends Disposable {\n    constructor(container, _link, options = {}, openerService) {\n        var _a;\n        super();\n        this._link = _link;\n        this._enabled = true;\n        this.el = append(container, $('a.monaco-link', {\n            tabIndex: (_a = _link.tabIndex) !== null && _a !== void 0 ? _a : 0,\n            href: _link.href,\n            title: _link.title\n        }, _link.label));\n        this.el.setAttribute('role', 'button');\n        const onClickEmitter = this._register(new DomEmitter(this.el, 'click'));\n        const onKeyPress = this._register(new DomEmitter(this.el, 'keypress'));\n        const onEnterPress = Event.chain(onKeyPress.event)\n            .map(e => new StandardKeyboardEvent(e))\n            .filter(e => e.keyCode === 3 /* KeyCode.Enter */)\n            .event;\n        const onTap = this._register(new DomEmitter(this.el, TouchEventType.Tap)).event;\n        this._register(Gesture.addTarget(this.el));\n        const onOpen = Event.any(onClickEmitter.event, onEnterPress, onTap);\n        this._register(onOpen(e => {\n            if (!this.enabled) {\n                return;\n            }\n            EventHelper.stop(e, true);\n            if (options === null || options === void 0 ? void 0 : options.opener) {\n                options.opener(this._link.href);\n            }\n            else {\n                openerService.open(this._link.href, { allowCommands: true });\n            }\n        }));\n        this.enabled = true;\n    }\n    get enabled() {\n        return this._enabled;\n    }\n    set enabled(enabled) {\n        if (enabled) {\n            this.el.setAttribute('aria-disabled', 'false');\n            this.el.tabIndex = 0;\n            this.el.style.pointerEvents = 'auto';\n            this.el.style.opacity = '1';\n            this.el.style.cursor = 'pointer';\n            this._enabled = false;\n        }\n        else {\n            this.el.setAttribute('aria-disabled', 'true');\n            this.el.tabIndex = -1;\n            this.el.style.pointerEvents = 'none';\n            this.el.style.opacity = '0.4';\n            this.el.style.cursor = 'default';\n            this._enabled = true;\n        }\n        this._enabled = enabled;\n    }\n};\nLink = __decorate([\n    __param(3, IOpenerService)\n], Link);\nexport { Link };\nregisterThemingParticipant((theme, collector) => {\n    const textLinkForegroundColor = theme.getColor(textLinkForeground);\n    if (textLinkForegroundColor) {\n        collector.addRule(`.monaco-link { color: ${textLinkForegroundColor}; }`);\n    }\n    const textLinkActiveForegroundColor = theme.getColor(textLinkActiveForeground);\n    if (textLinkActiveForegroundColor) {\n        collector.addRule(`.monaco-link:hover { color: ${textLinkActiveForegroundColor}; }`);\n    }\n});\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './bannerController.css';\nimport { $, append, clearNode } from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Link } from '../../../../platform/opener/browser/link.js';\nimport { widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../platform/theme/common/themeService.js';\nconst BANNER_ELEMENT_HEIGHT = 26;\nlet BannerController = class BannerController extends Disposable {\n    constructor(_editor, instantiationService) {\n        super();\n        this._editor = _editor;\n        this.instantiationService = instantiationService;\n        this.banner = this._register(this.instantiationService.createInstance(Banner));\n    }\n    hide() {\n        this._editor.setBanner(null, 0);\n        this.banner.clear();\n    }\n    show(item) {\n        this.banner.show(Object.assign(Object.assign({}, item), { onClose: () => {\n                var _a;\n                this.hide();\n                (_a = item.onClose) === null || _a === void 0 ? void 0 : _a.call(item);\n            } }));\n        this._editor.setBanner(this.banner.element, BANNER_ELEMENT_HEIGHT);\n    }\n};\nBannerController = __decorate([\n    __param(1, IInstantiationService)\n], BannerController);\nexport { BannerController };\n// TODO@hediet: Investigate if this can be reused by the workspace banner (bannerPart.ts).\nlet Banner = class Banner extends Disposable {\n    constructor(instantiationService) {\n        super();\n        this.instantiationService = instantiationService;\n        this.markdownRenderer = this.instantiationService.createInstance(MarkdownRenderer, {});\n        this.element = $('div.editor-banner');\n        this.element.tabIndex = 0;\n    }\n    getAriaLabel(item) {\n        if (item.ariaLabel) {\n            return item.ariaLabel;\n        }\n        if (typeof item.message === 'string') {\n            return item.message;\n        }\n        return undefined;\n    }\n    getBannerMessage(message) {\n        if (typeof message === 'string') {\n            const element = $('span');\n            element.innerText = message;\n            return element;\n        }\n        return this.markdownRenderer.render(message).element;\n    }\n    clear() {\n        clearNode(this.element);\n    }\n    show(item) {\n        // Clear previous item\n        clearNode(this.element);\n        // Banner aria label\n        const ariaLabel = this.getAriaLabel(item);\n        if (ariaLabel) {\n            this.element.setAttribute('aria-label', ariaLabel);\n        }\n        // Icon\n        const iconContainer = append(this.element, $('div.icon-container'));\n        iconContainer.setAttribute('aria-hidden', 'true');\n        if (item.icon) {\n            iconContainer.appendChild($(`div${ThemeIcon.asCSSSelector(item.icon)}`));\n        }\n        // Message\n        const messageContainer = append(this.element, $('div.message-container'));\n        messageContainer.setAttribute('aria-hidden', 'true');\n        messageContainer.appendChild(this.getBannerMessage(item.message));\n        // Message Actions\n        this.messageActionsContainer = append(this.element, $('div.message-actions-container'));\n        if (item.actions) {\n            for (const action of item.actions) {\n                this._register(this.instantiationService.createInstance(Link, this.messageActionsContainer, Object.assign(Object.assign({}, action), { tabIndex: -1 }), {}));\n            }\n        }\n        // Action\n        const actionBarContainer = append(this.element, $('div.action-container'));\n        this.actionBar = this._register(new ActionBar(actionBarContainer));\n        this.actionBar.push(this._register(new Action('banner.close', 'Close Banner', ThemeIcon.asClassName(widgetClose), true, () => {\n            if (typeof item.onClose === 'function') {\n                item.onClose();\n            }\n        })), { icon: true, label: false });\n        this.actionBar.setFocusable(false);\n    }\n};\nBanner = __decorate([\n    __param(0, IInstantiationService)\n], Banner);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { InvisibleCharacters } from '../../../../base/common/strings.js';\nimport './unicodeHighlighter.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { inUntrustedWorkspace, unicodeHighlightConfigKeys } from '../../../common/config/editorOptions.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { UnicodeTextModelHighlighter } from '../../../common/services/unicodeTextModelHighlighter.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { isModelDecorationInComment, isModelDecorationInString, isModelDecorationVisible } from '../../../common/viewModel/viewModelDecorations.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { MarkdownHover, renderMarkdownHovers } from '../../hover/browser/markdownHoverParticipant.js';\nimport { BannerController } from './bannerController.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IWorkspaceTrustManagementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nexport const warningIcon = registerIcon('extensions-warning-message', Codicon.warning, nls.localize('warningIcon', 'Icon shown with a warning message in the extensions editor.'));\nlet UnicodeHighlighter = class UnicodeHighlighter extends Disposable {\n    constructor(_editor, _editorWorkerService, _workspaceTrustService, instantiationService) {\n        super();\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._workspaceTrustService = _workspaceTrustService;\n        this._highlighter = null;\n        this._bannerClosed = false;\n        this._updateState = (state) => {\n            if (state && state.hasMore) {\n                if (this._bannerClosed) {\n                    return;\n                }\n                // This document contains many non-basic ASCII characters.\n                const max = Math.max(state.ambiguousCharacterCount, state.nonBasicAsciiCharacterCount, state.invisibleCharacterCount);\n                let data;\n                if (state.nonBasicAsciiCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters', 'This document contains many non-basic ASCII unicode characters'),\n                        command: new DisableHighlightingOfNonBasicAsciiCharactersAction(),\n                    };\n                }\n                else if (state.ambiguousCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters', 'This document contains many ambiguous unicode characters'),\n                        command: new DisableHighlightingOfAmbiguousCharactersAction(),\n                    };\n                }\n                else if (state.invisibleCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters', 'This document contains many invisible unicode characters'),\n                        command: new DisableHighlightingOfInvisibleCharactersAction(),\n                    };\n                }\n                else {\n                    throw new Error('Unreachable');\n                }\n                this._bannerController.show({\n                    id: 'unicodeHighlightBanner',\n                    message: data.message,\n                    icon: warningIcon,\n                    actions: [\n                        {\n                            label: data.command.shortLabel,\n                            href: `command:${data.command.id}`\n                        }\n                    ],\n                    onClose: () => {\n                        this._bannerClosed = true;\n                    },\n                });\n            }\n            else {\n                this._bannerController.hide();\n            }\n        };\n        this._bannerController = this._register(instantiationService.createInstance(BannerController, _editor));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._bannerClosed = false;\n            this._updateHighlighter();\n        }));\n        this._options = _editor.getOption(115 /* EditorOption.unicodeHighlighting */);\n        this._register(_workspaceTrustService.onDidChangeTrust(e => {\n            this._updateHighlighter();\n        }));\n        this._register(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(115 /* EditorOption.unicodeHighlighting */)) {\n                this._options = _editor.getOption(115 /* EditorOption.unicodeHighlighting */);\n                this._updateHighlighter();\n            }\n        }));\n        this._updateHighlighter();\n    }\n    dispose() {\n        if (this._highlighter) {\n            this._highlighter.dispose();\n            this._highlighter = null;\n        }\n        super.dispose();\n    }\n    _updateHighlighter() {\n        this._updateState(null);\n        if (this._highlighter) {\n            this._highlighter.dispose();\n            this._highlighter = null;\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const options = resolveOptions(this._workspaceTrustService.isWorkspaceTrusted(), this._options);\n        if ([\n            options.nonBasicASCII,\n            options.ambiguousCharacters,\n            options.invisibleCharacters,\n        ].every((option) => option === false)) {\n            // Don't do anything if the feature is fully disabled\n            return;\n        }\n        const highlightOptions = {\n            nonBasicASCII: options.nonBasicASCII,\n            ambiguousCharacters: options.ambiguousCharacters,\n            invisibleCharacters: options.invisibleCharacters,\n            includeComments: options.includeComments,\n            includeStrings: options.includeStrings,\n            allowedCodePoints: Object.keys(options.allowedCharacters).map(c => c.codePointAt(0)),\n            allowedLocales: Object.keys(options.allowedLocales).map(locale => {\n                if (locale === '_os') {\n                    const osLocale = new Intl.NumberFormat().resolvedOptions().locale;\n                    return osLocale;\n                }\n                else if (locale === '_vscode') {\n                    return platform.language;\n                }\n                return locale;\n            }),\n        };\n        if (this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)) {\n            this._highlighter = new DocumentUnicodeHighlighter(this._editor, highlightOptions, this._updateState, this._editorWorkerService);\n        }\n        else {\n            this._highlighter = new ViewportUnicodeHighlighter(this._editor, highlightOptions, this._updateState);\n        }\n    }\n    getDecorationInfo(decoration) {\n        if (this._highlighter) {\n            return this._highlighter.getDecorationInfo(decoration);\n        }\n        return null;\n    }\n};\nUnicodeHighlighter.ID = 'editor.contrib.unicodeHighlighter';\nUnicodeHighlighter = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IWorkspaceTrustManagementService),\n    __param(3, IInstantiationService)\n], UnicodeHighlighter);\nexport { UnicodeHighlighter };\nfunction resolveOptions(trusted, options) {\n    return {\n        nonBasicASCII: options.nonBasicASCII === inUntrustedWorkspace ? !trusted : options.nonBasicASCII,\n        ambiguousCharacters: options.ambiguousCharacters,\n        invisibleCharacters: options.invisibleCharacters,\n        includeComments: options.includeComments === inUntrustedWorkspace ? !trusted : options.includeComments,\n        includeStrings: options.includeStrings === inUntrustedWorkspace ? !trusted : options.includeStrings,\n        allowedCharacters: options.allowedCharacters,\n        allowedLocales: options.allowedLocales,\n    };\n}\nlet DocumentUnicodeHighlighter = class DocumentUnicodeHighlighter extends Disposable {\n    constructor(_editor, _options, _updateState, _editorWorkerService) {\n        super();\n        this._editor = _editor;\n        this._options = _options;\n        this._updateState = _updateState;\n        this._editorWorkerService = _editorWorkerService;\n        this._model = this._editor.getModel();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(), 250));\n        this._register(this._editor.onDidChangeModelContent(() => {\n            this._updateSoon.schedule();\n        }));\n        this._updateSoon.schedule();\n    }\n    dispose() {\n        this._decorations.clear();\n        super.dispose();\n    }\n    _update() {\n        if (this._model.isDisposed()) {\n            return;\n        }\n        if (!this._model.mightContainNonBasicASCII()) {\n            this._decorations.clear();\n            return;\n        }\n        const modelVersionId = this._model.getVersionId();\n        this._editorWorkerService\n            .computedUnicodeHighlights(this._model.uri, this._options)\n            .then((info) => {\n            if (this._model.isDisposed()) {\n                return;\n            }\n            if (this._model.getVersionId() !== modelVersionId) {\n                // model changed in the meantime\n                return;\n            }\n            this._updateState(info);\n            const decorations = [];\n            if (!info.hasMore) {\n                // Don't show decoration if there are too many.\n                // In this case, a banner is shown.\n                for (const range of info.ranges) {\n                    decorations.push({\n                        range: range,\n                        options: Decorations.instance.getDecorationFromOptions(this._options),\n                    });\n                }\n            }\n            this._decorations.set(decorations);\n        });\n    }\n    getDecorationInfo(decoration) {\n        if (!this._decorations.has(decoration)) {\n            return null;\n        }\n        const model = this._editor.getModel();\n        if (!isModelDecorationVisible(model, decoration)) {\n            return null;\n        }\n        const text = model.getValueInRange(decoration.range);\n        return {\n            reason: computeReason(text, this._options),\n            inComment: isModelDecorationInComment(model, decoration),\n            inString: isModelDecorationInString(model, decoration),\n        };\n    }\n};\nDocumentUnicodeHighlighter = __decorate([\n    __param(3, IEditorWorkerService)\n], DocumentUnicodeHighlighter);\nclass ViewportUnicodeHighlighter extends Disposable {\n    constructor(_editor, _options, _updateState) {\n        super();\n        this._editor = _editor;\n        this._options = _options;\n        this._updateState = _updateState;\n        this._model = this._editor.getModel();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(), 250));\n        this._register(this._editor.onDidLayoutChange(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidScrollChange(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidChangeHiddenAreas(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidChangeModelContent(() => {\n            this._updateSoon.schedule();\n        }));\n        this._updateSoon.schedule();\n    }\n    dispose() {\n        this._decorations.clear();\n        super.dispose();\n    }\n    _update() {\n        if (this._model.isDisposed()) {\n            return;\n        }\n        if (!this._model.mightContainNonBasicASCII()) {\n            this._decorations.clear();\n            return;\n        }\n        const ranges = this._editor.getVisibleRanges();\n        const decorations = [];\n        const totalResult = {\n            ranges: [],\n            ambiguousCharacterCount: 0,\n            invisibleCharacterCount: 0,\n            nonBasicAsciiCharacterCount: 0,\n            hasMore: false,\n        };\n        for (const range of ranges) {\n            const result = UnicodeTextModelHighlighter.computeUnicodeHighlights(this._model, this._options, range);\n            for (const r of result.ranges) {\n                totalResult.ranges.push(r);\n            }\n            totalResult.ambiguousCharacterCount += totalResult.ambiguousCharacterCount;\n            totalResult.invisibleCharacterCount += totalResult.invisibleCharacterCount;\n            totalResult.nonBasicAsciiCharacterCount += totalResult.nonBasicAsciiCharacterCount;\n            totalResult.hasMore = totalResult.hasMore || result.hasMore;\n        }\n        if (!totalResult.hasMore) {\n            // Don't show decorations if there are too many.\n            // A banner will be shown instead.\n            for (const range of totalResult.ranges) {\n                decorations.push({ range, options: Decorations.instance.getDecorationFromOptions(this._options) });\n            }\n        }\n        this._updateState(totalResult);\n        this._decorations.set(decorations);\n    }\n    getDecorationInfo(decoration) {\n        if (!this._decorations.has(decoration)) {\n            return null;\n        }\n        const model = this._editor.getModel();\n        const text = model.getValueInRange(decoration.range);\n        if (!isModelDecorationVisible(model, decoration)) {\n            return null;\n        }\n        return {\n            reason: computeReason(text, this._options),\n            inComment: isModelDecorationInComment(model, decoration),\n            inString: isModelDecorationInString(model, decoration),\n        };\n    }\n}\nlet UnicodeHighlighterHoverParticipant = class UnicodeHighlighterHoverParticipant {\n    constructor(_editor, _languageService, _openerService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this.hoverOrdinal = 4;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const unicodeHighlighter = this._editor.getContribution(UnicodeHighlighter.ID);\n        if (!unicodeHighlighter) {\n            return [];\n        }\n        const result = [];\n        let index = 300;\n        for (const d of lineDecorations) {\n            const highlightInfo = unicodeHighlighter.getDecorationInfo(d);\n            if (!highlightInfo) {\n                continue;\n            }\n            const char = model.getValueInRange(d.range);\n            // text refers to a single character.\n            const codePoint = char.codePointAt(0);\n            const codePointStr = formatCodePointMarkdown(codePoint);\n            let reason;\n            switch (highlightInfo.reason.kind) {\n                case 0 /* UnicodeHighlighterReasonKind.Ambiguous */:\n                    reason = nls.localize('unicodeHighlight.characterIsAmbiguous', 'The character {0} could be confused with the character {1}, which is more common in source code.', codePointStr, formatCodePointMarkdown(highlightInfo.reason.confusableWith.codePointAt(0)));\n                    break;\n                case 1 /* UnicodeHighlighterReasonKind.Invisible */:\n                    reason = nls.localize('unicodeHighlight.characterIsInvisible', 'The character {0} is invisible.', codePointStr);\n                    break;\n                case 2 /* UnicodeHighlighterReasonKind.NonBasicAscii */:\n                    reason = nls.localize('unicodeHighlight.characterIsNonBasicAscii', 'The character {0} is not a basic ASCII character.', codePointStr);\n                    break;\n            }\n            const adjustSettingsArgs = {\n                codePoint: codePoint,\n                reason: highlightInfo.reason,\n                inComment: highlightInfo.inComment,\n                inString: highlightInfo.inString,\n            };\n            const adjustSettings = nls.localize('unicodeHighlight.adjustSettings', 'Adjust settings');\n            const uri = `command:${ShowExcludeOptions.ID}?${encodeURIComponent(JSON.stringify(adjustSettingsArgs))}`;\n            const markdown = new MarkdownString('', true)\n                .appendMarkdown(reason)\n                .appendText(' ')\n                .appendLink(uri, adjustSettings);\n            result.push(new MarkdownHover(this, d.range, [markdown], index++));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderMarkdownHovers(context, hoverParts, this._editor, this._languageService, this._openerService);\n    }\n};\nUnicodeHighlighterHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService)\n], UnicodeHighlighterHoverParticipant);\nexport { UnicodeHighlighterHoverParticipant };\nfunction codePointToHex(codePoint) {\n    return `U+${codePoint.toString(16).padStart(4, '0')}`;\n}\nfunction formatCodePointMarkdown(codePoint) {\n    let value = `\\`${codePointToHex(codePoint)}\\``;\n    if (!InvisibleCharacters.isInvisibleCharacter(codePoint)) {\n        // Don't render any control characters or any invisible characters, as they cannot be seen anyways.\n        value += ` \"${`${renderCodePointAsInlineCode(codePoint)}`}\"`;\n    }\n    return value;\n}\nfunction renderCodePointAsInlineCode(codePoint) {\n    if (codePoint === 96 /* CharCode.BackTick */) {\n        return '`` ` ``';\n    }\n    return '`' + String.fromCodePoint(codePoint) + '`';\n}\nfunction computeReason(char, options) {\n    return UnicodeTextModelHighlighter.computeUnicodeHighlightReason(char, options);\n}\nclass Decorations {\n    constructor() {\n        this.map = new Map();\n    }\n    getDecorationFromOptions(options) {\n        return this.getDecoration(!options.includeComments, !options.includeStrings);\n    }\n    getDecoration(hideInComments, hideInStrings) {\n        const key = `${hideInComments}${hideInStrings}`;\n        let options = this.map.get(key);\n        if (!options) {\n            options = ModelDecorationOptions.createDynamic({\n                description: 'unicode-highlight',\n                stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n                className: 'unicode-highlight',\n                showIfCollapsed: true,\n                overviewRuler: null,\n                minimap: null,\n                hideInCommentTokens: hideInComments,\n                hideInStringTokens: hideInStrings,\n            });\n            this.map.set(key, options);\n        }\n        return options;\n    }\n}\nDecorations.instance = new Decorations();\nexport class DisableHighlightingInCommentsAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingInComments', 'Disable highlighting of characters in comments'),\n            alias: 'Disable highlighting of characters in comments',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingInComments.shortLabel', 'Disable Highlight In Comments');\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n            if (configurationService) {\n                this.runAction(configurationService);\n            }\n        });\n    }\n    runAction(configurationService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield configurationService.updateValue(unicodeHighlightConfigKeys.includeComments, false, 2 /* ConfigurationTarget.USER */);\n        });\n    }\n}\nexport class DisableHighlightingInStringsAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingInStrings', 'Disable highlighting of characters in strings'),\n            alias: 'Disable highlighting of characters in strings',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingInStrings.shortLabel', 'Disable Highlight In Strings');\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n            if (configurationService) {\n                this.runAction(configurationService);\n            }\n        });\n    }\n    runAction(configurationService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield configurationService.updateValue(unicodeHighlightConfigKeys.includeStrings, false, 2 /* ConfigurationTarget.USER */);\n        });\n    }\n}\nexport class DisableHighlightingOfAmbiguousCharactersAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters', 'Disable highlighting of ambiguous characters'),\n            alias: 'Disable highlighting of ambiguous characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel', 'Disable Ambiguous Highlight');\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n            if (configurationService) {\n                this.runAction(configurationService);\n            }\n        });\n    }\n    runAction(configurationService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield configurationService.updateValue(unicodeHighlightConfigKeys.ambiguousCharacters, false, 2 /* ConfigurationTarget.USER */);\n        });\n    }\n}\nDisableHighlightingOfAmbiguousCharactersAction.ID = 'editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters';\nexport class DisableHighlightingOfInvisibleCharactersAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfInvisibleCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfInvisibleCharacters', 'Disable highlighting of invisible characters'),\n            alias: 'Disable highlighting of invisible characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel', 'Disable Invisible Highlight');\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n            if (configurationService) {\n                this.runAction(configurationService);\n            }\n        });\n    }\n    runAction(configurationService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield configurationService.updateValue(unicodeHighlightConfigKeys.invisibleCharacters, false, 2 /* ConfigurationTarget.USER */);\n        });\n    }\n}\nDisableHighlightingOfInvisibleCharactersAction.ID = 'editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters';\nexport class DisableHighlightingOfNonBasicAsciiCharactersAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfNonBasicAsciiCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters', 'Disable highlighting of non basic ASCII characters'),\n            alias: 'Disable highlighting of non basic ASCII characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel', 'Disable Non ASCII Highlight');\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n            if (configurationService) {\n                this.runAction(configurationService);\n            }\n        });\n    }\n    runAction(configurationService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield configurationService.updateValue(unicodeHighlightConfigKeys.nonBasicASCII, false, 2 /* ConfigurationTarget.USER */);\n        });\n    }\n}\nDisableHighlightingOfNonBasicAsciiCharactersAction.ID = 'editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters';\nexport class ShowExcludeOptions extends EditorAction {\n    constructor() {\n        super({\n            id: ShowExcludeOptions.ID,\n            label: nls.localize('action.unicodeHighlight.showExcludeOptions', \"Show Exclude Options\"),\n            alias: 'Show Exclude Options',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { codePoint, reason, inString, inComment } = args;\n            const char = String.fromCodePoint(codePoint);\n            const quickPickService = accessor.get(IQuickInputService);\n            const configurationService = accessor.get(IConfigurationService);\n            function getExcludeCharFromBeingHighlightedLabel(codePoint) {\n                if (InvisibleCharacters.isInvisibleCharacter(codePoint)) {\n                    return nls.localize('unicodeHighlight.excludeInvisibleCharFromBeingHighlighted', 'Exclude {0} (invisible character) from being highlighted', codePointToHex(codePoint));\n                }\n                return nls.localize('unicodeHighlight.excludeCharFromBeingHighlighted', 'Exclude {0} from being highlighted', `${codePointToHex(codePoint)} \"${char}\"`);\n            }\n            const options = [];\n            if (reason.kind === 0 /* UnicodeHighlighterReasonKind.Ambiguous */) {\n                for (const locale of reason.notAmbiguousInLocales) {\n                    options.push({\n                        label: nls.localize(\"unicodeHighlight.allowCommonCharactersInLanguage\", \"Allow unicode characters that are more common in the language \\\"{0}\\\".\", locale),\n                        run: () => __awaiter(this, void 0, void 0, function* () {\n                            excludeLocaleFromBeingHighlighted(configurationService, [locale]);\n                        }),\n                    });\n                }\n            }\n            options.push({\n                label: getExcludeCharFromBeingHighlightedLabel(codePoint),\n                run: () => excludeCharFromBeingHighlighted(configurationService, [codePoint])\n            });\n            if (inComment) {\n                const action = new DisableHighlightingInCommentsAction();\n                options.push({ label: action.label, run: () => __awaiter(this, void 0, void 0, function* () { return action.runAction(configurationService); }) });\n            }\n            else if (inString) {\n                const action = new DisableHighlightingInStringsAction();\n                options.push({ label: action.label, run: () => __awaiter(this, void 0, void 0, function* () { return action.runAction(configurationService); }) });\n            }\n            if (reason.kind === 0 /* UnicodeHighlighterReasonKind.Ambiguous */) {\n                const action = new DisableHighlightingOfAmbiguousCharactersAction();\n                options.push({ label: action.label, run: () => __awaiter(this, void 0, void 0, function* () { return action.runAction(configurationService); }) });\n            }\n            else if (reason.kind === 1 /* UnicodeHighlighterReasonKind.Invisible */) {\n                const action = new DisableHighlightingOfInvisibleCharactersAction();\n                options.push({ label: action.label, run: () => __awaiter(this, void 0, void 0, function* () { return action.runAction(configurationService); }) });\n            }\n            else if (reason.kind === 2 /* UnicodeHighlighterReasonKind.NonBasicAscii */) {\n                const action = new DisableHighlightingOfNonBasicAsciiCharactersAction();\n                options.push({ label: action.label, run: () => __awaiter(this, void 0, void 0, function* () { return action.runAction(configurationService); }) });\n            }\n            else {\n                expectNever(reason);\n            }\n            const result = yield quickPickService.pick(options, { title: nls.localize('unicodeHighlight.configureUnicodeHighlightOptions', 'Configure Unicode Highlight Options') });\n            if (result) {\n                yield result.run();\n            }\n        });\n    }\n}\nShowExcludeOptions.ID = 'editor.action.unicodeHighlight.showExcludeOptions';\nfunction excludeCharFromBeingHighlighted(configurationService, charCodes) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const existingValue = configurationService.getValue(unicodeHighlightConfigKeys.allowedCharacters);\n        let value;\n        if ((typeof existingValue === 'object') && existingValue) {\n            value = existingValue;\n        }\n        else {\n            value = {};\n        }\n        for (const charCode of charCodes) {\n            value[String.fromCodePoint(charCode)] = true;\n        }\n        yield configurationService.updateValue(unicodeHighlightConfigKeys.allowedCharacters, value, 2 /* ConfigurationTarget.USER */);\n    });\n}\nfunction excludeLocaleFromBeingHighlighted(configurationService, locales) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n        const existingValue = (_a = configurationService.inspect(unicodeHighlightConfigKeys.allowedLocales).user) === null || _a === void 0 ? void 0 : _a.value;\n        let value;\n        if ((typeof existingValue === 'object') && existingValue) {\n            // Copy value, as the existing value is read only\n            value = Object.assign({}, existingValue);\n        }\n        else {\n            value = {};\n        }\n        for (const locale of locales) {\n            value[locale] = true;\n        }\n        yield configurationService.updateValue(unicodeHighlightConfigKeys.allowedLocales, value, 2 /* ConfigurationTarget.USER */);\n    });\n}\nfunction expectNever(value) {\n    throw new Error(`Unexpected value: ${value}`);\n}\nregisterEditorAction(DisableHighlightingOfAmbiguousCharactersAction);\nregisterEditorAction(DisableHighlightingOfInvisibleCharactersAction);\nregisterEditorAction(DisableHighlightingOfNonBasicAsciiCharactersAction);\nregisterEditorAction(ShowExcludeOptions);\nregisterEditorContribution(UnicodeHighlighter.ID, UnicodeHighlighter);\nHoverParticipantRegistry.register(UnicodeHighlighterHoverParticipant);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport * as nls from '../../../../nls.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nconst ignoreUnusualLineTerminators = 'ignoreUnusualLineTerminators';\nfunction writeIgnoreState(codeEditorService, model, state) {\n    codeEditorService.setModelProperty(model.uri, ignoreUnusualLineTerminators, state);\n}\nfunction readIgnoreState(codeEditorService, model) {\n    return codeEditorService.getModelProperty(model.uri, ignoreUnusualLineTerminators);\n}\nlet UnusualLineTerminatorsDetector = class UnusualLineTerminatorsDetector extends Disposable {\n    constructor(_editor, _dialogService, _codeEditorService) {\n        super();\n        this._editor = _editor;\n        this._dialogService = _dialogService;\n        this._codeEditorService = _codeEditorService;\n        this._config = this._editor.getOption(116 /* EditorOption.unusualLineTerminators */);\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(116 /* EditorOption.unusualLineTerminators */)) {\n                this._config = this._editor.getOption(116 /* EditorOption.unusualLineTerminators */);\n                this._checkForUnusualLineTerminators();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._checkForUnusualLineTerminators();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            if (e.isUndoing) {\n                // skip checking in case of undoing\n                return;\n            }\n            this._checkForUnusualLineTerminators();\n        }));\n    }\n    _checkForUnusualLineTerminators() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._config === 'off') {\n                return;\n            }\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            if (!model.mightContainUnusualLineTerminators()) {\n                return;\n            }\n            const ignoreState = readIgnoreState(this._codeEditorService, model);\n            if (ignoreState === true) {\n                // this model should be ignored\n                return;\n            }\n            if (this._editor.getOption(83 /* EditorOption.readOnly */)) {\n                // read only editor => sorry!\n                return;\n            }\n            if (this._config === 'auto') {\n                // just do it!\n                model.removeUnusualLineTerminators(this._editor.getSelections());\n                return;\n            }\n            const result = yield this._dialogService.confirm({\n                title: nls.localize('unusualLineTerminators.title', \"Unusual Line Terminators\"),\n                message: nls.localize('unusualLineTerminators.message', \"Detected unusual line terminators\"),\n                detail: nls.localize('unusualLineTerminators.detail', \"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\\n\\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.\", basename(model.uri)),\n                primaryButton: nls.localize('unusualLineTerminators.fix', \"Remove Unusual Line Terminators\"),\n                secondaryButton: nls.localize('unusualLineTerminators.ignore', \"Ignore\")\n            });\n            if (!result.confirmed) {\n                // this model should be ignored\n                writeIgnoreState(this._codeEditorService, model, true);\n                return;\n            }\n            model.removeUnusualLineTerminators(this._editor.getSelections());\n        });\n    }\n};\nUnusualLineTerminatorsDetector.ID = 'editor.contrib.unusualLineTerminatorsDetector';\nUnusualLineTerminatorsDetector = __decorate([\n    __param(1, IDialogService),\n    __param(2, ICodeEditorService)\n], UnusualLineTerminatorsDetector);\nexport { UnusualLineTerminatorsDetector };\nregisterEditorContribution(UnusualLineTerminatorsDetector.ID, UnusualLineTerminatorsDetector);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { getDocumentRangeSemanticTokens, hasDocumentRangeSemanticTokensProvider } from '../../../common/services/getSemanticTokens.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { isSemanticColoringEnabled, SEMANTIC_HIGHLIGHTING_SETTING_ID } from '../../../common/services/modelService.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nlet ViewportSemanticTokensContribution = class ViewportSemanticTokensContribution extends Disposable {\n    constructor(editor, _modelService, _themeService, _configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._modelService = _modelService;\n        this._themeService = _themeService;\n        this._configurationService = _configurationService;\n        this._editor = editor;\n        this._provider = languageFeaturesService.documentRangeSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentRangeSemanticTokens', { min: 100, max: 500 });\n        this._tokenizeViewport = this._register(new RunOnceScheduler(() => this._tokenizeViewportNow(), 100));\n        this._outstandingRequests = [];\n        const scheduleTokenizeViewport = () => {\n            if (this._editor.hasModel()) {\n                this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()));\n            }\n        };\n        this._register(this._editor.onDidScrollChange(() => {\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._provider.onDidChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                this._cancelAll();\n                scheduleTokenizeViewport();\n            }\n        }));\n        this._register(this._themeService.onDidColorThemeChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n    }\n    _cancelAll() {\n        for (const request of this._outstandingRequests) {\n            request.cancel();\n        }\n        this._outstandingRequests = [];\n    }\n    _removeOutstandingRequest(req) {\n        for (let i = 0, len = this._outstandingRequests.length; i < len; i++) {\n            if (this._outstandingRequests[i] === req) {\n                this._outstandingRequests.splice(i, 1);\n                return;\n            }\n        }\n    }\n    _tokenizeViewportNow() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (model.tokenization.hasCompleteSemanticTokens()) {\n            return;\n        }\n        if (!isSemanticColoringEnabled(model, this._themeService, this._configurationService)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!hasDocumentRangeSemanticTokensProvider(this._provider, model)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        this._outstandingRequests = this._outstandingRequests.concat(visibleRanges.map(range => this._requestRange(model, range)));\n    }\n    _requestRange(model, range) {\n        const requestVersionId = model.getVersionId();\n        const request = createCancelablePromise(token => Promise.resolve(getDocumentRangeSemanticTokens(this._provider, model, range, token)));\n        const sw = new StopWatch(false);\n        request.then((r) => {\n            this._debounceInformation.update(model, sw.elapsed());\n            if (!r || !r.tokens || model.isDisposed() || model.getVersionId() !== requestVersionId) {\n                return;\n            }\n            const { provider, tokens: result } = r;\n            const styling = this._modelService.getSemanticTokensProviderStyling(provider);\n            model.tokenization.setPartialSemanticTokens(range, toMultilineTokens2(result, styling, model.getLanguageId()));\n        }).then(() => this._removeOutstandingRequest(request), () => this._removeOutstandingRequest(request));\n        return request;\n    }\n};\nViewportSemanticTokensContribution.ID = 'editor.contrib.viewportSemanticTokens';\nViewportSemanticTokensContribution = __decorate([\n    __param(1, IModelService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], ViewportSemanticTokensContribution);\nregisterEditorContribution(ViewportSemanticTokensContribution.ID, ViewportSemanticTokensContribution);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, first, timeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { MinimapPosition, OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { activeContrastBorder, editorSelectionHighlight, editorSelectionHighlightBorder, minimapSelectionOccurrenceHighlight, overviewRulerSelectionHighlightForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nconst editorWordHighlight = registerColor('editor.wordHighlightBackground', { dark: '#575757B8', light: '#57575740', hcDark: null, hcLight: null }, nls.localize('wordHighlight', 'Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst editorWordHighlightStrong = registerColor('editor.wordHighlightStrongBackground', { dark: '#004972B8', light: '#0e639c40', hcDark: null, hcLight: null }, nls.localize('wordHighlightStrong', 'Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst editorWordHighlightBorder = registerColor('editor.wordHighlightBorder', { light: null, dark: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('wordHighlightBorder', 'Border color of a symbol during read-access, like reading a variable.'));\nconst editorWordHighlightStrongBorder = registerColor('editor.wordHighlightStrongBorder', { light: null, dark: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('wordHighlightStrongBorder', 'Border color of a symbol during write-access, like writing to a variable.'));\nconst overviewRulerWordHighlightForeground = registerColor('editorOverviewRuler.wordHighlightForeground', { dark: '#A0A0A0CC', light: '#A0A0A0CC', hcDark: '#A0A0A0CC', hcLight: '#A0A0A0CC' }, nls.localize('overviewRulerWordHighlightForeground', 'Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst overviewRulerWordHighlightStrongForeground = registerColor('editorOverviewRuler.wordHighlightStrongForeground', { dark: '#C0A0C0CC', light: '#C0A0C0CC', hcDark: '#C0A0C0CC', hcLight: '#C0A0C0CC' }, nls.localize('overviewRulerWordHighlightStrongForeground', 'Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\nexport function getOccurrencesAtPosition(registry, model, position, token) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = none empty array)\n    return first(orderedByScore.map(provider => () => {\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), arrays.isNonEmptyArray);\n}\nclass OccurenceAtPositionRequest {\n    constructor(_model, _selection, _wordSeparators) {\n        this._model = _model;\n        this._selection = _selection;\n        this._wordSeparators = _wordSeparators;\n        this._wordRange = this._getCurrentWordRange(_model, _selection);\n        this._result = null;\n    }\n    get result() {\n        if (!this._result) {\n            this._result = createCancelablePromise(token => this._compute(this._model, this._selection, this._wordSeparators, token));\n        }\n        return this._result;\n    }\n    _getCurrentWordRange(model, selection) {\n        const word = model.getWordAtPosition(selection.getPosition());\n        if (word) {\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n        }\n        return null;\n    }\n    isValid(model, selection, decorations) {\n        const lineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endColumn = selection.endColumn;\n        const currentWordRange = this._getCurrentWordRange(model, selection);\n        let requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\n        // (Same symbol)\n        for (let i = 0, len = decorations.length; !requestIsValid && i < len; i++) {\n            const range = decorations.getRange(i);\n            if (range && range.startLineNumber === lineNumber) {\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\n                    requestIsValid = true;\n                }\n            }\n        }\n        return requestIsValid;\n    }\n    cancel() {\n        this.result.cancel();\n    }\n}\nclass SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAtPosition(this._providers, model, selection.getPosition(), token).then(value => value || []);\n    }\n}\nclass TextualOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators) {\n        super(model, selection, wordSeparators);\n        this._selectionIsEmpty = selection.isEmpty();\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return timeout(250, token).then(() => {\n            if (!selection.isEmpty()) {\n                return [];\n            }\n            const word = model.getWordAtPosition(selection.getPosition());\n            if (!word || word.word.length > 1000) {\n                return [];\n            }\n            const matches = model.findMatches(word.word, true, false, true, wordSeparators, false);\n            return matches.map(m => {\n                return {\n                    range: m.range,\n                    kind: DocumentHighlightKind.Text\n                };\n            });\n        });\n    }\n    isValid(model, selection, decorations) {\n        const currentSelectionIsEmpty = selection.isEmpty();\n        if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\n            return false;\n        }\n        return super.isValid(model, selection, decorations);\n    }\n}\nfunction computeOccurencesAtPosition(registry, model, selection, wordSeparators) {\n    if (registry.has(model)) {\n        return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators, registry);\n    }\n    return new TextualOccurenceAtPositionRequest(model, selection, wordSeparators);\n}\nregisterModelAndPositionCommand('_executeDocumentHighlights', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    return getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, position, CancellationToken.None);\n});\nclass WordHighlighter {\n    constructor(editor, providers, contextKeyService) {\n        this.toUnhook = new DisposableStore();\n        this.workerRequestTokenId = 0;\n        this.workerRequestCompleted = false;\n        this.workerRequestValue = [];\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        this.editor = editor;\n        this.providers = providers;\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\n        this._ignorePositionChangeEvent = false;\n        this.occurrencesHighlight = this.editor.getOption(74 /* EditorOption.occurrencesHighlight */);\n        this.model = this.editor.getModel();\n        this.toUnhook.add(editor.onDidChangeCursorPosition((e) => {\n            if (this._ignorePositionChangeEvent) {\n                // We are changing the position => ignore this event\n                return;\n            }\n            if (!this.occurrencesHighlight) {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this._onPositionChanged(e);\n        }));\n        this.toUnhook.add(editor.onDidChangeModelContent((e) => {\n            this._stopAll();\n        }));\n        this.toUnhook.add(editor.onDidChangeConfiguration((e) => {\n            const newValue = this.editor.getOption(74 /* EditorOption.occurrencesHighlight */);\n            if (this.occurrencesHighlight !== newValue) {\n                this.occurrencesHighlight = newValue;\n                this._stopAll();\n            }\n        }));\n        this.decorations = this.editor.createDecorationsCollection();\n        this.workerRequestTokenId = 0;\n        this.workerRequest = null;\n        this.workerRequestCompleted = false;\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n    }\n    hasDecorations() {\n        return (this.decorations.length > 0);\n    }\n    restore() {\n        if (!this.occurrencesHighlight) {\n            return;\n        }\n        this._run();\n    }\n    _getSortedHighlights() {\n        return (this.decorations.getRanges()\n            .sort(Range.compareRangesUsingStarts));\n    }\n    moveNext() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index + 1) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    moveBack() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index - 1 + highlights.length) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    _removeDecorations() {\n        if (this.decorations.length > 0) {\n            // remove decorations\n            this.decorations.clear();\n            this._hasWordHighlights.set(false);\n        }\n    }\n    _stopAll() {\n        // Remove any existing decorations\n        this._removeDecorations();\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _onPositionChanged(e) {\n        // disabled\n        if (!this.occurrencesHighlight) {\n            this._stopAll();\n            return;\n        }\n        // ignore typing & other\n        if (e.reason !== 3 /* CursorChangeReason.Explicit */) {\n            this._stopAll();\n            return;\n        }\n        this._run();\n    }\n    _getWord() {\n        const editorSelection = this.editor.getSelection();\n        const lineNumber = editorSelection.startLineNumber;\n        const startColumn = editorSelection.startColumn;\n        return this.model.getWordAtPosition({\n            lineNumber: lineNumber,\n            column: startColumn\n        });\n    }\n    _run() {\n        const editorSelection = this.editor.getSelection();\n        // ignore multiline selection\n        if (editorSelection.startLineNumber !== editorSelection.endLineNumber) {\n            this._stopAll();\n            return;\n        }\n        const startColumn = editorSelection.startColumn;\n        const endColumn = editorSelection.endColumn;\n        const word = this._getWord();\n        // The selection must be inside a word or surround one word at most\n        if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\n            this._stopAll();\n            return;\n        }\n        // All the effort below is trying to achieve this:\n        // - when cursor is moved to a word, trigger immediately a findOccurrences request\n        // - 250ms later after the last cursor move event, render the occurrences\n        // - no flickering!\n        const workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this.decorations));\n        // There are 4 cases:\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\n        // c) old workerRequest is valid, but not completed\n        // d) old workerRequest is not valid\n        // For a) no action is needed\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\n        if (workerRequestIsValid) {\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\n                // case b)\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\n                clearTimeout(this.renderDecorationsTimer);\n                this.renderDecorationsTimer = -1;\n                this._beginRenderDecorations();\n            }\n        }\n        else {\n            // case d)\n            // Stop all previous actions and start fresh\n            this._stopAll();\n            const myRequestId = ++this.workerRequestTokenId;\n            this.workerRequestCompleted = false;\n            this.workerRequest = computeOccurencesAtPosition(this.providers, this.model, this.editor.getSelection(), this.editor.getOption(119 /* EditorOption.wordSeparators */));\n            this.workerRequest.result.then(data => {\n                if (myRequestId === this.workerRequestTokenId) {\n                    this.workerRequestCompleted = true;\n                    this.workerRequestValue = data || [];\n                    this._beginRenderDecorations();\n                }\n            }, onUnexpectedError);\n        }\n    }\n    _beginRenderDecorations() {\n        const currentTime = (new Date()).getTime();\n        const minimumRenderTime = this.lastCursorPositionChangeTime + 250;\n        if (currentTime >= minimumRenderTime) {\n            // Synchronous\n            this.renderDecorationsTimer = -1;\n            this.renderDecorations();\n        }\n        else {\n            // Asynchronous\n            this.renderDecorationsTimer = setTimeout(() => {\n                this.renderDecorations();\n            }, (minimumRenderTime - currentTime));\n        }\n    }\n    renderDecorations() {\n        this.renderDecorationsTimer = -1;\n        const decorations = [];\n        for (const info of this.workerRequestValue) {\n            if (info.range) {\n                decorations.push({\n                    range: info.range,\n                    options: WordHighlighter._getDecorationOptions(info.kind)\n                });\n            }\n        }\n        this.decorations.set(decorations);\n        this._hasWordHighlights.set(this.hasDecorations());\n    }\n    static _getDecorationOptions(kind) {\n        if (kind === DocumentHighlightKind.Write) {\n            return this._WRITE_OPTIONS;\n        }\n        else if (kind === DocumentHighlightKind.Text) {\n            return this._TEXT_OPTIONS;\n        }\n        else {\n            return this._REGULAR_OPTIONS;\n        }\n    }\n    dispose() {\n        this._stopAll();\n        this.toUnhook.dispose();\n    }\n}\nWordHighlighter._WRITE_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight-strong',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlightStrong',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightStrongForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nWordHighlighter._TEXT_OPTIONS = ModelDecorationOptions.register({\n    description: 'selection-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerSelectionHighlightForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nWordHighlighter._REGULAR_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlight',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nlet WordHighlighterContribution = class WordHighlighterContribution extends Disposable {\n    constructor(editor, contextKeyService, languageFeaturesService) {\n        super();\n        this.wordHighlighter = null;\n        const createWordHighlighterIfPossible = () => {\n            if (editor.hasModel()) {\n                this.wordHighlighter = new WordHighlighter(editor, languageFeaturesService.documentHighlightProvider, contextKeyService);\n            }\n        };\n        this._register(editor.onDidChangeModel((e) => {\n            if (this.wordHighlighter) {\n                this.wordHighlighter.dispose();\n                this.wordHighlighter = null;\n            }\n            createWordHighlighterIfPossible();\n        }));\n        createWordHighlighterIfPossible();\n    }\n    static get(editor) {\n        return editor.getContribution(WordHighlighterContribution.ID);\n    }\n    saveViewState() {\n        if (this.wordHighlighter && this.wordHighlighter.hasDecorations()) {\n            return true;\n        }\n        return false;\n    }\n    moveNext() {\n        if (this.wordHighlighter) {\n            this.wordHighlighter.moveNext();\n        }\n    }\n    moveBack() {\n        if (this.wordHighlighter) {\n            this.wordHighlighter.moveBack();\n        }\n    }\n    restoreViewState(state) {\n        if (this.wordHighlighter && state) {\n            this.wordHighlighter.restore();\n        }\n    }\n    dispose() {\n        if (this.wordHighlighter) {\n            this.wordHighlighter.dispose();\n            this.wordHighlighter = null;\n        }\n        super.dispose();\n    }\n};\nWordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\nWordHighlighterContribution = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService)\n], WordHighlighterContribution);\nclass WordHighlightNavigationAction extends EditorAction {\n    constructor(next, opts) {\n        super(opts);\n        this._isNext = next;\n    }\n    run(accessor, editor) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        if (this._isNext) {\n            controller.moveNext();\n        }\n        else {\n            controller.moveBack();\n        }\n    }\n}\nclass NextWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.wordHighlight.next',\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\n            alias: 'Go to Next Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass PrevWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.wordHighlight.prev',\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\n            alias: 'Go to Previous Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass TriggerWordHighlightAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.wordHighlight.trigger',\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\n            alias: 'Trigger Symbol Highlight',\n            precondition: ctxHasWordHighlights.toNegated(),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.restoreViewState(true);\n    }\n}\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution);\nregisterEditorAction(NextWordHighlightAction);\nregisterEditorAction(PrevWordHighlightAction);\nregisterEditorAction(TriggerWordHighlightAction);\nregisterThemingParticipant((theme, collector) => {\n    const selectionHighlight = theme.getColor(editorSelectionHighlight);\n    if (selectionHighlight) {\n        collector.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${selectionHighlight}; }`);\n        collector.addRule(`.monaco-editor .selectionHighlight { background-color: ${selectionHighlight.transparent(0.5)}; }`);\n    }\n    const wordHighlight = theme.getColor(editorWordHighlight);\n    if (wordHighlight) {\n        collector.addRule(`.monaco-editor .wordHighlight { background-color: ${wordHighlight}; }`);\n    }\n    const wordHighlightStrong = theme.getColor(editorWordHighlightStrong);\n    if (wordHighlightStrong) {\n        collector.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${wordHighlightStrong}; }`);\n    }\n    const selectionHighlightBorder = theme.getColor(editorSelectionHighlightBorder);\n    if (selectionHighlightBorder) {\n        collector.addRule(`.monaco-editor .selectionHighlight { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${selectionHighlightBorder}; box-sizing: border-box; }`);\n    }\n    const wordHighlightBorder = theme.getColor(editorWordHighlightBorder);\n    if (wordHighlightBorder) {\n        collector.addRule(`.monaco-editor .wordHighlight { border: 1px ${isHighContrast(theme.type) ? 'dashed' : 'solid'} ${wordHighlightBorder}; box-sizing: border-box; }`);\n    }\n    const wordHighlightStrongBorder = theme.getColor(editorWordHighlightStrongBorder);\n    if (wordHighlightStrongBorder) {\n        collector.addRule(`.monaco-editor .wordHighlightStrong { border: 1px ${isHighContrast(theme.type) ? 'dashed' : 'solid'} ${wordHighlightStrongBorder}; box-sizing: border-box; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand } from '../../../common/commands/replaceCommand.js';\nimport { EditorOptions } from '../../../common/config/editorOptions.js';\nimport { CursorState } from '../../../common/cursorCommon.js';\nimport { WordOperations } from '../../../common/cursor/cursorWordOperations.js';\nimport { getMapForWordSeparators } from '../../../common/core/wordCharacterClassifier.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IsWindowsContext } from '../../../../platform/contextkey/common/contextkeys.js';\nexport class MoveWordCommand extends EditorCommand {\n    constructor(opts) {\n        super(opts);\n        this._inSelectionMode = opts.inSelectionMode;\n        this._wordNavigationType = opts.wordNavigationType;\n    }\n    runEditorCommand(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(119 /* EditorOption.wordSeparators */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const result = selections.map((sel) => {\n            const inPosition = new Position(sel.positionLineNumber, sel.positionColumn);\n            const outPosition = this._move(wordSeparators, model, inPosition, this._wordNavigationType);\n            return this._moveTo(sel, outPosition, this._inSelectionMode);\n        });\n        model.pushStackElement();\n        editor._getViewModel().setCursorStates('moveWordCommand', 3 /* CursorChangeReason.Explicit */, result.map(r => CursorState.fromModelSelection(r)));\n        if (result.length === 1) {\n            const pos = new Position(result[0].positionLineNumber, result[0].positionColumn);\n            editor.revealPosition(pos, 0 /* ScrollType.Smooth */);\n        }\n    }\n    _moveTo(from, to, inSelectionMode) {\n        if (inSelectionMode) {\n            // move just position\n            return new Selection(from.selectionStartLineNumber, from.selectionStartColumn, to.lineNumber, to.column);\n        }\n        else {\n            // move everything\n            return new Selection(to.lineNumber, to.column, to.lineNumber, to.column);\n        }\n    }\n}\nexport class WordLeftCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordOperations.moveWordLeft(wordSeparators, model, position, wordNavigationType);\n    }\n}\nexport class WordRightCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordOperations.moveWordRight(wordSeparators, model, position, wordNavigationType);\n    }\n}\nexport class CursorWordStartLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartLeft',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndLeft',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordLeft extends WordLeftCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 1 /* WordNavigationType.WordStartFast */,\n            id: 'cursorWordLeft',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 15 /* KeyCode.LeftArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordStartLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartLeftSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndLeftSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordLeftSelect extends WordLeftCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 1 /* WordNavigationType.WordStartFast */,\n            id: 'cursorWordLeftSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Accessibility navigation commands should only be enabled on windows since they are tuned to what NVDA expects\nexport class CursorWordAccessibilityLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityLeft',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class CursorWordAccessibilityLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityLeftSelect',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class CursorWordStartRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartRight',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndRight extends WordRightCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndRight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordRight',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordStartRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartRightSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndRightSelect extends WordRightCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndRightSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordRightSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordAccessibilityRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityRight',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class CursorWordAccessibilityRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityRightSelect',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class DeleteWordCommand extends EditorCommand {\n    constructor(opts) {\n        super(opts);\n        this._whitespaceHeuristics = opts.whitespaceHeuristics;\n        this._wordNavigationType = opts.wordNavigationType;\n    }\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(119 /* EditorOption.wordSeparators */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const autoClosingBrackets = editor.getOption(5 /* EditorOption.autoClosingBrackets */);\n        const autoClosingQuotes = editor.getOption(8 /* EditorOption.autoClosingQuotes */);\n        const autoClosingPairs = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getAutoClosingPairs();\n        const viewModel = editor._getViewModel();\n        const commands = selections.map((sel) => {\n            const deleteRange = this._delete({\n                wordSeparators,\n                model,\n                selection: sel,\n                whitespaceHeuristics: this._whitespaceHeuristics,\n                autoClosingDelete: editor.getOption(6 /* EditorOption.autoClosingDelete */),\n                autoClosingBrackets,\n                autoClosingQuotes,\n                autoClosingPairs,\n                autoClosedCharacters: viewModel.getCursorAutoClosedCharacters()\n            }, this._wordNavigationType);\n            return new ReplaceCommand(deleteRange, '');\n        });\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteWordLeftCommand extends DeleteWordCommand {\n    _delete(ctx, wordNavigationType) {\n        const r = WordOperations.deleteWordLeft(ctx, wordNavigationType);\n        if (r) {\n            return r;\n        }\n        return new Range(1, 1, 1, 1);\n    }\n}\nexport class DeleteWordRightCommand extends DeleteWordCommand {\n    _delete(ctx, wordNavigationType) {\n        const r = WordOperations.deleteWordRight(ctx, wordNavigationType);\n        if (r) {\n            return r;\n        }\n        const lineCount = ctx.model.getLineCount();\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\n    }\n}\nexport class DeleteWordStartLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordStartLeft',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordEndLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordEndLeft',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordLeft',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1 /* KeyCode.Backspace */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class DeleteWordStartRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordStartRight',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordEndRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordEndRight',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordRight',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 20 /* KeyCode.Delete */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 20 /* KeyCode.Delete */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class DeleteInsideWord extends EditorAction {\n    constructor() {\n        super({\n            id: 'deleteInsideWord',\n            precondition: EditorContextKeys.writable,\n            label: nls.localize('deleteInsideWord', \"Delete Word\"),\n            alias: 'Delete Word'\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(119 /* EditorOption.wordSeparators */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const commands = selections.map((sel) => {\n            const deleteRange = WordOperations.deleteInsideWord(wordSeparators, model, sel);\n            return new ReplaceCommand(deleteRange, '');\n        });\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nregisterEditorCommand(new CursorWordStartLeft());\nregisterEditorCommand(new CursorWordEndLeft());\nregisterEditorCommand(new CursorWordLeft());\nregisterEditorCommand(new CursorWordStartLeftSelect());\nregisterEditorCommand(new CursorWordEndLeftSelect());\nregisterEditorCommand(new CursorWordLeftSelect());\nregisterEditorCommand(new CursorWordStartRight());\nregisterEditorCommand(new CursorWordEndRight());\nregisterEditorCommand(new CursorWordRight());\nregisterEditorCommand(new CursorWordStartRightSelect());\nregisterEditorCommand(new CursorWordEndRightSelect());\nregisterEditorCommand(new CursorWordRightSelect());\nregisterEditorCommand(new CursorWordAccessibilityLeft());\nregisterEditorCommand(new CursorWordAccessibilityLeftSelect());\nregisterEditorCommand(new CursorWordAccessibilityRight());\nregisterEditorCommand(new CursorWordAccessibilityRightSelect());\nregisterEditorCommand(new DeleteWordStartLeft());\nregisterEditorCommand(new DeleteWordEndLeft());\nregisterEditorCommand(new DeleteWordLeft());\nregisterEditorCommand(new DeleteWordStartRight());\nregisterEditorCommand(new DeleteWordEndRight());\nregisterEditorCommand(new DeleteWordRight());\nregisterEditorAction(DeleteInsideWord);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { WordPartOperations } from '../../../common/cursor/cursorWordOperations.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { DeleteWordCommand, MoveWordCommand } from '../../wordOperations/browser/wordOperations.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nexport class DeleteWordPartLeft extends DeleteWordCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordPartLeft',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _delete(ctx, wordNavigationType) {\n        const r = WordPartOperations.deleteWordPartLeft(ctx);\n        if (r) {\n            return r;\n        }\n        return new Range(1, 1, 1, 1);\n    }\n}\nexport class DeleteWordPartRight extends DeleteWordCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordPartRight',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 20 /* KeyCode.Delete */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _delete(ctx, wordNavigationType) {\n        const r = WordPartOperations.deleteWordPartRight(ctx);\n        if (r) {\n            return r;\n        }\n        const lineCount = ctx.model.getLineCount();\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\n    }\n}\nexport class WordPartLeftCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordPartOperations.moveWordPartLeft(wordSeparators, model, position);\n    }\n}\nexport class CursorWordPartLeft extends WordPartLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordPartLeft',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Register previous id for compatibility purposes\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeft', 'cursorWordPartLeft');\nexport class CursorWordPartLeftSelect extends WordPartLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordPartLeftSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Register previous id for compatibility purposes\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeftSelect', 'cursorWordPartLeftSelect');\nexport class WordPartRightCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordPartOperations.moveWordPartRight(wordSeparators, model, position);\n    }\n}\nexport class CursorWordPartRight extends WordPartRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordPartRight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordPartRightSelect extends WordPartRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordPartRightSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nregisterEditorCommand(new DeleteWordPartLeft());\nregisterEditorCommand(new DeleteWordPartRight());\nregisterEditorCommand(new CursorWordPartLeft());\nregisterEditorCommand(new CursorWordPartLeftSelect());\nregisterEditorCommand(new CursorWordPartRight());\nregisterEditorCommand(new CursorWordPartRightSelect());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nexport class ReadOnlyMessageController extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._register(this.editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit()));\n    }\n    _onDidAttemptReadOnlyEdit() {\n        const messageController = MessageController.get(this.editor);\n        if (messageController && this.editor.hasModel()) {\n            if (this.editor.isSimpleWidget) {\n                messageController.showMessage(nls.localize('editor.simple.readonly', \"Cannot edit in read-only input\"), this.editor.getPosition());\n            }\n            else {\n                messageController.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this.editor.getPosition());\n            }\n        }\n    }\n}\nReadOnlyMessageController.ID = 'editor.contrib.readOnlyMessageController';\nregisterEditorContribution(ReadOnlyMessageController.ID, ReadOnlyMessageController);\n"],"names":["__decorate","this","decorators","target","key","desc","c","r","d","i","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","reject","fulfilled","step","e","rejected","result","SelectionAnchorSet","RawContextKey","SelectionAnchorController","editor","contextKeyService","position","accessor","Selection","MarkdownString","localize","alert","anchorPosition","start","end","decorationId","IContextKeyService","SetSelectionAnchor","EditorAction","EditorContextKeys","KeyChord","_accessor","_a","GoToSelectionAnchor","SelectFromAnchorToCursor","CancelSelectionAnchor","registerEditorContribution","registerEditorAction","overviewRulerBracketMatchForeground","registerColor","nls.localize","JumpToBracketAction","BracketMatchingController","SelectToBracketAction","args","selectBrackets","BracketsData","brackets","options","Disposable","RunOnceScheduler","model","newSelections","selection","newCursorPosition","enclosingBrackets","nextBracket","selectFrom","selectTo","Range","open","close","tmp","newDecorations","newDecorationsLen","bracketData","selections","versionId","previousData","positions","positionsLen","len","Position","newData","newDataLen","previousIndex","previousLen","ModelDecorationOptions","themeColorFromId","OverviewRulerLane","registerThemingParticipant","theme","collector","bracketMatchBackground","editorBracketMatchBackground","bracketMatchBorder","editorBracketMatchBorder","MenuRegistry","MenuId","MoveCaretCommand","isMovingLeft","builder","lineNumber","startColumn","endColumn","rangeBefore","charBefore","rangeAfter","charAfter","helper","MoveCaretAction","left","opts","commands","MoveCaretLeftAction","MoveCaretRightAction","TransposeLettersAction","column","lastColumn","endPosition","MoveOperations","middlePosition","beginPosition","leftChar","rightChar","replaceRange","ReplaceCommand","CLIPBOARD_CONTEXT_MENU_GROUP","supportsCut","platform.isNative","supportsCopy","supportsPaste","browser.isFirefox","registerCommand","command","CutAction","MultiCommand","CopyAction","PasteAction","ExecCommandCopyWithSyntaxHighlightingAction","CopyOptions","registerExecCommandImpl","browserCommand","focusedEditor","ICodeEditorService","emptySelectionClipboard","codeEditorService","clipboardService","IClipboardService","platform.isWeb","clipboardText","metadata","InMemoryClipboardMetadataManager","pasteOnNewLine","multicursorText","mode","CodeActionKind","other","part","CodeActionTriggerSource","mayIncludeActionsOfKind","filter","providedKind","exclude","excludesAction","filtersAction","action","actionKind","include","CodeActionCommandArgs","kind","apply","preferred","arg","defaults","defaultAutoApply","defaultKind","codeActionCommandId","refactorCommandId","refactorPreviewCommandId","sourceActionCommandId","organizeImportsCommandId","fixAllCommandId","CodeActionItem","provider","token","err","onUnexpectedExternalError","ManagedCodeActionSet","actions","documentation","disposables","a","b","isNonEmptyArray","fix","emptyCodeActionsResponse","getCodeActions","registry","rangeOrSelection","trigger","progress","codeActionContext","cts","TextModelCancellationTokenSource","providers","getCodeActionProviders","DisposableStore","promises","providedCodeActions","filteredActions","getDocumentation","isCancellationError","listener","newProviders","equals","allActions","allDocumentation","coalesce","only","entry","currentBest","CommandsRegistry","resource","itemResolveCount","URI","illegalArgument","codeActionProvider","ILanguageFeaturesService","IModelService","validatedRangeOrSelection","codeActionSet","Progress","CancellationToken","resolving","resolveCount","item","MessageController","MutableDisposable","message","MessageWidget","TimeoutTimer","bounds","MessageCommand","EditorCommand","registerEditorCommand","MessageWidget$1","text","anchorTop","anchorBottom","messageWidget","dispose","handle","Context","CodeActionAction","Action","callback","stripNewlines","str","TEMPLATE_ID","codeActionLineHeight","CodeMenuRenderer","acceptKeybindings","keybindingService","container","data","element","index","templateData","isEnabled","isSeparator","isDocumentation","_b","accept","preview","IKeybindingService","CodeActionMenu","_editor","_delegate","_contextMenuService","_languageFeaturesService","_telemetryService","_themeService","_configurationService","_contextViewService","_contextKeyService","CodeActionKeybindingResolver","_c","_d","inputArray","renderDisposables","renderMenu","menuBlock","dom.addDisposableListener","dom.EventType","List","currIsSeparator","menuItem","height","arr","maxWidth","focusTracker","dom.trackFocus","blurListener","startIndex","Separator","openedFromString","didCancel","CodeActions","codeActions","at","actionsToShow","canceled","menuActions","anchor","resolver","useShadowDOM","toCodeActionAction","cursorCoords","editorCoords","dom.getDomNodePagePosition","x","y","IContextMenuService","ITelemetryService","IThemeService","IConfigurationService","IContextViewService","_keybindingProvider","allCodeActionBindings","Lazy","commandArgs","binding","candidates","candidate","LightBulbState","Showing","editorPosition","widgetPosition","LightBulbWidget","_quickFixActionId","_preferredFixActionId","_keybindingService","Emitter","Codicon","_","editorModel","Gesture","dom.addStandardDisposableGenericMouseDownListener","top","lineHeight","pad","atPosition","tabSize","fontInfo","lineContent","indent","computeIndentLevel","lineHasSpace","isFolded","effectiveLineNumber","preferredKb","kb","editorBackgroundColor","editorBackground","editorLightBulbForegroundColor","editorLightBulbForeground","editorLightBulbAutoFixForegroundColor","editorLightBulbAutoFixForeground","__classPrivateFieldSet","receiver","state","f","__classPrivateFieldGet","_CodeActionUi_disposed","CodeActionUi","quickFixActionId","preferredFixActionId","delegate","instantiationService","widget","navUp","newState","_e","onUnexpectedError","validActionToApply","invalidAction","includeDisabledActions","IInstantiationService","_CodeActionModel_isDisposed","SUPPORTED_CODE_ACTIONS","CodeActionOracle","_markerService","_signalChange","_delay","resources","isEqual","marker","markerRange","line","CodeActionsState","Triggered","_cancellablePromise","emptyCodeActionSet","CodeActionModel","_registry","_progressService","supportedActions","createCancelablePromise","skipNotify","contextKeyForSupportedActions","ContextKeyExpr","escapeRegExpCharacters","refactorTrigger","userArgs","codeActionFrom","triggerCodeActionsForEditorSelection","argsSchema","QuickFixController","markerService","progressService","_instantiationService","languageFeaturesService","QuickFixAction","AutoFixAction","retrigger","notAvailableMessage","triggerAction","autoApply","triggerPosition","applyCodeAction","ApplyCodeActionReason","IMarkerService","IEditorProgressService","codeActionReason","bulkEditService","IBulkEditService","commandService","ICommandService","telemetryService","notificationService","INotificationService","ResourceEdit","asMessage","controller","CodeActionCommand","RefactorAction","RefactorPreview","SourceAction","OrganizeImportsAction","FixAllAction","CodeActionContribution","weight","Registry","Extensions","editorConfigurationBaseNode","CodeLensModel","list","symbol","getCodeLensModel","providerRanks","uri","assertType","codeLensProvider","ICodeLensCache","createDecorator","CacheItem","lineCount","CodeLensCache","storageService","LRUCache","oldkey","runWhenIdle","raw","once","WillSaveStateReason","copyItems","copyModel","lines","lenses","IStorageService","registerSingleton","CodeLensViewZone","afterLineNumber","heightInPx","onHeight","CodeLensContentWidget","className","animate","children","hasSymbol","lens","title","renderLabelWithIcons","dom.$","dom.reset","link","CodeLensHelper","decoration","changeAccessor","resultingDecorations","CodeLensWidget","viewZoneChangeAccessor","updateCallback","range","codeLensData","id","symbols","resolved","CodeLensContribution","debounceService","_commandService","_notificationService","_codeLensCache","hash","dom.createStyleSheet","dom.isInShadowDOM","lineHeightFactor","fontSize","codeLensHeight","fontFamily","editorFontInfo","fontFamilyVar","fontFeaturesVar","newStyle","EDITOR_FONT_DEFAULTS","cachedLenses","disposableTimeout","cachedLensesNow","registration","scheduler","t1","newDelay","toDisposable","decorationsAccessor","viewZonesAccessor","toDispose","lastLensLineNumber","l","scrollState","StableEditorScrollState","decChangeAccessor","maxLineNumber","groups","lastGroup","layoutInfo","viewZoneAccessor","codeLensIndex","groupsIndex","symbolsLineNumber","codeLensLineNumber","toResolve","request","resolvePromise","resolvedSymbols","ILanguageFeatureDebounceService","quickInputService","IQuickInputService","codelensController","items","getColors","colors","colorInfo","getColorPresentations","colorProviderRegistry","rawCIs","ci","color","context","red","green","blue","alpha","presentations","ColorDecorationInjectedTextMarker","MAX_DECORATORS","ColorDetector","languageFeatureDebounceService","DynamicCssRules","prevIsEnabled","languageId","deprecatedConfig","colorDecorators","sw","StopWatch","colorInfos","colorDatas","decorations","colorData","rgba","RGBA","ref","noBreakWhitespace","ColorPickerModel","availableColorPresentations","presentationIndex","colorPresentations","originalText","$","ColorPickerHeader","themeService","dom.append","tooltip","colorBox","Color","editorHoverBackground","ColorPickerBody","pixelRatio","SaturationBox","OpacityStrip","HueStrip","s","v","hsva","HSVA","h","GlobalPointerMoveMonitor","origin","event","pointerUpListener","saturatedColor","ctx","whiteGradient","blackGradient","Strip","monitor","g","opaque","transparent","ColorPickerWidget","Widget","PixelRatio","header","ColorHover","owner","ColorHoverParticipant","lineDecorations","AsyncIterableObject","colorDetector","hoverParts","colorHover","updateEditorModel","textEdits","newRange","trackedRange","updateColorPresentations","hasModifier","modifier","ClickLinkMouseEvent","source","ClickLinkKeyboardEvent","ClickLinkOptions","triggerKey","triggerModifier","triggerSideBySideKey","triggerSideBySideModifier","createOptions","multiCursorModifier","platform.isMacintosh","ClickLinkGesture","newOpts","mouseEvent","currentLineNumber","EmbeddedCodeEditorWidget","CodeEditorWidget","domElement","parentEditor","accessibilityService","languageConfigurationService","newOptions","objects.mixin","IAccessibilityService","ILanguageConfigurationService","defaultColor","defaultOptions","WIDGET_ID","ViewZoneDelegate","domNode","afterColumn","heightInLines","onDomNodeTop","onComputedHeight","OverlayWidgetDelegate","Arrow","dom.removeCSSRulesContainingSelector","dom.createCSSRule","where","IdGenerator","ZoneWidget","objects.deepClone","info","width","styles","frameColor","arrowColor","containerHeight","rangeOrPos","arrowHeight","frameThickness","viewZoneDomNode","maxHeightInLines","revealLine","isLastLine","classToReplace","widthInPixel","heightInPixel","newHeightInLines","Sash","evt","lineDelta","roundedLineDelta","BaseDropdown","ActionRunner","append","labelRenderer","EventType","GestureEventType","addDisposableListener","EventHelper","StandardKeyboardEvent","cleanupFn","DropdownMenu","DropdownMenuActionViewItem","BaseActionViewItem","menuActionsOrProvider","contextMenuProvider","el","classNames","isActionsArray","visible","that","newContext","disabled","createAndFillInActionBarActions","menu","primaryGroup","primaryMaxCount","shouldInlineSubmenu","useSeparatorsInPrimaryActions","fillInActions","actionGroup","asDisposable","useAlternativeActions","isPrimaryAction","primaryBucket","secondaryBucket","submenuInfo","group","MenuItemAction","newLen","SubmenuAction","submenuActions","overflow","MenuEntryActionViewItem","ActionViewItem","ModifierKeyEmitter","mouseOver","alternativeKeyDown","isWindows","isLinux","updateAltState","wantsAltCommand","keybinding","keybindingLabel","altTooltip","altKeybinding","altKeybindingLabel","altTitleSection","UILabelProvider","OS","label","icon","ThemeIcon","iconClasses","isDark","asCSSUrl","combinedDisposable","SubmenuEntryActionViewItem","dropdownOptions","setBackgroundImage","DropdownWithDefaultActionViewItem","submenuAction","_menuService","_instaService","_storageService","defaultAction","defaultActionId","lastAction","prepend","defaultActionKeybinding","primaryContainer","dropdownContainer","fromRight","focusable","IMenuService","createActionViewItem","instaService","SubmenuItemAction","IPeekViewService","existing","remove","PeekContext","PeekContextController","getOuterEditor","PeekViewWidget","noCloseAction","titleElement","dom.addStandardDisposableListener","actionsContainer","actionBarOptions","ActionBar","primaryHeading","secondaryHeading","dom.clearNode","dom.show","dom.hide","headHeight","bodyHeight","peekViewTitleBackground","editorInfoForeground","peekViewTitleForeground","editorForeground","peekViewTitleInfoForeground","peekViewBorder","contrastBorder","peekViewResultsBackground","peekViewEditorBackground","activeContrastBorder","OneReference","isProviderFirst","parent","_rangeCallback","defaultGenerator","basename","FilePreview","_modelReference","n","startLineNumber","endLineNumber","word","beforeRange","afterRange","before","inside","after","FileReferences","ResourceMap","child","textModelResolverService","ReferencesModel","links","providersFirst","current","extUri","oneRef","reference","next","idx","childCount","groupCount","nearest","strings.commonPrefixLength","DataSource","_resolverService","val","ITextModelService","Delegate","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","parts","IdentityProvider","FileReferencesTemplate","_labelService","IconLabel","CountBadge","attachBadgeStyler","matches","dirname","ILabelService","node","template","createMatches","OneReferenceTemplate","HighlightedLabel","score","highlight","FuzzyScore","AccessibilityProvider","DecorationsManager","_model","newDecorationsActualIndex","oneReference","toRemove","ignore","lineLength","newLineLength","LayoutData","ratio","ReferencesTree","WorkbenchAsyncDataTree","ReferenceWidget","peekView.PeekViewWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","_uriLabel","_undoRedoService","_languageService","_languageConfigurationService","dom.Dimension","borderColor","peekView.peekViewBorder","peekView.peekViewTitleBackground","peekView.peekViewTitleForeground","peekView.peekViewTitleInfoForeground","containerElement","SplitView","TextModel","PLAINTEXT_LANGUAGE_ID","treeOptions","peekView.peekViewResultsBackground","Event","Sizing","onEvent","newModel","revealParent","Schemas","basenameOrAuthority","promise","scrollType","sel","peekView.IPeekViewService","IUndoRedoService","ILanguageService","ctxReferenceSearchVisible","ReferencesController","_editorService","modelPromise","peekMode","storageKey","requestId","pos","error","fwd","currentPosition","editorFocus","previewEditorFocus","focusEditor","openedEditor","sideBySide","pinned","withController","fn","outerEditor","KeybindingsRegistry","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","WorkbenchTreeElementCanExpand","focus","IListService","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","refModel","editorState","EditorState","seenUri","seenPosition","editorService","getLocationLinks","provide","values","getDefinitionsAtPosition","getDeclarationsAtPosition","getImplementationsAtPosition","getTypeDefinitionsAtPosition","getReferencesAtPosition","compact","resultWithoutDeclaration","_sortedAndDeduped","rawLinks","modelLinks","registerModelAndPositionCommand","_f","_g","_h","_goToActionIds","registerGoToAction","ctor","registerInstantiatedEditorAction","SymbolNavigationAnchor","thing","corePosition.Position","SymbolNavigationAction","configuration","symbolNavService","EditorStateCancellationTokenSource","raceCancellation","references","altAction","altActionId","referenceCount","gotoLocation","peek","targetEditor","isLocationLink","modelNow","DefinitionAction","goToDefinitionKb","isWeb","isStandalone","GoToDefinitionAction","OpenDefinitionToSideAction","PeekDefinitionAction","DeclarationAction","GoToDeclarationAction","TypeDefinitionAction","GoToTypeDefinitionAction","PeekTypeDefinitionAction","ImplementationAction","GoToImplementationAction","PeekImplementationAction","ReferencesAction","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_position","_token","multiple","noResultsMessage","openInPeek","isCodeEditor","control","GotoDefinitionAtPositionEditorContribution","languageService","linkGesture","keyboardEvent","withNullAsUndefined","withKey","results","textEditorModel","previewValue","wordRange","rangeToUse","previewRange","minIndent","endIndent","startIndent","hoverMessage","openToSide","canPeek","activeLinkForeground","editorActiveLinkForeground","HoverWidget","DomScrollableElement","HoverAction","actionOptions","enabled","__asyncValues","o","m","verb","settle","HoverResult","isComplete","hasLoadingMessage","HoverOperation","_computer","fireResult","createCancelableAsyncIterable","e_1","e_1_1","HoverRangeAnchor","priority","lastAnchor","showAtPosition","HoverForeignElementAnchor","HoverParticipantRegistry","Scanner","ch","type","Marker","Text","others","newChildren","_fixParent","TextmateSnippet","prev","cur","TransformableMarker","Placeholder","Choice","ret","Transform","_this","didMatch","FormatString","shorthandName","ifValue","elseValue","match","Variable","name","walk","visitor","stack","all","last","found","placeholder","SnippetParser","insertFinalTabstop","enforceFinalTabstop","snippet","offset","placeholderDefaultValues","incompletePlaceholders","defaultValues","clone","p","nextToken","choice","variable","transform","regexValue","regexOptions","escaped","complex","shorthand","NLS_DEFAULT_LABEL","NLS_PRESERVE_CASE_LABEL","PreserveCaseToggle","Toggle","ReplaceInput","contextViewProvider","_showOptionButtons","appendPreserveCaseLabel","history","flexibleHeight","flexibleWidth","flexibleMaxHeight","HistoryInputBox","viaKeyboard","indexes","newIndex","dom.EventHelper","controls","toggleStyles","inputBoxStyles","newWidth","historyNavigationVisible","HistoryNavigationWidgetFocusContext","HistoryNavigationForwardsEnablementContext","HistoryNavigationBackwardsEnablementContext","lastFocusedWidget","widgets","registerAndCreateHistoryNavigationContext","disposableStore","scopedContextKeyService","historyNavigationWidgetFocus","historyNavigationForwardsEnablement","historyNavigationBackwardsEnablement","onDidFocus","onDidBlur","ContextScopedFindInput","FindInput","showFindOptions","ContextScopedReplaceInput","showReplaceOptions","suggestWidgetStatusbarMenu","CompletionItem","completion","sub","CompletionOptions","snippetSortOrder","kindFilter","providerFilter","showDeprecated","_snippetSuggestSupport","getSnippetSuggestSupport","CompletionItemModel","needsClipboard","durations","disposable","provideSuggestionItems","defaultReplaceRange","defaultRange","onCompletionList","didAddResult","suggestion","isDisposable","snippetCompletions","providerGroup","CancellationError","getSuggestionComparator","defaultComparator","snippetUpComparator","snippetDownComparator","_snippetComparators","snippetConfig","triggerCharacter","maxItemsToResolve","completionProvider","completions","showSimpleSuggestions","QuickSuggestionsOptions","tokenType","ContentHoverController","ContentHoverWidget","participant","p1","p2","ContentHoverComputer","TokenizationRegistry","anchorCandidates","epsilon","filteredMessages","loadingMessage","messages","showAtRange","highlightRange","statusBar","EditorHoverStatusBar","fragment","colorPicker","msg","highlightDecoration","ContentHoverVisibleData","anchorRange","anchorLineNumber","renderStartColumn","renderEndColumn","forceShowAtRange","preferAbove","stoleFocus","SuggestContext","visibleData","scrollDimensions","extraBottomPadding","_participants","maxColumn","__marked_exports","define","deps","factory","global","exports","module","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","_unsupportedIterableToArray","minLen","_arrayLikeToArray","arr2","_createForOfIteratorHelperLoose","allowArrayLike","it","getDefaults","changeDefaults","newDefaults","escapeTest","escapeReplace","escapeTestNoEncode","escapeReplaceNoEncode","escapeReplacements","getEscapeReplacement","escape","html","encode","unescapeTest","unescape","caret","edit","regex","opt","obj","nonWordAndColonTest","originIndependentUrl","cleanUrl","sanitize","base","href","prot","resolveUrl","baseUrls","justDomain","protocol","domain","rtrim","relativeBase","noopTest","merge","splitCells","tableRow","count","row","curr","cells","invert","suffLen","currChar","findClosingBracket","level","checkSanitizeDeprecation","repeatString","pattern","outputLink","cap","lexer","indentCodeCompensation","matchIndentToCode","indentToCode","matchIndentInNode","indentInNode","Tokenizer","_proto","src","trimmed","istask","ischecked","blankLine","endsWithBlankLine","nextLine","rawLine","itemContents","endEarly","bull","isordered","itemRegex","nextBulletRegex","hrRegex","spacers","t","hasMultipleLineBreaks","chars","lineBreaks","_iterator","_step","_char","tag","j","k","trimmedUrl","rtrimSlash","lastParenIndex","linkLen","maskedSrc","prevChar","nextChar","lLength","rDelim","rLength","delimTotal","midDelimTotal","endReg","_text","hasNonSpaceChars","hasSpaceCharsOnBothEnds","mangle","prevCapZero","smartypants","block","inline","out","Lexer","rules","tokens","leading","tabs","lastToken","cutSrc","lastParagraphClipped","extTokenizer","tempSrc","tempStart","getStartIndex","errMsg","_this2","keepPrevChar","Renderer","_code","infostring","lang","quote","_html","slugger","body","ordered","startatt","checked","content","flags","TextRenderer","Slugger","originalSlug","isDryRun","slug","occurenceAccumulator","Parser","parser","l2","l3","cell","loose","itemBody","task","checkbox","renderer","marked","done","pending","code","_tokens","_len","_key","extensions","hasExtensions","pack","ext","prevRenderer","_len2","_key2","_loop","prop","_len3","_key3","tokenizer","_loop2","prevTokenizer","_len4","_key4","_walkTokens","_loop3","_iterator2","_step2","_iterator3","_step3","_iterator4","_step4","_cell","childTokens","setOptions","use","walkTokens","parseInline","parse","renderMarkdown","markdown","markedOptions","isDisposed","createElement","_uriMassage","cloneAndChange","_href","isDomUri","FileAccess","dimensions","attributes","parseHrefAndDimensions","escapeDoubleQuotes","removeMarkdownEscapes","codeBlocks","onClick","DomEmitter","onAuxClick","StandardMouseEvent","resolveWithBaseUri","markdownEscapeEscapedIcons","renderedMarkdown","markdownHtmlDoc","sanitizeRenderedMarkdown","img","resolvedHref","tuples","renderedElements","placeholderElements","placeholderElement","renderedElement","DOM.reset","DOM.addDisposableListener","baseUri","resolvePath","allowedSchemes","getSanitizerOptions","dompurify.addHook","hook","DOM.hookDomPurifyHrefAndSrcSanitizer","dompurify.sanitize","dompurify.removeHook","MarkdownRenderer","_options","_openerService","languageAlias","tokenizeToString","applyFontInfo","IOpenerService","MarginHoverWidget","openerService","NullOpenerService","MarginHoverComputer","markdownHoverElement","hoverContentsElement","renderedContents","editorLayout","topForLineNumber","editorScrollTop","nodeHeight","toHoverMessage","contents","isEmptyMarkdownString","asArray","HoverProviderResult","hover","ordinal","executeProvider","isValid","getHover","getHoverPromise","hasRange","hasHtmlContent","MarkdownHover","MarkdownHoverParticipant","maxTokenizationLineLength","rng","renderMarkdownHovers","hoverPart","MarkerCoordinate","total","MarkerList","resourceFilter","_configService","compareOrder","compareMarker","res","compare","MarkerSeverity","updateMarker","uris","binarySearch","oldIdx","IMarkerNavigationService","MarkerNavigationService","LinkedList","SeverityIcon","severity","Severity","errorIconForeground","problemsErrorIconForeground","errorCodiconSelector","warningIconForeground","problemsWarningIconForeground","warningCodiconSelector","infoIconForeground","problemsInfoIconForeground","infoCodiconSelector","onRelatedInformation","related","ScrollableElement","relatedInformation","sourceAndCodeLength","splitLines","lastLineElement","detailsElement","sourceElement","codeElement","relatedInformationNode","relatedResource","relatedMessage","scrollWidth","scrollHeight","severityLabel","ariaLabel","MarkerNavigationWidget","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","headerBg","markerIdx","markerCount","detail","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoBorder","MarkerController","_markerNavigationService","CONTEXT_MARKERS_NAVIGATION_VISIBLE","reusePosition","multiFile","otherEditor","MarkerNavigationAction","_next","_multiFile","NextMarkerAction","registerIcon","PrevMarkerAction","NextMarkerInFilesAction","PrevMarkerInFilesAction","MarkerCommand","MarkerHover","markerCodeActionTrigger","MarkerHoverParticipant","_markerDecorationsService","markerHoverForStatusbar","markerHover","hoverElement","markerElement","messageElement","sourceAndCodeElement","codeLink","relatedInfoContainer","quickfixPlaceholderElement","IMarkerData","updatePlaceholderDisposable","codeActionsPromise","showing","elementPosition","cancellationToken","IMarkerDecorationsService","linkFg","textLinkForeground","activeLinkFg","textLinkActiveForeground","ModesHoverController","hideWidgetsEventHandler","hoverOpts","targetEm","ShowHoverAction","ShowDefinitionPreviewHoverAction","goto","editorHoverHighlightColor","editorHoverHighlight","hoverBackground","hoverBorder","editorHoverBorder","linkHover","hoverForeground","editorHoverForeground","actionsBackground","editorHoverStatusBarBackground","codeBackground","textCodeBlockBackground","ColorContribution","hoverController","createStringDataTransferItem","stringOrPromise","createFileDataTransferItem","fileName","VSDataTransfer","mimeType","mine","mime","generateUuid","getRandomValues","bucket","_data","_hex","CodeDataTransfers","extractEditorsDropData","editors","rawEditorsData","rawResourcesData","DataTransfers","createDraggedEditorInputFromRawResourcesData","file","rawCodeFiles","codeFiles","codeFile","contributions","contribution","resourcesRaw","resourceRaw","extractSelection","DragAndDropContributionRegistry","toVSDataTransfer","dataTransfer","vsDataTransfer","asStringValue","createFileDataTransferItemFromFile","INTERNAL_DND_MIME_TYPES","addExternalEditorsDropData","dragEvent","overwriteUriList","Mimes","editorData","input","UriList","internal","entries","distinct","normalizeDriveLetter","path","isWindowsOS","hasDriveLetter","CompositeSnippetVariableResolver","_delegates","SelectionBasedVariableResolver","_selection","_selectionIdx","_overtypingCapturer","isMultiline","lineLeadingWhitespace","getLeadingWhitespace","varLeadingWhitespace","whitespaceCommonLength","commonPrefixLength","newline","rest","ModelBasedVariableResolver","path.basename","path.dirname","ClipboardBasedVariableResolver","_readClipboardText","_selectionCount","_spread","isFalsyOrWhitespace","CommentBasedVariableResolver","langId","TimeBasedVariableResolver","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","toWorkspaceIdentifier","isSingleFolderWorkspaceIdentifier","filename","WORKSPACE_EXTENSION","folderpath","RandomBasedVariableResolver","OneSnippet","_snippet","_snippetLineLeadingWhitespace","groupBy","textChange","placeholderOffset","placeholderLen","operations","currentValue","transformedValueLines","EditOperation","couldSkipThisPlaceholder","activePlaceholders","enclosingPlaceholder","placeholdersWithEqualIndex","ranges","nested","indexLastPlaceholder","nestedPlaceholder","_defaultOptions","SnippetSession","_template","adjustIndentation","adjustNewlines","snippetTextString","newValue","overwriteBefore","overwriteAfter","positionLineNumber","positionColumn","positionColumnBefore","positionColumnAfter","adjustWhitespace","overtypingCapturer","edits","snippets","workspaceService","IWorkspaceContextService","modelBasedVariableResolver","readClipboardText","firstBeforeText","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","extensionBefore","extensionAfter","snippetSelection","snippetLineLeadingWhitespace","snippetEdits","lastRange","textRange","textNode","snippetText","snippetFragmentText","_undoEdits","undoEdits","isTrivialSnippet","oneSelection","allPossibleSelections","possibleSelections","array","SnippetController2","_logService","activeChoice","isAnyOfOptions","suggestions","option","resetSelection","ILogService","CommandCtor","ctrl","performSnippetEdit","vscodeClipboardMime","CopyPasteController","_bulkEditService","_clipboardService","primarySelection","wasFromEmptySelection","rawMetadata","originalDocVersion","tokenSource","textDataTransfer","BlockCommentCommand","insertSpace","haystack","needle","needleLength","haystackLength","codeA","codeB","startToken","endToken","startLineText","endLineText","startTokenIndex","endTokenIndex","startLineAfterStartToken","endLineBeforeEndToken","ops","op","inverseEditOperations","startTokenEditOperation","endTokenEditOperation","srcRange","deltaColumn","LineCommentCommand","ignoreEmptyLines","ignoreFirstLine","commentStr","onlyWhitespaceLines","shouldRemoveComments","lineData","lineContentStartOffset","strings.firstNonWhitespaceIndex","commentStrEndOffset","cursorPosition","startTokenAllowedBeforeColumn","firstNonWhitespaceIndex","afterCommentStr","currentVisibleColumn","isTab","columnSize","minVisibleColumn","lenJ","CommentLineAction","modelOptions","commentsOptions","ToggleCommentLineAction","AddLineCommentAction","RemoveLineCommentAction","BlockCommentAction","ContextMenuController","view","dom.getShadowRoot","hasSelectionAtPosition","menuId","addedItems","subActions","oldHoverSetting","posx","posy","isIOS","customActionViewItem","wasCancelled","minimapOptions","lastId","createAction","createSubmenuAction","createEnumAction","configName","configuredValue","createRunner","ShowContextMenu","CursorState","thisLen","otherLen","StackElement","cursorState","scrollTop","scrollLeft","CursorUndoRedoController","prevState","stackElement","CursorUndo","CursorRedo","DragAndDropCommand","targetPosition","copy","hasTriggerModifier","isMacintosh","DragAndDropController","selectionStartLineNumber","selectionStartColumn","DropIntoEditorController","workspaceContextService","DefaultOnDropProvider","initialModelVersion","ourDataTransfer","textEditorDataTransfer","IProgressService","_workspaceContextService","urlListEntry","urlList","textEntry","strUriList","root","rel","relativePath","FindDecorations","scopes","findScopeDecorationId","newStartPosition","desiredRange","candidateOpts","nextMatch","newCurrentDecorationId","matchPosition","lineBeforeEnd","lineBeforeEndMaxColumn","findMatches","findScopes","findMatchesOptions","newOverviewRulerApproximateDecorations","approxPixelsPerLine","mergeLinesDelta","prevStartLineNumber","prevEndLineNumber","newFindMatchesDecorations","findScope","overviewRulerFindMatchForeground","minimapFindMatch","MinimapPosition","ReplaceAllCommand","editorSelection","replaceStrings","o1","o2","resultOps","previousOp","buildReplaceStringWithCasePreserved","containsHyphens","validateSpecificSpecialCharacter","containsUnderscores","buildReplaceStringForSpecificSpecialCharacter","strings.containsUppercaseCharacter","specialCharacter","splitPatternAtSpecialCharacter","splitMatchAtSpecialCharacter","replaceString","splitValue","StaticValueReplacePattern","staticValue","DynamicPiecesReplacePattern","pieces","ReplacePattern","ReplacePiece","preserveCase","piece","repl","lenOps","opIdx","matchIndex","remainder","caseOps","ReplacePieceBuilder","toCharIndex","parseReplaceString","chCode","nextChCode","nextNextChCode","CONTEXT_FIND_WIDGET_VISIBLE","CONTEXT_FIND_INPUT_FOCUSED","CONTEXT_REPLACE_INPUT_FOCUSED","ToggleCaseSensitiveKeybinding","ToggleWholeWordKeybinding","ToggleRegexKeybinding","ToggleSearchScopeKeybinding","TogglePreserveCaseKeybinding","FIND_IDS","MATCHES_LIMIT","RESEARCH_DELAY","FindModelBoundToEditorModel","moveCursor","newFindScope","currentMatchesPosition","matchAfterSelection","findFirstInSorted","matchesPosition","isUsingLineStops","isRecursed","nextMatchRange","prevMatchRange","searchRange","prevMatch","captureMatches","forceMove","replacePattern","limitResultCount","searchRanges","scope","searchData","SearchParams","searchRegex","mod","modelText","fullModelRange","resultText","ReplaceCommandThatPreservesSelection","FindOptionsWidget","inputActiveOptionBorderColor","inputActiveOptionBorder","inputActiveOptionForegroundColor","inputActiveOptionForeground","inputActiveOptionBackgroundColor","inputActiveOptionBackground","CaseSensitiveToggle","WholeWordsToggle","RegexToggle","somethingChanged","actionId","inputStyles","widgetBackground","editorWidgetBackground","widgetForeground","editorWidgetForeground","widgetShadowColor","widgetShadow","hcBorder","effectiveOptionValue","override","FindReplaceState","matchesCount","currentMatch","changeEvent","updateHistory","oldEffectiveIsRegex","oldEffectiveWholeWords","oldEffectiveMatchCase","oldEffectivePreserveCase","newSearchScope","existingSearchScope","showHistoryKeybindingHint","findSelectionIcon","findCollapsedIcon","findExpandedIcon","findReplaceIcon","findReplaceAllIcon","findPreviousMatchIcon","findNextMatchIcon","NLS_FIND_INPUT_LABEL","NLS_FIND_INPUT_PLACEHOLDER","NLS_PREVIOUS_MATCH_BTN_LABEL","NLS_NEXT_MATCH_BTN_LABEL","NLS_TOGGLE_SELECTION_FIND_TITLE","NLS_CLOSE_BTN_LABEL","NLS_REPLACE_INPUT_LABEL","NLS_REPLACE_INPUT_PLACEHOLDER","NLS_REPLACE_BTN_LABEL","NLS_REPLACE_ALL_BTN_LABEL","NLS_TOGGLE_REPLACE_MODE_BTN_LABEL","NLS_MATCHES_COUNT_LIMIT_TITLE","NLS_MATCHES_LOCATION","NLS_NO_RESULTS","FIND_WIDGET_INITIAL_WIDTH","PART_WIDTH","FIND_INPUT_AREA_WIDTH","MAX_MATCHES_COUNT_WIDTH","FIND_INPUT_AREA_HEIGHT","ctrlEnterReplaceAllWarningPromptedKey","ctrlKeyMod","FindWidgetViewZone","stopPropagationForMultiLineUpwards","textarea","stopPropagationForMultiLineDownwards","FindWidget","codeEditor","Delayer","addExtraSpaceOnTop","globalBufferTerm","dom.getTotalWidth","showRedOutline","strings.format","alertFn","searchString","isSelection","isChecked","findInputIsNonEmpty","canReplace","isSelectionMultipleLine","adjustEditorScrollTop","startCoords","startLeft","startTop","leftOfFindWidget","dom.getTopLeftOffset","endCoords","focusTheEditor","targetScrollTop","viewZone","adjustScroll","newHeight","scrollAdjustment","inputBackground","inputForeground","inputBorder","inputValidationInfoBackground","inputValidationInfoForeground","inputValidationInfoBorder","inputValidationWarningBackground","inputValidationWarningForeground","inputValidationWarningBorder","inputValidationErrorBackground","inputValidationErrorForeground","inputValidationErrorBorder","dom.isInDOM","editorWidth","minimapWidth","collapsedFindWidget","reducedFindWidget","narrowFindWidget","findInputWidth","totalheight","totalHeight","platform.isWindows","_sash","platform.isLinux","SimpleButton","findPart","widgetClose","replacePart","replaceActionsContainer","originalWidth","dom.getComputedStyle","currentWidth","expanded","addBackgroundColorRule","selector","editorFindMatchHighlight","editorFindMatch","editorFindRangeHighlight","findMatchHighlightBorder","editorFindMatchHighlightBorder","isHighContrast","findMatchBorder","editorFindMatchBorder","findRangeHighlightBorder","editorFindRangeHighlightBorder","foreground","errorForeground","resizeBorderBackground","editorWidgetResizeBorder","border","editorWidgetBorder","toolbarHoverBackgroundColor","toolbarHoverBackground","focusOutline","focusBorder","SEARCH_STRING_MAX_LENGTH","getSelectionSearchString","seedSearchStringFromSelection","seedSearchStringFromNonEmptySelection","wordAtPosition","CommonFindController","shouldRestartFind","strings.escapeRegExpCharacters","ignoreWhenVisible","stateChanges","selectionSearchString","currentSelections","FindController","_super","updateSearchScope","StartFindAction","registerMultiEditorAction","MultiEditorAction","findArgDescription","StartFindWithArgsAction","StartFindWithSelectionAction","MatchFindAction","NextMatchFindAction","PreviousMatchFindAction","SelectionMatchFindAction","NextSelectionMatchFindAction","PreviousSelectionMatchFindAction","StartFindReplaceAction","currentSelection","findInputFocused","shouldFocus","FindCommand","MAX_FOLDING_REGIONS","MAX_LINE_NUMBER","MASK_INDENT","BitField","size","numWords","arrayIndex","bit","FoldingRegions","startIndexes","endIndexes","types","parentIndexes","isInsideLast","parentIndex","hasChanged","FoldingRegion","low","high","mid","rangesLength","gotTypes","regions","rangesA","rangesB","getIndexedFunction","limit","getA","getB","indexA","indexB","nextA","nextB","stackedRanges","topStackedRange","prevLineNumber","resultRanges","useRange","scanIndex","prescanB","FoldingModel","textModel","decorationProvider","toggledRegions","r1","r2","processed","dirtyRegionEndLine","lastHiddenLine","updateDecorationsUntil","isCollapsed","isManual","region","editorDecorationId","newCollapseState","newFoldingRanges","intersects","foldRange","newRegions","blockedLineNumers","foldedOrManualRanges","newRanges","newEditorDecorations","decorationRange","isBlocked","blockedLineNumber","foldedRanges","decRange","checksum","rangesToRestore","lineNumber1","lineNumber2","levelStack","toggleCollapseState","foldingModel","levels","lineNumbers","toToggle","doCollapse","regionsInside","setCollapseStateLevelsDown","setCollapseStateLevelsUp","setCollapseStateUp","setCollapseStateAtLevel","foldLevel","blockedLineNumbers","setCollapseStateForRest","filteredRegions","filteredRegion","setCollapseStateForMatchingLines","regExp","setCollapseStateForType","getParentFoldLine","foldingRegion","parentFoldingIdx","getPreviousFoldLine","expectedParentIndex","minLineNumber","getNextFoldLine","HiddenRangeModel","change","countEOL","updateHiddenAreas","newHiddenAreas","lastCollapsedStart","lastCollapsedEnd","findRange","hasChanges","adjustLine","isInside","adjustedStartLine","adjustedEndLine","MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT","ID_INDENT_PROVIDER","IndentRangeProvider","maxFoldingRegions","cancelationToken","notifyTooManyRegions","foldingRules","offSide","markers","computeRanges","RangesCollector$1","foldingRangesLimit","_notifyTooManyRegions","maxIndent","RangesCollector","previousRegions","previous","foldingExpandedIcon","foldingCollapsedIcon","foldingManualCollapsedIcon","foldingManualExpandedIcon","FoldingDecorationProvider","isHidden","decorationIds","foldingContext","ID_SYNTAX_PROVIDER","SyntaxRangeProvider","handleFoldingRangesChange","collectSyntaxRanges","sanitizeRanges","rangeData","nLines","nestingLevel","maxLevel","sorted","d1","d2","diff","CONTEXT_FOLDING_ENABLED","FoldingController","collapsedRegions","hr","foldingProviders","foldingRegionPromise","foldingRanges","FoldingRangeKind","selectionLineNumbers","hiddenRanges","iconClicked","offsetLeftInGutter","surrounding","otherRegion","toMaybeToggle","recursive","FoldingAction","foldingController","foldingModelPromise","foldingArgumentsConstraint","types.isUndefined","types.isObject","foldingArgs","types.isNumber","types.isString","types.isArray","UnfoldAction","_foldingController","UnFoldRecursivelyAction","_args","FoldAction","direction","ToggleFoldAction","selectedLines","FoldRecursivelyAction","FoldAllBlockCommentsAction","comments","FoldAllRegionsAction","UnfoldAllRegionsAction","FoldAllRegionsExceptAction","UnfoldAllRegionsExceptAction","FoldAllAction","UnfoldAllAction","FoldLevelAction","GotoParentFoldAction","GotoPreviousFoldAction","GotoNextFoldAction","FoldRangeFromSelectionAction","collapseRanges","RemoveFoldRangeFromSelectionAction","foldBackgroundBackground","editorSelectionBackground","editorFoldForeground","iconForeground","foldBackground","editorFoldColor","EditorFontZoomIn","EditorZoom","EditorFontZoomOut","EditorFontZoomReset","FormatOnType","_workerService","support","triggerChars","CharacterSet","lastCharCode","CancellationTokenSource","unbind","getOnTypeFormattingEdits","FormattingEdit","alertFormattingEdits","IEditorWorkerService","FormatOnPaste","formatDocumentRangesWithSelectedProvider","FormatDocumentAction","formatDocumentWithSelectedProvider","FormatSelectionAction","TreeElement","candidateId","OutlineElement","OutlineGroup","order","OutlineModel","newProvider","childInfo","Iterable","roots","overrideContainerLabel","IOutlineModelService","OutlineModelService","debounces","modelService","now","outlineModel","_err","outlineService","inlineSuggestCommitId","createDisposableRef","object","applyEdits","transformer","PositionOffsetTransformer","offsetEdits","getReadonlyEmptyArray","GhostText","additionalReservedLineCount","lineText","lastPart","cappedLineText","GhostTextPart","GhostTextReplacement","columnStart","length","newLines","_lineText","BaseGhostTextWidgetModel","minimizeInlineCompletion","inlineCompletion","valueToReplace","commonPrefixLen","startOffset","remainingValueToReplace","commonSuffixLen","strings.commonSuffixLength","normalizedInlineCompletionsEquals","inlineCompletionToGhostText","previewSuffixLength","sourceLine","sourceIndentationLength","strings.getLeadingWhitespace","suggestionAddedIndentationLength","replacedIndentation","rangeThatDoesNotReplaceIndentation","suggestionWithoutIndentationChange","valueToBeReplaced","changes","cachingDiff","filteredChanges","previewStartInCompletionText","insertColumn","modifiedEnd","nonPreviewTextEnd","nonPreviewText","italicText","strings.splitLines","lastRequest","originalValue","smartDiff","deletedChars","deletedCharacters","newChanges","sum","smartBracketMatching","getMaxCharCode","maxCharCode","charCode","getUniqueCharCode","getElements","characters","elements1","elements2","LcsDiff","fixBracketsInLine","denseKeyProvider","DenseKeyProvider","bracketTokens","LanguageAgnosticBracketTokens","TextBufferTokenizer","StaticTokenizerSource","parseDocument","processNode","lengthAdd","closingTokenText","lengthGetColumnCountIfZeroLineCount","lengthZero","InlineCompletionsModel","cache","configurationService","CoreEditingCommands","active","InlineCompletionTriggerKind","triggerKind","InlineCompletionsSession","shouldUpdate","initialTriggerKind","debounce","lastCompletionItem","currentCompletion","filterText","cursorPosIndex","filterTextBefore","filterTextAfter","originalValueBefore","originalValueAfter","matchesSubString","newIdx","ghostText","startTime","provideInlineCompletions","endTime","operation","UpdateOperation","SynchronizedInlineCompletionsCache","completionsSource","onChange","CachedInlineCompletion","getDefaultRange","itemsByHash","insertText","snippetInfo","closeBrackets","assertNever","trackedItem","newLine","newTokens","slicedTokens","Memory","topScore","NoMemory","LRUMemory","lineSuffix","indexPreselect","indexRecency","seq","CompletionItemKinds","PrefixMemory","TernarySearchTree","SuggestMemoryService","ISuggestMemoryService","WordContextKey","checkForWordEnd","SuggestAlternatives","acceptNext","CommitCharacterController","selected","acceptCharacters","BracketSelectionRangeProvider","round","counts","bracket","closing","innerBracket","outerBracket","startLine","aboveLine","WordDistance","service","wordRanges","wordUntilPos","wordLines","isFalsyOrEmpty","bestWordRange","blockDistance","LineContext$1","leadingLineContent","characterCountDelta","CompletionModel","lineContext","wordDistance","snippetSuggestions","fuzzyScoreOptions","FuzzyScoreOptions","incomplete","except","labelLengths","wordLow","scoreFn","fuzzyScore","fuzzyScoreGracefulAggressive","wordLen","wordPos","compareIgnoreCase","anyScore","quickSelect","LineContext","auto","shy","noSelect","canShowQuickSuggest","allowQuickSuggestions","canShowSuggestOnTriggerCharacters","SuggestModel","_editorWorkerService","editorIsComposing","supportsByTriggerCharacter","set","checkTriggerCharacter","lastChar","isLowSurrogate","isHighSurrogate","supports","prevSelection","lineTokens","onlyFrom","noFilter","suggestCtx","itemKindFilter","completionOptions","cmpFn","suggestOptions","inactiveProvider","oldLineContext","isFrozen","OvertypingCapturer","suggestModel","selectionsLength","willOvertype","StatusBarViewItem","SuggestWidgetStatus","actionViewItemProvider","right","SYMBOL_ICON_ARRAY_FOREGROUND","SYMBOL_ICON_BOOLEAN_FOREGROUND","SYMBOL_ICON_CLASS_FOREGROUND","SYMBOL_ICON_COLOR_FOREGROUND","SYMBOL_ICON_CONSTANT_FOREGROUND","SYMBOL_ICON_CONSTRUCTOR_FOREGROUND","SYMBOL_ICON_ENUMERATOR_FOREGROUND","SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND","SYMBOL_ICON_EVENT_FOREGROUND","SYMBOL_ICON_FIELD_FOREGROUND","SYMBOL_ICON_FILE_FOREGROUND","SYMBOL_ICON_FOLDER_FOREGROUND","SYMBOL_ICON_FUNCTION_FOREGROUND","SYMBOL_ICON_INTERFACE_FOREGROUND","SYMBOL_ICON_KEY_FOREGROUND","SYMBOL_ICON_KEYWORD_FOREGROUND","SYMBOL_ICON_METHOD_FOREGROUND","SYMBOL_ICON_MODULE_FOREGROUND","SYMBOL_ICON_NAMESPACE_FOREGROUND","SYMBOL_ICON_NULL_FOREGROUND","SYMBOL_ICON_NUMBER_FOREGROUND","SYMBOL_ICON_OBJECT_FOREGROUND","SYMBOL_ICON_OPERATOR_FOREGROUND","SYMBOL_ICON_PACKAGE_FOREGROUND","SYMBOL_ICON_PROPERTY_FOREGROUND","SYMBOL_ICON_REFERENCE_FOREGROUND","SYMBOL_ICON_SNIPPET_FOREGROUND","SYMBOL_ICON_STRING_FOREGROUND","SYMBOL_ICON_STRUCT_FOREGROUND","SYMBOL_ICON_TEXT_FOREGROUND","SYMBOL_ICON_TYPEPARAMETER_FOREGROUND","SYMBOL_ICON_UNIT_FOREGROUND","SYMBOL_ICON_VARIABLE_FOREGROUND","symbolIconArrayColor","symbolIconBooleanColor","symbolIconClassColor","symbolIconMethodColor","symbolIconColorColor","symbolIconConstantColor","symbolIconConstructorColor","symbolIconEnumeratorColor","symbolIconEnumeratorMemberColor","symbolIconEventColor","symbolIconFieldColor","symbolIconFileColor","symbolIconFolderColor","symbolIconFunctionColor","symbolIconInterfaceColor","symbolIconKeyColor","symbolIconKeywordColor","symbolIconModuleColor","outlineNamespaceColor","symbolIconNullColor","symbolIconNumberColor","symbolIconObjectColor","symbolIconOperatorColor","symbolIconPackageColor","symbolIconPropertyColor","symbolIconReferenceColor","symbolIconSnippetColor","symbolIconStringColor","symbolIconStructColor","symbolIconTextColor","symbolIconTypeParameterColor","symbolIconUnitColor","symbolIconVariableColor","ResizableHTMLElement","Dimension","OrthogonalEdge","currentSize","deltaY","deltaX","north","east","south","west","minHeight","minWidth","maxHeight","newSize","canExpandCompletionItem","SuggestDetailsWidget","fontWeight","fontSizePx","lineHeightPx","borderWidth","borderHeight","explainMode","md","cappedDetail","dom.size","much","SuggestDetailsOverlay","topLeftNow","sizeNow","deltaTop","deltaLeft","updateTopLeft","sessionEnded","preferAlignAtTop","anchorBox","bodyBox","dom.getClientArea","defaultMinSize","defaultTop","eastPlacement","maxSizeTop","maxSizeBottom","westPlacement","southPacement","placements","placement","bottom","alignAtTop","maxSize","topLeft","FileKind","fileIconDirectoryRegex","getIconClasses","fileKind","classes","DataUri","cssEscape","dotSegments","detectedLanguageId","detectLanguageId","getAriaId","suggestMoreInfoIcon","_completionItemColor","ColorExtractor","ItemRenderer","_modelService","main","configureFont","fontFeatureSettings","letterSpacing","letterSpacingPx","labelOptions","labelClasses","detailClasses","CSSIcon","stripNewLines","show","hide","editorSuggestWidgetForeground","quickInputListFocusForeground","quickInputListFocusIconForeground","editorSuggestWidgetSelectedBackground","quickInputListFocusBackground","listHighlightForeground","listFocusHighlightForeground","PersistedWidgetSize","_service","SuggestWidget","SuggestContentWidget","ResizeState","persistedSize","persistHeight","persistWidth","itemHeight","defaultSize","threshold","details","applyIconStyle","_element","description","docs","applyStatusBarStyle","attachListStyler","completionModel","loading","delay","selectionIndex","isAuto","visibleCount","isEmpty","dim","minPersistedHeight","preferredWidth","fullHeight","editorBox","cursorBox","cursorBottom","maxHeightBelow","availableSpaceAbove","maxHeightAbove","forceRenderingAboveRequiredSpace","statusBarHeight","clamp","_widget","horizontalPadding","preference","LineSuffix","SuggestController","_memoryService","PriorityRegistry","ctxInsertMode","IdleValue","commitCharacterController","ctxMakesTextEdit","ctxHasInsertAndReplace","ctxCanResolve","SimpleKeybinding","acceptSuggestionsOnEnter","updateFromConfig","acceptSuggestionOnEnter","snippetController","modelVersionNow","tasks","docListener","thisPosition","oldFlags","didType","typeListener","applied","TriggerSuggestAction","acceptedSuggestion","providerId","extname","toggleMode","replace","columnDelta","suffixDelta","positionNow","fallback","makesTextEdit","keepAlternativeSuggestions","alternativeOverwriteConfig","prioritySelector","s1","s2","SuggestCommand","isObject","SuggestWidgetInlineCompletionProvider","suggestControllerPreselector","suggestController","suggestItems","normalizedItemToPreselect","suggestItem","inlineSuggestItem","suggestionToSuggestItemInfo","normalizedSuggestItem","valid","rangeStartsWith","findMaxBy","compareBy","numberComparator","isBoundToSuggestWidget","bindToSuggestWidget","newActive","newInlineCompletion","shouldFire","suggestItemInfoEquals","focusedItem","rangeToTest","prefix","isSnippetText","SuggestWidgetPreviewModel","newGhostText","isSuggestionPreviewEnabled","augmentedCompletion","suggestWidgetState","suggestInlineCompletion","isAugmentedCompletionValid","finalCompletion","inlineCompletionPreviewLength","DelegatingModel","GhostTextModel","SharedInlineCompletionCache","hoverRange","ttPolicy","GhostTextWidget","DecorationsWidget","AdditionalLinesWidget","DisposableDecorations","viewZoneId","inlineTexts","additionalLines","addToAdditionalLines","lastLine","LineDecoration","textBufferLine","hiddenTextStartColumn","lastIdx","firstLineText","remainingLinesLength","spacer","button","ViewMoreLinesContentWidget","hiddenText","hiddenTextDecorations","InjectedTextCursorStops","languageIdCodec","minReservedLineCount","renderLines","disableMonospaceOptimizations","stopRenderingLineAfter","renderWhitespace","renderControlCharacters","fontLigatures","sb","createStringBuilder","isBasicASCII","strings.isBasicASCII","containsRTL","strings.containsRTL","LineTokens","renderViewLine","RenderLineInput","EditorFontLigatures","trustedhtml","ghostTextForeground","background","ghostTextBackground","ghostTextBorder","GhostTextController","inlineSuggestOptions","ActiveGhostTextController","GhostTextContextKeys","startsWithIndentation","startsWithIndentationLessThanTabSize","firstLine","indentationEndColumn","firstNonWsIdx","CursorColumns","ShowNextInlineSuggestionAction","ShowPreviousInlineSuggestionAction","TriggerInlineSuggestionAction","InlineCompletionsHover","InlineCompletionsHoverParticipant","viewZoneData","previousAction","nextAction","hasMore","render","inlineSuggestionAvailable","GhostTextCommand","commitInlineSuggestionAction","getSpaceCnt","spacesCnt","generateIndent","insertSpaces","tabsCnt","getReindentEditOperations","inheritedIndent","indentationRules","indentSize","shiftIndent","indentation","ShiftCommand","unshiftIndent","indentEdits","globalIndent","currentLineText","adjustedLineContent","oldIndentation","normalizeIndentation","idealIndentForNextLine","IndentationToSpacesAction","modelOpts","IndentationToSpacesCommand","IndentationToTabsAction","IndentationToTabsCommand","ChangeIndentationSizeAction","creationOpts","picks","autoFocusIndex","pick","IndentUsingTabs","IndentUsingSpaces","DetectIndentation","ReindentLinesAction","ReindentSelectedLinesAction","editOperations","AutoIndentOnPasteCommand","initialSelection","selectionIsSet","AutoIndentOnPaste","autoIndent","indentConverter","indentOfFirstLine","getGoodIndentForLine","newSpaceCnt","indentUtils.getSpaceCnt","oldSpaceCnt","newIndent","indentUtils.generateIndent","indentMetadata","getIndentMetadata","firstLineNumber","indentOfSecondLine","newSpaceCntOfSecondLine","oldSpaceCntOfSecondLine","spaceCntOffset","originalIndent","newSpacesCnt","cmd","nonWhitespaceColumn","firstNonWhitespaceTokenIndex","getIndentationEditOperations","tabsToSpaces","spaces","spacesRegExp","lastIndentationColumn","originalIndentationRange","originalIndentation","newIndentation","InlayHintAnchor","InlayHintItem","hint","delta","newHint","InlayHintsFragments","asCommandLink","showGoToContextMenu","resolverService","contextMenuService","location","isIMenuItem","EditorExtensionsRegistry","box","goToDefinitionWithLocation","isInPeek","InlayHintsCache","IInlayHintsCache","RenderedInlayHintLabelPart","ActiveInlayHintInfo","InlayHintsController","_featureDebounce","_inlayHintsCache","cached","watchedProviders","myToken","inlayHints","defaultMode","altMode","newRenderMode","copies","store","gesture","sessionStore","labelPart","lineHints","languages.Command","updateInlayHints","ModelDecorationInjectedTextOptions","hints","visibleRanges","extendedRange","newDecorationsData","addInjectedText","cursorStops","attachedData","addInjectedWhitespace","isLast","marginRule","padding","isUniform","isFirst","cssProperties","colors.editorActiveLinkForeground","fixSpace","decorationIdsToReplace","newDecorationIds","languages.InlayHintKind","colors.editorInlayHintParameterBackground","colors.editorInlayHintParameterForeground","colors.editorInlayHintTypeBackground","colors.editorInlayHintTypeForeground","colors.editorInlayHintBackground","colors.editorInlayHintForeground","editorFontSize","editorFontFamily","inlayHintsProvider","InlayHintsHoverAnchor","InlayHintsHover","_lineDecorations","executor","itemTooltip","partTooltip","linkHint","iterable","iterable_1","iterable_1_1","InPlaceReplaceCommand","editRange","originalSelection","InPlaceReplaceController","editorWorkerService","up","modelURI","timeout","InPlaceReplaceUp","InPlaceReplaceDown","ExpandLineSelectionAction","viewModel","CursorMoveCommands","TrimTrailingWhitespaceCommand","cursors","trimTrailingWhitespace","rLen","cursorIndex","cursorLen","maxLineColumn","minEditColumn","lastNonWhitespaceIndex","strings.lastNonWhitespaceIndex","fromColumn","CopyLinesCommand","isCopyingDown","noop","sourceLines","sourceText","MoveLinesCommand","isMovingDown","modelLineCount","virtualModel","otherLineNumber","movingLineNumber","movingLineText","insertingText","movingLineMatchResult","indentOfMovingLine","newIndentatOfMovingBlock","oldIndent","enter","enterPrefix","IndentAction","indentMetadataOfMovelingLine","futureAboveLineNumber","futureAboveLineText","getEnterAction","validPrecedingLine","oneLineAbove","previousLineText","languageAtSelectionStart","languageAtSelectionEnd","SortLinesCommand","descending","sortLines","getSortData","linesToSort","AbstractCopyLinesAction","down","CopyLinesUpAction","CopyLinesDownAction","DuplicateSelectionAction","insertSelection","ReplaceCommandThatSelectsText","AbstractMoveLinesAction","MoveLinesUpAction","MoveLinesDownAction","AbstractSortLinesAction","SortLinesAscendingAction","SortLinesDescendingAction","DeleteDuplicateLinesAction","endCursorState","linesDeleted","uniqueLines","selectionToReplace","adjustedSelectionStart","finalSelection","TrimTrailingWhitespaceAction","DeleteLinesAction","mergedOperations","previousOperation","IndentLinesAction","TypeOperations","OutdentLinesAction","InsertLineBeforeAction","InsertLineAfterAction","AbstractDeleteAllToBoundaryAction","primaryCursor","rangesToDelete","effectiveRanges","nextRange","DeleteAllLeftAction","endPrimaryCursor","deletedLines","endCursor","newStartLine","deleteFromLine","deleteFromColumn","DeleteAllRightAction","JoinLinesAction","reducedSelections","lastSelection","previousValue","lineOffset","columnDeltaOffset","selectionEndPositionOffset","trimmedLinesContent","firstNonWhitespaceIdx","lineTextWithoutIndent","deleteSelection","resultSelection","TransposeAction","cursor","AbstractCaseAction","wordSeparators","UpperCaseAction","LowerCaseAction","BackwardsCompatibleRegExp","_pattern","_flags","TitleCaseAction","titleBoundary","SnakeCaseAction","caseBoundary","singleLetters","KebabCaseAction","regexp","underscoreBoundary","CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE","DECORATION_CLASS_NAME","LinkedEditingContribution","forceRefresh","rangeUpdateScheduler","triggerRangeUpdate","rangeSyncScheduler","triggerRangeSync","referenceRange","referenceValue","mirrorRange","oldValue","rangeStartColumn","rangeEndColumn","commonSuffixLength","prevEditOperationType","force","modelVersionId","response","getLinkedEditingRanges","foundReferenceRange","LinkedEditingAction","LinkedEditingCommand","orderedByScore","first","arrays.isNonEmptyArray","editorLinkedEditingBackground","editorLinkedEditingBackgroundColor","linkedEditingRangeProvider","Link$1","LinksList","newLinks","Link","oldLinks","oldIndex","oldLen","oldLink","newLink","getLinks","lists","linkProvider","LinkDetector","clickLinkGesture","useMetaKey","oldDecorations","keys","occurence","LinkOccurrence","occurrence","fromUserGesture","modelUri","parsedUri","fsPath","resources.originalFSPath","resources.joinPath","messageOrError","currentOccurrence","isActive","getHoverMessage","executeCmd","nativeLabel","commandId","OpenLinkAction","linkDetector","announceCursorChange","previousCursorState","cursorDiff","cs","pcs","cursorPositions","status","InsertCursorAbove","useLogicalLine","InsertCursorBelow","InsertCursorAtEndOfEachLineSelected","currentLineMaxColumn","InsertCursorAtEndOfLineSelected","InsertCursorAtTopOfLineSelected","MultiCursorSessionResult","revealRange","revealScrollType","MultiCursorSession","findController","isDisconnectedFromFindController","searchText","wholeWord","matchCase","findState","allSelections","lastAddedSelection","previousMatch","searchScope","MultiCursorSelectionController","session","modelRangesContainSameText","resultingSelections","MultiCursorSelectionControllerAction","multiCursorController","AddSelectionToNextFindMatchAction","AddSelectionToPreviousFindMatchAction","MoveSelectionToNextFindMatchAction","MoveSelectionToPreviousFindMatchAction","SelectHighlightsAction","CompatChangeAll","SelectionHighlighterState","_searchText","_matchCase","_wordSeparators","SelectionHighlighter","oldState","caseSensitive","findStateSearchString","mySearchString","allMatches","cmp","hasFindOccurrences","minimapSelectionOccurrenceHighlight","overviewRulerSelectionHighlightForeground","selectedText","getValueInRange","thisSelectedText","toLowerCase","FocusNextCursor","firstCursor","FocusPreviousCursor","provideSignatureHelp","languages.SignatureHelpTriggerKind","ParameterHintState","Pending","previouslyActiveHints","Active","ParameterHintsModel","silent","triggerId","activeSignature","cycle","isRetrigger","activeSignatureHelp","mergeTriggerContexts","triggerContext","lastCharIndex","triggerCharCode","parameterHintsNextIcon","parameterHintsPreviousIcon","ParameterHintsWidget","newParameterHints","wrapper","overloads","scrollbar","signature","updateFont","hasParameters","activeParameterIndex","activeParameter","hasDocs","labelToAnnounce","param","aria.alert","assertIsDefined","beforeSpan","paramSpan","afterSpan","paramIdx","editorHoverWidgetHighlightForeground","parameterHighlightColor","ParameterHintsController","TriggerParameterHintsAction","ParameterHintsCommand","CONTEXT_RENAME_INPUT_VISIBLE","RenameInputField","_acceptKeybindings","updateLabel","wantsPreview","selectionStart","selectionEnd","supportPreview","disposeOnDone","RenameSkeleton","rejects","newName","rename","skeleton","loc","RenameController","resolveLocationOperation","inputFieldResult","renameOperation","renameResult","ITextResourceConfigurationService","RenameAction","RenameCommand","renameProvider","StickyScrollController","StickyScrollWidget","stickyLineNumbers","stickyLineNumber","updateOutline","hiddenRange","outlineElement","depth","didRecursion","outline","currentStartLine","currentEndLine","_depth","beginningLinesConsidered","topOfElementAtDepth","bottomOfElementAtDepth","bottomOfBeginningLine","topOfEndLine","bottomOfEndLine","StickyScrollCodeLine","_ttPolicy","_lineNumber","_zIndex","_relativePosition","viewLineNumber","lineRenderingData","actualInlineDecorations","renderLineInput","lineHTMLNode","lineNumberHTMLNode","innerLineNumberHTML","widgetLineRange","codeLine","widgetHeight","WordSelectionRangeProvider","lastCh","isLowerAsciiLetter","isUpperAsciiLetter","SelectionRanges","SmartSelectController","forward","provideSelectionRanges","arrays.equals","AbstractSmartSelect","GrowSelectionAction","ShrinkSelectionAction","work","allRawRanges","allProviderRanges","oneProviderRanges","oneRawRanges","oneRanges","oneRangesWithTrivia","rangeNoWhitespace","rangeFull","SuggestInlineCompletion","additionalTextEdits","InlineCompletionResults","RefCountedDisposable","_suggestMemoryService","selectedIndex","second","CompletionItemInsertTextRule","SuggestInlineCompletions","_getEditorOption","_languageFeatureService","wordInfo","triggerCharacterInfo","leadingLineContents","newLineContext","_completions","EditorContribution","languageFeatureService","ForceRetokenizeAction","ToggleTabFocusModeAction","TabFocus","_link","onClickEmitter","onKeyPress","onEnterPress","onTap","TouchEventType","onOpen","textLinkForegroundColor","textLinkActiveForegroundColor","BANNER_ELEMENT_HEIGHT","BannerController","Banner","clearNode","iconContainer","messageContainer","actionBarContainer","warningIcon","UnicodeHighlighter","_workspaceTrustService","max","DisableHighlightingOfNonBasicAsciiCharactersAction","DisableHighlightingOfAmbiguousCharactersAction","DisableHighlightingOfInvisibleCharactersAction","resolveOptions","highlightOptions","locale","platform.language","DocumentUnicodeHighlighter","ViewportUnicodeHighlighter","IWorkspaceTrustManagementService","trusted","inUntrustedWorkspace","_updateState","Decorations","isModelDecorationVisible","computeReason","isModelDecorationInComment","isModelDecorationInString","totalResult","UnicodeTextModelHighlighter","UnicodeHighlighterHoverParticipant","unicodeHighlighter","highlightInfo","codePoint","codePointStr","formatCodePointMarkdown","reason","adjustSettingsArgs","adjustSettings","ShowExcludeOptions","codePointToHex","InvisibleCharacters","renderCodePointAsInlineCode","char","hideInComments","hideInStrings","DisableHighlightingInCommentsAction","unicodeHighlightConfigKeys","DisableHighlightingInStringsAction","inString","inComment","quickPickService","getExcludeCharFromBeingHighlightedLabel","excludeLocaleFromBeingHighlighted","excludeCharFromBeingHighlighted","expectNever","charCodes","existingValue","locales","ignoreUnusualLineTerminators","writeIgnoreState","readIgnoreState","UnusualLineTerminatorsDetector","_dialogService","_codeEditorService","IDialogService","ViewportSemanticTokensContribution","scheduleTokenizeViewport","SEMANTIC_HIGHLIGHTING_SETTING_ID","req","isSemanticColoringEnabled","hasDocumentRangeSemanticTokensProvider","requestVersionId","getDocumentRangeSemanticTokens","styling","toMultilineTokens2","editorWordHighlight","editorWordHighlightStrong","editorWordHighlightBorder","editorWordHighlightStrongBorder","overviewRulerWordHighlightForeground","overviewRulerWordHighlightStrongForeground","ctxHasWordHighlights","getOccurrencesAtPosition","OccurenceAtPositionRequest","currentWordRange","requestIsValid","SemanticOccurenceAtPositionRequest","TextualOccurenceAtPositionRequest","DocumentHighlightKind","currentSelectionIsEmpty","computeOccurencesAtPosition","WordHighlighter","highlights","dest","workerRequestIsValid","myRequestId","currentTime","minimumRenderTime","WordHighlighterContribution","createWordHighlighterIfPossible","WordHighlightNavigationAction","NextWordHighlightAction","PrevWordHighlightAction","TriggerWordHighlightAction","selectionHighlight","editorSelectionHighlight","wordHighlight","wordHighlightStrong","selectionHighlightBorder","editorSelectionHighlightBorder","wordHighlightBorder","wordHighlightStrongBorder","MoveWordCommand","getMapForWordSeparators","inPosition","outPosition","from","to","inSelectionMode","WordLeftCommand","wordNavigationType","WordOperations","WordRightCommand","CursorWordStartLeft","CursorWordEndLeft","CursorWordLeft","CONTEXT_ACCESSIBILITY_MODE_ENABLED","IsWindowsContext","CursorWordStartLeftSelect","CursorWordEndLeftSelect","CursorWordLeftSelect","CursorWordAccessibilityLeft","EditorOptions","CursorWordAccessibilityLeftSelect","CursorWordStartRight","CursorWordEndRight","CursorWordRight","CursorWordStartRightSelect","CursorWordEndRightSelect","CursorWordRightSelect","CursorWordAccessibilityRight","CursorWordAccessibilityRightSelect","DeleteWordCommand","autoClosingBrackets","autoClosingQuotes","autoClosingPairs","deleteRange","DeleteWordLeftCommand","DeleteWordRightCommand","DeleteWordStartLeft","DeleteWordEndLeft","DeleteWordLeft","DeleteWordStartRight","DeleteWordEndRight","DeleteWordRight","DeleteInsideWord","DeleteWordPartLeft","WordPartOperations","DeleteWordPartRight","WordPartLeftCommand","CursorWordPartLeft","CursorWordPartLeftSelect","WordPartRightCommand","CursorWordPartRight","CursorWordPartRightSelect","ReadOnlyMessageController","messageController"],"mappings":"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"}