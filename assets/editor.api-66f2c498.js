import{K as Ea,C as rr,E as _,a as xa,P as Li,R as U,S as Ia,b as La,M as Da,c as Ta,U as ne,T as fi,D as I,m as hs,o as Ma,i as Aa,g as ee,d as fs,e as ar,t as Vs,f as Ra,l as Pa,L as Oa,h as Fa,s as gs,j as Ba,k as Na,n as Ka,p as lr,q as Va,r as Ua,u as Wa,I as X,v as cr,w as Di,x as Ut,y as P,z as ur,A as $a,B as ms,F as za,G as zi,H as le,J as G,N as ue,O as de,Q as W,V as dr,W as Ha,X as cn,Y as ps,Z as hr,_ as fr,$ as _s,a0 as bs,a1 as un,a2 as it,a3 as Fe,a4 as vt,a5 as oe,a6 as N,a7 as gr,a8 as D,a9 as H,aa as vs,ab as gi,ac as qa,ad as mr,ae as Ee,af as ja,ag as ht,ah as pr,ai as _r,aj as Ga,ak as E,al as j,am as Ya,an as Us,ao as Ue,ap as Ct,aq as dn,ar as Ws,as as Qa,at as br,au as Xa,av as te,aw as hn,ax as vr,ay as yr,az as Ja,aA as Za,aB as el,aC as tl,aD as Cr,aE as il,aF as nl,aG as sl,aH as qt,aI as fn,aJ as ol,aK as rl,aL as z,aM as $s,aN as Lt,aO as ys,aP as kr,aQ as gn,aR as al,aS as Sr,aT as jt,aU as ll,aV as cl,aW as ul,aX as zs,aY as Qe,aZ as dl,a_ as Hi,a$ as mn,b0 as pn,b1 as wr,b2 as hl,b3 as Hs,b4 as fl,b5 as mi,b6 as qs,b7 as ft,b8 as Xe,b9 as pi,ba as ct,bb as Er,bc as gl,bd as ml,be as nt,bf as _i,bg as Cs,bh as _n,bi as k,bj as J,bk as x,bl as B,bm as bn,bn as pl,bo as vn,bp as Dt,bq as xr,br as _l,bs as bl,bt as Oe,bu as vl,bv as ks,bw as L,bx as yl,by as Cl,bz as Ir,bA as kl,bB as qi,bC as Sl,bD as js,bE as wl,bF as El,bG as xl,bH as Lr,bI as Il,bJ as Ti,bK as Ss,bL as Be,bM as Ll,bN as xe,bO as Dl,bP as Gs,bQ as Tl,bR as Ml,bS as Ys,bT as Tt,bU as Ne,bV as be,bW as gt,bX as Al,bY as Qs,bZ as Rl,b_ as Pl,b$ as Ol,c0 as Fl,c1 as Bl,c2 as ge,c3 as Dr,c4 as ws,c5 as Tr,c6 as Xs,c7 as yn,c8 as Nl,c9 as Kl,ca as Mi,cb as Mr,cc as Vl,cd as We,ce as Ul,cf as ze,cg as Gt,ch as Js,ci as li,cj as Cn,ck as kn,cl as fe,cm as Wl,cn as Zs,co as $l,cp as Ar,cq as he,cr as Rr,cs as Sn,ct as Wt,cu as zl,cv as Hl,cw as Es,cx as De,cy as eo,cz as ql,cA as jl,cB as ji,cC as to,cD as Gl,cE as Yl,cF as Ql,cG as Xl,cH as Jl,cI as Zl,cJ as ec,cK as tc,cL as ic,cM as nc,cN as sc,cO as oc,cP as rc,cQ as ac,cR as lc,cS as cc,cT as uc,cU as dc,cV as hc,cW as fc,cX as gc,cY as mc,cZ as pc,c_ as _c,c$ as bc,d0 as io,d1 as vc,d2 as yc,d3 as Cc,d4 as Ai,d5 as Ri,d6 as Pr,d7 as Pi,d8 as Oi,d9 as Or,da as no,db as kc,dc as Fr,dd as Sc,de as wc,df as Ec,dg as xc,dh as Ic,di as Lc,dj as Yt,dk as so,dl as Dc,dm as xs,dn as Br,dp as Tc,dq as kt,dr as Qt,ds as Mc,dt as Ac,du as oo,dv as Rc,dw as Pc,dx as me,dy as Oc,dz as Fc,dA as Bc,dB as Pe,dC as Nc,dD as Kc,dE as Nr,dF as Vc,dG as pe,dH as ro,dI as Uc,dJ as Wc,dK as $c,dL as zc,dM as Hc,dN as qc,dO as ao,dP as jc,dQ as Gc,dR as Yc,dS as Qc,dT as Xc,dU as Jc,dV as Zc,dW as eu,dX as tu,dY as iu,dZ as nu,d_ as su,d$ as ou,e0 as ru,e1 as Z,e2 as au,e3 as lu,e4 as cu,e5 as Kr,e6 as uu,e7 as Vr,e8 as du,e9 as hu,ea as fu,eb as gu,ec as mu,ed as pu,ee as Ur,ef as Wr,eg as _u,eh as bu,ei as vu,ej as yu,ek as lo,el as ae,em as $r,en as Cu,eo as ku,ep as Su,eq as wu,er as Eu,es as xu,et as Iu,eu as Lu,ev as Du,ew as Tu,ex as Mu,ey as Au,ez as Ru,eA as Pu,eB as Ou,eC as Fu,eD as Bu,eE as Nu,eF as Ku,eG as Vu,eH as Uu,eI as Wu,eJ as $u,eK as zu,eL as Hu,eM as qu,eN as ju,eO as Gu,eP as Yu,eQ as Qu,eR as Xu,eS as Ju,eT as $t,eU as Zu,eV as ed,eW as td,eX as id,eY as nd,eZ as sd,e_ as od,e$ as rd,f0 as ad,f1 as ld,f2 as cd,f3 as ud,f4 as dd,f5 as hd,f6 as fd,f7 as gd}from"./format-e63af49d.js";let zt=class{static chord(e,t){return Ea(e,t)}};zt.CtrlCmd=2048;zt.Shift=1024;zt.Alt=512;zt.WinCtrl=256;function zr(){return{editor:void 0,languages:void 0,CancellationTokenSource:rr,Emitter:_,KeyCode:xa,KeyMod:zt,Position:Li,Range:U,Selection:Ia,SelectionDirection:La,MarkerSeverity:Da,MarkerTag:Ta,Uri:ne,Token:fi}}const md={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0};class pd extends I{constructor(e,t={}){super(),this._onDidUpdate=this._register(new _),this._editor=e,this._options=hs(t,md,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidDispose(()=>this.dispose())),this._register(this._editor.onDidUpdateDiff(()=>this._onDiffUpdated())),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition(i=>{this.ignoreSelectionChange||(this.nextIdx=-1)})),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel(i=>{this.revealFirst=!0})),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&this._editor.getLineChanges()!==null&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach(t=>{!this._options.ignoreCharChanges&&t.charChanges?t.charChanges.forEach(i=>{this.ranges.push({rhs:!0,range:new U(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn)})}):t.modifiedEndLineNumber===0?this.ranges.push({rhs:!0,range:new U(t.modifiedStartLineNumber,1,t.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new U(t.modifiedStartLineNumber,1,t.modifiedEndLineNumber+1,1)})}),this.ranges.sort((t,i)=>U.compareRangesUsingStarts(t.range,i.range)),this._onDidUpdate.fire(this)}_initIdx(e){let t=!1;const i=this._editor.getPosition();if(!i){this.nextIdx=0;return}for(let n=0,s=this.ranges.length;n<s&&!t;n++){const o=this.ranges[n].range;i.isBeforeOrEqual(o.getStartPosition())&&(this.nextIdx=n+(e?0:-1),t=!0)}t||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}_move(e,t){if(Ma(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;this.nextIdx===-1?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const i=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const n=i.range.getStartPosition();this._editor.setPosition(n),this._editor.revealRangeInCenter(i.range,t)}finally{this.ignoreSelectionChange=!1}}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this._move(!0,e)}previous(e=0){this._move(!1,e)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}}const _d="$initialize";let co=!1;function wn(r){Aa&&(co||(co=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(r.message))}class bd{constructor(e,t,i,n){this.vsWorker=e,this.req=t,this.method=i,this.args=n,this.type=0}}class uo{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class vd{constructor(e,t,i,n){this.vsWorker=e,this.req=t,this.eventName=i,this.arg=n,this.type=2}}class yd{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class Cd{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class kd{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t){const i=String(++this._lastSentReq);return new Promise((n,s)=>{this._pendingReplies[i]={resolve:n,reject:s},this._send(new bd(this._workerId,i,e,t))})}listen(e,t){let i=null;const n=new _({onFirstListenerAdd:()=>{i=String(++this._lastSentReq),this._pendingEmitters.set(i,n),this._send(new vd(this._workerId,i,e,t))},onLastListenerRemove:()=>{this._pendingEmitters.delete(i),this._send(new Cd(this._workerId,i)),i=null}});return n.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.method,e.args).then(n=>{this._send(new uo(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=Vs(n.detail)),this._send(new uo(this._workerId,t,void 0,Vs(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.eventName,e.arg)(n=>{this._send(new yd(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class Sd extends I{constructor(e,t,i){super();let n=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",c=>{this._protocol.handleMessage(c)},c=>{n==null||n(c)})),this._protocol=new kd({sendMessage:(c,u)=>{this._worker.postMessage(c,u)},handleMessage:(c,u)=>{if(typeof i[c]!="function")return Promise.reject(new Error("Missing method "+c+" on main thread host."));try{return Promise.resolve(i[c].apply(i,u))}catch(d){return Promise.reject(d)}},handleEvent:(c,u)=>{if(qr(c)){const d=i[c].call(i,u);if(typeof d!="function")throw new Error(`Missing dynamic event ${c} on main thread host.`);return d}if(Hr(c)){const d=i[c];if(typeof d!="function")throw new Error(`Missing event ${c} on main thread host.`);return d}throw new Error(`Malformed event name ${c}`)}}),this._protocol.setWorkerId(this._worker.getId());let s=null;typeof ee.require<"u"&&typeof ee.require.getConfig=="function"?s=ee.require.getConfig():typeof ee.requirejs<"u"&&(s=ee.requirejs.s.contexts._.config);const o=fs(i);this._onModuleLoaded=this._protocol.sendMessage(_d,[this._worker.getId(),JSON.parse(JSON.stringify(s)),t,o]);const a=(c,u)=>this._request(c,u),l=(c,u)=>this._protocol.listen(c,u);this._lazyProxy=new Promise((c,u)=>{n=u,this._onModuleLoaded.then(d=>{c(wd(d,a,l))},d=>{u(d),this._onError("Worker failed to load "+t,d)})})}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise((i,n)=>{this._onModuleLoaded.then(()=>{this._protocol.sendMessage(e,t).then(i,n)},n)})}_onError(e,t){console.error(e),console.info(t)}}function Hr(r){return r[0]==="o"&&r[1]==="n"&&ar(r.charCodeAt(2))}function qr(r){return/^onDynamic/.test(r)&&ar(r.charCodeAt(9))}function wd(r,e,t){const i=o=>function(){const a=Array.prototype.slice.call(arguments,0);return e(o,a)},n=o=>function(a){return t(o,a)},s={};for(const o of r){if(qr(o)){s[o]=n(o);continue}if(Hr(o)){s[o]=t(o,void 0);continue}s[o]=i(o)}return s}var Gi;const ho=(Gi=window.trustedTypes)===null||Gi===void 0?void 0:Gi.createPolicy("defaultWorkerFactory",{createScriptURL:r=>r});function Ed(r){if(ee.MonacoEnvironment){if(typeof ee.MonacoEnvironment.getWorker=="function")return ee.MonacoEnvironment.getWorker("workerMain.js",r);if(typeof ee.MonacoEnvironment.getWorkerUrl=="function"){const e=ee.MonacoEnvironment.getWorkerUrl("workerMain.js",r);return new Worker(ho?ho.createScriptURL(e):e,{name:r})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function xd(r){return typeof r.then=="function"}class Id{constructor(e,t,i,n,s){this.id=t;const o=Ed(i);xd(o)?this.worker=o:this.worker=Promise.resolve(o),this.postMessage(e,[]),this.worker.then(a=>{a.onmessage=function(l){n(l.data)},a.onmessageerror=s,typeof a.addEventListener=="function"&&a.addEventListener("error",s)})}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)===null||i===void 0||i.then(n=>n.postMessage(e,t))}dispose(){var e;(e=this.worker)===null||e===void 0||e.then(t=>t.terminate()),this.worker=null}}class Fi{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,i){const n=++Fi.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new Id(e,n,this._label||"anonymous"+n,t,s=>{wn(s),this._webWorkerFailedBeforeError=s,i(s)})}}Fi.LAST_WORKER_ID=0;const Ld=3;function jr(r,e,t,i){return new Oa(r,e,t).ComputeDiff(i)}class fo{constructor(e){const t=[],i=[];for(let n=0,s=e.length;n<s;n++)t[n]=En(e[n],1),i[n]=xn(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],s=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],u=e?this._startColumns[l]:1,d=e?this._endColumns[l]:c.length+1;for(let h=u;h<d;h++)n[a]=c.charCodeAt(h-1),s[a]=l+1,o[a]=h,a++;!e&&l<i&&(n[a]=10,s[a]=l+1,o[a]=c.length+1,a++)}return new Dd(n,s,o)}}class Dd{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class Mt{constructor(e,t,i,n,s,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=s,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),s=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),u=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),d=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new Mt(n,s,o,a,l,c,u,d)}}function Td(r){if(r.length<=1)return r;const e=[r[0]];let t=e[0];for(let i=1,n=r.length;i<n;i++){const s=r[i],o=s.originalStart-(t.originalStart+t.originalLength),a=s.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<Ld?(t.originalLength=s.originalStart+s.originalLength-t.originalStart,t.modifiedLength=s.modifiedStart+s.modifiedLength-t.modifiedStart):(e.push(s),t=s)}return e}class St{constructor(e,t,i,n,s){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=s}static createFromDiffResult(e,t,i,n,s,o,a){let l,c,u,d,h;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(u=n.getStartLineNumber(t.modifiedStart)-1,d=0):(u=n.getStartLineNumber(t.modifiedStart),d=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&s()){const f=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),g=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(f.getElements().length>0&&g.getElements().length>0){let p=jr(f,g,s,!0).changes;a&&(p=Td(p)),h=[];for(let v=0,w=p.length;v<w;v++)h.push(Mt.createFromDiffChange(p[v],f,g))}}return new St(l,c,u,d,h)}}class Md{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new fo(e),this.modified=new fo(t),this.continueLineDiff=go(i.maxComputationTime),this.continueCharDiff=go(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};const e=jr(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(St.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let s=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,u=c?c.originalStart:this.originalLines.length,d=c?c.modifiedStart:this.modifiedLines.length;for(;s<u&&o<d;){const h=this.originalLines[s],f=this.modifiedLines[o];if(h!==f){{let g=En(h,1),p=En(f,1);for(;g>1&&p>1;){const v=h.charCodeAt(g-2),w=f.charCodeAt(p-2);if(v!==w)break;g--,p--}(g>1||p>1)&&this._pushTrimWhitespaceCharChange(n,s+1,1,g,o+1,1,p)}{let g=xn(h,1),p=xn(f,1);const v=h.length+1,w=f.length+1;for(;g<v&&p<w;){const S=h.charCodeAt(g-1),b=h.charCodeAt(p-1);if(S!==b)break;g++,p++}(g<v||p<w)&&this._pushTrimWhitespaceCharChange(n,s+1,g,v,o+1,p,w)}}s++,o++}c&&(n.push(St.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),s+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,s,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,s,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new Mt(t,i,t,n,s,o,s,a)]),e.push(new St(t,t,s,s,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,s,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===s?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=s,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Mt(t,i,t,n,s,o,s,a)),!0):!1}}function En(r,e){const t=Ra(r);return t===-1?e:t+1}function xn(r,e){const t=Pa(r);return t===-1?e:t+2}function go(r){if(r===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<r}class Ad{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new Li(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Fa(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=gs(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),n[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}class Rd{constructor(e,t,i){const n=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)n[s]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Pd{constructor(e){let t=0,i=0;for(let s=0,o=e.length;s<o;s++){const[a,l,c]=e[s];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new Rd(i,t,0);for(let s=0,o=e.length;s<o;s++){const[a,l,c]=e[s];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let Yi=null;function Od(){return Yi===null&&(Yi=new Pd([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),Yi}let mt=null;function Fd(){if(mt===null){mt=new Ba(0);const r=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<r.length;t++)mt.set(r.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)mt.set(e.charCodeAt(t),2)}return mt}class bi{static _createLink(e,t,i,n,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=Od()){const i=Fd(),n=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),l=a.length;let c=0,u=0,d=0,h=1,f=!1,g=!1,p=!1,v=!1;for(;c<l;){let w=!1;const S=a.charCodeAt(c);if(h===13){let b;switch(S){case 40:f=!0,b=0;break;case 41:b=f?0:1;break;case 91:p=!0,g=!0,b=0;break;case 93:p=!1,b=g?0:1;break;case 123:v=!0,b=0;break;case 125:b=v?0:1;break;case 39:b=d===39?1:0;break;case 34:b=d===34?1:0;break;case 96:b=d===96?1:0;break;case 42:b=d===42?1:0;break;case 124:b=d===124?1:0;break;case 32:b=p?0:1;break;default:b=i.get(S)}b===1&&(n.push(bi._createLink(i,a,s,u,c)),w=!0)}else if(h===12){let b;S===91?(g=!0,b=0):b=i.get(S),b===1?w=!0:h=13}else h=t.nextState(h,S),h===0&&(w=!0);w&&(h=1,f=!1,g=!1,v=!1,u=c+1,d=S),c++}h===13&&n.push(bi._createLink(i,a,s,u,l))}return n}}function Bd(r){return!r||typeof r.getLineCount!="function"||typeof r.getLineContent!="function"?[]:bi.computeLinks(r)}class In{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,s){if(e&&t){const o=this.doNavigateValueSet(t,s);if(o)return{range:e,value:o}}if(i&&n){const o=this.doNavigateValueSet(n,s);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const s=parseFloat(e);return!isNaN(n)&&!isNaN(s)&&n===s?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let s=0,o=e.length;n===null&&s<o;s++)n=this.valueSetReplace(e[s],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}}In.INSTANCE=new In;var Te=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};class Nd extends Ad{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=Ua(e.column,Wa(t),this._lines[e.lineNumber-1],0);return i?new U(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,s="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=s.substring(a[o].start,a[o].end);o+=1,yield l}else if(n<t.length)s=t[n],a=i(s,e),o=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),s=[];for(const o of n)s.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return s}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,s=[];s.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<n;o++)s.push(this._lines[o]);return s.push(this._lines[n].substring(0,e.endColumn-1)),s.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!Li.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const s=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>s&&(i=s,n=!0)}return n?{lineNumber:t,column:i}:e}}class Se{constructor(e,t){this._host=e,this._models=Object.create(null),this._foreignModuleFactory=t,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}acceptNewModel(e){this._models[e.url]=new Nd(ne.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}computeUnicodeHighlights(e,t,i){return Te(this,void 0,void 0,function*(){const n=this._getModel(e);return n?Na.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}})}computeDiff(e,t,i,n){return Te(this,void 0,void 0,function*(){const s=this._getModel(e),o=this._getModel(t);return!s||!o?null:Se.computeDiff(s,o,i,n)})}static computeDiff(e,t,i,n){const s=e.getLinesContent(),o=t.getLinesContent(),l=new Md(s,o,{shouldComputeCharChanges:!0,shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:i,shouldMakePrettyDiff:!0,maxComputationTime:n}).computeDiff(),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);return{quitEarly:l.quitEarly,identical:c,changes:l.changes}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let s=1;s<=i;s++){const o=e.getLineContent(s),a=t.getLineContent(s);if(o!==a)return!1}return!0}computeMoreMinimalEdits(e,t){return Te(this,void 0,void 0,function*(){const i=this._getModel(e);if(!i)return t;const n=[];let s;t=t.slice(0).sort((o,a)=>{if(o.range&&a.range)return U.compareRangesUsingStarts(o.range,a.range);const l=o.range?0:1,c=a.range?0:1;return l-c});for(let{range:o,text:a,eol:l}of t){if(typeof l=="number"&&(s=l),U.isEmpty(o)&&!a)continue;const c=i.getValueInRange(o);if(a=a.replace(/\r\n|\n|\r/g,i.eol),c===a)continue;if(Math.max(a.length,c.length)>Se._diffLimit){n.push({range:o,text:a});continue}const u=Ka(c,a,!1),d=i.offsetAt(U.lift(o).getStartPosition());for(const h of u){const f=i.positionAt(d+h.originalStart),g=i.positionAt(d+h.originalStart+h.originalLength),p={text:a.substr(h.modifiedStart,h.modifiedLength),range:{startLineNumber:f.lineNumber,startColumn:f.column,endLineNumber:g.lineNumber,endColumn:g.column}};i.getValueInRange(p.range)!==p.text&&n.push(p)}}return typeof s=="number"&&n.push({eol:s,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),n})}computeLinks(e){return Te(this,void 0,void 0,function*(){const t=this._getModel(e);return t?Bd(t):null})}textualSuggest(e,t,i,n){return Te(this,void 0,void 0,function*(){const s=new lr(!0),o=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const u of c.words(o))if(!(u===t||!isNaN(Number(u)))&&(a.add(u),a.size>Se._suggestionsLimit))break e}}return{words:Array.from(a),duration:s.elapsed()}})}computeWordRanges(e,t,i,n){return Te(this,void 0,void 0,function*(){const s=this._getModel(e);if(!s)return Object.create(null);const o=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=s.getLineWords(l,o);for(const u of c){if(!isNaN(Number(u.word)))continue;let d=a[u.word];d||(d=[],a[u.word]=d),d.push({startLineNumber:l,startColumn:u.startColumn,endLineNumber:l,endColumn:u.endColumn})}}return a})}navigateValueSet(e,t,i,n,s){return Te(this,void 0,void 0,function*(){const o=this._getModel(e);if(!o)return null;const a=new RegExp(n,s);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const u=o.getValueInRange(c);return In.INSTANCE.navigateValueSet(t,l,c,u,i)})}loadForeignModule(e,t,i){const o={host:Va(i,(a,l)=>this._host.fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(o,t),Promise.resolve(fs(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}Se._diffLimit=1e5;Se._suggestionsLimit=1e4;typeof importScripts=="function"&&(ee.monaco=zr());var Kd=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},pt=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},Ln=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};const mo=60*1e3,po=5*60*1e3;function Me(r,e){const t=r.getModel(e);return!(!t||t.isTooLargeForSyncing())}let Dn=class extends I{constructor(e,t,i,n,s){super(),this._modelService=e,this._workerManager=this._register(new Ud(this._modelService,n)),this._logService=i,this._register(s.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(o,a)=>Me(this._modelService,o.uri)?this._workerManager.withWorker().then(l=>l.computeLinks(o.uri)).then(l=>l&&{links:l}):Promise.resolve({links:[]})})),this._register(s.completionProvider.register("*",new Vd(this._workerManager,t,this._modelService,n)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return Me(this._modelService,e)}computedUnicodeHighlights(e,t,i){return this._workerManager.withWorker().then(n=>n.computedUnicodeHighlights(e,t,i))}computeDiff(e,t,i,n){return this._workerManager.withWorker().then(s=>s.computeDiff(e,t,i,n))}computeMoreMinimalEdits(e,t){if(ur(t)){if(!Me(this._modelService,e))return Promise.resolve(t);const i=lr.create(!0),n=this._workerManager.withWorker().then(s=>s.computeMoreMinimalEdits(e,t));return n.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),i.elapsed())),Promise.race([n,$a(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return Me(this._modelService,e)}navigateValueSet(e,t,i){return this._workerManager.withWorker().then(n=>n.navigateValueSet(e,t,i))}canComputeWordRanges(e){return Me(this._modelService,e)}computeWordRanges(e,t){return this._workerManager.withWorker().then(i=>i.computeWordRanges(e,t))}};Dn=Kd([pt(0,X),pt(1,cr),pt(2,Di),pt(3,Ut),pt(4,P)],Dn);class Vd{constructor(e,t,i,n){this.languageConfigurationService=n,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}provideCompletionItems(e,t){return Ln(this,void 0,void 0,function*(){const i=this._configurationService.getValue(e.uri,t,"editor");if(!i.wordBasedSuggestions)return;const n=[];if(i.wordBasedSuggestionsMode==="currentDocument")Me(this._modelService,e.uri)&&n.push(e.uri);else for(const d of this._modelService.getModels())Me(this._modelService,d.uri)&&(d===e?n.unshift(d.uri):(i.wordBasedSuggestionsMode==="allDocuments"||d.getLanguageId()===e.getLanguageId())&&n.push(d.uri));if(n.length===0)return;const s=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),o=e.getWordAtPosition(t),a=o?new U(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):U.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),u=yield(yield this._workerManager.withWorker()).textualSuggest(n,o==null?void 0:o.word,s);if(u)return{duration:u.duration,suggestions:u.words.map(d=>({kind:18,label:d,insertText:d,range:{insert:l,replace:a}}))}})}}class Ud extends I{constructor(e,t){super(),this.languageConfigurationService=t,this._modelService=e,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new ms).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(po/2)),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>po&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new Gr(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class Wd extends I{constructor(e,t,i){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new ms;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(mo/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)le(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>mo&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const s=new G;s.add(i.onDidChangeContent(o=>{this._proxy.acceptModelChanged(n.toString(),o)})),s.add(i.onWillDispose(()=>{this._stopModelSync(n)})),s.add(ue(()=>{this._proxy.acceptRemovedModel(n)})),this._syncedModels[n]=s}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],le(t)}}class _o{constructor(e){this._instance=e,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class Qi{constructor(e){this._workerClient=e}fhr(e,t){return this._workerClient.fhr(e,t)}}class Gr extends I{constructor(e,t,i,n){super(),this.languageConfigurationService=n,this._disposed=!1,this._modelService=e,this._keepIdleModels=t,this._workerFactory=new Fi(i),this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new Sd(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new Qi(this)))}catch(e){wn(e),this._worker=new _o(new Se(new Qi(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,e=>(wn(e),this._worker=new _o(new Se(new Qi(this),null)),this._getOrCreateWorker().getProxyObject()))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new Wd(e,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(e,t=!1){return Ln(this,void 0,void 0,function*(){return this._disposed?Promise.reject(za()):this._getProxy().then(i=>(this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i))})}computedUnicodeHighlights(e,t,i){return this._withSyncedResources([e]).then(n=>n.computeUnicodeHighlights(e.toString(),t,i))}computeDiff(e,t,i,n){return this._withSyncedResources([e,t],!0).then(s=>s.computeDiff(e.toString(),t.toString(),i,n))}computeMoreMinimalEdits(e,t){return this._withSyncedResources([e]).then(i=>i.computeMoreMinimalEdits(e.toString(),t))}computeLinks(e){return this._withSyncedResources([e]).then(t=>t.computeLinks(e.toString()))}textualSuggest(e,t,i){return Ln(this,void 0,void 0,function*(){const n=yield this._withSyncedResources(e),s=i.source,o=zi(i);return n.textualSuggest(e.map(a=>a.toString()),t,s,o)})}computeWordRanges(e,t){return this._withSyncedResources([e]).then(i=>{const n=this._modelService.getModel(e);if(!n)return Promise.resolve(null);const s=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),o=s.source,a=zi(s);return i.computeWordRanges(e.toString(),t,o,a)})}navigateValueSet(e,t,i){return this._withSyncedResources([e]).then(n=>{const s=this._modelService.getModel(e);if(!s)return null;const o=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId()).getWordDefinition(),a=o.source,l=zi(o);return n.navigateValueSet(e.toString(),t,i,a,l)})}dispose(){super.dispose(),this._disposed=!0}}function $d(r,e,t){return new zd(r,e,t)}class zd extends Gr{constructor(e,t,i){super(e,i.keepIdleModels||!1,i.label,t),this._foreignModuleId=i.moduleId,this._foreignModuleCreateData=i.createData||null,this._foreignModuleHost=i.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?fs(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const n=(a,l)=>e.fmr(a,l),s=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},o={};for(const a of i)o[a]=s(a,n);return o})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then(t=>this.getProxy())}}function Hd(r){return Array.isArray(r)}function qd(r){return!Hd(r)}function Yr(r){return typeof r=="string"}function bo(r){return!Yr(r)}function He(r){return!r}function we(r,e){return r.ignoreCase&&e?e.toLowerCase():e}function vo(r){return r.replace(/[&<>'"_]/g,"-")}function jd(r,e){console.log(`${r.languageId}: ${e}`)}function M(r,e){return new Error(`${r.languageId}: ${e}`)}function ve(r,e,t,i,n){const s=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(s,function(a,l,c,u,d,h,f,g,p){return He(c)?He(u)?!He(d)&&d<i.length?we(r,i[d]):!He(f)&&r&&typeof r[f]=="string"?r[f]:(o===null&&(o=n.split("."),o.unshift(n)),!He(h)&&h<o.length?we(r,o[h]):""):we(r,t):"$"})}function Xt(r,e){let t=e;for(;t&&t.length>0;){const i=r.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function Gd(r,e){let t=e;for(;t&&t.length>0;){if(r.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var Yd=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Qd=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};const Qr=5;class At{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new Je(e,t);let i=Je.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new Je(e,t),this._entries[i]=n,n)}}At._INSTANCE=new At(Qr);class Je{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return Je._equals(this,e)}push(e){return At.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return At.create(this.parent,e)}}class je{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new je(this.languageId,this.state)}}class ye{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(t!==null)return new wt(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new wt(e,t);const i=Je.getStackElementId(e);let n=this._entries[i];return n||(n=new wt(e,null),this._entries[i]=n,n)}}ye._INSTANCE=new ye(Qr);class wt{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:ye.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof wt)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class Xd{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new fi(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const s=i.languageId,o=i.state,a=W.get(s);if(!a)return this.enterLanguage(s),this.emit(n,""),o;const l=a.tokenize(e,t,o);if(n!==0)for(const c of l.tokens)this._tokens.push(new fi(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new hr(this._tokens,e)}}class vi{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t);this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,s=t.length,o=i!==null?i.length:0;if(n===0&&s===0&&o===0)return new Uint32Array(0);if(n===0&&s===0)return i;if(s===0&&o===0)return e;const a=new Uint32Array(n+s+o);e!==null&&a.set(e);for(let l=0;l<s;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+s),a}nestedLanguageTokenize(e,t,i,n){const s=i.languageId,o=i.state,a=W.get(s);if(!a)return this.enterLanguage(s),this.emit(n,""),o;const l=a.tokenizeEncoded(e,t,o);if(n!==0)for(let c=0,u=l.tokens.length;c<u;c+=2)l.tokens[c]+=n;return this._prependTokens=vi._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new ps(vi._merge(this._prependTokens,this._tokens,null),e)}}let Rt=class Xr{constructor(e,t,i,n,s){this._configurationService=s,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._tokenizationRegistryListener=W.onDidChange(a=>{if(o)return;let l=!1;for(let c=0,u=a.changedLanguages.length;c<u;c++){const d=a.changedLanguages[c];if(this._embeddedLanguages[d]){l=!0;break}}l&&(o=!0,W.fire([this._languageId]),o=!1)}),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))})}dispose(){this._tokenizationRegistryListener.dispose()}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=W.get(t);if(i){if(i instanceof Xr){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}W.isResolved(t)||e.push(W.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=At.create(null,this._lexer.start);return ye.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return dr(this._languageId,i);const n=new Xd,s=this._tokenize(e,t,i,n);return n.finalize(s)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return Ha(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new vi(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),s=this._tokenize(e,t,i,n);return n.finalize(s)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=Xt(this._lexer,t.stack.state),!i))throw M(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,s=!1;for(const o of i){if(!bo(o.action)||o.action.nextEmbedded!=="@pop")continue;s=!0;let a=o.regex;const l=o.regex.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const u=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),u)}const c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!s)throw M(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,s){const o=this._findLeavingNestedLanguageOffset(e,i);if(o===-1){const c=s.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return ye.create(i.stack,new je(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,o);a.length>0&&s.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(o);return this._myTokenize(l,t,i,n+o,s)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,s){s.enterLanguage(this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,u=i.stack,d=0,h=null,f=!0;for(;f||d<l;){const g=d,p=u.depth,v=h?h.groups.length:0,w=u.state;let S=null,b=null,C=null,Y=null,Le=null;if(h){S=h.matches;const T=h.groups.shift();b=T.matched,C=T.action,Y=h.rule,h.groups.length===0&&(h=null)}else{if(!f&&d>=l)break;f=!1;let T=this._lexer.tokenizer[w];if(!T&&(T=Xt(this._lexer,w),!T))throw M(this._lexer,"tokenizer state is not defined: "+w);const y=a.substr(d);for(const K of T)if((d===0||!K.matchOnlyAtLineStart)&&(S=y.match(K.regex),S)){b=S[0],C=K.action;break}}if(S||(S=[""],b=""),C||(d<l&&(S=[a.charAt(d)],b=S[0]),C=this._lexer.defaultToken),b===null)break;for(d+=b.length;qd(C)&&bo(C)&&C.test;)C=C.test(b,S,w,d===l);let F=null;if(typeof C=="string"||Array.isArray(C))F=C;else if(C.group)F=C.group;else if(C.token!==null&&C.token!==void 0){if(C.tokenSubst?F=ve(this._lexer,C.token,b,S,w):F=C.token,C.nextEmbedded)if(C.nextEmbedded==="@pop"){if(!c)throw M(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw M(this._lexer,"cannot enter embedded language from within an embedded language");Le=ve(this._lexer,C.nextEmbedded,b,S,w)}if(C.goBack&&(d=Math.max(0,d-C.goBack)),C.switchTo&&typeof C.switchTo=="string"){let T=ve(this._lexer,C.switchTo,b,S,w);if(T[0]==="@"&&(T=T.substr(1)),Xt(this._lexer,T))u=u.switchTo(T);else throw M(this._lexer,"trying to switch to a state '"+T+"' that is undefined in rule: "+this._safeRuleName(Y))}else{if(C.transform&&typeof C.transform=="function")throw M(this._lexer,"action.transform not supported");if(C.next)if(C.next==="@push"){if(u.depth>=this._lexer.maxStack)throw M(this._lexer,"maximum tokenizer stack size reached: ["+u.state+","+u.parent.state+",...]");u=u.push(w)}else if(C.next==="@pop"){if(u.depth<=1)throw M(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(Y));u=u.pop()}else if(C.next==="@popall")u=u.popall();else{let T=ve(this._lexer,C.next,b,S,w);if(T[0]==="@"&&(T=T.substr(1)),Xt(this._lexer,T))u=u.push(T);else throw M(this._lexer,"trying to set a next state '"+T+"' that is undefined in rule: "+this._safeRuleName(Y))}}C.log&&typeof C.log=="string"&&jd(this._lexer,this._lexer.languageId+": "+ve(this._lexer,C.log,b,S,w))}if(F===null)throw M(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(Y));const dt=T=>{const y=this._languageService.getLanguageIdByLanguageName(T)||this._languageService.getLanguageIdByMimeType(T)||T,K=this._getNestedEmbeddedLanguageData(y);if(d<l){const Ke=e.substr(d);return this._nestedTokenize(Ke,t,ye.create(u,K),n+d,s)}else return ye.create(u,K)};if(Array.isArray(F)){if(h&&h.groups.length>0)throw M(this._lexer,"groups cannot be nested: "+this._safeRuleName(Y));if(S.length!==F.length+1)throw M(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(Y));let T=0;for(let y=1;y<S.length;y++)T+=S[y].length;if(T!==b.length)throw M(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(Y));h={rule:Y,matches:S,groups:[]};for(let y=0;y<F.length;y++)h.groups[y]={action:F[y],matched:S[y+1]};d-=b.length;continue}else{if(F==="@rematch"&&(d-=b.length,b="",S=null,F="",Le!==null))return dt(Le);if(b.length===0){if(l===0||p!==u.depth||w!==u.state||(h?h.groups.length:0)!==v)continue;throw M(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(Y))}let T=null;if(Yr(F)&&F.indexOf("@brackets")===0){const y=F.substr(9),K=Jd(this._lexer,b);if(!K)throw M(this._lexer,"@brackets token returned but no bracket defined as: "+b);T=vo(K.token+y)}else{const y=F===""?"":F+this._lexer.tokenPostfix;T=vo(y)}g<o&&s.emit(g+n,T)}if(Le!==null)return dt(Le)}return ye.create(u,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new je(e,cn);e!==this._languageId&&(W.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=W.get(e);return t?new je(e,t.getInitialState()):new je(e,cn)}};Rt=Yd([Qd(4,de)],Rt);function Jd(r,e){if(!e)return null;e=we(r,e);const t=r.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}var Zd=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})},Xi;const Ji=(Xi=window.trustedTypes)===null||Xi===void 0?void 0:Xi.createPolicy("standaloneColorizer",{createHTML:r=>r});class Is{static colorizeElement(e,t,i,n){n=n||{};const s=n.theme||"vs",o=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(o)||o;e.setTheme(s);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+s;const c=u=>{var d;const h=(d=Ji==null?void 0:Ji.createHTML(u))!==null&&d!==void 0?d:u;i.innerHTML=h};return this.colorize(t,l||"",a,n).then(c,u=>console.error(u))}static colorize(e,t,i,n){return Zd(this,void 0,void 0,function*(){const s=e.languageIdCodec;let o=4;n&&typeof n.tabSize=="number"&&(o=n.tabSize),fr(t)&&(t=t.substr(1));const a=gs(t);if(!e.isRegisteredLanguageId(i))return yo(a,o,s);const l=yield W.getOrCreate(i);return l?eh(a,o,l,s):yo(a,o,s)})}static colorizeLine(e,t,i,n,s=4){const o=it.isBasicASCII(e,t),a=it.containsRTL(e,o,i);return _s(new bs(!1,!0,e,!1,o,a,0,n,[],s,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const o=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function eh(r,e,t,i){return new Promise((n,s)=>{const o=()=>{const a=th(r,e,t,i);if(t instanceof Rt){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,s);return}}n(a)};o()})}function yo(r,e,t){let i=[];const s=new Uint32Array(2);s[0]=0,s[1]=33587200;for(let o=0,a=r.length;o<a;o++){const l=r[o];s[0]=l.length;const c=new un(s,l,t),u=it.isBasicASCII(l,!0),d=it.containsRTL(l,u,!0),h=_s(new bs(!1,!0,l,!1,u,d,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(h.html),i.push("<br/>")}return i.join("")}function th(r,e,t,i){let n=[],s=t.getInitialState();for(let o=0,a=r.length;o<a;o++){const l=r[o],c=t.tokenizeEncoded(l,!0,s);un.convertToEndOffset(c.tokens,l.length);const u=new un(c.tokens,l,i),d=it.isBasicASCII(l,!0),h=it.containsRTL(l,d,!0),f=_s(new bs(!1,!0,l,!1,d,h,0,u.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(f.html),n.push("<br/>"),s=c.endState}return n.join("")}var ih=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},nh=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},sh=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};let Tn=class extends I{constructor(e){super(),this._themeService=e,this._onCodeEditorAdd=this._register(new _),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new _),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onDiffEditorAdd=this._register(new _),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new _),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new vt,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let s;this._modelProperties.has(n)?s=this._modelProperties.get(n):(s=new Map,this._modelProperties.set(n,s)),s.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}openCodeEditor(e,t,i){return sh(this,void 0,void 0,function*(){for(const n of this._codeEditorOpenHandlers){const s=yield n(e,t,i);if(s!==null)return s}return null})}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return ue(t)}};Tn=ih([nh(0,Fe)],Tn);var oh=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Co=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},rh=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};let yi=class extends Tn{constructor(e,t){super(t),this.onCodeEditorAdd(()=>this._checkContextKey()),this.onCodeEditorRemove(()=>this._checkContextKey()),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this.registerCodeEditorOpenHandler((i,n,s)=>rh(this,void 0,void 0,function*(){return n?this.doOpenEditor(n,i):null}))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const s=t.resource.scheme;if(s===N.http||s===N.https)return gr(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const s={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(s),e.revealPositionInCenter(s,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};yi=oh([Co(0,oe),Co(1,Fe)],yi);D(H,yi);const ut=vs("layoutService");var Jr=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Zr=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Ci=class{constructor(e){this._codeEditorService=e,this.onDidLayout=gi.None,this.offset={top:0,quickPickTop:0}}get dimension(){return this._dimension||(this._dimension=qa(window.document.body)),this._dimension}get hasContainer(){return!1}get container(){throw new Error("ILayoutService.container is not available in the standalone editor!")}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())===null||e===void 0||e.focus()}};Ci=Jr([Zr(0,H)],Ci);let Mn=class extends Ci{constructor(e,t){super(t),this._container=e}get hasContainer(){return!1}get container(){return this._container}};Mn=Jr([Zr(1,H)],Mn);D(ut,Ci);var ah=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ko=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},Jt=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};function Zt(r){return r.scheme===N.file?r.fsPath:r.path}let ea=0;class ei{constructor(e,t,i,n,s,o,a){this.id=++ea,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=s,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class So{constructor(e,t){this.resourceLabel=e,this.reason=t}}class wo{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(E({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(E({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class lh{constructor(e,t,i,n,s,o,a){this.id=++ea,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=s,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new wo),this.removedResources.has(t)||this.removedResources.set(t,new So(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new wo),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new So(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ta{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new pr(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,s=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,s=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}s!==-1&&(this._past=this._past.slice(0,s)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class Zi{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const ia=new ta("","");ia.locked=!0;let An=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=ja.None,i=ht.None){if(e.type===0){const n=Zt(e.resource),s=this.getUriComparisonKey(e.resource);this._pushElement(new ei(e,n,s,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,s=[],o=[];for(const a of e.resources){const l=Zt(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),s.push(l),o.push(c))}s.length===1?this._pushElement(new ei(e,s[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new lh(e,s,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],s=e.strResources[t];let o;this._editStacks.has(s)?o=this._editStacks.get(s):(o=new ta(n,s),this._editStacks.set(s,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const s of i){const o=Zt(s.resource),a=this.getUriComparisonKey(s.resource),l=new ei(s,o,a,0,0,0,0);n.set(l.strResource,l)}for(const s of e.strResources){if(t&&t.has(s))continue;this._editStacks.get(s).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const s of i){const o=Zt(s.resource),a=this.getUriComparisonKey(s.resource),l=new ei(s,o,a,0,0,0,0);n.set(l.strResource,l)}for(const s of e.strResources){if(t&&t.has(s))continue;this._editStacks.get(s).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new pr(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const o=s.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=n)}return[t,i]}canUndo(e){if(e instanceof ht){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){_r(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,s){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),n.dispose(),s()),l=>(o(),n.dispose(),this._onError(l,e))):(o(),n.dispose(),s())}_invokeWorkspacePrepare(e){return Jt(this,void 0,void 0,function*(){if(typeof e.actual.prepareUndoRedo>"u")return I.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?I.None:t})}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(I.None);const i=e.actual.prepareUndoRedo();return i?Ga(i)?t(i):i.then(n=>t(n)):t(I.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||ia);return new Zi(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new ti(this._undo(e,0,!0));for(const s of t.strResources)this.removeElements(s);return this._notificationService.warn(n),new ti}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,E({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,E({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const s=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&s.push(a.resourceLabel);if(s.length>0)return this._tryToSplitAndUndo(e,t,null,E({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,s.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,E({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,E({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),s=this._checkWorkspaceUndo(e,t,n,!1);return s?s.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(e,t,i,n){return Jt(this,void 0,void 0,function*(){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){const a=yield this._dialogService.show(j.Info,E("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),[E({key:"ok",comment:["{0} denotes a number that is > 1"]},"Undo in {0} Files",i.editStacks.length),E("nok","Undo this File"),E("cancel","Cancel")],{cancelId:2});if(a.choice===2)return;if(a.choice===1)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const l=this._checkWorkspaceUndo(e,t,i,!1);if(l)return l.returnValue;n=!0}let s;try{s=yield this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return s.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,s,()=>this._continueUndoInGroup(t.groupId,n))})}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=E({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new Zi([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const o=s.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof ht){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),s=n.getClosestPastElement();if(!s)return;if(s.groupId){const[a,l]=this._findClosestUndoElementInGroup(s.groupId);if(s!==a&&l)return this._undo(l,t,i)}if((s.sourceId!==t||s.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,s);try{return s.type===1?this._workspaceUndo(e,s,i):this._resourceUndo(n,s,i)}finally{}}_confirmAndContinueUndo(e,t,i){return Jt(this,void 0,void 0,function*(){if((yield this._dialogService.show(j.Info,E("confirmDifferentSource","Would you like to undo '{0}'?",i.label),[E("confirmDifferentSource.yes","Yes"),E("confirmDifferentSource.no","No")],{cancelId:1})).choice!==1)return this._undo(e,t,!0)})}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const o=s.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=n)}return[t,i]}canRedo(e){if(e instanceof ht){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new ti(this._redo(e));for(const s of t.strResources)this.removeElements(s);return this._notificationService.warn(n),new ti}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,E({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,E({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const s=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&s.push(a.resourceLabel);if(s.length>0)return this._tryToSplitAndRedo(e,t,null,E({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,s.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,E({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,E({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}_executeWorkspaceRedo(e,t,i){return Jt(this,void 0,void 0,function*(){let n;try{n=yield this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const s=this._checkWorkspaceRedo(e,t,i,!0);if(s)return n.dispose(),s.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))})}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=E({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new Zi([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const o=s.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof ht){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,s]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&s)return this._redo(s)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};An=ah([ko(0,mr),ko(1,Ee)],An);class ti{constructor(e){this.returnValue=e}}D(Ya,An);class q{constructor(e={},t=[],i=[]){this._contents=e,this._keys=t,this._overrides=i,this.frozen=!1,this.overrideConfigurations=new Map}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?Us(this.contents,e):this.contents}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?Us(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=Ue(this.contents),i=Ue(this.overrides),n=[...this.keys];for(const s of e)if(!s.isEmpty()){this.mergeContents(t,s.contents);for(const o of s.overrides){const[a]=i.filter(l=>Ct(l.identifiers,o.identifiers));a?(this.mergeContents(a.contents,o.contents),a.keys.push(...o.keys),a.keys=dn(a.keys)):i.push(Ue(o))}for(const o of s.keys)n.indexOf(o)===-1&&n.push(o)}return new q(t,n,i)}freeze(){return this.frozen=!0,this}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of dn([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[n];const o=t[n];o&&(typeof s=="object"&&typeof o=="object"?(s=Ue(s),this.mergeContents(s,o)):s=o),i[n]=s}return new q(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Ws(e[i])&&Ws(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=Ue(t[i])}}checkAndFreeze(e){return this.frozen&&!Object.isFrozen(e)?Qa(e):e}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=s=>{s&&(i?this.mergeContents(i,s):i=Ue(s))};for(const s of this.overrides)Ct(s.identifiers,[e])?t=s.contents:s.identifiers.includes(e)&&n(s.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.addKey(e),br(this.contents,e,t,i=>{throw new Error(i)})}removeValue(e){this.removeKey(e)&&Xa(this.contents,e)}addKey(e){let t=this.keys.length;for(let i=0;i<t;i++)e.indexOf(this.keys[i])===0&&(t=i);this.keys.splice(t,1,e)}removeKey(e){const t=this.keys.indexOf(e);return t!==-1?(this.keys.splice(t,1),!0):!1}}class Bi{constructor(e,t,i,n,s=new q,o=new q,a=new te,l=new q,c=new te,u=!0){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this._freeze=u,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new te,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=new q,this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=t.overrideIdentifier?this._defaultConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this._defaultConfiguration.freeze().getValue(e),l=this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration.freeze().getValue(e),c=this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration.freeze().getValue(e),u=t.overrideIdentifier?this.userConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.userConfiguration.freeze().getValue(e),d=t.overrideIdentifier?this.localUserConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.localUserConfiguration.freeze().getValue(e),h=t.overrideIdentifier?this.remoteUserConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.remoteUserConfiguration.freeze().getValue(e),f=i?t.overrideIdentifier?this._workspaceConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this._workspaceConfiguration.freeze().getValue(e):void 0,g=s?t.overrideIdentifier?s.freeze().override(t.overrideIdentifier).getValue(e):s.freeze().getValue(e):void 0,p=t.overrideIdentifier?o.override(t.overrideIdentifier).getValue(e):o.getValue(e),v=n.getValue(e),w=dn(n.overrides.map(S=>S.identifiers).flat()).filter(S=>n.getOverrideValue(e,S)!==void 0);return{defaultValue:a,policyValue:l,applicationValue:c,userValue:u,userLocalValue:d,userRemoteValue:h,workspaceValue:f,workspaceFolderValue:g,memoryValue:p,value:v,default:a!==void 0?{value:this._defaultConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this._defaultConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,policy:l!==void 0?{value:l}:void 0,application:c!==void 0?{value:c,override:t.overrideIdentifier?this.applicationConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,user:u!==void 0?{value:this.userConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.userConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,userLocal:d!==void 0?{value:this.localUserConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.localUserConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,userRemote:h!==void 0?{value:this.remoteUserConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.remoteUserConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,workspace:f!==void 0?{value:this._workspaceConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this._workspaceConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,workspaceFolder:g!==void 0?{value:s==null?void 0:s.freeze().getValue(e),override:t.overrideIdentifier?s==null?void 0:s.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,memory:p!==void 0?{value:o.getValue(e),override:t.overrideIdentifier?o.getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,overrideIdentifiers:w.length?w:void 0}}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._freeze&&(t=t.freeze()),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:s}]),e},[])}}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.policy),n=this.parseConfigurationModel(e.application),s=this.parseConfigurationModel(e.user),o=this.parseConfigurationModel(e.workspace),a=e.folders.reduce((l,c)=>(l.set(ne.revive(c[0]),this.parseConfigurationModel(c[1])),l),new te);return new Bi(t,i,n,s,new q,o,a,new q,new te,!1)}static parseConfigurationModel(e){return new q(e.contents,e.keys,e.overrides).freeze()}}class ch{constructor(e,t,i,n){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this._previousConfiguration=void 0;const s=new Set;e.keys.forEach(a=>s.add(a)),e.overrides.forEach(([,a])=>a.forEach(l=>s.add(l))),this.affectedKeys=[...s.values()];const o=new q;this.affectedKeys.forEach(a=>o.setValue(a,{})),this.affectedKeysTree=o.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Bi.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var i;if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(t){const n=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(i=this.previous)===null||i===void 0?void 0:i.workspace):void 0,s=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!hn(n,s)}return!0}return!1}doesAffectedKeysTreeContains(e,t){let i=vr({[t]:!0},()=>{}),n;for(;typeof i=="object"&&(n=Object.keys(i)[0]);){if(e=e[n],!e)return!1;i=i[n]}return!0}}const uh=/^(cursor|delete)/;class dh extends I{constructor(e,t,i,n,s){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=s,this._onDidUpdateKeybindings=this._register(new _),this._currentChord=null,this._currentChordChecker=new ms,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=Ge.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new yr,this._logging=!1}get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:gi.None}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),null;const[n]=i.getDispatchParts();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),null;const s=this._contextKeyService.getContext(t),o=this._currentChord?this._currentChord.keypress:null;return this._getResolver().resolve(s,o,n)}_enterChordMode(e,t){this._currentChord={keypress:e,label:t},this._currentChordStatusMessage=this._notificationService.status(E("first.chord","({0}) was pressed. Waiting for second key of chord...",t));const i=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-i>5e3&&this._leaveChordMode()},500)}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChord=null}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchParts();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=Ge.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=Ge.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[s]=i.getParts();return this._ignoreSingleModifiers=new Ge(s),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),!1;let s=null,o=null;if(i){const[u]=e.getSingleModifierDispatchParts();s=u,o=u}else[s]=e.getDispatchParts(),o=this._currentChord?this._currentChord.keypress:null;if(s===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,o,s);return this._logService.trace("KeybindingService#dispatch",l,c==null?void 0:c.commandId),c&&c.enterChord?(n=!0,this._enterChordMode(s,l),this._log("+ Entering chord mode..."),n):(this._currentChord&&(!c||!c.commandId)&&(this._log(`+ Leaving chord mode: Nothing bound to "${this._currentChord.label} ${l}".`),this._notificationService.status(E("missing.chord","The key combination ({0}, {1}) is not a command.",this._currentChord.label,l),{hideAfter:10*1e3}),n=!0),this._leaveChordMode(),c&&c.commandId&&(c.bubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,u=>this._notificationService.warn(u)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,u=>this._notificationService.warn(u)),uh.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding"})),n)}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}class Ge{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}Ge.EMPTY=new Ge(null);class Et{constructor(e,t,i){this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const n of e){const s=n.command;s&&s.charAt(0)!=="-"&&this._defaultBoundCommands.set(s,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Et.handleRemovals([].concat(e).concat(t));for(let n=0,s=this._keybindings.length;n<s;n++){const o=this._keybindings[n];o.keypressParts.length!==0&&(o.when&&o.when.type===0||this._addKeyPress(o.keypressParts[0],o))}}static _isTargetedForRemoval(e,t,i,n){return!(t&&e.keypressParts[0]!==t||i&&e.keypressParts[1]!==i||n&&(!e.when||!Ja(n,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,s=e.length;n<s;n++){const o=e[n];if(o.command&&o.command.charAt(0)==="-"){const a=o.command.substring(1);t.has(a)?t.get(a).push(o):t.set(a,[o])}}if(t.size===0)return e;const i=[];for(let n=0,s=e.length;n<s;n++){const o=e[n];if(!o.command||o.command.length===0){i.push(o);continue}if(o.command.charAt(0)==="-")continue;const a=t.get(o.command);if(!a||!o.isDefault){i.push(o);continue}let l=!1;for(const c of a){const u=c.keypressParts[0],d=c.keypressParts[1],h=c.when;if(this._isTargetedForRemoval(o,u,d,h)){l=!0;break}}if(!l){i.push(o);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const s=i[n];if(s.command===t.command)continue;const o=s.keypressParts.length>1,a=t.keypressParts.length>1;o&&a&&s.keypressParts[1]!==t.keypressParts[1]||Et.whenIsEntirelyIncluded(s.when,t.when)&&this._removeFromLookupMap(s)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:Za(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let n=i.length-1;n>=0;n--){const s=i[n];if(t.contextMatchesRules(s.when))return s}return i[i.length-1]}resolve(e,t,i){this._log(`| Resolving ${i}${t?` chorded from ${t}`:""}`);let n=null;if(t!==null){const o=this._map.get(t);if(typeof o>"u")return this._log("\\ No keybinding entries."),null;n=[];for(let a=0,l=o.length;a<l;a++){const c=o[a];c.keypressParts[1]===i&&n.push(c)}}else{const o=this._map.get(i);if(typeof o>"u")return this._log("\\ No keybinding entries."),null;n=o}const s=this._findCommand(e,n);return s?t===null&&s.keypressParts.length>1&&s.keypressParts[1]!==null?(this._log(`\\ From ${n.length} keybinding entries, matched chord, when: ${Eo(s.when)}, source: ${xo(s)}.`),{enterChord:!0,leaveChord:!1,commandId:null,commandArgs:null,bubble:!1}):(this._log(`\\ From ${n.length} keybinding entries, matched ${s.command}, when: ${Eo(s.when)}, source: ${xo(s)}.`),{enterChord:!1,leaveChord:s.keypressParts.length>1,commandId:s.command,commandArgs:s.commandArgs,bubble:s.bubble}):(this._log(`\\ From ${n.length} keybinding entries, no when clauses matched the context.`),null)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(Et._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function Eo(r){return r?`${r.serialize()}`:"no when condition"}function xo(r){return r.extensionId?r.isBuiltinExtension?`built-in extension ${r.extensionId}`:`user extension ${r.extensionId}`:r.isDefault?"built-in":"user"}class Io{constructor(e,t,i,n,s,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.keypressParts=e?Rn(e.getDispatchParts()):[],e&&this.keypressParts.length===0&&(this.keypressParts=Rn(e.getSingleModifierDispatchParts())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=s,this.extensionId=o,this.isBuiltinExtension=a}}function Rn(r){const e=[];for(let t=0,i=r.length;t<i;t++){const n=r[t];if(!n)return e;e.push(n)}return e}class hh extends el{constructor(e,t){if(super(),t.length===0)throw tl("parts");this._os=e,this._parts=t}getLabel(){return Cr.toLabel(this._os,this._parts,e=>this._getLabel(e))}getAriaLabel(){return il.toLabel(this._os,this._parts,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._parts.length>1||this._parts[0].isDuplicateModifierCase()?null:nl.toLabel(this._os,this._parts,e=>this._getElectronAccelerator(e))}isChord(){return this._parts.length>1}getParts(){return this._parts.map(e=>this._getPart(e))}_getPart(e){return new sl(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchParts(){return this._parts.map(e=>this._getDispatchPart(e))}getSingleModifierDispatchParts(){return this._parts.map(e=>this._getSingleModifierDispatchPart(e))}}class Pt extends hh{constructor(e,t){super(t,e.parts)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return qt.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":qt.toString(e.keyCode)}_getElectronAccelerator(e){return qt.toElectronAccelerator(e.keyCode)}_getDispatchPart(e){return Pt.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=qt.toString(e.keyCode),t}_getSingleModifierDispatchPart(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=rl[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 83;case 52:return 81;case 53:return 87;case 54:return 89;case 55:return 88;case 56:return 0;case 57:return 80;case 58:return 90;case 59:return 86;case 60:return 82;case 61:return 84;case 62:return 85;case 106:return 92}return 0}static _resolveSimpleUserBinding(e){if(!e)return null;if(e instanceof fn)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new fn(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveUserBinding(e,t){const i=Rn(e.map(n=>this._resolveSimpleUserBinding(n)));return i.length>0?[new Pt(new ol(i),t)]:[]}}var ke;(function(r){r[r.AVOID=0]="AVOID",r[r.ALIGN=1]="ALIGN"})(ke||(ke={}));function Ye(r,e,t){const i=t.mode===ke.ALIGN?t.offset:t.offset+t.size,n=t.mode===ke.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=r-i?i:e<=n?n-e:Math.max(r-e,0):e<=n?n-e:e<=r-i?i:0}class st extends I{constructor(e,t){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=I.None,this.toDisposeOnSetContainer=I.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=z(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,$s(this.view),this.setContainer(e,t),this._register(ue(()=>this.setContainer(null,1)))}setContainer(e,t){var i;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,(i=this.shadowRootHostElement)===null||i===void 0||i.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),e){if(this.container=e,this.useFixedPosition=t!==1,this.useShadowDOM=t===3,this.useShadowDOM){this.shadowRootHostElement=z(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const s=document.createElement("style");s.textContent=fh,this.shadowRoot.appendChild(s),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(z("slot"))}else this.container.appendChild(this.view);const n=new G;st.BUBBLE_UP_EVENTS.forEach(s=>{n.add(Lt(this.container,s,o=>{this.onDOMEvent(o,!1)}))}),st.BUBBLE_DOWN_EVENTS.forEach(s=>{n.add(Lt(this.container,s,o=>{this.onDOMEvent(o,!0)},!0))}),this.toDisposeOnSetContainer=n}}show(e){var t,i;this.isVisible()&&this.hide(),ys(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2575",this.view.style.position=this.useFixedPosition?"fixed":"absolute",kr(this.view),this.toDisposeOnClean=e.render(this.view)||I.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)===null||i===void 0||i.call(t)}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(gn&&al.pointerEvents)){this.hide();return}this.delegate.layout&&this.delegate.layout(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(Sr(e)){const d=jt(e),h=ll(e);t={top:d.top*h,left:d.left*h,width:d.width*h,height:d.height*h}}else t={top:e.y,left:e.x,width:e.width||1,height:e.height||2};const i=cl(this.view),n=ul(this.view),s=this.delegate.anchorPosition||0,o=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;if(a===0){const d={offset:t.top-window.pageYOffset,size:t.height,position:s===0?0:1},h={offset:t.left,size:t.width,position:o===0?0:1,mode:ke.ALIGN};l=Ye(window.innerHeight,n,d)+window.pageYOffset,zs.intersects({start:l,end:l+n},{start:d.offset,end:d.offset+d.size})&&(h.mode=ke.AVOID),c=Ye(window.innerWidth,i,h)}else{const d={offset:t.left,size:t.width,position:o===0?0:1},h={offset:t.top,size:t.height,position:s===0?0:1,mode:ke.ALIGN};c=Ye(window.innerWidth,i,d),zs.intersects({start:c,end:c+i},{start:d.offset,end:d.offset+d.size})&&(h.mode=ke.AVOID),l=Ye(window.innerHeight,n,h)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(s===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const u=jt(this.container);this.view.style.top=`${l-(this.useFixedPosition?jt(this.view).top:u.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?jt(this.view).left:u.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),$s(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):t&&!Qe(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}st.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"];st.BUBBLE_DOWN_EVENTS=["click"];const fh=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	@font-face {
		font-family: "codicon";
		font-display: block;
		src: url("./codicon.ttf?5d4d76ab2ce5108968ad644d591a16a6") format("truetype");
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var gh=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},mh=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Pn=class extends I{constructor(e){super(),this.layoutService=e,this.currentViewDisposable=I.None,this.container=e.hasContainer?e.container:null,this.contextView=this._register(new st(this.container,1)),this.layout(),this._register(e.onDidLayout(()=>this.layout()))}setContainer(e,t){this.contextView.setContainer(e,t||1)}showContextView(e,t,i){t?(t!==this.container||this.shadowRoot!==i)&&(this.container=t,this.setContainer(t,i?3:2)):this.layoutService.hasContainer&&this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.shadowRoot=i,this.contextView.show(e);const n=ue(()=>{this.currentViewDisposable===n&&this.hideContextView()});return this.currentViewDisposable=n,n}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}};Pn=gh([mh(0,ut)],Pn);var Lo=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};const ii="**",Do="/",ci="[/\\\\]",ui="[^/\\\\]",ph=/\//g;function To(r,e){switch(r){case 0:return"";case 1:return`${ui}*?`;default:return`(?:${ci}|${ui}+${ci}${e?`|${ci}${ui}+`:""})*?`}}function Mo(r,e){if(!r)return[];const t=[];let i=!1,n=!1,s="";for(const o of r){switch(o){case e:if(!i&&!n){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}s+=o}return s&&t.push(s),t}function na(r){if(!r)return"";let e="";const t=Mo(r,Do);if(t.every(i=>i===ii))e=".*";else{let i=!1;t.forEach((n,s)=>{if(n===ii){if(i)return;e+=To(2,s===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const u of n){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!c?d="^":u===Do?d="":d=Hs(u),c+=d;continue}switch(u){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const h=`(?:${Mo(a,",").map(f=>na(f)).join("|")})`;e+=h,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=ui;continue;case"*":e+=To(1);continue;default:e+=Hs(u)}}s<t.length-1&&(t[s+1]!==ii||s+2<t.length)&&(e+=ci)}i=n===ii})}return e}const _h=/^\*\*\/\*\.[\w\.-]+$/,bh=/^\*\*\/([\w\.-]+)\/?$/,vh=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,yh=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,Ch=/^\*\*((\/[\w\.-]+)+)\/?$/,kh=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Ao=new dl(1e4),Ro=function(){return!1},ce=function(){return null};function Ls(r,e){if(!r)return ce;let t;typeof r!="string"?t=r.pattern:t=r,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=Ao.get(i);if(n)return Po(n,r);let s;return _h.test(t)?n=Sh(t.substr(4),t):(s=bh.exec(en(t,e)))?n=wh(s[1],t):(e.trimForExclusions?yh:vh).test(t)?n=Eh(t,e):(s=Ch.exec(en(t,e)))?n=Oo(s[1].substr(1),t,!0):(s=kh.exec(en(t,e)))?n=Oo(s[1],t,!1):n=xh(t),Ao.set(i,n),Po(n,r)}function Po(r,e){if(typeof e=="string")return r;const t=function(i,n){return fl(i,e.base,!mi)?r(i.substr(e.base.length+1),n):null};return t.allBasenames=r.allBasenames,t.allPaths=r.allPaths,t.basenames=r.basenames,t.patterns=r.patterns,t}function en(r,e){return e.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function Sh(r,e){return function(t,i){return typeof t=="string"&&t.endsWith(r)?e:null}}function wh(r,e){const t=`/${r}`,i=`\\${r}`,n=function(o,a){return typeof o!="string"?null:a?a===r?e:null:o===r||o.endsWith(t)||o.endsWith(i)?e:null},s=[r];return n.basenames=s,n.patterns=[e],n.allBasenames=s,n}function Eh(r,e){const t=oa(r.slice(1,-1).split(",").map(a=>Ls(a,e)).filter(a=>a!==ce),r),i=t.length;if(!i)return ce;if(i===1)return t[0];const n=function(a,l){for(let c=0,u=t.length;c<u;c++)if(t[c](a,l))return r;return null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function Oo(r,e,t){const i=Hi===mn.sep,n=i?r:r.replace(ph,Hi),s=Hi+n,o=mn.sep+r;let a;return t?a=function(l,c){return typeof l=="string"&&(l===n||l.endsWith(s)||!i&&(l===r||l.endsWith(o)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===n||!i&&l===r)?e:null},a.allPaths=[(t?"*/":"./")+r],a}function xh(r){try{const e=new RegExp(`^${na(r)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?r:null}}catch{return ce}}function Ih(r,e,t){return!r||typeof e!="string"?!1:sa(r)(e,void 0,t)}function sa(r,e={}){if(!r)return Ro;if(typeof r=="string"||Lh(r)){const t=Ls(r,e);if(t===ce)return Ro;const i=function(n,s){return!!t(n,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return Dh(r,e)}function Lh(r){const e=r;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function Dh(r,e){const t=oa(Object.getOwnPropertyNames(r).map(a=>Th(a,r[a],e)).filter(a=>a!==ce)),i=t.length;if(!i)return ce;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,d){let h;for(let f=0,g=t.length;f<g;f++){const p=t[f](u,d);if(typeof p=="string")return p;pn(p)&&(h||(h=[]),h.push(p))}return h?(()=>Lo(this,void 0,void 0,function*(){for(const f of h){const g=yield f;if(typeof g=="string")return g}return null}))():null},l=t.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let u,d;for(let h=0,f=t.length;h<f;h++){const g=t[h];g.requiresSiblings&&c&&(l||(l=wr(a)),u||(u=l.substr(0,l.length-hl(a).length)));const p=g(a,l,u,c);if(typeof p=="string")return p;pn(p)&&(d||(d=[]),d.push(p))}return d?(()=>Lo(this,void 0,void 0,function*(){for(const h of d){const f=yield h;if(typeof f=="string")return f}return null}))():null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function Th(r,e,t){if(e===!1)return ce;const i=Ls(r,t);if(i===ce)return ce;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const s=(o,a,l,c)=>{if(!c||!i(o,a))return null;const u=n.replace("$(basename)",l),d=c(u);return pn(d)?d.then(h=>h?r:null):d?r:null};return s.requiresSiblings=!0,s}}return i}function oa(r,e){const t=r.filter(a=>!!a.basenames);if(t.length<2)return r;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const s=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===47||d===92)break}l=a.substr(u)}const c=i.indexOf(l);return c!==-1?n[c]:null};s.basenames=i,s.patterns=n,s.allBasenames=i;const o=r.filter(a=>!a.basenames);return o.push(s),o}let ot=[],Ds=[],ra=[];function ni(r,e=!1){Mh(r,!1,e)}function Mh(r,e,t){const i=Ah(r,e);ot.push(i),i.userConfigured?ra.push(i):Ds.push(i),t&&!i.userConfigured&&ot.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function Ah(r,e){return{id:r.id,mime:r.mime,filename:r.filename,extension:r.extension,filepattern:r.filepattern,firstline:r.firstline,userConfigured:e,filenameLowercase:r.filename?r.filename.toLowerCase():void 0,extensionLowercase:r.extension?r.extension.toLowerCase():void 0,filepatternLowercase:r.filepattern?sa(r.filepattern.toLowerCase()):void 0,filepatternOnPath:r.filepattern?r.filepattern.indexOf(mn.sep)>=0:!1}}function Rh(){ot=ot.filter(r=>r.userConfigured),Ds=[]}function Ph(r,e){return Oh(r,e).map(t=>t.id)}function Oh(r,e){let t;if(r)switch(r.scheme){case N.file:t=r.fsPath;break;case N.data:{t=qs.parseMetaData(r).get(qs.META_DATA_LABEL);break}case N.vscodeNotebookCell:t=void 0;break;default:t=r.path}if(!t)return[{id:"unknown",mime:ft.unknown}];t=t.toLowerCase();const i=wr(t),n=Fo(t,i,ra);if(n)return[n,{id:Xe,mime:ft.text}];const s=Fo(t,i,Ds);if(s)return[s,{id:Xe,mime:ft.text}];if(e){const o=Fh(e);if(o)return[o,{id:Xe,mime:ft.text}]}return[{id:"unknown",mime:ft.unknown}]}function Fo(r,e,t){var i;let n,s,o;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){n=l;break}if(l.filepattern&&(!s||l.filepattern.length>s.filepattern.length)){const c=l.filepatternOnPath?r:e;!((i=l.filepatternLowercase)===null||i===void 0)&&i.call(l,c)&&(s=l)}l.extension&&(!o||l.extension.length>o.extension.length)&&e.endsWith(l.extensionLowercase)&&(o=l)}if(n)return n;if(s)return s;if(o)return o}function Fh(r){if(fr(r)&&(r=r.substr(1)),r.length>0)for(let e=ot.length-1;e>=0;e--){const t=ot[e];if(!t.firstline)continue;const i=r.match(t.firstline);if(i&&i.length>0)return t}}const si=Object.prototype.hasOwnProperty,Bo="vs.editor.nullLanguage";class Bh{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(Bo,0),this._register(Xe,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||Bo}}class Ot extends I{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new _),this.onDidChange=this._onDidChange.event,Ot.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new Bh,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(pi.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){Ot.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Rh();const e=[].concat(pi.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),ct.as(Er.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;si.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)ni({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)ni({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)ni({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);gl(l)||ni({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){_r(l)}}e.aliases.push(i);let s=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?s=[null]:s=t.aliases),s!==null)for(const a of s)!a||a.length===0||e.aliases.push(a);const o=s!==null&&s.length>0;if(!(o&&s[0]===null)){const a=(o?s[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?si.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return si.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&si.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:Ph(e,t)}}Ot.instanceCount=0;class Ft extends I{constructor(e=!1){super(),this._onDidEncounterLanguage=this._register(new _),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event,this._onDidChange=this._register(new _({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,Ft.instanceCount++,this._encounteredLanguages=new Set,this._registry=this._register(new Ot(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){Ft.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return ml(i,null)}createById(e){return new No(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new No(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=Xe),this._encounteredLanguages.has(e)||(this._encounteredLanguages.add(e),W.getOrCreate(e),this._onDidEncounterLanguage.fire(e)),e}}Ft.instanceCount=0;class No{constructor(e,t){this._onDidChangeLanguages=e,this._selector=t,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages(()=>this._evaluate())),this._emitter||(this._emitter=new _({onLastListenerRemove:()=>{this._dispose()}})),this._emitter.event}_evaluate(){var e;const t=this._selector();t!==this.languageId&&(this.languageId=t,(e=this._emitter)===null||e===void 0||e.fire(this.languageId))}}function Ko(r){let e=r.definition;for(;e instanceof nt;)e=e.definition;return`.codicon-${r.id}:before { content: '${e.fontCharacter}'; }`}const On=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,tn=/(&amp;)?(&amp;)([^\s&])/g;var ki;(function(r){r[r.Right=0]="Right",r[r.Left=1]="Left"})(ki||(ki={}));let aa=class di extends _i{constructor(e,t,i={}){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const n=document.createElement("div");n.classList.add("monaco-menu"),n.setAttribute("role","presentation"),super(n,{orientation:1,actionViewItemProvider:a=>this.doGetActionViewItem(a,i,s),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...Cs||mi?[10]:[]],keyDown:!0}}),this.menuElement=n,this.actionsList.tabIndex=0,this.menuDisposables=this._register(new G),this.initializeOrUpdateStyleSheet(e,{}),this._register(_n.addTarget(n)),k(n,x.KEY_DOWN,a=>{new J(a).equals(2)&&a.preventDefault()}),i.enableMnemonics&&this.menuDisposables.add(k(n,x.KEY_DOWN,a=>{const l=a.key.toLocaleLowerCase();if(this.mnemonics.has(l)){B.stop(a,!0);const c=this.mnemonics.get(l);if(c.length===1&&(c[0]instanceof Vo&&c[0].container&&this.focusItemByElement(c[0].container),c[0].onClick(a)),c.length>1){const u=c.shift();u&&u.container&&(this.focusItemByElement(u.container),c.push(u)),this.mnemonics.set(l,c)}}})),mi&&this._register(k(n,x.KEY_DOWN,a=>{const l=new J(a);l.equals(14)||l.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),B.stop(a,!0)):(l.equals(13)||l.equals(12))&&(this.focusedItem=0,this.focusPrevious(),B.stop(a,!0))})),this._register(k(this.domNode,x.MOUSE_OUT,a=>{const l=a.relatedTarget;Qe(l,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),a.stopPropagation())})),this._register(k(this.actionsList,x.MOUSE_OVER,a=>{let l=a.target;if(!(!l||!Qe(l,this.actionsList)||l===this.actionsList)){for(;l.parentElement!==this.actionsList&&l.parentElement!==null;)l=l.parentElement;if(l.classList.contains("action-item")){const c=this.focusedItem;this.setFocusedItem(l),c!==this.focusedItem&&this.updateFocus()}}})),this._register(_n.addTarget(this.actionsList)),this._register(k(this.actionsList,bn.Tap,a=>{let l=a.initialTarget;if(!(!l||!Qe(l,this.actionsList)||l===this.actionsList)){for(;l.parentElement!==this.actionsList&&l.parentElement!==null;)l=l.parentElement;if(l.classList.contains("action-item")){const c=this.focusedItem;this.setFocusedItem(l),c!==this.focusedItem&&this.updateFocus()}}}));const s={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new pl(n,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const o=this.scrollableElement.getDomNode();o.style.position="",this._register(k(n,bn.Change,a=>{B.stop(a,!0);const l=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:l-a.translationY})})),this._register(k(o,x.MOUSE_UP,a=>{a.preventDefault()})),n.style.maxHeight=`${Math.max(10,window.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter(a=>{var l;return!((l=i.submenuIds)===null||l===void 0)&&l.has(a.id)?(console.warn(`Found submenu cycle: ${a.id}`),!1):!0}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(a=>!(a instanceof nn)).forEach((a,l,c)=>{a.updatePositionInSet(l+1,c.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(vn(e)?this.styleSheet=Dt(e):(di.globalStyleSheet||(di.globalStyleSheet=Dt()),this.styleSheet=di.globalStyleSheet)),this.styleSheet.textContent=Kh(t,vn(e))}style(e){const t=this.getContainer();this.initializeOrUpdateStyleSheet(t,e);const i=e.foregroundColor?`${e.foregroundColor}`:"",n=e.backgroundColor?`${e.backgroundColor}`:"",s=e.borderColor?`1px solid ${e.borderColor}`:"",o="5px",a=e.shadowColor?`0 2px 8px ${e.shadowColor}`:"";t.style.outline=s,t.style.borderRadius=o,t.style.color=i,t.style.backgroundColor=n,t.style.boxShadow=a,this.viewItems&&this.viewItems.forEach(l=>{(l instanceof Fn||l instanceof nn)&&l.style(e)})}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof xr)return new nn(t.context,e,{icon:!0});if(e instanceof _l){const n=new Vo(e,e.actions,i,Object.assign(Object.assign({},t),{submenuIds:new Set([...t.submenuIds||[],e.id])}));if(t.enableMnemonics){const s=n.getMnemonic();if(s&&n.isEnabled()){let o=[];this.mnemonics.has(s)&&(o=this.mnemonics.get(s)),o.push(n),this.mnemonics.set(s,o)}}return n}else{const n={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const o=t.getKeyBinding(e);if(o){const a=o.getLabel();a&&(n.keybinding=a)}}const s=new Fn(t.context,e,n);if(t.enableMnemonics){const o=s.getMnemonic();if(o&&s.isEnabled()){let a=[];this.mnemonics.has(o)&&(a=this.mnemonics.get(o)),a.push(s),this.mnemonics.set(o,a)}}return s}}};class Fn extends bl{constructor(e,t,i={}){if(i.isMenu=!0,super(t,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const n=this.getAction().label;if(n){const s=On.exec(n);s&&(this.mnemonic=(s[1]?s[1]:s[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Oe(()=>{this.element&&(this._register(k(this.element,x.MOUSE_UP,n=>{if(B.stop(n,!0),vl){if(new ks(n).rightButton)return;this.onClick(n)}else setTimeout(()=>{this.onClick(n)},0)})),this._register(k(this.element,x.CONTEXT_MENU,n=>{B.stop(n,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=L(this.element,z("a.action-menu-item")),this._action.id===xr.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=L(this.item,z("span.menu-item-check"+nt.menuSelection.cssSelector)),this.check.setAttribute("role","none"),this.label=L(this.item,z("span.action-label")),this.options.label&&this.options.keybinding&&(L(this.item,z("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item&&this.item.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){ys(this.label);let t=yl(this.getAction().label);if(t){const i=Nh(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const n=On.exec(t);if(n){t=Cl(t),tn.lastIndex=0;let s=tn.exec(t);for(;s&&s[1];)s=tn.exec(t);const o=a=>a.replace(/&amp;&amp;/g,"&amp;");s?this.label.append(Ir(o(t.substr(0,s.index))," "),z("u",{"aria-hidden":"true"},s[3]),kl(o(t.substr(s.index+s[0].length))," ")):this.label.innerText=o(t).trim(),(e=this.item)===null||e===void 0||e.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.innerText=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.getAction().class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.getAction().enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.getAction().checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){if(!this.menuStyle)return;const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",s=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t?t.toString():"",this.item.style.backgroundColor=i?i.toString():"",this.item.style.outline=n,this.item.style.outlineOffset=s),this.check&&(this.check.style.color=t?t.toString():"")}style(e){this.menuStyle=e,this.applyStyle()}}class Vo extends Fn{constructor(e,t,i,n){super(e,e,n),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new G),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:ki.Right,this.showScheduler=new Oe(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Oe(()=>{this.element&&!Qe(qi(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=L(this.item,z("span.submenu-indicator"+nt.menuSubmenu.cssSelector)),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(k(this.element,x.KEY_UP,t=>{const i=new J(t);(i.equals(17)||i.equals(3))&&(B.stop(t,!0),this.createSubmenu(!0))})),this._register(k(this.element,x.KEY_DOWN,t=>{const i=new J(t);qi()===this.item&&(i.equals(17)||i.equals(3))&&B.stop(t,!0)})),this._register(k(this.element,x.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(k(this.element,x.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(k(this.element,x.FOCUS_OUT,t=>{this.element&&!Qe(qi(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){B.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const s={top:0,left:0};return s.left=Ye(e.width,t.width,{position:n===ki.Right?0:1,offset:i.left,size:i.width}),s.left>=i.left&&s.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(s.left=i.left+10),i.top+=10,i.height=0),s.top=Ye(e.height,t.height,{position:0,offset:i.top,size:0}),s.top+t.height===i.top&&s.top+i.height+t.height<=e.height&&(s.top+=i.height),s}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=L(this.element,z("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new aa(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new Sl],this.submenuOptions),this.menuStyle&&this.parentData.submenu.style(this.menuStyle);const n=this.element.getBoundingClientRect(),s={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},o=this.submenuContainer.getBoundingClientRect(),{top:a,left:l}=this.calculateSubmenuMenuLayout(new js(window.innerWidth,window.innerHeight),js.lift(o),s,this.expandDirection);this.submenuContainer.style.left=`${l-o.left}px`,this.submenuContainer.style.top=`${a-o.top}px`,this.submenuDisposables.add(k(this.submenuContainer,x.KEY_UP,c=>{new J(c).equals(15)&&(B.stop(c,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(k(this.submenuContainer,x.KEY_DOWN,c=>{new J(c).equals(15)&&B.stop(c,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)===null||t===void 0||t.setAttribute("aria-expanded",e))}applyStyle(){var e;if(super.applyStyle(),!this.menuStyle)return;const i=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=i?`${i}`:""),(e=this.parentData.submenu)===null||e===void 0||e.style(this.menuStyle)}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class nn extends wl{style(e){this.label&&(this.label.style.borderBottomColor=e.separatorColor?`${e.separatorColor}`:"")}}function Nh(r){const e=On,t=e.exec(r);if(!t)return r;const i=!t[1];return r.replace(e,i?"$2$3":"").trim()}function Kh(r,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${Ko(nt.menuSelection)}
${Ko(nt.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar.animated .action-item.active {
	transform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: .6em 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=r.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=r.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const s=r.scrollbarSliderHoverBackground;s&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${s};
				}
			`);const o=r.scrollbarSliderActiveBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${o};
				}
			`)}return t}class Vh{constructor(e,t,i,n,s){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.themeService=s,this.focusToReturn=null,this.block=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=document.activeElement;let i;const n=Sr(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:s=>{const o=e.getMenuClassName?e.getMenuClassName():"";o&&(s.className+=" "+o),this.options.blockMouse&&(this.block=s.appendChild(z(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",k(this.block,x.MOUSE_DOWN,c=>c.stopPropagation()));const a=new G,l=e.actionRunner||new El;return l.onBeforeRun(this.onActionRun,this,a),l.onDidRun(this.onDidActionRun,this,a),i=new aa(s,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:c=>this.keybindingService.lookupKeybinding(c.id)}),a.add(xl(i,this.themeService)),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a),a.add(k(window,x.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(k(window,x.MOUSE_DOWN,c=>{if(c.defaultPrevented)return;const u=new ks(c);let d=u.target;if(!u.rightButton){for(;d;){if(d===s)return;d=d.parentElement}this.contextViewService.hideContextView(!0)}})),Lr(a,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:s=>{var o;(o=e.onHide)===null||o===void 0||o.call(e,!!s),this.block&&(this.block.remove(),this.block=null),this.focusToReturn&&this.focusToReturn.focus()}},n,!!n)}onActionRun(e){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1),this.focusToReturn&&this.focusToReturn.focus()}onDidActionRun(e){e.error&&!Il(e.error)&&this.notificationService.error(e.error)}}var Uh=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},_t=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Bn=class extends I{constructor(e,t,i,n,s){super(),this._onDidShowContextMenu=new _,this._onDidHideContextMenu=new _,this.contextMenuHandler=new Vh(i,e,t,n,s)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},e),{onHide:t=>{var i;(i=e.onHide)===null||i===void 0||i.call(e,t),this._onDidHideContextMenu.fire()}})),Ll.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};Bn=Uh([_t(0,Ti),_t(1,Ee),_t(2,Ss),_t(3,Be),_t(4,Fe)],Bn);var Si;(function(r){r[r.API=0]="API",r[r.USER=1]="USER"})(Si||(Si={}));var Ts=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},wi=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},Ae=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};let Nn=class{constructor(e){this._commandService=e}open(e,t){return Ae(this,void 0,void 0,function*(){if(!Dl(e,N.command))return!1;if(!(t!=null&&t.allowCommands))return!0;typeof e=="string"&&(e=ne.parse(e));let i=[];try{i=Gs(decodeURIComponent(e.query))}catch{try{i=Gs(e.query)}catch{}}return Array.isArray(i)||(i=[i]),yield this._commandService.executeCommand(e.path,...i),!0})}};Nn=Ts([wi(0,xe)],Nn);let Kn=class{constructor(e){this._editorService=e}open(e,t){return Ae(this,void 0,void 0,function*(){typeof e=="string"&&(e=ne.parse(e));const{selection:i,uri:n}=Tl(e);return e=n,e.scheme===N.file&&(e=Ml(e)),yield this._editorService.openCodeEditor({resource:e,options:Object.assign({selection:i,source:t!=null&&t.fromUserGesture?Si.USER:Si.API},t==null?void 0:t.editorOptions)},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0})}};Kn=Ts([wi(0,H)],Kn);let Vn=class{constructor(e,t){this._openers=new vt,this._validators=new vt,this._resolvers=new vt,this._resolvedUriTargets=new te(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new vt,this._defaultExternalOpener={openExternal:i=>Ae(this,void 0,void 0,function*(){return Ys(i,N.http,N.https)?gr(i):window.location.href=i,!0})},this._openers.push({open:(i,n)=>Ae(this,void 0,void 0,function*(){return n!=null&&n.openExternal||Ys(i,N.mailto,N.http,N.https,N.vsls)?(yield this._doOpenExternal(i,n),!0):!1})}),this._openers.push(new Nn(t)),this._openers.push(new Kn(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}registerValidator(e){return{dispose:this._validators.push(e)}}registerExternalUriResolver(e){return{dispose:this._resolvers.push(e)}}setDefaultExternalOpener(e){this._defaultExternalOpener=e}registerExternalOpener(e){return{dispose:this._externalOpeners.push(e)}}open(e,t){var i;return Ae(this,void 0,void 0,function*(){const n=typeof e=="string"?ne.parse(e):e,s=(i=this._resolvedUriTargets.get(n))!==null&&i!==void 0?i:e;for(const o of this._validators)if(!(yield o.shouldOpen(s,t)))return!1;for(const o of this._openers)if(yield o.open(e,t))return!0;return!1})}resolveExternalUri(e,t){return Ae(this,void 0,void 0,function*(){for(const i of this._resolvers)try{const n=yield i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())})}_doOpenExternal(e,t){return Ae(this,void 0,void 0,function*(){const i=typeof e=="string"?ne.parse(e):e;let n;try{n=(yield this.resolveExternalUri(i,t)).resolved}catch{n=i}let s;if(typeof e=="string"&&i.toString()===n.toString()?s=e:s=encodeURI(n.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(yield a.openExternal(s,{sourceUri:i,preferredOpenerId:o},Tt.None))return!0}return this._defaultExternalOpener.openExternal(s,{sourceUri:i},Tt.None)})}dispose(){this._validators.clear()}};Vn=Ts([wi(0,H),wi(1,xe)],Vn);var Wh=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Uo=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};class $h extends I{constructor(e){super(),this.model=e,this._markersData=new Map,this._register(ue(()=>{this.model.deltaDecorations([...this._markersData.keys()],[]),this._markersData.clear()}))}update(e,t){const i=[...this._markersData.keys()];this._markersData.clear();const n=this.model.deltaDecorations(i,t);for(let s=0;s<n.length;s++)this._markersData.set(n[s],e[s]);return i.length!==0||n.length!==0}getMarker(e){return this._markersData.get(e.id)}}let Un=class extends I{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new _),this._markerDecorations=new te,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new $h(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var t;const i=this._markerDecorations.get(e.uri);i&&(i.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===N.inMemory||e.uri.scheme===N.internal||e.uri.scheme===N.vscode)&&((t=this._markerService)===null||t===void 0||t.read({resource:e.uri}).map(n=>n.owner).forEach(n=>this._markerService.remove(n,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500}),i=t.map(n=>({range:this._createDecorationRange(e.model,n),options:this._createDecorationOption(n)}));e.update(t,i)&&this._onDidChangeMarker.fire(e.model)}_createDecorationRange(e,t){let i=U.lift(t);if(t.severity===be.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const s=e.getWordAtPosition(i.getStartPosition());s&&(i=new U(i.startLineNumber,s.startColumn,i.endLineNumber,s.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new U(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,s,o;switch(e.severity){case be.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case be.Warning:t="squiggly-warning",i=gt(Bl),n=20,o={color:gt(Rl),position:Qs.Inline};break;case be.Info:t="squiggly-info",i=gt(Fl),n=10;break;case be.Error:default:t="squiggly-error",i=gt(Ol),n=30,o={color:gt(Al),position:Qs.Inline};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(s="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(s="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:Pl.Right},minimap:o,zIndex:n,inlineClassName:s}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}};Un=Wh([Uo(0,X),Uo(1,Ne)],Un);const zh={buttonBackground:ge.fromHex("#0E639C"),buttonHoverBackground:ge.fromHex("#006BB3"),buttonSeparator:ge.white,buttonForeground:ge.white};class Wo extends I{constructor(e,t){super(),this._onDidClick=this._register(new _),this.options=t||Object.create(null),hs(this.options,zh,!1),this.buttonForeground=this.options.buttonForeground,this.buttonBackground=this.options.buttonBackground,this.buttonHoverBackground=this.options.buttonHoverBackground,this.buttonSecondaryForeground=this.options.buttonSecondaryForeground,this.buttonSecondaryBackground=this.options.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=this.options.buttonSecondaryHoverBackground,this.buttonBorder=this.options.buttonBorder,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),e.appendChild(this._element),this._register(_n.addTarget(this._element)),[x.CLICK,bn.Tap].forEach(i=>{this._register(k(this._element,i,n=>{if(!this.enabled){B.stop(n);return}this._onDidClick.fire(n)}))}),this._register(k(this._element,x.KEY_DOWN,i=>{const n=new J(i);let s=!1;this.enabled&&(n.equals(3)||n.equals(10))?(this._onDidClick.fire(i),s=!0):n.equals(9)&&(this._element.blur(),s=!0),s&&B.stop(n,!0)})),this._register(k(this._element,x.MOUSE_OVER,i=>{this._element.classList.contains("disabled")||this.setHoverBackground()})),this._register(k(this._element,x.MOUSE_OUT,i=>{this.applyStyles()})),this.focusTracker=this._register(Dr(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.setHoverBackground()})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.applyStyles()})),this.applyStyles()}get onDidClick(){return this._onDidClick.event}setHoverBackground(){let e;this.options.secondary?e=this.buttonSecondaryHoverBackground?this.buttonSecondaryHoverBackground.toString():null:e=this.buttonHoverBackground?this.buttonHoverBackground.toString():null,e&&(this._element.style.backgroundColor=e)}style(e){this.buttonForeground=e.buttonForeground,this.buttonBackground=e.buttonBackground,this.buttonHoverBackground=e.buttonHoverBackground,this.buttonSecondaryForeground=e.buttonSecondaryForeground,this.buttonSecondaryBackground=e.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=e.buttonSecondaryHoverBackground,this.buttonBorder=e.buttonBorder,this.applyStyles()}applyStyles(){if(this._element){let e,t;this.options.secondary?(t=this.buttonSecondaryForeground?this.buttonSecondaryForeground.toString():"",e=this.buttonSecondaryBackground?this.buttonSecondaryBackground.toString():""):(t=this.buttonForeground?this.buttonForeground.toString():"",e=this.buttonBackground?this.buttonBackground.toString():"");const i=this.buttonBorder?this.buttonBorder.toString():"";this._element.style.color=t,this._element.style.backgroundColor=e,this._element.style.borderWidth=i?"1px":"",this._element.style.borderStyle=i?"solid":"",this._element.style.borderColor=i}}get element(){return this._element}set label(e){this._element.classList.add("monaco-text-button"),this.options.supportIcons?ws(this._element,...Tr(e)):this._element.textContent=e,typeof this.options.title=="string"?this._element.title=this.options.title:this.options.title&&(this._element.title=e)}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}const $o="done",zo="active",sn="infinite",on="infinite-long-running",Ho="discrete",Hh={progressBarBackground:ge.fromHex("#0E70C0")};class Ni extends I{constructor(e,t){super(),this.options=t||Object.create(null),hs(this.options,Hh,!1),this.workedVal=0,this.progressBarBackground=this.options.progressBarBackground,this.showDelayedScheduler=this._register(new Oe(()=>kr(this.element),0)),this.longRunningScheduler=this._register(new Oe(()=>this.infiniteLongRunning(),Ni.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e)}create(e){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.element.appendChild(this.bit),this.applyStyles()}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(zo,sn,on,Ho),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add($o),this.element.classList.contains(sn)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Ho,$o,on),this.element.classList.add(zo,sn),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(on)}getContainer(){return this.element}style(e){this.progressBarBackground=e.progressBarBackground,this.applyStyles()}applyStyles(){if(this.bit){const e=this.progressBarBackground?this.progressBarBackground.toString():"";this.bit.style.backgroundColor=e}}}Ni.LONG_RUNNING_INFINITE_THRESHOLD=1e4;const rn={},qh=new Nl("quick-input-button-icon-");function Wn(r){if(!r)return;let e;const t=r.dark.toString();return rn[t]?e=rn[t]:(e=qh.nextId(),Xs(`.${e}, .hc-light .${e}`,`background-image: ${yn(r.light||r.dark)}`),Xs(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${yn(r.dark)}`),rn[t]=e),e}const jh=z;class Gh extends I{constructor(e){super(),this.parent=e,this.onKeyDown=t=>k(this.inputBox.inputElement,x.KEY_DOWN,i=>{t(new J(i))}),this.onMouseDown=t=>k(this.inputBox.inputElement,x.MOUSE_DOWN,i=>{t(new ks(i))}),this.onDidChange=t=>this.inputBox.onDidChange(t),this.container=L(this.parent,jh(".quick-input-box")),this.inputBox=this._register(new Kl(this.container,void 0))}get value(){return this.inputBox.value}set value(e){this.inputBox.value=e}select(e=null){this.inputBox.select(e)}isSelectionAtEnd(){return this.inputBox.isSelectionAtEnd()}get placeholder(){return this.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.inputBox.setPlaceHolder(e)}get ariaLabel(){return this.inputBox.getAriaLabel()}set ariaLabel(e){this.inputBox.setAriaLabel(e)}get password(){return this.inputBox.inputElement.type==="password"}set password(e){this.inputBox.inputElement.type=e?"password":"text"}setAttribute(e,t){this.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===j.Ignore?this.inputBox.hideMessage():this.inputBox.showMessage({type:e===j.Info?1:e===j.Warning?2:3,content:""})}stylesForType(e){return this.inputBox.stylesForType(e===j.Info?1:e===j.Warning?2:3)}setFocus(){this.inputBox.focus()}layout(){this.inputBox.layout()}style(e){this.inputBox.style(e)}}const oi=z;class Ms{constructor(e,t,i){this.os=t,this.keyElements=new Set,this.options=i||Object.create(null),this.labelBackground=this.options.keybindingLabelBackground,this.labelForeground=this.options.keybindingLabelForeground,this.labelBorder=this.options.keybindingLabelBorder,this.labelBottomBorder=this.options.keybindingLabelBottomBorder,this.labelShadow=this.options.keybindingLabelShadow,this.domNode=L(e,oi(".monaco-keybinding")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&Ms.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const[e,t]=this.keybinding.getParts();e&&this.renderPart(this.domNode,e,this.matches?this.matches.firstPart:null),t&&(L(this.domNode,oi("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderPart(this.domNode,t,this.matches?this.matches.chordPart:null)),this.domNode.title=this.keybinding.getAriaLabel()||""}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.applyStyles(),this.didEverRender=!0}clear(){ys(this.domNode),this.keyElements.clear()}renderPart(e,t,i){const n=Cr.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,Boolean(i==null?void 0:i.ctrlKey),n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,Boolean(i==null?void 0:i.shiftKey),n.separator),t.altKey&&this.renderKey(e,n.altKey,Boolean(i==null?void 0:i.altKey),n.separator),t.metaKey&&this.renderKey(e,n.metaKey,Boolean(i==null?void 0:i.metaKey),n.separator);const s=t.keyLabel;s&&this.renderKey(e,s,Boolean(i==null?void 0:i.keyCode),"")}renderKey(e,t,i,n){L(e,this.createKeyElement(t,i?".highlight":"")),n&&L(e,oi("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){L(e,this.createKeyElement(E("unbound","Unbound")))}createKeyElement(e,t=""){const i=oi("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),i}style(e){this.labelBackground=e.keybindingLabelBackground,this.labelForeground=e.keybindingLabelForeground,this.labelBorder=e.keybindingLabelBorder,this.labelBottomBorder=e.keybindingLabelBottomBorder,this.labelShadow=e.keybindingLabelShadow,this.applyStyles()}applyStyles(){var e;if(this.element){for(const t of this.keyElements)this.labelBackground&&(t.style.backgroundColor=(e=this.labelBackground)===null||e===void 0?void 0:e.toString()),this.labelBorder&&(t.style.borderColor=this.labelBorder.toString()),this.labelBottomBorder&&(t.style.borderBottomColor=this.labelBottomBorder.toString()),this.labelShadow&&(t.style.boxShadow=`inset 0 -1px 0 ${this.labelShadow}`);this.labelForeground&&(this.element.style.color=this.labelForeground.toString())}}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&hn(e.firstPart,t.firstPart)&&hn(e.chordPart,t.chordPart)}}const qo=new Mi(()=>{const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}});new Mi(()=>({collator:new Intl.Collator(void 0,{numeric:!0})}));new Mi(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function Yh(r,e,t=!1){const i=r||"",n=e||"",s=qo.value.collator.compare(i,n);return qo.value.collatorIsNumeric&&s===0&&i!==n?i<n?-1:1:s}function Qh(r,e,t){const i=r.toLowerCase(),n=e.toLowerCase(),s=Xh(r,e,t);if(s)return s;const o=i.endsWith(t),a=n.endsWith(t);if(o!==a)return o?-1:1;const l=Yh(i,n);return l!==0?l:i.localeCompare(n)}function Xh(r,e,t){const i=r.toLowerCase(),n=e.toLowerCase(),s=i.startsWith(t),o=n.startsWith(t);if(s!==o)return s?-1:1;if(s&&o){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var la=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Jh=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};const re=z;class Zh{constructor(e){this.hidden=!1,this._onChecked=new _,this.onChecked=this._onChecked.event,Object.assign(this,e)}get checked(){return!!this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire(e))}dispose(){this._onChecked.dispose()}}class Ht{get templateId(){return Ht.ID}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=[],t.toDisposeTemplate=[],t.entry=L(e,re(".quick-input-list-entry"));const i=L(t.entry,re("label.quick-input-list-label"));t.toDisposeTemplate.push(Lt(i,x.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=L(i,re("input.quick-input-list-checkbox")),t.checkbox.type="checkbox",t.toDisposeTemplate.push(Lt(t.checkbox,x.CHANGE,c=>{t.element.checked=t.checkbox.checked}));const n=L(i,re(".quick-input-list-rows")),s=L(n,re(".quick-input-list-row")),o=L(n,re(".quick-input-list-row"));t.label=new Js(s,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0});const a=L(s,re(".quick-input-list-entry-keybinding"));t.keybinding=new Ms(a,li);const l=L(o,re(".quick-input-list-label-meta"));return t.detail=new Js(l,{supportHighlights:!0,supportIcons:!0}),t.separator=L(t.entry,re(".quick-input-list-separator")),t.actionBar=new _i(t.entry),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.push(t.actionBar),t}renderElement(e,t,i){i.toDisposeElement=le(i.toDisposeElement),i.element=e,i.checkbox.checked=e.checked,i.toDisposeElement.push(e.onChecked(c=>i.checkbox.checked=c));const{labelHighlights:n,descriptionHighlights:s,detailHighlights:o}=e,a=Object.create(null);a.matches=n||[],a.descriptionTitle=e.saneDescription,a.descriptionMatches=s||[],a.extraClasses=e.item.iconClasses,a.italic=e.item.italic,a.strikethrough=e.item.strikethrough,i.label.setLabel(e.saneLabel,e.saneDescription,a),i.keybinding.set(e.item.keybinding),e.saneDetail&&i.detail.setLabel(e.saneDetail,void 0,{matches:o,title:e.saneDetail}),e.separator&&e.separator.label?(i.separator.textContent=e.separator.label,i.separator.style.display=""):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!e.separator),i.actionBar.clear();const l=e.item.buttons;l&&l.length?(i.actionBar.push(l.map((c,u)=>{let d=c.iconClass||(c.iconPath?Wn(c.iconPath):void 0);c.alwaysVisible&&(d=d?`${d} always-visible`:"always-visible");const h=new Cn(`id-${u}`,"",d,!0,()=>Jh(this,void 0,void 0,function*(){e.fireButtonTriggered({button:c,item:e.item})}));return h.tooltip=c.tooltip||"",h}),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){i.toDisposeElement=le(i.toDisposeElement)}disposeTemplate(e){e.toDisposeElement=le(e.toDisposeElement),e.toDisposeTemplate=le(e.toDisposeTemplate)}}Ht.ID="listelement";class ef{getHeight(e){return e.saneDetail?44:22}getTemplateId(e){return Ht.ID}}var O;(function(r){r[r.First=1]="First",r[r.Second=2]="Second",r[r.Last=3]="Last",r[r.Next=4]="Next",r[r.Previous=5]="Previous",r[r.NextPage=6]="NextPage",r[r.PreviousPage=7]="PreviousPage"})(O||(O={}));class As{constructor(e,t,i){this.parent=e,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnLabelMode="fuzzy",this.matchOnMeta=!0,this.sortByLabel=!0,this._onChangedAllVisibleChecked=new _,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new _,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new _,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new _,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new _,this.onButtonTriggered=this._onButtonTriggered.event,this._onKeyDown=new _,this.onKeyDown=this._onKeyDown.event,this._onLeave=new _,this.onLeave=this._onLeave.event,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=t,this.container=L(this.parent,re(".quick-input-list"));const n=new ef,s=new sf;this.list=i.createList("QuickInput",this.container,n,[new Ht],{identityProvider:{getId:o=>o.saneLabel},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:s}),this.list.getHTMLElement().id=t,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown(o=>{const a=new J(o);switch(a.keyCode){case 10:this.toggleCheckbox();break;case 31:(Cs?o.metaKey:o.ctrlKey)&&this.list.setFocus(Vl(this.list.length));break;case 16:{const l=this.list.getFocus();l.length===1&&l[0]===0&&this._onLeave.fire();break}case 18:{const l=this.list.getFocus();l.length===1&&l[0]===this.list.length-1&&this._onLeave.fire();break}}this._onKeyDown.fire(a)})),this.disposables.push(this.list.onMouseDown(o=>{o.browserEvent.button!==2&&o.browserEvent.preventDefault()})),this.disposables.push(k(this.container,x.CLICK,o=>{(o.x||o.y)&&this._onLeave.fire()})),this.disposables.push(this.list.onMouseMiddleClick(o=>{this._onLeave.fire()})),this.disposables.push(this.list.onContextMenu(o=>{typeof o.index=="number"&&(o.browserEvent.preventDefault(),this.list.setSelection([o.index]))})),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return gi.map(this.list.onDidChangeFocus,e=>e.elements.map(t=>t.item))}get onDidChangeSelection(){return gi.map(this.list.onDidChangeSelection,e=>({items:e.elements.map(t=>t.item),event:e.browserEvent}))}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const s=e[i];if(!s.hidden)if(s.checked)t=!0;else return!1}return t}getCheckedCount(){let e=0;const t=this.elements;for(let i=0,n=t.length;i<n;i++)t[i].checked&&e++;return e}getVisibleCount(){let e=0;const t=this.elements;for(let i=0,n=t.length;i<n;i++)t[i].hidden||e++;return e}setAllVisibleChecked(e){try{this._fireCheckedEvents=!1,this.elements.forEach(t=>{t.hidden||(t.checked=e)})}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(e){this.elementDisposables=le(this.elementDisposables);const t=i=>this.fireButtonTriggered(i);this.inputElements=e,this.elements=e.reduce((i,n,s)=>{var o,a,l;if(n.type!=="separator"){const c=s&&e[s-1],u=n.label&&n.label.replace(/\r?\n/g," "),d=We(u).text.trim(),h=n.meta&&n.meta.replace(/\r?\n/g," "),f=n.description&&n.description.replace(/\r?\n/g," "),g=n.detail&&n.detail.replace(/\r?\n/g," "),p=n.ariaLabel||[u,f,g].map(w=>Ul(w)).filter(w=>!!w).join(", "),v=this.parent.classList.contains("show-checkboxes");i.push(new Zh({hasCheckbox:v,index:s,item:n,saneLabel:u,saneSortLabel:d,saneMeta:h,saneAriaLabel:p,saneDescription:f,saneDetail:g,labelHighlights:(o=n.highlights)===null||o===void 0?void 0:o.label,descriptionHighlights:(a=n.highlights)===null||a===void 0?void 0:a.description,detailHighlights:(l=n.highlights)===null||l===void 0?void 0:l.detail,checked:!1,separator:c&&c.type==="separator"?c:void 0,fireButtonTriggered:t}))}return i},[]),this.elementDisposables.push(...this.elements),this.elementDisposables.push(...this.elements.map(i=>i.onChecked(()=>this.fireCheckedEvents()))),this.elementsToIndexes=this.elements.reduce((i,n,s)=>(i.set(n.item,s),i),new Map),this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map(e=>e.item)}setFocusedElements(e){if(this.list.setFocus(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t))),e.length>0){const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){this.list.setSelection(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t)))}getCheckedElements(){return this.elements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){try{this._fireCheckedEvents=!1;const t=new Set;for(const i of e)t.add(i);for(const i of this.elements)i.checked=t.has(i.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(e){this.list.getHTMLElement().style.pointerEvents=e?"":"none"}focus(e){if(!this.list.length)return;switch(e===O.Next&&this.list.getFocus()[0]===this.list.length-1&&(e=O.First),e===O.Previous&&this.list.getFocus()[0]===0&&(e=O.Last),e===O.Second&&this.list.length<2&&(e=O.First),e){case O.First:this.list.focusFirst();break;case O.Second:this.list.focusNth(1);break;case O.Last:this.list.focusLast();break;case O.Next:this.list.focusNext();break;case O.Previous:this.list.focusPrevious();break;case O.NextPage:this.list.focusNextPage();break;case O.PreviousPage:this.list.focusPreviousPage();break}const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}layout(e){this.list.getHTMLElement().style.maxHeight=e?`calc(${Math.floor(e/44)*44}px)`:"",this.list.layout()}filter(e){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this.elements.forEach(n=>{n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=!1;const s=n.index&&this.inputElements[n.index-1];n.separator=s&&s.type==="separator"?s:void 0});else{let n;this.elements.forEach(s=>{let o;this.matchOnLabelMode==="fuzzy"?o=this.matchOnLabel?ze(Gt(e,We(s.saneLabel))):void 0:o=this.matchOnLabel?ze(tf(t,We(s.saneLabel))):void 0;const a=this.matchOnDescription?ze(Gt(e,We(s.saneDescription||""))):void 0,l=this.matchOnDetail?ze(Gt(e,We(s.saneDetail||""))):void 0,c=this.matchOnMeta?ze(Gt(e,We(s.saneMeta||""))):void 0;if(o||a||l||c?(s.labelHighlights=o,s.descriptionHighlights=a,s.detailHighlights=l,s.hidden=!1):(s.labelHighlights=void 0,s.descriptionHighlights=void 0,s.detailHighlights=void 0,s.hidden=!s.item.alwaysShow),s.separator=void 0,!this.sortByLabel){const u=s.index&&this.inputElements[s.index-1];n=u&&u.type==="separator"?u:n,n&&!s.hidden&&(s.separator=n,n=void 0)}})}const i=this.elements.filter(n=>!n.hidden);if(this.sortByLabel&&e){const n=e.toLowerCase();i.sort((s,o)=>nf(s,o,n))}return this.elementsToIndexes=i.reduce((n,s,o)=>(n.set(s.item,o),n),new Map),this.list.splice(0,this.list.length,i),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(i.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const e=this.list.getFocusedElements(),t=this.allVisibleChecked(e);for(const i of e)i.checked=!t}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(e){this.container.style.display=e?"":"none"}isDisplayed(){return this.container.style.display!=="none"}dispose(){this.elementDisposables=le(this.elementDisposables),this.disposables=le(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(e){this._onButtonTriggered.fire(e)}style(e){this.list.style(e)}}la([Mr],As.prototype,"onDidChangeFocus",null);la([Mr],As.prototype,"onDidChangeSelection",null);function tf(r,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return jo(r,t);const n=Ir(t," "),s=t.length-n.length,o=jo(r,n);if(o)for(const a of o){const l=i[a.start+s]+s;a.start+=l,a.end+=l}return o}function jo(r,e){const t=e.toLowerCase().indexOf(r.toLowerCase());return t!==-1?[{start:t,end:t+r.length}]:null}function nf(r,e,t){const i=r.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:Qh(r.saneSortLabel,e.saneSortLabel,t)}class sf{getWidgetAriaLabel(){return E("quickInput","Quick Input")}getAriaLabel(e){var t;return!((t=e.separator)===null||t===void 0)&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(e.hasCheckbox)return{value:e.checked,onDidChange:e.onChecked}}}var Go=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};const Q=z,$n={iconClass:nt.quickInputBack.classNames,tooltip:E("quickInput.back","Back"),handle:-1};class Ki extends I{constructor(e){super(),this.ui=e,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.noValidationMessage=Ki.noPromptMessage,this._severity=j.Ignore,this.buttonsUpdated=!1,this.onDidTriggerButtonEmitter=this._register(new _),this.onDidHideEmitter=this._register(new _),this.onDisposeEmitter=this._register(new _),this.visibleDisposables=this._register(new G),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!gn;this._ignoreFocusOut=e&&!gn,t&&this.update()}get buttons(){return this._buttons}set buttons(e){this._buttons=e,this.buttonsUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=kn.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}update(){if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this.busy&&!this.busyDelay&&(this.busyDelay=new yr,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const n=this.buttons.filter(o=>o===$n);this.ui.leftActionBar.push(n.map((o,a)=>{const l=new Cn(`id-${a}`,"",o.iconClass||Wn(o.iconPath),!0,()=>Go(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(o)}));return l.tooltip=o.tooltip||"",l}),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const s=this.buttons.filter(o=>o!==$n);this.ui.rightActionBar.push(s.map((o,a)=>{const l=new Cn(`id-${a}`,"",o.iconClass||Wn(o.iconPath),!0,()=>Go(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(o)}));return l.tooltip=o.tooltip||"",l}),{icon:!0,label:!1})}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,ws(this.ui.message,...Tr(i))),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?E("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==j.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}Ki.noPromptMessage=E("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");class Bt extends Ki{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new _),this.onWillAcceptEmitter=this._register(new _),this.onDidAcceptEmitter=this._register(new _),this.onDidCustomEmitter=this._register(new _),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=this.ui.isScreenReaderOptimized()?fe.NONE:fe.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new _),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new _),this.onDidTriggerItemButtonEmitter=this._register(new _),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(e){this._autoFocusOnList=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?Wl:this.ui.keyMods}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(O.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.inputBox.onMouseDown(e=>{this.autoFocusOnList||this.ui.list.clearFocus()})),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown(e=>{switch(e.keyCode){case 18:this.ui.list.focus(O.Next),this.canSelectMany&&this.ui.list.domFocus(),B.stop(e,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(O.Previous):this.ui.list.focus(O.Last),this.canSelectMany&&this.ui.list.domFocus(),B.stop(e,!0);break;case 12:this.ui.list.focus(O.NextPage),this.canSelectMany&&this.ui.list.domFocus(),B.stop(e,!0);break;case 11:this.ui.list.focus(O.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),B.stop(e,!0);break;case 17:if(!this._canAcceptInBackground||!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(O.First),B.stop(e,!0));break;case 13:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(O.Last),B.stop(e,!0));break}})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this.ui.list.onDidChangeFocus(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&Ct(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&Ct(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(t instanceof MouseEvent&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&Ct(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e)))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return k(this.ui.container,x.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new J(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const[a,l]=o.getParts();return l?!1:a.shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a.altKey&&i===6||a.ctrlKey&&i===5||a.metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this._hideInput&&this._items.length>0;this.ui.container.classList.toggle("hidden-input",t&&!this.description);const i={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!t,progressBar:!t,visibleCount:!0,count:this.canSelectMany,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;if(n||(n=this.placeholder||Bt.DEFAULT_ARIA_LABEL,this.title&&(n+=` - ${this.title}`)),this.ui.inputBox.ariaLabel!==n&&(this.ui.inputBox.ariaLabel=n),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case fe.NONE:this._itemActivation=fe.FIRST;break;case fe.SECOND:this.ui.list.focus(O.Second),this._itemActivation=fe.FIRST;break;case fe.LAST:this.ui.list.focus(O.Last),this._itemActivation=fe.FIRST;break;default:this.trySelectFirst();break}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",this.ui.setComboboxAccessibility(!0),i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(O.First)),this.keepScrollPosition&&(this.scrollTop=e)}}Bt.DEFAULT_ARIA_LABEL=E("quickInputBox.ariaLabel","Type to narrow down results.");class Vi extends I{constructor(e){super(),this.options=e,this.comboboxAccessibility=!1,this.enabled=!0,this.onDidAcceptEmitter=this._register(new _),this.onDidCustomEmitter=this._register(new _),this.onDidTriggerButtonEmitter=this._register(new _),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new _),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new _),this.onHide=this.onHideEmitter.event,this.idPrefix=e.idPrefix,this.parentElement=e.container,this.styles=e.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const e=t=>{this.keyMods.ctrlCmd=t.ctrlKey||t.metaKey,this.keyMods.alt=t.altKey};this._register(k(window,x.KEY_DOWN,e,!0)),this._register(k(window,x.KEY_UP,e,!0)),this._register(k(window,x.MOUSE_DOWN,e,!0))}getUI(){if(this.ui)return this.ui;const e=L(this.parentElement,Q(".quick-input-widget.show-file-icons"));e.tabIndex=-1,e.style.display="none";const t=Dt(e),i=L(e,Q(".quick-input-titlebar")),n=this._register(new _i(i));n.domNode.classList.add("quick-input-left-action-bar");const s=L(i,Q(".quick-input-title")),o=this._register(new _i(i));o.domNode.classList.add("quick-input-right-action-bar");const a=L(e,Q(".quick-input-description")),l=L(e,Q(".quick-input-header")),c=L(l,Q("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",E("quickInput.checkAll","Toggle all checkboxes")),this._register(Lt(c,x.CHANGE,y=>{const K=c.checked;F.setAllVisibleChecked(K)})),this._register(k(c,x.CLICK,y=>{(y.x||y.y)&&f.setFocus()}));const u=L(l,Q(".quick-input-description")),d=L(l,Q(".quick-input-and-message")),h=L(d,Q(".quick-input-filter")),f=this._register(new Gh(h));f.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=L(h,Q(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const p=new Zs(g,{countFormat:E({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")}),v=L(h,Q(".quick-input-count"));v.setAttribute("aria-live","polite");const w=new Zs(v,{countFormat:E({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")}),S=L(l,Q(".quick-input-action")),b=new Wo(S);b.label=E("ok","OK"),this._register(b.onDidClick(y=>{this.onDidAcceptEmitter.fire()}));const C=L(l,Q(".quick-input-action")),Y=new Wo(C);Y.label=E("custom","Custom"),this._register(Y.onDidClick(y=>{this.onDidCustomEmitter.fire()}));const Le=L(d,Q(`#${this.idPrefix}message.quick-input-message`)),F=this._register(new As(e,this.idPrefix+"list",this.options));this._register(F.onChangedAllVisibleChecked(y=>{c.checked=y})),this._register(F.onChangedVisibleCount(y=>{p.setCount(y)})),this._register(F.onChangedCheckedCount(y=>{w.setCount(y)})),this._register(F.onLeave(()=>{setTimeout(()=>{f.setFocus(),this.controller instanceof Bt&&this.controller.canSelectMany&&F.clearFocus()},0)})),this._register(F.onDidChangeFocus(()=>{this.comboboxAccessibility&&this.getUI().inputBox.setAttribute("aria-activedescendant",this.getUI().list.getActiveDescendant()||"")}));const dt=new Ni(e);dt.getContainer().classList.add("quick-input-progress");const T=Dr(e);return this._register(T),this._register(k(e,x.FOCUS,y=>{this.previousFocusElement=y.relatedTarget instanceof HTMLElement?y.relatedTarget:void 0},!0)),this._register(T.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(kn.Blur),this.previousFocusElement=void 0})),this._register(k(e,x.FOCUS,y=>{f.setFocus()})),this._register(k(e,x.KEY_DOWN,y=>{const K=new J(y);switch(K.keyCode){case 3:B.stop(y,!0),this.onDidAcceptEmitter.fire();break;case 9:B.stop(y,!0),this.hide(kn.Gesture);break;case 2:if(!K.altKey&&!K.ctrlKey&&!K.metaKey){const Ke=[".action-label.codicon"];e.classList.contains("show-checkboxes")?Ke.push("input"):Ke.push("input[type=text]"),this.getUI().list.isDisplayed()&&Ke.push(".monaco-list");const Ve=e.querySelectorAll(Ke.join(", "));K.shiftKey&&K.target===Ve[0]?(B.stop(y,!0),Ve[Ve.length-1].focus()):!K.shiftKey&&K.target===Ve[Ve.length-1]&&(B.stop(y,!0),Ve[0].focus())}break}})),this.ui={container:e,styleSheet:t,leftActionBar:n,titleBar:i,title:s,description1:a,description2:u,rightActionBar:o,checkAll:c,filterContainer:h,inputBox:f,visibleCountContainer:g,visibleCount:p,countContainer:v,count:w,okContainer:S,ok:b,message:Le,customButtonContainer:C,customButton:Y,list:F,progressBar:dt,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,isScreenReaderOptimized:()=>this.options.isScreenReaderOptimized(),show:y=>this.show(y),hide:()=>this.hide(),setVisibilities:y=>this.setVisibilities(y),setComboboxAccessibility:y=>this.setComboboxAccessibility(y),setEnabled:y=>this.setEnabled(y),setContextKey:y=>this.options.setContextKey(y)},this.updateStyles(),this.ui}pick(e,t={},i=Tt.None){return new Promise((n,s)=>{let o=u=>{var d;o=n,(d=t.onKeyMods)===null||d===void 0||d.call(t,a.keyMods),n(u)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick();let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const u=a.activeItems[0];u&&(o(u),a.hide())}}),a.onDidChangeActive(u=>{const d=u[0];d&&t.onDidFocus&&t.onDidFocus(d)}),a.onDidChangeSelection(u=>{if(!a.canSelectMany){const d=u[0];d&&(o(d),a.hide())}}),a.onDidTriggerItemButton(u=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton(Object.assign(Object.assign({},u),{removeItem:()=>{const d=a.items.indexOf(u.item);if(d!==-1){const h=a.items.slice(),f=h.splice(d,1),g=a.activeItems.filter(v=>v!==f[0]),p=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=h,g&&(a.activeItems=g),a.keepScrollPosition=p}}}))),a.onDidChangeValue(u=>{l&&!u&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{le(c),o(void 0)})];a.title=t.title,a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.autoFocusOnList=t.autoFocusOnList===void 0||t.autoFocusOnList,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([u,d])=>{l=d,a.busy=!1,a.items=u,a.canSelectMany&&(a.selectedItems=u.filter(h=>h.type!=="separator"&&h.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,u=>{s(u),a.hide()})})}createQuickPick(){const e=this.getUI();return new Bt(e)}show(e){const t=this.getUI();this.onShowEmitter.fire();const i=this.controller;this.controller=e,i&&i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",t.rightActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(j.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),ws(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,this.setComboboxAccessibility(!1),t.inputBox.ariaLabel="";const n=this.options.backKeybindingLabel();$n.tooltip=n?E("quickInput.backWithKeybinding","Back ({0})",n):E("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus()}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.display(!!e.list),t.container.classList[e.checkBox?"add":"remove"]("show-checkboxes"),this.updateLayout()}setComboboxAccessibility(e){if(e!==this.comboboxAccessibility){const t=this.getUI();this.comboboxAccessibility=e,this.comboboxAccessibility?(t.inputBox.setAttribute("role","combobox"),t.inputBox.setAttribute("aria-haspopup","true"),t.inputBox.setAttribute("aria-autocomplete","list"),t.inputBox.setAttribute("aria-activedescendant",t.list.getActiveDescendant()||"")):(t.inputBox.removeAttribute("role"),t.inputBox.removeAttribute("aria-haspopup"),t.inputBox.removeAttribute("aria-autocomplete"),t.inputBox.removeAttribute("aria-activedescendant"))}}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.getAction().enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.getAction().enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var t;const i=this.controller;if(i){const n=!(!((t=this.ui)===null||t===void 0)&&t.container.contains(document.activeElement));if(this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",!n){let s=this.previousFocusElement;for(;s&&!s.offsetParent;)s=ze(s.parentElement);s!=null&&s.offsetParent?(s.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}i.didHide(e)}}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,Vi.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,contrastBorder:n,widgetShadow:s}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e?e.toString():"",this.ui.container.style.backgroundColor=t?t.toString():"",this.ui.container.style.color=i?i.toString():"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=s?`0 0 8px 2px ${s}`:"",this.ui.inputBox.style(this.styles.inputBox),this.ui.count.style(this.styles.countBadge),this.ui.ok.style(this.styles.button),this.ui.customButton.style(this.styles.button),this.ui.progressBar.style(this.styles.progressBar),this.ui.list.style(this.styles.list);const o=[];this.styles.list.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.list.pickerGroupBorder}; }`),this.styles.list.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.list.pickerGroupForeground}; }`),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}}Vi.MAX_WIDTH=600;var zn;(function(r){r[r.PRESERVE=0]="PRESERVE",r[r.LAST=1]="LAST"})(zn||(zn={}));const ca={Quickaccess:"workbench.contributions.quickaccess"};class of{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),ue(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return $l([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}ct.add(ca.Quickaccess,new of);var rf=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Yo=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Hn=class extends I{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=ct.as(ca.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var n;const[s,o]=this.getOrInstantiateProvider(e),a=this.visibleQuickAccess,l=a==null?void 0:a.descriptor;if(a&&o&&l===o){e!==o.prefix&&!(i!=null&&i.preserveValue)&&(a.picker.value=e),this.adjustValueSelection(a.picker,o,i);return}if(o&&!(i!=null&&i.preserveValue)){let f;if(a&&l&&l!==o){const g=a.value.substr(l.prefix.length);g&&(f=`${o.prefix}${g}`)}if(!f){const g=s==null?void 0:s.defaultFilterValue;g===zn.LAST?f=this.lastAcceptedPickerValues.get(o):typeof g=="string"&&(f=`${o.prefix}${g}`)}typeof f=="string"&&(e=f)}const c=new G,u=c.add(this.quickInputService.createQuickPick());u.value=e,this.adjustValueSelection(u,o,i),u.placeholder=o==null?void 0:o.placeholder,u.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,u.hideInput=!!u.quickNavigate&&!a,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(u.itemActivation=(n=i==null?void 0:i.itemActivation)!==null&&n!==void 0?n:fe.SECOND),u.contextKey=o==null?void 0:o.contextKey,u.filterValue=f=>f.substring(o?o.prefix.length:0),o!=null&&o.placeholder&&(u.ariaLabel=o==null?void 0:o.placeholder);let d;t&&(d=new Rr,c.add(Sn(u.onWillAccept)(f=>{f.veto(),u.hide()}))),c.add(this.registerPickerListeners(u,s,o,e));const h=c.add(new rr);if(s&&c.add(s.provide(u,h.token)),Sn(u.onDidHide)(()=>{u.selectedItems.length===0&&h.cancel(),c.dispose(),d==null||d.complete(u.selectedItems.slice(0))}),u.show(),t)return d==null?void 0:d.p}adjustValueSelection(e,t,i){var n;let s;i!=null&&i.preserveValue?s=[e.value.length,e.value.length]:s=[(n=t==null?void 0:t.prefix.length)!==null&&n!==void 0?n:0,e.value.length],e.valueSelection=s}registerPickerListeners(e,t,i,n){const s=new G,o=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return s.add(ue(()=>{o===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),s.add(e.onDidChangeValue(a=>{const[l]=this.getOrInstantiateProvider(a);l!==t?this.show(a,{preserveValue:!0}):o.value=a})),i&&s.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),s}getOrInstantiateProvider(e){const t=this.registry.getQuickAccessProvider(e);if(!t)return[void 0,void 0];let i=this.mapProviderToDescriptor.get(t);return i||(i=this.instantiationService.createInstance(t.ctor),this.mapProviderToDescriptor.set(t,i)),[i,t]}};Hn=rf([Yo(0,Ar),Yo(1,he)],Hn);var af=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},bt=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let qn=class extends zl{constructor(e,t,i,n,s){super(i),this.instantiationService=e,this.contextKeyService=t,this.accessibilityService=n,this.layoutService=s,this.contexts=new Map}get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(Hn))),this._quickAccess}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.container,ignoreFocusOut:()=>!1,isScreenReaderOptimized:()=>this.accessibilityService.isScreenReaderOptimized(),backKeybindingLabel:()=>{},setContextKey:s=>this.setContextKey(s),returnFocus:()=>e.focus(),createList:(s,o,a,l,c)=>this.instantiationService.createInstance(Hl,s,o,a,l,c),styles:this.computeStyles()},n=this._register(new Vi(Object.assign(Object.assign({},i),t)));return n.layout(e.dimension,e.offset.quickPickTop),this._register(e.onDidLayout(s=>n.layout(s,e.offset.quickPickTop))),this._register(n.onShow(()=>this.resetContextKeys())),this._register(n.onHide(()=>this.resetContextKeys())),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Es(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t={},i=Tt.None){return this.controller.pick(e,t,i)}createQuickPick(){return this.controller.createQuickPick()}updateStyles(){this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:Object.assign({},De(this.theme,{quickInputBackground:eo,quickInputForeground:ql,quickInputTitleBackground:jl,contrastBorder:ji,widgetShadow:to})),inputBox:De(this.theme,{inputForeground:Gl,inputBackground:Yl,inputBorder:Ql,inputValidationInfoBackground:Xl,inputValidationInfoForeground:Jl,inputValidationInfoBorder:Zl,inputValidationWarningBackground:ec,inputValidationWarningForeground:tc,inputValidationWarningBorder:ic,inputValidationErrorBackground:nc,inputValidationErrorForeground:sc,inputValidationErrorBorder:oc}),countBadge:De(this.theme,{badgeBackground:rc,badgeForeground:ac,badgeBorder:ji}),button:De(this.theme,{buttonForeground:lc,buttonBackground:cc,buttonHoverBackground:uc,buttonBorder:ji}),progressBar:De(this.theme,{progressBarBackground:dc}),keybindingLabel:De(this.theme,{keybindingLabelBackground:hc,keybindingLabelForeground:fc,keybindingLabelBorder:gc,keybindingLabelBottomBorder:mc,keybindingLabelShadow:to}),list:De(this.theme,{listBackground:eo,listInactiveFocusForeground:pc,listInactiveSelectionIconForeground:_c,listInactiveFocusBackground:bc,listFocusOutline:io,listInactiveFocusOutline:io,pickerGroupBorder:vc,pickerGroupForeground:yc})}}};qn=af([bt(0,he),bt(1,oe),bt(2,Fe),bt(3,Wt),bt(4,ut)],qn);var ua=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Re=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let jn=class extends qn{constructor(e,t,i,n,s,o){super(t,i,n,s,new Mn(e.getContainerDomNode(),o)),this.host=void 0;const a=rt.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return l.getDomNode()},get dimension(){return e.getLayoutInfo()},get onDidLayout(){return e.onDidLayoutChange},focus:()=>e.focus(),offset:{top:0,quickPickTop:0}}}else this.host=void 0}createController(){return super.createController(this.host)}};jn=ua([Re(1,he),Re(2,oe),Re(3,Fe),Re(4,Wt),Re(5,H)],jn);let Gn=class{constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(jn,e);this.mapEditorToService.set(e,t),Sn(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get quickAccess(){return this.activeService.quickAccess}pick(e,t={},i=Tt.None){return this.activeService.pick(e,t,i)}createQuickPick(){return this.activeService.createQuickPick()}};Gn=ua([Re(0,he),Re(1,H)],Gn);class rt{constructor(e){this.editor=e,this.widget=new Ui(this.editor)}static get(e){return e.getContribution(rt.ID)}dispose(){this.widget.dispose()}}rt.ID="editor.controller.quickInput";class Ui{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return Ui.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}Ui.ID="editor.contrib.quickInputWidget";Cc(rt.ID,rt);class lf{constructor(e,t,i,n,s){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=s}}function cf(r){if(!r||!Array.isArray(r))return[];const e=[];let t=0;for(let i=0,n=r.length;i<n;i++){const s=r[i];let o=-1;if(typeof s.fontStyle=="string"){o=0;const c=s.fontStyle.split(" ");for(let u=0,d=c.length;u<d;u++)switch(c[u]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break;case"strikethrough":o=o|8;break}}let a=null;typeof s.foreground=="string"&&(a=s.foreground);let l=null;typeof s.background=="string"&&(l=s.background),e[t++]=new lf(s.token||"",i,o,a,l)}return e}function uf(r,e){r.sort((u,d)=>{const h=mf(u.token,d.token);return h!==0?h:u.index-d.index});let t=0,i="000000",n="ffffff";for(;r.length>=1&&r[0].token==="";){const u=r.shift();u.fontStyle!==-1&&(t=u.fontStyle),u.foreground!==null&&(i=u.foreground),u.background!==null&&(n=u.background)}const s=new hf;for(const u of e)s.getId(u);const o=s.getId(i),a=s.getId(n),l=new Rs(t,o,a),c=new Ps(l);for(let u=0,d=r.length;u<d;u++){const h=r[u];c.insert(h.token,h.fontStyle,s.getId(h.foreground),s.getId(h.background))}return new da(s,c)}const df=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class hf{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(df);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=ge.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class da{constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(cf(e),t)}static createFromParsedTokenTheme(e,t){return uf(e,t)}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),s=gf(t);i=(n.metadata|s<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const ff=/\b(comment|string|regex|regexp)\b/;function gf(r){const e=r.match(ff);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function mf(r,e){return r<e?-1:r>e?1:0}class Rs{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new Rs(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class Ps{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const s=this._children.get(i);return typeof s<"u"?s.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const s=e.indexOf(".");let o,a;s===-1?(o=e,a=""):(o=e.substring(0,s),a=e.substring(s+1));let l=this._children.get(o);typeof l>"u"&&(l=new Ps(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,n)}}function pf(r){const e=[];for(let t=1,i=r.length;t<i;t++){const n=r[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const _f={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Ai]:"#FFFFFE",[Ri]:"#000000",[Pr]:"#E5EBF1",[Pi]:"#D3D3D3",[Oi]:"#939393",[Or]:"#ADD6FF4D"}},bf={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Ai]:"#1E1E1E",[Ri]:"#D4D4D4",[Pr]:"#3A3D41",[Pi]:"#404040",[Oi]:"#707070",[Or]:"#ADD6FF26"}},vf={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Ai]:"#000000",[Ri]:"#FFFFFF",[Pi]:"#FFFFFF",[Oi]:"#FFFFFF"}},yf={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Ai]:"#FFFFFF",[Ri]:"#292929",[Pi]:"#292929",[Oi]:"#292929"}};function Cf(r){const e=new _,t=Fr();return t.onDidChange(()=>e.fire()),r==null||r.onDidProductIconThemeChange(()=>e.fire()),{onDidChange:e.event,getCSS(){const i=r?r.getProductIconTheme():new ha,n={},s=a=>{const l=i.getIcon(a);if(!l)return;const c=l.font;return c?(n[c.id]=c.definition,`.codicon-${a.id}:before { content: '${l.fontCharacter}'; font-family: ${no(c.id)}; }`):`.codicon-${a.id}:before { content: '${l.fontCharacter}'; }`},o=[];for(const a of t.getIcons()){const l=s(a);l&&o.push(l)}for(const a in n){const l=n[a],c=l.weight?`font-weight: ${l.weight};`:"",u=l.style?`font-style: ${l.style};`:"",d=l.src.map(h=>`${yn(h.location)} format('${h.format}')`).join(", ");o.push(`@font-face { src: ${d}; font-family: ${no(a)};${c}${u} font-display: block; }`)}return o.join(`
`)}}}class ha{getIcon(e){const t=Fr();let i=e.defaults;for(;kc.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const Ce="vs",xt="vs-dark",Ze="hc-black",et="hc-light",fa=ct.as(Sc.ColorContribution),kf=ct.as(wc.ThemingContribution);class ga{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(hi(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,ge.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=Yn(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,ge.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=fa.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return Object.prototype.hasOwnProperty.call(this.getColors(),e)}get type(){switch(this.base){case Ce:return Yt.LIGHT;case Ze:return Yt.HIGH_CONTRAST_DARK;case et:return Yt.HIGH_CONTRAST_LIGHT;default:return Yt.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const s=Yn(this.themeData.base);e=s.rules,s.encodedTokensColors&&(t=s.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const s={token:""};i&&(s.foreground=i),n&&(s.background=n),e.push(s)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=da.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const s=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=so.getForeground(s),a=so.getFontStyle(s);return{foreground:o,italic:Boolean(a&1),bold:Boolean(a&2),underline:Boolean(a&4),strikethrough:Boolean(a&8)}}}function hi(r){return r===Ce||r===xt||r===Ze||r===et}function Yn(r){switch(r){case Ce:return _f;case xt:return bf;case Ze:return vf;case et:return yf}}function ri(r){const e=Yn(r);return new ga(r,e)}class Sf extends I{constructor(){super(),this._onColorThemeChange=this._register(new _),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new _),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new ha,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Ce,ri(Ce)),this._knownThemes.set(xt,ri(xt)),this._knownThemes.set(Ze,ri(Ze)),this._knownThemes.set(et,ri(et));const e=Cf(this);this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Ce),this._onOSSchemeChanged(),e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()}),Ec("(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return vn(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Dt(),this._globalStyleElement.className="monaco-colors",this._globalStyleElement.textContent=this._allCSS,this._styleElements.push(this._globalStyleElement)),I.None}_registerShadowDomContainer(e){const t=Dt(e);return t.className="monaco-colors",t.textContent=this._allCSS,this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!hi(t.base)&&!hi(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new ga(e,t)),hi(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Ce),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=window.matchMedia("(forced-colors: active)").matches;if(e!==xc(this._theme.type)){let t;Ic(this._theme.type)?t=e?Ze:xt:t=e?et:Ce,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:o=>{t[o]||(e.push(o),t[o]=!0)}};kf.getThemingParticipants().forEach(o=>o(this._theme,i,this._environment));const n=[];for(const o of fa.getColors()){const a=this._theme.getColor(o.id,!0);a&&n.push(`${Lc(o.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor { ${n.join(`
`)} }`);const s=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(pf(s)),this._themeCSS=e.join(`
`),this._updateCSS(),W.setColorMap(s),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const se=vs("themeService");var wf=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},an=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Qn=class extends I{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new _,this._onDidChangeReducedMotion=new _,this._accessibilityModeEnabledContext=Dc.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),o.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const s=window.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=s.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this.initReducedMotionListeners(s)}initReducedMotionListeners(e){if(!this._layoutService.hasContainer)return;this._register(k(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.container.classList.toggle("reduce-motion",i),this._layoutService.container.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};Qn=wf([an(0,oe),an(1,ut),an(2,de)],Qn);var Os=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},tt=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Xn=class{constructor(e,t){this._commandService=e,this._hiddenStates=new Ei(t)}createMenu(e,t,i){return new Jn(e,this._hiddenStates,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},i),this._commandService,t,this)}};Xn=Os([tt(0,xe),tt(1,xs)],Xn);let Ei=class yt{constructor(e){this._storageService=e,this._disposables=new G,this._onDidChange=new _,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1;try{const t=e.get(yt._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(t=>{if(t.key===yt._key){if(!this._ignoreChangeEvent)try{const i=e.get(yt._key,0,"{}");this._data=JSON.parse(i)}catch(i){console.log("FAILED to read storage after UPDATE",i)}this._onDidChange.fire()}}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}isHidden(e,t){var i,n;return(n=(i=this._data[e.id])===null||i===void 0?void 0:i.includes(t))!==null&&n!==void 0?n:!1}updateHidden(e,t,i){const n=this._data[e.id];if(i)n?n.indexOf(t)<0&&n.push(t):this._data[e.id]=[t];else if(n){const s=n.indexOf(t);s>=0&&Tc(n,s),n.length===0&&delete this._data[e.id]}this._persist()}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(yt._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};Ei._key="menu.hiddenCommands";Ei=Os([tt(0,xs)],Ei);let Jn=class qe{constructor(e,t,i,n,s,o){this._id=e,this._hiddenStates=t,this._options=i,this._commandService=n,this._contextKeyService=s,this._menuService=o,this._disposables=new G,this._menuGroups=[],this._contextKeys=new Set,this._build();const a=new Oe(()=>{this._build(),this._onDidChange.fire(this)},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(kt.onDidChangeMenu(u=>{u.has(e)&&a.schedule()}));const l=this._disposables.add(new G),c=()=>{const u=new Oe(()=>this._onDidChange.fire(this),i.eventDebounceDelay);l.add(u),l.add(s.onDidChangeContext(d=>{d.affectsSome(this._contextKeys)&&u.schedule()})),l.add(t.onDidChange(()=>{u.schedule()}))};this._onDidChange=new _({onFirstListenerAdd:c,onLastListenerRemove:l.clear.bind(l)}),this.onDidChange=this._onDidChange.event}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}_build(){this._menuGroups.length=0,this._contextKeys.clear();const e=kt.getMenuItems(this._id);let t;e.sort(qe._compareMenuItems);for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeys(i)}}_collectContextKeys(e){if(qe._fillInKbExprKeys(e.when,this._contextKeys),Qt(e)){if(e.command.precondition&&qe._fillInKbExprKeys(e.command.precondition,this._contextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;qe._fillInKbExprKeys(t,this._contextKeys)}}else this._options.emitEventsForSubmenuChanges&&kt.getMenuItems(e.submenu).forEach(this._collectContextKeys,this)}getActions(e){const t=[];for(const i of this._menuGroups){const[n,s]=i,o=[],a=[];for(const l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let c;if(Qt(l)){const d=Ef(this._id,l.command,this._hiddenStates);c=new Mc(l.command,l.alt,e,d,this._contextKeyService,this._commandService)}else c=new Ac(l,this._menuService,this._contextKeyService,e),c.actions.length===0&&(c.dispose(),c=void 0);c&&a.push(c)}a.length>0&&t.push([n,a]),o.length>0}return t}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const s=e.order||0,o=t.order||0;return s<o?-1:s>o?1:qe._compareTitles(Qt(e)?e.command.title:e.title,Qt(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};Jn=Os([tt(3,xe),tt(4,oe),tt(5,Br)],Jn);function Ef(r,e,t){const i=`${r.id}/${e.id}`,n=typeof e.title=="string"?e.title:e.title.value,s=oo({id:i,label:E("hide.label","Hide '{0}'",n),run(){t.updateHidden(r,e.id,!0)}}),o=oo({id:i,label:n,get checked(){return!t.isHidden(r,e.id)},run(){const a=!t.isHidden(r,e.id);t.updateHidden(r,e.id,a)}});return{hide:s,toggle:o,get isHidden(){return!o.checked}}}var xf=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Qo=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},$e=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};let Zn=class extends I{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],(Rc||Pc)&&this.installWebKitWriteTextWorkaround()}installWebKitWriteTextWorkaround(){const e=()=>{const t=new Rr;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(i=>$e(this,void 0,void 0,function*(){(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)}))};this.layoutService.hasContainer&&(this._register(k(this.layoutService.container,"click",e)),this._register(k(this.layoutService.container,"keydown",e)))}writeText(e,t){return $e(this,void 0,void 0,function*(){if(t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return yield navigator.clipboard.writeText(e)}catch(s){console.error(s)}const i=document.activeElement,n=document.body.appendChild(z("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),document.execCommand("copy"),i instanceof HTMLElement&&i.focus(),document.body.removeChild(n)})}readText(e){return $e(this,void 0,void 0,function*(){if(e)return this.mapTextToType.get(e)||"";try{return yield navigator.clipboard.readText()}catch(t){return console.error(t),""}})}readFindText(){return $e(this,void 0,void 0,function*(){return this.findText})}writeFindText(e){return $e(this,void 0,void 0,function*(){this.findText=e})}readResources(){return $e(this,void 0,void 0,function*(){return this.resources})}};Zn=xf([Qo(0,ut),Qo(1,Di)],Zn);var If=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Lf=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};const It="data-keybinding-context";class Fs{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return Object.assign({},this._value)}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}}class at extends Fs{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}at.INSTANCE=new at;class Nt extends Fs{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=Bc.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const s=Array.from(Pe.map(this._values,([o])=>o));this._values.clear(),i.fire(new Jo(s))}else{const s=[];for(const o of n.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(s.push(...Pe.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(s.push(a),this._values.delete(a))}i.fire(new Jo(s))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(Nt._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Nt._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}Nt._keyPrefix="config.";class Df{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class Xo{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class Jo{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class Tf{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function Mf(r,e){return r.allKeysContainedIn(new Set(Object.keys(e)))}class ma{constructor(e){this._onDidChangeContext=new Nc({merge:t=>new Tf(t)}),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new Df(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new Af(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new Xo(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new Xo(e))}getContext(e){return this._isDisposed?at.INSTANCE:this.getContextValuesContainer(Rf(e))}}let es=class extends ma{constructor(e){super(0),this._contexts=new Map,this._toDispose=new G,this._lastContextId=0;const t=new Nt(this._myContextId,e,this._onDidChangeContext);this._contexts.set(this._myContextId,t),this._toDispose.add(t)}dispose(){this._onDidChangeContext.dispose(),this._isDisposed=!0,this._toDispose.dispose()}getContextValuesContainer(e){return this._isDisposed?at.INSTANCE:this._contexts.get(e)||at.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new Fs(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};es=If([Lf(0,de)],es);class Af extends ma{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=new Kc,this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(It)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(It,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;Mf(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._onDidChangeContext.dispose(),this._parent.disposeContext(this._myContextId),this._parentChangeListener.dispose(),this._domNode.removeAttribute(It),this._isDisposed=!0)}getContextValuesContainer(e){return this._isDisposed?at.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function Rf(r){for(;r;){if(r.hasAttribute(It)){const e=r.getAttribute(It);return e?parseInt(e,10):NaN}r=r.parentElement}return 0}function Pf(r,e,t){r.get(oe).createKey(String(e),Of(t))}function Of(r){return Fc(r,e=>{if(typeof e=="object"&&e.$mid===1)return ne.revive(e).toString();if(e instanceof ne)return e.toString()})}me.registerCommand(Oc,Pf);me.registerCommand({id:"getContextKeyInfo",handler(){return[...Es.all()].sort((r,e)=>r.key.localeCompare(e.key))},description:{description:E("getContextKeyInfo","A command that returns information about context keys"),args:[]}});me.registerCommand("_generateContextKeyInfo",function(){const r=[],e=new Set;for(const t of Es.all())e.has(t.key)||(e.add(t.key),r.push(t));r.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(r,void 0,2))});class Ff{constructor(e){this.incoming=new Map,this.outgoing=new Map,this.data=e}}class Bf{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(this._hashFn(t),n),n.incoming.set(this._hashFn(e),i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new Ff(e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}, (incoming)[${[...i.incoming.keys()].join(", ")}], (outgoing)[${[...i.outgoing.keys()].join(",")}]`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(n,t);if(s)return s;t.delete(i)}}}class Zo extends Error{constructor(e){var t;super("cyclic dependency between services"),this.message=(t=e.findCycleSlow())!==null&&t!==void 0?t:`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class Bs{constructor(e=new Nr,t=!1,i){this._activeInstantiations=new Set,this._services=e,this._strict=t,this._parent=i,this._services.set(he,this)}createChild(e){return new Bs(e,this._strict,this)}invokeFunction(e,...t){const i=ie.traceInvocation(e);let n=!1;try{return e({get:o=>{if(n)throw Vc("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){let i,n;return e instanceof pe?(i=ie.traceCreation(e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=ie.traceCreation(e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=ro.getServiceDependencies(e).sort((a,l)=>a.index-l.index),s=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(l)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return new e(...t,...s)}_setServiceInstance(e,t){if(this._services.get(e)instanceof pe)this._services.set(e,t);else if(this._parent)this._parent._setServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){const i=this._getServiceInstanceOrDescriptor(e);return i instanceof pe?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const n=new Bf(a=>a.id.toString());let s=0;const o=[{id:e,desc:t,_trace:i}];for(;o.length;){const a=o.pop();if(n.lookupOrInsertNode(a),s++>1e3)throw new Zo(n);for(const l of ro.getServiceDependencies(a.desc.ctor)){const c=this._getServiceInstanceOrDescriptor(l.id);if(c||this._throwIfStrict(`[createInstance] ${e} depends on ${l.id} which is NOT registered.`,!0),c instanceof pe){const u={id:l.id,desc:c,_trace:a._trace.branch(l.id,!0)};n.insertEdge(a,u),o.push(u)}}}for(;;){const a=n.roots();if(a.length===0){if(!n.isEmpty())throw new Zo(n);break}for(const{data:l}of a){if(this._getServiceInstanceOrDescriptor(l.id)instanceof pe){const u=this._createServiceInstanceWithOwner(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this._setServiceInstance(l.id,u)}n.removeNode(l)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,s){if(this._services.get(e)instanceof pe)return this._createServiceInstance(t,i,n,s);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t=[],i,n){if(i){const s=new Mi(()=>this._createInstance(e,t,n));return new Proxy(Object.create(null),{get(o,a){if(a in o)return o[a];const l=s.value;let c=l[a];return typeof c!="function"||(c=c.bind(l),o[a]=c),c},set(o,a,l){return s.value[a]=l,!0}})}else return this._createInstance(e,t,n)}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}class ie{constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}static traceInvocation(e){return ie._None}static traceCreation(e){return ie._None}branch(e,t){const i=new ie(2,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;ie._totals+=e;let t=!1;function i(s,o){const a=[],l=new Array(s+1).join("	");for(const[c,u,d]of o._dep)if(u&&d){t=!0,a.push(`${l}CREATES -> ${c}`);const h=i(s+1,d);h&&a.push(h)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===0?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${ie._totals.toFixed(2)}ms)`];(e>2||t)&&console.log(n.join(`
`))}}ie._None=new class extends ie{constructor(){super(-1,null)}stop(){}branch(){return this}};ie._totals=0;class Nf{constructor(){this._byResource=new te,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let s=this._byOwner.get(t);s||(s=new te,this._byOwner.set(t,s)),s.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,n=!1;const s=this._byResource.get(e);s&&(i=s.delete(t));const o=this._byOwner.get(t);if(o&&(n=o.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){var t,i,n,s;return typeof e=="string"?(i=(t=this._byOwner.get(e))===null||t===void 0?void 0:t.values())!==null&&i!==void 0?i:Pe.empty():ne.isUri(e)?(s=(n=this._byResource.get(e))===null||n===void 0?void 0:n.values())!==null&&s!==void 0?s:Pe.empty():Pe.map(Pe.concat(...this._byOwner.values()),o=>o[1])}}class Kf{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new te,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(e.scheme===N.inMemory||e.scheme===N.walkThrough||e.scheme===N.walkThroughSnippet||e.scheme===N.vscodeSourceControl)return t;for(const{severity:i}of this._service.read({resource:e}))i===be.Error?t.errors+=1:i===be.Warning?t.warnings+=1:i===be.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class _e{constructor(){this._onMarkerChanged=new Uc({delay:0,merge:_e._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new Nf,this._stats=new Kf(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(Wc(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const s of i){const o=_e._toMarker(e,t,s);o&&n.push(o)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:s,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:u,endColumn:d,relatedInformation:h,tags:f}=i;if(o)return l=l>0?l:1,c=c>0?c:1,u=u>=l?u:l,d=d>0?d:c,{resource:t,owner:e,code:n,severity:s,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:u,endColumn:d,relatedInformation:h,tags:f}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const s of n){const o=Pe.first(s);o&&(i.push(o.resource),this._data.delete(o.resource,e))}if(ur(t)){const s=new te;for(const{resource:o,marker:a}of t){const l=_e._toMarker(e,o,a);if(!l)continue;const c=s.get(o);c?c.push(l):(s.set(o,[l]),i.push(o))}for(const[o,a]of s)this._data.set(o,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:s}=e;if((!s||s<0)&&(s=-1),t&&i){const o=this._data.get(i,t);if(o){const a=[];for(const l of o)if(_e._accept(l,n)){const c=a.push(l);if(s>0&&c===s)break}return a}else return[]}else if(!t&&!i){const o=[];for(const a of this._data.values())for(const l of a)if(_e._accept(l,n)){const c=o.push(l);if(s>0&&c===s)return o}return o}else{const o=this._data.values(i??t),a=[];for(const l of o)for(const c of l)if(_e._accept(c,n)){const u=a.push(c);if(s>0&&u===s)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new te;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}function pa(r,e,t,i,n,s){if(Array.isArray(r)){let o=0;for(const a of r){const l=pa(a,e,t,i,n,s);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof r=="string")return i?r==="*"?5:r===t?10:0:0;if(r){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=r;if(!i&&!c)return 0;u&&n&&(e=n);let d=0;if(l)if(l===e.scheme)d=10;else if(l==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===s)d=10;else if(u==="*"&&s!==void 0)d=Math.max(d,5);else return 0;if(a){let h;if(typeof a=="string"?h=a:h=Object.assign(Object.assign({},a),{base:$c(a.base)}),h===e.fsPath||Ih(h,e.fsPath))d=10;else return 0}return d}else return 0}}function _a(r){return typeof r=="string"?!1:Array.isArray(r)?r.every(_a):!!r.exclusive}class er{constructor(e,t,i,n){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)===null||t===void 0?void 0:t.toString())===((i=e.notebookUri)===null||i===void 0?void 0:i.toString())}}class R{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new _,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),ue(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e){const t=[];return this._orderedForEach(e,i=>t.push(i.provider)),t}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,s=>{i&&n===s._score?i.push(s.provider):(n=s._score,i=[s.provider],t.push(i))}),t}_orderedForEach(e,t){this._updateScores(e);for(const i of this._entries)i._score>0&&t(i)}_updateScores(e){var t,i;const n=(t=this._notebookInfoResolver)===null||t===void 0?void 0:t.call(this,e.uri),s=n?new er(e.uri,e.getLanguageId(),n.uri,n.type):new er(e.uri,e.getLanguageId(),void 0,void 0);if(!(!((i=this._lastCandidate)===null||i===void 0)&&i.equals(s))){this._lastCandidate=s;for(const o of this._entries)if(o._score=pa(o.selector,s.uri,s.languageId,zc(e),s.notebookUri,s.notebookType),_a(o.selector)&&o._score>0){for(const a of this._entries)a._score=0;o._score=1e3;break}this._entries.sort(R._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:e._time<t._time?1:e._time>t._time?-1:0}}class Vf{constructor(){this.referenceProvider=new R(this._score.bind(this)),this.renameProvider=new R(this._score.bind(this)),this.codeActionProvider=new R(this._score.bind(this)),this.definitionProvider=new R(this._score.bind(this)),this.typeDefinitionProvider=new R(this._score.bind(this)),this.declarationProvider=new R(this._score.bind(this)),this.implementationProvider=new R(this._score.bind(this)),this.documentSymbolProvider=new R(this._score.bind(this)),this.inlayHintsProvider=new R(this._score.bind(this)),this.colorProvider=new R(this._score.bind(this)),this.codeLensProvider=new R(this._score.bind(this)),this.documentFormattingEditProvider=new R(this._score.bind(this)),this.documentRangeFormattingEditProvider=new R(this._score.bind(this)),this.onTypeFormattingEditProvider=new R(this._score.bind(this)),this.signatureHelpProvider=new R(this._score.bind(this)),this.hoverProvider=new R(this._score.bind(this)),this.documentHighlightProvider=new R(this._score.bind(this)),this.selectionRangeProvider=new R(this._score.bind(this)),this.foldingRangeProvider=new R(this._score.bind(this)),this.linkProvider=new R(this._score.bind(this)),this.inlineCompletionsProvider=new R(this._score.bind(this)),this.completionProvider=new R(this._score.bind(this)),this.linkedEditingRangeProvider=new R(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new R(this._score.bind(this)),this.documentSemanticTokensProvider=new R(this._score.bind(this)),this.documentOnDropEditProvider=new R(this._score.bind(this)),this.documentPasteEditProvider=new R(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)===null||t===void 0?void 0:t.call(this,e)}}D(P,Vf,!0);class Uf extends q{constructor(e={}){const t=ct.as(Er.Configuration).getConfigurationProperties(),i=Object.keys(t),n=Object.create(null),s=[];for(const o in t){const a=e[o],l=a!==void 0?a:t[o].default;br(n,o,l,c=>console.error(`Conflict in default settings: ${c}`))}for(const o of Object.keys(n))Hc.test(o)&&s.push({identifiers:qc(o),keys:Object.keys(n[o]),contents:vr(n[o],a=>console.error(`Conflict in default settings file: ${a}`))});super(n,i,s)}}var Ie=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},V=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}},ba=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};class Wf{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new _}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let ts=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new jc(new Wf(t))):Promise.reject(new Error("Model not found"))}};ts=Ie([V(0,X)],ts);class Wi{show(){return Wi.NULL_PROGRESS_RUNNER}showWhile(e,t){return ba(this,void 0,void 0,function*(){yield e})}}Wi.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class $f{withProgress(e,t,i){return t({report:()=>{}})}}class zf{confirm(e){return this.doConfirm(e).then(t=>({confirmed:t,checkboxChecked:!1}))}doConfirm(e){let t=e.message;return e.detail&&(t=t+`

`+e.detail),Promise.resolve(window.confirm(t))}show(e,t,i,n){return Promise.resolve({choice:0})}}class $i{info(e){return this.notify({severity:j.Info,message:e})}warn(e){return this.notify({severity:j.Warning,message:e})}error(e){return this.notify({severity:j.Error,message:e})}notify(e){switch(e.severity){case j.Error:console.error(e.message);break;case j.Warning:console.warn(e.message);break;default:console.log(e.message);break}return $i.NO_OP}status(e,t){return I.None}}$i.NO_OP=new Gc;let is=class{constructor(e){this._onWillExecuteCommand=new _,this._onDidExecuteCommand=new _,this.onWillExecuteCommand=this._onWillExecuteCommand.event,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=me.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};is=Ie([V(0,he)],is);let lt=class extends dh{constructor(e,t,i,n,s,o){super(e,t,i,n,s),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=f=>{const g=new G;g.add(k(f,x.KEY_DOWN,p=>{const v=new J(p);this._dispatch(v,v.target)&&(v.preventDefault(),v.stopPropagation())})),g.add(k(f,x.KEY_UP,p=>{const v=new J(p);this._singleModifierDispatch(v,v.target)&&v.preventDefault()})),this._domNodeListeners.push(new Hf(f,g))},l=f=>{for(let g=0;g<this._domNodeListeners.length;g++){const p=this._domNodeListeners[g];p.domNode===f&&(this._domNodeListeners.splice(g,1),p.dispose())}},c=f=>{f.getOption(56)||a(f.getContainerDomNode())},u=f=>{f.getOption(56)||l(f.getContainerDomNode())};this._register(o.onCodeEditorAdd(c)),this._register(o.onCodeEditorRemove(u)),o.listCodeEditors().forEach(c);const d=f=>{a(f.getContainerDomNode())},h=f=>{l(f.getContainerDomNode())};this._register(o.onDiffEditorAdd(d)),this._register(o.onDiffEditorRemove(h)),o.listDiffEditors().forEach(d)}addDynamicKeybinding(e,t,i,n){return Lr(me.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>{var n,s;const o=Yc(i.keybinding,li);return{keybinding:(n=o==null?void 0:o.parts)!==null&&n!==void 0?n:null,command:(s=i.command)!==null&&s!==void 0?s:null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}});return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),ue(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Qc.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new Et(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const s of e){const o=s.when||void 0,a=s.keybinding;if(!a)i[n++]=new Io(void 0,s.command,s.commandArgs,o,t,null,!1);else{const l=Pt.resolveUserBinding(a,li);for(const c of l)i[n++]=new Io(c,s.command,s.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new fn(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode).toChord();return new Pt(t,li)}};lt=Ie([V(0,oe),V(1,xe),V(2,Ti),V(3,Ee),V(4,Di),V(5,H)],lt);class Hf extends I{constructor(e,t){super(),this.domNode=e,this._register(t)}}function tr(r){return r&&typeof r=="object"&&(!r.overrideIdentifier||typeof r.overrideIdentifier=="string")&&(!r.resource||r.resource instanceof ne)}class va{constructor(){this._onDidChangeConfiguration=new _,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._configuration=new Bi(new Uf,new q,new q,new q)}getValue(e,t){const i=typeof e=="string"?e:void 0,n=tr(e)?e:tr(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[s,o]=n;this.getValue(s)!==o&&(this._configuration.updateValue(s,o),i.push(s))}if(i.length>0){const n=new ch({keys:i,overrides:[]},t,this._configuration);n.source=8,n.sourceConfig=null,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}}let ns=class{constructor(e){this.configurationService=e,this._onDidChangeConfiguration=new _,this.configurationService.onDidChangeConfiguration(t=>{this._onDidChangeConfiguration.fire({affectedKeys:t.affectedKeys,affectsConfiguration:(i,n)=>t.affectsConfiguration(n)})})}getValue(e,t,i){const s=(Li.isIPosition(t)?t:null)?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0;return typeof s>"u"?this.configurationService.getValue():this.configurationService.getValue(s)}};ns=Ie([V(0,de)],ns);let ss=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:mi||Cs?`
`:`\r
`}};ss=Ie([V(0,de)],ss);class qf{publicLog(e,t){return Promise.resolve(void 0)}publicLog2(e,t){return this.publicLog(e,t)}}class Kt{constructor(){const e=ne.from({scheme:Kt.SCHEME,authority:"model",path:"/"});this.workspace={id:"4064f6ec-cb38-4ad0-af64-ee6467e63c82",folders:[new tu({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===Kt.SCHEME?this.workspace.folders[0]:null}}Kt.SCHEME="inmemory";function xi(r,e,t){if(!e||!(r instanceof va))return;const i=[];Object.keys(e).forEach(n=>{iu(n)&&i.push([`editor.${n}`,e[n]]),t&&nu(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&r.updateValues(i)}let os=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}apply(e,t){return ba(this,void 0,void 0,function*(){const i=new Map;for(const o of e){if(!(o instanceof Xc))throw new Error("bad edit - only text edits are supported");const a=this._modelService.getModel(o.resource);if(!a)throw new Error("bad edit - model not found");if(typeof o.versionId=="number"&&a.getVersionId()!==o.versionId)throw new Error("bad state - model changed in the meantime");let l=i.get(a);l||(l=[],i.set(a,l)),l.push(Jc.replaceMove(U.lift(o.textEdit.range),o.textEdit.text))}let n=0,s=0;for(const[o,a]of i)o.pushStackElement(),o.pushEditOperations([],a,()=>[]),o.pushStackElement(),s+=1,n+=a.length;return{ariaSummary:Zc(eu.bulkEditServiceSummary,n,s)}})}};os=Ie([V(0,X)],os);class jf{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return _u(e)}}let rs=class extends Pn{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};rs=Ie([V(0,ut),V(1,H)],rs);class Gf{constructor(){this._neverEmitter=new _,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class Yf extends Ft{constructor(){super()}}class Qf extends bu{constructor(){super(new vu)}}let as=class extends Bn{constructor(e,t,i,n,s){super(e,t,i,n,s),this.configure({blockMouse:!1})}};as=Ie([V(0,Ti),V(1,Ee),V(2,Ss),V(3,Be),V(4,Fe)],as);D(de,va);D(cr,ns);D(su,ss);D(ou,Kt);D(ru,jf);D(Ti,qf);D(mr,zf);D(Ee,$i);D(Ne,_e);D(Z,Yf);D(se,Sf);D(Di,Qf);D(X,au);D(lu,Un);D(oe,es);D(cu,$f);D(Kr,Wi);D(xs,uu);D(Vr,Dn);D(du,os);D(hu,Gf);D(fu,ts);D(Wt,Qn);D(mu,gu);D(xe,is);D(Be,lt);D(Ar,Gn);D(Ss,rs);D(pu,Vn);D(Ur,Zn);D(Wr,as);D(Br,Xn);var m;(function(r){const e=new Nr;for(const[o,a]of ao())e.set(o,a);const t=new Bs(e,!0);e.set(he,t);function i(o){const a=e.get(o);if(!a)throw new Error("Missing service "+o);return a instanceof pe?t.invokeFunction(l=>l.get(o)):a}r.get=i;let n=!1;function s(o){if(n)return t;n=!0;for(const[a,l]of ao())e.get(a)||e.set(a,l);for(const a in o)if(o.hasOwnProperty(a)){const l=vs(a);e.get(l)instanceof pe&&e.set(l,o[a])}return t}r.initialize=s})(m||(m={}));var Ns=globalThis&&globalThis.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},A=globalThis&&globalThis.__param||function(r,e){return function(t,i){e(t,i,r)}};let Xf=0,ir=!1;function Jf(r){if(!r){if(ir)return;ir=!0}Su(r||document.body)}let Ii=class extends yu{constructor(e,t,i,n,s,o,a,l,c,u,d,h){const f=Object.assign({},t);f.ariaLabel=f.ariaLabel||lo.editorViewAccessibleLabel,f.ariaLabel=f.ariaLabel+";"+lo.accessibilityHelpMessage,super(e,f,{},i,n,s,o,l,c,u,d,h),a instanceof lt?this._standaloneKeybindingService=a:this._standaloneKeybindingService=null,Jf(f.ariaContainerElement)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++Xf,s=ae.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,s),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),I.None;const t=e.id,i=e.label,n=ae.and(ae.equals("editorId",this.getId()),ae.deserialize(e.precondition)),s=e.keybindings,o=ae.and(n,ae.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(f,...g)=>Promise.resolve(e.run(this,...g)),u=new G,d=this.getId()+":"+t;if(u.add(me.registerCommand(d,c)),a){const f={command:{id:d,title:i},when:n,group:a,order:l};u.add(kt.appendMenuItem($r.EditorContext,f))}if(Array.isArray(s))for(const f of s)u.add(this._standaloneKeybindingService.addDynamicKeybinding(d,f,c,o));const h=new Cu(d,i,i,n,c,this._contextKeyService);return this._actions[t]=h,u.add(ue(()=>{delete this._actions[t]})),u}_triggerCommand(e,t){if(this._codeEditorService instanceof yi)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};Ii=Ns([A(2,he),A(3,H),A(4,xe),A(5,oe),A(6,Be),A(7,Fe),A(8,Ee),A(9,Wt),A(10,Ut),A(11,P)],Ii);let ls=class extends Ii{constructor(e,t,i,n,s,o,a,l,c,u,d,h,f,g,p){const v=Object.assign({},t);xi(u,v,!1);const w=l.registerEditorContainer(e);typeof v.theme=="string"&&l.setTheme(v.theme),typeof v.autoDetectHighContrast<"u"&&l.setAutoDetectHighContrast(Boolean(v.autoDetectHighContrast));const S=v.model;delete v.model,super(e,v,i,n,s,o,a,l,c,d,g,p),this._configurationService=u,this._standaloneThemeService=l,this._register(w);let b;if(typeof S>"u"){const C=f.getLanguageIdByMimeType(v.language)||v.language||Xe;b=ya(h,f,v.value||"",C,void 0),this._ownsModel=!0}else b=S,this._ownsModel=!1;if(this._attachModel(b),b){const C={oldModelUrl:null,newModelUrl:b.uri};this._onDidChangeModel.fire(C)}}dispose(){super.dispose()}updateOptions(e){xi(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(e.autoDetectHighContrast)),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};ls=Ns([A(2,he),A(3,H),A(4,xe),A(5,oe),A(6,Be),A(7,se),A(8,Ee),A(9,de),A(10,Wt),A(11,X),A(12,Z),A(13,Ut),A(14,P)],ls);let cs=class extends ku{constructor(e,t,i,n,s,o,a,l,c,u,d,h){const f=Object.assign({},t);xi(c,f,!0);const g=a.registerEditorContainer(e);typeof f.theme=="string"&&a.setTheme(f.theme),typeof f.autoDetectHighContrast<"u"&&a.setAutoDetectHighContrast(Boolean(f.autoDetectHighContrast)),super(e,f,{},h,s,n,i,o,a,l,u,d),this._configurationService=c,this._standaloneThemeService=a,this._register(g)}dispose(){super.dispose()}updateOptions(e){xi(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(e.autoDetectHighContrast)),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(Ii,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};cs=Ns([A(2,he),A(3,oe),A(4,Vr),A(5,H),A(6,se),A(7,Ee),A(8,de),A(9,Wr),A(10,Kr),A(11,Ur)],cs);function ya(r,e,t,i,n){if(t=t||"",!i){const s=t.indexOf(`
`);let o=t;return s!==-1&&(o=t.substring(0,s)),nr(r,t,e.createByFilepathOrFirstLine(n||null,o),n)}return nr(r,t,e.createById(i),n)}function nr(r,e,t,i){return r.createModel(e,t,i)}function Zf(r,e,t){return m.initialize(t||{}).createInstance(ls,r,e)}function eg(r){return m.get(H).onCodeEditorAdd(t=>{r(t)})}function tg(r){return m.get(H).onDiffEditorAdd(t=>{r(t)})}function ig(){return m.get(H).listCodeEditors()}function ng(){return m.get(H).listDiffEditors()}function sg(r,e,t){return m.initialize(t||{}).createInstance(cs,r,e)}function og(r,e){return new pd(r,e)}function rg(r){if(typeof r.id!="string"||typeof r.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return me.registerCommand(r.id,r.run)}function ag(r){if(typeof r.id!="string"||typeof r.label!="string"||typeof r.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=ae.deserialize(r.precondition),t=(n,...s)=>ed.runEditorCommand(n,s,e,(o,a,l)=>Promise.resolve(r.run(a,...l))),i=new G;if(i.add(me.registerCommand(r.id,t)),r.contextMenuGroupId){const n={command:{id:r.id,title:r.label},when:e,group:r.contextMenuGroupId,order:r.contextMenuOrder||0};i.add(kt.appendMenuItem($r.EditorContext,n))}if(Array.isArray(r.keybindings)){const n=m.get(Be);if(!(n instanceof lt))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const s=ae.and(e,ae.deserialize(r.keybindingContext));i.add(n.addDynamicKeybindings(r.keybindings.map(o=>({keybinding:o,command:r.id,when:s}))))}}return i}function lg(r){return Ca([r])}function Ca(r){const e=m.get(Be);return e instanceof lt?e.addDynamicKeybindings(r.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:ae.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),I.None)}function cg(r,e,t){const i=m.get(Z),n=i.getLanguageIdByMimeType(e)||e;return ya(m.get(X),i,r,n,t)}function ug(r,e){const t=m.get(Z);m.get(X).setMode(r,t.createById(e))}function dg(r,e,t){r&&m.get(Ne).changeOne(e,r.uri,t)}function hg(r){m.get(Ne).changeAll(r,[])}function fg(r){return m.get(Ne).read(r)}function gg(r){return m.get(Ne).onMarkerChanged(r)}function mg(r){return m.get(X).getModel(r)}function pg(){return m.get(X).getModels()}function _g(r){return m.get(X).onModelAdded(r)}function bg(r){return m.get(X).onModelRemoved(r)}function vg(r){return m.get(X).onModelLanguageChanged(t=>{r({model:t.model,oldLanguage:t.oldLanguageId})})}function yg(r){return $d(m.get(X),m.get(Ut),r)}function Cg(r,e){const t=m.get(Z),i=m.get(se);return i.registerEditorContainer(r),Is.colorizeElement(i,t,r,e)}function kg(r,e,t){const i=m.get(Z);return m.get(se).registerEditorContainer(document.body),Is.colorize(i,r,e,t)}function Sg(r,e,t=4){return m.get(se).registerEditorContainer(document.body),Is.colorizeModelLine(r,e,t)}function wg(r){const e=W.get(r);return e||{getInitialState:()=>cn,tokenize:(t,i,n)=>dr(r,n)}}function Eg(r,e){W.getOrCreate(e);const t=wg(e),i=gs(r),n=[];let s=t.getInitialState();for(let o=0,a=i.length;o<a;o++){const l=i[o],c=t.tokenize(l,!0,s);n[o]=c.tokens,s=c.endState}return n}function xg(r,e){m.get(se).defineTheme(r,e)}function Ig(r){m.get(se).setTheme(r)}function Lg(){Zu.clearAllFontInfos()}function Dg(r,e){return me.registerCommand({id:r,handler:e})}function Tg(){return{create:Zf,getEditors:ig,getDiffEditors:ng,onDidCreateEditor:eg,onDidCreateDiffEditor:tg,createDiffEditor:sg,createDiffNavigator:og,addCommand:rg,addEditorAction:ag,addKeybindingRule:lg,addKeybindingRules:Ca,createModel:cg,setModelLanguage:ug,setModelMarkers:dg,getModelMarkers:fg,removeAllMarkers:hg,onDidChangeMarkers:gg,getModels:pg,getModel:mg,onDidCreateModel:_g,onWillDisposeModel:bg,onDidChangeModelLanguage:vg,createWebWorker:yg,colorizeElement:Cg,colorize:kg,colorizeModelLine:Sg,tokenize:Eg,defineTheme:xg,setTheme:Ig,remeasureFonts:Lg,registerCommand:Dg,AccessibilitySupport:wu,ContentWidgetPositionPreference:Eu,CursorChangeReason:xu,DefaultEndOfLine:Iu,EditorAutoIndentStrategy:Lu,EditorOption:Du,EndOfLinePreference:Tu,EndOfLineSequence:Mu,MinimapPosition:Au,MouseTargetType:Ru,OverlayWidgetPositionPreference:Pu,OverviewRulerLane:Ou,RenderLineNumbersType:Fu,RenderMinimap:Bu,ScrollbarVisibility:Nu,ScrollType:Ku,TextEditorCursorBlinkingStyle:Vu,TextEditorCursorStyle:Uu,TrackedRangeStickiness:Wu,WrappingIndent:$u,InjectedTextCursorStops:zu,PositionAffinity:Hu,ConfigurationChangedEvent:qu,BareFontInfo:ju,FontInfo:Gu,TextModelResolvedOptions:Yu,FindMatch:Qu,ApplyUpdateResult:Xu,EditorType:Ju,EditorOptions:$t}}function Mg(r,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!r(t))return!1;return!0}function ai(r,e){return typeof r=="boolean"?r:e}function sr(r,e){return typeof r=="string"?r:e}function Ag(r){const e={};for(const t of r)e[t]=!0;return e}function or(r,e=!1){e&&(r=r.map(function(i){return i.toLowerCase()}));const t=Ag(r);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function us(r,e){e=e.replace(/@@/g,"");let t=0,i;do i=!1,e=e.replace(/@(\w+)/g,function(s,o){i=!0;let a="";if(typeof r[o]=="string")a=r[o];else if(r[o]&&r[o]instanceof RegExp)a=r[o].source;else throw r[o]===void 0?M(r,"language definition does not contain attribute '"+o+"', used at: "+e):M(r,"attribute reference '"+o+"' must be a string, used at: "+e);return He(a)?"":"(?:"+a+")"}),t++;while(i&&t<5);e=e.replace(/\x01/g,"@");const n=(r.ignoreCase?"i":"")+(r.unicode?"u":"");return new RegExp(e,n)}function Rg(r,e,t,i){if(i<0)return r;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function Pg(r,e,t,i){let n=-1,s=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(n=parseInt(o[3]),o[2]&&(n=n+100)),s=o[4]);let a="~",l=s;!s||s.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=s.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const u=or(l.split("|"),r.ignoreCase);c=function(d){return a==="~"?u(d):!u(d)}}else if(a==="@"||a==="!@"){const u=r[l];if(!u)throw M(r,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!Mg(function(h){return typeof h=="string"},u))throw M(r,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const d=or(u,r.ignoreCase);c=function(h){return a==="@"?d(h):!d(h)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const u=us(r,"^"+l+"$");c=function(d){return a==="~"?u.test(d):!u.test(d)}}else c=function(u,d,h,f){return us(r,"^"+ve(r,l,d,h,f)+"$").test(u)};else if(l.indexOf("$")<0){const u=we(r,l);c=function(d){return a==="=="?d===u:d!==u}}else{const u=we(r,l);c=function(d,h,f,g,p){const v=ve(r,u,h,f,g);return a==="=="?d===v:d!==v}}return n===-1?{name:t,value:i,test:function(u,d,h,f){return c(u,u,d,h,f)}}:{name:t,value:i,test:function(u,d,h,f){const g=Rg(u,d,h,n);return c(g||"",u,d,h,f)}}}function ds(r,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw M(r,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw M(r,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw M(r,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!Gd(r,ve(r,n,"",[],""))))throw M(r,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,r.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,s=t.length;n<s;n++)i[n]=ds(r,e,t[n]);return{group:i}}else if(t.cases){const i=[];for(const s in t.cases)if(t.cases.hasOwnProperty(s)){const o=ds(r,e,t.cases[s]);s==="@default"||s==="@"||s===""?i.push({test:void 0,value:o,name:s}):s==="@eos"?i.push({test:function(a,l,c,u){return u},value:o,name:s}):i.push(Pg(r,e,s,o))}const n=r.defaultToken;return{test:function(s,o,a,l){for(const c of i)if(!c.test||c.test(s,o,a,l))return c.value;return n}}}else throw M(r,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class Og{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw M(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=us(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")")}setAction(e,t){this.action=ds(e,this.name,t)}}function ka(r,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={};t.languageId=r,t.includeLF=ai(e.includeLF,!1),t.noThrow=!1,t.maxStack=100,t.start=typeof e.start=="string"?e.start:null,t.ignoreCase=ai(e.ignoreCase,!1),t.unicode=ai(e.unicode,!1),t.tokenPostfix=sr(e.tokenPostfix,"."+t.languageId),t.defaultToken=sr(e.defaultToken,"source"),t.usesEmbedded=!1;const i=e;i.languageId=r,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(o,a,l){for(const c of l){let u=c.include;if(u){if(typeof u!="string")throw M(t,"an 'include' attribute must be a string at: "+o);if(u[0]==="@"&&(u=u.substr(1)),!e.tokenizer[u])throw M(t,"include target '"+u+"' is not defined at: "+o);n(o+"."+u,a,e.tokenizer[u])}else{const d=new Og(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(d.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")d.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const h=c[1];h.next=c[2],d.setAction(i,h)}else throw M(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else d.setAction(i,c[1]);else{if(!c.regex)throw M(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(d.name=c.name),c.matchOnlyAtStart&&(d.matchOnlyAtLineStart=ai(c.matchOnlyAtLineStart,!1)),d.setRegex(i,c.regex),d.setAction(i,c.action)}a.push(d)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw M(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,n("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw M(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const s=[];for(const o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw M(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")s.push({token:a.token+t.tokenPostfix,open:we(t,a.open),close:we(t,a.close)});else throw M(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=s,t.noThrow=!0,t}var Fg=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((i=i.apply(r,e||[])).next())})};function Bg(r){pi.registerLanguage(r)}function Ng(){let r=[];return r=r.concat(pi.getLanguages()),r}function Kg(r){return m.get(Z).languageIdCodec.encodeLanguageId(r)}function Vg(r,e){const i=m.get(Z).onDidEncounterLanguage(n=>{n===r&&(i.dispose(),e())});return i}function Ug(r,e){if(!m.get(Z).isRegisteredLanguageId(r))throw new Error(`Cannot set configuration for unknown language ${r}`);return m.get(Ut).register(r,e,100)}class Wg{constructor(e,t){this._languageId=e,this._actual=t}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return Vt.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new ps(n.tokens,n.endState)}}class Vt{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let s=0,o=e.length;s<o;s++){const a=e[s];let l=a.startIndex;s===0?l=0:l<n&&(l=n),i[s]=new fi(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const s=t.tokenize(i,n),o=Vt._toClassicTokens(s.tokens,e);let a;return s.endState.equals(n)?a=n:a=s.endState,new hr(o,a)}tokenize(e,t,i){return Vt.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,s=[];let o=0,a=0;for(let c=0,u=t.length;c<u;c++){const d=t[c],h=n.match(i,d.scopes);if(o>0&&s[o-1]===h)continue;let f=d.startIndex;c===0?f=0:f<a&&(f=a),s[o++]=f,s[o++]=h,a=f}const l=new Uint32Array(o);for(let c=0;c<o;c++)l[c]=s[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),s=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let o;return n.endState.equals(i)?o=i:o=n.endState,new ps(s,o)}}function $g(r){return typeof r.getInitialState=="function"}function zg(r){return"tokenizeEncoded"in r}function Sa(r){return r&&typeof r.then=="function"}function Hg(r){const e=m.get(se);if(r){const t=[null];for(let i=1,n=r.length;i<n;i++)t[i]=ge.fromHex(r[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function wa(r,e){return zg(e)?new Wg(r,e):new Vt(r,e,m.get(Z),m.get(se))}function Ks(r,e){const t={createTokenizationSupport:()=>Fg(this,void 0,void 0,function*(){const i=yield Promise.resolve(e.create());return i?$g(i)?wa(r,i):new Rt(m.get(Z),m.get(se),r,ka(r,i),m.get(de)):null})};return W.registerFactory(r,t)}function qg(r,e){if(!m.get(Z).isRegisteredLanguageId(r))throw new Error(`Cannot set tokens provider for unknown language ${r}`);return Sa(e)?Ks(r,{create:()=>e}):W.register(r,wa(r,e))}function jg(r,e){const t=i=>new Rt(m.get(Z),m.get(se),r,ka(r,i),m.get(de));return Sa(e)?Ks(r,{create:()=>e}):W.register(r,t(e))}function Gg(r,e){return m.get(P).referenceProvider.register(r,e)}function Yg(r,e){return m.get(P).renameProvider.register(r,e)}function Qg(r,e){return m.get(P).signatureHelpProvider.register(r,e)}function Xg(r,e){return m.get(P).hoverProvider.register(r,{provideHover:(i,n,s)=>{const o=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,s)).then(a=>{if(a)return!a.range&&o&&(a.range=new U(n.lineNumber,o.startColumn,n.lineNumber,o.endColumn)),a.range||(a.range=new U(n.lineNumber,n.column,n.lineNumber,n.column)),a})}})}function Jg(r,e){return m.get(P).documentSymbolProvider.register(r,e)}function Zg(r,e){return m.get(P).documentHighlightProvider.register(r,e)}function em(r,e){return m.get(P).linkedEditingRangeProvider.register(r,e)}function tm(r,e){return m.get(P).definitionProvider.register(r,e)}function im(r,e){return m.get(P).implementationProvider.register(r,e)}function nm(r,e){return m.get(P).typeDefinitionProvider.register(r,e)}function sm(r,e){return m.get(P).codeLensProvider.register(r,e)}function om(r,e,t){return m.get(P).codeActionProvider.register(r,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(n,s,o,a)=>{const c=m.get(Ne).read({resource:n.uri}).filter(u=>U.areIntersectingOrTouching(u,s));return e.provideCodeActions(n,s,{markers:c,only:o.only,trigger:o.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function rm(r,e){return m.get(P).documentFormattingEditProvider.register(r,e)}function am(r,e){return m.get(P).documentRangeFormattingEditProvider.register(r,e)}function lm(r,e){return m.get(P).onTypeFormattingEditProvider.register(r,e)}function cm(r,e){return m.get(P).linkProvider.register(r,e)}function um(r,e){return m.get(P).completionProvider.register(r,e)}function dm(r,e){return m.get(P).colorProvider.register(r,e)}function hm(r,e){return m.get(P).foldingRangeProvider.register(r,e)}function fm(r,e){return m.get(P).declarationProvider.register(r,e)}function gm(r,e){return m.get(P).selectionRangeProvider.register(r,e)}function mm(r,e){return m.get(P).documentSemanticTokensProvider.register(r,e)}function pm(r,e){return m.get(P).documentRangeSemanticTokensProvider.register(r,e)}function _m(r,e){return m.get(P).inlineCompletionsProvider.register(r,e)}function bm(r,e){return m.get(P).inlayHintsProvider.register(r,e)}function vm(){return{register:Bg,getLanguages:Ng,onLanguage:Vg,getEncodedLanguageId:Kg,setLanguageConfiguration:Ug,setColorMap:Hg,registerTokensProviderFactory:Ks,setTokensProvider:qg,setMonarchTokensProvider:jg,registerReferenceProvider:Gg,registerRenameProvider:Yg,registerCompletionItemProvider:um,registerSignatureHelpProvider:Qg,registerHoverProvider:Xg,registerDocumentSymbolProvider:Jg,registerDocumentHighlightProvider:Zg,registerLinkedEditingRangeProvider:em,registerDefinitionProvider:tm,registerImplementationProvider:im,registerTypeDefinitionProvider:nm,registerCodeLensProvider:sm,registerCodeActionProvider:om,registerDocumentFormattingEditProvider:rm,registerDocumentRangeFormattingEditProvider:am,registerOnTypeFormattingEditProvider:lm,registerLinkProvider:cm,registerColorProvider:dm,registerFoldingRangeProvider:hm,registerDeclarationProvider:fm,registerSelectionRangeProvider:gm,registerDocumentSemanticTokensProvider:mm,registerDocumentRangeSemanticTokensProvider:pm,registerInlineCompletionsProvider:_m,registerInlayHintsProvider:bm,DocumentHighlightKind:td,CompletionItemKind:id,CompletionItemTag:nd,CompletionItemInsertTextRule:sd,SymbolKind:od,SymbolTag:rd,IndentAction:ad,CompletionTriggerKind:ld,SignatureHelpTriggerKind:cd,InlayHintKind:ud,InlineCompletionTriggerKind:dd,CodeActionTriggerType:hd,FoldingRangeKind:fd}}var ln;$t.wrappingIndent.defaultValue=0;$t.glyphMargin.defaultValue=!1;$t.autoIndent.defaultValue=3;$t.overviewRulerLanes.defaultValue=2;gd.setFormatterSelector((r,e,t)=>Promise.resolve(r[0]));const $=zr();$.editor=Tg();$.languages=vm();const ym=$.CancellationTokenSource,Cm=$.Emitter,km=$.KeyCode,Sm=$.KeyMod,wm=$.Position,Em=$.Range,xm=$.Selection,Im=$.SelectionDirection,Lm=$.MarkerSeverity,Dm=$.MarkerTag,Tm=$.Uri,Mm=$.Token,Am=$.editor,Rm=$.languages;(!((ln=ee.MonacoEnvironment)===null||ln===void 0)&&ln.globalAPI||typeof define=="function"&&define.amd)&&(self.monaco=$);typeof self.require<"u"&&typeof self.require.config=="function"&&self.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const fp=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:ym,Emitter:Cm,KeyCode:km,KeyMod:Sm,MarkerSeverity:Lm,MarkerTag:Dm,Position:wm,Range:Em,Selection:xm,SelectionDirection:Im,Token:Mm,Uri:Tm,editor:Am,languages:Rm},Symbol.toStringTag,{value:"Module"}));export{fp as m};
//# sourceMappingURL=editor.api-66f2c498.js.map
