{"version":3,"file":"editor.api-771045c4.js","sources":["../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/editorBaseApi.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffNavigator.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/worker/simpleWorker.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/defaultWorkerFactory.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/diff/diffComputer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/model/mirrorTextModel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/languages/linkComputer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/languages/supports/inplaceReplaceSupport.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/services/editorWorkerService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/services/webWorker.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/common/monarch/monarchCommon.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/common/monarch/monarchLexer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/colorizer.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/services/abstractCodeEditorService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneCodeEditorService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/layout/browser/layoutService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneLayoutService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/undoRedo/common/undoRedoService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/configuration/common/configurationModels.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/keybinding/common/abstractKeybindingService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/keybinding/common/keybindingResolver.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/keybinding/common/resolvedKeybindingItem.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/keybinding/common/baseResolvedKeybinding.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/keybinding/common/usLayoutResolvedKeybinding.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/contextview/contextview.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextViewService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/glob.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/languagesAssociations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/languagesRegistry.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/languageService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/codicons/codiconStyles.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextMenuHandler.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextMenuService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/editor/common/editor.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/browser/services/openerService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/button/button.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/progressbar/progressbar.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/parts/quickinput/browser/quickInputUtils.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/parts/quickinput/browser/quickInputBox.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/browser/ui/keybindingLabel/keybindingLabel.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/common/comparers.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/parts/quickinput/browser/quickInputList.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/base/parts/quickinput/browser/quickInput.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/quickinput/common/quickAccess.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/quickAccess.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/quickInput.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickInput/standaloneQuickInputService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/languages/supports/tokenization.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/common/themes.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/theme/browser/iconsStyleSheet.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneThemeService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/common/standaloneTheme.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/accessibility/browser/accessibilityService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/actions/common/menuService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/clipboard/browser/clipboardService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/contextkey/browser/contextKeyService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/instantiation/common/graph.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiationService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/markers/common/markerService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/languageSelector.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/languageFeatureRegistry.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/common/services/languageFeaturesService.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/platform/configuration/common/configurations.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneServices.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneCodeEditor.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneEditor.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/common/monarch/monarchCompile.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneLanguages.js","../../node_modules/.pnpm/monaco-editor@0.34.1/node_modules/monaco-editor/esm/vs/editor/editor.api.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { KeyChord } from '../../../base/common/keyCodes.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { Position } from '../core/position.js';\nimport { Range } from '../core/range.js';\nimport { Selection } from '../core/selection.js';\nimport { Token } from '../languages.js';\nimport * as standaloneEnums from '../standalone/standaloneEnums.js';\nexport class KeyMod {\n    static chord(firstPart, secondPart) {\n        return KeyChord(firstPart, secondPart);\n    }\n}\nKeyMod.CtrlCmd = 2048 /* ConstKeyMod.CtrlCmd */;\nKeyMod.Shift = 1024 /* ConstKeyMod.Shift */;\nKeyMod.Alt = 512 /* ConstKeyMod.Alt */;\nKeyMod.WinCtrl = 256 /* ConstKeyMod.WinCtrl */;\nexport function createMonacoBaseAPI() {\n    return {\n        editor: undefined,\n        languages: undefined,\n        CancellationTokenSource: CancellationTokenSource,\n        Emitter: Emitter,\n        KeyCode: standaloneEnums.KeyCode,\n        KeyMod: KeyMod,\n        Position: Position,\n        Range: Range,\n        Selection: Selection,\n        SelectionDirection: standaloneEnums.SelectionDirection,\n        MarkerSeverity: standaloneEnums.MarkerSeverity,\n        MarkerTag: standaloneEnums.MarkerTag,\n        Uri: URI,\n        Token: Token\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as assert from '../../../base/common/assert.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as objects from '../../../base/common/objects.js';\nimport { Range } from '../../common/core/range.js';\nconst defaultOptions = {\n    followsCaret: true,\n    ignoreCharChanges: true,\n    alwaysRevealFirst: true\n};\n/**\n * Create a new diff navigator for the provided diff editor.\n */\nexport class DiffNavigator extends Disposable {\n    constructor(editor, options = {}) {\n        super();\n        this._onDidUpdate = this._register(new Emitter());\n        this._editor = editor;\n        this._options = objects.mixin(options, defaultOptions, false);\n        this.disposed = false;\n        this.nextIdx = -1;\n        this.ranges = [];\n        this.ignoreSelectionChange = false;\n        this.revealFirst = Boolean(this._options.alwaysRevealFirst);\n        // hook up to diff editor for diff, disposal, and caret move\n        this._register(this._editor.onDidDispose(() => this.dispose()));\n        this._register(this._editor.onDidUpdateDiff(() => this._onDiffUpdated()));\n        if (this._options.followsCaret) {\n            this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e) => {\n                if (this.ignoreSelectionChange) {\n                    return;\n                }\n                this.nextIdx = -1;\n            }));\n        }\n        if (this._options.alwaysRevealFirst) {\n            this._register(this._editor.getModifiedEditor().onDidChangeModel((e) => {\n                this.revealFirst = true;\n            }));\n        }\n        // init things\n        this._init();\n    }\n    _init() {\n        const changes = this._editor.getLineChanges();\n        if (!changes) {\n            return;\n        }\n    }\n    _onDiffUpdated() {\n        this._init();\n        this._compute(this._editor.getLineChanges());\n        if (this.revealFirst) {\n            // Only reveal first on first non-null changes\n            if (this._editor.getLineChanges() !== null) {\n                this.revealFirst = false;\n                this.nextIdx = -1;\n                this.next(1 /* ScrollType.Immediate */);\n            }\n        }\n    }\n    _compute(lineChanges) {\n        // new ranges\n        this.ranges = [];\n        if (lineChanges) {\n            // create ranges from changes\n            lineChanges.forEach((lineChange) => {\n                if (!this._options.ignoreCharChanges && lineChange.charChanges) {\n                    lineChange.charChanges.forEach((charChange) => {\n                        this.ranges.push({\n                            rhs: true,\n                            range: new Range(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn)\n                        });\n                    });\n                }\n                else {\n                    if (lineChange.modifiedEndLineNumber === 0) {\n                        // a deletion\n                        this.ranges.push({\n                            rhs: true,\n                            range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedStartLineNumber + 1, 1)\n                        });\n                    }\n                    else {\n                        // an insertion or modification\n                        this.ranges.push({\n                            rhs: true,\n                            range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber + 1, 1)\n                        });\n                    }\n                }\n            });\n        }\n        // sort\n        this.ranges.sort((left, right) => Range.compareRangesUsingStarts(left.range, right.range));\n        this._onDidUpdate.fire(this);\n    }\n    _initIdx(fwd) {\n        let found = false;\n        const position = this._editor.getPosition();\n        if (!position) {\n            this.nextIdx = 0;\n            return;\n        }\n        for (let i = 0, len = this.ranges.length; i < len && !found; i++) {\n            const range = this.ranges[i].range;\n            if (position.isBeforeOrEqual(range.getStartPosition())) {\n                this.nextIdx = i + (fwd ? 0 : -1);\n                found = true;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this.nextIdx = fwd ? 0 : this.ranges.length - 1;\n        }\n        if (this.nextIdx < 0) {\n            this.nextIdx = this.ranges.length - 1;\n        }\n    }\n    _move(fwd, scrollType) {\n        assert.ok(!this.disposed, 'Illegal State - diff navigator has been disposed');\n        if (!this.canNavigate()) {\n            return;\n        }\n        if (this.nextIdx === -1) {\n            this._initIdx(fwd);\n        }\n        else if (fwd) {\n            this.nextIdx += 1;\n            if (this.nextIdx >= this.ranges.length) {\n                this.nextIdx = 0;\n            }\n        }\n        else {\n            this.nextIdx -= 1;\n            if (this.nextIdx < 0) {\n                this.nextIdx = this.ranges.length - 1;\n            }\n        }\n        const info = this.ranges[this.nextIdx];\n        this.ignoreSelectionChange = true;\n        try {\n            const pos = info.range.getStartPosition();\n            this._editor.setPosition(pos);\n            this._editor.revealRangeInCenter(info.range, scrollType);\n        }\n        finally {\n            this.ignoreSelectionChange = false;\n        }\n    }\n    canNavigate() {\n        return this.ranges && this.ranges.length > 0;\n    }\n    next(scrollType = 0 /* ScrollType.Smooth */) {\n        this._move(true, scrollType);\n    }\n    previous(scrollType = 0 /* ScrollType.Smooth */) {\n        this._move(false, scrollType);\n    }\n    dispose() {\n        super.dispose();\n        this.ranges = [];\n        this.disposed = true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { transformErrorForSerialization } from '../errors.js';\nimport { Emitter } from '../event.js';\nimport { Disposable } from '../lifecycle.js';\nimport { globals, isWeb } from '../platform.js';\nimport * as types from '../types.js';\nimport * as strings from '../strings.js';\nconst INITIALIZE = '$initialize';\nlet webWorkerWarningLogged = false;\nexport function logOnceWebWorkerWarning(err) {\n    if (!isWeb) {\n        // running tests\n        return;\n    }\n    if (!webWorkerWarningLogged) {\n        webWorkerWarningLogged = true;\n        console.warn('Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq');\n    }\n    console.warn(err.message);\n}\nclass RequestMessage {\n    constructor(vsWorker, req, method, args) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.method = method;\n        this.args = args;\n        this.type = 0 /* MessageType.Request */;\n    }\n}\nclass ReplyMessage {\n    constructor(vsWorker, seq, res, err) {\n        this.vsWorker = vsWorker;\n        this.seq = seq;\n        this.res = res;\n        this.err = err;\n        this.type = 1 /* MessageType.Reply */;\n    }\n}\nclass SubscribeEventMessage {\n    constructor(vsWorker, req, eventName, arg) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.eventName = eventName;\n        this.arg = arg;\n        this.type = 2 /* MessageType.SubscribeEvent */;\n    }\n}\nclass EventMessage {\n    constructor(vsWorker, req, event) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.event = event;\n        this.type = 3 /* MessageType.Event */;\n    }\n}\nclass UnsubscribeEventMessage {\n    constructor(vsWorker, req) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.type = 4 /* MessageType.UnsubscribeEvent */;\n    }\n}\nclass SimpleWorkerProtocol {\n    constructor(handler) {\n        this._workerId = -1;\n        this._handler = handler;\n        this._lastSentReq = 0;\n        this._pendingReplies = Object.create(null);\n        this._pendingEmitters = new Map();\n        this._pendingEvents = new Map();\n    }\n    setWorkerId(workerId) {\n        this._workerId = workerId;\n    }\n    sendMessage(method, args) {\n        const req = String(++this._lastSentReq);\n        return new Promise((resolve, reject) => {\n            this._pendingReplies[req] = {\n                resolve: resolve,\n                reject: reject\n            };\n            this._send(new RequestMessage(this._workerId, req, method, args));\n        });\n    }\n    listen(eventName, arg) {\n        let req = null;\n        const emitter = new Emitter({\n            onFirstListenerAdd: () => {\n                req = String(++this._lastSentReq);\n                this._pendingEmitters.set(req, emitter);\n                this._send(new SubscribeEventMessage(this._workerId, req, eventName, arg));\n            },\n            onLastListenerRemove: () => {\n                this._pendingEmitters.delete(req);\n                this._send(new UnsubscribeEventMessage(this._workerId, req));\n                req = null;\n            }\n        });\n        return emitter.event;\n    }\n    handleMessage(message) {\n        if (!message || !message.vsWorker) {\n            return;\n        }\n        if (this._workerId !== -1 && message.vsWorker !== this._workerId) {\n            return;\n        }\n        this._handleMessage(message);\n    }\n    _handleMessage(msg) {\n        switch (msg.type) {\n            case 1 /* MessageType.Reply */:\n                return this._handleReplyMessage(msg);\n            case 0 /* MessageType.Request */:\n                return this._handleRequestMessage(msg);\n            case 2 /* MessageType.SubscribeEvent */:\n                return this._handleSubscribeEventMessage(msg);\n            case 3 /* MessageType.Event */:\n                return this._handleEventMessage(msg);\n            case 4 /* MessageType.UnsubscribeEvent */:\n                return this._handleUnsubscribeEventMessage(msg);\n        }\n    }\n    _handleReplyMessage(replyMessage) {\n        if (!this._pendingReplies[replyMessage.seq]) {\n            console.warn('Got reply to unknown seq');\n            return;\n        }\n        const reply = this._pendingReplies[replyMessage.seq];\n        delete this._pendingReplies[replyMessage.seq];\n        if (replyMessage.err) {\n            let err = replyMessage.err;\n            if (replyMessage.err.$isError) {\n                err = new Error();\n                err.name = replyMessage.err.name;\n                err.message = replyMessage.err.message;\n                err.stack = replyMessage.err.stack;\n            }\n            reply.reject(err);\n            return;\n        }\n        reply.resolve(replyMessage.res);\n    }\n    _handleRequestMessage(requestMessage) {\n        const req = requestMessage.req;\n        const result = this._handler.handleMessage(requestMessage.method, requestMessage.args);\n        result.then((r) => {\n            this._send(new ReplyMessage(this._workerId, req, r, undefined));\n        }, (e) => {\n            if (e.detail instanceof Error) {\n                // Loading errors have a detail property that points to the actual error\n                e.detail = transformErrorForSerialization(e.detail);\n            }\n            this._send(new ReplyMessage(this._workerId, req, undefined, transformErrorForSerialization(e)));\n        });\n    }\n    _handleSubscribeEventMessage(msg) {\n        const req = msg.req;\n        const disposable = this._handler.handleEvent(msg.eventName, msg.arg)((event) => {\n            this._send(new EventMessage(this._workerId, req, event));\n        });\n        this._pendingEvents.set(req, disposable);\n    }\n    _handleEventMessage(msg) {\n        if (!this._pendingEmitters.has(msg.req)) {\n            console.warn('Got event for unknown req');\n            return;\n        }\n        this._pendingEmitters.get(msg.req).fire(msg.event);\n    }\n    _handleUnsubscribeEventMessage(msg) {\n        if (!this._pendingEvents.has(msg.req)) {\n            console.warn('Got unsubscribe for unknown req');\n            return;\n        }\n        this._pendingEvents.get(msg.req).dispose();\n        this._pendingEvents.delete(msg.req);\n    }\n    _send(msg) {\n        const transfer = [];\n        if (msg.type === 0 /* MessageType.Request */) {\n            for (let i = 0; i < msg.args.length; i++) {\n                if (msg.args[i] instanceof ArrayBuffer) {\n                    transfer.push(msg.args[i]);\n                }\n            }\n        }\n        else if (msg.type === 1 /* MessageType.Reply */) {\n            if (msg.res instanceof ArrayBuffer) {\n                transfer.push(msg.res);\n            }\n        }\n        this._handler.sendMessage(msg, transfer);\n    }\n}\n/**\n * Main thread side\n */\nexport class SimpleWorkerClient extends Disposable {\n    constructor(workerFactory, moduleId, host) {\n        super();\n        let lazyProxyReject = null;\n        this._worker = this._register(workerFactory.create('vs/base/common/worker/simpleWorker', (msg) => {\n            this._protocol.handleMessage(msg);\n        }, (err) => {\n            // in Firefox, web workers fail lazily :(\n            // we will reject the proxy\n            lazyProxyReject === null || lazyProxyReject === void 0 ? void 0 : lazyProxyReject(err);\n        }));\n        this._protocol = new SimpleWorkerProtocol({\n            sendMessage: (msg, transfer) => {\n                this._worker.postMessage(msg, transfer);\n            },\n            handleMessage: (method, args) => {\n                if (typeof host[method] !== 'function') {\n                    return Promise.reject(new Error('Missing method ' + method + ' on main thread host.'));\n                }\n                try {\n                    return Promise.resolve(host[method].apply(host, args));\n                }\n                catch (e) {\n                    return Promise.reject(e);\n                }\n            },\n            handleEvent: (eventName, arg) => {\n                if (propertyIsDynamicEvent(eventName)) {\n                    const event = host[eventName].call(host, arg);\n                    if (typeof event !== 'function') {\n                        throw new Error(`Missing dynamic event ${eventName} on main thread host.`);\n                    }\n                    return event;\n                }\n                if (propertyIsEvent(eventName)) {\n                    const event = host[eventName];\n                    if (typeof event !== 'function') {\n                        throw new Error(`Missing event ${eventName} on main thread host.`);\n                    }\n                    return event;\n                }\n                throw new Error(`Malformed event name ${eventName}`);\n            }\n        });\n        this._protocol.setWorkerId(this._worker.getId());\n        // Gather loader configuration\n        let loaderConfiguration = null;\n        if (typeof globals.require !== 'undefined' && typeof globals.require.getConfig === 'function') {\n            // Get the configuration from the Monaco AMD Loader\n            loaderConfiguration = globals.require.getConfig();\n        }\n        else if (typeof globals.requirejs !== 'undefined') {\n            // Get the configuration from requirejs\n            loaderConfiguration = globals.requirejs.s.contexts._.config;\n        }\n        const hostMethods = types.getAllMethodNames(host);\n        // Send initialize message\n        this._onModuleLoaded = this._protocol.sendMessage(INITIALIZE, [\n            this._worker.getId(),\n            JSON.parse(JSON.stringify(loaderConfiguration)),\n            moduleId,\n            hostMethods,\n        ]);\n        // Create proxy to loaded code\n        const proxyMethodRequest = (method, args) => {\n            return this._request(method, args);\n        };\n        const proxyListen = (eventName, arg) => {\n            return this._protocol.listen(eventName, arg);\n        };\n        this._lazyProxy = new Promise((resolve, reject) => {\n            lazyProxyReject = reject;\n            this._onModuleLoaded.then((availableMethods) => {\n                resolve(createProxyObject(availableMethods, proxyMethodRequest, proxyListen));\n            }, (e) => {\n                reject(e);\n                this._onError('Worker failed to load ' + moduleId, e);\n            });\n        });\n    }\n    getProxyObject() {\n        return this._lazyProxy;\n    }\n    _request(method, args) {\n        return new Promise((resolve, reject) => {\n            this._onModuleLoaded.then(() => {\n                this._protocol.sendMessage(method, args).then(resolve, reject);\n            }, reject);\n        });\n    }\n    _onError(message, error) {\n        console.error(message);\n        console.info(error);\n    }\n}\nfunction propertyIsEvent(name) {\n    // Assume a property is an event if it has a form of \"onSomething\"\n    return name[0] === 'o' && name[1] === 'n' && strings.isUpperAsciiLetter(name.charCodeAt(2));\n}\nfunction propertyIsDynamicEvent(name) {\n    // Assume a property is a dynamic event (a method that returns an event) if it has a form of \"onDynamicSomething\"\n    return /^onDynamic/.test(name) && strings.isUpperAsciiLetter(name.charCodeAt(9));\n}\nfunction createProxyObject(methodNames, invoke, proxyListen) {\n    const createProxyMethod = (method) => {\n        return function () {\n            const args = Array.prototype.slice.call(arguments, 0);\n            return invoke(method, args);\n        };\n    };\n    const createProxyDynamicEvent = (eventName) => {\n        return function (arg) {\n            return proxyListen(eventName, arg);\n        };\n    };\n    const result = {};\n    for (const methodName of methodNames) {\n        if (propertyIsDynamicEvent(methodName)) {\n            result[methodName] = createProxyDynamicEvent(methodName);\n            continue;\n        }\n        if (propertyIsEvent(methodName)) {\n            result[methodName] = proxyListen(methodName, undefined);\n            continue;\n        }\n        result[methodName] = createProxyMethod(methodName);\n    }\n    return result;\n}\n/**\n * Worker side\n */\nexport class SimpleWorkerServer {\n    constructor(postMessage, requestHandlerFactory) {\n        this._requestHandlerFactory = requestHandlerFactory;\n        this._requestHandler = null;\n        this._protocol = new SimpleWorkerProtocol({\n            sendMessage: (msg, transfer) => {\n                postMessage(msg, transfer);\n            },\n            handleMessage: (method, args) => this._handleMessage(method, args),\n            handleEvent: (eventName, arg) => this._handleEvent(eventName, arg)\n        });\n    }\n    onmessage(msg) {\n        this._protocol.handleMessage(msg);\n    }\n    _handleMessage(method, args) {\n        if (method === INITIALIZE) {\n            return this.initialize(args[0], args[1], args[2], args[3]);\n        }\n        if (!this._requestHandler || typeof this._requestHandler[method] !== 'function') {\n            return Promise.reject(new Error('Missing requestHandler or method: ' + method));\n        }\n        try {\n            return Promise.resolve(this._requestHandler[method].apply(this._requestHandler, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _handleEvent(eventName, arg) {\n        if (!this._requestHandler) {\n            throw new Error(`Missing requestHandler`);\n        }\n        if (propertyIsDynamicEvent(eventName)) {\n            const event = this._requestHandler[eventName].call(this._requestHandler, arg);\n            if (typeof event !== 'function') {\n                throw new Error(`Missing dynamic event ${eventName} on request handler.`);\n            }\n            return event;\n        }\n        if (propertyIsEvent(eventName)) {\n            const event = this._requestHandler[eventName];\n            if (typeof event !== 'function') {\n                throw new Error(`Missing event ${eventName} on request handler.`);\n            }\n            return event;\n        }\n        throw new Error(`Malformed event name ${eventName}`);\n    }\n    initialize(workerId, loaderConfig, moduleId, hostMethods) {\n        this._protocol.setWorkerId(workerId);\n        const proxyMethodRequest = (method, args) => {\n            return this._protocol.sendMessage(method, args);\n        };\n        const proxyListen = (eventName, arg) => {\n            return this._protocol.listen(eventName, arg);\n        };\n        const hostProxy = createProxyObject(hostMethods, proxyMethodRequest, proxyListen);\n        if (this._requestHandlerFactory) {\n            // static request handler\n            this._requestHandler = this._requestHandlerFactory(hostProxy);\n            return Promise.resolve(types.getAllMethodNames(this._requestHandler));\n        }\n        if (loaderConfig) {\n            // Remove 'baseUrl', handling it is beyond scope for now\n            if (typeof loaderConfig.baseUrl !== 'undefined') {\n                delete loaderConfig['baseUrl'];\n            }\n            if (typeof loaderConfig.paths !== 'undefined') {\n                if (typeof loaderConfig.paths.vs !== 'undefined') {\n                    delete loaderConfig.paths['vs'];\n                }\n            }\n            if (typeof loaderConfig.trustedTypesPolicy !== undefined) {\n                // don't use, it has been destroyed during serialize\n                delete loaderConfig['trustedTypesPolicy'];\n            }\n            // Since this is in a web worker, enable catching errors\n            loaderConfig.catchError = true;\n            globals.require.config(loaderConfig);\n        }\n        return new Promise((resolve, reject) => {\n            // Use the global require to be sure to get the global config\n            // ESM-comment-begin\n            // \t\t\tconst req = (globals.require || require);\n            // ESM-comment-end\n            // ESM-uncomment-begin\n            const req = globals.require;\n            // ESM-uncomment-end\n            req([moduleId], (module) => {\n                this._requestHandler = module.create(hostProxy);\n                if (!this._requestHandler) {\n                    reject(new Error(`No RequestHandler!`));\n                    return;\n                }\n                resolve(types.getAllMethodNames(this._requestHandler));\n            }, reject);\n        });\n    }\n}\n/**\n * Called on the worker side\n */\nexport function create(postMessage) {\n    return new SimpleWorkerServer(postMessage, null);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a;\nimport { globals } from '../common/platform.js';\nimport { logOnceWebWorkerWarning } from '../common/worker/simpleWorker.js';\nconst ttPolicy = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });\nfunction getWorker(label) {\n    // Option for hosts to overwrite the worker script (used in the standalone editor)\n    if (globals.MonacoEnvironment) {\n        if (typeof globals.MonacoEnvironment.getWorker === 'function') {\n            return globals.MonacoEnvironment.getWorker('workerMain.js', label);\n        }\n        if (typeof globals.MonacoEnvironment.getWorkerUrl === 'function') {\n            const workerUrl = globals.MonacoEnvironment.getWorkerUrl('workerMain.js', label);\n            return new Worker(ttPolicy ? ttPolicy.createScriptURL(workerUrl) : workerUrl, { name: label });\n        }\n    }\n    // ESM-comment-begin\n    // \tif (typeof require === 'function') {\n    // \t\t// check if the JS lives on a different origin\n    // \t\tconst workerMain = require.toUrl('vs/base/worker/workerMain.js'); // explicitly using require.toUrl(), see https://github.com/microsoft/vscode/issues/107440#issuecomment-698982321\n    // \t\tconst workerUrl = getWorkerBootstrapUrl(workerMain, label);\n    // \t\treturn new Worker(ttPolicy ? ttPolicy.createScriptURL(workerUrl) as unknown as string : workerUrl, { name: label });\n    // \t}\n    // ESM-comment-end\n    throw new Error(`You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker`);\n}\n// ESM-comment-begin\n// export function getWorkerBootstrapUrl(scriptPath: string, label: string): string {\n// \tif (/^((http:)|(https:)|(file:))/.test(scriptPath) && scriptPath.substring(0, self.origin.length) !== self.origin) {\n// \t\t// this is the cross-origin case\n// \t\t// i.e. the webpage is running at a different origin than where the scripts are loaded from\n// \t\tconst myPath = 'vs/base/worker/defaultWorkerFactory.js';\n// \t\tconst workerBaseUrl = require.toUrl(myPath).slice(0, -myPath.length); // explicitly using require.toUrl(), see https://github.com/microsoft/vscode/issues/107440#issuecomment-698982321\n// \t\tconst js = `/*${label}*/self.MonacoEnvironment={baseUrl: '${workerBaseUrl}'};const ttPolicy = self.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });importScripts(ttPolicy?.createScriptURL('${scriptPath}') ?? '${scriptPath}');/*${label}*/`;\n// \t\tconst blob = new Blob([js], { type: 'application/javascript' });\n// \t\treturn URL.createObjectURL(blob);\n// \t}\n// \treturn scriptPath + '#' + label;\n// }\n// ESM-comment-end\nfunction isPromiseLike(obj) {\n    if (typeof obj.then === 'function') {\n        return true;\n    }\n    return false;\n}\n/**\n * A worker that uses HTML5 web workers so that is has\n * its own global scope and its own thread.\n */\nclass WebWorker {\n    constructor(moduleId, id, label, onMessageCallback, onErrorCallback) {\n        this.id = id;\n        const workerOrPromise = getWorker(label);\n        if (isPromiseLike(workerOrPromise)) {\n            this.worker = workerOrPromise;\n        }\n        else {\n            this.worker = Promise.resolve(workerOrPromise);\n        }\n        this.postMessage(moduleId, []);\n        this.worker.then((w) => {\n            w.onmessage = function (ev) {\n                onMessageCallback(ev.data);\n            };\n            w.onmessageerror = onErrorCallback;\n            if (typeof w.addEventListener === 'function') {\n                w.addEventListener('error', onErrorCallback);\n            }\n        });\n    }\n    getId() {\n        return this.id;\n    }\n    postMessage(message, transfer) {\n        var _a;\n        (_a = this.worker) === null || _a === void 0 ? void 0 : _a.then(w => w.postMessage(message, transfer));\n    }\n    dispose() {\n        var _a;\n        (_a = this.worker) === null || _a === void 0 ? void 0 : _a.then(w => w.terminate());\n        this.worker = null;\n    }\n}\nexport class DefaultWorkerFactory {\n    constructor(label) {\n        this._label = label;\n        this._webWorkerFailedBeforeError = false;\n    }\n    create(moduleId, onMessageCallback, onErrorCallback) {\n        const workerId = (++DefaultWorkerFactory.LAST_WORKER_ID);\n        if (this._webWorkerFailedBeforeError) {\n            throw this._webWorkerFailedBeforeError;\n        }\n        return new WebWorker(moduleId, workerId, this._label || 'anonymous' + workerId, onMessageCallback, (err) => {\n            logOnceWebWorkerWarning(err);\n            this._webWorkerFailedBeforeError = err;\n            onErrorCallback(err);\n        });\n    }\n}\nDefaultWorkerFactory.LAST_WORKER_ID = 0;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LcsDiff } from '../../../base/common/diff/diff.js';\nimport * as strings from '../../../base/common/strings.js';\nconst MINIMUM_MATCHING_CHARACTER_LENGTH = 3;\nfunction computeDiff(originalSequence, modifiedSequence, continueProcessingPredicate, pretty) {\n    const diffAlgo = new LcsDiff(originalSequence, modifiedSequence, continueProcessingPredicate);\n    return diffAlgo.ComputeDiff(pretty);\n}\nclass LineSequence {\n    constructor(lines) {\n        const startColumns = [];\n        const endColumns = [];\n        for (let i = 0, length = lines.length; i < length; i++) {\n            startColumns[i] = getFirstNonBlankColumn(lines[i], 1);\n            endColumns[i] = getLastNonBlankColumn(lines[i], 1);\n        }\n        this.lines = lines;\n        this._startColumns = startColumns;\n        this._endColumns = endColumns;\n    }\n    getElements() {\n        const elements = [];\n        for (let i = 0, len = this.lines.length; i < len; i++) {\n            elements[i] = this.lines[i].substring(this._startColumns[i] - 1, this._endColumns[i] - 1);\n        }\n        return elements;\n    }\n    getStrictElement(index) {\n        return this.lines[index];\n    }\n    getStartLineNumber(i) {\n        return i + 1;\n    }\n    getEndLineNumber(i) {\n        return i + 1;\n    }\n    createCharSequence(shouldIgnoreTrimWhitespace, startIndex, endIndex) {\n        const charCodes = [];\n        const lineNumbers = [];\n        const columns = [];\n        let len = 0;\n        for (let index = startIndex; index <= endIndex; index++) {\n            const lineContent = this.lines[index];\n            const startColumn = (shouldIgnoreTrimWhitespace ? this._startColumns[index] : 1);\n            const endColumn = (shouldIgnoreTrimWhitespace ? this._endColumns[index] : lineContent.length + 1);\n            for (let col = startColumn; col < endColumn; col++) {\n                charCodes[len] = lineContent.charCodeAt(col - 1);\n                lineNumbers[len] = index + 1;\n                columns[len] = col;\n                len++;\n            }\n            if (!shouldIgnoreTrimWhitespace && index < endIndex) {\n                // Add \\n if trim whitespace is not ignored\n                charCodes[len] = 10 /* CharCode.LineFeed */;\n                lineNumbers[len] = index + 1;\n                columns[len] = lineContent.length + 1;\n                len++;\n            }\n        }\n        return new CharSequence(charCodes, lineNumbers, columns);\n    }\n}\nclass CharSequence {\n    constructor(charCodes, lineNumbers, columns) {\n        this._charCodes = charCodes;\n        this._lineNumbers = lineNumbers;\n        this._columns = columns;\n    }\n    toString() {\n        return ('[' + this._charCodes.map((s, idx) => (s === 10 /* CharCode.LineFeed */ ? '\\\\n' : String.fromCharCode(s)) + `-(${this._lineNumbers[idx]},${this._columns[idx]})`).join(', ') + ']');\n    }\n    _assertIndex(index, arr) {\n        if (index < 0 || index >= arr.length) {\n            throw new Error(`Illegal index`);\n        }\n    }\n    getElements() {\n        return this._charCodes;\n    }\n    getStartLineNumber(i) {\n        if (i > 0 && i === this._lineNumbers.length) {\n            // the start line number of the element after the last element\n            // is the end line number of the last element\n            return this.getEndLineNumber(i - 1);\n        }\n        this._assertIndex(i, this._lineNumbers);\n        return this._lineNumbers[i];\n    }\n    getEndLineNumber(i) {\n        if (i === -1) {\n            // the end line number of the element before the first element\n            // is the start line number of the first element\n            return this.getStartLineNumber(i + 1);\n        }\n        this._assertIndex(i, this._lineNumbers);\n        if (this._charCodes[i] === 10 /* CharCode.LineFeed */) {\n            return this._lineNumbers[i] + 1;\n        }\n        return this._lineNumbers[i];\n    }\n    getStartColumn(i) {\n        if (i > 0 && i === this._columns.length) {\n            // the start column of the element after the last element\n            // is the end column of the last element\n            return this.getEndColumn(i - 1);\n        }\n        this._assertIndex(i, this._columns);\n        return this._columns[i];\n    }\n    getEndColumn(i) {\n        if (i === -1) {\n            // the end column of the element before the first element\n            // is the start column of the first element\n            return this.getStartColumn(i + 1);\n        }\n        this._assertIndex(i, this._columns);\n        if (this._charCodes[i] === 10 /* CharCode.LineFeed */) {\n            return 1;\n        }\n        return this._columns[i] + 1;\n    }\n}\nclass CharChange {\n    constructor(originalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn, modifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn) {\n        this.originalStartLineNumber = originalStartLineNumber;\n        this.originalStartColumn = originalStartColumn;\n        this.originalEndLineNumber = originalEndLineNumber;\n        this.originalEndColumn = originalEndColumn;\n        this.modifiedStartLineNumber = modifiedStartLineNumber;\n        this.modifiedStartColumn = modifiedStartColumn;\n        this.modifiedEndLineNumber = modifiedEndLineNumber;\n        this.modifiedEndColumn = modifiedEndColumn;\n    }\n    static createFromDiffChange(diffChange, originalCharSequence, modifiedCharSequence) {\n        const originalStartLineNumber = originalCharSequence.getStartLineNumber(diffChange.originalStart);\n        const originalStartColumn = originalCharSequence.getStartColumn(diffChange.originalStart);\n        const originalEndLineNumber = originalCharSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\n        const originalEndColumn = originalCharSequence.getEndColumn(diffChange.originalStart + diffChange.originalLength - 1);\n        const modifiedStartLineNumber = modifiedCharSequence.getStartLineNumber(diffChange.modifiedStart);\n        const modifiedStartColumn = modifiedCharSequence.getStartColumn(diffChange.modifiedStart);\n        const modifiedEndLineNumber = modifiedCharSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n        const modifiedEndColumn = modifiedCharSequence.getEndColumn(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n        return new CharChange(originalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn, modifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn);\n    }\n}\nfunction postProcessCharChanges(rawChanges) {\n    if (rawChanges.length <= 1) {\n        return rawChanges;\n    }\n    const result = [rawChanges[0]];\n    let prevChange = result[0];\n    for (let i = 1, len = rawChanges.length; i < len; i++) {\n        const currChange = rawChanges[i];\n        const originalMatchingLength = currChange.originalStart - (prevChange.originalStart + prevChange.originalLength);\n        const modifiedMatchingLength = currChange.modifiedStart - (prevChange.modifiedStart + prevChange.modifiedLength);\n        // Both of the above should be equal, but the continueProcessingPredicate may prevent this from being true\n        const matchingLength = Math.min(originalMatchingLength, modifiedMatchingLength);\n        if (matchingLength < MINIMUM_MATCHING_CHARACTER_LENGTH) {\n            // Merge the current change into the previous one\n            prevChange.originalLength = (currChange.originalStart + currChange.originalLength) - prevChange.originalStart;\n            prevChange.modifiedLength = (currChange.modifiedStart + currChange.modifiedLength) - prevChange.modifiedStart;\n        }\n        else {\n            // Add the current change\n            result.push(currChange);\n            prevChange = currChange;\n        }\n    }\n    return result;\n}\nclass LineChange {\n    constructor(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges) {\n        this.originalStartLineNumber = originalStartLineNumber;\n        this.originalEndLineNumber = originalEndLineNumber;\n        this.modifiedStartLineNumber = modifiedStartLineNumber;\n        this.modifiedEndLineNumber = modifiedEndLineNumber;\n        this.charChanges = charChanges;\n    }\n    static createFromDiffResult(shouldIgnoreTrimWhitespace, diffChange, originalLineSequence, modifiedLineSequence, continueCharDiff, shouldComputeCharChanges, shouldPostProcessCharChanges) {\n        let originalStartLineNumber;\n        let originalEndLineNumber;\n        let modifiedStartLineNumber;\n        let modifiedEndLineNumber;\n        let charChanges = undefined;\n        if (diffChange.originalLength === 0) {\n            originalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart) - 1;\n            originalEndLineNumber = 0;\n        }\n        else {\n            originalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart);\n            originalEndLineNumber = originalLineSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\n        }\n        if (diffChange.modifiedLength === 0) {\n            modifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart) - 1;\n            modifiedEndLineNumber = 0;\n        }\n        else {\n            modifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart);\n            modifiedEndLineNumber = modifiedLineSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n        }\n        if (shouldComputeCharChanges && diffChange.originalLength > 0 && diffChange.originalLength < 20 && diffChange.modifiedLength > 0 && diffChange.modifiedLength < 20 && continueCharDiff()) {\n            // Compute character changes for diff chunks of at most 20 lines...\n            const originalCharSequence = originalLineSequence.createCharSequence(shouldIgnoreTrimWhitespace, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength - 1);\n            const modifiedCharSequence = modifiedLineSequence.createCharSequence(shouldIgnoreTrimWhitespace, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength - 1);\n            if (originalCharSequence.getElements().length > 0 && modifiedCharSequence.getElements().length > 0) {\n                let rawChanges = computeDiff(originalCharSequence, modifiedCharSequence, continueCharDiff, true).changes;\n                if (shouldPostProcessCharChanges) {\n                    rawChanges = postProcessCharChanges(rawChanges);\n                }\n                charChanges = [];\n                for (let i = 0, length = rawChanges.length; i < length; i++) {\n                    charChanges.push(CharChange.createFromDiffChange(rawChanges[i], originalCharSequence, modifiedCharSequence));\n                }\n            }\n        }\n        return new LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges);\n    }\n}\nexport class DiffComputer {\n    constructor(originalLines, modifiedLines, opts) {\n        this.shouldComputeCharChanges = opts.shouldComputeCharChanges;\n        this.shouldPostProcessCharChanges = opts.shouldPostProcessCharChanges;\n        this.shouldIgnoreTrimWhitespace = opts.shouldIgnoreTrimWhitespace;\n        this.shouldMakePrettyDiff = opts.shouldMakePrettyDiff;\n        this.originalLines = originalLines;\n        this.modifiedLines = modifiedLines;\n        this.original = new LineSequence(originalLines);\n        this.modified = new LineSequence(modifiedLines);\n        this.continueLineDiff = createContinueProcessingPredicate(opts.maxComputationTime);\n        this.continueCharDiff = createContinueProcessingPredicate(opts.maxComputationTime === 0 ? 0 : Math.min(opts.maxComputationTime, 5000)); // never run after 5s for character changes...\n    }\n    computeDiff() {\n        if (this.original.lines.length === 1 && this.original.lines[0].length === 0) {\n            // empty original => fast path\n            if (this.modified.lines.length === 1 && this.modified.lines[0].length === 0) {\n                return {\n                    quitEarly: false,\n                    changes: []\n                };\n            }\n            return {\n                quitEarly: false,\n                changes: [{\n                        originalStartLineNumber: 1,\n                        originalEndLineNumber: 1,\n                        modifiedStartLineNumber: 1,\n                        modifiedEndLineNumber: this.modified.lines.length,\n                        charChanges: [{\n                                modifiedEndColumn: 0,\n                                modifiedEndLineNumber: 0,\n                                modifiedStartColumn: 0,\n                                modifiedStartLineNumber: 0,\n                                originalEndColumn: 0,\n                                originalEndLineNumber: 0,\n                                originalStartColumn: 0,\n                                originalStartLineNumber: 0\n                            }]\n                    }]\n            };\n        }\n        if (this.modified.lines.length === 1 && this.modified.lines[0].length === 0) {\n            // empty modified => fast path\n            return {\n                quitEarly: false,\n                changes: [{\n                        originalStartLineNumber: 1,\n                        originalEndLineNumber: this.original.lines.length,\n                        modifiedStartLineNumber: 1,\n                        modifiedEndLineNumber: 1,\n                        charChanges: [{\n                                modifiedEndColumn: 0,\n                                modifiedEndLineNumber: 0,\n                                modifiedStartColumn: 0,\n                                modifiedStartLineNumber: 0,\n                                originalEndColumn: 0,\n                                originalEndLineNumber: 0,\n                                originalStartColumn: 0,\n                                originalStartLineNumber: 0\n                            }]\n                    }]\n            };\n        }\n        const diffResult = computeDiff(this.original, this.modified, this.continueLineDiff, this.shouldMakePrettyDiff);\n        const rawChanges = diffResult.changes;\n        const quitEarly = diffResult.quitEarly;\n        // The diff is always computed with ignoring trim whitespace\n        // This ensures we get the prettiest diff\n        if (this.shouldIgnoreTrimWhitespace) {\n            const lineChanges = [];\n            for (let i = 0, length = rawChanges.length; i < length; i++) {\n                lineChanges.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, rawChanges[i], this.original, this.modified, this.continueCharDiff, this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\n            }\n            return {\n                quitEarly: quitEarly,\n                changes: lineChanges\n            };\n        }\n        // Need to post-process and introduce changes where the trim whitespace is different\n        // Note that we are looping starting at -1 to also cover the lines before the first change\n        const result = [];\n        let originalLineIndex = 0;\n        let modifiedLineIndex = 0;\n        for (let i = -1 /* !!!! */, len = rawChanges.length; i < len; i++) {\n            const nextChange = (i + 1 < len ? rawChanges[i + 1] : null);\n            const originalStop = (nextChange ? nextChange.originalStart : this.originalLines.length);\n            const modifiedStop = (nextChange ? nextChange.modifiedStart : this.modifiedLines.length);\n            while (originalLineIndex < originalStop && modifiedLineIndex < modifiedStop) {\n                const originalLine = this.originalLines[originalLineIndex];\n                const modifiedLine = this.modifiedLines[modifiedLineIndex];\n                if (originalLine !== modifiedLine) {\n                    // These lines differ only in trim whitespace\n                    // Check the leading whitespace\n                    {\n                        let originalStartColumn = getFirstNonBlankColumn(originalLine, 1);\n                        let modifiedStartColumn = getFirstNonBlankColumn(modifiedLine, 1);\n                        while (originalStartColumn > 1 && modifiedStartColumn > 1) {\n                            const originalChar = originalLine.charCodeAt(originalStartColumn - 2);\n                            const modifiedChar = modifiedLine.charCodeAt(modifiedStartColumn - 2);\n                            if (originalChar !== modifiedChar) {\n                                break;\n                            }\n                            originalStartColumn--;\n                            modifiedStartColumn--;\n                        }\n                        if (originalStartColumn > 1 || modifiedStartColumn > 1) {\n                            this._pushTrimWhitespaceCharChange(result, originalLineIndex + 1, 1, originalStartColumn, modifiedLineIndex + 1, 1, modifiedStartColumn);\n                        }\n                    }\n                    // Check the trailing whitespace\n                    {\n                        let originalEndColumn = getLastNonBlankColumn(originalLine, 1);\n                        let modifiedEndColumn = getLastNonBlankColumn(modifiedLine, 1);\n                        const originalMaxColumn = originalLine.length + 1;\n                        const modifiedMaxColumn = modifiedLine.length + 1;\n                        while (originalEndColumn < originalMaxColumn && modifiedEndColumn < modifiedMaxColumn) {\n                            const originalChar = originalLine.charCodeAt(originalEndColumn - 1);\n                            const modifiedChar = originalLine.charCodeAt(modifiedEndColumn - 1);\n                            if (originalChar !== modifiedChar) {\n                                break;\n                            }\n                            originalEndColumn++;\n                            modifiedEndColumn++;\n                        }\n                        if (originalEndColumn < originalMaxColumn || modifiedEndColumn < modifiedMaxColumn) {\n                            this._pushTrimWhitespaceCharChange(result, originalLineIndex + 1, originalEndColumn, originalMaxColumn, modifiedLineIndex + 1, modifiedEndColumn, modifiedMaxColumn);\n                        }\n                    }\n                }\n                originalLineIndex++;\n                modifiedLineIndex++;\n            }\n            if (nextChange) {\n                // Emit the actual change\n                result.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, nextChange, this.original, this.modified, this.continueCharDiff, this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\n                originalLineIndex += nextChange.originalLength;\n                modifiedLineIndex += nextChange.modifiedLength;\n            }\n        }\n        return {\n            quitEarly: quitEarly,\n            changes: result\n        };\n    }\n    _pushTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn) {\n        if (this._mergeTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn)) {\n            // Merged into previous\n            return;\n        }\n        let charChanges = undefined;\n        if (this.shouldComputeCharChanges) {\n            charChanges = [new CharChange(originalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn)];\n        }\n        result.push(new LineChange(originalLineNumber, originalLineNumber, modifiedLineNumber, modifiedLineNumber, charChanges));\n    }\n    _mergeTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn) {\n        const len = result.length;\n        if (len === 0) {\n            return false;\n        }\n        const prevChange = result[len - 1];\n        if (prevChange.originalEndLineNumber === 0 || prevChange.modifiedEndLineNumber === 0) {\n            // Don't merge with inserts/deletes\n            return false;\n        }\n        if (prevChange.originalEndLineNumber + 1 === originalLineNumber && prevChange.modifiedEndLineNumber + 1 === modifiedLineNumber) {\n            prevChange.originalEndLineNumber = originalLineNumber;\n            prevChange.modifiedEndLineNumber = modifiedLineNumber;\n            if (this.shouldComputeCharChanges && prevChange.charChanges) {\n                prevChange.charChanges.push(new CharChange(originalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn));\n            }\n            return true;\n        }\n        return false;\n    }\n}\nfunction getFirstNonBlankColumn(txt, defaultValue) {\n    const r = strings.firstNonWhitespaceIndex(txt);\n    if (r === -1) {\n        return defaultValue;\n    }\n    return r + 1;\n}\nfunction getLastNonBlankColumn(txt, defaultValue) {\n    const r = strings.lastNonWhitespaceIndex(txt);\n    if (r === -1) {\n        return defaultValue;\n    }\n    return r + 2;\n}\nfunction createContinueProcessingPredicate(maximumRuntime) {\n    if (maximumRuntime === 0) {\n        return () => true;\n    }\n    const startTime = Date.now();\n    return () => {\n        return Date.now() - startTime < maximumRuntime;\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { splitLines } from '../../../base/common/strings.js';\nimport { Position } from '../core/position.js';\nimport { PrefixSumComputer } from './prefixSumComputer.js';\nexport class MirrorTextModel {\n    constructor(uri, lines, eol, versionId) {\n        this._uri = uri;\n        this._lines = lines;\n        this._eol = eol;\n        this._versionId = versionId;\n        this._lineStarts = null;\n        this._cachedTextValue = null;\n    }\n    dispose() {\n        this._lines.length = 0;\n    }\n    get version() {\n        return this._versionId;\n    }\n    getText() {\n        if (this._cachedTextValue === null) {\n            this._cachedTextValue = this._lines.join(this._eol);\n        }\n        return this._cachedTextValue;\n    }\n    onEvents(e) {\n        if (e.eol && e.eol !== this._eol) {\n            this._eol = e.eol;\n            this._lineStarts = null;\n        }\n        // Update my lines\n        const changes = e.changes;\n        for (const change of changes) {\n            this._acceptDeleteRange(change.range);\n            this._acceptInsertText(new Position(change.range.startLineNumber, change.range.startColumn), change.text);\n        }\n        this._versionId = e.versionId;\n        this._cachedTextValue = null;\n    }\n    _ensureLineStarts() {\n        if (!this._lineStarts) {\n            const eolLength = this._eol.length;\n            const linesLength = this._lines.length;\n            const lineStartValues = new Uint32Array(linesLength);\n            for (let i = 0; i < linesLength; i++) {\n                lineStartValues[i] = this._lines[i].length + eolLength;\n            }\n            this._lineStarts = new PrefixSumComputer(lineStartValues);\n        }\n    }\n    /**\n     * All changes to a line's text go through this method\n     */\n    _setLineText(lineIndex, newValue) {\n        this._lines[lineIndex] = newValue;\n        if (this._lineStarts) {\n            // update prefix sum\n            this._lineStarts.setValue(lineIndex, this._lines[lineIndex].length + this._eol.length);\n        }\n    }\n    _acceptDeleteRange(range) {\n        if (range.startLineNumber === range.endLineNumber) {\n            if (range.startColumn === range.endColumn) {\n                // Nothing to delete\n                return;\n            }\n            // Delete text on the affected line\n            this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\n                + this._lines[range.startLineNumber - 1].substring(range.endColumn - 1));\n            return;\n        }\n        // Take remaining text on last line and append it to remaining text on first line\n        this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\n            + this._lines[range.endLineNumber - 1].substring(range.endColumn - 1));\n        // Delete middle lines\n        this._lines.splice(range.startLineNumber, range.endLineNumber - range.startLineNumber);\n        if (this._lineStarts) {\n            // update prefix sum\n            this._lineStarts.removeValues(range.startLineNumber, range.endLineNumber - range.startLineNumber);\n        }\n    }\n    _acceptInsertText(position, insertText) {\n        if (insertText.length === 0) {\n            // Nothing to insert\n            return;\n        }\n        const insertLines = splitLines(insertText);\n        if (insertLines.length === 1) {\n            // Inserting text on one line\n            this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1)\n                + insertLines[0]\n                + this._lines[position.lineNumber - 1].substring(position.column - 1));\n            return;\n        }\n        // Append overflowing text from first line to the end of text to insert\n        insertLines[insertLines.length - 1] += this._lines[position.lineNumber - 1].substring(position.column - 1);\n        // Delete overflowing text from first line and insert text on first line\n        this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1)\n            + insertLines[0]);\n        // Insert new lines & store lengths\n        const newLengths = new Uint32Array(insertLines.length - 1);\n        for (let i = 1; i < insertLines.length; i++) {\n            this._lines.splice(position.lineNumber + i - 1, 0, insertLines[i]);\n            newLengths[i - 1] = insertLines[i].length + this._eol.length;\n        }\n        if (this._lineStarts) {\n            // update prefix sum\n            this._lineStarts.insertValues(position.lineNumber, newLengths);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CharacterClassifier } from '../core/characterClassifier.js';\nexport class Uint8Matrix {\n    constructor(rows, cols, defaultValue) {\n        const data = new Uint8Array(rows * cols);\n        for (let i = 0, len = rows * cols; i < len; i++) {\n            data[i] = defaultValue;\n        }\n        this._data = data;\n        this.rows = rows;\n        this.cols = cols;\n    }\n    get(row, col) {\n        return this._data[row * this.cols + col];\n    }\n    set(row, col, value) {\n        this._data[row * this.cols + col] = value;\n    }\n}\nexport class StateMachine {\n    constructor(edges) {\n        let maxCharCode = 0;\n        let maxState = 0 /* State.Invalid */;\n        for (let i = 0, len = edges.length; i < len; i++) {\n            const [from, chCode, to] = edges[i];\n            if (chCode > maxCharCode) {\n                maxCharCode = chCode;\n            }\n            if (from > maxState) {\n                maxState = from;\n            }\n            if (to > maxState) {\n                maxState = to;\n            }\n        }\n        maxCharCode++;\n        maxState++;\n        const states = new Uint8Matrix(maxState, maxCharCode, 0 /* State.Invalid */);\n        for (let i = 0, len = edges.length; i < len; i++) {\n            const [from, chCode, to] = edges[i];\n            states.set(from, chCode, to);\n        }\n        this._states = states;\n        this._maxCharCode = maxCharCode;\n    }\n    nextState(currentState, chCode) {\n        if (chCode < 0 || chCode >= this._maxCharCode) {\n            return 0 /* State.Invalid */;\n        }\n        return this._states.get(currentState, chCode);\n    }\n}\n// State machine for http:// or https:// or file://\nlet _stateMachine = null;\nfunction getStateMachine() {\n    if (_stateMachine === null) {\n        _stateMachine = new StateMachine([\n            [1 /* State.Start */, 104 /* CharCode.h */, 2 /* State.H */],\n            [1 /* State.Start */, 72 /* CharCode.H */, 2 /* State.H */],\n            [1 /* State.Start */, 102 /* CharCode.f */, 6 /* State.F */],\n            [1 /* State.Start */, 70 /* CharCode.F */, 6 /* State.F */],\n            [2 /* State.H */, 116 /* CharCode.t */, 3 /* State.HT */],\n            [2 /* State.H */, 84 /* CharCode.T */, 3 /* State.HT */],\n            [3 /* State.HT */, 116 /* CharCode.t */, 4 /* State.HTT */],\n            [3 /* State.HT */, 84 /* CharCode.T */, 4 /* State.HTT */],\n            [4 /* State.HTT */, 112 /* CharCode.p */, 5 /* State.HTTP */],\n            [4 /* State.HTT */, 80 /* CharCode.P */, 5 /* State.HTTP */],\n            [5 /* State.HTTP */, 115 /* CharCode.s */, 9 /* State.BeforeColon */],\n            [5 /* State.HTTP */, 83 /* CharCode.S */, 9 /* State.BeforeColon */],\n            [5 /* State.HTTP */, 58 /* CharCode.Colon */, 10 /* State.AfterColon */],\n            [6 /* State.F */, 105 /* CharCode.i */, 7 /* State.FI */],\n            [6 /* State.F */, 73 /* CharCode.I */, 7 /* State.FI */],\n            [7 /* State.FI */, 108 /* CharCode.l */, 8 /* State.FIL */],\n            [7 /* State.FI */, 76 /* CharCode.L */, 8 /* State.FIL */],\n            [8 /* State.FIL */, 101 /* CharCode.e */, 9 /* State.BeforeColon */],\n            [8 /* State.FIL */, 69 /* CharCode.E */, 9 /* State.BeforeColon */],\n            [9 /* State.BeforeColon */, 58 /* CharCode.Colon */, 10 /* State.AfterColon */],\n            [10 /* State.AfterColon */, 47 /* CharCode.Slash */, 11 /* State.AlmostThere */],\n            [11 /* State.AlmostThere */, 47 /* CharCode.Slash */, 12 /* State.End */],\n        ]);\n    }\n    return _stateMachine;\n}\nlet _classifier = null;\nfunction getClassifier() {\n    if (_classifier === null) {\n        _classifier = new CharacterClassifier(0 /* CharacterClass.None */);\n        // allow-any-unicode-next-line\n        const FORCE_TERMINATION_CHARACTERS = ' \\t<>\\'\\\"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…';\n        for (let i = 0; i < FORCE_TERMINATION_CHARACTERS.length; i++) {\n            _classifier.set(FORCE_TERMINATION_CHARACTERS.charCodeAt(i), 1 /* CharacterClass.ForceTermination */);\n        }\n        const CANNOT_END_WITH_CHARACTERS = '.,;:';\n        for (let i = 0; i < CANNOT_END_WITH_CHARACTERS.length; i++) {\n            _classifier.set(CANNOT_END_WITH_CHARACTERS.charCodeAt(i), 2 /* CharacterClass.CannotEndIn */);\n        }\n    }\n    return _classifier;\n}\nexport class LinkComputer {\n    static _createLink(classifier, line, lineNumber, linkBeginIndex, linkEndIndex) {\n        // Do not allow to end link in certain characters...\n        let lastIncludedCharIndex = linkEndIndex - 1;\n        do {\n            const chCode = line.charCodeAt(lastIncludedCharIndex);\n            const chClass = classifier.get(chCode);\n            if (chClass !== 2 /* CharacterClass.CannotEndIn */) {\n                break;\n            }\n            lastIncludedCharIndex--;\n        } while (lastIncludedCharIndex > linkBeginIndex);\n        // Handle links enclosed in parens, square brackets and curlys.\n        if (linkBeginIndex > 0) {\n            const charCodeBeforeLink = line.charCodeAt(linkBeginIndex - 1);\n            const lastCharCodeInLink = line.charCodeAt(lastIncludedCharIndex);\n            if ((charCodeBeforeLink === 40 /* CharCode.OpenParen */ && lastCharCodeInLink === 41 /* CharCode.CloseParen */)\n                || (charCodeBeforeLink === 91 /* CharCode.OpenSquareBracket */ && lastCharCodeInLink === 93 /* CharCode.CloseSquareBracket */)\n                || (charCodeBeforeLink === 123 /* CharCode.OpenCurlyBrace */ && lastCharCodeInLink === 125 /* CharCode.CloseCurlyBrace */)) {\n                // Do not end in ) if ( is before the link start\n                // Do not end in ] if [ is before the link start\n                // Do not end in } if { is before the link start\n                lastIncludedCharIndex--;\n            }\n        }\n        return {\n            range: {\n                startLineNumber: lineNumber,\n                startColumn: linkBeginIndex + 1,\n                endLineNumber: lineNumber,\n                endColumn: lastIncludedCharIndex + 2\n            },\n            url: line.substring(linkBeginIndex, lastIncludedCharIndex + 1)\n        };\n    }\n    static computeLinks(model, stateMachine = getStateMachine()) {\n        const classifier = getClassifier();\n        const result = [];\n        for (let i = 1, lineCount = model.getLineCount(); i <= lineCount; i++) {\n            const line = model.getLineContent(i);\n            const len = line.length;\n            let j = 0;\n            let linkBeginIndex = 0;\n            let linkBeginChCode = 0;\n            let state = 1 /* State.Start */;\n            let hasOpenParens = false;\n            let hasOpenSquareBracket = false;\n            let inSquareBrackets = false;\n            let hasOpenCurlyBracket = false;\n            while (j < len) {\n                let resetStateMachine = false;\n                const chCode = line.charCodeAt(j);\n                if (state === 13 /* State.Accept */) {\n                    let chClass;\n                    switch (chCode) {\n                        case 40 /* CharCode.OpenParen */:\n                            hasOpenParens = true;\n                            chClass = 0 /* CharacterClass.None */;\n                            break;\n                        case 41 /* CharCode.CloseParen */:\n                            chClass = (hasOpenParens ? 0 /* CharacterClass.None */ : 1 /* CharacterClass.ForceTermination */);\n                            break;\n                        case 91 /* CharCode.OpenSquareBracket */:\n                            inSquareBrackets = true;\n                            hasOpenSquareBracket = true;\n                            chClass = 0 /* CharacterClass.None */;\n                            break;\n                        case 93 /* CharCode.CloseSquareBracket */:\n                            inSquareBrackets = false;\n                            chClass = (hasOpenSquareBracket ? 0 /* CharacterClass.None */ : 1 /* CharacterClass.ForceTermination */);\n                            break;\n                        case 123 /* CharCode.OpenCurlyBrace */:\n                            hasOpenCurlyBracket = true;\n                            chClass = 0 /* CharacterClass.None */;\n                            break;\n                        case 125 /* CharCode.CloseCurlyBrace */:\n                            chClass = (hasOpenCurlyBracket ? 0 /* CharacterClass.None */ : 1 /* CharacterClass.ForceTermination */);\n                            break;\n                        /* The following three rules make it that ' or \" or ` are allowed inside links if the link didn't begin with them */\n                        case 39 /* CharCode.SingleQuote */:\n                            chClass = (linkBeginChCode === 39 /* CharCode.SingleQuote */ ? 1 /* CharacterClass.ForceTermination */ : 0 /* CharacterClass.None */);\n                            break;\n                        case 34 /* CharCode.DoubleQuote */:\n                            chClass = (linkBeginChCode === 34 /* CharCode.DoubleQuote */ ? 1 /* CharacterClass.ForceTermination */ : 0 /* CharacterClass.None */);\n                            break;\n                        case 96 /* CharCode.BackTick */:\n                            chClass = (linkBeginChCode === 96 /* CharCode.BackTick */ ? 1 /* CharacterClass.ForceTermination */ : 0 /* CharacterClass.None */);\n                            break;\n                        case 42 /* CharCode.Asterisk */:\n                            // `*` terminates a link if the link began with `*`\n                            chClass = (linkBeginChCode === 42 /* CharCode.Asterisk */) ? 1 /* CharacterClass.ForceTermination */ : 0 /* CharacterClass.None */;\n                            break;\n                        case 124 /* CharCode.Pipe */:\n                            // `|` terminates a link if the link began with `|`\n                            chClass = (linkBeginChCode === 124 /* CharCode.Pipe */) ? 1 /* CharacterClass.ForceTermination */ : 0 /* CharacterClass.None */;\n                            break;\n                        case 32 /* CharCode.Space */:\n                            // ` ` allow space in between [ and ]\n                            chClass = (inSquareBrackets ? 0 /* CharacterClass.None */ : 1 /* CharacterClass.ForceTermination */);\n                            break;\n                        default:\n                            chClass = classifier.get(chCode);\n                    }\n                    // Check if character terminates link\n                    if (chClass === 1 /* CharacterClass.ForceTermination */) {\n                        result.push(LinkComputer._createLink(classifier, line, i, linkBeginIndex, j));\n                        resetStateMachine = true;\n                    }\n                }\n                else if (state === 12 /* State.End */) {\n                    let chClass;\n                    if (chCode === 91 /* CharCode.OpenSquareBracket */) {\n                        // Allow for the authority part to contain ipv6 addresses which contain [ and ]\n                        hasOpenSquareBracket = true;\n                        chClass = 0 /* CharacterClass.None */;\n                    }\n                    else {\n                        chClass = classifier.get(chCode);\n                    }\n                    // Check if character terminates link\n                    if (chClass === 1 /* CharacterClass.ForceTermination */) {\n                        resetStateMachine = true;\n                    }\n                    else {\n                        state = 13 /* State.Accept */;\n                    }\n                }\n                else {\n                    state = stateMachine.nextState(state, chCode);\n                    if (state === 0 /* State.Invalid */) {\n                        resetStateMachine = true;\n                    }\n                }\n                if (resetStateMachine) {\n                    state = 1 /* State.Start */;\n                    hasOpenParens = false;\n                    hasOpenSquareBracket = false;\n                    hasOpenCurlyBracket = false;\n                    // Record where the link started\n                    linkBeginIndex = j + 1;\n                    linkBeginChCode = chCode;\n                }\n                j++;\n            }\n            if (state === 13 /* State.Accept */) {\n                result.push(LinkComputer._createLink(classifier, line, i, linkBeginIndex, len));\n            }\n        }\n        return result;\n    }\n}\n/**\n * Returns an array of all links contains in the provided\n * document. *Note* that this operation is computational\n * expensive and should not run in the UI thread.\n */\nexport function computeLinks(model) {\n    if (!model || typeof model.getLineCount !== 'function' || typeof model.getLineContent !== 'function') {\n        // Unknown caller!\n        return [];\n    }\n    return LinkComputer.computeLinks(model);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class BasicInplaceReplace {\n    constructor() {\n        this._defaultValueSet = [\n            ['true', 'false'],\n            ['True', 'False'],\n            ['Private', 'Public', 'Friend', 'ReadOnly', 'Partial', 'Protected', 'WriteOnly'],\n            ['public', 'protected', 'private'],\n        ];\n    }\n    navigateValueSet(range1, text1, range2, text2, up) {\n        if (range1 && text1) {\n            const result = this.doNavigateValueSet(text1, up);\n            if (result) {\n                return {\n                    range: range1,\n                    value: result\n                };\n            }\n        }\n        if (range2 && text2) {\n            const result = this.doNavigateValueSet(text2, up);\n            if (result) {\n                return {\n                    range: range2,\n                    value: result\n                };\n            }\n        }\n        return null;\n    }\n    doNavigateValueSet(text, up) {\n        const numberResult = this.numberReplace(text, up);\n        if (numberResult !== null) {\n            return numberResult;\n        }\n        return this.textReplace(text, up);\n    }\n    numberReplace(value, up) {\n        const precision = Math.pow(10, value.length - (value.lastIndexOf('.') + 1));\n        let n1 = Number(value);\n        const n2 = parseFloat(value);\n        if (!isNaN(n1) && !isNaN(n2) && n1 === n2) {\n            if (n1 === 0 && !up) {\n                return null; // don't do negative\n                //\t\t\t} else if(n1 === 9 && up) {\n                //\t\t\t\treturn null; // don't insert 10 into a number\n            }\n            else {\n                n1 = Math.floor(n1 * precision);\n                n1 += up ? precision : -precision;\n                return String(n1 / precision);\n            }\n        }\n        return null;\n    }\n    textReplace(value, up) {\n        return this.valueSetsReplace(this._defaultValueSet, value, up);\n    }\n    valueSetsReplace(valueSets, value, up) {\n        let result = null;\n        for (let i = 0, len = valueSets.length; result === null && i < len; i++) {\n            result = this.valueSetReplace(valueSets[i], value, up);\n        }\n        return result;\n    }\n    valueSetReplace(valueSet, value, up) {\n        let idx = valueSet.indexOf(value);\n        if (idx >= 0) {\n            idx += up ? +1 : -1;\n            if (idx < 0) {\n                idx = valueSet.length - 1;\n            }\n            else {\n                idx %= valueSet.length;\n            }\n            return valueSet[idx];\n        }\n        return null;\n    }\n}\nBasicInplaceReplace.INSTANCE = new BasicInplaceReplace();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { stringDiff } from '../../../base/common/diff/diff.js';\nimport { globals } from '../../../base/common/platform.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { Position } from '../core/position.js';\nimport { Range } from '../core/range.js';\nimport { DiffComputer } from '../diff/diffComputer.js';\nimport { MirrorTextModel as BaseMirrorModel } from '../model/mirrorTextModel.js';\nimport { ensureValidWordDefinition, getWordAtText } from '../core/wordHelper.js';\nimport { computeLinks } from '../languages/linkComputer.js';\nimport { BasicInplaceReplace } from '../languages/supports/inplaceReplaceSupport.js';\nimport { createMonacoBaseAPI } from './editorBaseApi.js';\nimport * as types from '../../../base/common/types.js';\nimport { StopWatch } from '../../../base/common/stopwatch.js';\nimport { UnicodeTextModelHighlighter } from './unicodeTextModelHighlighter.js';\n/**\n * @internal\n */\nexport class MirrorModel extends BaseMirrorModel {\n    get uri() {\n        return this._uri;\n    }\n    get eol() {\n        return this._eol;\n    }\n    getValue() {\n        return this.getText();\n    }\n    getLinesContent() {\n        return this._lines.slice(0);\n    }\n    getLineCount() {\n        return this._lines.length;\n    }\n    getLineContent(lineNumber) {\n        return this._lines[lineNumber - 1];\n    }\n    getWordAtPosition(position, wordDefinition) {\n        const wordAtText = getWordAtText(position.column, ensureValidWordDefinition(wordDefinition), this._lines[position.lineNumber - 1], 0);\n        if (wordAtText) {\n            return new Range(position.lineNumber, wordAtText.startColumn, position.lineNumber, wordAtText.endColumn);\n        }\n        return null;\n    }\n    words(wordDefinition) {\n        const lines = this._lines;\n        const wordenize = this._wordenize.bind(this);\n        let lineNumber = 0;\n        let lineText = '';\n        let wordRangesIdx = 0;\n        let wordRanges = [];\n        return {\n            *[Symbol.iterator]() {\n                while (true) {\n                    if (wordRangesIdx < wordRanges.length) {\n                        const value = lineText.substring(wordRanges[wordRangesIdx].start, wordRanges[wordRangesIdx].end);\n                        wordRangesIdx += 1;\n                        yield value;\n                    }\n                    else {\n                        if (lineNumber < lines.length) {\n                            lineText = lines[lineNumber];\n                            wordRanges = wordenize(lineText, wordDefinition);\n                            wordRangesIdx = 0;\n                            lineNumber += 1;\n                        }\n                        else {\n                            break;\n                        }\n                    }\n                }\n            }\n        };\n    }\n    getLineWords(lineNumber, wordDefinition) {\n        const content = this._lines[lineNumber - 1];\n        const ranges = this._wordenize(content, wordDefinition);\n        const words = [];\n        for (const range of ranges) {\n            words.push({\n                word: content.substring(range.start, range.end),\n                startColumn: range.start + 1,\n                endColumn: range.end + 1\n            });\n        }\n        return words;\n    }\n    _wordenize(content, wordDefinition) {\n        const result = [];\n        let match;\n        wordDefinition.lastIndex = 0; // reset lastIndex just to be sure\n        while (match = wordDefinition.exec(content)) {\n            if (match[0].length === 0) {\n                // it did match the empty string\n                break;\n            }\n            result.push({ start: match.index, end: match.index + match[0].length });\n        }\n        return result;\n    }\n    getValueInRange(range) {\n        range = this._validateRange(range);\n        if (range.startLineNumber === range.endLineNumber) {\n            return this._lines[range.startLineNumber - 1].substring(range.startColumn - 1, range.endColumn - 1);\n        }\n        const lineEnding = this._eol;\n        const startLineIndex = range.startLineNumber - 1;\n        const endLineIndex = range.endLineNumber - 1;\n        const resultLines = [];\n        resultLines.push(this._lines[startLineIndex].substring(range.startColumn - 1));\n        for (let i = startLineIndex + 1; i < endLineIndex; i++) {\n            resultLines.push(this._lines[i]);\n        }\n        resultLines.push(this._lines[endLineIndex].substring(0, range.endColumn - 1));\n        return resultLines.join(lineEnding);\n    }\n    offsetAt(position) {\n        position = this._validatePosition(position);\n        this._ensureLineStarts();\n        return this._lineStarts.getPrefixSum(position.lineNumber - 2) + (position.column - 1);\n    }\n    positionAt(offset) {\n        offset = Math.floor(offset);\n        offset = Math.max(0, offset);\n        this._ensureLineStarts();\n        const out = this._lineStarts.getIndexOf(offset);\n        const lineLength = this._lines[out.index].length;\n        // Ensure we return a valid position\n        return {\n            lineNumber: 1 + out.index,\n            column: 1 + Math.min(out.remainder, lineLength)\n        };\n    }\n    _validateRange(range) {\n        const start = this._validatePosition({ lineNumber: range.startLineNumber, column: range.startColumn });\n        const end = this._validatePosition({ lineNumber: range.endLineNumber, column: range.endColumn });\n        if (start.lineNumber !== range.startLineNumber\n            || start.column !== range.startColumn\n            || end.lineNumber !== range.endLineNumber\n            || end.column !== range.endColumn) {\n            return {\n                startLineNumber: start.lineNumber,\n                startColumn: start.column,\n                endLineNumber: end.lineNumber,\n                endColumn: end.column\n            };\n        }\n        return range;\n    }\n    _validatePosition(position) {\n        if (!Position.isIPosition(position)) {\n            throw new Error('bad position');\n        }\n        let { lineNumber, column } = position;\n        let hasChanged = false;\n        if (lineNumber < 1) {\n            lineNumber = 1;\n            column = 1;\n            hasChanged = true;\n        }\n        else if (lineNumber > this._lines.length) {\n            lineNumber = this._lines.length;\n            column = this._lines[lineNumber - 1].length + 1;\n            hasChanged = true;\n        }\n        else {\n            const maxCharacter = this._lines[lineNumber - 1].length + 1;\n            if (column < 1) {\n                column = 1;\n                hasChanged = true;\n            }\n            else if (column > maxCharacter) {\n                column = maxCharacter;\n                hasChanged = true;\n            }\n        }\n        if (!hasChanged) {\n            return position;\n        }\n        else {\n            return { lineNumber, column };\n        }\n    }\n}\n/**\n * @internal\n */\nexport class EditorSimpleWorker {\n    constructor(host, foreignModuleFactory) {\n        this._host = host;\n        this._models = Object.create(null);\n        this._foreignModuleFactory = foreignModuleFactory;\n        this._foreignModule = null;\n    }\n    dispose() {\n        this._models = Object.create(null);\n    }\n    _getModel(uri) {\n        return this._models[uri];\n    }\n    _getModels() {\n        const all = [];\n        Object.keys(this._models).forEach((key) => all.push(this._models[key]));\n        return all;\n    }\n    acceptNewModel(data) {\n        this._models[data.url] = new MirrorModel(URI.parse(data.url), data.lines, data.EOL, data.versionId);\n    }\n    acceptModelChanged(strURL, e) {\n        if (!this._models[strURL]) {\n            return;\n        }\n        const model = this._models[strURL];\n        model.onEvents(e);\n    }\n    acceptRemovedModel(strURL) {\n        if (!this._models[strURL]) {\n            return;\n        }\n        delete this._models[strURL];\n    }\n    computeUnicodeHighlights(url, options, range) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._getModel(url);\n            if (!model) {\n                return { ranges: [], hasMore: false, ambiguousCharacterCount: 0, invisibleCharacterCount: 0, nonBasicAsciiCharacterCount: 0 };\n            }\n            return UnicodeTextModelHighlighter.computeUnicodeHighlights(model, options, range);\n        });\n    }\n    // ---- BEGIN diff --------------------------------------------------------------------------\n    computeDiff(originalUrl, modifiedUrl, ignoreTrimWhitespace, maxComputationTime) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const original = this._getModel(originalUrl);\n            const modified = this._getModel(modifiedUrl);\n            if (!original || !modified) {\n                return null;\n            }\n            return EditorSimpleWorker.computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime);\n        });\n    }\n    static computeDiff(originalTextModel, modifiedTextModel, ignoreTrimWhitespace, maxComputationTime) {\n        const originalLines = originalTextModel.getLinesContent();\n        const modifiedLines = modifiedTextModel.getLinesContent();\n        const diffComputer = new DiffComputer(originalLines, modifiedLines, {\n            shouldComputeCharChanges: true,\n            shouldPostProcessCharChanges: true,\n            shouldIgnoreTrimWhitespace: ignoreTrimWhitespace,\n            shouldMakePrettyDiff: true,\n            maxComputationTime: maxComputationTime\n        });\n        const diffResult = diffComputer.computeDiff();\n        const identical = (diffResult.changes.length > 0 ? false : this._modelsAreIdentical(originalTextModel, modifiedTextModel));\n        return {\n            quitEarly: diffResult.quitEarly,\n            identical: identical,\n            changes: diffResult.changes\n        };\n    }\n    static _modelsAreIdentical(original, modified) {\n        const originalLineCount = original.getLineCount();\n        const modifiedLineCount = modified.getLineCount();\n        if (originalLineCount !== modifiedLineCount) {\n            return false;\n        }\n        for (let line = 1; line <= originalLineCount; line++) {\n            const originalLine = original.getLineContent(line);\n            const modifiedLine = modified.getLineContent(line);\n            if (originalLine !== modifiedLine) {\n                return false;\n            }\n        }\n        return true;\n    }\n    computeMoreMinimalEdits(modelUrl, edits) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._getModel(modelUrl);\n            if (!model) {\n                return edits;\n            }\n            const result = [];\n            let lastEol = undefined;\n            edits = edits.slice(0).sort((a, b) => {\n                if (a.range && b.range) {\n                    return Range.compareRangesUsingStarts(a.range, b.range);\n                }\n                // eol only changes should go to the end\n                const aRng = a.range ? 0 : 1;\n                const bRng = b.range ? 0 : 1;\n                return aRng - bRng;\n            });\n            for (let { range, text, eol } of edits) {\n                if (typeof eol === 'number') {\n                    lastEol = eol;\n                }\n                if (Range.isEmpty(range) && !text) {\n                    // empty change\n                    continue;\n                }\n                const original = model.getValueInRange(range);\n                text = text.replace(/\\r\\n|\\n|\\r/g, model.eol);\n                if (original === text) {\n                    // noop\n                    continue;\n                }\n                // make sure diff won't take too long\n                if (Math.max(text.length, original.length) > EditorSimpleWorker._diffLimit) {\n                    result.push({ range, text });\n                    continue;\n                }\n                // compute diff between original and edit.text\n                const changes = stringDiff(original, text, false);\n                const editOffset = model.offsetAt(Range.lift(range).getStartPosition());\n                for (const change of changes) {\n                    const start = model.positionAt(editOffset + change.originalStart);\n                    const end = model.positionAt(editOffset + change.originalStart + change.originalLength);\n                    const newEdit = {\n                        text: text.substr(change.modifiedStart, change.modifiedLength),\n                        range: { startLineNumber: start.lineNumber, startColumn: start.column, endLineNumber: end.lineNumber, endColumn: end.column }\n                    };\n                    if (model.getValueInRange(newEdit.range) !== newEdit.text) {\n                        result.push(newEdit);\n                    }\n                }\n            }\n            if (typeof lastEol === 'number') {\n                result.push({ eol: lastEol, text: '', range: { startLineNumber: 0, startColumn: 0, endLineNumber: 0, endColumn: 0 } });\n            }\n            return result;\n        });\n    }\n    // ---- END minimal edits ---------------------------------------------------------------\n    computeLinks(modelUrl) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._getModel(modelUrl);\n            if (!model) {\n                return null;\n            }\n            return computeLinks(model);\n        });\n    }\n    textualSuggest(modelUrls, leadingWord, wordDef, wordDefFlags) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const sw = new StopWatch(true);\n            const wordDefRegExp = new RegExp(wordDef, wordDefFlags);\n            const seen = new Set();\n            outer: for (const url of modelUrls) {\n                const model = this._getModel(url);\n                if (!model) {\n                    continue;\n                }\n                for (const word of model.words(wordDefRegExp)) {\n                    if (word === leadingWord || !isNaN(Number(word))) {\n                        continue;\n                    }\n                    seen.add(word);\n                    if (seen.size > EditorSimpleWorker._suggestionsLimit) {\n                        break outer;\n                    }\n                }\n            }\n            return { words: Array.from(seen), duration: sw.elapsed() };\n        });\n    }\n    // ---- END suggest --------------------------------------------------------------------------\n    //#region -- word ranges --\n    computeWordRanges(modelUrl, range, wordDef, wordDefFlags) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._getModel(modelUrl);\n            if (!model) {\n                return Object.create(null);\n            }\n            const wordDefRegExp = new RegExp(wordDef, wordDefFlags);\n            const result = Object.create(null);\n            for (let line = range.startLineNumber; line < range.endLineNumber; line++) {\n                const words = model.getLineWords(line, wordDefRegExp);\n                for (const word of words) {\n                    if (!isNaN(Number(word.word))) {\n                        continue;\n                    }\n                    let array = result[word.word];\n                    if (!array) {\n                        array = [];\n                        result[word.word] = array;\n                    }\n                    array.push({\n                        startLineNumber: line,\n                        startColumn: word.startColumn,\n                        endLineNumber: line,\n                        endColumn: word.endColumn\n                    });\n                }\n            }\n            return result;\n        });\n    }\n    //#endregion\n    navigateValueSet(modelUrl, range, up, wordDef, wordDefFlags) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._getModel(modelUrl);\n            if (!model) {\n                return null;\n            }\n            const wordDefRegExp = new RegExp(wordDef, wordDefFlags);\n            if (range.startColumn === range.endColumn) {\n                range = {\n                    startLineNumber: range.startLineNumber,\n                    startColumn: range.startColumn,\n                    endLineNumber: range.endLineNumber,\n                    endColumn: range.endColumn + 1\n                };\n            }\n            const selectionText = model.getValueInRange(range);\n            const wordRange = model.getWordAtPosition({ lineNumber: range.startLineNumber, column: range.startColumn }, wordDefRegExp);\n            if (!wordRange) {\n                return null;\n            }\n            const word = model.getValueInRange(wordRange);\n            const result = BasicInplaceReplace.INSTANCE.navigateValueSet(range, selectionText, wordRange, word, up);\n            return result;\n        });\n    }\n    // ---- BEGIN foreign module support --------------------------------------------------------------------------\n    loadForeignModule(moduleId, createData, foreignHostMethods) {\n        const proxyMethodRequest = (method, args) => {\n            return this._host.fhr(method, args);\n        };\n        const foreignHost = types.createProxyObject(foreignHostMethods, proxyMethodRequest);\n        const ctx = {\n            host: foreignHost,\n            getMirrorModels: () => {\n                return this._getModels();\n            }\n        };\n        if (this._foreignModuleFactory) {\n            this._foreignModule = this._foreignModuleFactory(ctx, createData);\n            // static foreing module\n            return Promise.resolve(types.getAllMethodNames(this._foreignModule));\n        }\n        // ESM-comment-begin\n        // \t\treturn new Promise<any>((resolve, reject) => {\n        // \t\t\trequire([moduleId], (foreignModule: { create: IForeignModuleFactory }) => {\n        // \t\t\t\tthis._foreignModule = foreignModule.create(ctx, createData);\n        // \n        // \t\t\t\tresolve(types.getAllMethodNames(this._foreignModule));\n        // \n        // \t\t\t}, reject);\n        // \t\t});\n        // ESM-comment-end\n        // ESM-uncomment-begin\n        return Promise.reject(new Error(`Unexpected usage`));\n        // ESM-uncomment-end\n    }\n    // foreign method request\n    fmr(method, args) {\n        if (!this._foreignModule || typeof this._foreignModule[method] !== 'function') {\n            return Promise.reject(new Error('Missing requestHandler or method: ' + method));\n        }\n        try {\n            return Promise.resolve(this._foreignModule[method].apply(this._foreignModule, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n}\n// ---- END diff --------------------------------------------------------------------------\n// ---- BEGIN minimal edits ---------------------------------------------------------------\nEditorSimpleWorker._diffLimit = 100000;\n// ---- BEGIN suggest --------------------------------------------------------------------------\nEditorSimpleWorker._suggestionsLimit = 10000;\n/**\n * Called on the worker side\n * @internal\n */\nexport function create(host) {\n    return new EditorSimpleWorker(host, null);\n}\nif (typeof importScripts === 'function') {\n    // Running in a web worker\n    globals.monaco = createMonacoBaseAPI();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { IntervalTimer, timeout } from '../../../base/common/async.js';\nimport { Disposable, dispose, toDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { SimpleWorkerClient, logOnceWebWorkerWarning } from '../../../base/common/worker/simpleWorker.js';\nimport { DefaultWorkerFactory } from '../../../base/browser/defaultWorkerFactory.js';\nimport { Range } from '../../common/core/range.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { EditorSimpleWorker } from '../../common/services/editorSimpleWorker.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ITextResourceConfigurationService } from '../../common/services/textResourceConfiguration.js';\nimport { regExpFlags } from '../../../base/common/strings.js';\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { StopWatch } from '../../../base/common/stopwatch.js';\nimport { canceled } from '../../../base/common/errors.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\n/**\n * Stop syncing a model to the worker if it was not needed for 1 min.\n */\nconst STOP_SYNC_MODEL_DELTA_TIME_MS = 60 * 1000;\n/**\n * Stop the worker if it was not needed for 5 min.\n */\nconst STOP_WORKER_DELTA_TIME_MS = 5 * 60 * 1000;\nfunction canSyncModel(modelService, resource) {\n    const model = modelService.getModel(resource);\n    if (!model) {\n        return false;\n    }\n    if (model.isTooLargeForSyncing()) {\n        return false;\n    }\n    return true;\n}\nlet EditorWorkerService = class EditorWorkerService extends Disposable {\n    constructor(modelService, configurationService, logService, languageConfigurationService, languageFeaturesService) {\n        super();\n        this._modelService = modelService;\n        this._workerManager = this._register(new WorkerManager(this._modelService, languageConfigurationService));\n        this._logService = logService;\n        // register default link-provider and default completions-provider\n        this._register(languageFeaturesService.linkProvider.register({ language: '*', hasAccessToAllModels: true }, {\n            provideLinks: (model, token) => {\n                if (!canSyncModel(this._modelService, model.uri)) {\n                    return Promise.resolve({ links: [] }); // File too large\n                }\n                return this._workerManager.withWorker().then(client => client.computeLinks(model.uri)).then(links => {\n                    return links && { links };\n                });\n            }\n        }));\n        this._register(languageFeaturesService.completionProvider.register('*', new WordBasedCompletionItemProvider(this._workerManager, configurationService, this._modelService, languageConfigurationService)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    canComputeUnicodeHighlights(uri) {\n        return canSyncModel(this._modelService, uri);\n    }\n    computedUnicodeHighlights(uri, options, range) {\n        return this._workerManager.withWorker().then(client => client.computedUnicodeHighlights(uri, options, range));\n    }\n    computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime) {\n        return this._workerManager.withWorker().then(client => client.computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime));\n    }\n    computeMoreMinimalEdits(resource, edits) {\n        if (isNonEmptyArray(edits)) {\n            if (!canSyncModel(this._modelService, resource)) {\n                return Promise.resolve(edits); // File too large\n            }\n            const sw = StopWatch.create(true);\n            const result = this._workerManager.withWorker().then(client => client.computeMoreMinimalEdits(resource, edits));\n            result.finally(() => this._logService.trace('FORMAT#computeMoreMinimalEdits', resource.toString(true), sw.elapsed()));\n            return Promise.race([result, timeout(1000).then(() => edits)]);\n        }\n        else {\n            return Promise.resolve(undefined);\n        }\n    }\n    canNavigateValueSet(resource) {\n        return (canSyncModel(this._modelService, resource));\n    }\n    navigateValueSet(resource, range, up) {\n        return this._workerManager.withWorker().then(client => client.navigateValueSet(resource, range, up));\n    }\n    canComputeWordRanges(resource) {\n        return canSyncModel(this._modelService, resource);\n    }\n    computeWordRanges(resource, range) {\n        return this._workerManager.withWorker().then(client => client.computeWordRanges(resource, range));\n    }\n};\nEditorWorkerService = __decorate([\n    __param(0, IModelService),\n    __param(1, ITextResourceConfigurationService),\n    __param(2, ILogService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeaturesService)\n], EditorWorkerService);\nexport { EditorWorkerService };\nclass WordBasedCompletionItemProvider {\n    constructor(workerManager, configurationService, modelService, languageConfigurationService) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._debugDisplayName = 'wordbasedCompletions';\n        this._workerManager = workerManager;\n        this._configurationService = configurationService;\n        this._modelService = modelService;\n    }\n    provideCompletionItems(model, position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const config = this._configurationService.getValue(model.uri, position, 'editor');\n            if (!config.wordBasedSuggestions) {\n                return undefined;\n            }\n            const models = [];\n            if (config.wordBasedSuggestionsMode === 'currentDocument') {\n                // only current file and only if not too large\n                if (canSyncModel(this._modelService, model.uri)) {\n                    models.push(model.uri);\n                }\n            }\n            else {\n                // either all files or files of same language\n                for (const candidate of this._modelService.getModels()) {\n                    if (!canSyncModel(this._modelService, candidate.uri)) {\n                        continue;\n                    }\n                    if (candidate === model) {\n                        models.unshift(candidate.uri);\n                    }\n                    else if (config.wordBasedSuggestionsMode === 'allDocuments' || candidate.getLanguageId() === model.getLanguageId()) {\n                        models.push(candidate.uri);\n                    }\n                }\n            }\n            if (models.length === 0) {\n                return undefined; // File too large, no other files\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const word = model.getWordAtPosition(position);\n            const replace = !word ? Range.fromPositions(position) : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            const insert = replace.setEndPosition(position.lineNumber, position.column);\n            const client = yield this._workerManager.withWorker();\n            const data = yield client.textualSuggest(models, word === null || word === void 0 ? void 0 : word.word, wordDefRegExp);\n            if (!data) {\n                return undefined;\n            }\n            return {\n                duration: data.duration,\n                suggestions: data.words.map((word) => {\n                    return {\n                        kind: 18 /* languages.CompletionItemKind.Text */,\n                        label: word,\n                        insertText: word,\n                        range: { insert, replace }\n                    };\n                }),\n            };\n        });\n    }\n}\nclass WorkerManager extends Disposable {\n    constructor(modelService, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._modelService = modelService;\n        this._editorWorkerClient = null;\n        this._lastWorkerUsedTime = (new Date()).getTime();\n        const stopWorkerInterval = this._register(new IntervalTimer());\n        stopWorkerInterval.cancelAndSet(() => this._checkStopIdleWorker(), Math.round(STOP_WORKER_DELTA_TIME_MS / 2));\n        this._register(this._modelService.onModelRemoved(_ => this._checkStopEmptyWorker()));\n    }\n    dispose() {\n        if (this._editorWorkerClient) {\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n        super.dispose();\n    }\n    /**\n     * Check if the model service has no more models and stop the worker if that is the case.\n     */\n    _checkStopEmptyWorker() {\n        if (!this._editorWorkerClient) {\n            return;\n        }\n        const models = this._modelService.getModels();\n        if (models.length === 0) {\n            // There are no more models => nothing possible for me to do\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n    }\n    /**\n     * Check if the worker has been idle for a while and then stop it.\n     */\n    _checkStopIdleWorker() {\n        if (!this._editorWorkerClient) {\n            return;\n        }\n        const timeSinceLastWorkerUsedTime = (new Date()).getTime() - this._lastWorkerUsedTime;\n        if (timeSinceLastWorkerUsedTime > STOP_WORKER_DELTA_TIME_MS) {\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n    }\n    withWorker() {\n        this._lastWorkerUsedTime = (new Date()).getTime();\n        if (!this._editorWorkerClient) {\n            this._editorWorkerClient = new EditorWorkerClient(this._modelService, false, 'editorWorkerService', this.languageConfigurationService);\n        }\n        return Promise.resolve(this._editorWorkerClient);\n    }\n}\nclass EditorModelManager extends Disposable {\n    constructor(proxy, modelService, keepIdleModels) {\n        super();\n        this._syncedModels = Object.create(null);\n        this._syncedModelsLastUsedTime = Object.create(null);\n        this._proxy = proxy;\n        this._modelService = modelService;\n        if (!keepIdleModels) {\n            const timer = new IntervalTimer();\n            timer.cancelAndSet(() => this._checkStopModelSync(), Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS / 2));\n            this._register(timer);\n        }\n    }\n    dispose() {\n        for (const modelUrl in this._syncedModels) {\n            dispose(this._syncedModels[modelUrl]);\n        }\n        this._syncedModels = Object.create(null);\n        this._syncedModelsLastUsedTime = Object.create(null);\n        super.dispose();\n    }\n    ensureSyncedResources(resources, forceLargeModels) {\n        for (const resource of resources) {\n            const resourceStr = resource.toString();\n            if (!this._syncedModels[resourceStr]) {\n                this._beginModelSync(resource, forceLargeModels);\n            }\n            if (this._syncedModels[resourceStr]) {\n                this._syncedModelsLastUsedTime[resourceStr] = (new Date()).getTime();\n            }\n        }\n    }\n    _checkStopModelSync() {\n        const currentTime = (new Date()).getTime();\n        const toRemove = [];\n        for (const modelUrl in this._syncedModelsLastUsedTime) {\n            const elapsedTime = currentTime - this._syncedModelsLastUsedTime[modelUrl];\n            if (elapsedTime > STOP_SYNC_MODEL_DELTA_TIME_MS) {\n                toRemove.push(modelUrl);\n            }\n        }\n        for (const e of toRemove) {\n            this._stopModelSync(e);\n        }\n    }\n    _beginModelSync(resource, forceLargeModels) {\n        const model = this._modelService.getModel(resource);\n        if (!model) {\n            return;\n        }\n        if (!forceLargeModels && model.isTooLargeForSyncing()) {\n            return;\n        }\n        const modelUrl = resource.toString();\n        this._proxy.acceptNewModel({\n            url: model.uri.toString(),\n            lines: model.getLinesContent(),\n            EOL: model.getEOL(),\n            versionId: model.getVersionId()\n        });\n        const toDispose = new DisposableStore();\n        toDispose.add(model.onDidChangeContent((e) => {\n            this._proxy.acceptModelChanged(modelUrl.toString(), e);\n        }));\n        toDispose.add(model.onWillDispose(() => {\n            this._stopModelSync(modelUrl);\n        }));\n        toDispose.add(toDisposable(() => {\n            this._proxy.acceptRemovedModel(modelUrl);\n        }));\n        this._syncedModels[modelUrl] = toDispose;\n    }\n    _stopModelSync(modelUrl) {\n        const toDispose = this._syncedModels[modelUrl];\n        delete this._syncedModels[modelUrl];\n        delete this._syncedModelsLastUsedTime[modelUrl];\n        dispose(toDispose);\n    }\n}\nclass SynchronousWorkerClient {\n    constructor(instance) {\n        this._instance = instance;\n        this._proxyObj = Promise.resolve(this._instance);\n    }\n    dispose() {\n        this._instance.dispose();\n    }\n    getProxyObject() {\n        return this._proxyObj;\n    }\n}\nexport class EditorWorkerHost {\n    constructor(workerClient) {\n        this._workerClient = workerClient;\n    }\n    // foreign host request\n    fhr(method, args) {\n        return this._workerClient.fhr(method, args);\n    }\n}\nexport class EditorWorkerClient extends Disposable {\n    constructor(modelService, keepIdleModels, label, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._disposed = false;\n        this._modelService = modelService;\n        this._keepIdleModels = keepIdleModels;\n        this._workerFactory = new DefaultWorkerFactory(label);\n        this._worker = null;\n        this._modelManager = null;\n    }\n    // foreign host request\n    fhr(method, args) {\n        throw new Error(`Not implemented!`);\n    }\n    _getOrCreateWorker() {\n        if (!this._worker) {\n            try {\n                this._worker = this._register(new SimpleWorkerClient(this._workerFactory, 'vs/editor/common/services/editorSimpleWorker', new EditorWorkerHost(this)));\n            }\n            catch (err) {\n                logOnceWebWorkerWarning(err);\n                this._worker = new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this), null));\n            }\n        }\n        return this._worker;\n    }\n    _getProxy() {\n        return this._getOrCreateWorker().getProxyObject().then(undefined, (err) => {\n            logOnceWebWorkerWarning(err);\n            this._worker = new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this), null));\n            return this._getOrCreateWorker().getProxyObject();\n        });\n    }\n    _getOrCreateModelManager(proxy) {\n        if (!this._modelManager) {\n            this._modelManager = this._register(new EditorModelManager(proxy, this._modelService, this._keepIdleModels));\n        }\n        return this._modelManager;\n    }\n    _withSyncedResources(resources, forceLargeModels = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._disposed) {\n                return Promise.reject(canceled());\n            }\n            return this._getProxy().then((proxy) => {\n                this._getOrCreateModelManager(proxy).ensureSyncedResources(resources, forceLargeModels);\n                return proxy;\n            });\n        });\n    }\n    computedUnicodeHighlights(uri, options, range) {\n        return this._withSyncedResources([uri]).then(proxy => {\n            return proxy.computeUnicodeHighlights(uri.toString(), options, range);\n        });\n    }\n    computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime) {\n        return this._withSyncedResources([original, modified], /* forceLargeModels */ true).then(proxy => {\n            return proxy.computeDiff(original.toString(), modified.toString(), ignoreTrimWhitespace, maxComputationTime);\n        });\n    }\n    computeMoreMinimalEdits(resource, edits) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            return proxy.computeMoreMinimalEdits(resource.toString(), edits);\n        });\n    }\n    computeLinks(resource) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            return proxy.computeLinks(resource.toString());\n        });\n    }\n    textualSuggest(resources, leadingWord, wordDefRegExp) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const proxy = yield this._withSyncedResources(resources);\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.textualSuggest(resources.map(r => r.toString()), leadingWord, wordDef, wordDefFlags);\n        });\n    }\n    computeWordRanges(resource, range) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            const model = this._modelService.getModel(resource);\n            if (!model) {\n                return Promise.resolve(null);\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.computeWordRanges(resource.toString(), range, wordDef, wordDefFlags);\n        });\n    }\n    navigateValueSet(resource, range, up) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            const model = this._modelService.getModel(resource);\n            if (!model) {\n                return null;\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.navigateValueSet(resource.toString(), range, up, wordDef, wordDefFlags);\n        });\n    }\n    dispose() {\n        super.dispose();\n        this._disposed = true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorWorkerClient } from './editorWorkerService.js';\nimport * as types from '../../../base/common/types.js';\n/**\n * Create a new web worker that has model syncing capabilities built in.\n * Specify an AMD module to load that will `create` an object that will be proxied.\n */\nexport function createWebWorker(modelService, languageConfigurationService, opts) {\n    return new MonacoWebWorkerImpl(modelService, languageConfigurationService, opts);\n}\nclass MonacoWebWorkerImpl extends EditorWorkerClient {\n    constructor(modelService, languageConfigurationService, opts) {\n        super(modelService, opts.keepIdleModels || false, opts.label, languageConfigurationService);\n        this._foreignModuleId = opts.moduleId;\n        this._foreignModuleCreateData = opts.createData || null;\n        this._foreignModuleHost = opts.host || null;\n        this._foreignProxy = null;\n    }\n    // foreign host request\n    fhr(method, args) {\n        if (!this._foreignModuleHost || typeof this._foreignModuleHost[method] !== 'function') {\n            return Promise.reject(new Error('Missing method ' + method + ' or missing main thread foreign host.'));\n        }\n        try {\n            return Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _getForeignProxy() {\n        if (!this._foreignProxy) {\n            this._foreignProxy = this._getProxy().then((proxy) => {\n                const foreignHostMethods = this._foreignModuleHost ? types.getAllMethodNames(this._foreignModuleHost) : [];\n                return proxy.loadForeignModule(this._foreignModuleId, this._foreignModuleCreateData, foreignHostMethods).then((foreignMethods) => {\n                    this._foreignModuleCreateData = null;\n                    const proxyMethodRequest = (method, args) => {\n                        return proxy.fmr(method, args);\n                    };\n                    const createProxyMethod = (method, proxyMethodRequest) => {\n                        return function () {\n                            const args = Array.prototype.slice.call(arguments, 0);\n                            return proxyMethodRequest(method, args);\n                        };\n                    };\n                    const foreignProxy = {};\n                    for (const foreignMethod of foreignMethods) {\n                        foreignProxy[foreignMethod] = createProxyMethod(foreignMethod, proxyMethodRequest);\n                    }\n                    return foreignProxy;\n                });\n            });\n        }\n        return this._foreignProxy;\n    }\n    getProxy() {\n        return this._getForeignProxy();\n    }\n    withSyncedResources(resources) {\n        return this._withSyncedResources(resources).then(_ => this.getProxy());\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function isFuzzyActionArr(what) {\n    return (Array.isArray(what));\n}\nexport function isFuzzyAction(what) {\n    return !isFuzzyActionArr(what);\n}\nexport function isString(what) {\n    return (typeof what === 'string');\n}\nexport function isIAction(what) {\n    return !isString(what);\n}\n// Small helper functions\n/**\n * Is a string null, undefined, or empty?\n */\nexport function empty(s) {\n    return (s ? false : true);\n}\n/**\n * Puts a string to lower case if 'ignoreCase' is set.\n */\nexport function fixCase(lexer, str) {\n    return (lexer.ignoreCase && str ? str.toLowerCase() : str);\n}\n/**\n * Ensures there are no bad characters in a CSS token class.\n */\nexport function sanitize(s) {\n    return s.replace(/[&<>'\"_]/g, '-'); // used on all output token CSS classes\n}\n// Logging\n/**\n * Logs a message.\n */\nexport function log(lexer, msg) {\n    console.log(`${lexer.languageId}: ${msg}`);\n}\n// Throwing errors\nexport function createError(lexer, msg) {\n    return new Error(`${lexer.languageId}: ${msg}`);\n}\n// Helper functions for rule finding and substitution\n/**\n * substituteMatches is used on lexer strings and can substitutes predefined patterns:\n * \t\t$$  => $\n * \t\t$#  => id\n * \t\t$n  => matched entry n\n * \t\t@attr => contents of lexer[attr]\n *\n * See documentation for more info\n */\nexport function substituteMatches(lexer, str, id, matches, state) {\n    const re = /\\$((\\$)|(#)|(\\d\\d?)|[sS](\\d\\d?)|@(\\w+))/g;\n    let stateMatches = null;\n    return str.replace(re, function (full, sub, dollar, hash, n, s, attr, ofs, total) {\n        if (!empty(dollar)) {\n            return '$'; // $$\n        }\n        if (!empty(hash)) {\n            return fixCase(lexer, id); // default $#\n        }\n        if (!empty(n) && n < matches.length) {\n            return fixCase(lexer, matches[n]); // $n\n        }\n        if (!empty(attr) && lexer && typeof (lexer[attr]) === 'string') {\n            return lexer[attr]; //@attribute\n        }\n        if (stateMatches === null) { // split state on demand\n            stateMatches = state.split('.');\n            stateMatches.unshift(state);\n        }\n        if (!empty(s) && s < stateMatches.length) {\n            return fixCase(lexer, stateMatches[s]); //$Sn\n        }\n        return '';\n    });\n}\n/**\n * Find the tokenizer rules for a specific state (i.e. next action)\n */\nexport function findRules(lexer, inState) {\n    let state = inState;\n    while (state && state.length > 0) {\n        const rules = lexer.tokenizer[state];\n        if (rules) {\n            return rules;\n        }\n        const idx = state.lastIndexOf('.');\n        if (idx < 0) {\n            state = null; // no further parent\n        }\n        else {\n            state = state.substr(0, idx);\n        }\n    }\n    return null;\n}\n/**\n * Is a certain state defined? In contrast to 'findRules' this works on a ILexerMin.\n * This is used during compilation where we may know the defined states\n * but not yet whether the corresponding rules are correct.\n */\nexport function stateExists(lexer, inState) {\n    let state = inState;\n    while (state && state.length > 0) {\n        const exist = lexer.stateNames[state];\n        if (exist) {\n            return true;\n        }\n        const idx = state.lastIndexOf('.');\n        if (idx < 0) {\n            state = null; // no further parent\n        }\n        else {\n            state = state.substr(0, idx);\n        }\n    }\n    return false;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as languages from '../../../common/languages.js';\nimport { NullState, nullTokenizeEncoded, nullTokenize } from '../../../common/languages/nullTokenize.js';\nimport * as monarchCommon from './monarchCommon.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst CACHE_STACK_DEPTH = 5;\n/**\n * Reuse the same stack elements up to a certain depth.\n */\nclass MonarchStackElementFactory {\n    constructor(maxCacheDepth) {\n        this._maxCacheDepth = maxCacheDepth;\n        this._entries = Object.create(null);\n    }\n    static create(parent, state) {\n        return this._INSTANCE.create(parent, state);\n    }\n    create(parent, state) {\n        if (parent !== null && parent.depth >= this._maxCacheDepth) {\n            // no caching above a certain depth\n            return new MonarchStackElement(parent, state);\n        }\n        let stackElementId = MonarchStackElement.getStackElementId(parent);\n        if (stackElementId.length > 0) {\n            stackElementId += '|';\n        }\n        stackElementId += state;\n        let result = this._entries[stackElementId];\n        if (result) {\n            return result;\n        }\n        result = new MonarchStackElement(parent, state);\n        this._entries[stackElementId] = result;\n        return result;\n    }\n}\nMonarchStackElementFactory._INSTANCE = new MonarchStackElementFactory(CACHE_STACK_DEPTH);\nclass MonarchStackElement {\n    constructor(parent, state) {\n        this.parent = parent;\n        this.state = state;\n        this.depth = (this.parent ? this.parent.depth : 0) + 1;\n    }\n    static getStackElementId(element) {\n        let result = '';\n        while (element !== null) {\n            if (result.length > 0) {\n                result += '|';\n            }\n            result += element.state;\n            element = element.parent;\n        }\n        return result;\n    }\n    static _equals(a, b) {\n        while (a !== null && b !== null) {\n            if (a === b) {\n                return true;\n            }\n            if (a.state !== b.state) {\n                return false;\n            }\n            a = a.parent;\n            b = b.parent;\n        }\n        if (a === null && b === null) {\n            return true;\n        }\n        return false;\n    }\n    equals(other) {\n        return MonarchStackElement._equals(this, other);\n    }\n    push(state) {\n        return MonarchStackElementFactory.create(this, state);\n    }\n    pop() {\n        return this.parent;\n    }\n    popall() {\n        let result = this;\n        while (result.parent) {\n            result = result.parent;\n        }\n        return result;\n    }\n    switchTo(state) {\n        return MonarchStackElementFactory.create(this.parent, state);\n    }\n}\nclass EmbeddedLanguageData {\n    constructor(languageId, state) {\n        this.languageId = languageId;\n        this.state = state;\n    }\n    equals(other) {\n        return (this.languageId === other.languageId\n            && this.state.equals(other.state));\n    }\n    clone() {\n        const stateClone = this.state.clone();\n        // save an object\n        if (stateClone === this.state) {\n            return this;\n        }\n        return new EmbeddedLanguageData(this.languageId, this.state);\n    }\n}\n/**\n * Reuse the same line states up to a certain depth.\n */\nclass MonarchLineStateFactory {\n    constructor(maxCacheDepth) {\n        this._maxCacheDepth = maxCacheDepth;\n        this._entries = Object.create(null);\n    }\n    static create(stack, embeddedLanguageData) {\n        return this._INSTANCE.create(stack, embeddedLanguageData);\n    }\n    create(stack, embeddedLanguageData) {\n        if (embeddedLanguageData !== null) {\n            // no caching when embedding\n            return new MonarchLineState(stack, embeddedLanguageData);\n        }\n        if (stack !== null && stack.depth >= this._maxCacheDepth) {\n            // no caching above a certain depth\n            return new MonarchLineState(stack, embeddedLanguageData);\n        }\n        const stackElementId = MonarchStackElement.getStackElementId(stack);\n        let result = this._entries[stackElementId];\n        if (result) {\n            return result;\n        }\n        result = new MonarchLineState(stack, null);\n        this._entries[stackElementId] = result;\n        return result;\n    }\n}\nMonarchLineStateFactory._INSTANCE = new MonarchLineStateFactory(CACHE_STACK_DEPTH);\nclass MonarchLineState {\n    constructor(stack, embeddedLanguageData) {\n        this.stack = stack;\n        this.embeddedLanguageData = embeddedLanguageData;\n    }\n    clone() {\n        const embeddedlanguageDataClone = this.embeddedLanguageData ? this.embeddedLanguageData.clone() : null;\n        // save an object\n        if (embeddedlanguageDataClone === this.embeddedLanguageData) {\n            return this;\n        }\n        return MonarchLineStateFactory.create(this.stack, this.embeddedLanguageData);\n    }\n    equals(other) {\n        if (!(other instanceof MonarchLineState)) {\n            return false;\n        }\n        if (!this.stack.equals(other.stack)) {\n            return false;\n        }\n        if (this.embeddedLanguageData === null && other.embeddedLanguageData === null) {\n            return true;\n        }\n        if (this.embeddedLanguageData === null || other.embeddedLanguageData === null) {\n            return false;\n        }\n        return this.embeddedLanguageData.equals(other.embeddedLanguageData);\n    }\n}\nclass MonarchClassicTokensCollector {\n    constructor() {\n        this._tokens = [];\n        this._languageId = null;\n        this._lastTokenType = null;\n        this._lastTokenLanguage = null;\n    }\n    enterLanguage(languageId) {\n        this._languageId = languageId;\n    }\n    emit(startOffset, type) {\n        if (this._lastTokenType === type && this._lastTokenLanguage === this._languageId) {\n            return;\n        }\n        this._lastTokenType = type;\n        this._lastTokenLanguage = this._languageId;\n        this._tokens.push(new languages.Token(startOffset, type, this._languageId));\n    }\n    nestedLanguageTokenize(embeddedLanguageLine, hasEOL, embeddedLanguageData, offsetDelta) {\n        const nestedLanguageId = embeddedLanguageData.languageId;\n        const embeddedModeState = embeddedLanguageData.state;\n        const nestedLanguageTokenizationSupport = languages.TokenizationRegistry.get(nestedLanguageId);\n        if (!nestedLanguageTokenizationSupport) {\n            this.enterLanguage(nestedLanguageId);\n            this.emit(offsetDelta, '');\n            return embeddedModeState;\n        }\n        const nestedResult = nestedLanguageTokenizationSupport.tokenize(embeddedLanguageLine, hasEOL, embeddedModeState);\n        if (offsetDelta !== 0) {\n            for (const token of nestedResult.tokens) {\n                this._tokens.push(new languages.Token(token.offset + offsetDelta, token.type, token.language));\n            }\n        }\n        else {\n            this._tokens = this._tokens.concat(nestedResult.tokens);\n        }\n        this._lastTokenType = null;\n        this._lastTokenLanguage = null;\n        this._languageId = null;\n        return nestedResult.endState;\n    }\n    finalize(endState) {\n        return new languages.TokenizationResult(this._tokens, endState);\n    }\n}\nclass MonarchModernTokensCollector {\n    constructor(languageService, theme) {\n        this._languageService = languageService;\n        this._theme = theme;\n        this._prependTokens = null;\n        this._tokens = [];\n        this._currentLanguageId = 0 /* LanguageId.Null */;\n        this._lastTokenMetadata = 0;\n    }\n    enterLanguage(languageId) {\n        this._currentLanguageId = this._languageService.languageIdCodec.encodeLanguageId(languageId);\n    }\n    emit(startOffset, type) {\n        const metadata = this._theme.match(this._currentLanguageId, type);\n        if (this._lastTokenMetadata === metadata) {\n            return;\n        }\n        this._lastTokenMetadata = metadata;\n        this._tokens.push(startOffset);\n        this._tokens.push(metadata);\n    }\n    static _merge(a, b, c) {\n        const aLen = (a !== null ? a.length : 0);\n        const bLen = b.length;\n        const cLen = (c !== null ? c.length : 0);\n        if (aLen === 0 && bLen === 0 && cLen === 0) {\n            return new Uint32Array(0);\n        }\n        if (aLen === 0 && bLen === 0) {\n            return c;\n        }\n        if (bLen === 0 && cLen === 0) {\n            return a;\n        }\n        const result = new Uint32Array(aLen + bLen + cLen);\n        if (a !== null) {\n            result.set(a);\n        }\n        for (let i = 0; i < bLen; i++) {\n            result[aLen + i] = b[i];\n        }\n        if (c !== null) {\n            result.set(c, aLen + bLen);\n        }\n        return result;\n    }\n    nestedLanguageTokenize(embeddedLanguageLine, hasEOL, embeddedLanguageData, offsetDelta) {\n        const nestedLanguageId = embeddedLanguageData.languageId;\n        const embeddedModeState = embeddedLanguageData.state;\n        const nestedLanguageTokenizationSupport = languages.TokenizationRegistry.get(nestedLanguageId);\n        if (!nestedLanguageTokenizationSupport) {\n            this.enterLanguage(nestedLanguageId);\n            this.emit(offsetDelta, '');\n            return embeddedModeState;\n        }\n        const nestedResult = nestedLanguageTokenizationSupport.tokenizeEncoded(embeddedLanguageLine, hasEOL, embeddedModeState);\n        if (offsetDelta !== 0) {\n            for (let i = 0, len = nestedResult.tokens.length; i < len; i += 2) {\n                nestedResult.tokens[i] += offsetDelta;\n            }\n        }\n        this._prependTokens = MonarchModernTokensCollector._merge(this._prependTokens, this._tokens, nestedResult.tokens);\n        this._tokens = [];\n        this._currentLanguageId = 0;\n        this._lastTokenMetadata = 0;\n        return nestedResult.endState;\n    }\n    finalize(endState) {\n        return new languages.EncodedTokenizationResult(MonarchModernTokensCollector._merge(this._prependTokens, this._tokens, null), endState);\n    }\n}\nlet MonarchTokenizer = class MonarchTokenizer {\n    constructor(languageService, standaloneThemeService, languageId, lexer, _configurationService) {\n        this._configurationService = _configurationService;\n        this._languageService = languageService;\n        this._standaloneThemeService = standaloneThemeService;\n        this._languageId = languageId;\n        this._lexer = lexer;\n        this._embeddedLanguages = Object.create(null);\n        this.embeddedLoaded = Promise.resolve(undefined);\n        // Set up listening for embedded modes\n        let emitting = false;\n        this._tokenizationRegistryListener = languages.TokenizationRegistry.onDidChange((e) => {\n            if (emitting) {\n                return;\n            }\n            let isOneOfMyEmbeddedModes = false;\n            for (let i = 0, len = e.changedLanguages.length; i < len; i++) {\n                const language = e.changedLanguages[i];\n                if (this._embeddedLanguages[language]) {\n                    isOneOfMyEmbeddedModes = true;\n                    break;\n                }\n            }\n            if (isOneOfMyEmbeddedModes) {\n                emitting = true;\n                languages.TokenizationRegistry.fire([this._languageId]);\n                emitting = false;\n            }\n        });\n        this._maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: this._languageId\n        });\n        this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration('editor.maxTokenizationLineLength')) {\n                this._maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n                    overrideIdentifier: this._languageId\n                });\n            }\n        });\n    }\n    dispose() {\n        this._tokenizationRegistryListener.dispose();\n    }\n    getLoadStatus() {\n        const promises = [];\n        for (const nestedLanguageId in this._embeddedLanguages) {\n            const tokenizationSupport = languages.TokenizationRegistry.get(nestedLanguageId);\n            if (tokenizationSupport) {\n                // The nested language is already loaded\n                if (tokenizationSupport instanceof MonarchTokenizer) {\n                    const nestedModeStatus = tokenizationSupport.getLoadStatus();\n                    if (nestedModeStatus.loaded === false) {\n                        promises.push(nestedModeStatus.promise);\n                    }\n                }\n                continue;\n            }\n            if (!languages.TokenizationRegistry.isResolved(nestedLanguageId)) {\n                // The nested language is in the process of being loaded\n                promises.push(languages.TokenizationRegistry.getOrCreate(nestedLanguageId));\n            }\n        }\n        if (promises.length === 0) {\n            return {\n                loaded: true\n            };\n        }\n        return {\n            loaded: false,\n            promise: Promise.all(promises).then(_ => undefined)\n        };\n    }\n    getInitialState() {\n        const rootState = MonarchStackElementFactory.create(null, this._lexer.start);\n        return MonarchLineStateFactory.create(rootState, null);\n    }\n    tokenize(line, hasEOL, lineState) {\n        if (line.length >= this._maxTokenizationLineLength) {\n            return nullTokenize(this._languageId, lineState);\n        }\n        const tokensCollector = new MonarchClassicTokensCollector();\n        const endLineState = this._tokenize(line, hasEOL, lineState, tokensCollector);\n        return tokensCollector.finalize(endLineState);\n    }\n    tokenizeEncoded(line, hasEOL, lineState) {\n        if (line.length >= this._maxTokenizationLineLength) {\n            return nullTokenizeEncoded(this._languageService.languageIdCodec.encodeLanguageId(this._languageId), lineState);\n        }\n        const tokensCollector = new MonarchModernTokensCollector(this._languageService, this._standaloneThemeService.getColorTheme().tokenTheme);\n        const endLineState = this._tokenize(line, hasEOL, lineState, tokensCollector);\n        return tokensCollector.finalize(endLineState);\n    }\n    _tokenize(line, hasEOL, lineState, collector) {\n        if (lineState.embeddedLanguageData) {\n            return this._nestedTokenize(line, hasEOL, lineState, 0, collector);\n        }\n        else {\n            return this._myTokenize(line, hasEOL, lineState, 0, collector);\n        }\n    }\n    _findLeavingNestedLanguageOffset(line, state) {\n        let rules = this._lexer.tokenizer[state.stack.state];\n        if (!rules) {\n            rules = monarchCommon.findRules(this._lexer, state.stack.state); // do parent matching\n            if (!rules) {\n                throw monarchCommon.createError(this._lexer, 'tokenizer state is not defined: ' + state.stack.state);\n            }\n        }\n        let popOffset = -1;\n        let hasEmbeddedPopRule = false;\n        for (const rule of rules) {\n            if (!monarchCommon.isIAction(rule.action) || rule.action.nextEmbedded !== '@pop') {\n                continue;\n            }\n            hasEmbeddedPopRule = true;\n            let regex = rule.regex;\n            const regexSource = rule.regex.source;\n            if (regexSource.substr(0, 4) === '^(?:' && regexSource.substr(regexSource.length - 1, 1) === ')') {\n                const flags = (regex.ignoreCase ? 'i' : '') + (regex.unicode ? 'u' : '');\n                regex = new RegExp(regexSource.substr(4, regexSource.length - 5), flags);\n            }\n            const result = line.search(regex);\n            if (result === -1 || (result !== 0 && rule.matchOnlyAtLineStart)) {\n                continue;\n            }\n            if (popOffset === -1 || result < popOffset) {\n                popOffset = result;\n            }\n        }\n        if (!hasEmbeddedPopRule) {\n            throw monarchCommon.createError(this._lexer, 'no rule containing nextEmbedded: \"@pop\" in tokenizer embedded state: ' + state.stack.state);\n        }\n        return popOffset;\n    }\n    _nestedTokenize(line, hasEOL, lineState, offsetDelta, tokensCollector) {\n        const popOffset = this._findLeavingNestedLanguageOffset(line, lineState);\n        if (popOffset === -1) {\n            // tokenization will not leave nested language\n            const nestedEndState = tokensCollector.nestedLanguageTokenize(line, hasEOL, lineState.embeddedLanguageData, offsetDelta);\n            return MonarchLineStateFactory.create(lineState.stack, new EmbeddedLanguageData(lineState.embeddedLanguageData.languageId, nestedEndState));\n        }\n        const nestedLanguageLine = line.substring(0, popOffset);\n        if (nestedLanguageLine.length > 0) {\n            // tokenize with the nested language\n            tokensCollector.nestedLanguageTokenize(nestedLanguageLine, false, lineState.embeddedLanguageData, offsetDelta);\n        }\n        const restOfTheLine = line.substring(popOffset);\n        return this._myTokenize(restOfTheLine, hasEOL, lineState, offsetDelta + popOffset, tokensCollector);\n    }\n    _safeRuleName(rule) {\n        if (rule) {\n            return rule.name;\n        }\n        return '(unknown)';\n    }\n    _myTokenize(lineWithoutLF, hasEOL, lineState, offsetDelta, tokensCollector) {\n        tokensCollector.enterLanguage(this._languageId);\n        const lineWithoutLFLength = lineWithoutLF.length;\n        const line = (hasEOL && this._lexer.includeLF ? lineWithoutLF + '\\n' : lineWithoutLF);\n        const lineLength = line.length;\n        let embeddedLanguageData = lineState.embeddedLanguageData;\n        let stack = lineState.stack;\n        let pos = 0;\n        let groupMatching = null;\n        // See https://github.com/microsoft/monaco-editor/issues/1235\n        // Evaluate rules at least once for an empty line\n        let forceEvaluation = true;\n        while (forceEvaluation || pos < lineLength) {\n            const pos0 = pos;\n            const stackLen0 = stack.depth;\n            const groupLen0 = groupMatching ? groupMatching.groups.length : 0;\n            const state = stack.state;\n            let matches = null;\n            let matched = null;\n            let action = null;\n            let rule = null;\n            let enteringEmbeddedLanguage = null;\n            // check if we need to process group matches first\n            if (groupMatching) {\n                matches = groupMatching.matches;\n                const groupEntry = groupMatching.groups.shift();\n                matched = groupEntry.matched;\n                action = groupEntry.action;\n                rule = groupMatching.rule;\n                // cleanup if necessary\n                if (groupMatching.groups.length === 0) {\n                    groupMatching = null;\n                }\n            }\n            else {\n                // otherwise we match on the token stream\n                if (!forceEvaluation && pos >= lineLength) {\n                    // nothing to do\n                    break;\n                }\n                forceEvaluation = false;\n                // get the rules for this state\n                let rules = this._lexer.tokenizer[state];\n                if (!rules) {\n                    rules = monarchCommon.findRules(this._lexer, state); // do parent matching\n                    if (!rules) {\n                        throw monarchCommon.createError(this._lexer, 'tokenizer state is not defined: ' + state);\n                    }\n                }\n                // try each rule until we match\n                const restOfLine = line.substr(pos);\n                for (const rule of rules) {\n                    if (pos === 0 || !rule.matchOnlyAtLineStart) {\n                        matches = restOfLine.match(rule.regex);\n                        if (matches) {\n                            matched = matches[0];\n                            action = rule.action;\n                            break;\n                        }\n                    }\n                }\n            }\n            // We matched 'rule' with 'matches' and 'action'\n            if (!matches) {\n                matches = [''];\n                matched = '';\n            }\n            if (!action) {\n                // bad: we didn't match anything, and there is no action to take\n                // we need to advance the stream or we get progress trouble\n                if (pos < lineLength) {\n                    matches = [line.charAt(pos)];\n                    matched = matches[0];\n                }\n                action = this._lexer.defaultToken;\n            }\n            if (matched === null) {\n                // should never happen, needed for strict null checking\n                break;\n            }\n            // advance stream\n            pos += matched.length;\n            // maybe call action function (used for 'cases')\n            while (monarchCommon.isFuzzyAction(action) && monarchCommon.isIAction(action) && action.test) {\n                action = action.test(matched, matches, state, pos === lineLength);\n            }\n            let result = null;\n            // set the result: either a string or an array of actions\n            if (typeof action === 'string' || Array.isArray(action)) {\n                result = action;\n            }\n            else if (action.group) {\n                result = action.group;\n            }\n            else if (action.token !== null && action.token !== undefined) {\n                // do $n replacements?\n                if (action.tokenSubst) {\n                    result = monarchCommon.substituteMatches(this._lexer, action.token, matched, matches, state);\n                }\n                else {\n                    result = action.token;\n                }\n                // enter embedded language?\n                if (action.nextEmbedded) {\n                    if (action.nextEmbedded === '@pop') {\n                        if (!embeddedLanguageData) {\n                            throw monarchCommon.createError(this._lexer, 'cannot pop embedded language if not inside one');\n                        }\n                        embeddedLanguageData = null;\n                    }\n                    else if (embeddedLanguageData) {\n                        throw monarchCommon.createError(this._lexer, 'cannot enter embedded language from within an embedded language');\n                    }\n                    else {\n                        enteringEmbeddedLanguage = monarchCommon.substituteMatches(this._lexer, action.nextEmbedded, matched, matches, state);\n                    }\n                }\n                // state transformations\n                if (action.goBack) { // back up the stream..\n                    pos = Math.max(0, pos - action.goBack);\n                }\n                if (action.switchTo && typeof action.switchTo === 'string') {\n                    let nextState = monarchCommon.substituteMatches(this._lexer, action.switchTo, matched, matches, state); // switch state without a push...\n                    if (nextState[0] === '@') {\n                        nextState = nextState.substr(1); // peel off starting '@'\n                    }\n                    if (!monarchCommon.findRules(this._lexer, nextState)) {\n                        throw monarchCommon.createError(this._lexer, 'trying to switch to a state \\'' + nextState + '\\' that is undefined in rule: ' + this._safeRuleName(rule));\n                    }\n                    else {\n                        stack = stack.switchTo(nextState);\n                    }\n                }\n                else if (action.transform && typeof action.transform === 'function') {\n                    throw monarchCommon.createError(this._lexer, 'action.transform not supported');\n                }\n                else if (action.next) {\n                    if (action.next === '@push') {\n                        if (stack.depth >= this._lexer.maxStack) {\n                            throw monarchCommon.createError(this._lexer, 'maximum tokenizer stack size reached: [' +\n                                stack.state + ',' + stack.parent.state + ',...]');\n                        }\n                        else {\n                            stack = stack.push(state);\n                        }\n                    }\n                    else if (action.next === '@pop') {\n                        if (stack.depth <= 1) {\n                            throw monarchCommon.createError(this._lexer, 'trying to pop an empty stack in rule: ' + this._safeRuleName(rule));\n                        }\n                        else {\n                            stack = stack.pop();\n                        }\n                    }\n                    else if (action.next === '@popall') {\n                        stack = stack.popall();\n                    }\n                    else {\n                        let nextState = monarchCommon.substituteMatches(this._lexer, action.next, matched, matches, state);\n                        if (nextState[0] === '@') {\n                            nextState = nextState.substr(1); // peel off starting '@'\n                        }\n                        if (!monarchCommon.findRules(this._lexer, nextState)) {\n                            throw monarchCommon.createError(this._lexer, 'trying to set a next state \\'' + nextState + '\\' that is undefined in rule: ' + this._safeRuleName(rule));\n                        }\n                        else {\n                            stack = stack.push(nextState);\n                        }\n                    }\n                }\n                if (action.log && typeof (action.log) === 'string') {\n                    monarchCommon.log(this._lexer, this._lexer.languageId + ': ' + monarchCommon.substituteMatches(this._lexer, action.log, matched, matches, state));\n                }\n            }\n            // check result\n            if (result === null) {\n                throw monarchCommon.createError(this._lexer, 'lexer rule has no well-defined action in rule: ' + this._safeRuleName(rule));\n            }\n            const computeNewStateForEmbeddedLanguage = (enteringEmbeddedLanguage) => {\n                // support language names, mime types, and language ids\n                const languageId = (this._languageService.getLanguageIdByLanguageName(enteringEmbeddedLanguage)\n                    || this._languageService.getLanguageIdByMimeType(enteringEmbeddedLanguage)\n                    || enteringEmbeddedLanguage);\n                const embeddedLanguageData = this._getNestedEmbeddedLanguageData(languageId);\n                if (pos < lineLength) {\n                    // there is content from the embedded language on this line\n                    const restOfLine = lineWithoutLF.substr(pos);\n                    return this._nestedTokenize(restOfLine, hasEOL, MonarchLineStateFactory.create(stack, embeddedLanguageData), offsetDelta + pos, tokensCollector);\n                }\n                else {\n                    return MonarchLineStateFactory.create(stack, embeddedLanguageData);\n                }\n            };\n            // is the result a group match?\n            if (Array.isArray(result)) {\n                if (groupMatching && groupMatching.groups.length > 0) {\n                    throw monarchCommon.createError(this._lexer, 'groups cannot be nested: ' + this._safeRuleName(rule));\n                }\n                if (matches.length !== result.length + 1) {\n                    throw monarchCommon.createError(this._lexer, 'matched number of groups does not match the number of actions in rule: ' + this._safeRuleName(rule));\n                }\n                let totalLen = 0;\n                for (let i = 1; i < matches.length; i++) {\n                    totalLen += matches[i].length;\n                }\n                if (totalLen !== matched.length) {\n                    throw monarchCommon.createError(this._lexer, 'with groups, all characters should be matched in consecutive groups in rule: ' + this._safeRuleName(rule));\n                }\n                groupMatching = {\n                    rule: rule,\n                    matches: matches,\n                    groups: []\n                };\n                for (let i = 0; i < result.length; i++) {\n                    groupMatching.groups[i] = {\n                        action: result[i],\n                        matched: matches[i + 1]\n                    };\n                }\n                pos -= matched.length;\n                // call recursively to initiate first result match\n                continue;\n            }\n            else {\n                // regular result\n                // check for '@rematch'\n                if (result === '@rematch') {\n                    pos -= matched.length;\n                    matched = ''; // better set the next state too..\n                    matches = null;\n                    result = '';\n                    // Even though `@rematch` was specified, if `nextEmbedded` also specified,\n                    // a state transition should occur.\n                    if (enteringEmbeddedLanguage !== null) {\n                        return computeNewStateForEmbeddedLanguage(enteringEmbeddedLanguage);\n                    }\n                }\n                // check progress\n                if (matched.length === 0) {\n                    if (lineLength === 0 || stackLen0 !== stack.depth || state !== stack.state || (!groupMatching ? 0 : groupMatching.groups.length) !== groupLen0) {\n                        continue;\n                    }\n                    else {\n                        throw monarchCommon.createError(this._lexer, 'no progress in tokenizer in rule: ' + this._safeRuleName(rule));\n                    }\n                }\n                // return the result (and check for brace matching)\n                // todo: for efficiency we could pre-sanitize tokenPostfix and substitutions\n                let tokenType = null;\n                if (monarchCommon.isString(result) && result.indexOf('@brackets') === 0) {\n                    const rest = result.substr('@brackets'.length);\n                    const bracket = findBracket(this._lexer, matched);\n                    if (!bracket) {\n                        throw monarchCommon.createError(this._lexer, '@brackets token returned but no bracket defined as: ' + matched);\n                    }\n                    tokenType = monarchCommon.sanitize(bracket.token + rest);\n                }\n                else {\n                    const token = (result === '' ? '' : result + this._lexer.tokenPostfix);\n                    tokenType = monarchCommon.sanitize(token);\n                }\n                if (pos0 < lineWithoutLFLength) {\n                    tokensCollector.emit(pos0 + offsetDelta, tokenType);\n                }\n            }\n            if (enteringEmbeddedLanguage !== null) {\n                return computeNewStateForEmbeddedLanguage(enteringEmbeddedLanguage);\n            }\n        }\n        return MonarchLineStateFactory.create(stack, embeddedLanguageData);\n    }\n    _getNestedEmbeddedLanguageData(languageId) {\n        if (!this._languageService.isRegisteredLanguageId(languageId)) {\n            return new EmbeddedLanguageData(languageId, NullState);\n        }\n        if (languageId !== this._languageId) {\n            // Fire language loading event\n            languages.TokenizationRegistry.getOrCreate(languageId);\n            this._embeddedLanguages[languageId] = true;\n        }\n        const tokenizationSupport = languages.TokenizationRegistry.get(languageId);\n        if (tokenizationSupport) {\n            return new EmbeddedLanguageData(languageId, tokenizationSupport.getInitialState());\n        }\n        return new EmbeddedLanguageData(languageId, NullState);\n    }\n};\nMonarchTokenizer = __decorate([\n    __param(4, IConfigurationService)\n], MonarchTokenizer);\nexport { MonarchTokenizer };\n/**\n * Searches for a bracket in the 'brackets' attribute that matches the input.\n */\nfunction findBracket(lexer, matched) {\n    if (!matched) {\n        return null;\n    }\n    matched = monarchCommon.fixCase(lexer, matched);\n    const brackets = lexer.brackets;\n    for (const bracket of brackets) {\n        if (bracket.open === matched) {\n            return { token: bracket.token, bracketType: 1 /* monarchCommon.MonarchBracket.Open */ };\n        }\n        else if (bracket.close === matched) {\n            return { token: bracket.token, bracketType: -1 /* monarchCommon.MonarchBracket.Close */ };\n        }\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a;\nimport * as strings from '../../../base/common/strings.js';\nimport { LineTokens } from '../../common/tokens/lineTokens.js';\nimport { TokenizationRegistry } from '../../common/languages.js';\nimport { RenderLineInput, renderViewLine2 as renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\nimport { ViewLineRenderingData } from '../../common/viewModel.js';\nimport { MonarchTokenizer } from '../common/monarch/monarchLexer.js';\nconst ttPolicy = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('standaloneColorizer', { createHTML: value => value });\nexport class Colorizer {\n    static colorizeElement(themeService, languageService, domNode, options) {\n        options = options || {};\n        const theme = options.theme || 'vs';\n        const mimeType = options.mimeType || domNode.getAttribute('lang') || domNode.getAttribute('data-lang');\n        if (!mimeType) {\n            console.error('Mode not detected');\n            return Promise.resolve();\n        }\n        const languageId = languageService.getLanguageIdByMimeType(mimeType) || mimeType;\n        themeService.setTheme(theme);\n        const text = domNode.firstChild ? domNode.firstChild.nodeValue : '';\n        domNode.className += ' ' + theme;\n        const render = (str) => {\n            var _a;\n            const trustedhtml = (_a = ttPolicy === null || ttPolicy === void 0 ? void 0 : ttPolicy.createHTML(str)) !== null && _a !== void 0 ? _a : str;\n            domNode.innerHTML = trustedhtml;\n        };\n        return this.colorize(languageService, text || '', languageId, options).then(render, (err) => console.error(err));\n    }\n    static colorize(languageService, text, languageId, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const languageIdCodec = languageService.languageIdCodec;\n            let tabSize = 4;\n            if (options && typeof options.tabSize === 'number') {\n                tabSize = options.tabSize;\n            }\n            if (strings.startsWithUTF8BOM(text)) {\n                text = text.substr(1);\n            }\n            const lines = strings.splitLines(text);\n            if (!languageService.isRegisteredLanguageId(languageId)) {\n                return _fakeColorize(lines, tabSize, languageIdCodec);\n            }\n            const tokenizationSupport = yield TokenizationRegistry.getOrCreate(languageId);\n            if (tokenizationSupport) {\n                return _colorize(lines, tabSize, tokenizationSupport, languageIdCodec);\n            }\n            return _fakeColorize(lines, tabSize, languageIdCodec);\n        });\n    }\n    static colorizeLine(line, mightContainNonBasicASCII, mightContainRTL, tokens, tabSize = 4) {\n        const isBasicASCII = ViewLineRenderingData.isBasicASCII(line, mightContainNonBasicASCII);\n        const containsRTL = ViewLineRenderingData.containsRTL(line, isBasicASCII, mightContainRTL);\n        const renderResult = renderViewLine(new RenderLineInput(false, true, line, false, isBasicASCII, containsRTL, 0, tokens, [], tabSize, 0, 0, 0, 0, -1, 'none', false, false, null));\n        return renderResult.html;\n    }\n    static colorizeModelLine(model, lineNumber, tabSize = 4) {\n        const content = model.getLineContent(lineNumber);\n        model.tokenization.forceTokenization(lineNumber);\n        const tokens = model.tokenization.getLineTokens(lineNumber);\n        const inflatedTokens = tokens.inflate();\n        return this.colorizeLine(content, model.mightContainNonBasicASCII(), model.mightContainRTL(), inflatedTokens, tabSize);\n    }\n}\nfunction _colorize(lines, tabSize, tokenizationSupport, languageIdCodec) {\n    return new Promise((c, e) => {\n        const execute = () => {\n            const result = _actualColorize(lines, tabSize, tokenizationSupport, languageIdCodec);\n            if (tokenizationSupport instanceof MonarchTokenizer) {\n                const status = tokenizationSupport.getLoadStatus();\n                if (status.loaded === false) {\n                    status.promise.then(execute, e);\n                    return;\n                }\n            }\n            c(result);\n        };\n        execute();\n    });\n}\nfunction _fakeColorize(lines, tabSize, languageIdCodec) {\n    let html = [];\n    const defaultMetadata = ((0 /* FontStyle.None */ << 11 /* MetadataConsts.FONT_STYLE_OFFSET */)\n        | (1 /* ColorId.DefaultForeground */ << 15 /* MetadataConsts.FOREGROUND_OFFSET */)\n        | (2 /* ColorId.DefaultBackground */ << 24 /* MetadataConsts.BACKGROUND_OFFSET */)) >>> 0;\n    const tokens = new Uint32Array(2);\n    tokens[0] = 0;\n    tokens[1] = defaultMetadata;\n    for (let i = 0, length = lines.length; i < length; i++) {\n        const line = lines[i];\n        tokens[0] = line.length;\n        const lineTokens = new LineTokens(tokens, line, languageIdCodec);\n        const isBasicASCII = ViewLineRenderingData.isBasicASCII(line, /* check for basic ASCII */ true);\n        const containsRTL = ViewLineRenderingData.containsRTL(line, isBasicASCII, /* check for RTL */ true);\n        const renderResult = renderViewLine(new RenderLineInput(false, true, line, false, isBasicASCII, containsRTL, 0, lineTokens, [], tabSize, 0, 0, 0, 0, -1, 'none', false, false, null));\n        html = html.concat(renderResult.html);\n        html.push('<br/>');\n    }\n    return html.join('');\n}\nfunction _actualColorize(lines, tabSize, tokenizationSupport, languageIdCodec) {\n    let html = [];\n    let state = tokenizationSupport.getInitialState();\n    for (let i = 0, length = lines.length; i < length; i++) {\n        const line = lines[i];\n        const tokenizeResult = tokenizationSupport.tokenizeEncoded(line, true, state);\n        LineTokens.convertToEndOffset(tokenizeResult.tokens, line.length);\n        const lineTokens = new LineTokens(tokenizeResult.tokens, line, languageIdCodec);\n        const isBasicASCII = ViewLineRenderingData.isBasicASCII(line, /* check for basic ASCII */ true);\n        const containsRTL = ViewLineRenderingData.containsRTL(line, isBasicASCII, /* check for RTL */ true);\n        const renderResult = renderViewLine(new RenderLineInput(false, true, line, false, isBasicASCII, containsRTL, 0, lineTokens.inflate(), [], tabSize, 0, 0, 0, 0, -1, 'none', false, false, null));\n        html = html.concat(renderResult.html);\n        html.push('<br/>');\n        state = tokenizeResult.endState;\n    }\n    return html.join('');\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nlet AbstractCodeEditorService = class AbstractCodeEditorService extends Disposable {\n    constructor(_themeService) {\n        super();\n        this._themeService = _themeService;\n        this._onCodeEditorAdd = this._register(new Emitter());\n        this.onCodeEditorAdd = this._onCodeEditorAdd.event;\n        this._onCodeEditorRemove = this._register(new Emitter());\n        this.onCodeEditorRemove = this._onCodeEditorRemove.event;\n        this._onDiffEditorAdd = this._register(new Emitter());\n        this.onDiffEditorAdd = this._onDiffEditorAdd.event;\n        this._onDiffEditorRemove = this._register(new Emitter());\n        this.onDiffEditorRemove = this._onDiffEditorRemove.event;\n        this._decorationOptionProviders = new Map();\n        this._codeEditorOpenHandlers = new LinkedList();\n        this._modelProperties = new Map();\n        this._codeEditors = Object.create(null);\n        this._diffEditors = Object.create(null);\n        this._globalStyleSheet = null;\n    }\n    addCodeEditor(editor) {\n        this._codeEditors[editor.getId()] = editor;\n        this._onCodeEditorAdd.fire(editor);\n    }\n    removeCodeEditor(editor) {\n        if (delete this._codeEditors[editor.getId()]) {\n            this._onCodeEditorRemove.fire(editor);\n        }\n    }\n    listCodeEditors() {\n        return Object.keys(this._codeEditors).map(id => this._codeEditors[id]);\n    }\n    addDiffEditor(editor) {\n        this._diffEditors[editor.getId()] = editor;\n        this._onDiffEditorAdd.fire(editor);\n    }\n    removeDiffEditor(editor) {\n        if (delete this._diffEditors[editor.getId()]) {\n            this._onDiffEditorRemove.fire(editor);\n        }\n    }\n    listDiffEditors() {\n        return Object.keys(this._diffEditors).map(id => this._diffEditors[id]);\n    }\n    getFocusedCodeEditor() {\n        let editorWithWidgetFocus = null;\n        const editors = this.listCodeEditors();\n        for (const editor of editors) {\n            if (editor.hasTextFocus()) {\n                // bingo!\n                return editor;\n            }\n            if (editor.hasWidgetFocus()) {\n                editorWithWidgetFocus = editor;\n            }\n        }\n        return editorWithWidgetFocus;\n    }\n    removeDecorationType(key) {\n        const provider = this._decorationOptionProviders.get(key);\n        if (provider) {\n            provider.refCount--;\n            if (provider.refCount <= 0) {\n                this._decorationOptionProviders.delete(key);\n                provider.dispose();\n                this.listCodeEditors().forEach((ed) => ed.removeDecorationsByType(key));\n            }\n        }\n    }\n    setModelProperty(resource, key, value) {\n        const key1 = resource.toString();\n        let dest;\n        if (this._modelProperties.has(key1)) {\n            dest = this._modelProperties.get(key1);\n        }\n        else {\n            dest = new Map();\n            this._modelProperties.set(key1, dest);\n        }\n        dest.set(key, value);\n    }\n    getModelProperty(resource, key) {\n        const key1 = resource.toString();\n        if (this._modelProperties.has(key1)) {\n            const innerMap = this._modelProperties.get(key1);\n            return innerMap.get(key);\n        }\n        return undefined;\n    }\n    openCodeEditor(input, source, sideBySide) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const handler of this._codeEditorOpenHandlers) {\n                const candidate = yield handler(input, source, sideBySide);\n                if (candidate !== null) {\n                    return candidate;\n                }\n            }\n            return null;\n        });\n    }\n    registerCodeEditorOpenHandler(handler) {\n        const rm = this._codeEditorOpenHandlers.unshift(handler);\n        return toDisposable(rm);\n    }\n};\nAbstractCodeEditorService = __decorate([\n    __param(0, IThemeService)\n], AbstractCodeEditorService);\nexport { AbstractCodeEditorService };\nexport class GlobalStyleSheet {\n    constructor(styleSheet) {\n        this._styleSheet = styleSheet;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { windowOpenNoOpener } from '../../../base/browser/dom.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { AbstractCodeEditorService } from '../../browser/services/abstractCodeEditorService.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nlet StandaloneCodeEditorService = class StandaloneCodeEditorService extends AbstractCodeEditorService {\n    constructor(contextKeyService, themeService) {\n        super(themeService);\n        this.onCodeEditorAdd(() => this._checkContextKey());\n        this.onCodeEditorRemove(() => this._checkContextKey());\n        this._editorIsOpen = contextKeyService.createKey('editorIsOpen', false);\n        this._activeCodeEditor = null;\n        this.registerCodeEditorOpenHandler((input, source, sideBySide) => __awaiter(this, void 0, void 0, function* () {\n            if (!source) {\n                return null;\n            }\n            return this.doOpenEditor(source, input);\n        }));\n    }\n    _checkContextKey() {\n        let hasCodeEditor = false;\n        for (const editor of this.listCodeEditors()) {\n            if (!editor.isSimpleWidget) {\n                hasCodeEditor = true;\n                break;\n            }\n        }\n        this._editorIsOpen.set(hasCodeEditor);\n    }\n    setActiveCodeEditor(activeCodeEditor) {\n        this._activeCodeEditor = activeCodeEditor;\n    }\n    getActiveCodeEditor() {\n        return this._activeCodeEditor;\n    }\n    doOpenEditor(editor, input) {\n        const model = this.findModel(editor, input.resource);\n        if (!model) {\n            if (input.resource) {\n                const schema = input.resource.scheme;\n                if (schema === Schemas.http || schema === Schemas.https) {\n                    // This is a fully qualified http or https URL\n                    windowOpenNoOpener(input.resource.toString());\n                    return editor;\n                }\n            }\n            return null;\n        }\n        const selection = (input.options ? input.options.selection : null);\n        if (selection) {\n            if (typeof selection.endLineNumber === 'number' && typeof selection.endColumn === 'number') {\n                editor.setSelection(selection);\n                editor.revealRangeInCenter(selection, 1 /* ScrollType.Immediate */);\n            }\n            else {\n                const pos = {\n                    lineNumber: selection.startLineNumber,\n                    column: selection.startColumn\n                };\n                editor.setPosition(pos);\n                editor.revealPositionInCenter(pos, 1 /* ScrollType.Immediate */);\n            }\n        }\n        return editor;\n    }\n    findModel(editor, resource) {\n        const model = editor.getModel();\n        if (model && model.uri.toString() !== resource.toString()) {\n            return null;\n        }\n        return model;\n    }\n};\nStandaloneCodeEditorService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, IThemeService)\n], StandaloneCodeEditorService);\nexport { StandaloneCodeEditorService };\nregisterSingleton(ICodeEditorService, StandaloneCodeEditorService);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nexport const ILayoutService = createDecorator('layoutService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { Event } from '../../../base/common/event.js';\nimport { ILayoutService } from '../../../platform/layout/browser/layoutService.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nlet StandaloneLayoutService = class StandaloneLayoutService {\n    constructor(_codeEditorService) {\n        this._codeEditorService = _codeEditorService;\n        this.onDidLayout = Event.None;\n        this.offset = { top: 0, quickPickTop: 0 };\n    }\n    get dimension() {\n        if (!this._dimension) {\n            this._dimension = dom.getClientArea(window.document.body);\n        }\n        return this._dimension;\n    }\n    get hasContainer() {\n        return false;\n    }\n    get container() {\n        // On a page, multiple editors can be created. Therefore, there are multiple containers, not\n        // just a single one. Please use `ICodeEditorService` to get the current focused code editor\n        // and use its container if necessary. You can also instantiate `EditorScopedLayoutService`\n        // which implements `ILayoutService` but is not a part of the service collection because\n        // it is code editor instance specific.\n        throw new Error(`ILayoutService.container is not available in the standalone editor!`);\n    }\n    focus() {\n        var _a;\n        (_a = this._codeEditorService.getFocusedCodeEditor()) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n};\nStandaloneLayoutService = __decorate([\n    __param(0, ICodeEditorService)\n], StandaloneLayoutService);\nlet EditorScopedLayoutService = class EditorScopedLayoutService extends StandaloneLayoutService {\n    constructor(_container, codeEditorService) {\n        super(codeEditorService);\n        this._container = _container;\n    }\n    get hasContainer() {\n        return false;\n    }\n    get container() {\n        return this._container;\n    }\n};\nEditorScopedLayoutService = __decorate([\n    __param(1, ICodeEditorService)\n], EditorScopedLayoutService);\nexport { EditorScopedLayoutService };\nregisterSingleton(ILayoutService, StandaloneLayoutService);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { Disposable, isDisposable } from '../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport Severity from '../../../base/common/severity.js';\nimport * as nls from '../../../nls.js';\nimport { IDialogService } from '../../dialogs/common/dialogs.js';\nimport { registerSingleton } from '../../instantiation/common/extensions.js';\nimport { INotificationService } from '../../notification/common/notification.js';\nimport { IUndoRedoService, ResourceEditStackSnapshot, UndoRedoGroup, UndoRedoSource } from './undoRedo.js';\nconst DEBUG = false;\nfunction getResourceLabel(resource) {\n    return resource.scheme === Schemas.file ? resource.fsPath : resource.path;\n}\nlet stackElementCounter = 0;\nclass ResourceStackElement {\n    constructor(actual, resourceLabel, strResource, groupId, groupOrder, sourceId, sourceOrder) {\n        this.id = (++stackElementCounter);\n        this.type = 0 /* UndoRedoElementType.Resource */;\n        this.actual = actual;\n        this.label = actual.label;\n        this.confirmBeforeUndo = actual.confirmBeforeUndo || false;\n        this.resourceLabel = resourceLabel;\n        this.strResource = strResource;\n        this.resourceLabels = [this.resourceLabel];\n        this.strResources = [this.strResource];\n        this.groupId = groupId;\n        this.groupOrder = groupOrder;\n        this.sourceId = sourceId;\n        this.sourceOrder = sourceOrder;\n        this.isValid = true;\n    }\n    setValid(isValid) {\n        this.isValid = isValid;\n    }\n    toString() {\n        return `[id:${this.id}] [group:${this.groupId}] [${this.isValid ? '  VALID' : 'INVALID'}] ${this.actual.constructor.name} - ${this.actual}`;\n    }\n}\nclass ResourceReasonPair {\n    constructor(resourceLabel, reason) {\n        this.resourceLabel = resourceLabel;\n        this.reason = reason;\n    }\n}\nclass RemovedResources {\n    constructor() {\n        this.elements = new Map();\n    }\n    createMessage() {\n        const externalRemoval = [];\n        const noParallelUniverses = [];\n        for (const [, element] of this.elements) {\n            const dest = (element.reason === 0 /* RemovedResourceReason.ExternalRemoval */\n                ? externalRemoval\n                : noParallelUniverses);\n            dest.push(element.resourceLabel);\n        }\n        const messages = [];\n        if (externalRemoval.length > 0) {\n            messages.push(nls.localize({ key: 'externalRemoval', comment: ['{0} is a list of filenames'] }, \"The following files have been closed and modified on disk: {0}.\", externalRemoval.join(', ')));\n        }\n        if (noParallelUniverses.length > 0) {\n            messages.push(nls.localize({ key: 'noParallelUniverses', comment: ['{0} is a list of filenames'] }, \"The following files have been modified in an incompatible way: {0}.\", noParallelUniverses.join(', ')));\n        }\n        return messages.join('\\n');\n    }\n    get size() {\n        return this.elements.size;\n    }\n    has(strResource) {\n        return this.elements.has(strResource);\n    }\n    set(strResource, value) {\n        this.elements.set(strResource, value);\n    }\n    delete(strResource) {\n        return this.elements.delete(strResource);\n    }\n}\nclass WorkspaceStackElement {\n    constructor(actual, resourceLabels, strResources, groupId, groupOrder, sourceId, sourceOrder) {\n        this.id = (++stackElementCounter);\n        this.type = 1 /* UndoRedoElementType.Workspace */;\n        this.actual = actual;\n        this.label = actual.label;\n        this.confirmBeforeUndo = actual.confirmBeforeUndo || false;\n        this.resourceLabels = resourceLabels;\n        this.strResources = strResources;\n        this.groupId = groupId;\n        this.groupOrder = groupOrder;\n        this.sourceId = sourceId;\n        this.sourceOrder = sourceOrder;\n        this.removedResources = null;\n        this.invalidatedResources = null;\n    }\n    canSplit() {\n        return (typeof this.actual.split === 'function');\n    }\n    removeResource(resourceLabel, strResource, reason) {\n        if (!this.removedResources) {\n            this.removedResources = new RemovedResources();\n        }\n        if (!this.removedResources.has(strResource)) {\n            this.removedResources.set(strResource, new ResourceReasonPair(resourceLabel, reason));\n        }\n    }\n    setValid(resourceLabel, strResource, isValid) {\n        if (isValid) {\n            if (this.invalidatedResources) {\n                this.invalidatedResources.delete(strResource);\n                if (this.invalidatedResources.size === 0) {\n                    this.invalidatedResources = null;\n                }\n            }\n        }\n        else {\n            if (!this.invalidatedResources) {\n                this.invalidatedResources = new RemovedResources();\n            }\n            if (!this.invalidatedResources.has(strResource)) {\n                this.invalidatedResources.set(strResource, new ResourceReasonPair(resourceLabel, 0 /* RemovedResourceReason.ExternalRemoval */));\n            }\n        }\n    }\n    toString() {\n        return `[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources ? 'INVALID' : '  VALID'}] ${this.actual.constructor.name} - ${this.actual}`;\n    }\n}\nclass ResourceEditStack {\n    constructor(resourceLabel, strResource) {\n        this.resourceLabel = resourceLabel;\n        this.strResource = strResource;\n        this._past = [];\n        this._future = [];\n        this.locked = false;\n        this.versionId = 1;\n    }\n    dispose() {\n        for (const element of this._past) {\n            if (element.type === 1 /* UndoRedoElementType.Workspace */) {\n                element.removeResource(this.resourceLabel, this.strResource, 0 /* RemovedResourceReason.ExternalRemoval */);\n            }\n        }\n        for (const element of this._future) {\n            if (element.type === 1 /* UndoRedoElementType.Workspace */) {\n                element.removeResource(this.resourceLabel, this.strResource, 0 /* RemovedResourceReason.ExternalRemoval */);\n            }\n        }\n        this.versionId++;\n    }\n    toString() {\n        const result = [];\n        result.push(`* ${this.strResource}:`);\n        for (let i = 0; i < this._past.length; i++) {\n            result.push(`   * [UNDO] ${this._past[i]}`);\n        }\n        for (let i = this._future.length - 1; i >= 0; i--) {\n            result.push(`   * [REDO] ${this._future[i]}`);\n        }\n        return result.join('\\n');\n    }\n    flushAllElements() {\n        this._past = [];\n        this._future = [];\n        this.versionId++;\n    }\n    _setElementValidFlag(element, isValid) {\n        if (element.type === 1 /* UndoRedoElementType.Workspace */) {\n            element.setValid(this.resourceLabel, this.strResource, isValid);\n        }\n        else {\n            element.setValid(isValid);\n        }\n    }\n    setElementsValidFlag(isValid, filter) {\n        for (const element of this._past) {\n            if (filter(element.actual)) {\n                this._setElementValidFlag(element, isValid);\n            }\n        }\n        for (const element of this._future) {\n            if (filter(element.actual)) {\n                this._setElementValidFlag(element, isValid);\n            }\n        }\n    }\n    pushElement(element) {\n        // remove the future\n        for (const futureElement of this._future) {\n            if (futureElement.type === 1 /* UndoRedoElementType.Workspace */) {\n                futureElement.removeResource(this.resourceLabel, this.strResource, 1 /* RemovedResourceReason.NoParallelUniverses */);\n            }\n        }\n        this._future = [];\n        this._past.push(element);\n        this.versionId++;\n    }\n    createSnapshot(resource) {\n        const elements = [];\n        for (let i = 0, len = this._past.length; i < len; i++) {\n            elements.push(this._past[i].id);\n        }\n        for (let i = this._future.length - 1; i >= 0; i--) {\n            elements.push(this._future[i].id);\n        }\n        return new ResourceEditStackSnapshot(resource, elements);\n    }\n    restoreSnapshot(snapshot) {\n        const snapshotLength = snapshot.elements.length;\n        let isOK = true;\n        let snapshotIndex = 0;\n        let removePastAfter = -1;\n        for (let i = 0, len = this._past.length; i < len; i++, snapshotIndex++) {\n            const element = this._past[i];\n            if (isOK && (snapshotIndex >= snapshotLength || element.id !== snapshot.elements[snapshotIndex])) {\n                isOK = false;\n                removePastAfter = 0;\n            }\n            if (!isOK && element.type === 1 /* UndoRedoElementType.Workspace */) {\n                element.removeResource(this.resourceLabel, this.strResource, 0 /* RemovedResourceReason.ExternalRemoval */);\n            }\n        }\n        let removeFutureBefore = -1;\n        for (let i = this._future.length - 1; i >= 0; i--, snapshotIndex++) {\n            const element = this._future[i];\n            if (isOK && (snapshotIndex >= snapshotLength || element.id !== snapshot.elements[snapshotIndex])) {\n                isOK = false;\n                removeFutureBefore = i;\n            }\n            if (!isOK && element.type === 1 /* UndoRedoElementType.Workspace */) {\n                element.removeResource(this.resourceLabel, this.strResource, 0 /* RemovedResourceReason.ExternalRemoval */);\n            }\n        }\n        if (removePastAfter !== -1) {\n            this._past = this._past.slice(0, removePastAfter);\n        }\n        if (removeFutureBefore !== -1) {\n            this._future = this._future.slice(removeFutureBefore + 1);\n        }\n        this.versionId++;\n    }\n    getElements() {\n        const past = [];\n        const future = [];\n        for (const element of this._past) {\n            past.push(element.actual);\n        }\n        for (const element of this._future) {\n            future.push(element.actual);\n        }\n        return { past, future };\n    }\n    getClosestPastElement() {\n        if (this._past.length === 0) {\n            return null;\n        }\n        return this._past[this._past.length - 1];\n    }\n    getSecondClosestPastElement() {\n        if (this._past.length < 2) {\n            return null;\n        }\n        return this._past[this._past.length - 2];\n    }\n    getClosestFutureElement() {\n        if (this._future.length === 0) {\n            return null;\n        }\n        return this._future[this._future.length - 1];\n    }\n    hasPastElements() {\n        return (this._past.length > 0);\n    }\n    hasFutureElements() {\n        return (this._future.length > 0);\n    }\n    splitPastWorkspaceElement(toRemove, individualMap) {\n        for (let j = this._past.length - 1; j >= 0; j--) {\n            if (this._past[j] === toRemove) {\n                if (individualMap.has(this.strResource)) {\n                    // gets replaced\n                    this._past[j] = individualMap.get(this.strResource);\n                }\n                else {\n                    // gets deleted\n                    this._past.splice(j, 1);\n                }\n                break;\n            }\n        }\n        this.versionId++;\n    }\n    splitFutureWorkspaceElement(toRemove, individualMap) {\n        for (let j = this._future.length - 1; j >= 0; j--) {\n            if (this._future[j] === toRemove) {\n                if (individualMap.has(this.strResource)) {\n                    // gets replaced\n                    this._future[j] = individualMap.get(this.strResource);\n                }\n                else {\n                    // gets deleted\n                    this._future.splice(j, 1);\n                }\n                break;\n            }\n        }\n        this.versionId++;\n    }\n    moveBackward(element) {\n        this._past.pop();\n        this._future.push(element);\n        this.versionId++;\n    }\n    moveForward(element) {\n        this._future.pop();\n        this._past.push(element);\n        this.versionId++;\n    }\n}\nclass EditStackSnapshot {\n    constructor(editStacks) {\n        this.editStacks = editStacks;\n        this._versionIds = [];\n        for (let i = 0, len = this.editStacks.length; i < len; i++) {\n            this._versionIds[i] = this.editStacks[i].versionId;\n        }\n    }\n    isValid() {\n        for (let i = 0, len = this.editStacks.length; i < len; i++) {\n            if (this._versionIds[i] !== this.editStacks[i].versionId) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\nconst missingEditStack = new ResourceEditStack('', '');\nmissingEditStack.locked = true;\nlet UndoRedoService = class UndoRedoService {\n    constructor(_dialogService, _notificationService) {\n        this._dialogService = _dialogService;\n        this._notificationService = _notificationService;\n        this._editStacks = new Map();\n        this._uriComparisonKeyComputers = [];\n    }\n    getUriComparisonKey(resource) {\n        for (const uriComparisonKeyComputer of this._uriComparisonKeyComputers) {\n            if (uriComparisonKeyComputer[0] === resource.scheme) {\n                return uriComparisonKeyComputer[1].getComparisonKey(resource);\n            }\n        }\n        return resource.toString();\n    }\n    _print(label) {\n        console.log(`------------------------------------`);\n        console.log(`AFTER ${label}: `);\n        const str = [];\n        for (const element of this._editStacks) {\n            str.push(element[1].toString());\n        }\n        console.log(str.join('\\n'));\n    }\n    pushElement(element, group = UndoRedoGroup.None, source = UndoRedoSource.None) {\n        if (element.type === 0 /* UndoRedoElementType.Resource */) {\n            const resourceLabel = getResourceLabel(element.resource);\n            const strResource = this.getUriComparisonKey(element.resource);\n            this._pushElement(new ResourceStackElement(element, resourceLabel, strResource, group.id, group.nextOrder(), source.id, source.nextOrder()));\n        }\n        else {\n            const seen = new Set();\n            const resourceLabels = [];\n            const strResources = [];\n            for (const resource of element.resources) {\n                const resourceLabel = getResourceLabel(resource);\n                const strResource = this.getUriComparisonKey(resource);\n                if (seen.has(strResource)) {\n                    continue;\n                }\n                seen.add(strResource);\n                resourceLabels.push(resourceLabel);\n                strResources.push(strResource);\n            }\n            if (resourceLabels.length === 1) {\n                this._pushElement(new ResourceStackElement(element, resourceLabels[0], strResources[0], group.id, group.nextOrder(), source.id, source.nextOrder()));\n            }\n            else {\n                this._pushElement(new WorkspaceStackElement(element, resourceLabels, strResources, group.id, group.nextOrder(), source.id, source.nextOrder()));\n            }\n        }\n        if (DEBUG) {\n            this._print('pushElement');\n        }\n    }\n    _pushElement(element) {\n        for (let i = 0, len = element.strResources.length; i < len; i++) {\n            const resourceLabel = element.resourceLabels[i];\n            const strResource = element.strResources[i];\n            let editStack;\n            if (this._editStacks.has(strResource)) {\n                editStack = this._editStacks.get(strResource);\n            }\n            else {\n                editStack = new ResourceEditStack(resourceLabel, strResource);\n                this._editStacks.set(strResource, editStack);\n            }\n            editStack.pushElement(element);\n        }\n    }\n    getLastElement(resource) {\n        const strResource = this.getUriComparisonKey(resource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            if (editStack.hasFutureElements()) {\n                return null;\n            }\n            const closestPastElement = editStack.getClosestPastElement();\n            return closestPastElement ? closestPastElement.actual : null;\n        }\n        return null;\n    }\n    _splitPastWorkspaceElement(toRemove, ignoreResources) {\n        const individualArr = toRemove.actual.split();\n        const individualMap = new Map();\n        for (const _element of individualArr) {\n            const resourceLabel = getResourceLabel(_element.resource);\n            const strResource = this.getUriComparisonKey(_element.resource);\n            const element = new ResourceStackElement(_element, resourceLabel, strResource, 0, 0, 0, 0);\n            individualMap.set(element.strResource, element);\n        }\n        for (const strResource of toRemove.strResources) {\n            if (ignoreResources && ignoreResources.has(strResource)) {\n                continue;\n            }\n            const editStack = this._editStacks.get(strResource);\n            editStack.splitPastWorkspaceElement(toRemove, individualMap);\n        }\n    }\n    _splitFutureWorkspaceElement(toRemove, ignoreResources) {\n        const individualArr = toRemove.actual.split();\n        const individualMap = new Map();\n        for (const _element of individualArr) {\n            const resourceLabel = getResourceLabel(_element.resource);\n            const strResource = this.getUriComparisonKey(_element.resource);\n            const element = new ResourceStackElement(_element, resourceLabel, strResource, 0, 0, 0, 0);\n            individualMap.set(element.strResource, element);\n        }\n        for (const strResource of toRemove.strResources) {\n            if (ignoreResources && ignoreResources.has(strResource)) {\n                continue;\n            }\n            const editStack = this._editStacks.get(strResource);\n            editStack.splitFutureWorkspaceElement(toRemove, individualMap);\n        }\n    }\n    removeElements(resource) {\n        const strResource = typeof resource === 'string' ? resource : this.getUriComparisonKey(resource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            editStack.dispose();\n            this._editStacks.delete(strResource);\n        }\n        if (DEBUG) {\n            this._print('removeElements');\n        }\n    }\n    setElementsValidFlag(resource, isValid, filter) {\n        const strResource = this.getUriComparisonKey(resource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            editStack.setElementsValidFlag(isValid, filter);\n        }\n        if (DEBUG) {\n            this._print('setElementsValidFlag');\n        }\n    }\n    createSnapshot(resource) {\n        const strResource = this.getUriComparisonKey(resource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            return editStack.createSnapshot(resource);\n        }\n        return new ResourceEditStackSnapshot(resource, []);\n    }\n    restoreSnapshot(snapshot) {\n        const strResource = this.getUriComparisonKey(snapshot.resource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            editStack.restoreSnapshot(snapshot);\n            if (!editStack.hasPastElements() && !editStack.hasFutureElements()) {\n                // the edit stack is now empty, just remove it entirely\n                editStack.dispose();\n                this._editStacks.delete(strResource);\n            }\n        }\n        if (DEBUG) {\n            this._print('restoreSnapshot');\n        }\n    }\n    getElements(resource) {\n        const strResource = this.getUriComparisonKey(resource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            return editStack.getElements();\n        }\n        return { past: [], future: [] };\n    }\n    _findClosestUndoElementWithSource(sourceId) {\n        if (!sourceId) {\n            return [null, null];\n        }\n        // find an element with the sourceId and with the highest sourceOrder ready to be undone\n        let matchedElement = null;\n        let matchedStrResource = null;\n        for (const [strResource, editStack] of this._editStacks) {\n            const candidate = editStack.getClosestPastElement();\n            if (!candidate) {\n                continue;\n            }\n            if (candidate.sourceId === sourceId) {\n                if (!matchedElement || candidate.sourceOrder > matchedElement.sourceOrder) {\n                    matchedElement = candidate;\n                    matchedStrResource = strResource;\n                }\n            }\n        }\n        return [matchedElement, matchedStrResource];\n    }\n    canUndo(resourceOrSource) {\n        if (resourceOrSource instanceof UndoRedoSource) {\n            const [, matchedStrResource] = this._findClosestUndoElementWithSource(resourceOrSource.id);\n            return matchedStrResource ? true : false;\n        }\n        const strResource = this.getUriComparisonKey(resourceOrSource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            return editStack.hasPastElements();\n        }\n        return false;\n    }\n    _onError(err, element) {\n        onUnexpectedError(err);\n        // An error occurred while undoing or redoing => drop the undo/redo stack for all affected resources\n        for (const strResource of element.strResources) {\n            this.removeElements(strResource);\n        }\n        this._notificationService.error(err);\n    }\n    _acquireLocks(editStackSnapshot) {\n        // first, check if all locks can be acquired\n        for (const editStack of editStackSnapshot.editStacks) {\n            if (editStack.locked) {\n                throw new Error('Cannot acquire edit stack lock');\n            }\n        }\n        // can acquire all locks\n        for (const editStack of editStackSnapshot.editStacks) {\n            editStack.locked = true;\n        }\n        return () => {\n            // release all locks\n            for (const editStack of editStackSnapshot.editStacks) {\n                editStack.locked = false;\n            }\n        };\n    }\n    _safeInvokeWithLocks(element, invoke, editStackSnapshot, cleanup, continuation) {\n        const releaseLocks = this._acquireLocks(editStackSnapshot);\n        let result;\n        try {\n            result = invoke();\n        }\n        catch (err) {\n            releaseLocks();\n            cleanup.dispose();\n            return this._onError(err, element);\n        }\n        if (result) {\n            // result is Promise<void>\n            return result.then(() => {\n                releaseLocks();\n                cleanup.dispose();\n                return continuation();\n            }, (err) => {\n                releaseLocks();\n                cleanup.dispose();\n                return this._onError(err, element);\n            });\n        }\n        else {\n            // result is void\n            releaseLocks();\n            cleanup.dispose();\n            return continuation();\n        }\n    }\n    _invokeWorkspacePrepare(element) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof element.actual.prepareUndoRedo === 'undefined') {\n                return Disposable.None;\n            }\n            const result = element.actual.prepareUndoRedo();\n            if (typeof result === 'undefined') {\n                return Disposable.None;\n            }\n            return result;\n        });\n    }\n    _invokeResourcePrepare(element, callback) {\n        if (element.actual.type !== 1 /* UndoRedoElementType.Workspace */ || typeof element.actual.prepareUndoRedo === 'undefined') {\n            // no preparation needed\n            return callback(Disposable.None);\n        }\n        const r = element.actual.prepareUndoRedo();\n        if (!r) {\n            // nothing to clean up\n            return callback(Disposable.None);\n        }\n        if (isDisposable(r)) {\n            return callback(r);\n        }\n        return r.then((disposable) => {\n            return callback(disposable);\n        });\n    }\n    _getAffectedEditStacks(element) {\n        const affectedEditStacks = [];\n        for (const strResource of element.strResources) {\n            affectedEditStacks.push(this._editStacks.get(strResource) || missingEditStack);\n        }\n        return new EditStackSnapshot(affectedEditStacks);\n    }\n    _tryToSplitAndUndo(strResource, element, ignoreResources, message) {\n        if (element.canSplit()) {\n            this._splitPastWorkspaceElement(element, ignoreResources);\n            this._notificationService.warn(message);\n            return new WorkspaceVerificationError(this._undo(strResource, 0, true));\n        }\n        else {\n            // Cannot safely split this workspace element => flush all undo/redo stacks\n            for (const strResource of element.strResources) {\n                this.removeElements(strResource);\n            }\n            this._notificationService.warn(message);\n            return new WorkspaceVerificationError();\n        }\n    }\n    _checkWorkspaceUndo(strResource, element, editStackSnapshot, checkInvalidatedResources) {\n        if (element.removedResources) {\n            return this._tryToSplitAndUndo(strResource, element, element.removedResources, nls.localize({ key: 'cannotWorkspaceUndo', comment: ['{0} is a label for an operation. {1} is another message.'] }, \"Could not undo '{0}' across all files. {1}\", element.label, element.removedResources.createMessage()));\n        }\n        if (checkInvalidatedResources && element.invalidatedResources) {\n            return this._tryToSplitAndUndo(strResource, element, element.invalidatedResources, nls.localize({ key: 'cannotWorkspaceUndo', comment: ['{0} is a label for an operation. {1} is another message.'] }, \"Could not undo '{0}' across all files. {1}\", element.label, element.invalidatedResources.createMessage()));\n        }\n        // this must be the last past element in all the impacted resources!\n        const cannotUndoDueToResources = [];\n        for (const editStack of editStackSnapshot.editStacks) {\n            if (editStack.getClosestPastElement() !== element) {\n                cannotUndoDueToResources.push(editStack.resourceLabel);\n            }\n        }\n        if (cannotUndoDueToResources.length > 0) {\n            return this._tryToSplitAndUndo(strResource, element, null, nls.localize({ key: 'cannotWorkspaceUndoDueToChanges', comment: ['{0} is a label for an operation. {1} is a list of filenames.'] }, \"Could not undo '{0}' across all files because changes were made to {1}\", element.label, cannotUndoDueToResources.join(', ')));\n        }\n        const cannotLockDueToResources = [];\n        for (const editStack of editStackSnapshot.editStacks) {\n            if (editStack.locked) {\n                cannotLockDueToResources.push(editStack.resourceLabel);\n            }\n        }\n        if (cannotLockDueToResources.length > 0) {\n            return this._tryToSplitAndUndo(strResource, element, null, nls.localize({ key: 'cannotWorkspaceUndoDueToInProgressUndoRedo', comment: ['{0} is a label for an operation. {1} is a list of filenames.'] }, \"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}\", element.label, cannotLockDueToResources.join(', ')));\n        }\n        // check if new stack elements were added in the meantime...\n        if (!editStackSnapshot.isValid()) {\n            return this._tryToSplitAndUndo(strResource, element, null, nls.localize({ key: 'cannotWorkspaceUndoDueToInMeantimeUndoRedo', comment: ['{0} is a label for an operation. {1} is a list of filenames.'] }, \"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime\", element.label));\n        }\n        return null;\n    }\n    _workspaceUndo(strResource, element, undoConfirmed) {\n        const affectedEditStacks = this._getAffectedEditStacks(element);\n        const verificationError = this._checkWorkspaceUndo(strResource, element, affectedEditStacks, /*invalidated resources will be checked after the prepare call*/ false);\n        if (verificationError) {\n            return verificationError.returnValue;\n        }\n        return this._confirmAndExecuteWorkspaceUndo(strResource, element, affectedEditStacks, undoConfirmed);\n    }\n    _isPartOfUndoGroup(element) {\n        if (!element.groupId) {\n            return false;\n        }\n        // check that there is at least another element with the same groupId ready to be undone\n        for (const [, editStack] of this._editStacks) {\n            const pastElement = editStack.getClosestPastElement();\n            if (!pastElement) {\n                continue;\n            }\n            if (pastElement === element) {\n                const secondPastElement = editStack.getSecondClosestPastElement();\n                if (secondPastElement && secondPastElement.groupId === element.groupId) {\n                    // there is another element with the same group id in the same stack!\n                    return true;\n                }\n            }\n            if (pastElement.groupId === element.groupId) {\n                // there is another element with the same group id in another stack!\n                return true;\n            }\n        }\n        return false;\n    }\n    _confirmAndExecuteWorkspaceUndo(strResource, element, editStackSnapshot, undoConfirmed) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (element.canSplit() && !this._isPartOfUndoGroup(element)) {\n                // this element can be split\n                const result = yield this._dialogService.show(Severity.Info, nls.localize('confirmWorkspace', \"Would you like to undo '{0}' across all files?\", element.label), [\n                    nls.localize({ key: 'ok', comment: ['{0} denotes a number that is > 1'] }, \"Undo in {0} Files\", editStackSnapshot.editStacks.length),\n                    nls.localize('nok', \"Undo this File\"),\n                    nls.localize('cancel', \"Cancel\"),\n                ], {\n                    cancelId: 2\n                });\n                if (result.choice === 2) {\n                    // choice: cancel\n                    return;\n                }\n                if (result.choice === 1) {\n                    // choice: undo this file\n                    this._splitPastWorkspaceElement(element, null);\n                    return this._undo(strResource, 0, true);\n                }\n                // choice: undo in all files\n                // At this point, it is possible that the element has been made invalid in the meantime (due to the confirmation await)\n                const verificationError1 = this._checkWorkspaceUndo(strResource, element, editStackSnapshot, /*invalidated resources will be checked after the prepare call*/ false);\n                if (verificationError1) {\n                    return verificationError1.returnValue;\n                }\n                undoConfirmed = true;\n            }\n            // prepare\n            let cleanup;\n            try {\n                cleanup = yield this._invokeWorkspacePrepare(element);\n            }\n            catch (err) {\n                return this._onError(err, element);\n            }\n            // At this point, it is possible that the element has been made invalid in the meantime (due to the prepare await)\n            const verificationError2 = this._checkWorkspaceUndo(strResource, element, editStackSnapshot, /*now also check that there are no more invalidated resources*/ true);\n            if (verificationError2) {\n                cleanup.dispose();\n                return verificationError2.returnValue;\n            }\n            for (const editStack of editStackSnapshot.editStacks) {\n                editStack.moveBackward(element);\n            }\n            return this._safeInvokeWithLocks(element, () => element.actual.undo(), editStackSnapshot, cleanup, () => this._continueUndoInGroup(element.groupId, undoConfirmed));\n        });\n    }\n    _resourceUndo(editStack, element, undoConfirmed) {\n        if (!element.isValid) {\n            // invalid element => immediately flush edit stack!\n            editStack.flushAllElements();\n            return;\n        }\n        if (editStack.locked) {\n            const message = nls.localize({ key: 'cannotResourceUndoDueToInProgressUndoRedo', comment: ['{0} is a label for an operation.'] }, \"Could not undo '{0}' because there is already an undo or redo operation running.\", element.label);\n            this._notificationService.warn(message);\n            return;\n        }\n        return this._invokeResourcePrepare(element, (cleanup) => {\n            editStack.moveBackward(element);\n            return this._safeInvokeWithLocks(element, () => element.actual.undo(), new EditStackSnapshot([editStack]), cleanup, () => this._continueUndoInGroup(element.groupId, undoConfirmed));\n        });\n    }\n    _findClosestUndoElementInGroup(groupId) {\n        if (!groupId) {\n            return [null, null];\n        }\n        // find another element with the same groupId and with the highest groupOrder ready to be undone\n        let matchedElement = null;\n        let matchedStrResource = null;\n        for (const [strResource, editStack] of this._editStacks) {\n            const candidate = editStack.getClosestPastElement();\n            if (!candidate) {\n                continue;\n            }\n            if (candidate.groupId === groupId) {\n                if (!matchedElement || candidate.groupOrder > matchedElement.groupOrder) {\n                    matchedElement = candidate;\n                    matchedStrResource = strResource;\n                }\n            }\n        }\n        return [matchedElement, matchedStrResource];\n    }\n    _continueUndoInGroup(groupId, undoConfirmed) {\n        if (!groupId) {\n            return;\n        }\n        const [, matchedStrResource] = this._findClosestUndoElementInGroup(groupId);\n        if (matchedStrResource) {\n            return this._undo(matchedStrResource, 0, undoConfirmed);\n        }\n    }\n    undo(resourceOrSource) {\n        if (resourceOrSource instanceof UndoRedoSource) {\n            const [, matchedStrResource] = this._findClosestUndoElementWithSource(resourceOrSource.id);\n            return matchedStrResource ? this._undo(matchedStrResource, resourceOrSource.id, false) : undefined;\n        }\n        if (typeof resourceOrSource === 'string') {\n            return this._undo(resourceOrSource, 0, false);\n        }\n        return this._undo(this.getUriComparisonKey(resourceOrSource), 0, false);\n    }\n    _undo(strResource, sourceId = 0, undoConfirmed) {\n        if (!this._editStacks.has(strResource)) {\n            return;\n        }\n        const editStack = this._editStacks.get(strResource);\n        const element = editStack.getClosestPastElement();\n        if (!element) {\n            return;\n        }\n        if (element.groupId) {\n            // this element is a part of a group, we need to make sure undoing in a group is in order\n            const [matchedElement, matchedStrResource] = this._findClosestUndoElementInGroup(element.groupId);\n            if (element !== matchedElement && matchedStrResource) {\n                // there is an element in the same group that should be undone before this one\n                return this._undo(matchedStrResource, sourceId, undoConfirmed);\n            }\n        }\n        const shouldPromptForConfirmation = (element.sourceId !== sourceId || element.confirmBeforeUndo);\n        if (shouldPromptForConfirmation && !undoConfirmed) {\n            // Hit a different source or the element asks for prompt before undo, prompt for confirmation\n            return this._confirmAndContinueUndo(strResource, sourceId, element);\n        }\n        try {\n            if (element.type === 1 /* UndoRedoElementType.Workspace */) {\n                return this._workspaceUndo(strResource, element, undoConfirmed);\n            }\n            else {\n                return this._resourceUndo(editStack, element, undoConfirmed);\n            }\n        }\n        finally {\n            if (DEBUG) {\n                this._print('undo');\n            }\n        }\n    }\n    _confirmAndContinueUndo(strResource, sourceId, element) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield this._dialogService.show(Severity.Info, nls.localize('confirmDifferentSource', \"Would you like to undo '{0}'?\", element.label), [\n                nls.localize('confirmDifferentSource.yes', \"Yes\"),\n                nls.localize('confirmDifferentSource.no', \"No\"),\n            ], {\n                cancelId: 1\n            });\n            if (result.choice === 1) {\n                // choice: cancel\n                return;\n            }\n            // choice: undo\n            return this._undo(strResource, sourceId, true);\n        });\n    }\n    _findClosestRedoElementWithSource(sourceId) {\n        if (!sourceId) {\n            return [null, null];\n        }\n        // find an element with sourceId and with the lowest sourceOrder ready to be redone\n        let matchedElement = null;\n        let matchedStrResource = null;\n        for (const [strResource, editStack] of this._editStacks) {\n            const candidate = editStack.getClosestFutureElement();\n            if (!candidate) {\n                continue;\n            }\n            if (candidate.sourceId === sourceId) {\n                if (!matchedElement || candidate.sourceOrder < matchedElement.sourceOrder) {\n                    matchedElement = candidate;\n                    matchedStrResource = strResource;\n                }\n            }\n        }\n        return [matchedElement, matchedStrResource];\n    }\n    canRedo(resourceOrSource) {\n        if (resourceOrSource instanceof UndoRedoSource) {\n            const [, matchedStrResource] = this._findClosestRedoElementWithSource(resourceOrSource.id);\n            return matchedStrResource ? true : false;\n        }\n        const strResource = this.getUriComparisonKey(resourceOrSource);\n        if (this._editStacks.has(strResource)) {\n            const editStack = this._editStacks.get(strResource);\n            return editStack.hasFutureElements();\n        }\n        return false;\n    }\n    _tryToSplitAndRedo(strResource, element, ignoreResources, message) {\n        if (element.canSplit()) {\n            this._splitFutureWorkspaceElement(element, ignoreResources);\n            this._notificationService.warn(message);\n            return new WorkspaceVerificationError(this._redo(strResource));\n        }\n        else {\n            // Cannot safely split this workspace element => flush all undo/redo stacks\n            for (const strResource of element.strResources) {\n                this.removeElements(strResource);\n            }\n            this._notificationService.warn(message);\n            return new WorkspaceVerificationError();\n        }\n    }\n    _checkWorkspaceRedo(strResource, element, editStackSnapshot, checkInvalidatedResources) {\n        if (element.removedResources) {\n            return this._tryToSplitAndRedo(strResource, element, element.removedResources, nls.localize({ key: 'cannotWorkspaceRedo', comment: ['{0} is a label for an operation. {1} is another message.'] }, \"Could not redo '{0}' across all files. {1}\", element.label, element.removedResources.createMessage()));\n        }\n        if (checkInvalidatedResources && element.invalidatedResources) {\n            return this._tryToSplitAndRedo(strResource, element, element.invalidatedResources, nls.localize({ key: 'cannotWorkspaceRedo', comment: ['{0} is a label for an operation. {1} is another message.'] }, \"Could not redo '{0}' across all files. {1}\", element.label, element.invalidatedResources.createMessage()));\n        }\n        // this must be the last future element in all the impacted resources!\n        const cannotRedoDueToResources = [];\n        for (const editStack of editStackSnapshot.editStacks) {\n            if (editStack.getClosestFutureElement() !== element) {\n                cannotRedoDueToResources.push(editStack.resourceLabel);\n            }\n        }\n        if (cannotRedoDueToResources.length > 0) {\n            return this._tryToSplitAndRedo(strResource, element, null, nls.localize({ key: 'cannotWorkspaceRedoDueToChanges', comment: ['{0} is a label for an operation. {1} is a list of filenames.'] }, \"Could not redo '{0}' across all files because changes were made to {1}\", element.label, cannotRedoDueToResources.join(', ')));\n        }\n        const cannotLockDueToResources = [];\n        for (const editStack of editStackSnapshot.editStacks) {\n            if (editStack.locked) {\n                cannotLockDueToResources.push(editStack.resourceLabel);\n            }\n        }\n        if (cannotLockDueToResources.length > 0) {\n            return this._tryToSplitAndRedo(strResource, element, null, nls.localize({ key: 'cannotWorkspaceRedoDueToInProgressUndoRedo', comment: ['{0} is a label for an operation. {1} is a list of filenames.'] }, \"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}\", element.label, cannotLockDueToResources.join(', ')));\n        }\n        // check if new stack elements were added in the meantime...\n        if (!editStackSnapshot.isValid()) {\n            return this._tryToSplitAndRedo(strResource, element, null, nls.localize({ key: 'cannotWorkspaceRedoDueToInMeantimeUndoRedo', comment: ['{0} is a label for an operation. {1} is a list of filenames.'] }, \"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime\", element.label));\n        }\n        return null;\n    }\n    _workspaceRedo(strResource, element) {\n        const affectedEditStacks = this._getAffectedEditStacks(element);\n        const verificationError = this._checkWorkspaceRedo(strResource, element, affectedEditStacks, /*invalidated resources will be checked after the prepare call*/ false);\n        if (verificationError) {\n            return verificationError.returnValue;\n        }\n        return this._executeWorkspaceRedo(strResource, element, affectedEditStacks);\n    }\n    _executeWorkspaceRedo(strResource, element, editStackSnapshot) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // prepare\n            let cleanup;\n            try {\n                cleanup = yield this._invokeWorkspacePrepare(element);\n            }\n            catch (err) {\n                return this._onError(err, element);\n            }\n            // At this point, it is possible that the element has been made invalid in the meantime (due to the prepare await)\n            const verificationError = this._checkWorkspaceRedo(strResource, element, editStackSnapshot, /*now also check that there are no more invalidated resources*/ true);\n            if (verificationError) {\n                cleanup.dispose();\n                return verificationError.returnValue;\n            }\n            for (const editStack of editStackSnapshot.editStacks) {\n                editStack.moveForward(element);\n            }\n            return this._safeInvokeWithLocks(element, () => element.actual.redo(), editStackSnapshot, cleanup, () => this._continueRedoInGroup(element.groupId));\n        });\n    }\n    _resourceRedo(editStack, element) {\n        if (!element.isValid) {\n            // invalid element => immediately flush edit stack!\n            editStack.flushAllElements();\n            return;\n        }\n        if (editStack.locked) {\n            const message = nls.localize({ key: 'cannotResourceRedoDueToInProgressUndoRedo', comment: ['{0} is a label for an operation.'] }, \"Could not redo '{0}' because there is already an undo or redo operation running.\", element.label);\n            this._notificationService.warn(message);\n            return;\n        }\n        return this._invokeResourcePrepare(element, (cleanup) => {\n            editStack.moveForward(element);\n            return this._safeInvokeWithLocks(element, () => element.actual.redo(), new EditStackSnapshot([editStack]), cleanup, () => this._continueRedoInGroup(element.groupId));\n        });\n    }\n    _findClosestRedoElementInGroup(groupId) {\n        if (!groupId) {\n            return [null, null];\n        }\n        // find another element with the same groupId and with the lowest groupOrder ready to be redone\n        let matchedElement = null;\n        let matchedStrResource = null;\n        for (const [strResource, editStack] of this._editStacks) {\n            const candidate = editStack.getClosestFutureElement();\n            if (!candidate) {\n                continue;\n            }\n            if (candidate.groupId === groupId) {\n                if (!matchedElement || candidate.groupOrder < matchedElement.groupOrder) {\n                    matchedElement = candidate;\n                    matchedStrResource = strResource;\n                }\n            }\n        }\n        return [matchedElement, matchedStrResource];\n    }\n    _continueRedoInGroup(groupId) {\n        if (!groupId) {\n            return;\n        }\n        const [, matchedStrResource] = this._findClosestRedoElementInGroup(groupId);\n        if (matchedStrResource) {\n            return this._redo(matchedStrResource);\n        }\n    }\n    redo(resourceOrSource) {\n        if (resourceOrSource instanceof UndoRedoSource) {\n            const [, matchedStrResource] = this._findClosestRedoElementWithSource(resourceOrSource.id);\n            return matchedStrResource ? this._redo(matchedStrResource) : undefined;\n        }\n        if (typeof resourceOrSource === 'string') {\n            return this._redo(resourceOrSource);\n        }\n        return this._redo(this.getUriComparisonKey(resourceOrSource));\n    }\n    _redo(strResource) {\n        if (!this._editStacks.has(strResource)) {\n            return;\n        }\n        const editStack = this._editStacks.get(strResource);\n        const element = editStack.getClosestFutureElement();\n        if (!element) {\n            return;\n        }\n        if (element.groupId) {\n            // this element is a part of a group, we need to make sure redoing in a group is in order\n            const [matchedElement, matchedStrResource] = this._findClosestRedoElementInGroup(element.groupId);\n            if (element !== matchedElement && matchedStrResource) {\n                // there is an element in the same group that should be redone before this one\n                return this._redo(matchedStrResource);\n            }\n        }\n        try {\n            if (element.type === 1 /* UndoRedoElementType.Workspace */) {\n                return this._workspaceRedo(strResource, element);\n            }\n            else {\n                return this._resourceRedo(editStack, element);\n            }\n        }\n        finally {\n            if (DEBUG) {\n                this._print('redo');\n            }\n        }\n    }\n};\nUndoRedoService = __decorate([\n    __param(0, IDialogService),\n    __param(1, INotificationService)\n], UndoRedoService);\nexport { UndoRedoService };\nclass WorkspaceVerificationError {\n    constructor(returnValue) {\n        this.returnValue = returnValue;\n    }\n}\nregisterSingleton(IUndoRedoService, UndoRedoService);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as arrays from '../../../base/common/arrays.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport * as objects from '../../../base/common/objects.js';\nimport * as types from '../../../base/common/types.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { addToValueTree, getConfigurationValue, removeFromValueTree, toValuesTree } from './configuration.js';\nexport class ConfigurationModel {\n    constructor(_contents = {}, _keys = [], _overrides = []) {\n        this._contents = _contents;\n        this._keys = _keys;\n        this._overrides = _overrides;\n        this.frozen = false;\n        this.overrideConfigurations = new Map();\n    }\n    get contents() {\n        return this.checkAndFreeze(this._contents);\n    }\n    get overrides() {\n        return this.checkAndFreeze(this._overrides);\n    }\n    get keys() {\n        return this.checkAndFreeze(this._keys);\n    }\n    isEmpty() {\n        return this._keys.length === 0 && Object.keys(this._contents).length === 0 && this._overrides.length === 0;\n    }\n    getValue(section) {\n        return section ? getConfigurationValue(this.contents, section) : this.contents;\n    }\n    getOverrideValue(section, overrideIdentifier) {\n        const overrideContents = this.getContentsForOverrideIdentifer(overrideIdentifier);\n        return overrideContents\n            ? section ? getConfigurationValue(overrideContents, section) : overrideContents\n            : undefined;\n    }\n    override(identifier) {\n        let overrideConfigurationModel = this.overrideConfigurations.get(identifier);\n        if (!overrideConfigurationModel) {\n            overrideConfigurationModel = this.createOverrideConfigurationModel(identifier);\n            this.overrideConfigurations.set(identifier, overrideConfigurationModel);\n        }\n        return overrideConfigurationModel;\n    }\n    merge(...others) {\n        const contents = objects.deepClone(this.contents);\n        const overrides = objects.deepClone(this.overrides);\n        const keys = [...this.keys];\n        for (const other of others) {\n            if (other.isEmpty()) {\n                continue;\n            }\n            this.mergeContents(contents, other.contents);\n            for (const otherOverride of other.overrides) {\n                const [override] = overrides.filter(o => arrays.equals(o.identifiers, otherOverride.identifiers));\n                if (override) {\n                    this.mergeContents(override.contents, otherOverride.contents);\n                    override.keys.push(...otherOverride.keys);\n                    override.keys = arrays.distinct(override.keys);\n                }\n                else {\n                    overrides.push(objects.deepClone(otherOverride));\n                }\n            }\n            for (const key of other.keys) {\n                if (keys.indexOf(key) === -1) {\n                    keys.push(key);\n                }\n            }\n        }\n        return new ConfigurationModel(contents, keys, overrides);\n    }\n    freeze() {\n        this.frozen = true;\n        return this;\n    }\n    createOverrideConfigurationModel(identifier) {\n        const overrideContents = this.getContentsForOverrideIdentifer(identifier);\n        if (!overrideContents || typeof overrideContents !== 'object' || !Object.keys(overrideContents).length) {\n            // If there are no valid overrides, return self\n            return this;\n        }\n        const contents = {};\n        for (const key of arrays.distinct([...Object.keys(this.contents), ...Object.keys(overrideContents)])) {\n            let contentsForKey = this.contents[key];\n            const overrideContentsForKey = overrideContents[key];\n            // If there are override contents for the key, clone and merge otherwise use base contents\n            if (overrideContentsForKey) {\n                // Clone and merge only if base contents and override contents are of type object otherwise just override\n                if (typeof contentsForKey === 'object' && typeof overrideContentsForKey === 'object') {\n                    contentsForKey = objects.deepClone(contentsForKey);\n                    this.mergeContents(contentsForKey, overrideContentsForKey);\n                }\n                else {\n                    contentsForKey = overrideContentsForKey;\n                }\n            }\n            contents[key] = contentsForKey;\n        }\n        return new ConfigurationModel(contents, this.keys, this.overrides);\n    }\n    mergeContents(source, target) {\n        for (const key of Object.keys(target)) {\n            if (key in source) {\n                if (types.isObject(source[key]) && types.isObject(target[key])) {\n                    this.mergeContents(source[key], target[key]);\n                    continue;\n                }\n            }\n            source[key] = objects.deepClone(target[key]);\n        }\n    }\n    checkAndFreeze(data) {\n        if (this.frozen && !Object.isFrozen(data)) {\n            return objects.deepFreeze(data);\n        }\n        return data;\n    }\n    getContentsForOverrideIdentifer(identifier) {\n        let contentsForIdentifierOnly = null;\n        let contents = null;\n        const mergeContents = (contentsToMerge) => {\n            if (contentsToMerge) {\n                if (contents) {\n                    this.mergeContents(contents, contentsToMerge);\n                }\n                else {\n                    contents = objects.deepClone(contentsToMerge);\n                }\n            }\n        };\n        for (const override of this.overrides) {\n            if (arrays.equals(override.identifiers, [identifier])) {\n                contentsForIdentifierOnly = override.contents;\n            }\n            else if (override.identifiers.includes(identifier)) {\n                mergeContents(override.contents);\n            }\n        }\n        // Merge contents of the identifier only at the end to take precedence.\n        mergeContents(contentsForIdentifierOnly);\n        return contents;\n    }\n    toJSON() {\n        return {\n            contents: this.contents,\n            overrides: this.overrides,\n            keys: this.keys\n        };\n    }\n    // Update methods\n    setValue(key, value) {\n        this.addKey(key);\n        addToValueTree(this.contents, key, value, e => { throw new Error(e); });\n    }\n    removeValue(key) {\n        if (this.removeKey(key)) {\n            removeFromValueTree(this.contents, key);\n        }\n    }\n    addKey(key) {\n        let index = this.keys.length;\n        for (let i = 0; i < index; i++) {\n            if (key.indexOf(this.keys[i]) === 0) {\n                index = i;\n            }\n        }\n        this.keys.splice(index, 1, key);\n    }\n    removeKey(key) {\n        const index = this.keys.indexOf(key);\n        if (index !== -1) {\n            this.keys.splice(index, 1);\n            return true;\n        }\n        return false;\n    }\n}\nexport class Configuration {\n    constructor(_defaultConfiguration, _policyConfiguration, _applicationConfiguration, _localUserConfiguration, _remoteUserConfiguration = new ConfigurationModel(), _workspaceConfiguration = new ConfigurationModel(), _folderConfigurations = new ResourceMap(), _memoryConfiguration = new ConfigurationModel(), _memoryConfigurationByResource = new ResourceMap(), _freeze = true) {\n        this._defaultConfiguration = _defaultConfiguration;\n        this._policyConfiguration = _policyConfiguration;\n        this._applicationConfiguration = _applicationConfiguration;\n        this._localUserConfiguration = _localUserConfiguration;\n        this._remoteUserConfiguration = _remoteUserConfiguration;\n        this._workspaceConfiguration = _workspaceConfiguration;\n        this._folderConfigurations = _folderConfigurations;\n        this._memoryConfiguration = _memoryConfiguration;\n        this._memoryConfigurationByResource = _memoryConfigurationByResource;\n        this._freeze = _freeze;\n        this._workspaceConsolidatedConfiguration = null;\n        this._foldersConsolidatedConfigurations = new ResourceMap();\n        this._userConfiguration = null;\n    }\n    getValue(section, overrides, workspace) {\n        const consolidateConfigurationModel = this.getConsolidatedConfigurationModel(section, overrides, workspace);\n        return consolidateConfigurationModel.getValue(section);\n    }\n    updateValue(key, value, overrides = {}) {\n        let memoryConfiguration;\n        if (overrides.resource) {\n            memoryConfiguration = this._memoryConfigurationByResource.get(overrides.resource);\n            if (!memoryConfiguration) {\n                memoryConfiguration = new ConfigurationModel();\n                this._memoryConfigurationByResource.set(overrides.resource, memoryConfiguration);\n            }\n        }\n        else {\n            memoryConfiguration = this._memoryConfiguration;\n        }\n        if (value === undefined) {\n            memoryConfiguration.removeValue(key);\n        }\n        else {\n            memoryConfiguration.setValue(key, value);\n        }\n        if (!overrides.resource) {\n            this._workspaceConsolidatedConfiguration = null;\n        }\n    }\n    inspect(key, overrides, workspace) {\n        const consolidateConfigurationModel = this.getConsolidatedConfigurationModel(key, overrides, workspace);\n        const folderConfigurationModel = this.getFolderConfigurationModelForResource(overrides.resource, workspace);\n        const memoryConfigurationModel = overrides.resource ? this._memoryConfigurationByResource.get(overrides.resource) || this._memoryConfiguration : this._memoryConfiguration;\n        const defaultValue = overrides.overrideIdentifier ? this._defaultConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key) : this._defaultConfiguration.freeze().getValue(key);\n        const policyValue = this._policyConfiguration.isEmpty() ? undefined : this._policyConfiguration.freeze().getValue(key);\n        const applicationValue = this.applicationConfiguration.isEmpty() ? undefined : this.applicationConfiguration.freeze().getValue(key);\n        const userValue = overrides.overrideIdentifier ? this.userConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key) : this.userConfiguration.freeze().getValue(key);\n        const userLocalValue = overrides.overrideIdentifier ? this.localUserConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key) : this.localUserConfiguration.freeze().getValue(key);\n        const userRemoteValue = overrides.overrideIdentifier ? this.remoteUserConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key) : this.remoteUserConfiguration.freeze().getValue(key);\n        const workspaceValue = workspace ? overrides.overrideIdentifier ? this._workspaceConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key) : this._workspaceConfiguration.freeze().getValue(key) : undefined; //Check on workspace exists or not because _workspaceConfiguration is never null\n        const workspaceFolderValue = folderConfigurationModel ? overrides.overrideIdentifier ? folderConfigurationModel.freeze().override(overrides.overrideIdentifier).getValue(key) : folderConfigurationModel.freeze().getValue(key) : undefined;\n        const memoryValue = overrides.overrideIdentifier ? memoryConfigurationModel.override(overrides.overrideIdentifier).getValue(key) : memoryConfigurationModel.getValue(key);\n        const value = consolidateConfigurationModel.getValue(key);\n        const overrideIdentifiers = arrays.distinct(consolidateConfigurationModel.overrides.map(override => override.identifiers).flat()).filter(overrideIdentifier => consolidateConfigurationModel.getOverrideValue(key, overrideIdentifier) !== undefined);\n        return {\n            defaultValue,\n            policyValue,\n            applicationValue,\n            userValue,\n            userLocalValue,\n            userRemoteValue,\n            workspaceValue,\n            workspaceFolderValue,\n            memoryValue,\n            value,\n            default: defaultValue !== undefined ? { value: this._defaultConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this._defaultConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            policy: policyValue !== undefined ? { value: policyValue } : undefined,\n            application: applicationValue !== undefined ? { value: applicationValue, override: overrides.overrideIdentifier ? this.applicationConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            user: userValue !== undefined ? { value: this.userConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this.userConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            userLocal: userLocalValue !== undefined ? { value: this.localUserConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this.localUserConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            userRemote: userRemoteValue !== undefined ? { value: this.remoteUserConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this.remoteUserConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            workspace: workspaceValue !== undefined ? { value: this._workspaceConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this._workspaceConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            workspaceFolder: workspaceFolderValue !== undefined ? { value: folderConfigurationModel === null || folderConfigurationModel === void 0 ? void 0 : folderConfigurationModel.freeze().getValue(key), override: overrides.overrideIdentifier ? folderConfigurationModel === null || folderConfigurationModel === void 0 ? void 0 : folderConfigurationModel.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            memory: memoryValue !== undefined ? { value: memoryConfigurationModel.getValue(key), override: overrides.overrideIdentifier ? memoryConfigurationModel.getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n            overrideIdentifiers: overrideIdentifiers.length ? overrideIdentifiers : undefined\n        };\n    }\n    get applicationConfiguration() {\n        return this._applicationConfiguration;\n    }\n    get userConfiguration() {\n        if (!this._userConfiguration) {\n            this._userConfiguration = this._remoteUserConfiguration.isEmpty() ? this._localUserConfiguration : this._localUserConfiguration.merge(this._remoteUserConfiguration);\n            if (this._freeze) {\n                this._userConfiguration.freeze();\n            }\n        }\n        return this._userConfiguration;\n    }\n    get localUserConfiguration() {\n        return this._localUserConfiguration;\n    }\n    get remoteUserConfiguration() {\n        return this._remoteUserConfiguration;\n    }\n    getConsolidatedConfigurationModel(section, overrides, workspace) {\n        let configurationModel = this.getConsolidatedConfigurationModelForResource(overrides, workspace);\n        if (overrides.overrideIdentifier) {\n            configurationModel = configurationModel.override(overrides.overrideIdentifier);\n        }\n        if (!this._policyConfiguration.isEmpty() && this._policyConfiguration.getValue(section) !== undefined) {\n            configurationModel = configurationModel.merge(this._policyConfiguration);\n        }\n        return configurationModel;\n    }\n    getConsolidatedConfigurationModelForResource({ resource }, workspace) {\n        let consolidateConfiguration = this.getWorkspaceConsolidatedConfiguration();\n        if (workspace && resource) {\n            const root = workspace.getFolder(resource);\n            if (root) {\n                consolidateConfiguration = this.getFolderConsolidatedConfiguration(root.uri) || consolidateConfiguration;\n            }\n            const memoryConfigurationForResource = this._memoryConfigurationByResource.get(resource);\n            if (memoryConfigurationForResource) {\n                consolidateConfiguration = consolidateConfiguration.merge(memoryConfigurationForResource);\n            }\n        }\n        return consolidateConfiguration;\n    }\n    getWorkspaceConsolidatedConfiguration() {\n        if (!this._workspaceConsolidatedConfiguration) {\n            this._workspaceConsolidatedConfiguration = this._defaultConfiguration.merge(this.applicationConfiguration, this.userConfiguration, this._workspaceConfiguration, this._memoryConfiguration);\n            if (this._freeze) {\n                this._workspaceConfiguration = this._workspaceConfiguration.freeze();\n            }\n        }\n        return this._workspaceConsolidatedConfiguration;\n    }\n    getFolderConsolidatedConfiguration(folder) {\n        let folderConsolidatedConfiguration = this._foldersConsolidatedConfigurations.get(folder);\n        if (!folderConsolidatedConfiguration) {\n            const workspaceConsolidateConfiguration = this.getWorkspaceConsolidatedConfiguration();\n            const folderConfiguration = this._folderConfigurations.get(folder);\n            if (folderConfiguration) {\n                folderConsolidatedConfiguration = workspaceConsolidateConfiguration.merge(folderConfiguration);\n                if (this._freeze) {\n                    folderConsolidatedConfiguration = folderConsolidatedConfiguration.freeze();\n                }\n                this._foldersConsolidatedConfigurations.set(folder, folderConsolidatedConfiguration);\n            }\n            else {\n                folderConsolidatedConfiguration = workspaceConsolidateConfiguration;\n            }\n        }\n        return folderConsolidatedConfiguration;\n    }\n    getFolderConfigurationModelForResource(resource, workspace) {\n        if (workspace && resource) {\n            const root = workspace.getFolder(resource);\n            if (root) {\n                return this._folderConfigurations.get(root.uri);\n            }\n        }\n        return undefined;\n    }\n    toData() {\n        return {\n            defaults: {\n                contents: this._defaultConfiguration.contents,\n                overrides: this._defaultConfiguration.overrides,\n                keys: this._defaultConfiguration.keys\n            },\n            policy: {\n                contents: this._policyConfiguration.contents,\n                overrides: this._policyConfiguration.overrides,\n                keys: this._policyConfiguration.keys\n            },\n            application: {\n                contents: this.applicationConfiguration.contents,\n                overrides: this.applicationConfiguration.overrides,\n                keys: this.applicationConfiguration.keys\n            },\n            user: {\n                contents: this.userConfiguration.contents,\n                overrides: this.userConfiguration.overrides,\n                keys: this.userConfiguration.keys\n            },\n            workspace: {\n                contents: this._workspaceConfiguration.contents,\n                overrides: this._workspaceConfiguration.overrides,\n                keys: this._workspaceConfiguration.keys\n            },\n            folders: [...this._folderConfigurations.keys()].reduce((result, folder) => {\n                const { contents, overrides, keys } = this._folderConfigurations.get(folder);\n                result.push([folder, { contents, overrides, keys }]);\n                return result;\n            }, [])\n        };\n    }\n    static parse(data) {\n        const defaultConfiguration = this.parseConfigurationModel(data.defaults);\n        const policyConfiguration = this.parseConfigurationModel(data.policy);\n        const applicationConfiguration = this.parseConfigurationModel(data.application);\n        const userConfiguration = this.parseConfigurationModel(data.user);\n        const workspaceConfiguration = this.parseConfigurationModel(data.workspace);\n        const folders = data.folders.reduce((result, value) => {\n            result.set(URI.revive(value[0]), this.parseConfigurationModel(value[1]));\n            return result;\n        }, new ResourceMap());\n        return new Configuration(defaultConfiguration, policyConfiguration, applicationConfiguration, userConfiguration, new ConfigurationModel(), workspaceConfiguration, folders, new ConfigurationModel(), new ResourceMap(), false);\n    }\n    static parseConfigurationModel(model) {\n        return new ConfigurationModel(model.contents, model.keys, model.overrides).freeze();\n    }\n}\nexport class ConfigurationChangeEvent {\n    constructor(change, previous, currentConfiguraiton, currentWorkspace) {\n        this.change = change;\n        this.previous = previous;\n        this.currentConfiguraiton = currentConfiguraiton;\n        this.currentWorkspace = currentWorkspace;\n        this._previousConfiguration = undefined;\n        const keysSet = new Set();\n        change.keys.forEach(key => keysSet.add(key));\n        change.overrides.forEach(([, keys]) => keys.forEach(key => keysSet.add(key)));\n        this.affectedKeys = [...keysSet.values()];\n        const configurationModel = new ConfigurationModel();\n        this.affectedKeys.forEach(key => configurationModel.setValue(key, {}));\n        this.affectedKeysTree = configurationModel.contents;\n    }\n    get previousConfiguration() {\n        if (!this._previousConfiguration && this.previous) {\n            this._previousConfiguration = Configuration.parse(this.previous.data);\n        }\n        return this._previousConfiguration;\n    }\n    affectsConfiguration(section, overrides) {\n        var _a;\n        if (this.doesAffectedKeysTreeContains(this.affectedKeysTree, section)) {\n            if (overrides) {\n                const value1 = this.previousConfiguration ? this.previousConfiguration.getValue(section, overrides, (_a = this.previous) === null || _a === void 0 ? void 0 : _a.workspace) : undefined;\n                const value2 = this.currentConfiguraiton.getValue(section, overrides, this.currentWorkspace);\n                return !objects.equals(value1, value2);\n            }\n            return true;\n        }\n        return false;\n    }\n    doesAffectedKeysTreeContains(affectedKeysTree, section) {\n        let requestedTree = toValuesTree({ [section]: true }, () => { });\n        let key;\n        while (typeof requestedTree === 'object' && (key = Object.keys(requestedTree)[0])) { // Only one key should present, since we added only one property\n            affectedKeysTree = affectedKeysTree[key];\n            if (!affectedKeysTree) {\n                return false; // Requested tree is not found\n            }\n            requestedTree = requestedTree[key];\n        }\n        return true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IntervalTimer, TimeoutTimer } from '../../../base/common/async.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as nls from '../../../nls.js';\nconst HIGH_FREQ_COMMANDS = /^(cursor|delete)/;\nexport class AbstractKeybindingService extends Disposable {\n    constructor(_contextKeyService, _commandService, _telemetryService, _notificationService, _logService) {\n        super();\n        this._contextKeyService = _contextKeyService;\n        this._commandService = _commandService;\n        this._telemetryService = _telemetryService;\n        this._notificationService = _notificationService;\n        this._logService = _logService;\n        this._onDidUpdateKeybindings = this._register(new Emitter());\n        this._currentChord = null;\n        this._currentChordChecker = new IntervalTimer();\n        this._currentChordStatusMessage = null;\n        this._ignoreSingleModifiers = KeybindingModifierSet.EMPTY;\n        this._currentSingleModifier = null;\n        this._currentSingleModifierClearTimeout = new TimeoutTimer();\n        this._logging = false;\n    }\n    get onDidUpdateKeybindings() {\n        return this._onDidUpdateKeybindings ? this._onDidUpdateKeybindings.event : Event.None; // Sinon stubbing walks properties on prototype\n    }\n    dispose() {\n        super.dispose();\n    }\n    _log(str) {\n        if (this._logging) {\n            this._logService.info(`[KeybindingService]: ${str}`);\n        }\n    }\n    getKeybindings() {\n        return this._getResolver().getKeybindings();\n    }\n    lookupKeybinding(commandId, context) {\n        const result = this._getResolver().lookupPrimaryKeybinding(commandId, context || this._contextKeyService);\n        if (!result) {\n            return undefined;\n        }\n        return result.resolvedKeybinding;\n    }\n    dispatchEvent(e, target) {\n        return this._dispatch(e, target);\n    }\n    softDispatch(e, target) {\n        this._log(`/ Soft dispatching keyboard event`);\n        const keybinding = this.resolveKeyboardEvent(e);\n        if (keybinding.isChord()) {\n            console.warn('Unexpected keyboard event mapped to a chord');\n            return null;\n        }\n        const [firstPart,] = keybinding.getDispatchParts();\n        if (firstPart === null) {\n            // cannot be dispatched, probably only modifier keys\n            this._log(`\\\\ Keyboard event cannot be dispatched`);\n            return null;\n        }\n        const contextValue = this._contextKeyService.getContext(target);\n        const currentChord = this._currentChord ? this._currentChord.keypress : null;\n        return this._getResolver().resolve(contextValue, currentChord, firstPart);\n    }\n    _enterChordMode(firstPart, keypressLabel) {\n        this._currentChord = {\n            keypress: firstPart,\n            label: keypressLabel\n        };\n        this._currentChordStatusMessage = this._notificationService.status(nls.localize('first.chord', \"({0}) was pressed. Waiting for second key of chord...\", keypressLabel));\n        const chordEnterTime = Date.now();\n        this._currentChordChecker.cancelAndSet(() => {\n            if (!this._documentHasFocus()) {\n                // Focus has been lost => leave chord mode\n                this._leaveChordMode();\n                return;\n            }\n            if (Date.now() - chordEnterTime > 5000) {\n                // 5 seconds elapsed => leave chord mode\n                this._leaveChordMode();\n            }\n        }, 500);\n    }\n    _leaveChordMode() {\n        if (this._currentChordStatusMessage) {\n            this._currentChordStatusMessage.dispose();\n            this._currentChordStatusMessage = null;\n        }\n        this._currentChordChecker.cancel();\n        this._currentChord = null;\n    }\n    _dispatch(e, target) {\n        return this._doDispatch(this.resolveKeyboardEvent(e), target, /*isSingleModiferChord*/ false);\n    }\n    _singleModifierDispatch(e, target) {\n        const keybinding = this.resolveKeyboardEvent(e);\n        const [singleModifier,] = keybinding.getSingleModifierDispatchParts();\n        if (singleModifier) {\n            if (this._ignoreSingleModifiers.has(singleModifier)) {\n                this._log(`+ Ignoring single modifier ${singleModifier} due to it being pressed together with other keys.`);\n                this._ignoreSingleModifiers = KeybindingModifierSet.EMPTY;\n                this._currentSingleModifierClearTimeout.cancel();\n                this._currentSingleModifier = null;\n                return false;\n            }\n            this._ignoreSingleModifiers = KeybindingModifierSet.EMPTY;\n            if (this._currentSingleModifier === null) {\n                // we have a valid `singleModifier`, store it for the next keyup, but clear it in 300ms\n                this._log(`+ Storing single modifier for possible chord ${singleModifier}.`);\n                this._currentSingleModifier = singleModifier;\n                this._currentSingleModifierClearTimeout.cancelAndSet(() => {\n                    this._log(`+ Clearing single modifier due to 300ms elapsed.`);\n                    this._currentSingleModifier = null;\n                }, 300);\n                return false;\n            }\n            if (singleModifier === this._currentSingleModifier) {\n                // bingo!\n                this._log(`/ Dispatching single modifier chord ${singleModifier} ${singleModifier}`);\n                this._currentSingleModifierClearTimeout.cancel();\n                this._currentSingleModifier = null;\n                return this._doDispatch(keybinding, target, /*isSingleModiferChord*/ true);\n            }\n            this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${singleModifier}`);\n            this._currentSingleModifierClearTimeout.cancel();\n            this._currentSingleModifier = null;\n            return false;\n        }\n        // When pressing a modifier and holding it pressed with any other modifier or key combination,\n        // the pressed modifiers should no longer be considered for single modifier dispatch.\n        const [firstPart,] = keybinding.getParts();\n        this._ignoreSingleModifiers = new KeybindingModifierSet(firstPart);\n        if (this._currentSingleModifier !== null) {\n            this._log(`+ Clearing single modifier due to other key up.`);\n        }\n        this._currentSingleModifierClearTimeout.cancel();\n        this._currentSingleModifier = null;\n        return false;\n    }\n    _doDispatch(keybinding, target, isSingleModiferChord = false) {\n        let shouldPreventDefault = false;\n        if (keybinding.isChord()) {\n            console.warn('Unexpected keyboard event mapped to a chord');\n            return false;\n        }\n        let firstPart = null; // the first keybinding i.e. Ctrl+K\n        let currentChord = null; // the \"second\" keybinding i.e. Ctrl+K \"Ctrl+D\"\n        if (isSingleModiferChord) {\n            const [dispatchKeyname,] = keybinding.getSingleModifierDispatchParts();\n            firstPart = dispatchKeyname;\n            currentChord = dispatchKeyname;\n        }\n        else {\n            [firstPart,] = keybinding.getDispatchParts();\n            currentChord = this._currentChord ? this._currentChord.keypress : null;\n        }\n        if (firstPart === null) {\n            this._log(`\\\\ Keyboard event cannot be dispatched in keydown phase.`);\n            // cannot be dispatched, probably only modifier keys\n            return shouldPreventDefault;\n        }\n        const contextValue = this._contextKeyService.getContext(target);\n        const keypressLabel = keybinding.getLabel();\n        const resolveResult = this._getResolver().resolve(contextValue, currentChord, firstPart);\n        this._logService.trace('KeybindingService#dispatch', keypressLabel, resolveResult === null || resolveResult === void 0 ? void 0 : resolveResult.commandId);\n        if (resolveResult && resolveResult.enterChord) {\n            shouldPreventDefault = true;\n            this._enterChordMode(firstPart, keypressLabel);\n            this._log(`+ Entering chord mode...`);\n            return shouldPreventDefault;\n        }\n        if (this._currentChord) {\n            if (!resolveResult || !resolveResult.commandId) {\n                this._log(`+ Leaving chord mode: Nothing bound to \"${this._currentChord.label} ${keypressLabel}\".`);\n                this._notificationService.status(nls.localize('missing.chord', \"The key combination ({0}, {1}) is not a command.\", this._currentChord.label, keypressLabel), { hideAfter: 10 * 1000 /* 10s */ });\n                shouldPreventDefault = true;\n            }\n        }\n        this._leaveChordMode();\n        if (resolveResult && resolveResult.commandId) {\n            if (!resolveResult.bubble) {\n                shouldPreventDefault = true;\n            }\n            this._log(`+ Invoking command ${resolveResult.commandId}.`);\n            if (typeof resolveResult.commandArgs === 'undefined') {\n                this._commandService.executeCommand(resolveResult.commandId).then(undefined, err => this._notificationService.warn(err));\n            }\n            else {\n                this._commandService.executeCommand(resolveResult.commandId, resolveResult.commandArgs).then(undefined, err => this._notificationService.warn(err));\n            }\n            if (!HIGH_FREQ_COMMANDS.test(resolveResult.commandId)) {\n                this._telemetryService.publicLog2('workbenchActionExecuted', { id: resolveResult.commandId, from: 'keybinding' });\n            }\n        }\n        return shouldPreventDefault;\n    }\n    mightProducePrintableCharacter(event) {\n        if (event.ctrlKey || event.metaKey) {\n            // ignore ctrl/cmd-combination but not shift/alt-combinatios\n            return false;\n        }\n        // weak check for certain ranges. this is properly implemented in a subclass\n        // with access to the KeyboardMapperFactory.\n        if ((event.keyCode >= 31 /* KeyCode.KeyA */ && event.keyCode <= 56 /* KeyCode.KeyZ */)\n            || (event.keyCode >= 21 /* KeyCode.Digit0 */ && event.keyCode <= 30 /* KeyCode.Digit9 */)) {\n            return true;\n        }\n        return false;\n    }\n}\nclass KeybindingModifierSet {\n    constructor(source) {\n        this._ctrlKey = source ? source.ctrlKey : false;\n        this._shiftKey = source ? source.shiftKey : false;\n        this._altKey = source ? source.altKey : false;\n        this._metaKey = source ? source.metaKey : false;\n    }\n    has(modifier) {\n        switch (modifier) {\n            case 'ctrl': return this._ctrlKey;\n            case 'shift': return this._shiftKey;\n            case 'alt': return this._altKey;\n            case 'meta': return this._metaKey;\n        }\n    }\n}\nKeybindingModifierSet.EMPTY = new KeybindingModifierSet(null);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { implies, expressionsAreEqualWithConstantSubstitution } from '../../contextkey/common/contextkey.js';\nexport class KeybindingResolver {\n    constructor(defaultKeybindings, overrides, log) {\n        this._log = log;\n        this._defaultKeybindings = defaultKeybindings;\n        this._defaultBoundCommands = new Map();\n        for (const defaultKeybinding of defaultKeybindings) {\n            const command = defaultKeybinding.command;\n            if (command && command.charAt(0) !== '-') {\n                this._defaultBoundCommands.set(command, true);\n            }\n        }\n        this._map = new Map();\n        this._lookupMap = new Map();\n        this._keybindings = KeybindingResolver.handleRemovals([].concat(defaultKeybindings).concat(overrides));\n        for (let i = 0, len = this._keybindings.length; i < len; i++) {\n            const k = this._keybindings[i];\n            if (k.keypressParts.length === 0) {\n                // unbound\n                continue;\n            }\n            if (k.when && k.when.type === 0 /* ContextKeyExprType.False */) {\n                // when condition is false\n                continue;\n            }\n            // TODO@chords\n            this._addKeyPress(k.keypressParts[0], k);\n        }\n    }\n    static _isTargetedForRemoval(defaultKb, keypressFirstPart, keypressChordPart, when) {\n        // TODO@chords\n        if (keypressFirstPart && defaultKb.keypressParts[0] !== keypressFirstPart) {\n            return false;\n        }\n        // TODO@chords\n        if (keypressChordPart && defaultKb.keypressParts[1] !== keypressChordPart) {\n            return false;\n        }\n        if (when) {\n            if (!defaultKb.when) {\n                return false;\n            }\n            if (!expressionsAreEqualWithConstantSubstitution(when, defaultKb.when)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Looks for rules containing \"-commandId\" and removes them.\n     */\n    static handleRemovals(rules) {\n        // Do a first pass and construct a hash-map for removals\n        const removals = new Map();\n        for (let i = 0, len = rules.length; i < len; i++) {\n            const rule = rules[i];\n            if (rule.command && rule.command.charAt(0) === '-') {\n                const command = rule.command.substring(1);\n                if (!removals.has(command)) {\n                    removals.set(command, [rule]);\n                }\n                else {\n                    removals.get(command).push(rule);\n                }\n            }\n        }\n        if (removals.size === 0) {\n            // There are no removals\n            return rules;\n        }\n        // Do a second pass and keep only non-removed keybindings\n        const result = [];\n        for (let i = 0, len = rules.length; i < len; i++) {\n            const rule = rules[i];\n            if (!rule.command || rule.command.length === 0) {\n                result.push(rule);\n                continue;\n            }\n            if (rule.command.charAt(0) === '-') {\n                continue;\n            }\n            const commandRemovals = removals.get(rule.command);\n            if (!commandRemovals || !rule.isDefault) {\n                result.push(rule);\n                continue;\n            }\n            let isRemoved = false;\n            for (const commandRemoval of commandRemovals) {\n                // TODO@chords\n                const keypressFirstPart = commandRemoval.keypressParts[0];\n                const keypressChordPart = commandRemoval.keypressParts[1];\n                const when = commandRemoval.when;\n                if (this._isTargetedForRemoval(rule, keypressFirstPart, keypressChordPart, when)) {\n                    isRemoved = true;\n                    break;\n                }\n            }\n            if (!isRemoved) {\n                result.push(rule);\n                continue;\n            }\n        }\n        return result;\n    }\n    _addKeyPress(keypress, item) {\n        const conflicts = this._map.get(keypress);\n        if (typeof conflicts === 'undefined') {\n            // There is no conflict so far\n            this._map.set(keypress, [item]);\n            this._addToLookupMap(item);\n            return;\n        }\n        for (let i = conflicts.length - 1; i >= 0; i--) {\n            const conflict = conflicts[i];\n            if (conflict.command === item.command) {\n                continue;\n            }\n            const conflictIsChord = (conflict.keypressParts.length > 1);\n            const itemIsChord = (item.keypressParts.length > 1);\n            // TODO@chords\n            if (conflictIsChord && itemIsChord && conflict.keypressParts[1] !== item.keypressParts[1]) {\n                // The conflict only shares the chord start with this command\n                continue;\n            }\n            if (KeybindingResolver.whenIsEntirelyIncluded(conflict.when, item.when)) {\n                // `item` completely overwrites `conflict`\n                // Remove conflict from the lookupMap\n                this._removeFromLookupMap(conflict);\n            }\n        }\n        conflicts.push(item);\n        this._addToLookupMap(item);\n    }\n    _addToLookupMap(item) {\n        if (!item.command) {\n            return;\n        }\n        let arr = this._lookupMap.get(item.command);\n        if (typeof arr === 'undefined') {\n            arr = [item];\n            this._lookupMap.set(item.command, arr);\n        }\n        else {\n            arr.push(item);\n        }\n    }\n    _removeFromLookupMap(item) {\n        if (!item.command) {\n            return;\n        }\n        const arr = this._lookupMap.get(item.command);\n        if (typeof arr === 'undefined') {\n            return;\n        }\n        for (let i = 0, len = arr.length; i < len; i++) {\n            if (arr[i] === item) {\n                arr.splice(i, 1);\n                return;\n            }\n        }\n    }\n    /**\n     * Returns true if it is provable `a` implies `b`.\n     */\n    static whenIsEntirelyIncluded(a, b) {\n        if (!b || b.type === 1 /* ContextKeyExprType.True */) {\n            return true;\n        }\n        if (!a || a.type === 1 /* ContextKeyExprType.True */) {\n            return false;\n        }\n        return implies(a, b);\n    }\n    getKeybindings() {\n        return this._keybindings;\n    }\n    lookupPrimaryKeybinding(commandId, context) {\n        const items = this._lookupMap.get(commandId);\n        if (typeof items === 'undefined' || items.length === 0) {\n            return null;\n        }\n        if (items.length === 1) {\n            return items[0];\n        }\n        for (let i = items.length - 1; i >= 0; i--) {\n            const item = items[i];\n            if (context.contextMatchesRules(item.when)) {\n                return item;\n            }\n        }\n        return items[items.length - 1];\n    }\n    resolve(context, currentChord, keypress) {\n        this._log(`| Resolving ${keypress}${currentChord ? ` chorded from ${currentChord}` : ``}`);\n        let lookupMap = null;\n        if (currentChord !== null) {\n            // Fetch all chord bindings for `currentChord`\n            const candidates = this._map.get(currentChord);\n            if (typeof candidates === 'undefined') {\n                // No chords starting with `currentChord`\n                this._log(`\\\\ No keybinding entries.`);\n                return null;\n            }\n            lookupMap = [];\n            for (let i = 0, len = candidates.length; i < len; i++) {\n                const candidate = candidates[i];\n                // TODO@chords\n                if (candidate.keypressParts[1] === keypress) {\n                    lookupMap.push(candidate);\n                }\n            }\n        }\n        else {\n            const candidates = this._map.get(keypress);\n            if (typeof candidates === 'undefined') {\n                // No bindings with `keypress`\n                this._log(`\\\\ No keybinding entries.`);\n                return null;\n            }\n            lookupMap = candidates;\n        }\n        const result = this._findCommand(context, lookupMap);\n        if (!result) {\n            this._log(`\\\\ From ${lookupMap.length} keybinding entries, no when clauses matched the context.`);\n            return null;\n        }\n        // TODO@chords\n        if (currentChord === null && result.keypressParts.length > 1 && result.keypressParts[1] !== null) {\n            this._log(`\\\\ From ${lookupMap.length} keybinding entries, matched chord, when: ${printWhenExplanation(result.when)}, source: ${printSourceExplanation(result)}.`);\n            return {\n                enterChord: true,\n                leaveChord: false,\n                commandId: null,\n                commandArgs: null,\n                bubble: false\n            };\n        }\n        this._log(`\\\\ From ${lookupMap.length} keybinding entries, matched ${result.command}, when: ${printWhenExplanation(result.when)}, source: ${printSourceExplanation(result)}.`);\n        return {\n            enterChord: false,\n            leaveChord: result.keypressParts.length > 1,\n            commandId: result.command,\n            commandArgs: result.commandArgs,\n            bubble: result.bubble\n        };\n    }\n    _findCommand(context, matches) {\n        for (let i = matches.length - 1; i >= 0; i--) {\n            const k = matches[i];\n            if (!KeybindingResolver._contextMatchesRules(context, k.when)) {\n                continue;\n            }\n            return k;\n        }\n        return null;\n    }\n    static _contextMatchesRules(context, rules) {\n        if (!rules) {\n            return true;\n        }\n        return rules.evaluate(context);\n    }\n}\nfunction printWhenExplanation(when) {\n    if (!when) {\n        return `no when condition`;\n    }\n    return `${when.serialize()}`;\n}\nfunction printSourceExplanation(kb) {\n    return (kb.extensionId\n        ? (kb.isBuiltinExtension ? `built-in extension ${kb.extensionId}` : `user extension ${kb.extensionId}`)\n        : (kb.isDefault ? `built-in` : `user`));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class ResolvedKeybindingItem {\n    constructor(resolvedKeybinding, command, commandArgs, when, isDefault, extensionId, isBuiltinExtension) {\n        this._resolvedKeybindingItemBrand = undefined;\n        this.resolvedKeybinding = resolvedKeybinding;\n        this.keypressParts = resolvedKeybinding ? removeElementsAfterNulls(resolvedKeybinding.getDispatchParts()) : [];\n        if (resolvedKeybinding && this.keypressParts.length === 0) {\n            // handle possible single modifier chord keybindings\n            this.keypressParts = removeElementsAfterNulls(resolvedKeybinding.getSingleModifierDispatchParts());\n        }\n        this.bubble = (command ? command.charCodeAt(0) === 94 /* CharCode.Caret */ : false);\n        this.command = this.bubble ? command.substr(1) : command;\n        this.commandArgs = commandArgs;\n        this.when = when;\n        this.isDefault = isDefault;\n        this.extensionId = extensionId;\n        this.isBuiltinExtension = isBuiltinExtension;\n    }\n}\nexport function removeElementsAfterNulls(arr) {\n    const result = [];\n    for (let i = 0, len = arr.length; i < len; i++) {\n        const element = arr[i];\n        if (!element) {\n            // stop processing at first encountered null\n            return result;\n        }\n        result.push(element);\n    }\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { illegalArgument } from '../../../base/common/errors.js';\nimport { AriaLabelProvider, ElectronAcceleratorLabelProvider, UILabelProvider } from '../../../base/common/keybindingLabels.js';\nimport { ResolvedKeybinding, ResolvedKeybindingPart } from '../../../base/common/keybindings.js';\nexport class BaseResolvedKeybinding extends ResolvedKeybinding {\n    constructor(os, parts) {\n        super();\n        if (parts.length === 0) {\n            throw illegalArgument(`parts`);\n        }\n        this._os = os;\n        this._parts = parts;\n    }\n    getLabel() {\n        return UILabelProvider.toLabel(this._os, this._parts, (keybinding) => this._getLabel(keybinding));\n    }\n    getAriaLabel() {\n        return AriaLabelProvider.toLabel(this._os, this._parts, (keybinding) => this._getAriaLabel(keybinding));\n    }\n    getElectronAccelerator() {\n        if (this._parts.length > 1) {\n            // [Electron Accelerators] Electron cannot handle chords\n            return null;\n        }\n        if (this._parts[0].isDuplicateModifierCase()) {\n            // [Electron Accelerators] Electron cannot handle modifier only keybindings\n            // e.g. \"shift shift\"\n            return null;\n        }\n        return ElectronAcceleratorLabelProvider.toLabel(this._os, this._parts, (keybinding) => this._getElectronAccelerator(keybinding));\n    }\n    isChord() {\n        return (this._parts.length > 1);\n    }\n    getParts() {\n        return this._parts.map((keybinding) => this._getPart(keybinding));\n    }\n    _getPart(keybinding) {\n        return new ResolvedKeybindingPart(keybinding.ctrlKey, keybinding.shiftKey, keybinding.altKey, keybinding.metaKey, this._getLabel(keybinding), this._getAriaLabel(keybinding));\n    }\n    getDispatchParts() {\n        return this._parts.map((keybinding) => this._getDispatchPart(keybinding));\n    }\n    getSingleModifierDispatchParts() {\n        return this._parts.map((keybinding) => this._getSingleModifierDispatchPart(keybinding));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyCodeUtils, IMMUTABLE_CODE_TO_KEY_CODE } from '../../../base/common/keyCodes.js';\nimport { ChordKeybinding, SimpleKeybinding } from '../../../base/common/keybindings.js';\nimport { BaseResolvedKeybinding } from './baseResolvedKeybinding.js';\nimport { removeElementsAfterNulls } from './resolvedKeybindingItem.js';\n/**\n * Do not instantiate. Use KeybindingService to get a ResolvedKeybinding seeded with information about the current kb layout.\n */\nexport class USLayoutResolvedKeybinding extends BaseResolvedKeybinding {\n    constructor(actual, os) {\n        super(os, actual.parts);\n    }\n    _keyCodeToUILabel(keyCode) {\n        if (this._os === 2 /* OperatingSystem.Macintosh */) {\n            switch (keyCode) {\n                case 15 /* KeyCode.LeftArrow */:\n                    return '←';\n                case 16 /* KeyCode.UpArrow */:\n                    return '↑';\n                case 17 /* KeyCode.RightArrow */:\n                    return '→';\n                case 18 /* KeyCode.DownArrow */:\n                    return '↓';\n            }\n        }\n        return KeyCodeUtils.toString(keyCode);\n    }\n    _getLabel(keybinding) {\n        if (keybinding.isDuplicateModifierCase()) {\n            return '';\n        }\n        return this._keyCodeToUILabel(keybinding.keyCode);\n    }\n    _getAriaLabel(keybinding) {\n        if (keybinding.isDuplicateModifierCase()) {\n            return '';\n        }\n        return KeyCodeUtils.toString(keybinding.keyCode);\n    }\n    _getElectronAccelerator(keybinding) {\n        return KeyCodeUtils.toElectronAccelerator(keybinding.keyCode);\n    }\n    _getDispatchPart(keybinding) {\n        return USLayoutResolvedKeybinding.getDispatchStr(keybinding);\n    }\n    static getDispatchStr(keybinding) {\n        if (keybinding.isModifierKey()) {\n            return null;\n        }\n        let result = '';\n        if (keybinding.ctrlKey) {\n            result += 'ctrl+';\n        }\n        if (keybinding.shiftKey) {\n            result += 'shift+';\n        }\n        if (keybinding.altKey) {\n            result += 'alt+';\n        }\n        if (keybinding.metaKey) {\n            result += 'meta+';\n        }\n        result += KeyCodeUtils.toString(keybinding.keyCode);\n        return result;\n    }\n    _getSingleModifierDispatchPart(keybinding) {\n        if (keybinding.keyCode === 5 /* KeyCode.Ctrl */ && !keybinding.shiftKey && !keybinding.altKey && !keybinding.metaKey) {\n            return 'ctrl';\n        }\n        if (keybinding.keyCode === 4 /* KeyCode.Shift */ && !keybinding.ctrlKey && !keybinding.altKey && !keybinding.metaKey) {\n            return 'shift';\n        }\n        if (keybinding.keyCode === 6 /* KeyCode.Alt */ && !keybinding.ctrlKey && !keybinding.shiftKey && !keybinding.metaKey) {\n            return 'alt';\n        }\n        if (keybinding.keyCode === 57 /* KeyCode.Meta */ && !keybinding.ctrlKey && !keybinding.shiftKey && !keybinding.altKey) {\n            return 'meta';\n        }\n        return null;\n    }\n    /**\n     * *NOTE*: Check return value for `KeyCode.Unknown`.\n     */\n    static _scanCodeToKeyCode(scanCode) {\n        const immutableKeyCode = IMMUTABLE_CODE_TO_KEY_CODE[scanCode];\n        if (immutableKeyCode !== -1 /* KeyCode.DependsOnKbLayout */) {\n            return immutableKeyCode;\n        }\n        switch (scanCode) {\n            case 10 /* ScanCode.KeyA */: return 31 /* KeyCode.KeyA */;\n            case 11 /* ScanCode.KeyB */: return 32 /* KeyCode.KeyB */;\n            case 12 /* ScanCode.KeyC */: return 33 /* KeyCode.KeyC */;\n            case 13 /* ScanCode.KeyD */: return 34 /* KeyCode.KeyD */;\n            case 14 /* ScanCode.KeyE */: return 35 /* KeyCode.KeyE */;\n            case 15 /* ScanCode.KeyF */: return 36 /* KeyCode.KeyF */;\n            case 16 /* ScanCode.KeyG */: return 37 /* KeyCode.KeyG */;\n            case 17 /* ScanCode.KeyH */: return 38 /* KeyCode.KeyH */;\n            case 18 /* ScanCode.KeyI */: return 39 /* KeyCode.KeyI */;\n            case 19 /* ScanCode.KeyJ */: return 40 /* KeyCode.KeyJ */;\n            case 20 /* ScanCode.KeyK */: return 41 /* KeyCode.KeyK */;\n            case 21 /* ScanCode.KeyL */: return 42 /* KeyCode.KeyL */;\n            case 22 /* ScanCode.KeyM */: return 43 /* KeyCode.KeyM */;\n            case 23 /* ScanCode.KeyN */: return 44 /* KeyCode.KeyN */;\n            case 24 /* ScanCode.KeyO */: return 45 /* KeyCode.KeyO */;\n            case 25 /* ScanCode.KeyP */: return 46 /* KeyCode.KeyP */;\n            case 26 /* ScanCode.KeyQ */: return 47 /* KeyCode.KeyQ */;\n            case 27 /* ScanCode.KeyR */: return 48 /* KeyCode.KeyR */;\n            case 28 /* ScanCode.KeyS */: return 49 /* KeyCode.KeyS */;\n            case 29 /* ScanCode.KeyT */: return 50 /* KeyCode.KeyT */;\n            case 30 /* ScanCode.KeyU */: return 51 /* KeyCode.KeyU */;\n            case 31 /* ScanCode.KeyV */: return 52 /* KeyCode.KeyV */;\n            case 32 /* ScanCode.KeyW */: return 53 /* KeyCode.KeyW */;\n            case 33 /* ScanCode.KeyX */: return 54 /* KeyCode.KeyX */;\n            case 34 /* ScanCode.KeyY */: return 55 /* KeyCode.KeyY */;\n            case 35 /* ScanCode.KeyZ */: return 56 /* KeyCode.KeyZ */;\n            case 36 /* ScanCode.Digit1 */: return 22 /* KeyCode.Digit1 */;\n            case 37 /* ScanCode.Digit2 */: return 23 /* KeyCode.Digit2 */;\n            case 38 /* ScanCode.Digit3 */: return 24 /* KeyCode.Digit3 */;\n            case 39 /* ScanCode.Digit4 */: return 25 /* KeyCode.Digit4 */;\n            case 40 /* ScanCode.Digit5 */: return 26 /* KeyCode.Digit5 */;\n            case 41 /* ScanCode.Digit6 */: return 27 /* KeyCode.Digit6 */;\n            case 42 /* ScanCode.Digit7 */: return 28 /* KeyCode.Digit7 */;\n            case 43 /* ScanCode.Digit8 */: return 29 /* KeyCode.Digit8 */;\n            case 44 /* ScanCode.Digit9 */: return 30 /* KeyCode.Digit9 */;\n            case 45 /* ScanCode.Digit0 */: return 21 /* KeyCode.Digit0 */;\n            case 51 /* ScanCode.Minus */: return 83 /* KeyCode.Minus */;\n            case 52 /* ScanCode.Equal */: return 81 /* KeyCode.Equal */;\n            case 53 /* ScanCode.BracketLeft */: return 87 /* KeyCode.BracketLeft */;\n            case 54 /* ScanCode.BracketRight */: return 89 /* KeyCode.BracketRight */;\n            case 55 /* ScanCode.Backslash */: return 88 /* KeyCode.Backslash */;\n            case 56 /* ScanCode.IntlHash */: return 0 /* KeyCode.Unknown */; // missing\n            case 57 /* ScanCode.Semicolon */: return 80 /* KeyCode.Semicolon */;\n            case 58 /* ScanCode.Quote */: return 90 /* KeyCode.Quote */;\n            case 59 /* ScanCode.Backquote */: return 86 /* KeyCode.Backquote */;\n            case 60 /* ScanCode.Comma */: return 82 /* KeyCode.Comma */;\n            case 61 /* ScanCode.Period */: return 84 /* KeyCode.Period */;\n            case 62 /* ScanCode.Slash */: return 85 /* KeyCode.Slash */;\n            case 106 /* ScanCode.IntlBackslash */: return 92 /* KeyCode.IntlBackslash */;\n        }\n        return 0 /* KeyCode.Unknown */;\n    }\n    static _resolveSimpleUserBinding(binding) {\n        if (!binding) {\n            return null;\n        }\n        if (binding instanceof SimpleKeybinding) {\n            return binding;\n        }\n        const keyCode = this._scanCodeToKeyCode(binding.scanCode);\n        if (keyCode === 0 /* KeyCode.Unknown */) {\n            return null;\n        }\n        return new SimpleKeybinding(binding.ctrlKey, binding.shiftKey, binding.altKey, binding.metaKey, keyCode);\n    }\n    static resolveUserBinding(input, os) {\n        const parts = removeElementsAfterNulls(input.map(keybinding => this._resolveSimpleUserBinding(keybinding)));\n        if (parts.length > 0) {\n            return [new USLayoutResolvedKeybinding(new ChordKeybinding(parts), os)];\n        }\n        return [];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { BrowserFeatures } from '../../canIUse.js';\nimport * as DOM from '../../dom.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../common/lifecycle.js';\nimport * as platform from '../../../common/platform.js';\nimport { Range } from '../../../common/range.js';\nimport './contextview.css';\nexport var LayoutAnchorMode;\n(function (LayoutAnchorMode) {\n    LayoutAnchorMode[LayoutAnchorMode[\"AVOID\"] = 0] = \"AVOID\";\n    LayoutAnchorMode[LayoutAnchorMode[\"ALIGN\"] = 1] = \"ALIGN\";\n})(LayoutAnchorMode || (LayoutAnchorMode = {}));\n/**\n * Lays out a one dimensional view next to an anchor in a viewport.\n *\n * @returns The view offset within the viewport.\n */\nexport function layout(viewportSize, viewSize, anchor) {\n    const layoutAfterAnchorBoundary = anchor.mode === LayoutAnchorMode.ALIGN ? anchor.offset : anchor.offset + anchor.size;\n    const layoutBeforeAnchorBoundary = anchor.mode === LayoutAnchorMode.ALIGN ? anchor.offset + anchor.size : anchor.offset;\n    if (anchor.position === 0 /* LayoutAnchorPosition.Before */) {\n        if (viewSize <= viewportSize - layoutAfterAnchorBoundary) {\n            return layoutAfterAnchorBoundary; // happy case, lay it out after the anchor\n        }\n        if (viewSize <= layoutBeforeAnchorBoundary) {\n            return layoutBeforeAnchorBoundary - viewSize; // ok case, lay it out before the anchor\n        }\n        return Math.max(viewportSize - viewSize, 0); // sad case, lay it over the anchor\n    }\n    else {\n        if (viewSize <= layoutBeforeAnchorBoundary) {\n            return layoutBeforeAnchorBoundary - viewSize; // happy case, lay it out before the anchor\n        }\n        if (viewSize <= viewportSize - layoutAfterAnchorBoundary) {\n            return layoutAfterAnchorBoundary; // ok case, lay it out after the anchor\n        }\n        return 0; // sad case, lay it over the anchor\n    }\n}\nexport class ContextView extends Disposable {\n    constructor(container, domPosition) {\n        super();\n        this.container = null;\n        this.delegate = null;\n        this.toDisposeOnClean = Disposable.None;\n        this.toDisposeOnSetContainer = Disposable.None;\n        this.shadowRoot = null;\n        this.shadowRootHostElement = null;\n        this.view = DOM.$('.context-view');\n        this.useFixedPosition = false;\n        this.useShadowDOM = false;\n        DOM.hide(this.view);\n        this.setContainer(container, domPosition);\n        this._register(toDisposable(() => this.setContainer(null, 1 /* ContextViewDOMPosition.ABSOLUTE */)));\n    }\n    setContainer(container, domPosition) {\n        var _a;\n        if (this.container) {\n            this.toDisposeOnSetContainer.dispose();\n            if (this.shadowRoot) {\n                this.shadowRoot.removeChild(this.view);\n                this.shadowRoot = null;\n                (_a = this.shadowRootHostElement) === null || _a === void 0 ? void 0 : _a.remove();\n                this.shadowRootHostElement = null;\n            }\n            else {\n                this.container.removeChild(this.view);\n            }\n            this.container = null;\n        }\n        if (container) {\n            this.container = container;\n            this.useFixedPosition = domPosition !== 1 /* ContextViewDOMPosition.ABSOLUTE */;\n            this.useShadowDOM = domPosition === 3 /* ContextViewDOMPosition.FIXED_SHADOW */;\n            if (this.useShadowDOM) {\n                this.shadowRootHostElement = DOM.$('.shadow-root-host');\n                this.container.appendChild(this.shadowRootHostElement);\n                this.shadowRoot = this.shadowRootHostElement.attachShadow({ mode: 'open' });\n                const style = document.createElement('style');\n                style.textContent = SHADOW_ROOT_CSS;\n                this.shadowRoot.appendChild(style);\n                this.shadowRoot.appendChild(this.view);\n                this.shadowRoot.appendChild(DOM.$('slot'));\n            }\n            else {\n                this.container.appendChild(this.view);\n            }\n            const toDisposeOnSetContainer = new DisposableStore();\n            ContextView.BUBBLE_UP_EVENTS.forEach(event => {\n                toDisposeOnSetContainer.add(DOM.addStandardDisposableListener(this.container, event, (e) => {\n                    this.onDOMEvent(e, false);\n                }));\n            });\n            ContextView.BUBBLE_DOWN_EVENTS.forEach(event => {\n                toDisposeOnSetContainer.add(DOM.addStandardDisposableListener(this.container, event, (e) => {\n                    this.onDOMEvent(e, true);\n                }, true));\n            });\n            this.toDisposeOnSetContainer = toDisposeOnSetContainer;\n        }\n    }\n    show(delegate) {\n        var _a, _b;\n        if (this.isVisible()) {\n            this.hide();\n        }\n        // Show static box\n        DOM.clearNode(this.view);\n        this.view.className = 'context-view';\n        this.view.style.top = '0px';\n        this.view.style.left = '0px';\n        this.view.style.zIndex = '2575';\n        this.view.style.position = this.useFixedPosition ? 'fixed' : 'absolute';\n        DOM.show(this.view);\n        // Render content\n        this.toDisposeOnClean = delegate.render(this.view) || Disposable.None;\n        // Set active delegate\n        this.delegate = delegate;\n        // Layout\n        this.doLayout();\n        // Focus\n        (_b = (_a = this.delegate).focus) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n    getViewElement() {\n        return this.view;\n    }\n    layout() {\n        if (!this.isVisible()) {\n            return;\n        }\n        if (this.delegate.canRelayout === false && !(platform.isIOS && BrowserFeatures.pointerEvents)) {\n            this.hide();\n            return;\n        }\n        if (this.delegate.layout) {\n            this.delegate.layout();\n        }\n        this.doLayout();\n    }\n    doLayout() {\n        // Check that we still have a delegate - this.delegate.layout may have hidden\n        if (!this.isVisible()) {\n            return;\n        }\n        // Get anchor\n        const anchor = this.delegate.getAnchor();\n        // Compute around\n        let around;\n        // Get the element's position and size (to anchor the view)\n        if (DOM.isHTMLElement(anchor)) {\n            const elementPosition = DOM.getDomNodePagePosition(anchor);\n            // In areas where zoom is applied to the element or its ancestors, we need to adjust the size of the element\n            // e.g. The title bar has counter zoom behavior meaning it applies the inverse of zoom level.\n            // Window Zoom Level: 1.5, Title Bar Zoom: 1/1.5, Size Multiplier: 1.5\n            const zoom = DOM.getDomNodeZoomLevel(anchor);\n            around = {\n                top: elementPosition.top * zoom,\n                left: elementPosition.left * zoom,\n                width: elementPosition.width * zoom,\n                height: elementPosition.height * zoom\n            };\n        }\n        else {\n            around = {\n                top: anchor.y,\n                left: anchor.x,\n                width: anchor.width || 1,\n                height: anchor.height || 2\n            };\n        }\n        const viewSizeWidth = DOM.getTotalWidth(this.view);\n        const viewSizeHeight = DOM.getTotalHeight(this.view);\n        const anchorPosition = this.delegate.anchorPosition || 0 /* AnchorPosition.BELOW */;\n        const anchorAlignment = this.delegate.anchorAlignment || 0 /* AnchorAlignment.LEFT */;\n        const anchorAxisAlignment = this.delegate.anchorAxisAlignment || 0 /* AnchorAxisAlignment.VERTICAL */;\n        let top;\n        let left;\n        if (anchorAxisAlignment === 0 /* AnchorAxisAlignment.VERTICAL */) {\n            const verticalAnchor = { offset: around.top - window.pageYOffset, size: around.height, position: anchorPosition === 0 /* AnchorPosition.BELOW */ ? 0 /* LayoutAnchorPosition.Before */ : 1 /* LayoutAnchorPosition.After */ };\n            const horizontalAnchor = { offset: around.left, size: around.width, position: anchorAlignment === 0 /* AnchorAlignment.LEFT */ ? 0 /* LayoutAnchorPosition.Before */ : 1 /* LayoutAnchorPosition.After */, mode: LayoutAnchorMode.ALIGN };\n            top = layout(window.innerHeight, viewSizeHeight, verticalAnchor) + window.pageYOffset;\n            // if view intersects vertically with anchor,  we must avoid the anchor\n            if (Range.intersects({ start: top, end: top + viewSizeHeight }, { start: verticalAnchor.offset, end: verticalAnchor.offset + verticalAnchor.size })) {\n                horizontalAnchor.mode = LayoutAnchorMode.AVOID;\n            }\n            left = layout(window.innerWidth, viewSizeWidth, horizontalAnchor);\n        }\n        else {\n            const horizontalAnchor = { offset: around.left, size: around.width, position: anchorAlignment === 0 /* AnchorAlignment.LEFT */ ? 0 /* LayoutAnchorPosition.Before */ : 1 /* LayoutAnchorPosition.After */ };\n            const verticalAnchor = { offset: around.top, size: around.height, position: anchorPosition === 0 /* AnchorPosition.BELOW */ ? 0 /* LayoutAnchorPosition.Before */ : 1 /* LayoutAnchorPosition.After */, mode: LayoutAnchorMode.ALIGN };\n            left = layout(window.innerWidth, viewSizeWidth, horizontalAnchor);\n            // if view intersects horizontally with anchor, we must avoid the anchor\n            if (Range.intersects({ start: left, end: left + viewSizeWidth }, { start: horizontalAnchor.offset, end: horizontalAnchor.offset + horizontalAnchor.size })) {\n                verticalAnchor.mode = LayoutAnchorMode.AVOID;\n            }\n            top = layout(window.innerHeight, viewSizeHeight, verticalAnchor) + window.pageYOffset;\n        }\n        this.view.classList.remove('top', 'bottom', 'left', 'right');\n        this.view.classList.add(anchorPosition === 0 /* AnchorPosition.BELOW */ ? 'bottom' : 'top');\n        this.view.classList.add(anchorAlignment === 0 /* AnchorAlignment.LEFT */ ? 'left' : 'right');\n        this.view.classList.toggle('fixed', this.useFixedPosition);\n        const containerPosition = DOM.getDomNodePagePosition(this.container);\n        this.view.style.top = `${top - (this.useFixedPosition ? DOM.getDomNodePagePosition(this.view).top : containerPosition.top)}px`;\n        this.view.style.left = `${left - (this.useFixedPosition ? DOM.getDomNodePagePosition(this.view).left : containerPosition.left)}px`;\n        this.view.style.width = 'initial';\n    }\n    hide(data) {\n        const delegate = this.delegate;\n        this.delegate = null;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.onHide) {\n            delegate.onHide(data);\n        }\n        this.toDisposeOnClean.dispose();\n        DOM.hide(this.view);\n    }\n    isVisible() {\n        return !!this.delegate;\n    }\n    onDOMEvent(e, onCapture) {\n        if (this.delegate) {\n            if (this.delegate.onDOMEvent) {\n                this.delegate.onDOMEvent(e, document.activeElement);\n            }\n            else if (onCapture && !DOM.isAncestor(e.target, this.container)) {\n                this.hide();\n            }\n        }\n    }\n    dispose() {\n        this.hide();\n        super.dispose();\n    }\n}\nContextView.BUBBLE_UP_EVENTS = ['click', 'keydown', 'focus', 'blur'];\nContextView.BUBBLE_DOWN_EVENTS = ['click'];\nconst SHADOW_ROOT_CSS = /* css */ `\n\t:host {\n\t\tall: initial; /* 1st rule so subsequent properties are reset. */\n\t}\n\n\t@font-face {\n\t\tfont-family: \"codicon\";\n\t\tfont-display: block;\n\t\tsrc: url(\"./codicon.ttf?5d4d76ab2ce5108968ad644d591a16a6\") format(\"truetype\");\n\t}\n\n\t.codicon[class*='codicon-'] {\n\t\tfont: normal normal normal 16px/1 codicon;\n\t\tdisplay: inline-block;\n\t\ttext-decoration: none;\n\t\ttext-rendering: auto;\n\t\ttext-align: center;\n\t\t-webkit-font-smoothing: antialiased;\n\t\t-moz-osx-font-smoothing: grayscale;\n\t\tuser-select: none;\n\t\t-webkit-user-select: none;\n\t\t-ms-user-select: none;\n\t}\n\n\t:host {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, \"Segoe WPC\", \"Segoe UI\", \"HelveticaNeue-Light\", system-ui, \"Ubuntu\", \"Droid Sans\", sans-serif;\n\t}\n\n\t:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }\n\t:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, \"PingFang SC\", \"Hiragino Sans GB\", sans-serif; }\n\t:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, \"PingFang TC\", sans-serif; }\n\t:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, \"Hiragino Kaku Gothic Pro\", sans-serif; }\n\t:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, \"Nanum Gothic\", \"Apple SD Gothic Neo\", \"AppleGothic\", sans-serif; }\n\n\t:host-context(.windows) { font-family: \"Segoe WPC\", \"Segoe UI\", sans-serif; }\n\t:host-context(.windows:lang(zh-Hans)) { font-family: \"Segoe WPC\", \"Segoe UI\", \"Microsoft YaHei\", sans-serif; }\n\t:host-context(.windows:lang(zh-Hant)) { font-family: \"Segoe WPC\", \"Segoe UI\", \"Microsoft Jhenghei\", sans-serif; }\n\t:host-context(.windows:lang(ja)) { font-family: \"Segoe WPC\", \"Segoe UI\", \"Yu Gothic UI\", \"Meiryo UI\", sans-serif; }\n\t:host-context(.windows:lang(ko)) { font-family: \"Segoe WPC\", \"Segoe UI\", \"Malgun Gothic\", \"Dotom\", sans-serif; }\n\n\t:host-context(.linux) { font-family: system-ui, \"Ubuntu\", \"Droid Sans\", sans-serif; }\n\t:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, \"Ubuntu\", \"Droid Sans\", \"Source Han Sans SC\", \"Source Han Sans CN\", \"Source Han Sans\", sans-serif; }\n\t:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, \"Ubuntu\", \"Droid Sans\", \"Source Han Sans TC\", \"Source Han Sans TW\", \"Source Han Sans\", sans-serif; }\n\t:host-context(.linux:lang(ja)) { font-family: system-ui, \"Ubuntu\", \"Droid Sans\", \"Source Han Sans J\", \"Source Han Sans JP\", \"Source Han Sans\", sans-serif; }\n\t:host-context(.linux:lang(ko)) { font-family: system-ui, \"Ubuntu\", \"Droid Sans\", \"Source Han Sans K\", \"Source Han Sans JR\", \"Source Han Sans\", \"UnDotum\", \"FBaekmuk Gulim\", sans-serif; }\n`;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { ContextView } from '../../../base/browser/ui/contextview/contextview.js';\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { ILayoutService } from '../../layout/browser/layoutService.js';\nlet ContextViewService = class ContextViewService extends Disposable {\n    constructor(layoutService) {\n        super();\n        this.layoutService = layoutService;\n        this.currentViewDisposable = Disposable.None;\n        this.container = layoutService.hasContainer ? layoutService.container : null;\n        this.contextView = this._register(new ContextView(this.container, 1 /* ContextViewDOMPosition.ABSOLUTE */));\n        this.layout();\n        this._register(layoutService.onDidLayout(() => this.layout()));\n    }\n    // ContextView\n    setContainer(container, domPosition) {\n        this.contextView.setContainer(container, domPosition || 1 /* ContextViewDOMPosition.ABSOLUTE */);\n    }\n    showContextView(delegate, container, shadowRoot) {\n        if (container) {\n            if (container !== this.container || this.shadowRoot !== shadowRoot) {\n                this.container = container;\n                this.setContainer(container, shadowRoot ? 3 /* ContextViewDOMPosition.FIXED_SHADOW */ : 2 /* ContextViewDOMPosition.FIXED */);\n            }\n        }\n        else {\n            if (this.layoutService.hasContainer && this.container !== this.layoutService.container) {\n                this.container = this.layoutService.container;\n                this.setContainer(this.container, 1 /* ContextViewDOMPosition.ABSOLUTE */);\n            }\n        }\n        this.shadowRoot = shadowRoot;\n        this.contextView.show(delegate);\n        const disposable = toDisposable(() => {\n            if (this.currentViewDisposable === disposable) {\n                this.hideContextView();\n            }\n        });\n        this.currentViewDisposable = disposable;\n        return disposable;\n    }\n    getContextViewElement() {\n        return this.contextView.getViewElement();\n    }\n    layout() {\n        this.contextView.layout();\n    }\n    hideContextView(data) {\n        this.contextView.hide(data);\n    }\n};\nContextViewService = __decorate([\n    __param(0, ILayoutService)\n], ContextViewService);\nexport { ContextViewService };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isThenable } from './async.js';\nimport { isEqualOrParent } from './extpath.js';\nimport { LRUCache } from './map.js';\nimport { basename, extname, posix, sep } from './path.js';\nimport { isLinux } from './platform.js';\nimport { escapeRegExpCharacters } from './strings.js';\nexport const GLOBSTAR = '**';\nexport const GLOB_SPLIT = '/';\nconst PATH_REGEX = '[/\\\\\\\\]'; // any slash or backslash\nconst NO_PATH_REGEX = '[^/\\\\\\\\]'; // any non-slash and non-backslash\nconst ALL_FORWARD_SLASHES = /\\//g;\nfunction starsToRegExp(starCount, isLastPattern) {\n    switch (starCount) {\n        case 0:\n            return '';\n        case 1:\n            return `${NO_PATH_REGEX}*?`; // 1 star matches any number of characters except path separator (/ and \\) - non greedy (?)\n        default:\n            // Matches:  (Path Sep OR Path Val followed by Path Sep) 0-many times except when it's the last pattern\n            //           in which case also matches (Path Sep followed by Path Val)\n            // Group is non capturing because we don't need to capture at all (?:...)\n            // Overall we use non-greedy matching because it could be that we match too much\n            return `(?:${PATH_REGEX}|${NO_PATH_REGEX}+${PATH_REGEX}${isLastPattern ? `|${PATH_REGEX}${NO_PATH_REGEX}+` : ''})*?`;\n    }\n}\nexport function splitGlobAware(pattern, splitChar) {\n    if (!pattern) {\n        return [];\n    }\n    const segments = [];\n    let inBraces = false;\n    let inBrackets = false;\n    let curVal = '';\n    for (const char of pattern) {\n        switch (char) {\n            case splitChar:\n                if (!inBraces && !inBrackets) {\n                    segments.push(curVal);\n                    curVal = '';\n                    continue;\n                }\n                break;\n            case '{':\n                inBraces = true;\n                break;\n            case '}':\n                inBraces = false;\n                break;\n            case '[':\n                inBrackets = true;\n                break;\n            case ']':\n                inBrackets = false;\n                break;\n        }\n        curVal += char;\n    }\n    // Tail\n    if (curVal) {\n        segments.push(curVal);\n    }\n    return segments;\n}\nfunction parseRegExp(pattern) {\n    if (!pattern) {\n        return '';\n    }\n    let regEx = '';\n    // Split up into segments for each slash found\n    const segments = splitGlobAware(pattern, GLOB_SPLIT);\n    // Special case where we only have globstars\n    if (segments.every(segment => segment === GLOBSTAR)) {\n        regEx = '.*';\n    }\n    // Build regex over segments\n    else {\n        let previousSegmentWasGlobStar = false;\n        segments.forEach((segment, index) => {\n            // Treat globstar specially\n            if (segment === GLOBSTAR) {\n                // if we have more than one globstar after another, just ignore it\n                if (previousSegmentWasGlobStar) {\n                    return;\n                }\n                regEx += starsToRegExp(2, index === segments.length - 1);\n            }\n            // Anything else, not globstar\n            else {\n                // States\n                let inBraces = false;\n                let braceVal = '';\n                let inBrackets = false;\n                let bracketVal = '';\n                for (const char of segment) {\n                    // Support brace expansion\n                    if (char !== '}' && inBraces) {\n                        braceVal += char;\n                        continue;\n                    }\n                    // Support brackets\n                    if (inBrackets && (char !== ']' || !bracketVal) /* ] is literally only allowed as first character in brackets to match it */) {\n                        let res;\n                        // range operator\n                        if (char === '-') {\n                            res = char;\n                        }\n                        // negation operator (only valid on first index in bracket)\n                        else if ((char === '^' || char === '!') && !bracketVal) {\n                            res = '^';\n                        }\n                        // glob split matching is not allowed within character ranges\n                        // see http://man7.org/linux/man-pages/man7/glob.7.html\n                        else if (char === GLOB_SPLIT) {\n                            res = '';\n                        }\n                        // anything else gets escaped\n                        else {\n                            res = escapeRegExpCharacters(char);\n                        }\n                        bracketVal += res;\n                        continue;\n                    }\n                    switch (char) {\n                        case '{':\n                            inBraces = true;\n                            continue;\n                        case '[':\n                            inBrackets = true;\n                            continue;\n                        case '}': {\n                            const choices = splitGlobAware(braceVal, ',');\n                            // Converts {foo,bar} => [foo|bar]\n                            const braceRegExp = `(?:${choices.map(choice => parseRegExp(choice)).join('|')})`;\n                            regEx += braceRegExp;\n                            inBraces = false;\n                            braceVal = '';\n                            break;\n                        }\n                        case ']': {\n                            regEx += ('[' + bracketVal + ']');\n                            inBrackets = false;\n                            bracketVal = '';\n                            break;\n                        }\n                        case '?':\n                            regEx += NO_PATH_REGEX; // 1 ? matches any single character except path separator (/ and \\)\n                            continue;\n                        case '*':\n                            regEx += starsToRegExp(1);\n                            continue;\n                        default:\n                            regEx += escapeRegExpCharacters(char);\n                    }\n                }\n                // Tail: Add the slash we had split on if there is more to\n                // come and the remaining pattern is not a globstar\n                // For example if pattern: some/**/*.js we want the \"/\" after\n                // some to be included in the RegEx to prevent a folder called\n                // \"something\" to match as well.\n                if (index < segments.length - 1 && // more segments to come after this\n                    (segments[index + 1] !== GLOBSTAR || // next segment is not **, or...\n                        index + 2 < segments.length // ...next segment is ** but there is more segments after that\n                    )) {\n                    regEx += PATH_REGEX;\n                }\n            }\n            // update globstar state\n            previousSegmentWasGlobStar = (segment === GLOBSTAR);\n        });\n    }\n    return regEx;\n}\n// regexes to check for trivial glob patterns that just check for String#endsWith\nconst T1 = /^\\*\\*\\/\\*\\.[\\w\\.-]+$/; // **/*.something\nconst T2 = /^\\*\\*\\/([\\w\\.-]+)\\/?$/; // **/something\nconst T3 = /^{\\*\\*\\/\\*?[\\w\\.-]+\\/?(,\\*\\*\\/\\*?[\\w\\.-]+\\/?)*}$/; // {**/*.something,**/*.else} or {**/package.json,**/project.json}\nconst T3_2 = /^{\\*\\*\\/\\*?[\\w\\.-]+(\\/(\\*\\*)?)?(,\\*\\*\\/\\*?[\\w\\.-]+(\\/(\\*\\*)?)?)*}$/; // Like T3, with optional trailing /**\nconst T4 = /^\\*\\*((\\/[\\w\\.-]+)+)\\/?$/; // **/something/else\nconst T5 = /^([\\w\\.-]+(\\/[\\w\\.-]+)*)\\/?$/; // something/else\nconst CACHE = new LRUCache(10000); // bounded to 10000 elements\nconst FALSE = function () {\n    return false;\n};\nconst NULL = function () {\n    return null;\n};\nfunction parsePattern(arg1, options) {\n    if (!arg1) {\n        return NULL;\n    }\n    // Handle relative patterns\n    let pattern;\n    if (typeof arg1 !== 'string') {\n        pattern = arg1.pattern;\n    }\n    else {\n        pattern = arg1;\n    }\n    // Whitespace trimming\n    pattern = pattern.trim();\n    // Check cache\n    const patternKey = `${pattern}_${!!options.trimForExclusions}`;\n    let parsedPattern = CACHE.get(patternKey);\n    if (parsedPattern) {\n        return wrapRelativePattern(parsedPattern, arg1);\n    }\n    // Check for Trivials\n    let match;\n    if (T1.test(pattern)) {\n        parsedPattern = trivia1(pattern.substr(4), pattern); // common pattern: **/*.txt just need endsWith check\n    }\n    else if (match = T2.exec(trimForExclusions(pattern, options))) { // common pattern: **/some.txt just need basename check\n        parsedPattern = trivia2(match[1], pattern);\n    }\n    else if ((options.trimForExclusions ? T3_2 : T3).test(pattern)) { // repetition of common patterns (see above) {**/*.txt,**/*.png}\n        parsedPattern = trivia3(pattern, options);\n    }\n    else if (match = T4.exec(trimForExclusions(pattern, options))) { // common pattern: **/something/else just need endsWith check\n        parsedPattern = trivia4and5(match[1].substr(1), pattern, true);\n    }\n    else if (match = T5.exec(trimForExclusions(pattern, options))) { // common pattern: something/else just need equals check\n        parsedPattern = trivia4and5(match[1], pattern, false);\n    }\n    // Otherwise convert to pattern\n    else {\n        parsedPattern = toRegExp(pattern);\n    }\n    // Cache\n    CACHE.set(patternKey, parsedPattern);\n    return wrapRelativePattern(parsedPattern, arg1);\n}\nfunction wrapRelativePattern(parsedPattern, arg2) {\n    if (typeof arg2 === 'string') {\n        return parsedPattern;\n    }\n    const wrappedPattern = function (path, basename) {\n        if (!isEqualOrParent(path, arg2.base, !isLinux)) {\n            // skip glob matching if `base` is not a parent of `path`\n            return null;\n        }\n        // Given we have checked `base` being a parent of `path`,\n        // we can now remove the `base` portion of the `path`\n        // and only match on the remaining path components\n        return parsedPattern(path.substr(arg2.base.length + 1), basename);\n    };\n    // Make sure to preserve associated metadata\n    wrappedPattern.allBasenames = parsedPattern.allBasenames;\n    wrappedPattern.allPaths = parsedPattern.allPaths;\n    wrappedPattern.basenames = parsedPattern.basenames;\n    wrappedPattern.patterns = parsedPattern.patterns;\n    return wrappedPattern;\n}\nfunction trimForExclusions(pattern, options) {\n    return options.trimForExclusions && pattern.endsWith('/**') ? pattern.substr(0, pattern.length - 2) : pattern; // dropping **, tailing / is dropped later\n}\n// common pattern: **/*.txt just need endsWith check\nfunction trivia1(base, pattern) {\n    return function (path, basename) {\n        return typeof path === 'string' && path.endsWith(base) ? pattern : null;\n    };\n}\n// common pattern: **/some.txt just need basename check\nfunction trivia2(base, pattern) {\n    const slashBase = `/${base}`;\n    const backslashBase = `\\\\${base}`;\n    const parsedPattern = function (path, basename) {\n        if (typeof path !== 'string') {\n            return null;\n        }\n        if (basename) {\n            return basename === base ? pattern : null;\n        }\n        return path === base || path.endsWith(slashBase) || path.endsWith(backslashBase) ? pattern : null;\n    };\n    const basenames = [base];\n    parsedPattern.basenames = basenames;\n    parsedPattern.patterns = [pattern];\n    parsedPattern.allBasenames = basenames;\n    return parsedPattern;\n}\n// repetition of common patterns (see above) {**/*.txt,**/*.png}\nfunction trivia3(pattern, options) {\n    const parsedPatterns = aggregateBasenameMatches(pattern.slice(1, -1)\n        .split(',')\n        .map(pattern => parsePattern(pattern, options))\n        .filter(pattern => pattern !== NULL), pattern);\n    const patternsLength = parsedPatterns.length;\n    if (!patternsLength) {\n        return NULL;\n    }\n    if (patternsLength === 1) {\n        return parsedPatterns[0];\n    }\n    const parsedPattern = function (path, basename) {\n        for (let i = 0, n = parsedPatterns.length; i < n; i++) {\n            if (parsedPatterns[i](path, basename)) {\n                return pattern;\n            }\n        }\n        return null;\n    };\n    const withBasenames = parsedPatterns.find(pattern => !!pattern.allBasenames);\n    if (withBasenames) {\n        parsedPattern.allBasenames = withBasenames.allBasenames;\n    }\n    const allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, []);\n    if (allPaths.length) {\n        parsedPattern.allPaths = allPaths;\n    }\n    return parsedPattern;\n}\n// common patterns: **/something/else just need endsWith check, something/else just needs and equals check\nfunction trivia4and5(targetPath, pattern, matchPathEnds) {\n    const usingPosixSep = sep === posix.sep;\n    const nativePath = usingPosixSep ? targetPath : targetPath.replace(ALL_FORWARD_SLASHES, sep);\n    const nativePathEnd = sep + nativePath;\n    const targetPathEnd = posix.sep + targetPath;\n    let parsedPattern;\n    if (matchPathEnds) {\n        parsedPattern = function (path, basename) {\n            return typeof path === 'string' && ((path === nativePath || path.endsWith(nativePathEnd)) || !usingPosixSep && (path === targetPath || path.endsWith(targetPathEnd))) ? pattern : null;\n        };\n    }\n    else {\n        parsedPattern = function (path, basename) {\n            return typeof path === 'string' && (path === nativePath || (!usingPosixSep && path === targetPath)) ? pattern : null;\n        };\n    }\n    parsedPattern.allPaths = [(matchPathEnds ? '*/' : './') + targetPath];\n    return parsedPattern;\n}\nfunction toRegExp(pattern) {\n    try {\n        const regExp = new RegExp(`^${parseRegExp(pattern)}$`);\n        return function (path) {\n            regExp.lastIndex = 0; // reset RegExp to its initial state to reuse it!\n            return typeof path === 'string' && regExp.test(path) ? pattern : null;\n        };\n    }\n    catch (error) {\n        return NULL;\n    }\n}\nexport function match(arg1, path, hasSibling) {\n    if (!arg1 || typeof path !== 'string') {\n        return false;\n    }\n    return parse(arg1)(path, undefined, hasSibling);\n}\nexport function parse(arg1, options = {}) {\n    if (!arg1) {\n        return FALSE;\n    }\n    // Glob with String\n    if (typeof arg1 === 'string' || isRelativePattern(arg1)) {\n        const parsedPattern = parsePattern(arg1, options);\n        if (parsedPattern === NULL) {\n            return FALSE;\n        }\n        const resultPattern = function (path, basename) {\n            return !!parsedPattern(path, basename);\n        };\n        if (parsedPattern.allBasenames) {\n            resultPattern.allBasenames = parsedPattern.allBasenames;\n        }\n        if (parsedPattern.allPaths) {\n            resultPattern.allPaths = parsedPattern.allPaths;\n        }\n        return resultPattern;\n    }\n    // Glob with Expression\n    return parsedExpression(arg1, options);\n}\nexport function isRelativePattern(obj) {\n    const rp = obj;\n    if (!rp) {\n        return false;\n    }\n    return typeof rp.base === 'string' && typeof rp.pattern === 'string';\n}\nfunction parsedExpression(expression, options) {\n    const parsedPatterns = aggregateBasenameMatches(Object.getOwnPropertyNames(expression)\n        .map(pattern => parseExpressionPattern(pattern, expression[pattern], options))\n        .filter(pattern => pattern !== NULL));\n    const patternsLength = parsedPatterns.length;\n    if (!patternsLength) {\n        return NULL;\n    }\n    if (!parsedPatterns.some(parsedPattern => !!parsedPattern.requiresSiblings)) {\n        if (patternsLength === 1) {\n            return parsedPatterns[0];\n        }\n        const resultExpression = function (path, basename) {\n            let resultPromises = undefined;\n            for (let i = 0, n = parsedPatterns.length; i < n; i++) {\n                const result = parsedPatterns[i](path, basename);\n                if (typeof result === 'string') {\n                    return result; // immediately return as soon as the first expression matches\n                }\n                // If the result is a promise, we have to keep it for\n                // later processing and await the result properly.\n                if (isThenable(result)) {\n                    if (!resultPromises) {\n                        resultPromises = [];\n                    }\n                    resultPromises.push(result);\n                }\n            }\n            // With result promises, we have to loop over each and\n            // await the result before we can return any result.\n            if (resultPromises) {\n                return (() => __awaiter(this, void 0, void 0, function* () {\n                    for (const resultPromise of resultPromises) {\n                        const result = yield resultPromise;\n                        if (typeof result === 'string') {\n                            return result;\n                        }\n                    }\n                    return null;\n                }))();\n            }\n            return null;\n        };\n        const withBasenames = parsedPatterns.find(pattern => !!pattern.allBasenames);\n        if (withBasenames) {\n            resultExpression.allBasenames = withBasenames.allBasenames;\n        }\n        const allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, []);\n        if (allPaths.length) {\n            resultExpression.allPaths = allPaths;\n        }\n        return resultExpression;\n    }\n    const resultExpression = function (path, base, hasSibling) {\n        let name = undefined;\n        let resultPromises = undefined;\n        for (let i = 0, n = parsedPatterns.length; i < n; i++) {\n            // Pattern matches path\n            const parsedPattern = parsedPatterns[i];\n            if (parsedPattern.requiresSiblings && hasSibling) {\n                if (!base) {\n                    base = basename(path);\n                }\n                if (!name) {\n                    name = base.substr(0, base.length - extname(path).length);\n                }\n            }\n            const result = parsedPattern(path, base, name, hasSibling);\n            if (typeof result === 'string') {\n                return result; // immediately return as soon as the first expression matches\n            }\n            // If the result is a promise, we have to keep it for\n            // later processing and await the result properly.\n            if (isThenable(result)) {\n                if (!resultPromises) {\n                    resultPromises = [];\n                }\n                resultPromises.push(result);\n            }\n        }\n        // With result promises, we have to loop over each and\n        // await the result before we can return any result.\n        if (resultPromises) {\n            return (() => __awaiter(this, void 0, void 0, function* () {\n                for (const resultPromise of resultPromises) {\n                    const result = yield resultPromise;\n                    if (typeof result === 'string') {\n                        return result;\n                    }\n                }\n                return null;\n            }))();\n        }\n        return null;\n    };\n    const withBasenames = parsedPatterns.find(pattern => !!pattern.allBasenames);\n    if (withBasenames) {\n        resultExpression.allBasenames = withBasenames.allBasenames;\n    }\n    const allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, []);\n    if (allPaths.length) {\n        resultExpression.allPaths = allPaths;\n    }\n    return resultExpression;\n}\nfunction parseExpressionPattern(pattern, value, options) {\n    if (value === false) {\n        return NULL; // pattern is disabled\n    }\n    const parsedPattern = parsePattern(pattern, options);\n    if (parsedPattern === NULL) {\n        return NULL;\n    }\n    // Expression Pattern is <boolean>\n    if (typeof value === 'boolean') {\n        return parsedPattern;\n    }\n    // Expression Pattern is <SiblingClause>\n    if (value) {\n        const when = value.when;\n        if (typeof when === 'string') {\n            const result = (path, basename, name, hasSibling) => {\n                if (!hasSibling || !parsedPattern(path, basename)) {\n                    return null;\n                }\n                const clausePattern = when.replace('$(basename)', name);\n                const matched = hasSibling(clausePattern);\n                return isThenable(matched) ?\n                    matched.then(match => match ? pattern : null) :\n                    matched ? pattern : null;\n            };\n            result.requiresSiblings = true;\n            return result;\n        }\n    }\n    // Expression is anything\n    return parsedPattern;\n}\nfunction aggregateBasenameMatches(parsedPatterns, result) {\n    const basenamePatterns = parsedPatterns.filter(parsedPattern => !!parsedPattern.basenames);\n    if (basenamePatterns.length < 2) {\n        return parsedPatterns;\n    }\n    const basenames = basenamePatterns.reduce((all, current) => {\n        const basenames = current.basenames;\n        return basenames ? all.concat(basenames) : all;\n    }, []);\n    let patterns;\n    if (result) {\n        patterns = [];\n        for (let i = 0, n = basenames.length; i < n; i++) {\n            patterns.push(result);\n        }\n    }\n    else {\n        patterns = basenamePatterns.reduce((all, current) => {\n            const patterns = current.patterns;\n            return patterns ? all.concat(patterns) : all;\n        }, []);\n    }\n    const aggregate = function (path, basename) {\n        if (typeof path !== 'string') {\n            return null;\n        }\n        if (!basename) {\n            let i;\n            for (i = path.length; i > 0; i--) {\n                const ch = path.charCodeAt(i - 1);\n                if (ch === 47 /* CharCode.Slash */ || ch === 92 /* CharCode.Backslash */) {\n                    break;\n                }\n            }\n            basename = path.substr(i);\n        }\n        const index = basenames.indexOf(basename);\n        return index !== -1 ? patterns[index] : null;\n    };\n    aggregate.basenames = basenames;\n    aggregate.patterns = patterns;\n    aggregate.allBasenames = basenames;\n    const aggregatedPatterns = parsedPatterns.filter(parsedPattern => !parsedPattern.basenames);\n    aggregatedPatterns.push(aggregate);\n    return aggregatedPatterns;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { parse } from '../../../base/common/glob.js';\nimport { Mimes } from '../../../base/common/mime.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { basename, posix } from '../../../base/common/path.js';\nimport { DataUri } from '../../../base/common/resources.js';\nimport { startsWithUTF8BOM } from '../../../base/common/strings.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../languages/modesRegistry.js';\nlet registeredAssociations = [];\nlet nonUserRegisteredAssociations = [];\nlet userRegisteredAssociations = [];\n/**\n * Associate a language to the registry (platform).\n * * **NOTE**: This association will lose over associations registered using `registerConfiguredLanguageAssociation`.\n * * **NOTE**: Use `clearPlatformLanguageAssociations` to remove all associations registered using this function.\n */\nexport function registerPlatformLanguageAssociation(association, warnOnOverwrite = false) {\n    _registerLanguageAssociation(association, false, warnOnOverwrite);\n}\nfunction _registerLanguageAssociation(association, userConfigured, warnOnOverwrite) {\n    // Register\n    const associationItem = toLanguageAssociationItem(association, userConfigured);\n    registeredAssociations.push(associationItem);\n    if (!associationItem.userConfigured) {\n        nonUserRegisteredAssociations.push(associationItem);\n    }\n    else {\n        userRegisteredAssociations.push(associationItem);\n    }\n    // Check for conflicts unless this is a user configured association\n    if (warnOnOverwrite && !associationItem.userConfigured) {\n        registeredAssociations.forEach(a => {\n            if (a.mime === associationItem.mime || a.userConfigured) {\n                return; // same mime or userConfigured is ok\n            }\n            if (associationItem.extension && a.extension === associationItem.extension) {\n                console.warn(`Overwriting extension <<${associationItem.extension}>> to now point to mime <<${associationItem.mime}>>`);\n            }\n            if (associationItem.filename && a.filename === associationItem.filename) {\n                console.warn(`Overwriting filename <<${associationItem.filename}>> to now point to mime <<${associationItem.mime}>>`);\n            }\n            if (associationItem.filepattern && a.filepattern === associationItem.filepattern) {\n                console.warn(`Overwriting filepattern <<${associationItem.filepattern}>> to now point to mime <<${associationItem.mime}>>`);\n            }\n            if (associationItem.firstline && a.firstline === associationItem.firstline) {\n                console.warn(`Overwriting firstline <<${associationItem.firstline}>> to now point to mime <<${associationItem.mime}>>`);\n            }\n        });\n    }\n}\nfunction toLanguageAssociationItem(association, userConfigured) {\n    return {\n        id: association.id,\n        mime: association.mime,\n        filename: association.filename,\n        extension: association.extension,\n        filepattern: association.filepattern,\n        firstline: association.firstline,\n        userConfigured: userConfigured,\n        filenameLowercase: association.filename ? association.filename.toLowerCase() : undefined,\n        extensionLowercase: association.extension ? association.extension.toLowerCase() : undefined,\n        filepatternLowercase: association.filepattern ? parse(association.filepattern.toLowerCase()) : undefined,\n        filepatternOnPath: association.filepattern ? association.filepattern.indexOf(posix.sep) >= 0 : false\n    };\n}\n/**\n * Clear language associations from the registry (platform).\n */\nexport function clearPlatformLanguageAssociations() {\n    registeredAssociations = registeredAssociations.filter(a => a.userConfigured);\n    nonUserRegisteredAssociations = [];\n}\n/**\n * @see `getMimeTypes`\n */\nexport function getLanguageIds(resource, firstLine) {\n    return getAssociations(resource, firstLine).map(item => item.id);\n}\nfunction getAssociations(resource, firstLine) {\n    let path;\n    if (resource) {\n        switch (resource.scheme) {\n            case Schemas.file:\n                path = resource.fsPath;\n                break;\n            case Schemas.data: {\n                const metadata = DataUri.parseMetaData(resource);\n                path = metadata.get(DataUri.META_DATA_LABEL);\n                break;\n            }\n            case Schemas.vscodeNotebookCell:\n                // File path not relevant for language detection of cell\n                path = undefined;\n                break;\n            default:\n                path = resource.path;\n        }\n    }\n    if (!path) {\n        return [{ id: 'unknown', mime: Mimes.unknown }];\n    }\n    path = path.toLowerCase();\n    const filename = basename(path);\n    // 1.) User configured mappings have highest priority\n    const configuredLanguage = getAssociationByPath(path, filename, userRegisteredAssociations);\n    if (configuredLanguage) {\n        return [configuredLanguage, { id: PLAINTEXT_LANGUAGE_ID, mime: Mimes.text }];\n    }\n    // 2.) Registered mappings have middle priority\n    const registeredLanguage = getAssociationByPath(path, filename, nonUserRegisteredAssociations);\n    if (registeredLanguage) {\n        return [registeredLanguage, { id: PLAINTEXT_LANGUAGE_ID, mime: Mimes.text }];\n    }\n    // 3.) Firstline has lowest priority\n    if (firstLine) {\n        const firstlineLanguage = getAssociationByFirstline(firstLine);\n        if (firstlineLanguage) {\n            return [firstlineLanguage, { id: PLAINTEXT_LANGUAGE_ID, mime: Mimes.text }];\n        }\n    }\n    return [{ id: 'unknown', mime: Mimes.unknown }];\n}\nfunction getAssociationByPath(path, filename, associations) {\n    var _a;\n    let filenameMatch = undefined;\n    let patternMatch = undefined;\n    let extensionMatch = undefined;\n    // We want to prioritize associations based on the order they are registered so that the last registered\n    // association wins over all other. This is for https://github.com/microsoft/vscode/issues/20074\n    for (let i = associations.length - 1; i >= 0; i--) {\n        const association = associations[i];\n        // First exact name match\n        if (filename === association.filenameLowercase) {\n            filenameMatch = association;\n            break; // take it!\n        }\n        // Longest pattern match\n        if (association.filepattern) {\n            if (!patternMatch || association.filepattern.length > patternMatch.filepattern.length) {\n                const target = association.filepatternOnPath ? path : filename; // match on full path if pattern contains path separator\n                if ((_a = association.filepatternLowercase) === null || _a === void 0 ? void 0 : _a.call(association, target)) {\n                    patternMatch = association;\n                }\n            }\n        }\n        // Longest extension match\n        if (association.extension) {\n            if (!extensionMatch || association.extension.length > extensionMatch.extension.length) {\n                if (filename.endsWith(association.extensionLowercase)) {\n                    extensionMatch = association;\n                }\n            }\n        }\n    }\n    // 1.) Exact name match has second highest priority\n    if (filenameMatch) {\n        return filenameMatch;\n    }\n    // 2.) Match on pattern\n    if (patternMatch) {\n        return patternMatch;\n    }\n    // 3.) Match on extension comes next\n    if (extensionMatch) {\n        return extensionMatch;\n    }\n    return undefined;\n}\nfunction getAssociationByFirstline(firstLine) {\n    if (startsWithUTF8BOM(firstLine)) {\n        firstLine = firstLine.substr(1);\n    }\n    if (firstLine.length > 0) {\n        // We want to prioritize associations based on the order they are registered so that the last registered\n        // association wins over all other. This is for https://github.com/microsoft/vscode/issues/20074\n        for (let i = registeredAssociations.length - 1; i >= 0; i--) {\n            const association = registeredAssociations[i];\n            if (!association.firstline) {\n                continue;\n            }\n            const matches = firstLine.match(association.firstline);\n            if (matches && matches.length > 0) {\n                return association;\n            }\n        }\n    }\n    return undefined;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { regExpLeadsToEndlessLoop } from '../../../base/common/strings.js';\nimport { clearPlatformLanguageAssociations, getLanguageIds, registerPlatformLanguageAssociation } from './languagesAssociations.js';\nimport { ModesRegistry, PLAINTEXT_LANGUAGE_ID } from '../languages/modesRegistry.js';\nimport { Extensions } from '../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../platform/registry/common/platform.js';\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst NULL_LANGUAGE_ID = 'vs.editor.nullLanguage';\nexport class LanguageIdCodec {\n    constructor() {\n        this._languageIdToLanguage = [];\n        this._languageToLanguageId = new Map();\n        this._register(NULL_LANGUAGE_ID, 0 /* LanguageId.Null */);\n        this._register(PLAINTEXT_LANGUAGE_ID, 1 /* LanguageId.PlainText */);\n        this._nextLanguageId = 2;\n    }\n    _register(language, languageId) {\n        this._languageIdToLanguage[languageId] = language;\n        this._languageToLanguageId.set(language, languageId);\n    }\n    register(language) {\n        if (this._languageToLanguageId.has(language)) {\n            return;\n        }\n        const languageId = this._nextLanguageId++;\n        this._register(language, languageId);\n    }\n    encodeLanguageId(languageId) {\n        return this._languageToLanguageId.get(languageId) || 0 /* LanguageId.Null */;\n    }\n    decodeLanguageId(languageId) {\n        return this._languageIdToLanguage[languageId] || NULL_LANGUAGE_ID;\n    }\n}\nexport class LanguagesRegistry extends Disposable {\n    constructor(useModesRegistry = true, warnOnOverwrite = false) {\n        super();\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        LanguagesRegistry.instanceCount++;\n        this._warnOnOverwrite = warnOnOverwrite;\n        this.languageIdCodec = new LanguageIdCodec();\n        this._dynamicLanguages = [];\n        this._languages = {};\n        this._mimeTypesMap = {};\n        this._nameMap = {};\n        this._lowercaseNameMap = {};\n        if (useModesRegistry) {\n            this._initializeFromRegistry();\n            this._register(ModesRegistry.onDidChangeLanguages((m) => {\n                this._initializeFromRegistry();\n            }));\n        }\n    }\n    dispose() {\n        LanguagesRegistry.instanceCount--;\n        super.dispose();\n    }\n    _initializeFromRegistry() {\n        this._languages = {};\n        this._mimeTypesMap = {};\n        this._nameMap = {};\n        this._lowercaseNameMap = {};\n        clearPlatformLanguageAssociations();\n        const desc = [].concat(ModesRegistry.getLanguages()).concat(this._dynamicLanguages);\n        this._registerLanguages(desc);\n    }\n    _registerLanguages(desc) {\n        for (const d of desc) {\n            this._registerLanguage(d);\n        }\n        // Rebuild fast path maps\n        this._mimeTypesMap = {};\n        this._nameMap = {};\n        this._lowercaseNameMap = {};\n        Object.keys(this._languages).forEach((langId) => {\n            const language = this._languages[langId];\n            if (language.name) {\n                this._nameMap[language.name] = language.identifier;\n            }\n            language.aliases.forEach((alias) => {\n                this._lowercaseNameMap[alias.toLowerCase()] = language.identifier;\n            });\n            language.mimetypes.forEach((mimetype) => {\n                this._mimeTypesMap[mimetype] = language.identifier;\n            });\n        });\n        Registry.as(Extensions.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds());\n        this._onDidChange.fire();\n    }\n    _registerLanguage(lang) {\n        const langId = lang.id;\n        let resolvedLanguage;\n        if (hasOwnProperty.call(this._languages, langId)) {\n            resolvedLanguage = this._languages[langId];\n        }\n        else {\n            this.languageIdCodec.register(langId);\n            resolvedLanguage = {\n                identifier: langId,\n                name: null,\n                mimetypes: [],\n                aliases: [],\n                extensions: [],\n                filenames: [],\n                configurationFiles: [],\n                icons: []\n            };\n            this._languages[langId] = resolvedLanguage;\n        }\n        this._mergeLanguage(resolvedLanguage, lang);\n    }\n    _mergeLanguage(resolvedLanguage, lang) {\n        const langId = lang.id;\n        let primaryMime = null;\n        if (Array.isArray(lang.mimetypes) && lang.mimetypes.length > 0) {\n            resolvedLanguage.mimetypes.push(...lang.mimetypes);\n            primaryMime = lang.mimetypes[0];\n        }\n        if (!primaryMime) {\n            primaryMime = `text/x-${langId}`;\n            resolvedLanguage.mimetypes.push(primaryMime);\n        }\n        if (Array.isArray(lang.extensions)) {\n            if (lang.configuration) {\n                // insert first as this appears to be the 'primary' language definition\n                resolvedLanguage.extensions = lang.extensions.concat(resolvedLanguage.extensions);\n            }\n            else {\n                resolvedLanguage.extensions = resolvedLanguage.extensions.concat(lang.extensions);\n            }\n            for (const extension of lang.extensions) {\n                registerPlatformLanguageAssociation({ id: langId, mime: primaryMime, extension: extension }, this._warnOnOverwrite);\n            }\n        }\n        if (Array.isArray(lang.filenames)) {\n            for (const filename of lang.filenames) {\n                registerPlatformLanguageAssociation({ id: langId, mime: primaryMime, filename: filename }, this._warnOnOverwrite);\n                resolvedLanguage.filenames.push(filename);\n            }\n        }\n        if (Array.isArray(lang.filenamePatterns)) {\n            for (const filenamePattern of lang.filenamePatterns) {\n                registerPlatformLanguageAssociation({ id: langId, mime: primaryMime, filepattern: filenamePattern }, this._warnOnOverwrite);\n            }\n        }\n        if (typeof lang.firstLine === 'string' && lang.firstLine.length > 0) {\n            let firstLineRegexStr = lang.firstLine;\n            if (firstLineRegexStr.charAt(0) !== '^') {\n                firstLineRegexStr = '^' + firstLineRegexStr;\n            }\n            try {\n                const firstLineRegex = new RegExp(firstLineRegexStr);\n                if (!regExpLeadsToEndlessLoop(firstLineRegex)) {\n                    registerPlatformLanguageAssociation({ id: langId, mime: primaryMime, firstline: firstLineRegex }, this._warnOnOverwrite);\n                }\n            }\n            catch (err) {\n                // Most likely, the regex was bad\n                onUnexpectedError(err);\n            }\n        }\n        resolvedLanguage.aliases.push(langId);\n        let langAliases = null;\n        if (typeof lang.aliases !== 'undefined' && Array.isArray(lang.aliases)) {\n            if (lang.aliases.length === 0) {\n                // signal that this language should not get a name\n                langAliases = [null];\n            }\n            else {\n                langAliases = lang.aliases;\n            }\n        }\n        if (langAliases !== null) {\n            for (const langAlias of langAliases) {\n                if (!langAlias || langAlias.length === 0) {\n                    continue;\n                }\n                resolvedLanguage.aliases.push(langAlias);\n            }\n        }\n        const containsAliases = (langAliases !== null && langAliases.length > 0);\n        if (containsAliases && langAliases[0] === null) {\n            // signal that this language should not get a name\n        }\n        else {\n            const bestName = (containsAliases ? langAliases[0] : null) || langId;\n            if (containsAliases || !resolvedLanguage.name) {\n                resolvedLanguage.name = bestName;\n            }\n        }\n        if (lang.configuration) {\n            resolvedLanguage.configurationFiles.push(lang.configuration);\n        }\n        if (lang.icon) {\n            resolvedLanguage.icons.push(lang.icon);\n        }\n    }\n    isRegisteredLanguageId(languageId) {\n        if (!languageId) {\n            return false;\n        }\n        return hasOwnProperty.call(this._languages, languageId);\n    }\n    getRegisteredLanguageIds() {\n        return Object.keys(this._languages);\n    }\n    getLanguageIdByLanguageName(languageName) {\n        const languageNameLower = languageName.toLowerCase();\n        if (!hasOwnProperty.call(this._lowercaseNameMap, languageNameLower)) {\n            return null;\n        }\n        return this._lowercaseNameMap[languageNameLower];\n    }\n    getLanguageIdByMimeType(mimeType) {\n        if (!mimeType) {\n            return null;\n        }\n        if (hasOwnProperty.call(this._mimeTypesMap, mimeType)) {\n            return this._mimeTypesMap[mimeType];\n        }\n        return null;\n    }\n    guessLanguageIdByFilepathOrFirstLine(resource, firstLine) {\n        if (!resource && !firstLine) {\n            return [];\n        }\n        return getLanguageIds(resource, firstLine);\n    }\n}\nLanguagesRegistry.instanceCount = 0;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { LanguagesRegistry } from './languagesRegistry.js';\nimport { firstOrDefault } from '../../../base/common/arrays.js';\nimport { TokenizationRegistry } from '../languages.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../languages/modesRegistry.js';\nexport class LanguageService extends Disposable {\n    constructor(warnOnOverwrite = false) {\n        super();\n        this._onDidEncounterLanguage = this._register(new Emitter());\n        this.onDidEncounterLanguage = this._onDidEncounterLanguage.event;\n        this._onDidChange = this._register(new Emitter({ leakWarningThreshold: 200 /* https://github.com/microsoft/vscode/issues/119968 */ }));\n        this.onDidChange = this._onDidChange.event;\n        LanguageService.instanceCount++;\n        this._encounteredLanguages = new Set();\n        this._registry = this._register(new LanguagesRegistry(true, warnOnOverwrite));\n        this.languageIdCodec = this._registry.languageIdCodec;\n        this._register(this._registry.onDidChange(() => this._onDidChange.fire()));\n    }\n    dispose() {\n        LanguageService.instanceCount--;\n        super.dispose();\n    }\n    isRegisteredLanguageId(languageId) {\n        return this._registry.isRegisteredLanguageId(languageId);\n    }\n    getLanguageIdByLanguageName(languageName) {\n        return this._registry.getLanguageIdByLanguageName(languageName);\n    }\n    getLanguageIdByMimeType(mimeType) {\n        return this._registry.getLanguageIdByMimeType(mimeType);\n    }\n    guessLanguageIdByFilepathOrFirstLine(resource, firstLine) {\n        const languageIds = this._registry.guessLanguageIdByFilepathOrFirstLine(resource, firstLine);\n        return firstOrDefault(languageIds, null);\n    }\n    createById(languageId) {\n        return new LanguageSelection(this.onDidChange, () => {\n            return this._createAndGetLanguageIdentifier(languageId);\n        });\n    }\n    createByFilepathOrFirstLine(resource, firstLine) {\n        return new LanguageSelection(this.onDidChange, () => {\n            const languageId = this.guessLanguageIdByFilepathOrFirstLine(resource, firstLine);\n            return this._createAndGetLanguageIdentifier(languageId);\n        });\n    }\n    _createAndGetLanguageIdentifier(languageId) {\n        if (!languageId || !this.isRegisteredLanguageId(languageId)) {\n            // Fall back to plain text if language is unknown\n            languageId = PLAINTEXT_LANGUAGE_ID;\n        }\n        if (!this._encounteredLanguages.has(languageId)) {\n            this._encounteredLanguages.add(languageId);\n            // Ensure tokenizers are created\n            TokenizationRegistry.getOrCreate(languageId);\n            // Fire event\n            this._onDidEncounterLanguage.fire(languageId);\n        }\n        return languageId;\n    }\n}\nLanguageService.instanceCount = 0;\nclass LanguageSelection {\n    constructor(_onDidChangeLanguages, _selector) {\n        this._onDidChangeLanguages = _onDidChangeLanguages;\n        this._selector = _selector;\n        this._listener = null;\n        this._emitter = null;\n        this.languageId = this._selector();\n    }\n    _dispose() {\n        if (this._listener) {\n            this._listener.dispose();\n            this._listener = null;\n        }\n        if (this._emitter) {\n            this._emitter.dispose();\n            this._emitter = null;\n        }\n    }\n    get onDidChange() {\n        if (!this._listener) {\n            this._listener = this._onDidChangeLanguages(() => this._evaluate());\n        }\n        if (!this._emitter) {\n            this._emitter = new Emitter({\n                onLastListenerRemove: () => {\n                    this._dispose();\n                }\n            });\n        }\n        return this._emitter.event;\n    }\n    _evaluate() {\n        var _a;\n        const languageId = this._selector();\n        if (languageId === this.languageId) {\n            // no change\n            return;\n        }\n        this.languageId = languageId;\n        (_a = this._emitter) === null || _a === void 0 ? void 0 : _a.fire(this.languageId);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../common/codicons.js';\nimport './codicon/codicon.css';\nimport './codicon/codicon-modifiers.css';\nexport function formatRule(c) {\n    let def = c.definition;\n    while (def instanceof Codicon) {\n        def = def.definition;\n    }\n    return `.codicon-${c.id}:before { content: '${def.fontCharacter}'; }`;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isFirefox } from '../../browser.js';\nimport { EventType as TouchEventType, Gesture } from '../../touch.js';\nimport { $, addDisposableListener, append, clearNode, createStyleSheet, Dimension, EventHelper, EventType, getActiveElement, isAncestor, isInShadowDOM } from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { ActionBar } from '../actionbar/actionbar.js';\nimport { ActionViewItem, BaseActionViewItem } from '../actionbar/actionViewItems.js';\nimport { formatRule } from '../codicons/codiconStyles.js';\nimport { layout } from '../contextview/contextview.js';\nimport { DomScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { EmptySubmenuAction, Separator, SubmenuAction } from '../../../common/actions.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { stripIcons } from '../../../common/iconLabels.js';\nimport { DisposableStore } from '../../../common/lifecycle.js';\nimport { isLinux, isMacintosh } from '../../../common/platform.js';\nimport * as strings from '../../../common/strings.js';\nexport const MENU_MNEMONIC_REGEX = /\\(&([^\\s&])\\)|(^|[^&])&([^\\s&])/;\nexport const MENU_ESCAPED_MNEMONIC_REGEX = /(&amp;)?(&amp;)([^\\s&])/g;\nexport var Direction;\n(function (Direction) {\n    Direction[Direction[\"Right\"] = 0] = \"Right\";\n    Direction[Direction[\"Left\"] = 1] = \"Left\";\n})(Direction || (Direction = {}));\nexport class Menu extends ActionBar {\n    constructor(container, actions, options = {}) {\n        container.classList.add('monaco-menu-container');\n        container.setAttribute('role', 'presentation');\n        const menuElement = document.createElement('div');\n        menuElement.classList.add('monaco-menu');\n        menuElement.setAttribute('role', 'presentation');\n        super(menuElement, {\n            orientation: 1 /* ActionsOrientation.VERTICAL */,\n            actionViewItemProvider: action => this.doGetActionViewItem(action, options, parentData),\n            context: options.context,\n            actionRunner: options.actionRunner,\n            ariaLabel: options.ariaLabel,\n            ariaRole: 'menu',\n            focusOnlyEnabledItems: true,\n            triggerKeys: { keys: [3 /* KeyCode.Enter */, ...(isMacintosh || isLinux ? [10 /* KeyCode.Space */] : [])], keyDown: true }\n        });\n        this.menuElement = menuElement;\n        this.actionsList.tabIndex = 0;\n        this.menuDisposables = this._register(new DisposableStore());\n        this.initializeOrUpdateStyleSheet(container, {});\n        this._register(Gesture.addTarget(menuElement));\n        addDisposableListener(menuElement, EventType.KEY_DOWN, (e) => {\n            const event = new StandardKeyboardEvent(e);\n            // Stop tab navigation of menus\n            if (event.equals(2 /* KeyCode.Tab */)) {\n                e.preventDefault();\n            }\n        });\n        if (options.enableMnemonics) {\n            this.menuDisposables.add(addDisposableListener(menuElement, EventType.KEY_DOWN, (e) => {\n                const key = e.key.toLocaleLowerCase();\n                if (this.mnemonics.has(key)) {\n                    EventHelper.stop(e, true);\n                    const actions = this.mnemonics.get(key);\n                    if (actions.length === 1) {\n                        if (actions[0] instanceof SubmenuMenuActionViewItem && actions[0].container) {\n                            this.focusItemByElement(actions[0].container);\n                        }\n                        actions[0].onClick(e);\n                    }\n                    if (actions.length > 1) {\n                        const action = actions.shift();\n                        if (action && action.container) {\n                            this.focusItemByElement(action.container);\n                            actions.push(action);\n                        }\n                        this.mnemonics.set(key, actions);\n                    }\n                }\n            }));\n        }\n        if (isLinux) {\n            this._register(addDisposableListener(menuElement, EventType.KEY_DOWN, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(14 /* KeyCode.Home */) || event.equals(11 /* KeyCode.PageUp */)) {\n                    this.focusedItem = this.viewItems.length - 1;\n                    this.focusNext();\n                    EventHelper.stop(e, true);\n                }\n                else if (event.equals(13 /* KeyCode.End */) || event.equals(12 /* KeyCode.PageDown */)) {\n                    this.focusedItem = 0;\n                    this.focusPrevious();\n                    EventHelper.stop(e, true);\n                }\n            }));\n        }\n        this._register(addDisposableListener(this.domNode, EventType.MOUSE_OUT, e => {\n            const relatedTarget = e.relatedTarget;\n            if (!isAncestor(relatedTarget, this.domNode)) {\n                this.focusedItem = undefined;\n                this.updateFocus();\n                e.stopPropagation();\n            }\n        }));\n        this._register(addDisposableListener(this.actionsList, EventType.MOUSE_OVER, e => {\n            let target = e.target;\n            if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n                return;\n            }\n            while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n                target = target.parentElement;\n            }\n            if (target.classList.contains('action-item')) {\n                const lastFocusedItem = this.focusedItem;\n                this.setFocusedItem(target);\n                if (lastFocusedItem !== this.focusedItem) {\n                    this.updateFocus();\n                }\n            }\n        }));\n        // Support touch on actions list to focus items (needed for submenus)\n        this._register(Gesture.addTarget(this.actionsList));\n        this._register(addDisposableListener(this.actionsList, TouchEventType.Tap, e => {\n            let target = e.initialTarget;\n            if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n                return;\n            }\n            while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n                target = target.parentElement;\n            }\n            if (target.classList.contains('action-item')) {\n                const lastFocusedItem = this.focusedItem;\n                this.setFocusedItem(target);\n                if (lastFocusedItem !== this.focusedItem) {\n                    this.updateFocus();\n                }\n            }\n        }));\n        const parentData = {\n            parent: this\n        };\n        this.mnemonics = new Map();\n        // Scroll Logic\n        this.scrollableElement = this._register(new DomScrollableElement(menuElement, {\n            alwaysConsumeMouseWheel: true,\n            horizontal: 2 /* ScrollbarVisibility.Hidden */,\n            vertical: 3 /* ScrollbarVisibility.Visible */,\n            verticalScrollbarSize: 7,\n            handleMouseWheel: true,\n            useShadows: true\n        }));\n        const scrollElement = this.scrollableElement.getDomNode();\n        scrollElement.style.position = '';\n        // Support scroll on menu drag\n        this._register(addDisposableListener(menuElement, TouchEventType.Change, e => {\n            EventHelper.stop(e, true);\n            const scrollTop = this.scrollableElement.getScrollPosition().scrollTop;\n            this.scrollableElement.setScrollPosition({ scrollTop: scrollTop - e.translationY });\n        }));\n        this._register(addDisposableListener(scrollElement, EventType.MOUSE_UP, e => {\n            // Absorb clicks in menu dead space https://github.com/microsoft/vscode/issues/63575\n            // We do this on the scroll element so the scroll bar doesn't dismiss the menu either\n            e.preventDefault();\n        }));\n        menuElement.style.maxHeight = `${Math.max(10, window.innerHeight - container.getBoundingClientRect().top - 35)}px`;\n        actions = actions.filter(a => {\n            var _a;\n            if ((_a = options.submenuIds) === null || _a === void 0 ? void 0 : _a.has(a.id)) {\n                console.warn(`Found submenu cycle: ${a.id}`);\n                return false;\n            }\n            return true;\n        });\n        this.push(actions, { icon: true, label: true, isMenu: true });\n        container.appendChild(this.scrollableElement.getDomNode());\n        this.scrollableElement.scanDomNode();\n        this.viewItems.filter(item => !(item instanceof MenuSeparatorActionViewItem)).forEach((item, index, array) => {\n            item.updatePositionInSet(index + 1, array.length);\n        });\n    }\n    initializeOrUpdateStyleSheet(container, style) {\n        if (!this.styleSheet) {\n            if (isInShadowDOM(container)) {\n                this.styleSheet = createStyleSheet(container);\n            }\n            else {\n                if (!Menu.globalStyleSheet) {\n                    Menu.globalStyleSheet = createStyleSheet();\n                }\n                this.styleSheet = Menu.globalStyleSheet;\n            }\n        }\n        this.styleSheet.textContent = getMenuWidgetCSS(style, isInShadowDOM(container));\n    }\n    style(style) {\n        const container = this.getContainer();\n        this.initializeOrUpdateStyleSheet(container, style);\n        const fgColor = style.foregroundColor ? `${style.foregroundColor}` : '';\n        const bgColor = style.backgroundColor ? `${style.backgroundColor}` : '';\n        const border = style.borderColor ? `1px solid ${style.borderColor}` : '';\n        const borderRadius = '5px';\n        const shadow = style.shadowColor ? `0 2px 8px ${style.shadowColor}` : '';\n        container.style.outline = border;\n        container.style.borderRadius = borderRadius;\n        container.style.color = fgColor;\n        container.style.backgroundColor = bgColor;\n        container.style.boxShadow = shadow;\n        if (this.viewItems) {\n            this.viewItems.forEach(item => {\n                if (item instanceof BaseMenuActionViewItem || item instanceof MenuSeparatorActionViewItem) {\n                    item.style(style);\n                }\n            });\n        }\n    }\n    getContainer() {\n        return this.scrollableElement.getDomNode();\n    }\n    get onScroll() {\n        return this.scrollableElement.onScroll;\n    }\n    focusItemByElement(element) {\n        const lastFocusedItem = this.focusedItem;\n        this.setFocusedItem(element);\n        if (lastFocusedItem !== this.focusedItem) {\n            this.updateFocus();\n        }\n    }\n    setFocusedItem(element) {\n        for (let i = 0; i < this.actionsList.children.length; i++) {\n            const elem = this.actionsList.children[i];\n            if (element === elem) {\n                this.focusedItem = i;\n                break;\n            }\n        }\n    }\n    updateFocus(fromRight) {\n        super.updateFocus(fromRight, true, true);\n        if (typeof this.focusedItem !== 'undefined') {\n            // Workaround for #80047 caused by an issue in chromium\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=414283\n            // When that's fixed, just call this.scrollableElement.scanDomNode()\n            this.scrollableElement.setScrollPosition({\n                scrollTop: Math.round(this.menuElement.scrollTop)\n            });\n        }\n    }\n    doGetActionViewItem(action, options, parentData) {\n        if (action instanceof Separator) {\n            return new MenuSeparatorActionViewItem(options.context, action, { icon: true });\n        }\n        else if (action instanceof SubmenuAction) {\n            const menuActionViewItem = new SubmenuMenuActionViewItem(action, action.actions, parentData, Object.assign(Object.assign({}, options), { submenuIds: new Set([...(options.submenuIds || []), action.id]) }));\n            if (options.enableMnemonics) {\n                const mnemonic = menuActionViewItem.getMnemonic();\n                if (mnemonic && menuActionViewItem.isEnabled()) {\n                    let actionViewItems = [];\n                    if (this.mnemonics.has(mnemonic)) {\n                        actionViewItems = this.mnemonics.get(mnemonic);\n                    }\n                    actionViewItems.push(menuActionViewItem);\n                    this.mnemonics.set(mnemonic, actionViewItems);\n                }\n            }\n            return menuActionViewItem;\n        }\n        else {\n            const menuItemOptions = { enableMnemonics: options.enableMnemonics, useEventAsContext: options.useEventAsContext };\n            if (options.getKeyBinding) {\n                const keybinding = options.getKeyBinding(action);\n                if (keybinding) {\n                    const keybindingLabel = keybinding.getLabel();\n                    if (keybindingLabel) {\n                        menuItemOptions.keybinding = keybindingLabel;\n                    }\n                }\n            }\n            const menuActionViewItem = new BaseMenuActionViewItem(options.context, action, menuItemOptions);\n            if (options.enableMnemonics) {\n                const mnemonic = menuActionViewItem.getMnemonic();\n                if (mnemonic && menuActionViewItem.isEnabled()) {\n                    let actionViewItems = [];\n                    if (this.mnemonics.has(mnemonic)) {\n                        actionViewItems = this.mnemonics.get(mnemonic);\n                    }\n                    actionViewItems.push(menuActionViewItem);\n                    this.mnemonics.set(mnemonic, actionViewItems);\n                }\n            }\n            return menuActionViewItem;\n        }\n    }\n}\nclass BaseMenuActionViewItem extends BaseActionViewItem {\n    constructor(ctx, action, options = {}) {\n        options.isMenu = true;\n        super(action, action, options);\n        this.options = options;\n        this.options.icon = options.icon !== undefined ? options.icon : false;\n        this.options.label = options.label !== undefined ? options.label : true;\n        this.cssClass = '';\n        // Set mnemonic\n        if (this.options.label && options.enableMnemonics) {\n            const label = this.getAction().label;\n            if (label) {\n                const matches = MENU_MNEMONIC_REGEX.exec(label);\n                if (matches) {\n                    this.mnemonic = (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase();\n                }\n            }\n        }\n        // Add mouse up listener later to avoid accidental clicks\n        this.runOnceToEnableMouseUp = new RunOnceScheduler(() => {\n            if (!this.element) {\n                return;\n            }\n            this._register(addDisposableListener(this.element, EventType.MOUSE_UP, e => {\n                // removed default prevention as it conflicts\n                // with BaseActionViewItem #101537\n                // add back if issues arise and link new issue\n                EventHelper.stop(e, true);\n                // See https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Interact_with_the_clipboard\n                // > Writing to the clipboard\n                // > You can use the \"cut\" and \"copy\" commands without any special\n                // permission if you are using them in a short-lived event handler\n                // for a user action (for example, a click handler).\n                // => to get the Copy and Paste context menu actions working on Firefox,\n                // there should be no timeout here\n                if (isFirefox) {\n                    const mouseEvent = new StandardMouseEvent(e);\n                    // Allowing right click to trigger the event causes the issue described below,\n                    // but since the solution below does not work in FF, we must disable right click\n                    if (mouseEvent.rightButton) {\n                        return;\n                    }\n                    this.onClick(e);\n                }\n                // In all other cases, set timeout to allow context menu cancellation to trigger\n                // otherwise the action will destroy the menu and a second context menu\n                // will still trigger for right click.\n                else {\n                    setTimeout(() => {\n                        this.onClick(e);\n                    }, 0);\n                }\n            }));\n            this._register(addDisposableListener(this.element, EventType.CONTEXT_MENU, e => {\n                EventHelper.stop(e, true);\n            }));\n        }, 100);\n        this._register(this.runOnceToEnableMouseUp);\n    }\n    render(container) {\n        super.render(container);\n        if (!this.element) {\n            return;\n        }\n        this.container = container;\n        this.item = append(this.element, $('a.action-menu-item'));\n        if (this._action.id === Separator.ID) {\n            // A separator is a presentation item\n            this.item.setAttribute('role', 'presentation');\n        }\n        else {\n            this.item.setAttribute('role', 'menuitem');\n            if (this.mnemonic) {\n                this.item.setAttribute('aria-keyshortcuts', `${this.mnemonic}`);\n            }\n        }\n        this.check = append(this.item, $('span.menu-item-check' + Codicon.menuSelection.cssSelector));\n        this.check.setAttribute('role', 'none');\n        this.label = append(this.item, $('span.action-label'));\n        if (this.options.label && this.options.keybinding) {\n            append(this.item, $('span.keybinding')).textContent = this.options.keybinding;\n        }\n        // Adds mouse up listener to actually run the action\n        this.runOnceToEnableMouseUp.schedule();\n        this.updateClass();\n        this.updateLabel();\n        this.updateTooltip();\n        this.updateEnabled();\n        this.updateChecked();\n    }\n    blur() {\n        super.blur();\n        this.applyStyle();\n    }\n    focus() {\n        super.focus();\n        if (this.item) {\n            this.item.focus();\n        }\n        this.applyStyle();\n    }\n    updatePositionInSet(pos, setSize) {\n        if (this.item) {\n            this.item.setAttribute('aria-posinset', `${pos}`);\n            this.item.setAttribute('aria-setsize', `${setSize}`);\n        }\n    }\n    updateLabel() {\n        var _a;\n        if (!this.label) {\n            return;\n        }\n        if (this.options.label) {\n            clearNode(this.label);\n            let label = stripIcons(this.getAction().label);\n            if (label) {\n                const cleanLabel = cleanMnemonic(label);\n                if (!this.options.enableMnemonics) {\n                    label = cleanLabel;\n                }\n                this.label.setAttribute('aria-label', cleanLabel.replace(/&&/g, '&'));\n                const matches = MENU_MNEMONIC_REGEX.exec(label);\n                if (matches) {\n                    label = strings.escape(label);\n                    // This is global, reset it\n                    MENU_ESCAPED_MNEMONIC_REGEX.lastIndex = 0;\n                    let escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n                    // We can't use negative lookbehind so if we match our negative and skip\n                    while (escMatch && escMatch[1]) {\n                        escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n                    }\n                    const replaceDoubleEscapes = (str) => str.replace(/&amp;&amp;/g, '&amp;');\n                    if (escMatch) {\n                        this.label.append(strings.ltrim(replaceDoubleEscapes(label.substr(0, escMatch.index)), ' '), $('u', { 'aria-hidden': 'true' }, escMatch[3]), strings.rtrim(replaceDoubleEscapes(label.substr(escMatch.index + escMatch[0].length)), ' '));\n                    }\n                    else {\n                        this.label.innerText = replaceDoubleEscapes(label).trim();\n                    }\n                    (_a = this.item) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-keyshortcuts', (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase());\n                }\n                else {\n                    this.label.innerText = label.replace(/&&/g, '&').trim();\n                }\n            }\n        }\n    }\n    updateTooltip() {\n        // menus should function like native menus and they do not have tooltips\n    }\n    updateClass() {\n        if (this.cssClass && this.item) {\n            this.item.classList.remove(...this.cssClass.split(' '));\n        }\n        if (this.options.icon && this.label) {\n            this.cssClass = this.getAction().class || '';\n            this.label.classList.add('icon');\n            if (this.cssClass) {\n                this.label.classList.add(...this.cssClass.split(' '));\n            }\n            this.updateEnabled();\n        }\n        else if (this.label) {\n            this.label.classList.remove('icon');\n        }\n    }\n    updateEnabled() {\n        if (this.getAction().enabled) {\n            if (this.element) {\n                this.element.classList.remove('disabled');\n                this.element.removeAttribute('aria-disabled');\n            }\n            if (this.item) {\n                this.item.classList.remove('disabled');\n                this.item.removeAttribute('aria-disabled');\n                this.item.tabIndex = 0;\n            }\n        }\n        else {\n            if (this.element) {\n                this.element.classList.add('disabled');\n                this.element.setAttribute('aria-disabled', 'true');\n            }\n            if (this.item) {\n                this.item.classList.add('disabled');\n                this.item.setAttribute('aria-disabled', 'true');\n            }\n        }\n    }\n    updateChecked() {\n        if (!this.item) {\n            return;\n        }\n        const checked = this.getAction().checked;\n        this.item.classList.toggle('checked', !!checked);\n        if (checked !== undefined) {\n            this.item.setAttribute('role', 'menuitemcheckbox');\n            this.item.setAttribute('aria-checked', checked ? 'true' : 'false');\n        }\n        else {\n            this.item.setAttribute('role', 'menuitem');\n            this.item.setAttribute('aria-checked', '');\n        }\n    }\n    getMnemonic() {\n        return this.mnemonic;\n    }\n    applyStyle() {\n        if (!this.menuStyle) {\n            return;\n        }\n        const isSelected = this.element && this.element.classList.contains('focused');\n        const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n        const bgColor = isSelected && this.menuStyle.selectionBackgroundColor ? this.menuStyle.selectionBackgroundColor : undefined;\n        const outline = isSelected && this.menuStyle.selectionBorderColor ? `1px solid ${this.menuStyle.selectionBorderColor}` : '';\n        const outlineOffset = isSelected && this.menuStyle.selectionBorderColor ? `-1px` : '';\n        if (this.item) {\n            this.item.style.color = fgColor ? fgColor.toString() : '';\n            this.item.style.backgroundColor = bgColor ? bgColor.toString() : '';\n            this.item.style.outline = outline;\n            this.item.style.outlineOffset = outlineOffset;\n        }\n        if (this.check) {\n            this.check.style.color = fgColor ? fgColor.toString() : '';\n        }\n    }\n    style(style) {\n        this.menuStyle = style;\n        this.applyStyle();\n    }\n}\nclass SubmenuMenuActionViewItem extends BaseMenuActionViewItem {\n    constructor(action, submenuActions, parentData, submenuOptions) {\n        super(action, action, submenuOptions);\n        this.submenuActions = submenuActions;\n        this.parentData = parentData;\n        this.submenuOptions = submenuOptions;\n        this.mysubmenu = null;\n        this.submenuDisposables = this._register(new DisposableStore());\n        this.mouseOver = false;\n        this.expandDirection = submenuOptions && submenuOptions.expandDirection !== undefined ? submenuOptions.expandDirection : Direction.Right;\n        this.showScheduler = new RunOnceScheduler(() => {\n            if (this.mouseOver) {\n                this.cleanupExistingSubmenu(false);\n                this.createSubmenu(false);\n            }\n        }, 250);\n        this.hideScheduler = new RunOnceScheduler(() => {\n            if (this.element && (!isAncestor(getActiveElement(), this.element) && this.parentData.submenu === this.mysubmenu)) {\n                this.parentData.parent.focus(false);\n                this.cleanupExistingSubmenu(true);\n            }\n        }, 750);\n    }\n    render(container) {\n        super.render(container);\n        if (!this.element) {\n            return;\n        }\n        if (this.item) {\n            this.item.classList.add('monaco-submenu-item');\n            this.item.tabIndex = 0;\n            this.item.setAttribute('aria-haspopup', 'true');\n            this.updateAriaExpanded('false');\n            this.submenuIndicator = append(this.item, $('span.submenu-indicator' + Codicon.menuSubmenu.cssSelector));\n            this.submenuIndicator.setAttribute('aria-hidden', 'true');\n        }\n        this._register(addDisposableListener(this.element, EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(17 /* KeyCode.RightArrow */) || event.equals(3 /* KeyCode.Enter */)) {\n                EventHelper.stop(e, true);\n                this.createSubmenu(true);\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.KEY_DOWN, e => {\n            const event = new StandardKeyboardEvent(e);\n            if (getActiveElement() === this.item) {\n                if (event.equals(17 /* KeyCode.RightArrow */) || event.equals(3 /* KeyCode.Enter */)) {\n                    EventHelper.stop(e, true);\n                }\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.MOUSE_OVER, e => {\n            if (!this.mouseOver) {\n                this.mouseOver = true;\n                this.showScheduler.schedule();\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.MOUSE_LEAVE, e => {\n            this.mouseOver = false;\n        }));\n        this._register(addDisposableListener(this.element, EventType.FOCUS_OUT, e => {\n            if (this.element && !isAncestor(getActiveElement(), this.element)) {\n                this.hideScheduler.schedule();\n            }\n        }));\n        this._register(this.parentData.parent.onScroll(() => {\n            if (this.parentData.submenu === this.mysubmenu) {\n                this.parentData.parent.focus(false);\n                this.cleanupExistingSubmenu(true);\n            }\n        }));\n    }\n    updateEnabled() {\n        // override on submenu entry\n        // native menus do not observe enablement on sumbenus\n        // we mimic that behavior\n    }\n    onClick(e) {\n        // stop clicking from trying to run an action\n        EventHelper.stop(e, true);\n        this.cleanupExistingSubmenu(false);\n        this.createSubmenu(true);\n    }\n    cleanupExistingSubmenu(force) {\n        if (this.parentData.submenu && (force || (this.parentData.submenu !== this.mysubmenu))) {\n            // disposal may throw if the submenu has already been removed\n            try {\n                this.parentData.submenu.dispose();\n            }\n            catch (_a) { }\n            this.parentData.submenu = undefined;\n            this.updateAriaExpanded('false');\n            if (this.submenuContainer) {\n                this.submenuDisposables.clear();\n                this.submenuContainer = undefined;\n            }\n        }\n    }\n    calculateSubmenuMenuLayout(windowDimensions, submenu, entry, expandDirection) {\n        const ret = { top: 0, left: 0 };\n        // Start with horizontal\n        ret.left = layout(windowDimensions.width, submenu.width, { position: expandDirection === Direction.Right ? 0 /* LayoutAnchorPosition.Before */ : 1 /* LayoutAnchorPosition.After */, offset: entry.left, size: entry.width });\n        // We don't have enough room to layout the menu fully, so we are overlapping the menu\n        if (ret.left >= entry.left && ret.left < entry.left + entry.width) {\n            if (entry.left + 10 + submenu.width <= windowDimensions.width) {\n                ret.left = entry.left + 10;\n            }\n            entry.top += 10;\n            entry.height = 0;\n        }\n        // Now that we have a horizontal position, try layout vertically\n        ret.top = layout(windowDimensions.height, submenu.height, { position: 0 /* LayoutAnchorPosition.Before */, offset: entry.top, size: 0 });\n        // We didn't have enough room below, but we did above, so we shift down to align the menu\n        if (ret.top + submenu.height === entry.top && ret.top + entry.height + submenu.height <= windowDimensions.height) {\n            ret.top += entry.height;\n        }\n        return ret;\n    }\n    createSubmenu(selectFirstItem = true) {\n        if (!this.element) {\n            return;\n        }\n        if (!this.parentData.submenu) {\n            this.updateAriaExpanded('true');\n            this.submenuContainer = append(this.element, $('div.monaco-submenu'));\n            this.submenuContainer.classList.add('menubar-menu-items-holder', 'context-view');\n            // Set the top value of the menu container before construction\n            // This allows the menu constructor to calculate the proper max height\n            const computedStyles = getComputedStyle(this.parentData.parent.domNode);\n            const paddingTop = parseFloat(computedStyles.paddingTop || '0') || 0;\n            // this.submenuContainer.style.top = `${this.element.offsetTop - this.parentData.parent.scrollOffset - paddingTop}px`;\n            this.submenuContainer.style.zIndex = '1';\n            this.submenuContainer.style.position = 'fixed';\n            this.submenuContainer.style.top = '0';\n            this.submenuContainer.style.left = '0';\n            this.parentData.submenu = new Menu(this.submenuContainer, this.submenuActions.length ? this.submenuActions : [new EmptySubmenuAction()], this.submenuOptions);\n            if (this.menuStyle) {\n                this.parentData.submenu.style(this.menuStyle);\n            }\n            // layout submenu\n            const entryBox = this.element.getBoundingClientRect();\n            const entryBoxUpdated = {\n                top: entryBox.top - paddingTop,\n                left: entryBox.left,\n                height: entryBox.height + 2 * paddingTop,\n                width: entryBox.width\n            };\n            const viewBox = this.submenuContainer.getBoundingClientRect();\n            const { top, left } = this.calculateSubmenuMenuLayout(new Dimension(window.innerWidth, window.innerHeight), Dimension.lift(viewBox), entryBoxUpdated, this.expandDirection);\n            // subtract offsets caused by transform parent\n            this.submenuContainer.style.left = `${left - viewBox.left}px`;\n            this.submenuContainer.style.top = `${top - viewBox.top}px`;\n            this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_UP, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                    EventHelper.stop(e, true);\n                    this.parentData.parent.focus();\n                    this.cleanupExistingSubmenu(true);\n                }\n            }));\n            this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_DOWN, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                    EventHelper.stop(e, true);\n                }\n            }));\n            this.submenuDisposables.add(this.parentData.submenu.onDidCancel(() => {\n                this.parentData.parent.focus();\n                this.cleanupExistingSubmenu(true);\n            }));\n            this.parentData.submenu.focus(selectFirstItem);\n            this.mysubmenu = this.parentData.submenu;\n        }\n        else {\n            this.parentData.submenu.focus(false);\n        }\n    }\n    updateAriaExpanded(value) {\n        var _a;\n        if (this.item) {\n            (_a = this.item) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-expanded', value);\n        }\n    }\n    applyStyle() {\n        var _a;\n        super.applyStyle();\n        if (!this.menuStyle) {\n            return;\n        }\n        const isSelected = this.element && this.element.classList.contains('focused');\n        const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n        if (this.submenuIndicator) {\n            this.submenuIndicator.style.color = fgColor ? `${fgColor}` : '';\n        }\n        (_a = this.parentData.submenu) === null || _a === void 0 ? void 0 : _a.style(this.menuStyle);\n    }\n    dispose() {\n        super.dispose();\n        this.hideScheduler.dispose();\n        if (this.mysubmenu) {\n            this.mysubmenu.dispose();\n            this.mysubmenu = null;\n        }\n        if (this.submenuContainer) {\n            this.submenuContainer = undefined;\n        }\n    }\n}\nclass MenuSeparatorActionViewItem extends ActionViewItem {\n    style(style) {\n        if (this.label) {\n            this.label.style.borderBottomColor = style.separatorColor ? `${style.separatorColor}` : '';\n        }\n    }\n}\nexport function cleanMnemonic(label) {\n    const regex = MENU_MNEMONIC_REGEX;\n    const matches = regex.exec(label);\n    if (!matches) {\n        return label;\n    }\n    const mnemonicInText = !matches[1];\n    return label.replace(regex, mnemonicInText ? '$2$3' : '').trim();\n}\nfunction getMenuWidgetCSS(style, isForShadowDom) {\n    let result = /* css */ `\n.monaco-menu {\n\tfont-size: 13px;\n\tborder-radius: 5px;\n\tmin-width: 160px;\n}\n\n${formatRule(Codicon.menuSelection)}\n${formatRule(Codicon.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\tcolor: var(--vscode-disabledForeground);\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid var(--vscode-menu-separatorBackground);\n\tpadding-top: 1px;\n\tpadding: 30px;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {\n\topacity: unset;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\twidth: 100%;\n\theight: 0px !important;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.hc-black .context-view.monaco-menu-container,\n.hc-light .context-view.monaco-menu-container,\n:host-context(.hc-black) .context-view.monaco-menu-container,\n:host-context(.hc-light) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .6em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tmargin: 5px 0 !important;\n\tpadding: 0;\n\tborder-radius: 0;\n}\n\n.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}`;\n    if (isForShadowDom) {\n        // Only define scrollbar styles when used inside shadow dom,\n        // otherwise leave their styling to the global workbench styling.\n        result += `\n\t\t\t/* Arrows */\n\t\t\t.monaco-scrollable-element > .scrollbar > .scra {\n\t\t\t\tcursor: pointer;\n\t\t\t\tfont-size: 11px !important;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .visible {\n\t\t\t\topacity: 1;\n\n\t\t\t\t/* Background rule added for IE9 - to allow clicks on dom node */\n\t\t\t\tbackground:rgba(0,0,0,0);\n\n\t\t\t\ttransition: opacity 100ms linear;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible {\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible.fade {\n\t\t\t\ttransition: opacity 800ms linear;\n\t\t\t}\n\n\t\t\t/* Scrollable Content Inset Shadow */\n\t\t\t.monaco-scrollable-element > .shadow {\n\t\t\t\tposition: absolute;\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 3px;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 3px;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 100%;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top-left-corner {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t`;\n        // Scrollbars\n        const scrollbarShadowColor = style.scrollbarShadow;\n        if (scrollbarShadowColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 0 6px 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 0 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 6px 6px -6px inset;\n\t\t\t\t}\n\t\t\t`;\n        }\n        const scrollbarSliderBackgroundColor = style.scrollbarSliderBackground;\n        if (scrollbarSliderBackgroundColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t\t}\n\t\t\t`;\n        }\n        const scrollbarSliderHoverBackgroundColor = style.scrollbarSliderHoverBackground;\n        if (scrollbarSliderHoverBackgroundColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t\t}\n\t\t\t`;\n        }\n        const scrollbarSliderActiveBackgroundColor = style.scrollbarSliderActiveBackground;\n        if (scrollbarSliderActiveBackgroundColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t\t}\n\t\t\t`;\n        }\n    }\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, addDisposableListener, EventType, isHTMLElement } from '../../../base/browser/dom.js';\nimport { StandardMouseEvent } from '../../../base/browser/mouseEvent.js';\nimport { Menu } from '../../../base/browser/ui/menu/menu.js';\nimport { ActionRunner } from '../../../base/common/actions.js';\nimport { isCancellationError } from '../../../base/common/errors.js';\nimport { combinedDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { attachMenuStyler } from '../../theme/common/styler.js';\nexport class ContextMenuHandler {\n    constructor(contextViewService, telemetryService, notificationService, keybindingService, themeService) {\n        this.contextViewService = contextViewService;\n        this.telemetryService = telemetryService;\n        this.notificationService = notificationService;\n        this.keybindingService = keybindingService;\n        this.themeService = themeService;\n        this.focusToReturn = null;\n        this.block = null;\n        this.options = { blockMouse: true };\n    }\n    configure(options) {\n        this.options = options;\n    }\n    showContextMenu(delegate) {\n        const actions = delegate.getActions();\n        if (!actions.length) {\n            return; // Don't render an empty context menu\n        }\n        this.focusToReturn = document.activeElement;\n        let menu;\n        const shadowRootElement = isHTMLElement(delegate.domForShadowRoot) ? delegate.domForShadowRoot : undefined;\n        this.contextViewService.showContextView({\n            getAnchor: () => delegate.getAnchor(),\n            canRelayout: false,\n            anchorAlignment: delegate.anchorAlignment,\n            anchorAxisAlignment: delegate.anchorAxisAlignment,\n            render: (container) => {\n                const className = delegate.getMenuClassName ? delegate.getMenuClassName() : '';\n                if (className) {\n                    container.className += ' ' + className;\n                }\n                // Render invisible div to block mouse interaction in the rest of the UI\n                if (this.options.blockMouse) {\n                    this.block = container.appendChild($('.context-view-block'));\n                    this.block.style.position = 'fixed';\n                    this.block.style.cursor = 'initial';\n                    this.block.style.left = '0';\n                    this.block.style.top = '0';\n                    this.block.style.width = '100%';\n                    this.block.style.height = '100%';\n                    this.block.style.zIndex = '-1';\n                    // TODO@Steven: this is never getting disposed\n                    addDisposableListener(this.block, EventType.MOUSE_DOWN, e => e.stopPropagation());\n                }\n                const menuDisposables = new DisposableStore();\n                const actionRunner = delegate.actionRunner || new ActionRunner();\n                actionRunner.onBeforeRun(this.onActionRun, this, menuDisposables);\n                actionRunner.onDidRun(this.onDidActionRun, this, menuDisposables);\n                menu = new Menu(container, actions, {\n                    actionViewItemProvider: delegate.getActionViewItem,\n                    context: delegate.getActionsContext ? delegate.getActionsContext() : null,\n                    actionRunner,\n                    getKeyBinding: delegate.getKeyBinding ? delegate.getKeyBinding : action => this.keybindingService.lookupKeybinding(action.id)\n                });\n                menuDisposables.add(attachMenuStyler(menu, this.themeService));\n                menu.onDidCancel(() => this.contextViewService.hideContextView(true), null, menuDisposables);\n                menu.onDidBlur(() => this.contextViewService.hideContextView(true), null, menuDisposables);\n                menuDisposables.add(addDisposableListener(window, EventType.BLUR, () => this.contextViewService.hideContextView(true)));\n                menuDisposables.add(addDisposableListener(window, EventType.MOUSE_DOWN, (e) => {\n                    if (e.defaultPrevented) {\n                        return;\n                    }\n                    const event = new StandardMouseEvent(e);\n                    let element = event.target;\n                    // Don't do anything as we are likely creating a context menu\n                    if (event.rightButton) {\n                        return;\n                    }\n                    while (element) {\n                        if (element === container) {\n                            return;\n                        }\n                        element = element.parentElement;\n                    }\n                    this.contextViewService.hideContextView(true);\n                }));\n                return combinedDisposable(menuDisposables, menu);\n            },\n            focus: () => {\n                menu === null || menu === void 0 ? void 0 : menu.focus(!!delegate.autoSelectFirstItem);\n            },\n            onHide: (didCancel) => {\n                var _a;\n                (_a = delegate.onHide) === null || _a === void 0 ? void 0 : _a.call(delegate, !!didCancel);\n                if (this.block) {\n                    this.block.remove();\n                    this.block = null;\n                }\n                if (this.focusToReturn) {\n                    this.focusToReturn.focus();\n                }\n            }\n        }, shadowRootElement, !!shadowRootElement);\n    }\n    onActionRun(e) {\n        this.telemetryService.publicLog2('workbenchActionExecuted', { id: e.action.id, from: 'contextMenu' });\n        this.contextViewService.hideContextView(false);\n        // Restore focus here\n        if (this.focusToReturn) {\n            this.focusToReturn.focus();\n        }\n    }\n    onDidActionRun(e) {\n        if (e.error && !isCancellationError(e.error)) {\n            this.notificationService.error(e.error);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { ModifierKeyEmitter } from '../../../base/browser/dom.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { INotificationService } from '../../notification/common/notification.js';\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\nimport { IThemeService } from '../../theme/common/themeService.js';\nimport { ContextMenuHandler } from './contextMenuHandler.js';\nimport { IContextViewService } from './contextView.js';\nlet ContextMenuService = class ContextMenuService extends Disposable {\n    constructor(telemetryService, notificationService, contextViewService, keybindingService, themeService) {\n        super();\n        this._onDidShowContextMenu = new Emitter();\n        this._onDidHideContextMenu = new Emitter();\n        this.contextMenuHandler = new ContextMenuHandler(contextViewService, telemetryService, notificationService, keybindingService, themeService);\n    }\n    configure(options) {\n        this.contextMenuHandler.configure(options);\n    }\n    // ContextMenu\n    showContextMenu(delegate) {\n        this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({}, delegate), { onHide: (didCancel) => {\n                var _a;\n                (_a = delegate.onHide) === null || _a === void 0 ? void 0 : _a.call(delegate, didCancel);\n                this._onDidHideContextMenu.fire();\n            } }));\n        ModifierKeyEmitter.getInstance().resetKeyStatus();\n        this._onDidShowContextMenu.fire();\n    }\n};\nContextMenuService = __decorate([\n    __param(0, ITelemetryService),\n    __param(1, INotificationService),\n    __param(2, IContextViewService),\n    __param(3, IKeybindingService),\n    __param(4, IThemeService)\n], ContextMenuService);\nexport { ContextMenuService };\n","export var EditorOpenSource;\n(function (EditorOpenSource) {\n    /**\n     * Default: the editor is opening via a programmatic call\n     * to the editor service API.\n     */\n    EditorOpenSource[EditorOpenSource[\"API\"] = 0] = \"API\";\n    /**\n     * Indicates that a user action triggered the opening, e.g.\n     * via mouse or keyboard use.\n     */\n    EditorOpenSource[EditorOpenSource[\"USER\"] = 1] = \"USER\";\n})(EditorOpenSource || (EditorOpenSource = {}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { normalizePath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from './codeEditorService.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { EditorOpenSource } from '../../../platform/editor/common/editor.js';\nimport { extractSelection, matchesScheme, matchesSomeScheme } from '../../../platform/opener/common/opener.js';\nlet CommandOpener = class CommandOpener {\n    constructor(_commandService) {\n        this._commandService = _commandService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!matchesScheme(target, Schemas.command)) {\n                return false;\n            }\n            if (!(options === null || options === void 0 ? void 0 : options.allowCommands)) {\n                // silently ignore commands when command-links are disabled, also\n                // surpress other openers by returning TRUE\n                return true;\n            }\n            // run command or bail out if command isn't known\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            // execute as command\n            let args = [];\n            try {\n                args = parse(decodeURIComponent(target.query));\n            }\n            catch (_a) {\n                // ignore and retry\n                try {\n                    args = parse(target.query);\n                }\n                catch (_b) {\n                    // ignore error\n                }\n            }\n            if (!Array.isArray(args)) {\n                args = [args];\n            }\n            yield this._commandService.executeCommand(target.path, ...args);\n            return true;\n        });\n    }\n};\nCommandOpener = __decorate([\n    __param(0, ICommandService)\n], CommandOpener);\nlet EditorOpener = class EditorOpener {\n    constructor(_editorService) {\n        this._editorService = _editorService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            const { selection, uri } = extractSelection(target);\n            target = uri;\n            if (target.scheme === Schemas.file) {\n                target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\n            }\n            yield this._editorService.openCodeEditor({\n                resource: target,\n                options: Object.assign({ selection, source: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenSource.USER : EditorOpenSource.API }, options === null || options === void 0 ? void 0 : options.editorOptions)\n            }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\n            return true;\n        });\n    }\n};\nEditorOpener = __decorate([\n    __param(0, ICodeEditorService)\n], EditorOpener);\nlet OpenerService = class OpenerService {\n    constructor(editorService, commandService) {\n        this._openers = new LinkedList();\n        this._validators = new LinkedList();\n        this._resolvers = new LinkedList();\n        this._resolvedUriTargets = new ResourceMap(uri => uri.with({ path: null, fragment: null, query: null }).toString());\n        this._externalOpeners = new LinkedList();\n        // Default external opener is going through window.open()\n        this._defaultExternalOpener = {\n            openExternal: (href) => __awaiter(this, void 0, void 0, function* () {\n                // ensure to open HTTP/HTTPS links into new windows\n                // to not trigger a navigation. Any other link is\n                // safe to be set as HREF to prevent a blank window\n                // from opening.\n                if (matchesSomeScheme(href, Schemas.http, Schemas.https)) {\n                    dom.windowOpenNoOpener(href);\n                }\n                else {\n                    window.location.href = href;\n                }\n                return true;\n            })\n        };\n        // Default opener: any external, maito, http(s), command, and catch-all-editors\n        this._openers.push({\n            open: (target, options) => __awaiter(this, void 0, void 0, function* () {\n                if ((options === null || options === void 0 ? void 0 : options.openExternal) || matchesSomeScheme(target, Schemas.mailto, Schemas.http, Schemas.https, Schemas.vsls)) {\n                    // open externally\n                    yield this._doOpenExternal(target, options);\n                    return true;\n                }\n                return false;\n            })\n        });\n        this._openers.push(new CommandOpener(commandService));\n        this._openers.push(new EditorOpener(editorService));\n    }\n    registerOpener(opener) {\n        const remove = this._openers.unshift(opener);\n        return { dispose: remove };\n    }\n    registerValidator(validator) {\n        const remove = this._validators.push(validator);\n        return { dispose: remove };\n    }\n    registerExternalUriResolver(resolver) {\n        const remove = this._resolvers.push(resolver);\n        return { dispose: remove };\n    }\n    setDefaultExternalOpener(externalOpener) {\n        this._defaultExternalOpener = externalOpener;\n    }\n    registerExternalOpener(opener) {\n        const remove = this._externalOpeners.push(opener);\n        return { dispose: remove };\n    }\n    open(target, options) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // check with contributed validators\n            const targetURI = typeof target === 'string' ? URI.parse(target) : target;\n            // validate against the original URI that this URI resolves to, if one exists\n            const validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\n            for (const validator of this._validators) {\n                if (!(yield validator.shouldOpen(validationTarget, options))) {\n                    return false;\n                }\n            }\n            // check with contributed openers\n            for (const opener of this._openers) {\n                const handled = yield opener.open(target, options);\n                if (handled) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    resolveExternalUri(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const resolver of this._resolvers) {\n                try {\n                    const result = yield resolver.resolveExternalUri(resource, options);\n                    if (result) {\n                        if (!this._resolvedUriTargets.has(result.resolved)) {\n                            this._resolvedUriTargets.set(result.resolved, resource);\n                        }\n                        return result;\n                    }\n                }\n                catch (_a) {\n                    // noop\n                }\n            }\n            throw new Error('Could not resolve external URI: ' + resource.toString());\n        });\n    }\n    _doOpenExternal(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            //todo@jrieken IExternalUriResolver should support `uri: URI | string`\n            const uri = typeof resource === 'string' ? URI.parse(resource) : resource;\n            let externalUri;\n            try {\n                externalUri = (yield this.resolveExternalUri(uri, options)).resolved;\n            }\n            catch (_a) {\n                externalUri = uri;\n            }\n            let href;\n            if (typeof resource === 'string' && uri.toString() === externalUri.toString()) {\n                // open the url-string AS IS\n                href = resource;\n            }\n            else {\n                // open URI using the toString(noEncode)+encodeURI-trick\n                href = encodeURI(externalUri.toString(true));\n            }\n            if (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) {\n                const preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\n                for (const opener of this._externalOpeners) {\n                    const didOpen = yield opener.openExternal(href, {\n                        sourceUri: uri,\n                        preferredOpenerId,\n                    }, CancellationToken.None);\n                    if (didOpen) {\n                        return true;\n                    }\n                }\n            }\n            return this._defaultExternalOpener.openExternal(href, { sourceUri: uri }, CancellationToken.None);\n        });\n    }\n    dispose() {\n        this._validators.clear();\n    }\n};\nOpenerService = __decorate([\n    __param(0, ICodeEditorService),\n    __param(1, ICommandService)\n], OpenerService);\nexport { OpenerService };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { OverviewRulerLane, MinimapPosition } from '../model.js';\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\nimport { overviewRulerWarning, overviewRulerInfo, overviewRulerError } from '../core/editorColorRegistry.js';\nimport { IModelService } from './model.js';\nimport { Range } from '../core/range.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { minimapWarning, minimapError } from '../../../platform/theme/common/colorRegistry.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nclass MarkerDecorations extends Disposable {\n    constructor(model) {\n        super();\n        this.model = model;\n        this._markersData = new Map();\n        this._register(toDisposable(() => {\n            this.model.deltaDecorations([...this._markersData.keys()], []);\n            this._markersData.clear();\n        }));\n    }\n    update(markers, newDecorations) {\n        const oldIds = [...this._markersData.keys()];\n        this._markersData.clear();\n        const ids = this.model.deltaDecorations(oldIds, newDecorations);\n        for (let index = 0; index < ids.length; index++) {\n            this._markersData.set(ids[index], markers[index]);\n        }\n        return oldIds.length !== 0 || ids.length !== 0;\n    }\n    getMarker(decoration) {\n        return this._markersData.get(decoration.id);\n    }\n}\nlet MarkerDecorationsService = class MarkerDecorationsService extends Disposable {\n    constructor(modelService, _markerService) {\n        super();\n        this._markerService = _markerService;\n        this._onDidChangeMarker = this._register(new Emitter());\n        this._markerDecorations = new ResourceMap();\n        modelService.getModels().forEach(model => this._onModelAdded(model));\n        this._register(modelService.onModelAdded(this._onModelAdded, this));\n        this._register(modelService.onModelRemoved(this._onModelRemoved, this));\n        this._register(this._markerService.onMarkerChanged(this._handleMarkerChange, this));\n    }\n    dispose() {\n        super.dispose();\n        this._markerDecorations.forEach(value => value.dispose());\n        this._markerDecorations.clear();\n    }\n    getMarker(uri, decoration) {\n        const markerDecorations = this._markerDecorations.get(uri);\n        return markerDecorations ? (markerDecorations.getMarker(decoration) || null) : null;\n    }\n    _handleMarkerChange(changedResources) {\n        changedResources.forEach((resource) => {\n            const markerDecorations = this._markerDecorations.get(resource);\n            if (markerDecorations) {\n                this._updateDecorations(markerDecorations);\n            }\n        });\n    }\n    _onModelAdded(model) {\n        const markerDecorations = new MarkerDecorations(model);\n        this._markerDecorations.set(model.uri, markerDecorations);\n        this._updateDecorations(markerDecorations);\n    }\n    _onModelRemoved(model) {\n        var _a;\n        const markerDecorations = this._markerDecorations.get(model.uri);\n        if (markerDecorations) {\n            markerDecorations.dispose();\n            this._markerDecorations.delete(model.uri);\n        }\n        // clean up markers for internal, transient models\n        if (model.uri.scheme === Schemas.inMemory\n            || model.uri.scheme === Schemas.internal\n            || model.uri.scheme === Schemas.vscode) {\n            (_a = this._markerService) === null || _a === void 0 ? void 0 : _a.read({ resource: model.uri }).map(marker => marker.owner).forEach(owner => this._markerService.remove(owner, [model.uri]));\n        }\n    }\n    _updateDecorations(markerDecorations) {\n        // Limit to the first 500 errors/warnings\n        const markers = this._markerService.read({ resource: markerDecorations.model.uri, take: 500 });\n        const newModelDecorations = markers.map((marker) => {\n            return {\n                range: this._createDecorationRange(markerDecorations.model, marker),\n                options: this._createDecorationOption(marker)\n            };\n        });\n        if (markerDecorations.update(markers, newModelDecorations)) {\n            this._onDidChangeMarker.fire(markerDecorations.model);\n        }\n    }\n    _createDecorationRange(model, rawMarker) {\n        let ret = Range.lift(rawMarker);\n        if (rawMarker.severity === MarkerSeverity.Hint && !this._hasMarkerTag(rawMarker, 1 /* MarkerTag.Unnecessary */) && !this._hasMarkerTag(rawMarker, 2 /* MarkerTag.Deprecated */)) {\n            // * never render hints on multiple lines\n            // * make enough space for three dots\n            ret = ret.setEndPosition(ret.startLineNumber, ret.startColumn + 2);\n        }\n        ret = model.validateRange(ret);\n        if (ret.isEmpty()) {\n            const maxColumn = model.getLineLastNonWhitespaceColumn(ret.startLineNumber) ||\n                model.getLineMaxColumn(ret.startLineNumber);\n            if (maxColumn === 1 || ret.endColumn >= maxColumn) {\n                // empty line or behind eol\n                // keep the range as is, it will be rendered 1ch wide\n                return ret;\n            }\n            const word = model.getWordAtPosition(ret.getStartPosition());\n            if (word) {\n                ret = new Range(ret.startLineNumber, word.startColumn, ret.endLineNumber, word.endColumn);\n            }\n        }\n        else if (rawMarker.endColumn === Number.MAX_VALUE && rawMarker.startColumn === 1 && ret.startLineNumber === ret.endLineNumber) {\n            const minColumn = model.getLineFirstNonWhitespaceColumn(rawMarker.startLineNumber);\n            if (minColumn < ret.endColumn) {\n                ret = new Range(ret.startLineNumber, minColumn, ret.endLineNumber, ret.endColumn);\n                rawMarker.startColumn = minColumn;\n            }\n        }\n        return ret;\n    }\n    _createDecorationOption(marker) {\n        let className;\n        let color = undefined;\n        let zIndex;\n        let inlineClassName = undefined;\n        let minimap;\n        switch (marker.severity) {\n            case MarkerSeverity.Hint:\n                if (this._hasMarkerTag(marker, 2 /* MarkerTag.Deprecated */)) {\n                    className = undefined;\n                }\n                else if (this._hasMarkerTag(marker, 1 /* MarkerTag.Unnecessary */)) {\n                    className = \"squiggly-unnecessary\" /* ClassName.EditorUnnecessaryDecoration */;\n                }\n                else {\n                    className = \"squiggly-hint\" /* ClassName.EditorHintDecoration */;\n                }\n                zIndex = 0;\n                break;\n            case MarkerSeverity.Warning:\n                className = \"squiggly-warning\" /* ClassName.EditorWarningDecoration */;\n                color = themeColorFromId(overviewRulerWarning);\n                zIndex = 20;\n                minimap = {\n                    color: themeColorFromId(minimapWarning),\n                    position: MinimapPosition.Inline\n                };\n                break;\n            case MarkerSeverity.Info:\n                className = \"squiggly-info\" /* ClassName.EditorInfoDecoration */;\n                color = themeColorFromId(overviewRulerInfo);\n                zIndex = 10;\n                break;\n            case MarkerSeverity.Error:\n            default:\n                className = \"squiggly-error\" /* ClassName.EditorErrorDecoration */;\n                color = themeColorFromId(overviewRulerError);\n                zIndex = 30;\n                minimap = {\n                    color: themeColorFromId(minimapError),\n                    position: MinimapPosition.Inline\n                };\n                break;\n        }\n        if (marker.tags) {\n            if (marker.tags.indexOf(1 /* MarkerTag.Unnecessary */) !== -1) {\n                inlineClassName = \"squiggly-inline-unnecessary\" /* ClassName.EditorUnnecessaryInlineDecoration */;\n            }\n            if (marker.tags.indexOf(2 /* MarkerTag.Deprecated */) !== -1) {\n                inlineClassName = \"squiggly-inline-deprecated\" /* ClassName.EditorDeprecatedInlineDecoration */;\n            }\n        }\n        return {\n            description: 'marker-decoration',\n            stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n            className,\n            showIfCollapsed: true,\n            overviewRuler: {\n                color,\n                position: OverviewRulerLane.Right\n            },\n            minimap,\n            zIndex,\n            inlineClassName,\n        };\n    }\n    _hasMarkerTag(marker, tag) {\n        if (marker.tags) {\n            return marker.tags.indexOf(tag) >= 0;\n        }\n        return false;\n    }\n};\nMarkerDecorationsService = __decorate([\n    __param(0, IModelService),\n    __param(1, IMarkerService)\n], MarkerDecorationsService);\nexport { MarkerDecorationsService };\n","import { addDisposableListener, EventHelper, EventType, reset, trackFocus } from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { EventType as TouchEventType, Gesture } from '../../touch.js';\nimport { renderLabelWithIcons } from '../iconLabel/iconLabels.js';\nimport { Color } from '../../../common/color.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable } from '../../../common/lifecycle.js';\nimport { mixin } from '../../../common/objects.js';\nimport './button.css';\nconst defaultOptions = {\n    buttonBackground: Color.fromHex('#0E639C'),\n    buttonHoverBackground: Color.fromHex('#006BB3'),\n    buttonSeparator: Color.white,\n    buttonForeground: Color.white\n};\nexport class Button extends Disposable {\n    constructor(container, options) {\n        super();\n        this._onDidClick = this._register(new Emitter());\n        this.options = options || Object.create(null);\n        mixin(this.options, defaultOptions, false);\n        this.buttonForeground = this.options.buttonForeground;\n        this.buttonBackground = this.options.buttonBackground;\n        this.buttonHoverBackground = this.options.buttonHoverBackground;\n        this.buttonSecondaryForeground = this.options.buttonSecondaryForeground;\n        this.buttonSecondaryBackground = this.options.buttonSecondaryBackground;\n        this.buttonSecondaryHoverBackground = this.options.buttonSecondaryHoverBackground;\n        this.buttonBorder = this.options.buttonBorder;\n        this._element = document.createElement('a');\n        this._element.classList.add('monaco-button');\n        this._element.tabIndex = 0;\n        this._element.setAttribute('role', 'button');\n        container.appendChild(this._element);\n        this._register(Gesture.addTarget(this._element));\n        [EventType.CLICK, TouchEventType.Tap].forEach(eventType => {\n            this._register(addDisposableListener(this._element, eventType, e => {\n                if (!this.enabled) {\n                    EventHelper.stop(e);\n                    return;\n                }\n                this._onDidClick.fire(e);\n            }));\n        });\n        this._register(addDisposableListener(this._element, EventType.KEY_DOWN, e => {\n            const event = new StandardKeyboardEvent(e);\n            let eventHandled = false;\n            if (this.enabled && (event.equals(3 /* KeyCode.Enter */) || event.equals(10 /* KeyCode.Space */))) {\n                this._onDidClick.fire(e);\n                eventHandled = true;\n            }\n            else if (event.equals(9 /* KeyCode.Escape */)) {\n                this._element.blur();\n                eventHandled = true;\n            }\n            if (eventHandled) {\n                EventHelper.stop(event, true);\n            }\n        }));\n        this._register(addDisposableListener(this._element, EventType.MOUSE_OVER, e => {\n            if (!this._element.classList.contains('disabled')) {\n                this.setHoverBackground();\n            }\n        }));\n        this._register(addDisposableListener(this._element, EventType.MOUSE_OUT, e => {\n            this.applyStyles(); // restore standard styles\n        }));\n        // Also set hover background when button is focused for feedback\n        this.focusTracker = this._register(trackFocus(this._element));\n        this._register(this.focusTracker.onDidFocus(() => { if (this.enabled) {\n            this.setHoverBackground();\n        } }));\n        this._register(this.focusTracker.onDidBlur(() => { if (this.enabled) {\n            this.applyStyles();\n        } }));\n        this.applyStyles();\n    }\n    get onDidClick() { return this._onDidClick.event; }\n    setHoverBackground() {\n        let hoverBackground;\n        if (this.options.secondary) {\n            hoverBackground = this.buttonSecondaryHoverBackground ? this.buttonSecondaryHoverBackground.toString() : null;\n        }\n        else {\n            hoverBackground = this.buttonHoverBackground ? this.buttonHoverBackground.toString() : null;\n        }\n        if (hoverBackground) {\n            this._element.style.backgroundColor = hoverBackground;\n        }\n    }\n    style(styles) {\n        this.buttonForeground = styles.buttonForeground;\n        this.buttonBackground = styles.buttonBackground;\n        this.buttonHoverBackground = styles.buttonHoverBackground;\n        this.buttonSecondaryForeground = styles.buttonSecondaryForeground;\n        this.buttonSecondaryBackground = styles.buttonSecondaryBackground;\n        this.buttonSecondaryHoverBackground = styles.buttonSecondaryHoverBackground;\n        this.buttonBorder = styles.buttonBorder;\n        this.applyStyles();\n    }\n    applyStyles() {\n        if (this._element) {\n            let background, foreground;\n            if (this.options.secondary) {\n                foreground = this.buttonSecondaryForeground ? this.buttonSecondaryForeground.toString() : '';\n                background = this.buttonSecondaryBackground ? this.buttonSecondaryBackground.toString() : '';\n            }\n            else {\n                foreground = this.buttonForeground ? this.buttonForeground.toString() : '';\n                background = this.buttonBackground ? this.buttonBackground.toString() : '';\n            }\n            const border = this.buttonBorder ? this.buttonBorder.toString() : '';\n            this._element.style.color = foreground;\n            this._element.style.backgroundColor = background;\n            this._element.style.borderWidth = border ? '1px' : '';\n            this._element.style.borderStyle = border ? 'solid' : '';\n            this._element.style.borderColor = border;\n        }\n    }\n    get element() {\n        return this._element;\n    }\n    set label(value) {\n        this._element.classList.add('monaco-text-button');\n        if (this.options.supportIcons) {\n            reset(this._element, ...renderLabelWithIcons(value));\n        }\n        else {\n            this._element.textContent = value;\n        }\n        if (typeof this.options.title === 'string') {\n            this._element.title = this.options.title;\n        }\n        else if (this.options.title) {\n            this._element.title = value;\n        }\n    }\n    set enabled(value) {\n        if (value) {\n            this._element.classList.remove('disabled');\n            this._element.setAttribute('aria-disabled', String(false));\n            this._element.tabIndex = 0;\n        }\n        else {\n            this._element.classList.add('disabled');\n            this._element.setAttribute('aria-disabled', String(true));\n        }\n    }\n    get enabled() {\n        return !this._element.classList.contains('disabled');\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { show } from '../../dom.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Color } from '../../../common/color.js';\nimport { Disposable } from '../../../common/lifecycle.js';\nimport { mixin } from '../../../common/objects.js';\nimport './progressbar.css';\nconst CSS_DONE = 'done';\nconst CSS_ACTIVE = 'active';\nconst CSS_INFINITE = 'infinite';\nconst CSS_INFINITE_LONG_RUNNING = 'infinite-long-running';\nconst CSS_DISCRETE = 'discrete';\nconst defaultOpts = {\n    progressBarBackground: Color.fromHex('#0E70C0')\n};\n/**\n * A progress bar with support for infinite or discrete progress.\n */\nexport class ProgressBar extends Disposable {\n    constructor(container, options) {\n        super();\n        this.options = options || Object.create(null);\n        mixin(this.options, defaultOpts, false);\n        this.workedVal = 0;\n        this.progressBarBackground = this.options.progressBarBackground;\n        this.showDelayedScheduler = this._register(new RunOnceScheduler(() => show(this.element), 0));\n        this.longRunningScheduler = this._register(new RunOnceScheduler(() => this.infiniteLongRunning(), ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD));\n        this.create(container);\n    }\n    create(container) {\n        this.element = document.createElement('div');\n        this.element.classList.add('monaco-progress-container');\n        this.element.setAttribute('role', 'progressbar');\n        this.element.setAttribute('aria-valuemin', '0');\n        container.appendChild(this.element);\n        this.bit = document.createElement('div');\n        this.bit.classList.add('progress-bit');\n        this.element.appendChild(this.bit);\n        this.applyStyles();\n    }\n    off() {\n        this.bit.style.width = 'inherit';\n        this.bit.style.opacity = '1';\n        this.element.classList.remove(CSS_ACTIVE, CSS_INFINITE, CSS_INFINITE_LONG_RUNNING, CSS_DISCRETE);\n        this.workedVal = 0;\n        this.totalWork = undefined;\n        this.longRunningScheduler.cancel();\n    }\n    /**\n     * Stops the progressbar from showing any progress instantly without fading out.\n     */\n    stop() {\n        return this.doDone(false);\n    }\n    doDone(delayed) {\n        this.element.classList.add(CSS_DONE);\n        // discrete: let it grow to 100% width and hide afterwards\n        if (!this.element.classList.contains(CSS_INFINITE)) {\n            this.bit.style.width = 'inherit';\n            if (delayed) {\n                setTimeout(() => this.off(), 200);\n            }\n            else {\n                this.off();\n            }\n        }\n        // infinite: let it fade out and hide afterwards\n        else {\n            this.bit.style.opacity = '0';\n            if (delayed) {\n                setTimeout(() => this.off(), 200);\n            }\n            else {\n                this.off();\n            }\n        }\n        return this;\n    }\n    /**\n     * Use this mode to indicate progress that has no total number of work units.\n     */\n    infinite() {\n        this.bit.style.width = '2%';\n        this.bit.style.opacity = '1';\n        this.element.classList.remove(CSS_DISCRETE, CSS_DONE, CSS_INFINITE_LONG_RUNNING);\n        this.element.classList.add(CSS_ACTIVE, CSS_INFINITE);\n        this.longRunningScheduler.schedule();\n        return this;\n    }\n    infiniteLongRunning() {\n        this.element.classList.add(CSS_INFINITE_LONG_RUNNING);\n    }\n    getContainer() {\n        return this.element;\n    }\n    style(styles) {\n        this.progressBarBackground = styles.progressBarBackground;\n        this.applyStyles();\n    }\n    applyStyles() {\n        if (this.bit) {\n            const background = this.progressBarBackground ? this.progressBarBackground.toString() : '';\n            this.bit.style.backgroundColor = background;\n        }\n    }\n}\n/**\n * After a certain time of showing the progress bar, switch\n * to long-running mode and throttle animations to reduce\n * the pressure on the GPU process.\n *\n * https://github.com/microsoft/vscode/issues/97900\n * https://github.com/microsoft/vscode/issues/138396\n */\nProgressBar.LONG_RUNNING_INFINITE_THRESHOLD = 10000;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../browser/dom.js';\nimport { IdGenerator } from '../../../common/idGenerator.js';\nimport './media/quickInput.css';\nconst iconPathToClass = {};\nconst iconClassGenerator = new IdGenerator('quick-input-button-icon-');\nexport function getIconClass(iconPath) {\n    if (!iconPath) {\n        return undefined;\n    }\n    let iconClass;\n    const key = iconPath.dark.toString();\n    if (iconPathToClass[key]) {\n        iconClass = iconPathToClass[key];\n    }\n    else {\n        iconClass = iconClassGenerator.nextId();\n        dom.createCSSRule(`.${iconClass}, .hc-light .${iconClass}`, `background-image: ${dom.asCSSUrl(iconPath.light || iconPath.dark)}`);\n        dom.createCSSRule(`.vs-dark .${iconClass}, .hc-black .${iconClass}`, `background-image: ${dom.asCSSUrl(iconPath.dark)}`);\n        iconPathToClass[key] = iconClass;\n    }\n    return iconClass;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../browser/keyboardEvent.js';\nimport { StandardMouseEvent } from '../../../browser/mouseEvent.js';\nimport { InputBox } from '../../../browser/ui/inputbox/inputBox.js';\nimport { Disposable } from '../../../common/lifecycle.js';\nimport Severity from '../../../common/severity.js';\nimport './media/quickInput.css';\nconst $ = dom.$;\nexport class QuickInputBox extends Disposable {\n    constructor(parent) {\n        super();\n        this.parent = parent;\n        this.onKeyDown = (handler) => {\n            return dom.addDisposableListener(this.inputBox.inputElement, dom.EventType.KEY_DOWN, (e) => {\n                handler(new StandardKeyboardEvent(e));\n            });\n        };\n        this.onMouseDown = (handler) => {\n            return dom.addDisposableListener(this.inputBox.inputElement, dom.EventType.MOUSE_DOWN, (e) => {\n                handler(new StandardMouseEvent(e));\n            });\n        };\n        this.onDidChange = (handler) => {\n            return this.inputBox.onDidChange(handler);\n        };\n        this.container = dom.append(this.parent, $('.quick-input-box'));\n        this.inputBox = this._register(new InputBox(this.container, undefined));\n    }\n    get value() {\n        return this.inputBox.value;\n    }\n    set value(value) {\n        this.inputBox.value = value;\n    }\n    select(range = null) {\n        this.inputBox.select(range);\n    }\n    isSelectionAtEnd() {\n        return this.inputBox.isSelectionAtEnd();\n    }\n    get placeholder() {\n        return this.inputBox.inputElement.getAttribute('placeholder') || '';\n    }\n    set placeholder(placeholder) {\n        this.inputBox.setPlaceHolder(placeholder);\n    }\n    get ariaLabel() {\n        return this.inputBox.getAriaLabel();\n    }\n    set ariaLabel(ariaLabel) {\n        this.inputBox.setAriaLabel(ariaLabel);\n    }\n    get password() {\n        return this.inputBox.inputElement.type === 'password';\n    }\n    set password(password) {\n        this.inputBox.inputElement.type = password ? 'password' : 'text';\n    }\n    setAttribute(name, value) {\n        this.inputBox.inputElement.setAttribute(name, value);\n    }\n    removeAttribute(name) {\n        this.inputBox.inputElement.removeAttribute(name);\n    }\n    showDecoration(decoration) {\n        if (decoration === Severity.Ignore) {\n            this.inputBox.hideMessage();\n        }\n        else {\n            this.inputBox.showMessage({ type: decoration === Severity.Info ? 1 /* MessageType.INFO */ : decoration === Severity.Warning ? 2 /* MessageType.WARNING */ : 3 /* MessageType.ERROR */, content: '' });\n        }\n    }\n    stylesForType(decoration) {\n        return this.inputBox.stylesForType(decoration === Severity.Info ? 1 /* MessageType.INFO */ : decoration === Severity.Warning ? 2 /* MessageType.WARNING */ : 3 /* MessageType.ERROR */);\n    }\n    setFocus() {\n        this.inputBox.focus();\n    }\n    layout() {\n        this.inputBox.layout();\n    }\n    style(styles) {\n        this.inputBox.style(styles);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../dom.js';\nimport { UILabelProvider } from '../../../common/keybindingLabels.js';\nimport { equals } from '../../../common/objects.js';\nimport './keybindingLabel.css';\nimport { localize } from '../../../../nls.js';\nconst $ = dom.$;\nexport class KeybindingLabel {\n    constructor(container, os, options) {\n        this.os = os;\n        this.keyElements = new Set();\n        this.options = options || Object.create(null);\n        this.labelBackground = this.options.keybindingLabelBackground;\n        this.labelForeground = this.options.keybindingLabelForeground;\n        this.labelBorder = this.options.keybindingLabelBorder;\n        this.labelBottomBorder = this.options.keybindingLabelBottomBorder;\n        this.labelShadow = this.options.keybindingLabelShadow;\n        this.domNode = dom.append(container, $('.monaco-keybinding'));\n        this.didEverRender = false;\n        container.appendChild(this.domNode);\n    }\n    get element() {\n        return this.domNode;\n    }\n    set(keybinding, matches) {\n        if (this.didEverRender && this.keybinding === keybinding && KeybindingLabel.areSame(this.matches, matches)) {\n            return;\n        }\n        this.keybinding = keybinding;\n        this.matches = matches;\n        this.render();\n    }\n    render() {\n        this.clear();\n        if (this.keybinding) {\n            const [firstPart, chordPart] = this.keybinding.getParts();\n            if (firstPart) {\n                this.renderPart(this.domNode, firstPart, this.matches ? this.matches.firstPart : null);\n            }\n            if (chordPart) {\n                dom.append(this.domNode, $('span.monaco-keybinding-key-chord-separator', undefined, ' '));\n                this.renderPart(this.domNode, chordPart, this.matches ? this.matches.chordPart : null);\n            }\n            this.domNode.title = this.keybinding.getAriaLabel() || '';\n        }\n        else if (this.options && this.options.renderUnboundKeybindings) {\n            this.renderUnbound(this.domNode);\n        }\n        this.applyStyles();\n        this.didEverRender = true;\n    }\n    clear() {\n        dom.clearNode(this.domNode);\n        this.keyElements.clear();\n    }\n    renderPart(parent, part, match) {\n        const modifierLabels = UILabelProvider.modifierLabels[this.os];\n        if (part.ctrlKey) {\n            this.renderKey(parent, modifierLabels.ctrlKey, Boolean(match === null || match === void 0 ? void 0 : match.ctrlKey), modifierLabels.separator);\n        }\n        if (part.shiftKey) {\n            this.renderKey(parent, modifierLabels.shiftKey, Boolean(match === null || match === void 0 ? void 0 : match.shiftKey), modifierLabels.separator);\n        }\n        if (part.altKey) {\n            this.renderKey(parent, modifierLabels.altKey, Boolean(match === null || match === void 0 ? void 0 : match.altKey), modifierLabels.separator);\n        }\n        if (part.metaKey) {\n            this.renderKey(parent, modifierLabels.metaKey, Boolean(match === null || match === void 0 ? void 0 : match.metaKey), modifierLabels.separator);\n        }\n        const keyLabel = part.keyLabel;\n        if (keyLabel) {\n            this.renderKey(parent, keyLabel, Boolean(match === null || match === void 0 ? void 0 : match.keyCode), '');\n        }\n    }\n    renderKey(parent, label, highlight, separator) {\n        dom.append(parent, this.createKeyElement(label, highlight ? '.highlight' : ''));\n        if (separator) {\n            dom.append(parent, $('span.monaco-keybinding-key-separator', undefined, separator));\n        }\n    }\n    renderUnbound(parent) {\n        dom.append(parent, this.createKeyElement(localize('unbound', \"Unbound\")));\n    }\n    createKeyElement(label, extraClass = '') {\n        const keyElement = $('span.monaco-keybinding-key' + extraClass, undefined, label);\n        this.keyElements.add(keyElement);\n        return keyElement;\n    }\n    style(styles) {\n        this.labelBackground = styles.keybindingLabelBackground;\n        this.labelForeground = styles.keybindingLabelForeground;\n        this.labelBorder = styles.keybindingLabelBorder;\n        this.labelBottomBorder = styles.keybindingLabelBottomBorder;\n        this.labelShadow = styles.keybindingLabelShadow;\n        this.applyStyles();\n    }\n    applyStyles() {\n        var _a;\n        if (this.element) {\n            for (const keyElement of this.keyElements) {\n                if (this.labelBackground) {\n                    keyElement.style.backgroundColor = (_a = this.labelBackground) === null || _a === void 0 ? void 0 : _a.toString();\n                }\n                if (this.labelBorder) {\n                    keyElement.style.borderColor = this.labelBorder.toString();\n                }\n                if (this.labelBottomBorder) {\n                    keyElement.style.borderBottomColor = this.labelBottomBorder.toString();\n                }\n                if (this.labelShadow) {\n                    keyElement.style.boxShadow = `inset 0 -1px 0 ${this.labelShadow}`;\n                }\n            }\n            if (this.labelForeground) {\n                this.element.style.color = this.labelForeground.toString();\n            }\n        }\n    }\n    static areSame(a, b) {\n        if (a === b || (!a && !b)) {\n            return true;\n        }\n        return !!a && !!b && equals(a.firstPart, b.firstPart) && equals(a.chordPart, b.chordPart);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IdleValue } from './async.js';\n// When comparing large numbers of strings it's better for performance to create an\n// Intl.Collator object and use the function provided by its compare property\n// than it is to use String.prototype.localeCompare()\n// A collator with numeric sorting enabled, and no sensitivity to case, accents or diacritics.\nconst intlFileNameCollatorBaseNumeric = new IdleValue(() => {\n    const collator = new Intl.Collator(undefined, { numeric: true, sensitivity: 'base' });\n    return {\n        collator: collator,\n        collatorIsNumeric: collator.resolvedOptions().numeric\n    };\n});\n// A collator with numeric sorting enabled.\nconst intlFileNameCollatorNumeric = new IdleValue(() => {\n    const collator = new Intl.Collator(undefined, { numeric: true });\n    return {\n        collator: collator\n    };\n});\n// A collator with numeric sorting enabled, and sensitivity to accents and diacritics but not case.\nconst intlFileNameCollatorNumericCaseInsensitive = new IdleValue(() => {\n    const collator = new Intl.Collator(undefined, { numeric: true, sensitivity: 'accent' });\n    return {\n        collator: collator\n    };\n});\n/** Compares filenames without distinguishing the name from the extension. Disambiguates by unicode comparison. */\nexport function compareFileNames(one, other, caseSensitive = false) {\n    const a = one || '';\n    const b = other || '';\n    const result = intlFileNameCollatorBaseNumeric.value.collator.compare(a, b);\n    // Using the numeric option will make compare(`foo1`, `foo01`) === 0. Disambiguate.\n    if (intlFileNameCollatorBaseNumeric.value.collatorIsNumeric && result === 0 && a !== b) {\n        return a < b ? -1 : 1;\n    }\n    return result;\n}\nexport function compareAnything(one, other, lookFor) {\n    const elementAName = one.toLowerCase();\n    const elementBName = other.toLowerCase();\n    // Sort prefix matches over non prefix matches\n    const prefixCompare = compareByPrefix(one, other, lookFor);\n    if (prefixCompare) {\n        return prefixCompare;\n    }\n    // Sort suffix matches over non suffix matches\n    const elementASuffixMatch = elementAName.endsWith(lookFor);\n    const elementBSuffixMatch = elementBName.endsWith(lookFor);\n    if (elementASuffixMatch !== elementBSuffixMatch) {\n        return elementASuffixMatch ? -1 : 1;\n    }\n    // Understand file names\n    const r = compareFileNames(elementAName, elementBName);\n    if (r !== 0) {\n        return r;\n    }\n    // Compare by name\n    return elementAName.localeCompare(elementBName);\n}\nexport function compareByPrefix(one, other, lookFor) {\n    const elementAName = one.toLowerCase();\n    const elementBName = other.toLowerCase();\n    // Sort prefix matches over non prefix matches\n    const elementAPrefixMatch = elementAName.startsWith(lookFor);\n    const elementBPrefixMatch = elementBName.startsWith(lookFor);\n    if (elementAPrefixMatch !== elementBPrefixMatch) {\n        return elementAPrefixMatch ? -1 : 1;\n    }\n    // Same prefix: Sort shorter matches to the top to have those on top that match more precisely\n    else if (elementAPrefixMatch && elementBPrefixMatch) {\n        if (elementAName.length < elementBName.length) {\n            return -1;\n        }\n        if (elementAName.length > elementBName.length) {\n            return 1;\n        }\n    }\n    return 0;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../browser/keyboardEvent.js';\nimport { ActionBar } from '../../../browser/ui/actionbar/actionbar.js';\nimport { IconLabel } from '../../../browser/ui/iconLabel/iconLabel.js';\nimport { KeybindingLabel } from '../../../browser/ui/keybindingLabel/keybindingLabel.js';\nimport { Action } from '../../../common/actions.js';\nimport { range } from '../../../common/arrays.js';\nimport { getCodiconAriaLabel } from '../../../common/codicons.js';\nimport { compareAnything } from '../../../common/comparers.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { matchesFuzzyIconAware, parseLabelWithIcons } from '../../../common/iconLabels.js';\nimport { dispose } from '../../../common/lifecycle.js';\nimport * as platform from '../../../common/platform.js';\nimport { ltrim } from '../../../common/strings.js';\nimport { withNullAsUndefined } from '../../../common/types.js';\nimport { getIconClass } from './quickInputUtils.js';\nimport './media/quickInput.css';\nimport { localize } from '../../../../nls.js';\nconst $ = dom.$;\nclass ListElement {\n    constructor(init) {\n        this.hidden = false;\n        this._onChecked = new Emitter();\n        this.onChecked = this._onChecked.event;\n        Object.assign(this, init);\n    }\n    get checked() {\n        return !!this._checked;\n    }\n    set checked(value) {\n        if (value !== this._checked) {\n            this._checked = value;\n            this._onChecked.fire(value);\n        }\n    }\n    dispose() {\n        this._onChecked.dispose();\n    }\n}\nclass ListElementRenderer {\n    get templateId() {\n        return ListElementRenderer.ID;\n    }\n    renderTemplate(container) {\n        const data = Object.create(null);\n        data.toDisposeElement = [];\n        data.toDisposeTemplate = [];\n        data.entry = dom.append(container, $('.quick-input-list-entry'));\n        // Checkbox\n        const label = dom.append(data.entry, $('label.quick-input-list-label'));\n        data.toDisposeTemplate.push(dom.addStandardDisposableListener(label, dom.EventType.CLICK, e => {\n            if (!data.checkbox.offsetParent) { // If checkbox not visible:\n                e.preventDefault(); // Prevent toggle of checkbox when it is immediately shown afterwards. #91740\n            }\n        }));\n        data.checkbox = dom.append(label, $('input.quick-input-list-checkbox'));\n        data.checkbox.type = 'checkbox';\n        data.toDisposeTemplate.push(dom.addStandardDisposableListener(data.checkbox, dom.EventType.CHANGE, e => {\n            data.element.checked = data.checkbox.checked;\n        }));\n        // Rows\n        const rows = dom.append(label, $('.quick-input-list-rows'));\n        const row1 = dom.append(rows, $('.quick-input-list-row'));\n        const row2 = dom.append(rows, $('.quick-input-list-row'));\n        // Label\n        data.label = new IconLabel(row1, { supportHighlights: true, supportDescriptionHighlights: true, supportIcons: true });\n        // Keybinding\n        const keybindingContainer = dom.append(row1, $('.quick-input-list-entry-keybinding'));\n        data.keybinding = new KeybindingLabel(keybindingContainer, platform.OS);\n        // Detail\n        const detailContainer = dom.append(row2, $('.quick-input-list-label-meta'));\n        data.detail = new IconLabel(detailContainer, { supportHighlights: true, supportIcons: true });\n        // Separator\n        data.separator = dom.append(data.entry, $('.quick-input-list-separator'));\n        // Actions\n        data.actionBar = new ActionBar(data.entry);\n        data.actionBar.domNode.classList.add('quick-input-list-entry-action-bar');\n        data.toDisposeTemplate.push(data.actionBar);\n        return data;\n    }\n    renderElement(element, index, data) {\n        data.toDisposeElement = dispose(data.toDisposeElement);\n        data.element = element;\n        data.checkbox.checked = element.checked;\n        data.toDisposeElement.push(element.onChecked(checked => data.checkbox.checked = checked));\n        const { labelHighlights, descriptionHighlights, detailHighlights } = element;\n        // Label\n        const options = Object.create(null);\n        options.matches = labelHighlights || [];\n        options.descriptionTitle = element.saneDescription;\n        options.descriptionMatches = descriptionHighlights || [];\n        options.extraClasses = element.item.iconClasses;\n        options.italic = element.item.italic;\n        options.strikethrough = element.item.strikethrough;\n        data.label.setLabel(element.saneLabel, element.saneDescription, options);\n        // Keybinding\n        data.keybinding.set(element.item.keybinding);\n        // Meta\n        if (element.saneDetail) {\n            data.detail.setLabel(element.saneDetail, undefined, {\n                matches: detailHighlights,\n                title: element.saneDetail\n            });\n        }\n        // Separator\n        if (element.separator && element.separator.label) {\n            data.separator.textContent = element.separator.label;\n            data.separator.style.display = '';\n        }\n        else {\n            data.separator.style.display = 'none';\n        }\n        data.entry.classList.toggle('quick-input-list-separator-border', !!element.separator);\n        // Actions\n        data.actionBar.clear();\n        const buttons = element.item.buttons;\n        if (buttons && buttons.length) {\n            data.actionBar.push(buttons.map((button, index) => {\n                let cssClasses = button.iconClass || (button.iconPath ? getIconClass(button.iconPath) : undefined);\n                if (button.alwaysVisible) {\n                    cssClasses = cssClasses ? `${cssClasses} always-visible` : 'always-visible';\n                }\n                const action = new Action(`id-${index}`, '', cssClasses, true, () => __awaiter(this, void 0, void 0, function* () {\n                    element.fireButtonTriggered({\n                        button,\n                        item: element.item\n                    });\n                }));\n                action.tooltip = button.tooltip || '';\n                return action;\n            }), { icon: true, label: false });\n            data.entry.classList.add('has-actions');\n        }\n        else {\n            data.entry.classList.remove('has-actions');\n        }\n    }\n    disposeElement(element, index, data) {\n        data.toDisposeElement = dispose(data.toDisposeElement);\n    }\n    disposeTemplate(data) {\n        data.toDisposeElement = dispose(data.toDisposeElement);\n        data.toDisposeTemplate = dispose(data.toDisposeTemplate);\n    }\n}\nListElementRenderer.ID = 'listelement';\nclass ListElementDelegate {\n    getHeight(element) {\n        return element.saneDetail ? 44 : 22;\n    }\n    getTemplateId(element) {\n        return ListElementRenderer.ID;\n    }\n}\nexport var QuickInputListFocus;\n(function (QuickInputListFocus) {\n    QuickInputListFocus[QuickInputListFocus[\"First\"] = 1] = \"First\";\n    QuickInputListFocus[QuickInputListFocus[\"Second\"] = 2] = \"Second\";\n    QuickInputListFocus[QuickInputListFocus[\"Last\"] = 3] = \"Last\";\n    QuickInputListFocus[QuickInputListFocus[\"Next\"] = 4] = \"Next\";\n    QuickInputListFocus[QuickInputListFocus[\"Previous\"] = 5] = \"Previous\";\n    QuickInputListFocus[QuickInputListFocus[\"NextPage\"] = 6] = \"NextPage\";\n    QuickInputListFocus[QuickInputListFocus[\"PreviousPage\"] = 7] = \"PreviousPage\";\n})(QuickInputListFocus || (QuickInputListFocus = {}));\nexport class QuickInputList {\n    constructor(parent, id, options) {\n        this.parent = parent;\n        this.inputElements = [];\n        this.elements = [];\n        this.elementsToIndexes = new Map();\n        this.matchOnDescription = false;\n        this.matchOnDetail = false;\n        this.matchOnLabel = true;\n        this.matchOnLabelMode = 'fuzzy';\n        this.matchOnMeta = true;\n        this.sortByLabel = true;\n        this._onChangedAllVisibleChecked = new Emitter();\n        this.onChangedAllVisibleChecked = this._onChangedAllVisibleChecked.event;\n        this._onChangedCheckedCount = new Emitter();\n        this.onChangedCheckedCount = this._onChangedCheckedCount.event;\n        this._onChangedVisibleCount = new Emitter();\n        this.onChangedVisibleCount = this._onChangedVisibleCount.event;\n        this._onChangedCheckedElements = new Emitter();\n        this.onChangedCheckedElements = this._onChangedCheckedElements.event;\n        this._onButtonTriggered = new Emitter();\n        this.onButtonTriggered = this._onButtonTriggered.event;\n        this._onKeyDown = new Emitter();\n        this.onKeyDown = this._onKeyDown.event;\n        this._onLeave = new Emitter();\n        this.onLeave = this._onLeave.event;\n        this._fireCheckedEvents = true;\n        this.elementDisposables = [];\n        this.disposables = [];\n        this.id = id;\n        this.container = dom.append(this.parent, $('.quick-input-list'));\n        const delegate = new ListElementDelegate();\n        const accessibilityProvider = new QuickInputAccessibilityProvider();\n        this.list = options.createList('QuickInput', this.container, delegate, [new ListElementRenderer()], {\n            identityProvider: { getId: element => element.saneLabel },\n            setRowLineHeight: false,\n            multipleSelectionSupport: false,\n            horizontalScrolling: false,\n            accessibilityProvider\n        });\n        this.list.getHTMLElement().id = id;\n        this.disposables.push(this.list);\n        this.disposables.push(this.list.onKeyDown(e => {\n            const event = new StandardKeyboardEvent(e);\n            switch (event.keyCode) {\n                case 10 /* KeyCode.Space */:\n                    this.toggleCheckbox();\n                    break;\n                case 31 /* KeyCode.KeyA */:\n                    if (platform.isMacintosh ? e.metaKey : e.ctrlKey) {\n                        this.list.setFocus(range(this.list.length));\n                    }\n                    break;\n                case 16 /* KeyCode.UpArrow */: {\n                    const focus1 = this.list.getFocus();\n                    if (focus1.length === 1 && focus1[0] === 0) {\n                        this._onLeave.fire();\n                    }\n                    break;\n                }\n                case 18 /* KeyCode.DownArrow */: {\n                    const focus2 = this.list.getFocus();\n                    if (focus2.length === 1 && focus2[0] === this.list.length - 1) {\n                        this._onLeave.fire();\n                    }\n                    break;\n                }\n            }\n            this._onKeyDown.fire(event);\n        }));\n        this.disposables.push(this.list.onMouseDown(e => {\n            if (e.browserEvent.button !== 2) {\n                // Works around / fixes #64350.\n                e.browserEvent.preventDefault();\n            }\n        }));\n        this.disposables.push(dom.addDisposableListener(this.container, dom.EventType.CLICK, e => {\n            if (e.x || e.y) { // Avoid 'click' triggered by 'space' on checkbox.\n                this._onLeave.fire();\n            }\n        }));\n        this.disposables.push(this.list.onMouseMiddleClick(e => {\n            this._onLeave.fire();\n        }));\n        this.disposables.push(this.list.onContextMenu(e => {\n            if (typeof e.index === 'number') {\n                e.browserEvent.preventDefault();\n                // we want to treat a context menu event as\n                // a gesture to open the item at the index\n                // since we do not have any context menu\n                // this enables for example macOS to Ctrl-\n                // click on an item to open it.\n                this.list.setSelection([e.index]);\n            }\n        }));\n        this.disposables.push(this._onChangedAllVisibleChecked, this._onChangedCheckedCount, this._onChangedVisibleCount, this._onChangedCheckedElements, this._onButtonTriggered, this._onLeave, this._onKeyDown);\n    }\n    get onDidChangeFocus() {\n        return Event.map(this.list.onDidChangeFocus, e => e.elements.map(e => e.item));\n    }\n    get onDidChangeSelection() {\n        return Event.map(this.list.onDidChangeSelection, e => ({ items: e.elements.map(e => e.item), event: e.browserEvent }));\n    }\n    get scrollTop() {\n        return this.list.scrollTop;\n    }\n    set scrollTop(scrollTop) {\n        this.list.scrollTop = scrollTop;\n    }\n    getAllVisibleChecked() {\n        return this.allVisibleChecked(this.elements, false);\n    }\n    allVisibleChecked(elements, whenNoneVisible = true) {\n        for (let i = 0, n = elements.length; i < n; i++) {\n            const element = elements[i];\n            if (!element.hidden) {\n                if (!element.checked) {\n                    return false;\n                }\n                else {\n                    whenNoneVisible = true;\n                }\n            }\n        }\n        return whenNoneVisible;\n    }\n    getCheckedCount() {\n        let count = 0;\n        const elements = this.elements;\n        for (let i = 0, n = elements.length; i < n; i++) {\n            if (elements[i].checked) {\n                count++;\n            }\n        }\n        return count;\n    }\n    getVisibleCount() {\n        let count = 0;\n        const elements = this.elements;\n        for (let i = 0, n = elements.length; i < n; i++) {\n            if (!elements[i].hidden) {\n                count++;\n            }\n        }\n        return count;\n    }\n    setAllVisibleChecked(checked) {\n        try {\n            this._fireCheckedEvents = false;\n            this.elements.forEach(element => {\n                if (!element.hidden) {\n                    element.checked = checked;\n                }\n            });\n        }\n        finally {\n            this._fireCheckedEvents = true;\n            this.fireCheckedEvents();\n        }\n    }\n    setElements(inputElements) {\n        this.elementDisposables = dispose(this.elementDisposables);\n        const fireButtonTriggered = (event) => this.fireButtonTriggered(event);\n        this.inputElements = inputElements;\n        this.elements = inputElements.reduce((result, item, index) => {\n            var _a, _b, _c;\n            if (item.type !== 'separator') {\n                const previous = index && inputElements[index - 1];\n                const saneLabel = item.label && item.label.replace(/\\r?\\n/g, ' ');\n                const saneSortLabel = parseLabelWithIcons(saneLabel).text.trim();\n                const saneMeta = item.meta && item.meta.replace(/\\r?\\n/g, ' ');\n                const saneDescription = item.description && item.description.replace(/\\r?\\n/g, ' ');\n                const saneDetail = item.detail && item.detail.replace(/\\r?\\n/g, ' ');\n                const saneAriaLabel = item.ariaLabel || [saneLabel, saneDescription, saneDetail]\n                    .map(s => getCodiconAriaLabel(s))\n                    .filter(s => !!s)\n                    .join(', ');\n                const hasCheckbox = this.parent.classList.contains('show-checkboxes');\n                result.push(new ListElement({\n                    hasCheckbox,\n                    index,\n                    item,\n                    saneLabel,\n                    saneSortLabel,\n                    saneMeta,\n                    saneAriaLabel,\n                    saneDescription,\n                    saneDetail,\n                    labelHighlights: (_a = item.highlights) === null || _a === void 0 ? void 0 : _a.label,\n                    descriptionHighlights: (_b = item.highlights) === null || _b === void 0 ? void 0 : _b.description,\n                    detailHighlights: (_c = item.highlights) === null || _c === void 0 ? void 0 : _c.detail,\n                    checked: false,\n                    separator: previous && previous.type === 'separator' ? previous : undefined,\n                    fireButtonTriggered\n                }));\n            }\n            return result;\n        }, []);\n        this.elementDisposables.push(...this.elements);\n        this.elementDisposables.push(...this.elements.map(element => element.onChecked(() => this.fireCheckedEvents())));\n        this.elementsToIndexes = this.elements.reduce((map, element, index) => {\n            map.set(element.item, index);\n            return map;\n        }, new Map());\n        this.list.splice(0, this.list.length); // Clear focus and selection first, sending the events when the list is empty.\n        this.list.splice(0, this.list.length, this.elements);\n        this._onChangedVisibleCount.fire(this.elements.length);\n    }\n    getFocusedElements() {\n        return this.list.getFocusedElements()\n            .map(e => e.item);\n    }\n    setFocusedElements(items) {\n        this.list.setFocus(items\n            .filter(item => this.elementsToIndexes.has(item))\n            .map(item => this.elementsToIndexes.get(item)));\n        if (items.length > 0) {\n            const focused = this.list.getFocus()[0];\n            if (typeof focused === 'number') {\n                this.list.reveal(focused);\n            }\n        }\n    }\n    getActiveDescendant() {\n        return this.list.getHTMLElement().getAttribute('aria-activedescendant');\n    }\n    setSelectedElements(items) {\n        this.list.setSelection(items\n            .filter(item => this.elementsToIndexes.has(item))\n            .map(item => this.elementsToIndexes.get(item)));\n    }\n    getCheckedElements() {\n        return this.elements.filter(e => e.checked)\n            .map(e => e.item);\n    }\n    setCheckedElements(items) {\n        try {\n            this._fireCheckedEvents = false;\n            const checked = new Set();\n            for (const item of items) {\n                checked.add(item);\n            }\n            for (const element of this.elements) {\n                element.checked = checked.has(element.item);\n            }\n        }\n        finally {\n            this._fireCheckedEvents = true;\n            this.fireCheckedEvents();\n        }\n    }\n    set enabled(value) {\n        this.list.getHTMLElement().style.pointerEvents = value ? '' : 'none';\n    }\n    focus(what) {\n        if (!this.list.length) {\n            return;\n        }\n        if (what === QuickInputListFocus.Next && this.list.getFocus()[0] === this.list.length - 1) {\n            what = QuickInputListFocus.First;\n        }\n        if (what === QuickInputListFocus.Previous && this.list.getFocus()[0] === 0) {\n            what = QuickInputListFocus.Last;\n        }\n        if (what === QuickInputListFocus.Second && this.list.length < 2) {\n            what = QuickInputListFocus.First;\n        }\n        switch (what) {\n            case QuickInputListFocus.First:\n                this.list.focusFirst();\n                break;\n            case QuickInputListFocus.Second:\n                this.list.focusNth(1);\n                break;\n            case QuickInputListFocus.Last:\n                this.list.focusLast();\n                break;\n            case QuickInputListFocus.Next:\n                this.list.focusNext();\n                break;\n            case QuickInputListFocus.Previous:\n                this.list.focusPrevious();\n                break;\n            case QuickInputListFocus.NextPage:\n                this.list.focusNextPage();\n                break;\n            case QuickInputListFocus.PreviousPage:\n                this.list.focusPreviousPage();\n                break;\n        }\n        const focused = this.list.getFocus()[0];\n        if (typeof focused === 'number') {\n            this.list.reveal(focused);\n        }\n    }\n    clearFocus() {\n        this.list.setFocus([]);\n    }\n    domFocus() {\n        this.list.domFocus();\n    }\n    layout(maxHeight) {\n        this.list.getHTMLElement().style.maxHeight = maxHeight ? `calc(${Math.floor(maxHeight / 44) * 44}px)` : '';\n        this.list.layout();\n    }\n    filter(query) {\n        if (!(this.sortByLabel || this.matchOnLabel || this.matchOnDescription || this.matchOnDetail)) {\n            this.list.layout();\n            return false;\n        }\n        const queryWithWhitespace = query;\n        query = query.trim();\n        // Reset filtering\n        if (!query || !(this.matchOnLabel || this.matchOnDescription || this.matchOnDetail)) {\n            this.elements.forEach(element => {\n                element.labelHighlights = undefined;\n                element.descriptionHighlights = undefined;\n                element.detailHighlights = undefined;\n                element.hidden = false;\n                const previous = element.index && this.inputElements[element.index - 1];\n                element.separator = previous && previous.type === 'separator' ? previous : undefined;\n            });\n        }\n        // Filter by value (since we support icons in labels, use $(..) aware fuzzy matching)\n        else {\n            let currentSeparator;\n            this.elements.forEach(element => {\n                let labelHighlights;\n                if (this.matchOnLabelMode === 'fuzzy') {\n                    labelHighlights = this.matchOnLabel ? withNullAsUndefined(matchesFuzzyIconAware(query, parseLabelWithIcons(element.saneLabel))) : undefined;\n                }\n                else {\n                    labelHighlights = this.matchOnLabel ? withNullAsUndefined(matchesContiguousIconAware(queryWithWhitespace, parseLabelWithIcons(element.saneLabel))) : undefined;\n                }\n                const descriptionHighlights = this.matchOnDescription ? withNullAsUndefined(matchesFuzzyIconAware(query, parseLabelWithIcons(element.saneDescription || ''))) : undefined;\n                const detailHighlights = this.matchOnDetail ? withNullAsUndefined(matchesFuzzyIconAware(query, parseLabelWithIcons(element.saneDetail || ''))) : undefined;\n                const metaHighlights = this.matchOnMeta ? withNullAsUndefined(matchesFuzzyIconAware(query, parseLabelWithIcons(element.saneMeta || ''))) : undefined;\n                if (labelHighlights || descriptionHighlights || detailHighlights || metaHighlights) {\n                    element.labelHighlights = labelHighlights;\n                    element.descriptionHighlights = descriptionHighlights;\n                    element.detailHighlights = detailHighlights;\n                    element.hidden = false;\n                }\n                else {\n                    element.labelHighlights = undefined;\n                    element.descriptionHighlights = undefined;\n                    element.detailHighlights = undefined;\n                    element.hidden = !element.item.alwaysShow;\n                }\n                element.separator = undefined;\n                // we can show the separator unless the list gets sorted by match\n                if (!this.sortByLabel) {\n                    const previous = element.index && this.inputElements[element.index - 1];\n                    currentSeparator = previous && previous.type === 'separator' ? previous : currentSeparator;\n                    if (currentSeparator && !element.hidden) {\n                        element.separator = currentSeparator;\n                        currentSeparator = undefined;\n                    }\n                }\n            });\n        }\n        const shownElements = this.elements.filter(element => !element.hidden);\n        // Sort by value\n        if (this.sortByLabel && query) {\n            const normalizedSearchValue = query.toLowerCase();\n            shownElements.sort((a, b) => {\n                return compareEntries(a, b, normalizedSearchValue);\n            });\n        }\n        this.elementsToIndexes = shownElements.reduce((map, element, index) => {\n            map.set(element.item, index);\n            return map;\n        }, new Map());\n        this.list.splice(0, this.list.length, shownElements);\n        this.list.setFocus([]);\n        this.list.layout();\n        this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked());\n        this._onChangedVisibleCount.fire(shownElements.length);\n        return true;\n    }\n    toggleCheckbox() {\n        try {\n            this._fireCheckedEvents = false;\n            const elements = this.list.getFocusedElements();\n            const allChecked = this.allVisibleChecked(elements);\n            for (const element of elements) {\n                element.checked = !allChecked;\n            }\n        }\n        finally {\n            this._fireCheckedEvents = true;\n            this.fireCheckedEvents();\n        }\n    }\n    display(display) {\n        this.container.style.display = display ? '' : 'none';\n    }\n    isDisplayed() {\n        return this.container.style.display !== 'none';\n    }\n    dispose() {\n        this.elementDisposables = dispose(this.elementDisposables);\n        this.disposables = dispose(this.disposables);\n    }\n    fireCheckedEvents() {\n        if (this._fireCheckedEvents) {\n            this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked());\n            this._onChangedCheckedCount.fire(this.getCheckedCount());\n            this._onChangedCheckedElements.fire(this.getCheckedElements());\n        }\n    }\n    fireButtonTriggered(event) {\n        this._onButtonTriggered.fire(event);\n    }\n    style(styles) {\n        this.list.style(styles);\n    }\n}\n__decorate([\n    memoize\n], QuickInputList.prototype, \"onDidChangeFocus\", null);\n__decorate([\n    memoize\n], QuickInputList.prototype, \"onDidChangeSelection\", null);\nexport function matchesContiguousIconAware(query, target) {\n    const { text, iconOffsets } = target;\n    // Return early if there are no icon markers in the word to match against\n    if (!iconOffsets || iconOffsets.length === 0) {\n        return matchesContiguous(query, text);\n    }\n    // Trim the word to match against because it could have leading\n    // whitespace now if the word started with an icon\n    const wordToMatchAgainstWithoutIconsTrimmed = ltrim(text, ' ');\n    const leadingWhitespaceOffset = text.length - wordToMatchAgainstWithoutIconsTrimmed.length;\n    // match on value without icon\n    const matches = matchesContiguous(query, wordToMatchAgainstWithoutIconsTrimmed);\n    // Map matches back to offsets with icon and trimming\n    if (matches) {\n        for (const match of matches) {\n            const iconOffset = iconOffsets[match.start + leadingWhitespaceOffset] /* icon offsets at index */ + leadingWhitespaceOffset /* overall leading whitespace offset */;\n            match.start += iconOffset;\n            match.end += iconOffset;\n        }\n    }\n    return matches;\n}\nfunction matchesContiguous(word, wordToMatchAgainst) {\n    const matchIndex = wordToMatchAgainst.toLowerCase().indexOf(word.toLowerCase());\n    if (matchIndex !== -1) {\n        return [{ start: matchIndex, end: matchIndex + word.length }];\n    }\n    return null;\n}\nfunction compareEntries(elementA, elementB, lookFor) {\n    const labelHighlightsA = elementA.labelHighlights || [];\n    const labelHighlightsB = elementB.labelHighlights || [];\n    if (labelHighlightsA.length && !labelHighlightsB.length) {\n        return -1;\n    }\n    if (!labelHighlightsA.length && labelHighlightsB.length) {\n        return 1;\n    }\n    if (labelHighlightsA.length === 0 && labelHighlightsB.length === 0) {\n        return 0;\n    }\n    return compareAnything(elementA.saneSortLabel, elementB.saneSortLabel, lookFor);\n}\nclass QuickInputAccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('quickInput', \"Quick Input\");\n    }\n    getAriaLabel(element) {\n        var _a;\n        return ((_a = element.separator) === null || _a === void 0 ? void 0 : _a.label)\n            ? `${element.saneAriaLabel}, ${element.separator.label}`\n            : element.saneAriaLabel;\n    }\n    getWidgetRole() {\n        return 'listbox';\n    }\n    getRole(element) {\n        return element.hasCheckbox ? 'checkbox' : 'option';\n    }\n    isChecked(element) {\n        if (!element.hasCheckbox) {\n            return undefined;\n        }\n        return {\n            value: element.checked,\n            onDidChange: element.onChecked\n        };\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../browser/keyboardEvent.js';\nimport { ActionBar } from '../../../browser/ui/actionbar/actionbar.js';\nimport { Button } from '../../../browser/ui/button/button.js';\nimport { CountBadge } from '../../../browser/ui/countBadge/countBadge.js';\nimport { renderLabelWithIcons } from '../../../browser/ui/iconLabel/iconLabels.js';\nimport { ProgressBar } from '../../../browser/ui/progressbar/progressbar.js';\nimport { Action } from '../../../common/actions.js';\nimport { equals } from '../../../common/arrays.js';\nimport { TimeoutTimer } from '../../../common/async.js';\nimport { CancellationToken } from '../../../common/cancellation.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { isIOS } from '../../../common/platform.js';\nimport Severity from '../../../common/severity.js';\nimport { withNullAsUndefined } from '../../../common/types.js';\nimport { getIconClass } from './quickInputUtils.js';\nimport { ItemActivation, NO_KEY_MODS, QuickInputHideReason } from '../common/quickInput.js';\nimport './media/quickInput.css';\nimport { localize } from '../../../../nls.js';\nimport { QuickInputBox } from './quickInputBox.js';\nimport { QuickInputList, QuickInputListFocus } from './quickInputList.js';\nconst $ = dom.$;\nconst backButton = {\n    iconClass: Codicon.quickInputBack.classNames,\n    tooltip: localize('quickInput.back', \"Back\"),\n    handle: -1 // TODO\n};\nclass QuickInput extends Disposable {\n    constructor(ui) {\n        super();\n        this.ui = ui;\n        this.visible = false;\n        this._enabled = true;\n        this._busy = false;\n        this._ignoreFocusOut = false;\n        this._buttons = [];\n        this.noValidationMessage = QuickInput.noPromptMessage;\n        this._severity = Severity.Ignore;\n        this.buttonsUpdated = false;\n        this.onDidTriggerButtonEmitter = this._register(new Emitter());\n        this.onDidHideEmitter = this._register(new Emitter());\n        this.onDisposeEmitter = this._register(new Emitter());\n        this.visibleDisposables = this._register(new DisposableStore());\n        this.onDidHide = this.onDidHideEmitter.event;\n    }\n    get title() {\n        return this._title;\n    }\n    set title(title) {\n        this._title = title;\n        this.update();\n    }\n    get description() {\n        return this._description;\n    }\n    set description(description) {\n        this._description = description;\n        this.update();\n    }\n    get step() {\n        return this._steps;\n    }\n    set step(step) {\n        this._steps = step;\n        this.update();\n    }\n    get totalSteps() {\n        return this._totalSteps;\n    }\n    set totalSteps(totalSteps) {\n        this._totalSteps = totalSteps;\n        this.update();\n    }\n    get enabled() {\n        return this._enabled;\n    }\n    set enabled(enabled) {\n        this._enabled = enabled;\n        this.update();\n    }\n    get contextKey() {\n        return this._contextKey;\n    }\n    set contextKey(contextKey) {\n        this._contextKey = contextKey;\n        this.update();\n    }\n    get busy() {\n        return this._busy;\n    }\n    set busy(busy) {\n        this._busy = busy;\n        this.update();\n    }\n    get ignoreFocusOut() {\n        return this._ignoreFocusOut;\n    }\n    set ignoreFocusOut(ignoreFocusOut) {\n        const shouldUpdate = this._ignoreFocusOut !== ignoreFocusOut && !isIOS;\n        this._ignoreFocusOut = ignoreFocusOut && !isIOS;\n        if (shouldUpdate) {\n            this.update();\n        }\n    }\n    get buttons() {\n        return this._buttons;\n    }\n    set buttons(buttons) {\n        this._buttons = buttons;\n        this.buttonsUpdated = true;\n        this.update();\n    }\n    get validationMessage() {\n        return this._validationMessage;\n    }\n    set validationMessage(validationMessage) {\n        this._validationMessage = validationMessage;\n        this.update();\n    }\n    get severity() {\n        return this._severity;\n    }\n    set severity(severity) {\n        this._severity = severity;\n        this.update();\n    }\n    show() {\n        if (this.visible) {\n            return;\n        }\n        this.visibleDisposables.add(this.ui.onDidTriggerButton(button => {\n            if (this.buttons.indexOf(button) !== -1) {\n                this.onDidTriggerButtonEmitter.fire(button);\n            }\n        }));\n        this.ui.show(this);\n        // update properties in the controller that get reset in the ui.show() call\n        this.visible = true;\n        // This ensures the message/prompt gets rendered\n        this._lastValidationMessage = undefined;\n        // This ensures the input box has the right severity applied\n        this._lastSeverity = undefined;\n        if (this.buttons.length) {\n            // if there are buttons, the ui.show() clears them out of the UI so we should\n            // rerender them.\n            this.buttonsUpdated = true;\n        }\n        this.update();\n    }\n    hide() {\n        if (!this.visible) {\n            return;\n        }\n        this.ui.hide();\n    }\n    didHide(reason = QuickInputHideReason.Other) {\n        this.visible = false;\n        this.visibleDisposables.clear();\n        this.onDidHideEmitter.fire({ reason });\n    }\n    update() {\n        if (!this.visible) {\n            return;\n        }\n        const title = this.getTitle();\n        if (title && this.ui.title.textContent !== title) {\n            this.ui.title.textContent = title;\n        }\n        else if (!title && this.ui.title.innerHTML !== '&nbsp;') {\n            this.ui.title.innerText = '\\u00a0';\n        }\n        const description = this.getDescription();\n        if (this.ui.description1.textContent !== description) {\n            this.ui.description1.textContent = description;\n        }\n        if (this.ui.description2.textContent !== description) {\n            this.ui.description2.textContent = description;\n        }\n        if (this.busy && !this.busyDelay) {\n            this.busyDelay = new TimeoutTimer();\n            this.busyDelay.setIfNotSet(() => {\n                if (this.visible) {\n                    this.ui.progressBar.infinite();\n                }\n            }, 800);\n        }\n        if (!this.busy && this.busyDelay) {\n            this.ui.progressBar.stop();\n            this.busyDelay.cancel();\n            this.busyDelay = undefined;\n        }\n        if (this.buttonsUpdated) {\n            this.buttonsUpdated = false;\n            this.ui.leftActionBar.clear();\n            const leftButtons = this.buttons.filter(button => button === backButton);\n            this.ui.leftActionBar.push(leftButtons.map((button, index) => {\n                const action = new Action(`id-${index}`, '', button.iconClass || getIconClass(button.iconPath), true, () => __awaiter(this, void 0, void 0, function* () {\n                    this.onDidTriggerButtonEmitter.fire(button);\n                }));\n                action.tooltip = button.tooltip || '';\n                return action;\n            }), { icon: true, label: false });\n            this.ui.rightActionBar.clear();\n            const rightButtons = this.buttons.filter(button => button !== backButton);\n            this.ui.rightActionBar.push(rightButtons.map((button, index) => {\n                const action = new Action(`id-${index}`, '', button.iconClass || getIconClass(button.iconPath), true, () => __awaiter(this, void 0, void 0, function* () {\n                    this.onDidTriggerButtonEmitter.fire(button);\n                }));\n                action.tooltip = button.tooltip || '';\n                return action;\n            }), { icon: true, label: false });\n        }\n        this.ui.ignoreFocusOut = this.ignoreFocusOut;\n        this.ui.setEnabled(this.enabled);\n        this.ui.setContextKey(this.contextKey);\n        const validationMessage = this.validationMessage || this.noValidationMessage;\n        if (this._lastValidationMessage !== validationMessage) {\n            this._lastValidationMessage = validationMessage;\n            dom.reset(this.ui.message, ...renderLabelWithIcons(validationMessage));\n        }\n        if (this._lastSeverity !== this.severity) {\n            this._lastSeverity = this.severity;\n            this.showMessageDecoration(this.severity);\n        }\n    }\n    getTitle() {\n        if (this.title && this.step) {\n            return `${this.title} (${this.getSteps()})`;\n        }\n        if (this.title) {\n            return this.title;\n        }\n        if (this.step) {\n            return this.getSteps();\n        }\n        return '';\n    }\n    getDescription() {\n        return this.description || '';\n    }\n    getSteps() {\n        if (this.step && this.totalSteps) {\n            return localize('quickInput.steps', \"{0}/{1}\", this.step, this.totalSteps);\n        }\n        if (this.step) {\n            return String(this.step);\n        }\n        return '';\n    }\n    showMessageDecoration(severity) {\n        this.ui.inputBox.showDecoration(severity);\n        if (severity !== Severity.Ignore) {\n            const styles = this.ui.inputBox.stylesForType(severity);\n            this.ui.message.style.color = styles.foreground ? `${styles.foreground}` : '';\n            this.ui.message.style.backgroundColor = styles.background ? `${styles.background}` : '';\n            this.ui.message.style.border = styles.border ? `1px solid ${styles.border}` : '';\n            this.ui.message.style.marginBottom = '-2px';\n        }\n        else {\n            this.ui.message.style.color = '';\n            this.ui.message.style.backgroundColor = '';\n            this.ui.message.style.border = '';\n            this.ui.message.style.marginBottom = '';\n        }\n    }\n    dispose() {\n        this.hide();\n        this.onDisposeEmitter.fire();\n        super.dispose();\n    }\n}\nQuickInput.noPromptMessage = localize('inputModeEntry', \"Press 'Enter' to confirm your input or 'Escape' to cancel\");\nclass QuickPick extends QuickInput {\n    constructor() {\n        super(...arguments);\n        this._value = '';\n        this.onDidChangeValueEmitter = this._register(new Emitter());\n        this.onWillAcceptEmitter = this._register(new Emitter());\n        this.onDidAcceptEmitter = this._register(new Emitter());\n        this.onDidCustomEmitter = this._register(new Emitter());\n        this._items = [];\n        this.itemsUpdated = false;\n        this._canSelectMany = false;\n        this._canAcceptInBackground = false;\n        this._matchOnDescription = false;\n        this._matchOnDetail = false;\n        this._matchOnLabel = true;\n        this._matchOnLabelMode = 'fuzzy';\n        this._sortByLabel = true;\n        this._autoFocusOnList = true;\n        this._keepScrollPosition = false;\n        this._itemActivation = this.ui.isScreenReaderOptimized() ? ItemActivation.NONE /* https://github.com/microsoft/vscode/issues/57501 */ : ItemActivation.FIRST;\n        this._activeItems = [];\n        this.activeItemsUpdated = false;\n        this.activeItemsToConfirm = [];\n        this.onDidChangeActiveEmitter = this._register(new Emitter());\n        this._selectedItems = [];\n        this.selectedItemsUpdated = false;\n        this.selectedItemsToConfirm = [];\n        this.onDidChangeSelectionEmitter = this._register(new Emitter());\n        this.onDidTriggerItemButtonEmitter = this._register(new Emitter());\n        this.valueSelectionUpdated = true;\n        this._ok = 'default';\n        this._customButton = false;\n        this.filterValue = (value) => value;\n        this.onDidChangeValue = this.onDidChangeValueEmitter.event;\n        this.onWillAccept = this.onWillAcceptEmitter.event;\n        this.onDidAccept = this.onDidAcceptEmitter.event;\n        this.onDidChangeActive = this.onDidChangeActiveEmitter.event;\n        this.onDidChangeSelection = this.onDidChangeSelectionEmitter.event;\n        this.onDidTriggerItemButton = this.onDidTriggerItemButtonEmitter.event;\n    }\n    get quickNavigate() {\n        return this._quickNavigate;\n    }\n    set quickNavigate(quickNavigate) {\n        this._quickNavigate = quickNavigate;\n        this.update();\n    }\n    get value() {\n        return this._value;\n    }\n    set value(value) {\n        this.doSetValue(value);\n    }\n    doSetValue(value, skipUpdate) {\n        if (this._value !== value) {\n            this._value = value;\n            if (!skipUpdate) {\n                this.update();\n            }\n            if (this.visible) {\n                const didFilter = this.ui.list.filter(this.filterValue(this._value));\n                if (didFilter) {\n                    this.trySelectFirst();\n                }\n            }\n            this.onDidChangeValueEmitter.fire(this._value);\n        }\n    }\n    set ariaLabel(ariaLabel) {\n        this._ariaLabel = ariaLabel;\n        this.update();\n    }\n    get ariaLabel() {\n        return this._ariaLabel;\n    }\n    get placeholder() {\n        return this._placeholder;\n    }\n    set placeholder(placeholder) {\n        this._placeholder = placeholder;\n        this.update();\n    }\n    get items() {\n        return this._items;\n    }\n    get scrollTop() {\n        return this.ui.list.scrollTop;\n    }\n    set scrollTop(scrollTop) {\n        this.ui.list.scrollTop = scrollTop;\n    }\n    set items(items) {\n        this._items = items;\n        this.itemsUpdated = true;\n        this.update();\n    }\n    get canSelectMany() {\n        return this._canSelectMany;\n    }\n    set canSelectMany(canSelectMany) {\n        this._canSelectMany = canSelectMany;\n        this.update();\n    }\n    get canAcceptInBackground() {\n        return this._canAcceptInBackground;\n    }\n    set canAcceptInBackground(canAcceptInBackground) {\n        this._canAcceptInBackground = canAcceptInBackground;\n    }\n    get matchOnDescription() {\n        return this._matchOnDescription;\n    }\n    set matchOnDescription(matchOnDescription) {\n        this._matchOnDescription = matchOnDescription;\n        this.update();\n    }\n    get matchOnDetail() {\n        return this._matchOnDetail;\n    }\n    set matchOnDetail(matchOnDetail) {\n        this._matchOnDetail = matchOnDetail;\n        this.update();\n    }\n    get matchOnLabel() {\n        return this._matchOnLabel;\n    }\n    set matchOnLabel(matchOnLabel) {\n        this._matchOnLabel = matchOnLabel;\n        this.update();\n    }\n    get matchOnLabelMode() {\n        return this._matchOnLabelMode;\n    }\n    set matchOnLabelMode(matchOnLabelMode) {\n        this._matchOnLabelMode = matchOnLabelMode;\n        this.update();\n    }\n    get sortByLabel() {\n        return this._sortByLabel;\n    }\n    set sortByLabel(sortByLabel) {\n        this._sortByLabel = sortByLabel;\n        this.update();\n    }\n    get autoFocusOnList() {\n        return this._autoFocusOnList;\n    }\n    set autoFocusOnList(autoFocusOnList) {\n        this._autoFocusOnList = autoFocusOnList;\n        this.update();\n    }\n    get keepScrollPosition() {\n        return this._keepScrollPosition;\n    }\n    set keepScrollPosition(keepScrollPosition) {\n        this._keepScrollPosition = keepScrollPosition;\n    }\n    get itemActivation() {\n        return this._itemActivation;\n    }\n    set itemActivation(itemActivation) {\n        this._itemActivation = itemActivation;\n    }\n    get activeItems() {\n        return this._activeItems;\n    }\n    set activeItems(activeItems) {\n        this._activeItems = activeItems;\n        this.activeItemsUpdated = true;\n        this.update();\n    }\n    get selectedItems() {\n        return this._selectedItems;\n    }\n    set selectedItems(selectedItems) {\n        this._selectedItems = selectedItems;\n        this.selectedItemsUpdated = true;\n        this.update();\n    }\n    get keyMods() {\n        if (this._quickNavigate) {\n            // Disable keyMods when quick navigate is enabled\n            // because in this model the interaction is purely\n            // keyboard driven and Ctrl/Alt are typically\n            // pressed and hold during this interaction.\n            return NO_KEY_MODS;\n        }\n        return this.ui.keyMods;\n    }\n    set valueSelection(valueSelection) {\n        this._valueSelection = valueSelection;\n        this.valueSelectionUpdated = true;\n        this.update();\n    }\n    get customButton() {\n        return this._customButton;\n    }\n    set customButton(showCustomButton) {\n        this._customButton = showCustomButton;\n        this.update();\n    }\n    get customLabel() {\n        return this._customButtonLabel;\n    }\n    set customLabel(label) {\n        this._customButtonLabel = label;\n        this.update();\n    }\n    get customHover() {\n        return this._customButtonHover;\n    }\n    set customHover(hover) {\n        this._customButtonHover = hover;\n        this.update();\n    }\n    get ok() {\n        return this._ok;\n    }\n    set ok(showOkButton) {\n        this._ok = showOkButton;\n        this.update();\n    }\n    get hideInput() {\n        return !!this._hideInput;\n    }\n    set hideInput(hideInput) {\n        this._hideInput = hideInput;\n        this.update();\n    }\n    trySelectFirst() {\n        if (this.autoFocusOnList) {\n            if (!this.canSelectMany) {\n                this.ui.list.focus(QuickInputListFocus.First);\n            }\n        }\n    }\n    show() {\n        if (!this.visible) {\n            this.visibleDisposables.add(this.ui.inputBox.onDidChange(value => {\n                this.doSetValue(value, true /* skip update since this originates from the UI */);\n            }));\n            this.visibleDisposables.add(this.ui.inputBox.onMouseDown(event => {\n                if (!this.autoFocusOnList) {\n                    this.ui.list.clearFocus();\n                }\n            }));\n            this.visibleDisposables.add((this._hideInput ? this.ui.list : this.ui.inputBox).onKeyDown((event) => {\n                switch (event.keyCode) {\n                    case 18 /* KeyCode.DownArrow */:\n                        this.ui.list.focus(QuickInputListFocus.Next);\n                        if (this.canSelectMany) {\n                            this.ui.list.domFocus();\n                        }\n                        dom.EventHelper.stop(event, true);\n                        break;\n                    case 16 /* KeyCode.UpArrow */:\n                        if (this.ui.list.getFocusedElements().length) {\n                            this.ui.list.focus(QuickInputListFocus.Previous);\n                        }\n                        else {\n                            this.ui.list.focus(QuickInputListFocus.Last);\n                        }\n                        if (this.canSelectMany) {\n                            this.ui.list.domFocus();\n                        }\n                        dom.EventHelper.stop(event, true);\n                        break;\n                    case 12 /* KeyCode.PageDown */:\n                        this.ui.list.focus(QuickInputListFocus.NextPage);\n                        if (this.canSelectMany) {\n                            this.ui.list.domFocus();\n                        }\n                        dom.EventHelper.stop(event, true);\n                        break;\n                    case 11 /* KeyCode.PageUp */:\n                        this.ui.list.focus(QuickInputListFocus.PreviousPage);\n                        if (this.canSelectMany) {\n                            this.ui.list.domFocus();\n                        }\n                        dom.EventHelper.stop(event, true);\n                        break;\n                    case 17 /* KeyCode.RightArrow */:\n                        if (!this._canAcceptInBackground) {\n                            return; // needs to be enabled\n                        }\n                        if (!this.ui.inputBox.isSelectionAtEnd()) {\n                            return; // ensure input box selection at end\n                        }\n                        if (this.activeItems[0]) {\n                            this._selectedItems = [this.activeItems[0]];\n                            this.onDidChangeSelectionEmitter.fire(this.selectedItems);\n                            this.handleAccept(true);\n                        }\n                        break;\n                    case 14 /* KeyCode.Home */:\n                        if ((event.ctrlKey || event.metaKey) && !event.shiftKey && !event.altKey) {\n                            this.ui.list.focus(QuickInputListFocus.First);\n                            dom.EventHelper.stop(event, true);\n                        }\n                        break;\n                    case 13 /* KeyCode.End */:\n                        if ((event.ctrlKey || event.metaKey) && !event.shiftKey && !event.altKey) {\n                            this.ui.list.focus(QuickInputListFocus.Last);\n                            dom.EventHelper.stop(event, true);\n                        }\n                        break;\n                }\n            }));\n            this.visibleDisposables.add(this.ui.onDidAccept(() => {\n                if (this.canSelectMany) {\n                    // if there are no checked elements, it means that an onDidChangeSelection never fired to overwrite\n                    // `_selectedItems`. In that case, we should emit one with an empty array to ensure that\n                    // `.selectedItems` is up to date.\n                    if (!this.ui.list.getCheckedElements().length) {\n                        this._selectedItems = [];\n                        this.onDidChangeSelectionEmitter.fire(this.selectedItems);\n                    }\n                }\n                else if (this.activeItems[0]) {\n                    // For single-select, we set `selectedItems` to the item that was accepted.\n                    this._selectedItems = [this.activeItems[0]];\n                    this.onDidChangeSelectionEmitter.fire(this.selectedItems);\n                }\n                this.handleAccept(false);\n            }));\n            this.visibleDisposables.add(this.ui.onDidCustom(() => {\n                this.onDidCustomEmitter.fire();\n            }));\n            this.visibleDisposables.add(this.ui.list.onDidChangeFocus(focusedItems => {\n                if (this.activeItemsUpdated) {\n                    return; // Expect another event.\n                }\n                if (this.activeItemsToConfirm !== this._activeItems && equals(focusedItems, this._activeItems, (a, b) => a === b)) {\n                    return;\n                }\n                this._activeItems = focusedItems;\n                this.onDidChangeActiveEmitter.fire(focusedItems);\n            }));\n            this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({ items: selectedItems, event }) => {\n                if (this.canSelectMany) {\n                    if (selectedItems.length) {\n                        this.ui.list.setSelectedElements([]);\n                    }\n                    return;\n                }\n                if (this.selectedItemsToConfirm !== this._selectedItems && equals(selectedItems, this._selectedItems, (a, b) => a === b)) {\n                    return;\n                }\n                this._selectedItems = selectedItems;\n                this.onDidChangeSelectionEmitter.fire(selectedItems);\n                if (selectedItems.length) {\n                    this.handleAccept(event instanceof MouseEvent && event.button === 1 /* mouse middle click */);\n                }\n            }));\n            this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(checkedItems => {\n                if (!this.canSelectMany) {\n                    return;\n                }\n                if (this.selectedItemsToConfirm !== this._selectedItems && equals(checkedItems, this._selectedItems, (a, b) => a === b)) {\n                    return;\n                }\n                this._selectedItems = checkedItems;\n                this.onDidChangeSelectionEmitter.fire(checkedItems);\n            }));\n            this.visibleDisposables.add(this.ui.list.onButtonTriggered(event => this.onDidTriggerItemButtonEmitter.fire(event)));\n            this.visibleDisposables.add(this.registerQuickNavigation());\n            this.valueSelectionUpdated = true;\n        }\n        super.show(); // TODO: Why have show() bubble up while update() trickles down? (Could move setComboboxAccessibility() here.)\n    }\n    handleAccept(inBackground) {\n        // Figure out veto via `onWillAccept` event\n        let veto = false;\n        this.onWillAcceptEmitter.fire({ veto: () => veto = true });\n        // Continue with `onDidAccept` if no veto\n        if (!veto) {\n            this.onDidAcceptEmitter.fire({ inBackground });\n        }\n    }\n    registerQuickNavigation() {\n        return dom.addDisposableListener(this.ui.container, dom.EventType.KEY_UP, e => {\n            if (this.canSelectMany || !this._quickNavigate) {\n                return;\n            }\n            const keyboardEvent = new StandardKeyboardEvent(e);\n            const keyCode = keyboardEvent.keyCode;\n            // Select element when keys are pressed that signal it\n            const quickNavKeys = this._quickNavigate.keybindings;\n            const wasTriggerKeyPressed = quickNavKeys.some(k => {\n                const [firstPart, chordPart] = k.getParts();\n                if (chordPart) {\n                    return false;\n                }\n                if (firstPart.shiftKey && keyCode === 4 /* KeyCode.Shift */) {\n                    if (keyboardEvent.ctrlKey || keyboardEvent.altKey || keyboardEvent.metaKey) {\n                        return false; // this is an optimistic check for the shift key being used to navigate back in quick input\n                    }\n                    return true;\n                }\n                if (firstPart.altKey && keyCode === 6 /* KeyCode.Alt */) {\n                    return true;\n                }\n                if (firstPart.ctrlKey && keyCode === 5 /* KeyCode.Ctrl */) {\n                    return true;\n                }\n                if (firstPart.metaKey && keyCode === 57 /* KeyCode.Meta */) {\n                    return true;\n                }\n                return false;\n            });\n            if (wasTriggerKeyPressed) {\n                if (this.activeItems[0]) {\n                    this._selectedItems = [this.activeItems[0]];\n                    this.onDidChangeSelectionEmitter.fire(this.selectedItems);\n                    this.handleAccept(false);\n                }\n                // Unset quick navigate after press. It is only valid once\n                // and should not result in any behaviour change afterwards\n                // if the picker remains open because there was no active item\n                this._quickNavigate = undefined;\n            }\n        });\n    }\n    update() {\n        if (!this.visible) {\n            return;\n        }\n        // store the scrollTop before it is reset\n        const scrollTopBefore = this.keepScrollPosition ? this.scrollTop : 0;\n        const hideInput = !!this._hideInput && this._items.length > 0;\n        this.ui.container.classList.toggle('hidden-input', hideInput && !this.description);\n        const visibilities = {\n            title: !!this.title || !!this.step || !!this.buttons.length,\n            description: !!this.description,\n            checkAll: this.canSelectMany && !this._hideCheckAll,\n            checkBox: this.canSelectMany,\n            inputBox: !hideInput,\n            progressBar: !hideInput,\n            visibleCount: true,\n            count: this.canSelectMany,\n            ok: this.ok === 'default' ? this.canSelectMany : this.ok,\n            list: true,\n            message: !!this.validationMessage,\n            customButton: this.customButton\n        };\n        this.ui.setVisibilities(visibilities);\n        super.update();\n        if (this.ui.inputBox.value !== this.value) {\n            this.ui.inputBox.value = this.value;\n        }\n        if (this.valueSelectionUpdated) {\n            this.valueSelectionUpdated = false;\n            this.ui.inputBox.select(this._valueSelection && { start: this._valueSelection[0], end: this._valueSelection[1] });\n        }\n        if (this.ui.inputBox.placeholder !== (this.placeholder || '')) {\n            this.ui.inputBox.placeholder = (this.placeholder || '');\n        }\n        let ariaLabel = this.ariaLabel;\n        if (!ariaLabel) {\n            ariaLabel = this.placeholder || QuickPick.DEFAULT_ARIA_LABEL;\n            // If we have a title, include it in the aria label.\n            if (this.title) {\n                ariaLabel += ` - ${this.title}`;\n            }\n        }\n        if (this.ui.inputBox.ariaLabel !== ariaLabel) {\n            this.ui.inputBox.ariaLabel = ariaLabel;\n        }\n        this.ui.list.matchOnDescription = this.matchOnDescription;\n        this.ui.list.matchOnDetail = this.matchOnDetail;\n        this.ui.list.matchOnLabel = this.matchOnLabel;\n        this.ui.list.matchOnLabelMode = this.matchOnLabelMode;\n        this.ui.list.sortByLabel = this.sortByLabel;\n        if (this.itemsUpdated) {\n            this.itemsUpdated = false;\n            this.ui.list.setElements(this.items);\n            this.ui.list.filter(this.filterValue(this.ui.inputBox.value));\n            this.ui.checkAll.checked = this.ui.list.getAllVisibleChecked();\n            this.ui.visibleCount.setCount(this.ui.list.getVisibleCount());\n            this.ui.count.setCount(this.ui.list.getCheckedCount());\n            switch (this._itemActivation) {\n                case ItemActivation.NONE:\n                    this._itemActivation = ItemActivation.FIRST; // only valid once, then unset\n                    break;\n                case ItemActivation.SECOND:\n                    this.ui.list.focus(QuickInputListFocus.Second);\n                    this._itemActivation = ItemActivation.FIRST; // only valid once, then unset\n                    break;\n                case ItemActivation.LAST:\n                    this.ui.list.focus(QuickInputListFocus.Last);\n                    this._itemActivation = ItemActivation.FIRST; // only valid once, then unset\n                    break;\n                default:\n                    this.trySelectFirst();\n                    break;\n            }\n        }\n        if (this.ui.container.classList.contains('show-checkboxes') !== !!this.canSelectMany) {\n            if (this.canSelectMany) {\n                this.ui.list.clearFocus();\n            }\n            else {\n                this.trySelectFirst();\n            }\n        }\n        if (this.activeItemsUpdated) {\n            this.activeItemsUpdated = false;\n            this.activeItemsToConfirm = this._activeItems;\n            this.ui.list.setFocusedElements(this.activeItems);\n            if (this.activeItemsToConfirm === this._activeItems) {\n                this.activeItemsToConfirm = null;\n            }\n        }\n        if (this.selectedItemsUpdated) {\n            this.selectedItemsUpdated = false;\n            this.selectedItemsToConfirm = this._selectedItems;\n            if (this.canSelectMany) {\n                this.ui.list.setCheckedElements(this.selectedItems);\n            }\n            else {\n                this.ui.list.setSelectedElements(this.selectedItems);\n            }\n            if (this.selectedItemsToConfirm === this._selectedItems) {\n                this.selectedItemsToConfirm = null;\n            }\n        }\n        this.ui.customButton.label = this.customLabel || '';\n        this.ui.customButton.element.title = this.customHover || '';\n        this.ui.setComboboxAccessibility(true);\n        if (!visibilities.inputBox) {\n            // we need to move focus into the tree to detect keybindings\n            // properly when the input box is not visible (quick nav)\n            this.ui.list.domFocus();\n            // Focus the first element in the list if multiselect is enabled\n            if (this.canSelectMany) {\n                this.ui.list.focus(QuickInputListFocus.First);\n            }\n        }\n        // Set the scroll position to what it was before updating the items\n        if (this.keepScrollPosition) {\n            this.scrollTop = scrollTopBefore;\n        }\n    }\n}\nQuickPick.DEFAULT_ARIA_LABEL = localize('quickInputBox.ariaLabel', \"Type to narrow down results.\");\nexport class QuickInputController extends Disposable {\n    constructor(options) {\n        super();\n        this.options = options;\n        this.comboboxAccessibility = false;\n        this.enabled = true;\n        this.onDidAcceptEmitter = this._register(new Emitter());\n        this.onDidCustomEmitter = this._register(new Emitter());\n        this.onDidTriggerButtonEmitter = this._register(new Emitter());\n        this.keyMods = { ctrlCmd: false, alt: false };\n        this.controller = null;\n        this.onShowEmitter = this._register(new Emitter());\n        this.onShow = this.onShowEmitter.event;\n        this.onHideEmitter = this._register(new Emitter());\n        this.onHide = this.onHideEmitter.event;\n        this.idPrefix = options.idPrefix;\n        this.parentElement = options.container;\n        this.styles = options.styles;\n        this.registerKeyModsListeners();\n    }\n    registerKeyModsListeners() {\n        const listener = (e) => {\n            this.keyMods.ctrlCmd = e.ctrlKey || e.metaKey;\n            this.keyMods.alt = e.altKey;\n        };\n        this._register(dom.addDisposableListener(window, dom.EventType.KEY_DOWN, listener, true));\n        this._register(dom.addDisposableListener(window, dom.EventType.KEY_UP, listener, true));\n        this._register(dom.addDisposableListener(window, dom.EventType.MOUSE_DOWN, listener, true));\n    }\n    getUI() {\n        if (this.ui) {\n            return this.ui;\n        }\n        const container = dom.append(this.parentElement, $('.quick-input-widget.show-file-icons'));\n        container.tabIndex = -1;\n        container.style.display = 'none';\n        const styleSheet = dom.createStyleSheet(container);\n        const titleBar = dom.append(container, $('.quick-input-titlebar'));\n        const leftActionBar = this._register(new ActionBar(titleBar));\n        leftActionBar.domNode.classList.add('quick-input-left-action-bar');\n        const title = dom.append(titleBar, $('.quick-input-title'));\n        const rightActionBar = this._register(new ActionBar(titleBar));\n        rightActionBar.domNode.classList.add('quick-input-right-action-bar');\n        const description1 = dom.append(container, $('.quick-input-description'));\n        const headerContainer = dom.append(container, $('.quick-input-header'));\n        const checkAll = dom.append(headerContainer, $('input.quick-input-check-all'));\n        checkAll.type = 'checkbox';\n        checkAll.setAttribute('aria-label', localize('quickInput.checkAll', \"Toggle all checkboxes\"));\n        this._register(dom.addStandardDisposableListener(checkAll, dom.EventType.CHANGE, e => {\n            const checked = checkAll.checked;\n            list.setAllVisibleChecked(checked);\n        }));\n        this._register(dom.addDisposableListener(checkAll, dom.EventType.CLICK, e => {\n            if (e.x || e.y) { // Avoid 'click' triggered by 'space'...\n                inputBox.setFocus();\n            }\n        }));\n        const description2 = dom.append(headerContainer, $('.quick-input-description'));\n        const extraContainer = dom.append(headerContainer, $('.quick-input-and-message'));\n        const filterContainer = dom.append(extraContainer, $('.quick-input-filter'));\n        const inputBox = this._register(new QuickInputBox(filterContainer));\n        inputBox.setAttribute('aria-describedby', `${this.idPrefix}message`);\n        const visibleCountContainer = dom.append(filterContainer, $('.quick-input-visible-count'));\n        visibleCountContainer.setAttribute('aria-live', 'polite');\n        visibleCountContainer.setAttribute('aria-atomic', 'true');\n        const visibleCount = new CountBadge(visibleCountContainer, { countFormat: localize({ key: 'quickInput.visibleCount', comment: ['This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers.'] }, \"{0} Results\") });\n        const countContainer = dom.append(filterContainer, $('.quick-input-count'));\n        countContainer.setAttribute('aria-live', 'polite');\n        const count = new CountBadge(countContainer, { countFormat: localize({ key: 'quickInput.countSelected', comment: ['This tells the user how many items are selected in a list of items to select from. The items can be anything.'] }, \"{0} Selected\") });\n        const okContainer = dom.append(headerContainer, $('.quick-input-action'));\n        const ok = new Button(okContainer);\n        ok.label = localize('ok', \"OK\");\n        this._register(ok.onDidClick(e => {\n            this.onDidAcceptEmitter.fire();\n        }));\n        const customButtonContainer = dom.append(headerContainer, $('.quick-input-action'));\n        const customButton = new Button(customButtonContainer);\n        customButton.label = localize('custom', \"Custom\");\n        this._register(customButton.onDidClick(e => {\n            this.onDidCustomEmitter.fire();\n        }));\n        const message = dom.append(extraContainer, $(`#${this.idPrefix}message.quick-input-message`));\n        const list = this._register(new QuickInputList(container, this.idPrefix + 'list', this.options));\n        this._register(list.onChangedAllVisibleChecked(checked => {\n            checkAll.checked = checked;\n        }));\n        this._register(list.onChangedVisibleCount(c => {\n            visibleCount.setCount(c);\n        }));\n        this._register(list.onChangedCheckedCount(c => {\n            count.setCount(c);\n        }));\n        this._register(list.onLeave(() => {\n            // Defer to avoid the input field reacting to the triggering key.\n            setTimeout(() => {\n                inputBox.setFocus();\n                if (this.controller instanceof QuickPick && this.controller.canSelectMany) {\n                    list.clearFocus();\n                }\n            }, 0);\n        }));\n        this._register(list.onDidChangeFocus(() => {\n            if (this.comboboxAccessibility) {\n                this.getUI().inputBox.setAttribute('aria-activedescendant', this.getUI().list.getActiveDescendant() || '');\n            }\n        }));\n        const progressBar = new ProgressBar(container);\n        progressBar.getContainer().classList.add('quick-input-progress');\n        const focusTracker = dom.trackFocus(container);\n        this._register(focusTracker);\n        this._register(dom.addDisposableListener(container, dom.EventType.FOCUS, e => {\n            this.previousFocusElement = e.relatedTarget instanceof HTMLElement ? e.relatedTarget : undefined;\n        }, true));\n        this._register(focusTracker.onDidBlur(() => {\n            if (!this.getUI().ignoreFocusOut && !this.options.ignoreFocusOut()) {\n                this.hide(QuickInputHideReason.Blur);\n            }\n            this.previousFocusElement = undefined;\n        }));\n        this._register(dom.addDisposableListener(container, dom.EventType.FOCUS, (e) => {\n            inputBox.setFocus();\n        }));\n        this._register(dom.addDisposableListener(container, dom.EventType.KEY_DOWN, (e) => {\n            const event = new StandardKeyboardEvent(e);\n            switch (event.keyCode) {\n                case 3 /* KeyCode.Enter */:\n                    dom.EventHelper.stop(e, true);\n                    this.onDidAcceptEmitter.fire();\n                    break;\n                case 9 /* KeyCode.Escape */:\n                    dom.EventHelper.stop(e, true);\n                    this.hide(QuickInputHideReason.Gesture);\n                    break;\n                case 2 /* KeyCode.Tab */:\n                    if (!event.altKey && !event.ctrlKey && !event.metaKey) {\n                        const selectors = ['.action-label.codicon'];\n                        if (container.classList.contains('show-checkboxes')) {\n                            selectors.push('input');\n                        }\n                        else {\n                            selectors.push('input[type=text]');\n                        }\n                        if (this.getUI().list.isDisplayed()) {\n                            selectors.push('.monaco-list');\n                        }\n                        const stops = container.querySelectorAll(selectors.join(', '));\n                        if (event.shiftKey && event.target === stops[0]) {\n                            dom.EventHelper.stop(e, true);\n                            stops[stops.length - 1].focus();\n                        }\n                        else if (!event.shiftKey && event.target === stops[stops.length - 1]) {\n                            dom.EventHelper.stop(e, true);\n                            stops[0].focus();\n                        }\n                    }\n                    break;\n            }\n        }));\n        this.ui = {\n            container,\n            styleSheet,\n            leftActionBar,\n            titleBar,\n            title,\n            description1,\n            description2,\n            rightActionBar,\n            checkAll,\n            filterContainer,\n            inputBox,\n            visibleCountContainer,\n            visibleCount,\n            countContainer,\n            count,\n            okContainer,\n            ok,\n            message,\n            customButtonContainer,\n            customButton,\n            list,\n            progressBar,\n            onDidAccept: this.onDidAcceptEmitter.event,\n            onDidCustom: this.onDidCustomEmitter.event,\n            onDidTriggerButton: this.onDidTriggerButtonEmitter.event,\n            ignoreFocusOut: false,\n            keyMods: this.keyMods,\n            isScreenReaderOptimized: () => this.options.isScreenReaderOptimized(),\n            show: controller => this.show(controller),\n            hide: () => this.hide(),\n            setVisibilities: visibilities => this.setVisibilities(visibilities),\n            setComboboxAccessibility: enabled => this.setComboboxAccessibility(enabled),\n            setEnabled: enabled => this.setEnabled(enabled),\n            setContextKey: contextKey => this.options.setContextKey(contextKey),\n        };\n        this.updateStyles();\n        return this.ui;\n    }\n    pick(picks, options = {}, token = CancellationToken.None) {\n        return new Promise((doResolve, reject) => {\n            let resolve = (result) => {\n                var _a;\n                resolve = doResolve;\n                (_a = options.onKeyMods) === null || _a === void 0 ? void 0 : _a.call(options, input.keyMods);\n                doResolve(result);\n            };\n            if (token.isCancellationRequested) {\n                resolve(undefined);\n                return;\n            }\n            const input = this.createQuickPick();\n            let activeItem;\n            const disposables = [\n                input,\n                input.onDidAccept(() => {\n                    if (input.canSelectMany) {\n                        resolve(input.selectedItems.slice());\n                        input.hide();\n                    }\n                    else {\n                        const result = input.activeItems[0];\n                        if (result) {\n                            resolve(result);\n                            input.hide();\n                        }\n                    }\n                }),\n                input.onDidChangeActive(items => {\n                    const focused = items[0];\n                    if (focused && options.onDidFocus) {\n                        options.onDidFocus(focused);\n                    }\n                }),\n                input.onDidChangeSelection(items => {\n                    if (!input.canSelectMany) {\n                        const result = items[0];\n                        if (result) {\n                            resolve(result);\n                            input.hide();\n                        }\n                    }\n                }),\n                input.onDidTriggerItemButton(event => options.onDidTriggerItemButton && options.onDidTriggerItemButton(Object.assign(Object.assign({}, event), { removeItem: () => {\n                        const index = input.items.indexOf(event.item);\n                        if (index !== -1) {\n                            const items = input.items.slice();\n                            const removed = items.splice(index, 1);\n                            const activeItems = input.activeItems.filter(activeItem => activeItem !== removed[0]);\n                            const keepScrollPositionBefore = input.keepScrollPosition;\n                            input.keepScrollPosition = true;\n                            input.items = items;\n                            if (activeItems) {\n                                input.activeItems = activeItems;\n                            }\n                            input.keepScrollPosition = keepScrollPositionBefore;\n                        }\n                    } }))),\n                input.onDidChangeValue(value => {\n                    if (activeItem && !value && (input.activeItems.length !== 1 || input.activeItems[0] !== activeItem)) {\n                        input.activeItems = [activeItem];\n                    }\n                }),\n                token.onCancellationRequested(() => {\n                    input.hide();\n                }),\n                input.onDidHide(() => {\n                    dispose(disposables);\n                    resolve(undefined);\n                }),\n            ];\n            input.title = options.title;\n            input.canSelectMany = !!options.canPickMany;\n            input.placeholder = options.placeHolder;\n            input.ignoreFocusOut = !!options.ignoreFocusLost;\n            input.matchOnDescription = !!options.matchOnDescription;\n            input.matchOnDetail = !!options.matchOnDetail;\n            input.matchOnLabel = (options.matchOnLabel === undefined) || options.matchOnLabel; // default to true\n            input.autoFocusOnList = (options.autoFocusOnList === undefined) || options.autoFocusOnList; // default to true\n            input.quickNavigate = options.quickNavigate;\n            input.hideInput = !!options.hideInput;\n            input.contextKey = options.contextKey;\n            input.busy = true;\n            Promise.all([picks, options.activeItem])\n                .then(([items, _activeItem]) => {\n                activeItem = _activeItem;\n                input.busy = false;\n                input.items = items;\n                if (input.canSelectMany) {\n                    input.selectedItems = items.filter(item => item.type !== 'separator' && item.picked);\n                }\n                if (activeItem) {\n                    input.activeItems = [activeItem];\n                }\n            });\n            input.show();\n            Promise.resolve(picks).then(undefined, err => {\n                reject(err);\n                input.hide();\n            });\n        });\n    }\n    createQuickPick() {\n        const ui = this.getUI();\n        return new QuickPick(ui);\n    }\n    show(controller) {\n        const ui = this.getUI();\n        this.onShowEmitter.fire();\n        const oldController = this.controller;\n        this.controller = controller;\n        if (oldController) {\n            oldController.didHide();\n        }\n        this.setEnabled(true);\n        ui.leftActionBar.clear();\n        ui.title.textContent = '';\n        ui.description1.textContent = '';\n        ui.description2.textContent = '';\n        ui.rightActionBar.clear();\n        ui.checkAll.checked = false;\n        // ui.inputBox.value = ''; Avoid triggering an event.\n        ui.inputBox.placeholder = '';\n        ui.inputBox.password = false;\n        ui.inputBox.showDecoration(Severity.Ignore);\n        ui.visibleCount.setCount(0);\n        ui.count.setCount(0);\n        dom.reset(ui.message);\n        ui.progressBar.stop();\n        ui.list.setElements([]);\n        ui.list.matchOnDescription = false;\n        ui.list.matchOnDetail = false;\n        ui.list.matchOnLabel = true;\n        ui.list.sortByLabel = true;\n        ui.ignoreFocusOut = false;\n        this.setComboboxAccessibility(false);\n        ui.inputBox.ariaLabel = '';\n        const backKeybindingLabel = this.options.backKeybindingLabel();\n        backButton.tooltip = backKeybindingLabel ? localize('quickInput.backWithKeybinding', \"Back ({0})\", backKeybindingLabel) : localize('quickInput.back', \"Back\");\n        ui.container.style.display = '';\n        this.updateLayout();\n        ui.inputBox.setFocus();\n    }\n    setVisibilities(visibilities) {\n        const ui = this.getUI();\n        ui.title.style.display = visibilities.title ? '' : 'none';\n        ui.description1.style.display = visibilities.description && (visibilities.inputBox || visibilities.checkAll) ? '' : 'none';\n        ui.description2.style.display = visibilities.description && !(visibilities.inputBox || visibilities.checkAll) ? '' : 'none';\n        ui.checkAll.style.display = visibilities.checkAll ? '' : 'none';\n        ui.filterContainer.style.display = visibilities.inputBox ? '' : 'none';\n        ui.visibleCountContainer.style.display = visibilities.visibleCount ? '' : 'none';\n        ui.countContainer.style.display = visibilities.count ? '' : 'none';\n        ui.okContainer.style.display = visibilities.ok ? '' : 'none';\n        ui.customButtonContainer.style.display = visibilities.customButton ? '' : 'none';\n        ui.message.style.display = visibilities.message ? '' : 'none';\n        ui.progressBar.getContainer().style.display = visibilities.progressBar ? '' : 'none';\n        ui.list.display(!!visibilities.list);\n        ui.container.classList[visibilities.checkBox ? 'add' : 'remove']('show-checkboxes');\n        this.updateLayout(); // TODO\n    }\n    setComboboxAccessibility(enabled) {\n        if (enabled !== this.comboboxAccessibility) {\n            const ui = this.getUI();\n            this.comboboxAccessibility = enabled;\n            if (this.comboboxAccessibility) {\n                ui.inputBox.setAttribute('role', 'combobox');\n                ui.inputBox.setAttribute('aria-haspopup', 'true');\n                ui.inputBox.setAttribute('aria-autocomplete', 'list');\n                ui.inputBox.setAttribute('aria-activedescendant', ui.list.getActiveDescendant() || '');\n            }\n            else {\n                ui.inputBox.removeAttribute('role');\n                ui.inputBox.removeAttribute('aria-haspopup');\n                ui.inputBox.removeAttribute('aria-autocomplete');\n                ui.inputBox.removeAttribute('aria-activedescendant');\n            }\n        }\n    }\n    setEnabled(enabled) {\n        if (enabled !== this.enabled) {\n            this.enabled = enabled;\n            for (const item of this.getUI().leftActionBar.viewItems) {\n                item.getAction().enabled = enabled;\n            }\n            for (const item of this.getUI().rightActionBar.viewItems) {\n                item.getAction().enabled = enabled;\n            }\n            this.getUI().checkAll.disabled = !enabled;\n            // this.getUI().inputBox.enabled = enabled; Avoid loosing focus.\n            this.getUI().ok.enabled = enabled;\n            this.getUI().list.enabled = enabled;\n        }\n    }\n    hide(reason) {\n        var _a;\n        const controller = this.controller;\n        if (controller) {\n            const focusChanged = !((_a = this.ui) === null || _a === void 0 ? void 0 : _a.container.contains(document.activeElement));\n            this.controller = null;\n            this.onHideEmitter.fire();\n            this.getUI().container.style.display = 'none';\n            if (!focusChanged) {\n                let currentElement = this.previousFocusElement;\n                while (currentElement && !currentElement.offsetParent) {\n                    currentElement = withNullAsUndefined(currentElement.parentElement);\n                }\n                if (currentElement === null || currentElement === void 0 ? void 0 : currentElement.offsetParent) {\n                    currentElement.focus();\n                    this.previousFocusElement = undefined;\n                }\n                else {\n                    this.options.returnFocus();\n                }\n            }\n            controller.didHide(reason);\n        }\n    }\n    layout(dimension, titleBarOffset) {\n        this.dimension = dimension;\n        this.titleBarOffset = titleBarOffset;\n        this.updateLayout();\n    }\n    updateLayout() {\n        if (this.ui) {\n            this.ui.container.style.top = `${this.titleBarOffset}px`;\n            const style = this.ui.container.style;\n            const width = Math.min(this.dimension.width * 0.62 /* golden cut */, QuickInputController.MAX_WIDTH);\n            style.width = width + 'px';\n            style.marginLeft = '-' + (width / 2) + 'px';\n            this.ui.inputBox.layout();\n            this.ui.list.layout(this.dimension && this.dimension.height * 0.4);\n        }\n    }\n    applyStyles(styles) {\n        this.styles = styles;\n        this.updateStyles();\n    }\n    updateStyles() {\n        if (this.ui) {\n            const { quickInputTitleBackground, quickInputBackground, quickInputForeground, contrastBorder, widgetShadow, } = this.styles.widget;\n            this.ui.titleBar.style.backgroundColor = quickInputTitleBackground ? quickInputTitleBackground.toString() : '';\n            this.ui.container.style.backgroundColor = quickInputBackground ? quickInputBackground.toString() : '';\n            this.ui.container.style.color = quickInputForeground ? quickInputForeground.toString() : '';\n            this.ui.container.style.border = contrastBorder ? `1px solid ${contrastBorder}` : '';\n            this.ui.container.style.boxShadow = widgetShadow ? `0 0 8px 2px ${widgetShadow}` : '';\n            this.ui.inputBox.style(this.styles.inputBox);\n            this.ui.count.style(this.styles.countBadge);\n            this.ui.ok.style(this.styles.button);\n            this.ui.customButton.style(this.styles.button);\n            this.ui.progressBar.style(this.styles.progressBar);\n            this.ui.list.style(this.styles.list);\n            const content = [];\n            if (this.styles.list.pickerGroupBorder) {\n                content.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.list.pickerGroupBorder}; }`);\n            }\n            if (this.styles.list.pickerGroupForeground) {\n                content.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.list.pickerGroupForeground}; }`);\n            }\n            if (this.styles.keybindingLabel.keybindingLabelBackground ||\n                this.styles.keybindingLabel.keybindingLabelBorder ||\n                this.styles.keybindingLabel.keybindingLabelBottomBorder ||\n                this.styles.keybindingLabel.keybindingLabelShadow ||\n                this.styles.keybindingLabel.keybindingLabelForeground) {\n                content.push('.quick-input-list .monaco-keybinding > .monaco-keybinding-key {');\n                if (this.styles.keybindingLabel.keybindingLabelBackground) {\n                    content.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`);\n                }\n                if (this.styles.keybindingLabel.keybindingLabelBorder) {\n                    // Order matters here. `border-color` must come before `border-bottom-color`.\n                    content.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`);\n                }\n                if (this.styles.keybindingLabel.keybindingLabelBottomBorder) {\n                    content.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`);\n                }\n                if (this.styles.keybindingLabel.keybindingLabelShadow) {\n                    content.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`);\n                }\n                if (this.styles.keybindingLabel.keybindingLabelForeground) {\n                    content.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`);\n                }\n                content.push('}');\n            }\n            const newStyles = content.join('\\n');\n            if (newStyles !== this.ui.styleSheet.textContent) {\n                this.ui.styleSheet.textContent = newStyles;\n            }\n        }\n    }\n}\nQuickInputController.MAX_WIDTH = 600; // Max total width of quick input widget\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../base/common/arrays.js';\nimport { toDisposable } from '../../../base/common/lifecycle.js';\nimport { Registry } from '../../registry/common/platform.js';\nexport var DefaultQuickAccessFilterValue;\n(function (DefaultQuickAccessFilterValue) {\n    /**\n     * Keep the value as it is given to quick access.\n     */\n    DefaultQuickAccessFilterValue[DefaultQuickAccessFilterValue[\"PRESERVE\"] = 0] = \"PRESERVE\";\n    /**\n     * Use the value that was used last time something was accepted from the picker.\n     */\n    DefaultQuickAccessFilterValue[DefaultQuickAccessFilterValue[\"LAST\"] = 1] = \"LAST\";\n})(DefaultQuickAccessFilterValue || (DefaultQuickAccessFilterValue = {}));\nexport const Extensions = {\n    Quickaccess: 'workbench.contributions.quickaccess'\n};\nexport class QuickAccessRegistry {\n    constructor() {\n        this.providers = [];\n        this.defaultProvider = undefined;\n    }\n    registerQuickAccessProvider(provider) {\n        // Extract the default provider when no prefix is present\n        if (provider.prefix.length === 0) {\n            this.defaultProvider = provider;\n        }\n        else {\n            this.providers.push(provider);\n        }\n        // sort the providers by decreasing prefix length, such that longer\n        // prefixes take priority: 'ext' vs 'ext install' - the latter should win\n        this.providers.sort((providerA, providerB) => providerB.prefix.length - providerA.prefix.length);\n        return toDisposable(() => {\n            this.providers.splice(this.providers.indexOf(provider), 1);\n            if (this.defaultProvider === provider) {\n                this.defaultProvider = undefined;\n            }\n        });\n    }\n    getQuickAccessProviders() {\n        return coalesce([this.defaultProvider, ...this.providers]);\n    }\n    getQuickAccessProvider(prefix) {\n        const result = prefix ? (this.providers.find(provider => prefix.startsWith(provider.prefix)) || undefined) : undefined;\n        return result || this.defaultProvider;\n    }\n}\nRegistry.add(Extensions.Quickaccess, new QuickAccessRegistry());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DeferredPromise } from '../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { once } from '../../../base/common/functional.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../base/common/lifecycle.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { DefaultQuickAccessFilterValue, Extensions } from '../common/quickAccess.js';\nimport { IQuickInputService, ItemActivation } from '../common/quickInput.js';\nimport { Registry } from '../../registry/common/platform.js';\nlet QuickAccessController = class QuickAccessController extends Disposable {\n    constructor(quickInputService, instantiationService) {\n        super();\n        this.quickInputService = quickInputService;\n        this.instantiationService = instantiationService;\n        this.registry = Registry.as(Extensions.Quickaccess);\n        this.mapProviderToDescriptor = new Map();\n        this.lastAcceptedPickerValues = new Map();\n        this.visibleQuickAccess = undefined;\n    }\n    show(value = '', options) {\n        this.doShowOrPick(value, false, options);\n    }\n    doShowOrPick(value, pick, options) {\n        var _a;\n        // Find provider for the value to show\n        const [provider, descriptor] = this.getOrInstantiateProvider(value);\n        // Return early if quick access is already showing on that same prefix\n        const visibleQuickAccess = this.visibleQuickAccess;\n        const visibleDescriptor = visibleQuickAccess === null || visibleQuickAccess === void 0 ? void 0 : visibleQuickAccess.descriptor;\n        if (visibleQuickAccess && descriptor && visibleDescriptor === descriptor) {\n            // Apply value only if it is more specific than the prefix\n            // from the provider and we are not instructed to preserve\n            if (value !== descriptor.prefix && !(options === null || options === void 0 ? void 0 : options.preserveValue)) {\n                visibleQuickAccess.picker.value = value;\n            }\n            // Always adjust selection\n            this.adjustValueSelection(visibleQuickAccess.picker, descriptor, options);\n            return;\n        }\n        // Rewrite the filter value based on certain rules unless disabled\n        if (descriptor && !(options === null || options === void 0 ? void 0 : options.preserveValue)) {\n            let newValue = undefined;\n            // If we have a visible provider with a value, take it's filter value but\n            // rewrite to new provider prefix in case they differ\n            if (visibleQuickAccess && visibleDescriptor && visibleDescriptor !== descriptor) {\n                const newValueCandidateWithoutPrefix = visibleQuickAccess.value.substr(visibleDescriptor.prefix.length);\n                if (newValueCandidateWithoutPrefix) {\n                    newValue = `${descriptor.prefix}${newValueCandidateWithoutPrefix}`;\n                }\n            }\n            // Otherwise, take a default value as instructed\n            if (!newValue) {\n                const defaultFilterValue = provider === null || provider === void 0 ? void 0 : provider.defaultFilterValue;\n                if (defaultFilterValue === DefaultQuickAccessFilterValue.LAST) {\n                    newValue = this.lastAcceptedPickerValues.get(descriptor);\n                }\n                else if (typeof defaultFilterValue === 'string') {\n                    newValue = `${descriptor.prefix}${defaultFilterValue}`;\n                }\n            }\n            if (typeof newValue === 'string') {\n                value = newValue;\n            }\n        }\n        // Create a picker for the provider to use with the initial value\n        // and adjust the filtering to exclude the prefix from filtering\n        const disposables = new DisposableStore();\n        const picker = disposables.add(this.quickInputService.createQuickPick());\n        picker.value = value;\n        this.adjustValueSelection(picker, descriptor, options);\n        picker.placeholder = descriptor === null || descriptor === void 0 ? void 0 : descriptor.placeholder;\n        picker.quickNavigate = options === null || options === void 0 ? void 0 : options.quickNavigateConfiguration;\n        picker.hideInput = !!picker.quickNavigate && !visibleQuickAccess; // only hide input if there was no picker opened already\n        if (typeof (options === null || options === void 0 ? void 0 : options.itemActivation) === 'number' || (options === null || options === void 0 ? void 0 : options.quickNavigateConfiguration)) {\n            picker.itemActivation = (_a = options === null || options === void 0 ? void 0 : options.itemActivation) !== null && _a !== void 0 ? _a : ItemActivation.SECOND /* quick nav is always second */;\n        }\n        picker.contextKey = descriptor === null || descriptor === void 0 ? void 0 : descriptor.contextKey;\n        picker.filterValue = (value) => value.substring(descriptor ? descriptor.prefix.length : 0);\n        if (descriptor === null || descriptor === void 0 ? void 0 : descriptor.placeholder) {\n            picker.ariaLabel = descriptor === null || descriptor === void 0 ? void 0 : descriptor.placeholder;\n        }\n        // Pick mode: setup a promise that can be resolved\n        // with the selected items and prevent execution\n        let pickPromise = undefined;\n        if (pick) {\n            pickPromise = new DeferredPromise();\n            disposables.add(once(picker.onWillAccept)(e => {\n                e.veto();\n                picker.hide();\n            }));\n        }\n        // Register listeners\n        disposables.add(this.registerPickerListeners(picker, provider, descriptor, value));\n        // Ask provider to fill the picker as needed if we have one\n        // and pass over a cancellation token that will indicate when\n        // the picker is hiding without a pick being made.\n        const cts = disposables.add(new CancellationTokenSource());\n        if (provider) {\n            disposables.add(provider.provide(picker, cts.token));\n        }\n        // Finally, trigger disposal and cancellation when the picker\n        // hides depending on items selected or not.\n        once(picker.onDidHide)(() => {\n            if (picker.selectedItems.length === 0) {\n                cts.cancel();\n            }\n            // Start to dispose once picker hides\n            disposables.dispose();\n            // Resolve pick promise with selected items\n            pickPromise === null || pickPromise === void 0 ? void 0 : pickPromise.complete(picker.selectedItems.slice(0));\n        });\n        // Finally, show the picker. This is important because a provider\n        // may not call this and then our disposables would leak that rely\n        // on the onDidHide event.\n        picker.show();\n        // Pick mode: return with promise\n        if (pick) {\n            return pickPromise === null || pickPromise === void 0 ? void 0 : pickPromise.p;\n        }\n    }\n    adjustValueSelection(picker, descriptor, options) {\n        var _a;\n        let valueSelection;\n        // Preserve: just always put the cursor at the end\n        if (options === null || options === void 0 ? void 0 : options.preserveValue) {\n            valueSelection = [picker.value.length, picker.value.length];\n        }\n        // Otherwise: select the value up until the prefix\n        else {\n            valueSelection = [(_a = descriptor === null || descriptor === void 0 ? void 0 : descriptor.prefix.length) !== null && _a !== void 0 ? _a : 0, picker.value.length];\n        }\n        picker.valueSelection = valueSelection;\n    }\n    registerPickerListeners(picker, provider, descriptor, value) {\n        const disposables = new DisposableStore();\n        // Remember as last visible picker and clean up once picker get's disposed\n        const visibleQuickAccess = this.visibleQuickAccess = { picker, descriptor, value };\n        disposables.add(toDisposable(() => {\n            if (visibleQuickAccess === this.visibleQuickAccess) {\n                this.visibleQuickAccess = undefined;\n            }\n        }));\n        // Whenever the value changes, check if the provider has\n        // changed and if so - re-create the picker from the beginning\n        disposables.add(picker.onDidChangeValue(value => {\n            const [providerForValue] = this.getOrInstantiateProvider(value);\n            if (providerForValue !== provider) {\n                this.show(value, { preserveValue: true } /* do not rewrite value from user typing! */);\n            }\n            else {\n                visibleQuickAccess.value = value; // remember the value in our visible one\n            }\n        }));\n        // Remember picker input for future use when accepting\n        if (descriptor) {\n            disposables.add(picker.onDidAccept(() => {\n                this.lastAcceptedPickerValues.set(descriptor, picker.value);\n            }));\n        }\n        return disposables;\n    }\n    getOrInstantiateProvider(value) {\n        const providerDescriptor = this.registry.getQuickAccessProvider(value);\n        if (!providerDescriptor) {\n            return [undefined, undefined];\n        }\n        let provider = this.mapProviderToDescriptor.get(providerDescriptor);\n        if (!provider) {\n            provider = this.instantiationService.createInstance(providerDescriptor.ctor);\n            this.mapProviderToDescriptor.set(providerDescriptor, provider);\n        }\n        return [provider, providerDescriptor];\n    }\n};\nQuickAccessController = __decorate([\n    __param(0, IQuickInputService),\n    __param(1, IInstantiationService)\n], QuickAccessController);\nexport { QuickAccessController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { QuickInputController } from '../../../base/parts/quickinput/browser/quickInput.js';\nimport { IAccessibilityService } from '../../accessibility/common/accessibility.js';\nimport { IContextKeyService, RawContextKey } from '../../contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { ILayoutService } from '../../layout/browser/layoutService.js';\nimport { WorkbenchList } from '../../list/browser/listService.js';\nimport { QuickAccessController } from './quickAccess.js';\nimport { activeContrastBorder, badgeBackground, badgeForeground, buttonBackground, buttonForeground, buttonHoverBackground, contrastBorder, inputBackground, inputBorder, inputForeground, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, inputValidationInfoBackground, inputValidationInfoBorder, inputValidationInfoForeground, inputValidationWarningBackground, inputValidationWarningBorder, inputValidationWarningForeground, keybindingLabelBackground, keybindingLabelBorder, keybindingLabelBottomBorder, keybindingLabelForeground, pickerGroupBorder, pickerGroupForeground, progressBarBackground, quickInputBackground, quickInputForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, quickInputTitleBackground, widgetShadow } from '../../theme/common/colorRegistry.js';\nimport { computeStyles } from '../../theme/common/styler.js';\nimport { IThemeService, Themable } from '../../theme/common/themeService.js';\nlet QuickInputService = class QuickInputService extends Themable {\n    constructor(instantiationService, contextKeyService, themeService, accessibilityService, layoutService) {\n        super(themeService);\n        this.instantiationService = instantiationService;\n        this.contextKeyService = contextKeyService;\n        this.accessibilityService = accessibilityService;\n        this.layoutService = layoutService;\n        this.contexts = new Map();\n    }\n    get controller() {\n        if (!this._controller) {\n            this._controller = this._register(this.createController());\n        }\n        return this._controller;\n    }\n    get quickAccess() {\n        if (!this._quickAccess) {\n            this._quickAccess = this._register(this.instantiationService.createInstance(QuickAccessController));\n        }\n        return this._quickAccess;\n    }\n    createController(host = this.layoutService, options) {\n        const defaultOptions = {\n            idPrefix: 'quickInput_',\n            container: host.container,\n            ignoreFocusOut: () => false,\n            isScreenReaderOptimized: () => this.accessibilityService.isScreenReaderOptimized(),\n            backKeybindingLabel: () => undefined,\n            setContextKey: (id) => this.setContextKey(id),\n            returnFocus: () => host.focus(),\n            createList: (user, container, delegate, renderers, options) => this.instantiationService.createInstance(WorkbenchList, user, container, delegate, renderers, options),\n            styles: this.computeStyles()\n        };\n        const controller = this._register(new QuickInputController(Object.assign(Object.assign({}, defaultOptions), options)));\n        controller.layout(host.dimension, host.offset.quickPickTop);\n        // Layout changes\n        this._register(host.onDidLayout(dimension => controller.layout(dimension, host.offset.quickPickTop)));\n        // Context keys\n        this._register(controller.onShow(() => this.resetContextKeys()));\n        this._register(controller.onHide(() => this.resetContextKeys()));\n        return controller;\n    }\n    setContextKey(id) {\n        let key;\n        if (id) {\n            key = this.contexts.get(id);\n            if (!key) {\n                key = new RawContextKey(id, false)\n                    .bindTo(this.contextKeyService);\n                this.contexts.set(id, key);\n            }\n        }\n        if (key && key.get()) {\n            return; // already active context\n        }\n        this.resetContextKeys();\n        key === null || key === void 0 ? void 0 : key.set(true);\n    }\n    resetContextKeys() {\n        this.contexts.forEach(context => {\n            if (context.get()) {\n                context.reset();\n            }\n        });\n    }\n    pick(picks, options = {}, token = CancellationToken.None) {\n        return this.controller.pick(picks, options, token);\n    }\n    createQuickPick() {\n        return this.controller.createQuickPick();\n    }\n    updateStyles() {\n        this.controller.applyStyles(this.computeStyles());\n    }\n    computeStyles() {\n        return {\n            widget: Object.assign({}, computeStyles(this.theme, {\n                quickInputBackground,\n                quickInputForeground,\n                quickInputTitleBackground,\n                contrastBorder,\n                widgetShadow\n            })),\n            inputBox: computeStyles(this.theme, {\n                inputForeground,\n                inputBackground,\n                inputBorder,\n                inputValidationInfoBackground,\n                inputValidationInfoForeground,\n                inputValidationInfoBorder,\n                inputValidationWarningBackground,\n                inputValidationWarningForeground,\n                inputValidationWarningBorder,\n                inputValidationErrorBackground,\n                inputValidationErrorForeground,\n                inputValidationErrorBorder\n            }),\n            countBadge: computeStyles(this.theme, {\n                badgeBackground,\n                badgeForeground,\n                badgeBorder: contrastBorder\n            }),\n            button: computeStyles(this.theme, {\n                buttonForeground,\n                buttonBackground,\n                buttonHoverBackground,\n                buttonBorder: contrastBorder\n            }),\n            progressBar: computeStyles(this.theme, {\n                progressBarBackground\n            }),\n            keybindingLabel: computeStyles(this.theme, {\n                keybindingLabelBackground,\n                keybindingLabelForeground,\n                keybindingLabelBorder,\n                keybindingLabelBottomBorder,\n                keybindingLabelShadow: widgetShadow\n            }),\n            list: computeStyles(this.theme, {\n                listBackground: quickInputBackground,\n                // Look like focused when inactive.\n                listInactiveFocusForeground: quickInputListFocusForeground,\n                listInactiveSelectionIconForeground: quickInputListFocusIconForeground,\n                listInactiveFocusBackground: quickInputListFocusBackground,\n                listFocusOutline: activeContrastBorder,\n                listInactiveFocusOutline: activeContrastBorder,\n                pickerGroupBorder,\n                pickerGroupForeground\n            })\n        };\n    }\n};\nQuickInputService = __decorate([\n    __param(0, IInstantiationService),\n    __param(1, IContextKeyService),\n    __param(2, IThemeService),\n    __param(3, IAccessibilityService),\n    __param(4, ILayoutService)\n], QuickInputService);\nexport { QuickInputService };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport './standaloneQuickInput.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { EditorScopedLayoutService } from '../standaloneLayoutService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { QuickInputService } from '../../../../platform/quickinput/browser/quickInput.js';\nimport { once } from '../../../../base/common/functional.js';\nlet EditorScopedQuickInputService = class EditorScopedQuickInputService extends QuickInputService {\n    constructor(editor, instantiationService, contextKeyService, themeService, accessibilityService, codeEditorService) {\n        super(instantiationService, contextKeyService, themeService, accessibilityService, new EditorScopedLayoutService(editor.getContainerDomNode(), codeEditorService));\n        this.host = undefined;\n        // Use the passed in code editor as host for the quick input widget\n        const contribution = QuickInputEditorContribution.get(editor);\n        if (contribution) {\n            const widget = contribution.widget;\n            this.host = {\n                _serviceBrand: undefined,\n                get hasContainer() { return true; },\n                get container() { return widget.getDomNode(); },\n                get dimension() { return editor.getLayoutInfo(); },\n                get onDidLayout() { return editor.onDidLayoutChange; },\n                focus: () => editor.focus(),\n                offset: { top: 0, quickPickTop: 0 }\n            };\n        }\n        else {\n            this.host = undefined;\n        }\n    }\n    createController() {\n        return super.createController(this.host);\n    }\n};\nEditorScopedQuickInputService = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IAccessibilityService),\n    __param(5, ICodeEditorService)\n], EditorScopedQuickInputService);\nexport { EditorScopedQuickInputService };\nlet StandaloneQuickInputService = class StandaloneQuickInputService {\n    constructor(instantiationService, codeEditorService) {\n        this.instantiationService = instantiationService;\n        this.codeEditorService = codeEditorService;\n        this.mapEditorToService = new Map();\n    }\n    get activeService() {\n        const editor = this.codeEditorService.getFocusedCodeEditor();\n        if (!editor) {\n            throw new Error('Quick input service needs a focused editor to work.');\n        }\n        // Find the quick input implementation for the focused\n        // editor or create it lazily if not yet created\n        let quickInputService = this.mapEditorToService.get(editor);\n        if (!quickInputService) {\n            const newQuickInputService = quickInputService = this.instantiationService.createInstance(EditorScopedQuickInputService, editor);\n            this.mapEditorToService.set(editor, quickInputService);\n            once(editor.onDidDispose)(() => {\n                newQuickInputService.dispose();\n                this.mapEditorToService.delete(editor);\n            });\n        }\n        return quickInputService;\n    }\n    get quickAccess() { return this.activeService.quickAccess; }\n    pick(picks, options = {}, token = CancellationToken.None) {\n        return this.activeService /* TS fail */.pick(picks, options, token);\n    }\n    createQuickPick() {\n        return this.activeService.createQuickPick();\n    }\n};\nStandaloneQuickInputService = __decorate([\n    __param(0, IInstantiationService),\n    __param(1, ICodeEditorService)\n], StandaloneQuickInputService);\nexport { StandaloneQuickInputService };\nexport class QuickInputEditorContribution {\n    constructor(editor) {\n        this.editor = editor;\n        this.widget = new QuickInputEditorWidget(this.editor);\n    }\n    static get(editor) {\n        return editor.getContribution(QuickInputEditorContribution.ID);\n    }\n    dispose() {\n        this.widget.dispose();\n    }\n}\nQuickInputEditorContribution.ID = 'editor.controller.quickInput';\nexport class QuickInputEditorWidget {\n    constructor(codeEditor) {\n        this.codeEditor = codeEditor;\n        this.domNode = document.createElement('div');\n        this.codeEditor.addOverlayWidget(this);\n    }\n    getId() {\n        return QuickInputEditorWidget.ID;\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    getPosition() {\n        return { preference: 2 /* OverlayWidgetPositionPreference.TOP_CENTER */ };\n    }\n    dispose() {\n        this.codeEditor.removeOverlayWidget(this);\n    }\n}\nQuickInputEditorWidget.ID = 'editor.contrib.quickInputWidget';\nregisterEditorContribution(QuickInputEditorContribution.ID, QuickInputEditorContribution);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Color } from '../../../../base/common/color.js';\nexport class ParsedTokenThemeRule {\n    constructor(token, index, fontStyle, foreground, background) {\n        this._parsedThemeRuleBrand = undefined;\n        this.token = token;\n        this.index = index;\n        this.fontStyle = fontStyle;\n        this.foreground = foreground;\n        this.background = background;\n    }\n}\n/**\n * Parse a raw theme into rules.\n */\nexport function parseTokenTheme(source) {\n    if (!source || !Array.isArray(source)) {\n        return [];\n    }\n    const result = [];\n    let resultLen = 0;\n    for (let i = 0, len = source.length; i < len; i++) {\n        const entry = source[i];\n        let fontStyle = -1 /* FontStyle.NotSet */;\n        if (typeof entry.fontStyle === 'string') {\n            fontStyle = 0 /* FontStyle.None */;\n            const segments = entry.fontStyle.split(' ');\n            for (let j = 0, lenJ = segments.length; j < lenJ; j++) {\n                const segment = segments[j];\n                switch (segment) {\n                    case 'italic':\n                        fontStyle = fontStyle | 1 /* FontStyle.Italic */;\n                        break;\n                    case 'bold':\n                        fontStyle = fontStyle | 2 /* FontStyle.Bold */;\n                        break;\n                    case 'underline':\n                        fontStyle = fontStyle | 4 /* FontStyle.Underline */;\n                        break;\n                    case 'strikethrough':\n                        fontStyle = fontStyle | 8 /* FontStyle.Strikethrough */;\n                        break;\n                }\n            }\n        }\n        let foreground = null;\n        if (typeof entry.foreground === 'string') {\n            foreground = entry.foreground;\n        }\n        let background = null;\n        if (typeof entry.background === 'string') {\n            background = entry.background;\n        }\n        result[resultLen++] = new ParsedTokenThemeRule(entry.token || '', i, fontStyle, foreground, background);\n    }\n    return result;\n}\n/**\n * Resolve rules (i.e. inheritance).\n */\nfunction resolveParsedTokenThemeRules(parsedThemeRules, customTokenColors) {\n    // Sort rules lexicographically, and then by index if necessary\n    parsedThemeRules.sort((a, b) => {\n        const r = strcmp(a.token, b.token);\n        if (r !== 0) {\n            return r;\n        }\n        return a.index - b.index;\n    });\n    // Determine defaults\n    let defaultFontStyle = 0 /* FontStyle.None */;\n    let defaultForeground = '000000';\n    let defaultBackground = 'ffffff';\n    while (parsedThemeRules.length >= 1 && parsedThemeRules[0].token === '') {\n        const incomingDefaults = parsedThemeRules.shift();\n        if (incomingDefaults.fontStyle !== -1 /* FontStyle.NotSet */) {\n            defaultFontStyle = incomingDefaults.fontStyle;\n        }\n        if (incomingDefaults.foreground !== null) {\n            defaultForeground = incomingDefaults.foreground;\n        }\n        if (incomingDefaults.background !== null) {\n            defaultBackground = incomingDefaults.background;\n        }\n    }\n    const colorMap = new ColorMap();\n    // start with token colors from custom token themes\n    for (const color of customTokenColors) {\n        colorMap.getId(color);\n    }\n    const foregroundColorId = colorMap.getId(defaultForeground);\n    const backgroundColorId = colorMap.getId(defaultBackground);\n    const defaults = new ThemeTrieElementRule(defaultFontStyle, foregroundColorId, backgroundColorId);\n    const root = new ThemeTrieElement(defaults);\n    for (let i = 0, len = parsedThemeRules.length; i < len; i++) {\n        const rule = parsedThemeRules[i];\n        root.insert(rule.token, rule.fontStyle, colorMap.getId(rule.foreground), colorMap.getId(rule.background));\n    }\n    return new TokenTheme(colorMap, root);\n}\nconst colorRegExp = /^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;\nexport class ColorMap {\n    constructor() {\n        this._lastColorId = 0;\n        this._id2color = [];\n        this._color2id = new Map();\n    }\n    getId(color) {\n        if (color === null) {\n            return 0;\n        }\n        const match = color.match(colorRegExp);\n        if (!match) {\n            throw new Error('Illegal value for token color: ' + color);\n        }\n        color = match[1].toUpperCase();\n        let value = this._color2id.get(color);\n        if (value) {\n            return value;\n        }\n        value = ++this._lastColorId;\n        this._color2id.set(color, value);\n        this._id2color[value] = Color.fromHex('#' + color);\n        return value;\n    }\n    getColorMap() {\n        return this._id2color.slice(0);\n    }\n}\nexport class TokenTheme {\n    constructor(colorMap, root) {\n        this._colorMap = colorMap;\n        this._root = root;\n        this._cache = new Map();\n    }\n    static createFromRawTokenTheme(source, customTokenColors) {\n        return this.createFromParsedTokenTheme(parseTokenTheme(source), customTokenColors);\n    }\n    static createFromParsedTokenTheme(source, customTokenColors) {\n        return resolveParsedTokenThemeRules(source, customTokenColors);\n    }\n    getColorMap() {\n        return this._colorMap.getColorMap();\n    }\n    _match(token) {\n        return this._root.match(token);\n    }\n    match(languageId, token) {\n        // The cache contains the metadata without the language bits set.\n        let result = this._cache.get(token);\n        if (typeof result === 'undefined') {\n            const rule = this._match(token);\n            const standardToken = toStandardTokenType(token);\n            result = (rule.metadata\n                | (standardToken << 8 /* MetadataConsts.TOKEN_TYPE_OFFSET */)) >>> 0;\n            this._cache.set(token, result);\n        }\n        return (result\n            | (languageId << 0 /* MetadataConsts.LANGUAGEID_OFFSET */)) >>> 0;\n    }\n}\nconst STANDARD_TOKEN_TYPE_REGEXP = /\\b(comment|string|regex|regexp)\\b/;\nexport function toStandardTokenType(tokenType) {\n    const m = tokenType.match(STANDARD_TOKEN_TYPE_REGEXP);\n    if (!m) {\n        return 0 /* StandardTokenType.Other */;\n    }\n    switch (m[1]) {\n        case 'comment':\n            return 1 /* StandardTokenType.Comment */;\n        case 'string':\n            return 2 /* StandardTokenType.String */;\n        case 'regex':\n            return 3 /* StandardTokenType.RegEx */;\n        case 'regexp':\n            return 3 /* StandardTokenType.RegEx */;\n    }\n    throw new Error('Unexpected match for standard token type!');\n}\nexport function strcmp(a, b) {\n    if (a < b) {\n        return -1;\n    }\n    if (a > b) {\n        return 1;\n    }\n    return 0;\n}\nexport class ThemeTrieElementRule {\n    constructor(fontStyle, foreground, background) {\n        this._themeTrieElementRuleBrand = undefined;\n        this._fontStyle = fontStyle;\n        this._foreground = foreground;\n        this._background = background;\n        this.metadata = ((this._fontStyle << 11 /* MetadataConsts.FONT_STYLE_OFFSET */)\n            | (this._foreground << 15 /* MetadataConsts.FOREGROUND_OFFSET */)\n            | (this._background << 24 /* MetadataConsts.BACKGROUND_OFFSET */)) >>> 0;\n    }\n    clone() {\n        return new ThemeTrieElementRule(this._fontStyle, this._foreground, this._background);\n    }\n    acceptOverwrite(fontStyle, foreground, background) {\n        if (fontStyle !== -1 /* FontStyle.NotSet */) {\n            this._fontStyle = fontStyle;\n        }\n        if (foreground !== 0 /* ColorId.None */) {\n            this._foreground = foreground;\n        }\n        if (background !== 0 /* ColorId.None */) {\n            this._background = background;\n        }\n        this.metadata = ((this._fontStyle << 11 /* MetadataConsts.FONT_STYLE_OFFSET */)\n            | (this._foreground << 15 /* MetadataConsts.FOREGROUND_OFFSET */)\n            | (this._background << 24 /* MetadataConsts.BACKGROUND_OFFSET */)) >>> 0;\n    }\n}\nexport class ThemeTrieElement {\n    constructor(mainRule) {\n        this._themeTrieElementBrand = undefined;\n        this._mainRule = mainRule;\n        this._children = new Map();\n    }\n    match(token) {\n        if (token === '') {\n            return this._mainRule;\n        }\n        const dotIndex = token.indexOf('.');\n        let head;\n        let tail;\n        if (dotIndex === -1) {\n            head = token;\n            tail = '';\n        }\n        else {\n            head = token.substring(0, dotIndex);\n            tail = token.substring(dotIndex + 1);\n        }\n        const child = this._children.get(head);\n        if (typeof child !== 'undefined') {\n            return child.match(tail);\n        }\n        return this._mainRule;\n    }\n    insert(token, fontStyle, foreground, background) {\n        if (token === '') {\n            // Merge into the main rule\n            this._mainRule.acceptOverwrite(fontStyle, foreground, background);\n            return;\n        }\n        const dotIndex = token.indexOf('.');\n        let head;\n        let tail;\n        if (dotIndex === -1) {\n            head = token;\n            tail = '';\n        }\n        else {\n            head = token.substring(0, dotIndex);\n            tail = token.substring(dotIndex + 1);\n        }\n        let child = this._children.get(head);\n        if (typeof child === 'undefined') {\n            child = new ThemeTrieElement(this._mainRule.clone());\n            this._children.set(head, child);\n        }\n        child.insert(tail, fontStyle, foreground, background);\n    }\n}\nexport function generateTokensCSSForColorMap(colorMap) {\n    const rules = [];\n    for (let i = 1, len = colorMap.length; i < len; i++) {\n        const color = colorMap[i];\n        rules[i] = `.mtk${i} { color: ${color}; }`;\n    }\n    rules.push('.mtki { font-style: italic; }');\n    rules.push('.mtkb { font-weight: bold; }');\n    rules.push('.mtku { text-decoration: underline; text-underline-position: under; }');\n    rules.push('.mtks { text-decoration: line-through; }');\n    rules.push('.mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }');\n    return rules.join('\\n');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { editorActiveIndentGuides, editorIndentGuides } from '../../common/core/editorColorRegistry.js';\nimport { editorBackground, editorForeground, editorInactiveSelection, editorSelectionHighlight } from '../../../platform/theme/common/colorRegistry.js';\n/* -------------------------------- Begin vs theme -------------------------------- */\nexport const vs = {\n    base: 'vs',\n    inherit: false,\n    rules: [\n        { token: '', foreground: '000000', background: 'fffffe' },\n        { token: 'invalid', foreground: 'cd3131' },\n        { token: 'emphasis', fontStyle: 'italic' },\n        { token: 'strong', fontStyle: 'bold' },\n        { token: 'variable', foreground: '001188' },\n        { token: 'variable.predefined', foreground: '4864AA' },\n        { token: 'constant', foreground: 'dd0000' },\n        { token: 'comment', foreground: '008000' },\n        { token: 'number', foreground: '098658' },\n        { token: 'number.hex', foreground: '3030c0' },\n        { token: 'regexp', foreground: '800000' },\n        { token: 'annotation', foreground: '808080' },\n        { token: 'type', foreground: '008080' },\n        { token: 'delimiter', foreground: '000000' },\n        { token: 'delimiter.html', foreground: '383838' },\n        { token: 'delimiter.xml', foreground: '0000FF' },\n        { token: 'tag', foreground: '800000' },\n        { token: 'tag.id.pug', foreground: '4F76AC' },\n        { token: 'tag.class.pug', foreground: '4F76AC' },\n        { token: 'meta.scss', foreground: '800000' },\n        { token: 'metatag', foreground: 'e00000' },\n        { token: 'metatag.content.html', foreground: 'FF0000' },\n        { token: 'metatag.html', foreground: '808080' },\n        { token: 'metatag.xml', foreground: '808080' },\n        { token: 'metatag.php', fontStyle: 'bold' },\n        { token: 'key', foreground: '863B00' },\n        { token: 'string.key.json', foreground: 'A31515' },\n        { token: 'string.value.json', foreground: '0451A5' },\n        { token: 'attribute.name', foreground: 'FF0000' },\n        { token: 'attribute.value', foreground: '0451A5' },\n        { token: 'attribute.value.number', foreground: '098658' },\n        { token: 'attribute.value.unit', foreground: '098658' },\n        { token: 'attribute.value.html', foreground: '0000FF' },\n        { token: 'attribute.value.xml', foreground: '0000FF' },\n        { token: 'string', foreground: 'A31515' },\n        { token: 'string.html', foreground: '0000FF' },\n        { token: 'string.sql', foreground: 'FF0000' },\n        { token: 'string.yaml', foreground: '0451A5' },\n        { token: 'keyword', foreground: '0000FF' },\n        { token: 'keyword.json', foreground: '0451A5' },\n        { token: 'keyword.flow', foreground: 'AF00DB' },\n        { token: 'keyword.flow.scss', foreground: '0000FF' },\n        { token: 'operator.scss', foreground: '666666' },\n        { token: 'operator.sql', foreground: '778899' },\n        { token: 'operator.swift', foreground: '666666' },\n        { token: 'predefined.sql', foreground: 'C700C7' },\n    ],\n    colors: {\n        [editorBackground]: '#FFFFFE',\n        [editorForeground]: '#000000',\n        [editorInactiveSelection]: '#E5EBF1',\n        [editorIndentGuides]: '#D3D3D3',\n        [editorActiveIndentGuides]: '#939393',\n        [editorSelectionHighlight]: '#ADD6FF4D'\n    }\n};\n/* -------------------------------- End vs theme -------------------------------- */\n/* -------------------------------- Begin vs-dark theme -------------------------------- */\nexport const vs_dark = {\n    base: 'vs-dark',\n    inherit: false,\n    rules: [\n        { token: '', foreground: 'D4D4D4', background: '1E1E1E' },\n        { token: 'invalid', foreground: 'f44747' },\n        { token: 'emphasis', fontStyle: 'italic' },\n        { token: 'strong', fontStyle: 'bold' },\n        { token: 'variable', foreground: '74B0DF' },\n        { token: 'variable.predefined', foreground: '4864AA' },\n        { token: 'variable.parameter', foreground: '9CDCFE' },\n        { token: 'constant', foreground: '569CD6' },\n        { token: 'comment', foreground: '608B4E' },\n        { token: 'number', foreground: 'B5CEA8' },\n        { token: 'number.hex', foreground: '5BB498' },\n        { token: 'regexp', foreground: 'B46695' },\n        { token: 'annotation', foreground: 'cc6666' },\n        { token: 'type', foreground: '3DC9B0' },\n        { token: 'delimiter', foreground: 'DCDCDC' },\n        { token: 'delimiter.html', foreground: '808080' },\n        { token: 'delimiter.xml', foreground: '808080' },\n        { token: 'tag', foreground: '569CD6' },\n        { token: 'tag.id.pug', foreground: '4F76AC' },\n        { token: 'tag.class.pug', foreground: '4F76AC' },\n        { token: 'meta.scss', foreground: 'A79873' },\n        { token: 'meta.tag', foreground: 'CE9178' },\n        { token: 'metatag', foreground: 'DD6A6F' },\n        { token: 'metatag.content.html', foreground: '9CDCFE' },\n        { token: 'metatag.html', foreground: '569CD6' },\n        { token: 'metatag.xml', foreground: '569CD6' },\n        { token: 'metatag.php', fontStyle: 'bold' },\n        { token: 'key', foreground: '9CDCFE' },\n        { token: 'string.key.json', foreground: '9CDCFE' },\n        { token: 'string.value.json', foreground: 'CE9178' },\n        { token: 'attribute.name', foreground: '9CDCFE' },\n        { token: 'attribute.value', foreground: 'CE9178' },\n        { token: 'attribute.value.number.css', foreground: 'B5CEA8' },\n        { token: 'attribute.value.unit.css', foreground: 'B5CEA8' },\n        { token: 'attribute.value.hex.css', foreground: 'D4D4D4' },\n        { token: 'string', foreground: 'CE9178' },\n        { token: 'string.sql', foreground: 'FF0000' },\n        { token: 'keyword', foreground: '569CD6' },\n        { token: 'keyword.flow', foreground: 'C586C0' },\n        { token: 'keyword.json', foreground: 'CE9178' },\n        { token: 'keyword.flow.scss', foreground: '569CD6' },\n        { token: 'operator.scss', foreground: '909090' },\n        { token: 'operator.sql', foreground: '778899' },\n        { token: 'operator.swift', foreground: '909090' },\n        { token: 'predefined.sql', foreground: 'FF00FF' },\n    ],\n    colors: {\n        [editorBackground]: '#1E1E1E',\n        [editorForeground]: '#D4D4D4',\n        [editorInactiveSelection]: '#3A3D41',\n        [editorIndentGuides]: '#404040',\n        [editorActiveIndentGuides]: '#707070',\n        [editorSelectionHighlight]: '#ADD6FF26'\n    }\n};\n/* -------------------------------- End vs-dark theme -------------------------------- */\n/* -------------------------------- Begin hc-black theme -------------------------------- */\nexport const hc_black = {\n    base: 'hc-black',\n    inherit: false,\n    rules: [\n        { token: '', foreground: 'FFFFFF', background: '000000' },\n        { token: 'invalid', foreground: 'f44747' },\n        { token: 'emphasis', fontStyle: 'italic' },\n        { token: 'strong', fontStyle: 'bold' },\n        { token: 'variable', foreground: '1AEBFF' },\n        { token: 'variable.parameter', foreground: '9CDCFE' },\n        { token: 'constant', foreground: '569CD6' },\n        { token: 'comment', foreground: '608B4E' },\n        { token: 'number', foreground: 'FFFFFF' },\n        { token: 'regexp', foreground: 'C0C0C0' },\n        { token: 'annotation', foreground: '569CD6' },\n        { token: 'type', foreground: '3DC9B0' },\n        { token: 'delimiter', foreground: 'FFFF00' },\n        { token: 'delimiter.html', foreground: 'FFFF00' },\n        { token: 'tag', foreground: '569CD6' },\n        { token: 'tag.id.pug', foreground: '4F76AC' },\n        { token: 'tag.class.pug', foreground: '4F76AC' },\n        { token: 'meta', foreground: 'D4D4D4' },\n        { token: 'meta.tag', foreground: 'CE9178' },\n        { token: 'metatag', foreground: '569CD6' },\n        { token: 'metatag.content.html', foreground: '1AEBFF' },\n        { token: 'metatag.html', foreground: '569CD6' },\n        { token: 'metatag.xml', foreground: '569CD6' },\n        { token: 'metatag.php', fontStyle: 'bold' },\n        { token: 'key', foreground: '9CDCFE' },\n        { token: 'string.key', foreground: '9CDCFE' },\n        { token: 'string.value', foreground: 'CE9178' },\n        { token: 'attribute.name', foreground: '569CD6' },\n        { token: 'attribute.value', foreground: '3FF23F' },\n        { token: 'string', foreground: 'CE9178' },\n        { token: 'string.sql', foreground: 'FF0000' },\n        { token: 'keyword', foreground: '569CD6' },\n        { token: 'keyword.flow', foreground: 'C586C0' },\n        { token: 'operator.sql', foreground: '778899' },\n        { token: 'operator.swift', foreground: '909090' },\n        { token: 'predefined.sql', foreground: 'FF00FF' },\n    ],\n    colors: {\n        [editorBackground]: '#000000',\n        [editorForeground]: '#FFFFFF',\n        [editorIndentGuides]: '#FFFFFF',\n        [editorActiveIndentGuides]: '#FFFFFF',\n    }\n};\n/* -------------------------------- End hc-black theme -------------------------------- */\n/* -------------------------------- Begin hc-light theme -------------------------------- */\nexport const hc_light = {\n    base: 'hc-light',\n    inherit: false,\n    rules: [\n        { token: '', foreground: '292929', background: 'FFFFFF' },\n        { token: 'invalid', foreground: 'B5200D' },\n        { token: 'emphasis', fontStyle: 'italic' },\n        { token: 'strong', fontStyle: 'bold' },\n        { token: 'variable', foreground: '264F70' },\n        { token: 'variable.predefined', foreground: '4864AA' },\n        { token: 'constant', foreground: 'dd0000' },\n        { token: 'comment', foreground: '008000' },\n        { token: 'number', foreground: '098658' },\n        { token: 'number.hex', foreground: '3030c0' },\n        { token: 'regexp', foreground: '800000' },\n        { token: 'annotation', foreground: '808080' },\n        { token: 'type', foreground: '008080' },\n        { token: 'delimiter', foreground: '000000' },\n        { token: 'delimiter.html', foreground: '383838' },\n        { token: 'tag', foreground: '800000' },\n        { token: 'tag.id.pug', foreground: '4F76AC' },\n        { token: 'tag.class.pug', foreground: '4F76AC' },\n        { token: 'meta.scss', foreground: '800000' },\n        { token: 'metatag', foreground: 'e00000' },\n        { token: 'metatag.content.html', foreground: 'B5200D' },\n        { token: 'metatag.html', foreground: '808080' },\n        { token: 'metatag.xml', foreground: '808080' },\n        { token: 'metatag.php', fontStyle: 'bold' },\n        { token: 'key', foreground: '863B00' },\n        { token: 'string.key.json', foreground: 'A31515' },\n        { token: 'string.value.json', foreground: '0451A5' },\n        { token: 'attribute.name', foreground: '264F78' },\n        { token: 'attribute.value', foreground: '0451A5' },\n        { token: 'string', foreground: 'A31515' },\n        { token: 'string.sql', foreground: 'B5200D' },\n        { token: 'keyword', foreground: '0000FF' },\n        { token: 'keyword.flow', foreground: 'AF00DB' },\n        { token: 'operator.sql', foreground: '778899' },\n        { token: 'operator.swift', foreground: '666666' },\n        { token: 'predefined.sql', foreground: 'C700C7' },\n    ],\n    colors: {\n        [editorBackground]: '#FFFFFF',\n        [editorForeground]: '#292929',\n        [editorIndentGuides]: '#292929',\n        [editorActiveIndentGuides]: '#292929',\n    }\n};\n/* -------------------------------- End hc-light theme -------------------------------- */\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { asCSSPropertyValue, asCSSUrl } from '../../../base/browser/dom.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { getIconRegistry } from '../common/iconRegistry.js';\nimport { ThemeIcon } from '../common/themeService.js';\nexport function getIconsStyleSheet(themeService) {\n    const onDidChangeEmmiter = new Emitter();\n    const iconRegistry = getIconRegistry();\n    iconRegistry.onDidChange(() => onDidChangeEmmiter.fire());\n    themeService === null || themeService === void 0 ? void 0 : themeService.onDidProductIconThemeChange(() => onDidChangeEmmiter.fire());\n    return {\n        onDidChange: onDidChangeEmmiter.event,\n        getCSS() {\n            const productIconTheme = themeService ? themeService.getProductIconTheme() : new UnthemedProductIconTheme();\n            const usedFontIds = {};\n            const formatIconRule = (contribution) => {\n                const definition = productIconTheme.getIcon(contribution);\n                if (!definition) {\n                    return undefined;\n                }\n                const fontContribution = definition.font;\n                if (fontContribution) {\n                    usedFontIds[fontContribution.id] = fontContribution.definition;\n                    return `.codicon-${contribution.id}:before { content: '${definition.fontCharacter}'; font-family: ${asCSSPropertyValue(fontContribution.id)}; }`;\n                }\n                // default font (codicon)\n                return `.codicon-${contribution.id}:before { content: '${definition.fontCharacter}'; }`;\n            };\n            const rules = [];\n            for (const contribution of iconRegistry.getIcons()) {\n                const rule = formatIconRule(contribution);\n                if (rule) {\n                    rules.push(rule);\n                }\n            }\n            for (const id in usedFontIds) {\n                const definition = usedFontIds[id];\n                const fontWeight = definition.weight ? `font-weight: ${definition.weight};` : '';\n                const fontStyle = definition.style ? `font-style: ${definition.style};` : '';\n                const src = definition.src.map(l => `${asCSSUrl(l.location)} format('${l.format}')`).join(', ');\n                rules.push(`@font-face { src: ${src}; font-family: ${asCSSPropertyValue(id)};${fontWeight}${fontStyle} font-display: block; }`);\n            }\n            return rules.join('\\n');\n        }\n    };\n}\nexport class UnthemedProductIconTheme {\n    getIcon(contribution) {\n        const iconRegistry = getIconRegistry();\n        let definition = contribution.defaults;\n        while (ThemeIcon.isThemeIcon(definition)) {\n            const c = iconRegistry.getIcon(definition.id);\n            if (!c) {\n                return undefined;\n            }\n            definition = c.defaults;\n        }\n        return definition;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport { addMatchMediaChangeListener } from '../../../base/browser/browser.js';\nimport { Color } from '../../../base/common/color.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { TokenizationRegistry } from '../../common/languages.js';\nimport { TokenMetadata } from '../../common/encodedTokenAttributes.js';\nimport { TokenTheme, generateTokensCSSForColorMap } from '../../common/languages/supports/tokenization.js';\nimport { hc_black, hc_light, vs, vs_dark } from '../common/themes.js';\nimport { Registry } from '../../../platform/registry/common/platform.js';\nimport { asCssVariableName, Extensions } from '../../../platform/theme/common/colorRegistry.js';\nimport { Extensions as ThemingExtensions } from '../../../platform/theme/common/themeService.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { ColorScheme, isDark, isHighContrast } from '../../../platform/theme/common/theme.js';\nimport { getIconsStyleSheet, UnthemedProductIconTheme } from '../../../platform/theme/browser/iconsStyleSheet.js';\nexport const VS_LIGHT_THEME_NAME = 'vs';\nexport const VS_DARK_THEME_NAME = 'vs-dark';\nexport const HC_BLACK_THEME_NAME = 'hc-black';\nexport const HC_LIGHT_THEME_NAME = 'hc-light';\nconst colorRegistry = Registry.as(Extensions.ColorContribution);\nconst themingRegistry = Registry.as(ThemingExtensions.ThemingContribution);\nclass StandaloneTheme {\n    constructor(name, standaloneThemeData) {\n        this.semanticHighlighting = false;\n        this.themeData = standaloneThemeData;\n        const base = standaloneThemeData.base;\n        if (name.length > 0) {\n            if (isBuiltinTheme(name)) {\n                this.id = name;\n            }\n            else {\n                this.id = base + ' ' + name;\n            }\n            this.themeName = name;\n        }\n        else {\n            this.id = base;\n            this.themeName = base;\n        }\n        this.colors = null;\n        this.defaultColors = Object.create(null);\n        this._tokenTheme = null;\n    }\n    get base() {\n        return this.themeData.base;\n    }\n    notifyBaseUpdated() {\n        if (this.themeData.inherit) {\n            this.colors = null;\n            this._tokenTheme = null;\n        }\n    }\n    getColors() {\n        if (!this.colors) {\n            const colors = new Map();\n            for (const id in this.themeData.colors) {\n                colors.set(id, Color.fromHex(this.themeData.colors[id]));\n            }\n            if (this.themeData.inherit) {\n                const baseData = getBuiltinRules(this.themeData.base);\n                for (const id in baseData.colors) {\n                    if (!colors.has(id)) {\n                        colors.set(id, Color.fromHex(baseData.colors[id]));\n                    }\n                }\n            }\n            this.colors = colors;\n        }\n        return this.colors;\n    }\n    getColor(colorId, useDefault) {\n        const color = this.getColors().get(colorId);\n        if (color) {\n            return color;\n        }\n        if (useDefault !== false) {\n            return this.getDefault(colorId);\n        }\n        return undefined;\n    }\n    getDefault(colorId) {\n        let color = this.defaultColors[colorId];\n        if (color) {\n            return color;\n        }\n        color = colorRegistry.resolveDefaultColor(colorId, this);\n        this.defaultColors[colorId] = color;\n        return color;\n    }\n    defines(colorId) {\n        return Object.prototype.hasOwnProperty.call(this.getColors(), colorId);\n    }\n    get type() {\n        switch (this.base) {\n            case VS_LIGHT_THEME_NAME: return ColorScheme.LIGHT;\n            case HC_BLACK_THEME_NAME: return ColorScheme.HIGH_CONTRAST_DARK;\n            case HC_LIGHT_THEME_NAME: return ColorScheme.HIGH_CONTRAST_LIGHT;\n            default: return ColorScheme.DARK;\n        }\n    }\n    get tokenTheme() {\n        if (!this._tokenTheme) {\n            let rules = [];\n            let encodedTokensColors = [];\n            if (this.themeData.inherit) {\n                const baseData = getBuiltinRules(this.themeData.base);\n                rules = baseData.rules;\n                if (baseData.encodedTokensColors) {\n                    encodedTokensColors = baseData.encodedTokensColors;\n                }\n            }\n            // Pick up default colors from `editor.foreground` and `editor.background` if available\n            const editorForeground = this.themeData.colors['editor.foreground'];\n            const editorBackground = this.themeData.colors['editor.background'];\n            if (editorForeground || editorBackground) {\n                const rule = { token: '' };\n                if (editorForeground) {\n                    rule.foreground = editorForeground;\n                }\n                if (editorBackground) {\n                    rule.background = editorBackground;\n                }\n                rules.push(rule);\n            }\n            rules = rules.concat(this.themeData.rules);\n            if (this.themeData.encodedTokensColors) {\n                encodedTokensColors = this.themeData.encodedTokensColors;\n            }\n            this._tokenTheme = TokenTheme.createFromRawTokenTheme(rules, encodedTokensColors);\n        }\n        return this._tokenTheme;\n    }\n    getTokenStyleMetadata(type, modifiers, modelLanguage) {\n        // use theme rules match\n        const style = this.tokenTheme._match([type].concat(modifiers).join('.'));\n        const metadata = style.metadata;\n        const foreground = TokenMetadata.getForeground(metadata);\n        const fontStyle = TokenMetadata.getFontStyle(metadata);\n        return {\n            foreground: foreground,\n            italic: Boolean(fontStyle & 1 /* FontStyle.Italic */),\n            bold: Boolean(fontStyle & 2 /* FontStyle.Bold */),\n            underline: Boolean(fontStyle & 4 /* FontStyle.Underline */),\n            strikethrough: Boolean(fontStyle & 8 /* FontStyle.Strikethrough */)\n        };\n    }\n}\nfunction isBuiltinTheme(themeName) {\n    return (themeName === VS_LIGHT_THEME_NAME\n        || themeName === VS_DARK_THEME_NAME\n        || themeName === HC_BLACK_THEME_NAME\n        || themeName === HC_LIGHT_THEME_NAME);\n}\nfunction getBuiltinRules(builtinTheme) {\n    switch (builtinTheme) {\n        case VS_LIGHT_THEME_NAME:\n            return vs;\n        case VS_DARK_THEME_NAME:\n            return vs_dark;\n        case HC_BLACK_THEME_NAME:\n            return hc_black;\n        case HC_LIGHT_THEME_NAME:\n            return hc_light;\n    }\n}\nfunction newBuiltInTheme(builtinTheme) {\n    const themeData = getBuiltinRules(builtinTheme);\n    return new StandaloneTheme(builtinTheme, themeData);\n}\nexport class StandaloneThemeService extends Disposable {\n    constructor() {\n        super();\n        this._onColorThemeChange = this._register(new Emitter());\n        this.onDidColorThemeChange = this._onColorThemeChange.event;\n        this._onProductIconThemeChange = this._register(new Emitter());\n        this.onDidProductIconThemeChange = this._onProductIconThemeChange.event;\n        this._environment = Object.create(null);\n        this._builtInProductIconTheme = new UnthemedProductIconTheme();\n        this._autoDetectHighContrast = true;\n        this._knownThemes = new Map();\n        this._knownThemes.set(VS_LIGHT_THEME_NAME, newBuiltInTheme(VS_LIGHT_THEME_NAME));\n        this._knownThemes.set(VS_DARK_THEME_NAME, newBuiltInTheme(VS_DARK_THEME_NAME));\n        this._knownThemes.set(HC_BLACK_THEME_NAME, newBuiltInTheme(HC_BLACK_THEME_NAME));\n        this._knownThemes.set(HC_LIGHT_THEME_NAME, newBuiltInTheme(HC_LIGHT_THEME_NAME));\n        const iconsStyleSheet = getIconsStyleSheet(this);\n        this._codiconCSS = iconsStyleSheet.getCSS();\n        this._themeCSS = '';\n        this._allCSS = `${this._codiconCSS}\\n${this._themeCSS}`;\n        this._globalStyleElement = null;\n        this._styleElements = [];\n        this._colorMapOverride = null;\n        this.setTheme(VS_LIGHT_THEME_NAME);\n        this._onOSSchemeChanged();\n        iconsStyleSheet.onDidChange(() => {\n            this._codiconCSS = iconsStyleSheet.getCSS();\n            this._updateCSS();\n        });\n        addMatchMediaChangeListener('(forced-colors: active)', () => {\n            this._onOSSchemeChanged();\n        });\n    }\n    registerEditorContainer(domNode) {\n        if (dom.isInShadowDOM(domNode)) {\n            return this._registerShadowDomContainer(domNode);\n        }\n        return this._registerRegularEditorContainer();\n    }\n    _registerRegularEditorContainer() {\n        if (!this._globalStyleElement) {\n            this._globalStyleElement = dom.createStyleSheet();\n            this._globalStyleElement.className = 'monaco-colors';\n            this._globalStyleElement.textContent = this._allCSS;\n            this._styleElements.push(this._globalStyleElement);\n        }\n        return Disposable.None;\n    }\n    _registerShadowDomContainer(domNode) {\n        const styleElement = dom.createStyleSheet(domNode);\n        styleElement.className = 'monaco-colors';\n        styleElement.textContent = this._allCSS;\n        this._styleElements.push(styleElement);\n        return {\n            dispose: () => {\n                for (let i = 0; i < this._styleElements.length; i++) {\n                    if (this._styleElements[i] === styleElement) {\n                        this._styleElements.splice(i, 1);\n                        return;\n                    }\n                }\n            }\n        };\n    }\n    defineTheme(themeName, themeData) {\n        if (!/^[a-z0-9\\-]+$/i.test(themeName)) {\n            throw new Error('Illegal theme name!');\n        }\n        if (!isBuiltinTheme(themeData.base) && !isBuiltinTheme(themeName)) {\n            throw new Error('Illegal theme base!');\n        }\n        // set or replace theme\n        this._knownThemes.set(themeName, new StandaloneTheme(themeName, themeData));\n        if (isBuiltinTheme(themeName)) {\n            this._knownThemes.forEach(theme => {\n                if (theme.base === themeName) {\n                    theme.notifyBaseUpdated();\n                }\n            });\n        }\n        if (this._theme.themeName === themeName) {\n            this.setTheme(themeName); // refresh theme\n        }\n    }\n    getColorTheme() {\n        return this._theme;\n    }\n    setColorMapOverride(colorMapOverride) {\n        this._colorMapOverride = colorMapOverride;\n        this._updateThemeOrColorMap();\n    }\n    setTheme(themeName) {\n        let theme;\n        if (this._knownThemes.has(themeName)) {\n            theme = this._knownThemes.get(themeName);\n        }\n        else {\n            theme = this._knownThemes.get(VS_LIGHT_THEME_NAME);\n        }\n        this._updateActualTheme(theme);\n    }\n    _updateActualTheme(desiredTheme) {\n        if (!desiredTheme || this._theme === desiredTheme) {\n            // Nothing to do\n            return;\n        }\n        this._theme = desiredTheme;\n        this._updateThemeOrColorMap();\n    }\n    _onOSSchemeChanged() {\n        if (this._autoDetectHighContrast) {\n            const wantsHighContrast = window.matchMedia(`(forced-colors: active)`).matches;\n            if (wantsHighContrast !== isHighContrast(this._theme.type)) {\n                // switch to high contrast or non-high contrast but stick to dark or light\n                let newThemeName;\n                if (isDark(this._theme.type)) {\n                    newThemeName = wantsHighContrast ? HC_BLACK_THEME_NAME : VS_DARK_THEME_NAME;\n                }\n                else {\n                    newThemeName = wantsHighContrast ? HC_LIGHT_THEME_NAME : VS_LIGHT_THEME_NAME;\n                }\n                this._updateActualTheme(this._knownThemes.get(newThemeName));\n            }\n        }\n    }\n    setAutoDetectHighContrast(autoDetectHighContrast) {\n        this._autoDetectHighContrast = autoDetectHighContrast;\n        this._onOSSchemeChanged();\n    }\n    _updateThemeOrColorMap() {\n        const cssRules = [];\n        const hasRule = {};\n        const ruleCollector = {\n            addRule: (rule) => {\n                if (!hasRule[rule]) {\n                    cssRules.push(rule);\n                    hasRule[rule] = true;\n                }\n            }\n        };\n        themingRegistry.getThemingParticipants().forEach(p => p(this._theme, ruleCollector, this._environment));\n        const colorVariables = [];\n        for (const item of colorRegistry.getColors()) {\n            const color = this._theme.getColor(item.id, true);\n            if (color) {\n                colorVariables.push(`${asCssVariableName(item.id)}: ${color.toString()};`);\n            }\n        }\n        ruleCollector.addRule(`.monaco-editor { ${colorVariables.join('\\n')} }`);\n        const colorMap = this._colorMapOverride || this._theme.tokenTheme.getColorMap();\n        ruleCollector.addRule(generateTokensCSSForColorMap(colorMap));\n        this._themeCSS = cssRules.join('\\n');\n        this._updateCSS();\n        TokenizationRegistry.setColorMap(colorMap);\n        this._onColorThemeChange.fire(this._theme);\n    }\n    _updateCSS() {\n        this._allCSS = `${this._codiconCSS}\\n${this._themeCSS}`;\n        this._styleElements.forEach(styleElement => styleElement.textContent = this._allCSS);\n    }\n    getFileIconTheme() {\n        return {\n            hasFileIcons: false,\n            hasFolderIcons: false,\n            hidesExplorerArrows: false\n        };\n    }\n    getProductIconTheme() {\n        return this._builtInProductIconTheme;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nexport const IStandaloneThemeService = createDecorator('themeService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { addDisposableListener } from '../../../base/browser/dom.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../common/accessibility.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\nimport { ILayoutService } from '../../layout/browser/layoutService.js';\nlet AccessibilityService = class AccessibilityService extends Disposable {\n    constructor(_contextKeyService, _layoutService, _configurationService) {\n        super();\n        this._contextKeyService = _contextKeyService;\n        this._layoutService = _layoutService;\n        this._configurationService = _configurationService;\n        this._accessibilitySupport = 0 /* AccessibilitySupport.Unknown */;\n        this._onDidChangeScreenReaderOptimized = new Emitter();\n        this._onDidChangeReducedMotion = new Emitter();\n        this._accessibilityModeEnabledContext = CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);\n        const updateContextKey = () => this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration('editor.accessibilitySupport')) {\n                updateContextKey();\n                this._onDidChangeScreenReaderOptimized.fire();\n            }\n            if (e.affectsConfiguration('workbench.reduceMotion')) {\n                this._configMotionReduced = this._configurationService.getValue('workbench.reduceMotion');\n                this._onDidChangeReducedMotion.fire();\n            }\n        }));\n        updateContextKey();\n        this._register(this.onDidChangeScreenReaderOptimized(() => updateContextKey()));\n        const reduceMotionMatcher = window.matchMedia(`(prefers-reduced-motion: reduce)`);\n        this._systemMotionReduced = reduceMotionMatcher.matches;\n        this._configMotionReduced = this._configurationService.getValue('workbench.reduceMotion');\n        this.initReducedMotionListeners(reduceMotionMatcher);\n    }\n    initReducedMotionListeners(reduceMotionMatcher) {\n        if (!this._layoutService.hasContainer) {\n            // we can't use `ILayoutService.container` because the application\n            // doesn't have a single container\n            return;\n        }\n        this._register(addDisposableListener(reduceMotionMatcher, 'change', () => {\n            this._systemMotionReduced = reduceMotionMatcher.matches;\n            if (this._configMotionReduced === 'auto') {\n                this._onDidChangeReducedMotion.fire();\n            }\n        }));\n        const updateRootClasses = () => {\n            const reduce = this.isMotionReduced();\n            this._layoutService.container.classList.toggle('reduce-motion', reduce);\n            this._layoutService.container.classList.toggle('enable-motion', !reduce);\n        };\n        updateRootClasses();\n        this._register(this.onDidChangeReducedMotion(() => updateRootClasses()));\n    }\n    get onDidChangeScreenReaderOptimized() {\n        return this._onDidChangeScreenReaderOptimized.event;\n    }\n    isScreenReaderOptimized() {\n        const config = this._configurationService.getValue('editor.accessibilitySupport');\n        return config === 'on' || (config === 'auto' && this._accessibilitySupport === 2 /* AccessibilitySupport.Enabled */);\n    }\n    get onDidChangeReducedMotion() {\n        return this._onDidChangeReducedMotion.event;\n    }\n    isMotionReduced() {\n        const config = this._configMotionReduced;\n        return config === 'on' || (config === 'auto' && this._systemMotionReduced);\n    }\n    getAccessibilitySupport() {\n        return this._accessibilitySupport;\n    }\n};\nAccessibilityService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ILayoutService),\n    __param(2, IConfigurationService)\n], AccessibilityService);\nexport { AccessibilityService };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { RunOnceScheduler } from '../../../base/common/async.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { IMenuService, isIMenuItem, MenuItemAction, MenuRegistry, SubmenuItemAction } from './actions.js';\nimport { ICommandService } from '../../commands/common/commands.js';\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\nimport { toAction } from '../../../base/common/actions.js';\nimport { IStorageService } from '../../storage/common/storage.js';\nimport { removeFastWithoutKeepingOrder } from '../../../base/common/arrays.js';\nimport { localize } from '../../../nls.js';\nlet MenuService = class MenuService {\n    constructor(_commandService, storageService) {\n        this._commandService = _commandService;\n        this._hiddenStates = new PersistedMenuHideState(storageService);\n    }\n    createMenu(id, contextKeyService, options) {\n        return new Menu(id, this._hiddenStates, Object.assign({ emitEventsForSubmenuChanges: false, eventDebounceDelay: 50 }, options), this._commandService, contextKeyService, this);\n    }\n};\nMenuService = __decorate([\n    __param(0, ICommandService),\n    __param(1, IStorageService)\n], MenuService);\nexport { MenuService };\nlet PersistedMenuHideState = class PersistedMenuHideState {\n    constructor(_storageService) {\n        this._storageService = _storageService;\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._ignoreChangeEvent = false;\n        try {\n            const raw = _storageService.get(PersistedMenuHideState._key, 0 /* StorageScope.PROFILE */, '{}');\n            this._data = JSON.parse(raw);\n        }\n        catch (err) {\n            this._data = Object.create(null);\n        }\n        this._disposables.add(_storageService.onDidChangeValue(e => {\n            if (e.key !== PersistedMenuHideState._key) {\n                return;\n            }\n            if (!this._ignoreChangeEvent) {\n                try {\n                    const raw = _storageService.get(PersistedMenuHideState._key, 0 /* StorageScope.PROFILE */, '{}');\n                    this._data = JSON.parse(raw);\n                }\n                catch (err) {\n                    console.log('FAILED to read storage after UPDATE', err);\n                }\n            }\n            this._onDidChange.fire();\n        }));\n    }\n    dispose() {\n        this._onDidChange.dispose();\n        this._disposables.dispose();\n    }\n    isHidden(menu, commandId) {\n        var _a, _b;\n        return (_b = (_a = this._data[menu.id]) === null || _a === void 0 ? void 0 : _a.includes(commandId)) !== null && _b !== void 0 ? _b : false;\n    }\n    updateHidden(menu, commandId, hidden) {\n        const entries = this._data[menu.id];\n        if (!hidden) {\n            // remove and cleanup\n            if (entries) {\n                const idx = entries.indexOf(commandId);\n                if (idx >= 0) {\n                    removeFastWithoutKeepingOrder(entries, idx);\n                }\n                if (entries.length === 0) {\n                    delete this._data[menu.id];\n                }\n            }\n        }\n        else {\n            // add unless already added\n            if (!entries) {\n                this._data[menu.id] = [commandId];\n            }\n            else {\n                const idx = entries.indexOf(commandId);\n                if (idx < 0) {\n                    entries.push(commandId);\n                }\n            }\n        }\n        this._persist();\n    }\n    _persist() {\n        try {\n            this._ignoreChangeEvent = true;\n            const raw = JSON.stringify(this._data);\n            this._storageService.store(PersistedMenuHideState._key, raw, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n        }\n        finally {\n            this._ignoreChangeEvent = false;\n        }\n    }\n};\nPersistedMenuHideState._key = 'menu.hiddenCommands';\nPersistedMenuHideState = __decorate([\n    __param(0, IStorageService)\n], PersistedMenuHideState);\nlet Menu = class Menu {\n    constructor(_id, _hiddenStates, _options, _commandService, _contextKeyService, _menuService) {\n        this._id = _id;\n        this._hiddenStates = _hiddenStates;\n        this._options = _options;\n        this._commandService = _commandService;\n        this._contextKeyService = _contextKeyService;\n        this._menuService = _menuService;\n        this._disposables = new DisposableStore();\n        this._menuGroups = [];\n        this._contextKeys = new Set();\n        this._build();\n        // Rebuild this menu whenever the menu registry reports an event for this MenuId.\n        // This usually happen while code and extensions are loaded and affects the over\n        // structure of the menu\n        const rebuildMenuSoon = new RunOnceScheduler(() => {\n            this._build();\n            this._onDidChange.fire(this);\n        }, _options.eventDebounceDelay);\n        this._disposables.add(rebuildMenuSoon);\n        this._disposables.add(MenuRegistry.onDidChangeMenu(e => {\n            if (e.has(_id)) {\n                rebuildMenuSoon.schedule();\n            }\n        }));\n        // When context keys or storage state changes we need to check if the menu also has changed. However,\n        // we only do that when someone listens on this menu because (1) these events are\n        // firing often and (2) menu are often leaked\n        const lazyListener = this._disposables.add(new DisposableStore());\n        const startLazyListener = () => {\n            const fireChangeSoon = new RunOnceScheduler(() => this._onDidChange.fire(this), _options.eventDebounceDelay);\n            lazyListener.add(fireChangeSoon);\n            lazyListener.add(_contextKeyService.onDidChangeContext(e => {\n                if (e.affectsSome(this._contextKeys)) {\n                    fireChangeSoon.schedule();\n                }\n            }));\n            lazyListener.add(_hiddenStates.onDidChange(() => {\n                fireChangeSoon.schedule();\n            }));\n        };\n        this._onDidChange = new Emitter({\n            // start/stop context key listener\n            onFirstListenerAdd: startLazyListener,\n            onLastListenerRemove: lazyListener.clear.bind(lazyListener)\n        });\n        this.onDidChange = this._onDidChange.event;\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n    }\n    _build() {\n        // reset\n        this._menuGroups.length = 0;\n        this._contextKeys.clear();\n        const menuItems = MenuRegistry.getMenuItems(this._id);\n        let group;\n        menuItems.sort(Menu._compareMenuItems);\n        for (const item of menuItems) {\n            // group by groupId\n            const groupName = item.group || '';\n            if (!group || group[0] !== groupName) {\n                group = [groupName, []];\n                this._menuGroups.push(group);\n            }\n            group[1].push(item);\n            // keep keys for eventing\n            this._collectContextKeys(item);\n        }\n    }\n    _collectContextKeys(item) {\n        Menu._fillInKbExprKeys(item.when, this._contextKeys);\n        if (isIMenuItem(item)) {\n            // keep precondition keys for event if applicable\n            if (item.command.precondition) {\n                Menu._fillInKbExprKeys(item.command.precondition, this._contextKeys);\n            }\n            // keep toggled keys for event if applicable\n            if (item.command.toggled) {\n                const toggledExpression = item.command.toggled.condition || item.command.toggled;\n                Menu._fillInKbExprKeys(toggledExpression, this._contextKeys);\n            }\n        }\n        else if (this._options.emitEventsForSubmenuChanges) {\n            // recursively collect context keys from submenus so that this\n            // menu fires events when context key changes affect submenus\n            MenuRegistry.getMenuItems(item.submenu).forEach(this._collectContextKeys, this);\n        }\n    }\n    getActions(options) {\n        const result = [];\n        const allToggleActions = [];\n        for (const group of this._menuGroups) {\n            const [id, items] = group;\n            const toggleActions = [];\n            const activeActions = [];\n            for (const item of items) {\n                if (this._contextKeyService.contextMatchesRules(item.when)) {\n                    let action;\n                    const isMenuItem = isIMenuItem(item);\n                    if (isMenuItem) {\n                        const menuHide = createMenuHide(this._id, item.command, this._hiddenStates);\n                        action = new MenuItemAction(item.command, item.alt, options, menuHide, this._contextKeyService, this._commandService);\n                    }\n                    else {\n                        action = new SubmenuItemAction(item, this._menuService, this._contextKeyService, options);\n                        if (action.actions.length === 0) {\n                            action.dispose();\n                            action = undefined;\n                        }\n                    }\n                    if (action) {\n                        activeActions.push(action);\n                    }\n                }\n            }\n            if (activeActions.length > 0) {\n                result.push([id, activeActions]);\n            }\n            if (toggleActions.length > 0) {\n                allToggleActions.push(toggleActions);\n            }\n        }\n        return result;\n    }\n    static _fillInKbExprKeys(exp, set) {\n        if (exp) {\n            for (const key of exp.keys()) {\n                set.add(key);\n            }\n        }\n    }\n    static _compareMenuItems(a, b) {\n        const aGroup = a.group;\n        const bGroup = b.group;\n        if (aGroup !== bGroup) {\n            // Falsy groups come last\n            if (!aGroup) {\n                return 1;\n            }\n            else if (!bGroup) {\n                return -1;\n            }\n            // 'navigation' group comes first\n            if (aGroup === 'navigation') {\n                return -1;\n            }\n            else if (bGroup === 'navigation') {\n                return 1;\n            }\n            // lexical sort for groups\n            const value = aGroup.localeCompare(bGroup);\n            if (value !== 0) {\n                return value;\n            }\n        }\n        // sort on priority - default is 0\n        const aPrio = a.order || 0;\n        const bPrio = b.order || 0;\n        if (aPrio < bPrio) {\n            return -1;\n        }\n        else if (aPrio > bPrio) {\n            return 1;\n        }\n        // sort on titles\n        return Menu._compareTitles(isIMenuItem(a) ? a.command.title : a.title, isIMenuItem(b) ? b.command.title : b.title);\n    }\n    static _compareTitles(a, b) {\n        const aStr = typeof a === 'string' ? a : a.original;\n        const bStr = typeof b === 'string' ? b : b.original;\n        return aStr.localeCompare(bStr);\n    }\n};\nMenu = __decorate([\n    __param(3, ICommandService),\n    __param(4, IContextKeyService),\n    __param(5, IMenuService)\n], Menu);\nfunction createMenuHide(menu, command, states) {\n    const id = `${menu.id}/${command.id}`;\n    const title = typeof command.title === 'string' ? command.title : command.title.value;\n    const hide = toAction({\n        id,\n        label: localize('hide.label', 'Hide \\'{0}\\'', title),\n        run() { states.updateHidden(menu, command.id, true); }\n    });\n    const toggle = toAction({\n        id,\n        label: title,\n        get checked() { return !states.isHidden(menu, command.id); },\n        run() {\n            const newValue = !states.isHidden(menu, command.id);\n            states.updateHidden(menu, command.id, newValue);\n        }\n    });\n    return {\n        hide,\n        toggle,\n        get isHidden() { return !toggle.checked; },\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isSafari, isWebkitWebView } from '../../../base/browser/browser.js';\nimport { $, addDisposableListener } from '../../../base/browser/dom.js';\nimport { DeferredPromise } from '../../../base/common/async.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { ILayoutService } from '../../layout/browser/layoutService.js';\nimport { ILogService } from '../../log/common/log.js';\nlet BrowserClipboardService = class BrowserClipboardService extends Disposable {\n    constructor(layoutService, logService) {\n        super();\n        this.layoutService = layoutService;\n        this.logService = logService;\n        this.mapTextToType = new Map(); // unsupported in web (only in-memory)\n        this.findText = ''; // unsupported in web (only in-memory)\n        this.resources = [];\n        if (isSafari || isWebkitWebView) {\n            this.installWebKitWriteTextWorkaround();\n        }\n    }\n    // In Safari, it has the following note:\n    //\n    // \"The request to write to the clipboard must be triggered during a user gesture.\n    // A call to clipboard.write or clipboard.writeText outside the scope of a user\n    // gesture(such as \"click\" or \"touch\" event handlers) will result in the immediate\n    // rejection of the promise returned by the API call.\"\n    // From: https://webkit.org/blog/10855/async-clipboard-api/\n    //\n    // Since extensions run in a web worker, and handle gestures in an asynchronous way,\n    // they are not classified by Safari as \"in response to a user gesture\" and will reject.\n    //\n    // This function sets up some handlers to work around that behavior.\n    installWebKitWriteTextWorkaround() {\n        const handler = () => {\n            const currentWritePromise = new DeferredPromise();\n            // Cancel the previous promise since we just created a new one in response to this new event\n            if (this.webKitPendingClipboardWritePromise && !this.webKitPendingClipboardWritePromise.isSettled) {\n                this.webKitPendingClipboardWritePromise.cancel();\n            }\n            this.webKitPendingClipboardWritePromise = currentWritePromise;\n            // The ctor of ClipboardItem allows you to pass in a promise that will resolve to a string.\n            // This allows us to pass in a Promise that will either be cancelled by another event or\n            // resolved with the contents of the first call to this.writeText.\n            // see https://developer.mozilla.org/en-US/docs/Web/API/ClipboardItem/ClipboardItem#parameters\n            navigator.clipboard.write([new ClipboardItem({\n                    'text/plain': currentWritePromise.p,\n                })]).catch((err) => __awaiter(this, void 0, void 0, function* () {\n                if (!(err instanceof Error) || err.name !== 'NotAllowedError' || !currentWritePromise.isRejected) {\n                    this.logService.error(err);\n                }\n            }));\n        };\n        if (this.layoutService.hasContainer) {\n            this._register(addDisposableListener(this.layoutService.container, 'click', handler));\n            this._register(addDisposableListener(this.layoutService.container, 'keydown', handler));\n        }\n    }\n    writeText(text, type) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // With type: only in-memory is supported\n            if (type) {\n                this.mapTextToType.set(type, text);\n                return;\n            }\n            if (this.webKitPendingClipboardWritePromise) {\n                // For Safari, we complete this Promise which allows the call to `navigator.clipboard.write()`\n                // above to resolve and successfully copy to the clipboard. If we let this continue, Safari\n                // would throw an error because this call stack doesn't appear to originate from a user gesture.\n                return this.webKitPendingClipboardWritePromise.complete(text);\n            }\n            // Guard access to navigator.clipboard with try/catch\n            // as we have seen DOMExceptions in certain browsers\n            // due to security policies.\n            try {\n                return yield navigator.clipboard.writeText(text);\n            }\n            catch (error) {\n                console.error(error);\n            }\n            // Fallback to textarea and execCommand solution\n            const activeElement = document.activeElement;\n            const textArea = document.body.appendChild($('textarea', { 'aria-hidden': true }));\n            textArea.style.height = '1px';\n            textArea.style.width = '1px';\n            textArea.style.position = 'absolute';\n            textArea.value = text;\n            textArea.focus();\n            textArea.select();\n            document.execCommand('copy');\n            if (activeElement instanceof HTMLElement) {\n                activeElement.focus();\n            }\n            document.body.removeChild(textArea);\n            return;\n        });\n    }\n    readText(type) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // With type: only in-memory is supported\n            if (type) {\n                return this.mapTextToType.get(type) || '';\n            }\n            // Guard access to navigator.clipboard with try/catch\n            // as we have seen DOMExceptions in certain browsers\n            // due to security policies.\n            try {\n                return yield navigator.clipboard.readText();\n            }\n            catch (error) {\n                console.error(error);\n                return '';\n            }\n        });\n    }\n    readFindText() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.findText;\n        });\n    }\n    writeFindText(text) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.findText = text;\n        });\n    }\n    readResources() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.resources;\n        });\n    }\n};\nBrowserClipboardService = __decorate([\n    __param(0, ILayoutService),\n    __param(1, ILogService)\n], BrowserClipboardService);\nexport { BrowserClipboardService };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { PauseableEmitter } from '../../../base/common/event.js';\nimport { Iterable } from '../../../base/common/iterator.js';\nimport { DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { TernarySearchTree } from '../../../base/common/map.js';\nimport { cloneAndChange } from '../../../base/common/objects.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { CommandsRegistry } from '../../commands/common/commands.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IContextKeyService, RawContextKey, SET_CONTEXT_COMMAND_ID } from '../common/contextkey.js';\nconst KEYBINDING_CONTEXT_ATTR = 'data-keybinding-context';\nexport class Context {\n    constructor(id, parent) {\n        this._id = id;\n        this._parent = parent;\n        this._value = Object.create(null);\n        this._value['_contextId'] = id;\n    }\n    get value() {\n        return Object.assign({}, this._value);\n    }\n    setValue(key, value) {\n        // console.log('SET ' + key + ' = ' + value + ' ON ' + this._id);\n        if (this._value[key] !== value) {\n            this._value[key] = value;\n            return true;\n        }\n        return false;\n    }\n    removeValue(key) {\n        // console.log('REMOVE ' + key + ' FROM ' + this._id);\n        if (key in this._value) {\n            delete this._value[key];\n            return true;\n        }\n        return false;\n    }\n    getValue(key) {\n        const ret = this._value[key];\n        if (typeof ret === 'undefined' && this._parent) {\n            return this._parent.getValue(key);\n        }\n        return ret;\n    }\n}\nclass NullContext extends Context {\n    constructor() {\n        super(-1, null);\n    }\n    setValue(key, value) {\n        return false;\n    }\n    removeValue(key) {\n        return false;\n    }\n    getValue(key) {\n        return undefined;\n    }\n}\nNullContext.INSTANCE = new NullContext();\nclass ConfigAwareContextValuesContainer extends Context {\n    constructor(id, _configurationService, emitter) {\n        super(id, null);\n        this._configurationService = _configurationService;\n        this._values = TernarySearchTree.forConfigKeys();\n        this._listener = this._configurationService.onDidChangeConfiguration(event => {\n            if (event.source === 7 /* ConfigurationTarget.DEFAULT */) {\n                // new setting, reset everything\n                const allKeys = Array.from(Iterable.map(this._values, ([k]) => k));\n                this._values.clear();\n                emitter.fire(new ArrayContextKeyChangeEvent(allKeys));\n            }\n            else {\n                const changedKeys = [];\n                for (const configKey of event.affectedKeys) {\n                    const contextKey = `config.${configKey}`;\n                    const cachedItems = this._values.findSuperstr(contextKey);\n                    if (cachedItems !== undefined) {\n                        changedKeys.push(...Iterable.map(cachedItems, ([key]) => key));\n                        this._values.deleteSuperstr(contextKey);\n                    }\n                    if (this._values.has(contextKey)) {\n                        changedKeys.push(contextKey);\n                        this._values.delete(contextKey);\n                    }\n                }\n                emitter.fire(new ArrayContextKeyChangeEvent(changedKeys));\n            }\n        });\n    }\n    dispose() {\n        this._listener.dispose();\n    }\n    getValue(key) {\n        if (key.indexOf(ConfigAwareContextValuesContainer._keyPrefix) !== 0) {\n            return super.getValue(key);\n        }\n        if (this._values.has(key)) {\n            return this._values.get(key);\n        }\n        const configKey = key.substr(ConfigAwareContextValuesContainer._keyPrefix.length);\n        const configValue = this._configurationService.getValue(configKey);\n        let value = undefined;\n        switch (typeof configValue) {\n            case 'number':\n            case 'boolean':\n            case 'string':\n                value = configValue;\n                break;\n            default:\n                if (Array.isArray(configValue)) {\n                    value = JSON.stringify(configValue);\n                }\n                else {\n                    value = configValue;\n                }\n        }\n        this._values.set(key, value);\n        return value;\n    }\n    setValue(key, value) {\n        return super.setValue(key, value);\n    }\n    removeValue(key) {\n        return super.removeValue(key);\n    }\n}\nConfigAwareContextValuesContainer._keyPrefix = 'config.';\nclass ContextKey {\n    constructor(service, key, defaultValue) {\n        this._service = service;\n        this._key = key;\n        this._defaultValue = defaultValue;\n        this.reset();\n    }\n    set(value) {\n        this._service.setContext(this._key, value);\n    }\n    reset() {\n        if (typeof this._defaultValue === 'undefined') {\n            this._service.removeContext(this._key);\n        }\n        else {\n            this._service.setContext(this._key, this._defaultValue);\n        }\n    }\n    get() {\n        return this._service.getContextKeyValue(this._key);\n    }\n}\nclass SimpleContextKeyChangeEvent {\n    constructor(key) {\n        this.key = key;\n    }\n    affectsSome(keys) {\n        return keys.has(this.key);\n    }\n    allKeysContainedIn(keys) {\n        return this.affectsSome(keys);\n    }\n}\nclass ArrayContextKeyChangeEvent {\n    constructor(keys) {\n        this.keys = keys;\n    }\n    affectsSome(keys) {\n        for (const key of this.keys) {\n            if (keys.has(key)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    allKeysContainedIn(keys) {\n        return this.keys.every(key => keys.has(key));\n    }\n}\nclass CompositeContextKeyChangeEvent {\n    constructor(events) {\n        this.events = events;\n    }\n    affectsSome(keys) {\n        for (const e of this.events) {\n            if (e.affectsSome(keys)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    allKeysContainedIn(keys) {\n        return this.events.every(evt => evt.allKeysContainedIn(keys));\n    }\n}\nfunction allEventKeysInContext(event, context) {\n    return event.allKeysContainedIn(new Set(Object.keys(context)));\n}\nexport class AbstractContextKeyService {\n    constructor(myContextId) {\n        this._onDidChangeContext = new PauseableEmitter({ merge: input => new CompositeContextKeyChangeEvent(input) });\n        this.onDidChangeContext = this._onDidChangeContext.event;\n        this._isDisposed = false;\n        this._myContextId = myContextId;\n    }\n    createKey(key, defaultValue) {\n        if (this._isDisposed) {\n            throw new Error(`AbstractContextKeyService has been disposed`);\n        }\n        return new ContextKey(this, key, defaultValue);\n    }\n    bufferChangeEvents(callback) {\n        this._onDidChangeContext.pause();\n        try {\n            callback();\n        }\n        finally {\n            this._onDidChangeContext.resume();\n        }\n    }\n    createScoped(domNode) {\n        if (this._isDisposed) {\n            throw new Error(`AbstractContextKeyService has been disposed`);\n        }\n        return new ScopedContextKeyService(this, domNode);\n    }\n    contextMatchesRules(rules) {\n        if (this._isDisposed) {\n            throw new Error(`AbstractContextKeyService has been disposed`);\n        }\n        const context = this.getContextValuesContainer(this._myContextId);\n        const result = (rules ? rules.evaluate(context) : true);\n        // console.group(rules.serialize() + ' -> ' + result);\n        // rules.keys().forEach(key => { console.log(key, ctx[key]); });\n        // console.groupEnd();\n        return result;\n    }\n    getContextKeyValue(key) {\n        if (this._isDisposed) {\n            return undefined;\n        }\n        return this.getContextValuesContainer(this._myContextId).getValue(key);\n    }\n    setContext(key, value) {\n        if (this._isDisposed) {\n            return;\n        }\n        const myContext = this.getContextValuesContainer(this._myContextId);\n        if (!myContext) {\n            return;\n        }\n        if (myContext.setValue(key, value)) {\n            this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key));\n        }\n    }\n    removeContext(key) {\n        if (this._isDisposed) {\n            return;\n        }\n        if (this.getContextValuesContainer(this._myContextId).removeValue(key)) {\n            this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key));\n        }\n    }\n    getContext(target) {\n        if (this._isDisposed) {\n            return NullContext.INSTANCE;\n        }\n        return this.getContextValuesContainer(findContextAttr(target));\n    }\n}\nlet ContextKeyService = class ContextKeyService extends AbstractContextKeyService {\n    constructor(configurationService) {\n        super(0);\n        this._contexts = new Map();\n        this._toDispose = new DisposableStore();\n        this._lastContextId = 0;\n        const myContext = new ConfigAwareContextValuesContainer(this._myContextId, configurationService, this._onDidChangeContext);\n        this._contexts.set(this._myContextId, myContext);\n        this._toDispose.add(myContext);\n        // Uncomment this to see the contexts continuously logged\n        // let lastLoggedValue: string | null = null;\n        // setInterval(() => {\n        // \tlet values = Object.keys(this._contexts).map((key) => this._contexts[key]);\n        // \tlet logValue = values.map(v => JSON.stringify(v._value, null, '\\t')).join('\\n');\n        // \tif (lastLoggedValue !== logValue) {\n        // \t\tlastLoggedValue = logValue;\n        // \t\tconsole.log(lastLoggedValue);\n        // \t}\n        // }, 2000);\n    }\n    dispose() {\n        this._onDidChangeContext.dispose();\n        this._isDisposed = true;\n        this._toDispose.dispose();\n    }\n    getContextValuesContainer(contextId) {\n        if (this._isDisposed) {\n            return NullContext.INSTANCE;\n        }\n        return this._contexts.get(contextId) || NullContext.INSTANCE;\n    }\n    createChildContext(parentContextId = this._myContextId) {\n        if (this._isDisposed) {\n            throw new Error(`ContextKeyService has been disposed`);\n        }\n        const id = (++this._lastContextId);\n        this._contexts.set(id, new Context(id, this.getContextValuesContainer(parentContextId)));\n        return id;\n    }\n    disposeContext(contextId) {\n        if (!this._isDisposed) {\n            this._contexts.delete(contextId);\n        }\n    }\n};\nContextKeyService = __decorate([\n    __param(0, IConfigurationService)\n], ContextKeyService);\nexport { ContextKeyService };\nclass ScopedContextKeyService extends AbstractContextKeyService {\n    constructor(parent, domNode) {\n        super(parent.createChildContext());\n        this._parentChangeListener = new MutableDisposable();\n        this._parent = parent;\n        this._updateParentChangeListener();\n        this._domNode = domNode;\n        if (this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\n            let extraInfo = '';\n            if (this._domNode.classList) {\n                extraInfo = Array.from(this._domNode.classList.values()).join(', ');\n            }\n            console.error(`Element already has context attribute${extraInfo ? ': ' + extraInfo : ''}`);\n        }\n        this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR, String(this._myContextId));\n    }\n    _updateParentChangeListener() {\n        // Forward parent events to this listener. Parent will change.\n        this._parentChangeListener.value = this._parent.onDidChangeContext(e => {\n            const thisContainer = this._parent.getContextValuesContainer(this._myContextId);\n            const thisContextValues = thisContainer.value;\n            if (!allEventKeysInContext(e, thisContextValues)) {\n                this._onDidChangeContext.fire(e);\n            }\n        });\n    }\n    dispose() {\n        if (this._isDisposed) {\n            return;\n        }\n        this._onDidChangeContext.dispose();\n        this._parent.disposeContext(this._myContextId);\n        this._parentChangeListener.dispose();\n        this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR);\n        this._isDisposed = true;\n    }\n    getContextValuesContainer(contextId) {\n        if (this._isDisposed) {\n            return NullContext.INSTANCE;\n        }\n        return this._parent.getContextValuesContainer(contextId);\n    }\n    createChildContext(parentContextId = this._myContextId) {\n        if (this._isDisposed) {\n            throw new Error(`ScopedContextKeyService has been disposed`);\n        }\n        return this._parent.createChildContext(parentContextId);\n    }\n    disposeContext(contextId) {\n        if (this._isDisposed) {\n            return;\n        }\n        this._parent.disposeContext(contextId);\n    }\n}\nfunction findContextAttr(domNode) {\n    while (domNode) {\n        if (domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\n            const attr = domNode.getAttribute(KEYBINDING_CONTEXT_ATTR);\n            if (attr) {\n                return parseInt(attr, 10);\n            }\n            return NaN;\n        }\n        domNode = domNode.parentElement;\n    }\n    return 0;\n}\nexport function setContext(accessor, contextKey, contextValue) {\n    accessor.get(IContextKeyService).createKey(String(contextKey), stringifyURIs(contextValue));\n}\nfunction stringifyURIs(contextValue) {\n    return cloneAndChange(contextValue, (obj) => {\n        if (typeof obj === 'object' && obj.$mid === 1 /* MarshalledId.Uri */) {\n            return URI.revive(obj).toString();\n        }\n        if (obj instanceof URI) {\n            return obj.toString();\n        }\n        return undefined;\n    });\n}\nCommandsRegistry.registerCommand(SET_CONTEXT_COMMAND_ID, setContext);\nCommandsRegistry.registerCommand({\n    id: 'getContextKeyInfo',\n    handler() {\n        return [...RawContextKey.all()].sort((a, b) => a.key.localeCompare(b.key));\n    },\n    description: {\n        description: localize('getContextKeyInfo', \"A command that returns information about context keys\"),\n        args: []\n    }\n});\nCommandsRegistry.registerCommand('_generateContextKeyInfo', function () {\n    const result = [];\n    const seen = new Set();\n    for (const info of RawContextKey.all()) {\n        if (!seen.has(info.key)) {\n            seen.add(info.key);\n            result.push(info);\n        }\n    }\n    result.sort((a, b) => a.key.localeCompare(b.key));\n    console.log(JSON.stringify(result, undefined, 2));\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Node {\n    constructor(data) {\n        this.incoming = new Map();\n        this.outgoing = new Map();\n        this.data = data;\n    }\n}\nexport class Graph {\n    constructor(_hashFn) {\n        this._hashFn = _hashFn;\n        this._nodes = new Map();\n        // empty\n    }\n    roots() {\n        const ret = [];\n        for (const node of this._nodes.values()) {\n            if (node.outgoing.size === 0) {\n                ret.push(node);\n            }\n        }\n        return ret;\n    }\n    insertEdge(from, to) {\n        const fromNode = this.lookupOrInsertNode(from);\n        const toNode = this.lookupOrInsertNode(to);\n        fromNode.outgoing.set(this._hashFn(to), toNode);\n        toNode.incoming.set(this._hashFn(from), fromNode);\n    }\n    removeNode(data) {\n        const key = this._hashFn(data);\n        this._nodes.delete(key);\n        for (const node of this._nodes.values()) {\n            node.outgoing.delete(key);\n            node.incoming.delete(key);\n        }\n    }\n    lookupOrInsertNode(data) {\n        const key = this._hashFn(data);\n        let node = this._nodes.get(key);\n        if (!node) {\n            node = new Node(data);\n            this._nodes.set(key, node);\n        }\n        return node;\n    }\n    isEmpty() {\n        return this._nodes.size === 0;\n    }\n    toString() {\n        const data = [];\n        for (const [key, value] of this._nodes) {\n            data.push(`${key}, (incoming)[${[...value.incoming.keys()].join(', ')}], (outgoing)[${[...value.outgoing.keys()].join(',')}]`);\n        }\n        return data.join('\\n');\n    }\n    /**\n     * This is brute force and slow and **only** be used\n     * to trouble shoot.\n     */\n    findCycleSlow() {\n        for (const [id, node] of this._nodes) {\n            const seen = new Set([id]);\n            const res = this._findCycle(node, seen);\n            if (res) {\n                return res;\n            }\n        }\n        return undefined;\n    }\n    _findCycle(node, seen) {\n        for (const [id, outgoing] of node.outgoing) {\n            if (seen.has(id)) {\n                return [...seen, id].join(' -> ');\n            }\n            seen.add(id);\n            const value = this._findCycle(outgoing, seen);\n            if (value) {\n                return value;\n            }\n            seen.delete(id);\n        }\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IdleValue } from '../../../base/common/async.js';\nimport { illegalState } from '../../../base/common/errors.js';\nimport { SyncDescriptor } from './descriptors.js';\nimport { Graph } from './graph.js';\nimport { IInstantiationService, _util } from './instantiation.js';\nimport { ServiceCollection } from './serviceCollection.js';\n// TRACING\nconst _enableTracing = false;\nclass CyclicDependencyError extends Error {\n    constructor(graph) {\n        var _a;\n        super('cyclic dependency between services');\n        this.message = (_a = graph.findCycleSlow()) !== null && _a !== void 0 ? _a : `UNABLE to detect cycle, dumping graph: \\n${graph.toString()}`;\n    }\n}\nexport class InstantiationService {\n    constructor(services = new ServiceCollection(), strict = false, parent) {\n        this._activeInstantiations = new Set();\n        this._services = services;\n        this._strict = strict;\n        this._parent = parent;\n        this._services.set(IInstantiationService, this);\n    }\n    createChild(services) {\n        return new InstantiationService(services, this._strict, this);\n    }\n    invokeFunction(fn, ...args) {\n        const _trace = Trace.traceInvocation(fn);\n        let _done = false;\n        try {\n            const accessor = {\n                get: (id) => {\n                    if (_done) {\n                        throw illegalState('service accessor is only valid during the invocation of its target method');\n                    }\n                    const result = this._getOrCreateServiceInstance(id, _trace);\n                    if (!result) {\n                        throw new Error(`[invokeFunction] unknown service '${id}'`);\n                    }\n                    return result;\n                }\n            };\n            return fn(accessor, ...args);\n        }\n        finally {\n            _done = true;\n            _trace.stop();\n        }\n    }\n    createInstance(ctorOrDescriptor, ...rest) {\n        let _trace;\n        let result;\n        if (ctorOrDescriptor instanceof SyncDescriptor) {\n            _trace = Trace.traceCreation(ctorOrDescriptor.ctor);\n            result = this._createInstance(ctorOrDescriptor.ctor, ctorOrDescriptor.staticArguments.concat(rest), _trace);\n        }\n        else {\n            _trace = Trace.traceCreation(ctorOrDescriptor);\n            result = this._createInstance(ctorOrDescriptor, rest, _trace);\n        }\n        _trace.stop();\n        return result;\n    }\n    _createInstance(ctor, args = [], _trace) {\n        // arguments defined by service decorators\n        const serviceDependencies = _util.getServiceDependencies(ctor).sort((a, b) => a.index - b.index);\n        const serviceArgs = [];\n        for (const dependency of serviceDependencies) {\n            const service = this._getOrCreateServiceInstance(dependency.id, _trace);\n            if (!service) {\n                this._throwIfStrict(`[createInstance] ${ctor.name} depends on UNKNOWN service ${dependency.id}.`, false);\n            }\n            serviceArgs.push(service);\n        }\n        const firstServiceArgPos = serviceDependencies.length > 0 ? serviceDependencies[0].index : args.length;\n        // check for argument mismatches, adjust static args if needed\n        if (args.length !== firstServiceArgPos) {\n            console.trace(`[createInstance] First service dependency of ${ctor.name} at position ${firstServiceArgPos + 1} conflicts with ${args.length} static arguments`);\n            const delta = firstServiceArgPos - args.length;\n            if (delta > 0) {\n                args = args.concat(new Array(delta));\n            }\n            else {\n                args = args.slice(0, firstServiceArgPos);\n            }\n        }\n        // now create the instance\n        return new ctor(...[...args, ...serviceArgs]);\n    }\n    _setServiceInstance(id, instance) {\n        if (this._services.get(id) instanceof SyncDescriptor) {\n            this._services.set(id, instance);\n        }\n        else if (this._parent) {\n            this._parent._setServiceInstance(id, instance);\n        }\n        else {\n            throw new Error('illegalState - setting UNKNOWN service instance');\n        }\n    }\n    _getServiceInstanceOrDescriptor(id) {\n        const instanceOrDesc = this._services.get(id);\n        if (!instanceOrDesc && this._parent) {\n            return this._parent._getServiceInstanceOrDescriptor(id);\n        }\n        else {\n            return instanceOrDesc;\n        }\n    }\n    _getOrCreateServiceInstance(id, _trace) {\n        const thing = this._getServiceInstanceOrDescriptor(id);\n        if (thing instanceof SyncDescriptor) {\n            return this._safeCreateAndCacheServiceInstance(id, thing, _trace.branch(id, true));\n        }\n        else {\n            _trace.branch(id, false);\n            return thing;\n        }\n    }\n    _safeCreateAndCacheServiceInstance(id, desc, _trace) {\n        if (this._activeInstantiations.has(id)) {\n            throw new Error(`illegal state - RECURSIVELY instantiating service '${id}'`);\n        }\n        this._activeInstantiations.add(id);\n        try {\n            return this._createAndCacheServiceInstance(id, desc, _trace);\n        }\n        finally {\n            this._activeInstantiations.delete(id);\n        }\n    }\n    _createAndCacheServiceInstance(id, desc, _trace) {\n        const graph = new Graph(data => data.id.toString());\n        let cycleCount = 0;\n        const stack = [{ id, desc, _trace }];\n        while (stack.length) {\n            const item = stack.pop();\n            graph.lookupOrInsertNode(item);\n            // a weak but working heuristic for cycle checks\n            if (cycleCount++ > 1000) {\n                throw new CyclicDependencyError(graph);\n            }\n            // check all dependencies for existence and if they need to be created first\n            for (const dependency of _util.getServiceDependencies(item.desc.ctor)) {\n                const instanceOrDesc = this._getServiceInstanceOrDescriptor(dependency.id);\n                if (!instanceOrDesc) {\n                    this._throwIfStrict(`[createInstance] ${id} depends on ${dependency.id} which is NOT registered.`, true);\n                }\n                if (instanceOrDesc instanceof SyncDescriptor) {\n                    const d = { id: dependency.id, desc: instanceOrDesc, _trace: item._trace.branch(dependency.id, true) };\n                    graph.insertEdge(item, d);\n                    stack.push(d);\n                }\n            }\n        }\n        while (true) {\n            const roots = graph.roots();\n            // if there is no more roots but still\n            // nodes in the graph we have a cycle\n            if (roots.length === 0) {\n                if (!graph.isEmpty()) {\n                    throw new CyclicDependencyError(graph);\n                }\n                break;\n            }\n            for (const { data } of roots) {\n                // Repeat the check for this still being a service sync descriptor. That's because\n                // instantiating a dependency might have side-effect and recursively trigger instantiation\n                // so that some dependencies are now fullfilled already.\n                const instanceOrDesc = this._getServiceInstanceOrDescriptor(data.id);\n                if (instanceOrDesc instanceof SyncDescriptor) {\n                    // create instance and overwrite the service collections\n                    const instance = this._createServiceInstanceWithOwner(data.id, data.desc.ctor, data.desc.staticArguments, data.desc.supportsDelayedInstantiation, data._trace);\n                    this._setServiceInstance(data.id, instance);\n                }\n                graph.removeNode(data);\n            }\n        }\n        return this._getServiceInstanceOrDescriptor(id);\n    }\n    _createServiceInstanceWithOwner(id, ctor, args = [], supportsDelayedInstantiation, _trace) {\n        if (this._services.get(id) instanceof SyncDescriptor) {\n            return this._createServiceInstance(ctor, args, supportsDelayedInstantiation, _trace);\n        }\n        else if (this._parent) {\n            return this._parent._createServiceInstanceWithOwner(id, ctor, args, supportsDelayedInstantiation, _trace);\n        }\n        else {\n            throw new Error(`illegalState - creating UNKNOWN service instance ${ctor.name}`);\n        }\n    }\n    _createServiceInstance(ctor, args = [], _supportsDelayedInstantiation, _trace) {\n        if (!_supportsDelayedInstantiation) {\n            // eager instantiation\n            return this._createInstance(ctor, args, _trace);\n        }\n        else {\n            // Return a proxy object that's backed by an idle value. That\n            // strategy is to instantiate services in our idle time or when actually\n            // needed but not when injected into a consumer\n            const idle = new IdleValue(() => this._createInstance(ctor, args, _trace));\n            return new Proxy(Object.create(null), {\n                get(target, key) {\n                    if (key in target) {\n                        return target[key];\n                    }\n                    const obj = idle.value;\n                    let prop = obj[key];\n                    if (typeof prop !== 'function') {\n                        return prop;\n                    }\n                    prop = prop.bind(obj);\n                    target[key] = prop;\n                    return prop;\n                },\n                set(_target, p, value) {\n                    idle.value[p] = value;\n                    return true;\n                }\n            });\n        }\n    }\n    _throwIfStrict(msg, printWarning) {\n        if (printWarning) {\n            console.warn(msg);\n        }\n        if (this._strict) {\n            throw new Error(msg);\n        }\n    }\n}\nexport class Trace {\n    constructor(type, name) {\n        this.type = type;\n        this.name = name;\n        this._start = Date.now();\n        this._dep = [];\n    }\n    static traceInvocation(ctor) {\n        return !_enableTracing ? Trace._None : new Trace(1 /* TraceType.Invocation */, ctor.name || ctor.toString().substring(0, 42).replace(/\\n/g, ''));\n    }\n    static traceCreation(ctor) {\n        return !_enableTracing ? Trace._None : new Trace(0 /* TraceType.Creation */, ctor.name);\n    }\n    branch(id, first) {\n        const child = new Trace(2 /* TraceType.Branch */, id.toString());\n        this._dep.push([id, first, child]);\n        return child;\n    }\n    stop() {\n        const dur = Date.now() - this._start;\n        Trace._totals += dur;\n        let causedCreation = false;\n        function printChild(n, trace) {\n            const res = [];\n            const prefix = new Array(n + 1).join('\\t');\n            for (const [id, first, child] of trace._dep) {\n                if (first && child) {\n                    causedCreation = true;\n                    res.push(`${prefix}CREATES -> ${id}`);\n                    const nested = printChild(n + 1, child);\n                    if (nested) {\n                        res.push(nested);\n                    }\n                }\n                else {\n                    res.push(`${prefix}uses -> ${id}`);\n                }\n            }\n            return res.join('\\n');\n        }\n        const lines = [\n            `${this.type === 0 /* TraceType.Creation */ ? 'CREATE' : 'CALL'} ${this.name}`,\n            `${printChild(1, this)}`,\n            `DONE, took ${dur.toFixed(2)}ms (grand total ${Trace._totals.toFixed(2)}ms)`\n        ];\n        if (dur > 2 || causedCreation) {\n            console.log(lines.join('\\n'));\n        }\n    }\n}\nTrace._None = new class extends Trace {\n    constructor() { super(-1, null); }\n    stop() { }\n    branch() { return this; }\n};\nTrace._totals = 0;\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isFalsyOrEmpty, isNonEmptyArray } from '../../../base/common/arrays.js';\nimport { DebounceEmitter } from '../../../base/common/event.js';\nimport { Iterable } from '../../../base/common/iterator.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { MarkerSeverity } from './markers.js';\nclass DoubleResourceMap {\n    constructor() {\n        this._byResource = new ResourceMap();\n        this._byOwner = new Map();\n    }\n    set(resource, owner, value) {\n        let ownerMap = this._byResource.get(resource);\n        if (!ownerMap) {\n            ownerMap = new Map();\n            this._byResource.set(resource, ownerMap);\n        }\n        ownerMap.set(owner, value);\n        let resourceMap = this._byOwner.get(owner);\n        if (!resourceMap) {\n            resourceMap = new ResourceMap();\n            this._byOwner.set(owner, resourceMap);\n        }\n        resourceMap.set(resource, value);\n    }\n    get(resource, owner) {\n        const ownerMap = this._byResource.get(resource);\n        return ownerMap === null || ownerMap === void 0 ? void 0 : ownerMap.get(owner);\n    }\n    delete(resource, owner) {\n        let removedA = false;\n        let removedB = false;\n        const ownerMap = this._byResource.get(resource);\n        if (ownerMap) {\n            removedA = ownerMap.delete(owner);\n        }\n        const resourceMap = this._byOwner.get(owner);\n        if (resourceMap) {\n            removedB = resourceMap.delete(resource);\n        }\n        if (removedA !== removedB) {\n            throw new Error('illegal state');\n        }\n        return removedA && removedB;\n    }\n    values(key) {\n        var _a, _b, _c, _d;\n        if (typeof key === 'string') {\n            return (_b = (_a = this._byOwner.get(key)) === null || _a === void 0 ? void 0 : _a.values()) !== null && _b !== void 0 ? _b : Iterable.empty();\n        }\n        if (URI.isUri(key)) {\n            return (_d = (_c = this._byResource.get(key)) === null || _c === void 0 ? void 0 : _c.values()) !== null && _d !== void 0 ? _d : Iterable.empty();\n        }\n        return Iterable.map(Iterable.concat(...this._byOwner.values()), map => map[1]);\n    }\n}\nclass MarkerStats {\n    constructor(service) {\n        this.errors = 0;\n        this.infos = 0;\n        this.warnings = 0;\n        this.unknowns = 0;\n        this._data = new ResourceMap();\n        this._service = service;\n        this._subscription = service.onMarkerChanged(this._update, this);\n    }\n    dispose() {\n        this._subscription.dispose();\n    }\n    _update(resources) {\n        for (const resource of resources) {\n            const oldStats = this._data.get(resource);\n            if (oldStats) {\n                this._substract(oldStats);\n            }\n            const newStats = this._resourceStats(resource);\n            this._add(newStats);\n            this._data.set(resource, newStats);\n        }\n    }\n    _resourceStats(resource) {\n        const result = { errors: 0, warnings: 0, infos: 0, unknowns: 0 };\n        // TODO this is a hack\n        if (resource.scheme === Schemas.inMemory || resource.scheme === Schemas.walkThrough || resource.scheme === Schemas.walkThroughSnippet || resource.scheme === Schemas.vscodeSourceControl) {\n            return result;\n        }\n        for (const { severity } of this._service.read({ resource })) {\n            if (severity === MarkerSeverity.Error) {\n                result.errors += 1;\n            }\n            else if (severity === MarkerSeverity.Warning) {\n                result.warnings += 1;\n            }\n            else if (severity === MarkerSeverity.Info) {\n                result.infos += 1;\n            }\n            else {\n                result.unknowns += 1;\n            }\n        }\n        return result;\n    }\n    _substract(op) {\n        this.errors -= op.errors;\n        this.warnings -= op.warnings;\n        this.infos -= op.infos;\n        this.unknowns -= op.unknowns;\n    }\n    _add(op) {\n        this.errors += op.errors;\n        this.warnings += op.warnings;\n        this.infos += op.infos;\n        this.unknowns += op.unknowns;\n    }\n}\nexport class MarkerService {\n    constructor() {\n        this._onMarkerChanged = new DebounceEmitter({\n            delay: 0,\n            merge: MarkerService._merge\n        });\n        this.onMarkerChanged = this._onMarkerChanged.event;\n        this._data = new DoubleResourceMap();\n        this._stats = new MarkerStats(this);\n    }\n    dispose() {\n        this._stats.dispose();\n        this._onMarkerChanged.dispose();\n    }\n    remove(owner, resources) {\n        for (const resource of resources || []) {\n            this.changeOne(owner, resource, []);\n        }\n    }\n    changeOne(owner, resource, markerData) {\n        if (isFalsyOrEmpty(markerData)) {\n            // remove marker for this (owner,resource)-tuple\n            const removed = this._data.delete(resource, owner);\n            if (removed) {\n                this._onMarkerChanged.fire([resource]);\n            }\n        }\n        else {\n            // insert marker for this (owner,resource)-tuple\n            const markers = [];\n            for (const data of markerData) {\n                const marker = MarkerService._toMarker(owner, resource, data);\n                if (marker) {\n                    markers.push(marker);\n                }\n            }\n            this._data.set(resource, owner, markers);\n            this._onMarkerChanged.fire([resource]);\n        }\n    }\n    static _toMarker(owner, resource, data) {\n        let { code, severity, message, source, startLineNumber, startColumn, endLineNumber, endColumn, relatedInformation, tags, } = data;\n        if (!message) {\n            return undefined;\n        }\n        // santize data\n        startLineNumber = startLineNumber > 0 ? startLineNumber : 1;\n        startColumn = startColumn > 0 ? startColumn : 1;\n        endLineNumber = endLineNumber >= startLineNumber ? endLineNumber : startLineNumber;\n        endColumn = endColumn > 0 ? endColumn : startColumn;\n        return {\n            resource,\n            owner,\n            code,\n            severity,\n            message,\n            source,\n            startLineNumber,\n            startColumn,\n            endLineNumber,\n            endColumn,\n            relatedInformation,\n            tags,\n        };\n    }\n    changeAll(owner, data) {\n        const changes = [];\n        // remove old marker\n        const existing = this._data.values(owner);\n        if (existing) {\n            for (const data of existing) {\n                const first = Iterable.first(data);\n                if (first) {\n                    changes.push(first.resource);\n                    this._data.delete(first.resource, owner);\n                }\n            }\n        }\n        // add new markers\n        if (isNonEmptyArray(data)) {\n            // group by resource\n            const groups = new ResourceMap();\n            for (const { resource, marker: markerData } of data) {\n                const marker = MarkerService._toMarker(owner, resource, markerData);\n                if (!marker) {\n                    // filter bad markers\n                    continue;\n                }\n                const array = groups.get(resource);\n                if (!array) {\n                    groups.set(resource, [marker]);\n                    changes.push(resource);\n                }\n                else {\n                    array.push(marker);\n                }\n            }\n            // insert all\n            for (const [resource, value] of groups) {\n                this._data.set(resource, owner, value);\n            }\n        }\n        if (changes.length > 0) {\n            this._onMarkerChanged.fire(changes);\n        }\n    }\n    read(filter = Object.create(null)) {\n        let { owner, resource, severities, take } = filter;\n        if (!take || take < 0) {\n            take = -1;\n        }\n        if (owner && resource) {\n            // exactly one owner AND resource\n            const data = this._data.get(resource, owner);\n            if (!data) {\n                return [];\n            }\n            else {\n                const result = [];\n                for (const marker of data) {\n                    if (MarkerService._accept(marker, severities)) {\n                        const newLen = result.push(marker);\n                        if (take > 0 && newLen === take) {\n                            break;\n                        }\n                    }\n                }\n                return result;\n            }\n        }\n        else if (!owner && !resource) {\n            // all\n            const result = [];\n            for (const markers of this._data.values()) {\n                for (const data of markers) {\n                    if (MarkerService._accept(data, severities)) {\n                        const newLen = result.push(data);\n                        if (take > 0 && newLen === take) {\n                            return result;\n                        }\n                    }\n                }\n            }\n            return result;\n        }\n        else {\n            // of one resource OR owner\n            const iterable = this._data.values(resource !== null && resource !== void 0 ? resource : owner);\n            const result = [];\n            for (const markers of iterable) {\n                for (const data of markers) {\n                    if (MarkerService._accept(data, severities)) {\n                        const newLen = result.push(data);\n                        if (take > 0 && newLen === take) {\n                            return result;\n                        }\n                    }\n                }\n            }\n            return result;\n        }\n    }\n    static _accept(marker, severities) {\n        return severities === undefined || (severities & marker.severity) === marker.severity;\n    }\n    // --- event debounce logic\n    static _merge(all) {\n        const set = new ResourceMap();\n        for (const array of all) {\n            for (const item of array) {\n                set.set(item, true);\n            }\n        }\n        return Array.from(set.keys());\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { match as matchGlobPattern } from '../../base/common/glob.js';\nimport { normalize } from '../../base/common/path.js';\nexport function score(selector, candidateUri, candidateLanguage, candidateIsSynchronized, candidateNotebookUri, candidateNotebookType) {\n    if (Array.isArray(selector)) {\n        // array -> take max individual value\n        let ret = 0;\n        for (const filter of selector) {\n            const value = score(filter, candidateUri, candidateLanguage, candidateIsSynchronized, candidateNotebookUri, candidateNotebookType);\n            if (value === 10) {\n                return value; // already at the highest\n            }\n            if (value > ret) {\n                ret = value;\n            }\n        }\n        return ret;\n    }\n    else if (typeof selector === 'string') {\n        if (!candidateIsSynchronized) {\n            return 0;\n        }\n        // short-hand notion, desugars to\n        // 'fooLang' -> { language: 'fooLang'}\n        // '*' -> { language: '*' }\n        if (selector === '*') {\n            return 5;\n        }\n        else if (selector === candidateLanguage) {\n            return 10;\n        }\n        else {\n            return 0;\n        }\n    }\n    else if (selector) {\n        // filter -> select accordingly, use defaults for scheme\n        const { language, pattern, scheme, hasAccessToAllModels, notebookType } = selector; // TODO: microsoft/TypeScript#42768\n        if (!candidateIsSynchronized && !hasAccessToAllModels) {\n            return 0;\n        }\n        // selector targets a notebook -> use the notebook uri instead\n        // of the \"normal\" document uri.\n        if (notebookType && candidateNotebookUri) {\n            candidateUri = candidateNotebookUri;\n        }\n        let ret = 0;\n        if (scheme) {\n            if (scheme === candidateUri.scheme) {\n                ret = 10;\n            }\n            else if (scheme === '*') {\n                ret = 5;\n            }\n            else {\n                return 0;\n            }\n        }\n        if (language) {\n            if (language === candidateLanguage) {\n                ret = 10;\n            }\n            else if (language === '*') {\n                ret = Math.max(ret, 5);\n            }\n            else {\n                return 0;\n            }\n        }\n        if (notebookType) {\n            if (notebookType === candidateNotebookType) {\n                ret = 10;\n            }\n            else if (notebookType === '*' && candidateNotebookType !== undefined) {\n                ret = Math.max(ret, 5);\n            }\n            else {\n                return 0;\n            }\n        }\n        if (pattern) {\n            let normalizedPattern;\n            if (typeof pattern === 'string') {\n                normalizedPattern = pattern;\n            }\n            else {\n                // Since this pattern has a `base` property, we need\n                // to normalize this path first before passing it on\n                // because we will compare it against `Uri.fsPath`\n                // which uses platform specific separators.\n                // Refs: https://github.com/microsoft/vscode/issues/99938\n                normalizedPattern = Object.assign(Object.assign({}, pattern), { base: normalize(pattern.base) });\n            }\n            if (normalizedPattern === candidateUri.fsPath || matchGlobPattern(normalizedPattern, candidateUri.fsPath)) {\n                ret = 10;\n            }\n            else {\n                return 0;\n            }\n        }\n        return ret;\n    }\n    else {\n        return 0;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../base/common/event.js';\nimport { toDisposable } from '../../base/common/lifecycle.js';\nimport { shouldSynchronizeModel } from './model.js';\nimport { score } from './languageSelector.js';\nfunction isExclusive(selector) {\n    if (typeof selector === 'string') {\n        return false;\n    }\n    else if (Array.isArray(selector)) {\n        return selector.every(isExclusive);\n    }\n    else {\n        return !!selector.exclusive; // TODO: microsoft/TypeScript#42768\n    }\n}\nclass MatchCandidate {\n    constructor(uri, languageId, notebookUri, notebookType) {\n        this.uri = uri;\n        this.languageId = languageId;\n        this.notebookUri = notebookUri;\n        this.notebookType = notebookType;\n    }\n    equals(other) {\n        var _a, _b;\n        return this.notebookType === other.notebookType\n            && this.languageId === other.languageId\n            && this.uri.toString() === other.uri.toString()\n            && ((_a = this.notebookUri) === null || _a === void 0 ? void 0 : _a.toString()) === ((_b = other.notebookUri) === null || _b === void 0 ? void 0 : _b.toString());\n    }\n}\nexport class LanguageFeatureRegistry {\n    constructor(_notebookInfoResolver) {\n        this._notebookInfoResolver = _notebookInfoResolver;\n        this._clock = 0;\n        this._entries = [];\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n    }\n    register(selector, provider) {\n        let entry = {\n            selector,\n            provider,\n            _score: -1,\n            _time: this._clock++\n        };\n        this._entries.push(entry);\n        this._lastCandidate = undefined;\n        this._onDidChange.fire(this._entries.length);\n        return toDisposable(() => {\n            if (entry) {\n                const idx = this._entries.indexOf(entry);\n                if (idx >= 0) {\n                    this._entries.splice(idx, 1);\n                    this._lastCandidate = undefined;\n                    this._onDidChange.fire(this._entries.length);\n                    entry = undefined;\n                }\n            }\n        });\n    }\n    has(model) {\n        return this.all(model).length > 0;\n    }\n    all(model) {\n        if (!model) {\n            return [];\n        }\n        this._updateScores(model);\n        const result = [];\n        // from registry\n        for (const entry of this._entries) {\n            if (entry._score > 0) {\n                result.push(entry.provider);\n            }\n        }\n        return result;\n    }\n    ordered(model) {\n        const result = [];\n        this._orderedForEach(model, entry => result.push(entry.provider));\n        return result;\n    }\n    orderedGroups(model) {\n        const result = [];\n        let lastBucket;\n        let lastBucketScore;\n        this._orderedForEach(model, entry => {\n            if (lastBucket && lastBucketScore === entry._score) {\n                lastBucket.push(entry.provider);\n            }\n            else {\n                lastBucketScore = entry._score;\n                lastBucket = [entry.provider];\n                result.push(lastBucket);\n            }\n        });\n        return result;\n    }\n    _orderedForEach(model, callback) {\n        this._updateScores(model);\n        for (const entry of this._entries) {\n            if (entry._score > 0) {\n                callback(entry);\n            }\n        }\n    }\n    _updateScores(model) {\n        var _a, _b;\n        const notebookInfo = (_a = this._notebookInfoResolver) === null || _a === void 0 ? void 0 : _a.call(this, model.uri);\n        // use the uri (scheme, pattern) of the notebook info iff we have one\n        // otherwise it's the model's/document's uri\n        const candidate = notebookInfo\n            ? new MatchCandidate(model.uri, model.getLanguageId(), notebookInfo.uri, notebookInfo.type)\n            : new MatchCandidate(model.uri, model.getLanguageId(), undefined, undefined);\n        if ((_b = this._lastCandidate) === null || _b === void 0 ? void 0 : _b.equals(candidate)) {\n            // nothing has changed\n            return;\n        }\n        this._lastCandidate = candidate;\n        for (const entry of this._entries) {\n            entry._score = score(entry.selector, candidate.uri, candidate.languageId, shouldSynchronizeModel(model), candidate.notebookUri, candidate.notebookType);\n            if (isExclusive(entry.selector) && entry._score > 0) {\n                // support for one exclusive selector that overwrites\n                // any other selector\n                for (const entry of this._entries) {\n                    entry._score = 0;\n                }\n                entry._score = 1000;\n                break;\n            }\n        }\n        // needs sorting\n        this._entries.sort(LanguageFeatureRegistry._compareByScoreAndTime);\n    }\n    static _compareByScoreAndTime(a, b) {\n        if (a._score < b._score) {\n            return 1;\n        }\n        else if (a._score > b._score) {\n            return -1;\n        }\n        else if (a._time < b._time) {\n            return 1;\n        }\n        else if (a._time > b._time) {\n            return -1;\n        }\n        else {\n            return 0;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LanguageFeatureRegistry } from '../languageFeatureRegistry.js';\nimport { ILanguageFeaturesService } from './languageFeatures.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nexport class LanguageFeaturesService {\n    constructor() {\n        this.referenceProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.renameProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.codeActionProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.definitionProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.typeDefinitionProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.declarationProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.implementationProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentSymbolProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.inlayHintsProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.colorProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.codeLensProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentFormattingEditProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentRangeFormattingEditProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.onTypeFormattingEditProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.signatureHelpProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.hoverProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentHighlightProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.selectionRangeProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.foldingRangeProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.linkProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.inlineCompletionsProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.completionProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.linkedEditingRangeProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentRangeSemanticTokensProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentSemanticTokensProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentOnDropEditProvider = new LanguageFeatureRegistry(this._score.bind(this));\n        this.documentPasteEditProvider = new LanguageFeatureRegistry(this._score.bind(this));\n    }\n    _score(uri) {\n        var _a;\n        return (_a = this._notebookTypeResolver) === null || _a === void 0 ? void 0 : _a.call(this, uri);\n    }\n}\nregisterSingleton(ILanguageFeaturesService, LanguageFeaturesService, true);\n","import { addToValueTree, toValuesTree } from './configuration.js';\nimport { ConfigurationModel } from './configurationModels.js';\nimport { Extensions, overrideIdentifiersFromKey, OVERRIDE_PROPERTY_REGEX } from './configurationRegistry.js';\nimport { Registry } from '../../registry/common/platform.js';\nexport class DefaultConfigurationModel extends ConfigurationModel {\n    constructor(configurationDefaultsOverrides = {}) {\n        const properties = Registry.as(Extensions.Configuration).getConfigurationProperties();\n        const keys = Object.keys(properties);\n        const contents = Object.create(null);\n        const overrides = [];\n        for (const key in properties) {\n            const defaultOverrideValue = configurationDefaultsOverrides[key];\n            const value = defaultOverrideValue !== undefined ? defaultOverrideValue : properties[key].default;\n            addToValueTree(contents, key, value, message => console.error(`Conflict in default settings: ${message}`));\n        }\n        for (const key of Object.keys(contents)) {\n            if (OVERRIDE_PROPERTY_REGEX.test(key)) {\n                overrides.push({\n                    identifiers: overrideIdentifiersFromKey(key),\n                    keys: Object.keys(contents[key]),\n                    contents: toValuesTree(contents[key], message => console.error(`Conflict in default settings file: ${message}`)),\n                });\n            }\n        }\n        super(contents, keys, overrides);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport '../../common/languages/languageConfigurationRegistry.js';\nimport './standaloneCodeEditorService.js';\nimport './standaloneLayoutService.js';\nimport '../../../platform/undoRedo/common/undoRedoService.js';\nimport '../../common/services/languageFeatureDebounce.js';\nimport * as strings from '../../../base/common/strings.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { SimpleKeybinding, createKeybinding } from '../../../base/common/keybindings.js';\nimport { ImmortalReference, toDisposable, DisposableStore, Disposable, combinedDisposable } from '../../../base/common/lifecycle.js';\nimport { OS, isLinux, isMacintosh } from '../../../base/common/platform.js';\nimport Severity from '../../../base/common/severity.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IBulkEditService, ResourceTextEdit } from '../../browser/services/bulkEditService.js';\nimport { isDiffEditorConfigurationKey, isEditorConfigurationKey } from '../../common/config/editorConfigurationSchema.js';\nimport { EditOperation } from '../../common/core/editOperation.js';\nimport { Position as Pos } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ITextModelService } from '../../common/services/resolverService.js';\nimport { ITextResourceConfigurationService, ITextResourcePropertiesService } from '../../common/services/textResourceConfiguration.js';\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { Configuration, ConfigurationModel, ConfigurationChangeEvent } from '../../../platform/configuration/common/configurationModels.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../platform/dialogs/common/dialogs.js';\nimport { createDecorator, IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { AbstractKeybindingService } from '../../../platform/keybinding/common/abstractKeybindingService.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingResolver } from '../../../platform/keybinding/common/keybindingResolver.js';\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { ResolvedKeybindingItem } from '../../../platform/keybinding/common/resolvedKeybindingItem.js';\nimport { USLayoutResolvedKeybinding } from '../../../platform/keybinding/common/usLayoutResolvedKeybinding.js';\nimport { ILabelService } from '../../../platform/label/common/label.js';\nimport { INotificationService, NoOpNotification } from '../../../platform/notification/common/notification.js';\nimport { IEditorProgressService, IProgressService } from '../../../platform/progress/common/progress.js';\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService, WorkspaceFolder } from '../../../platform/workspace/common/workspace.js';\nimport { ILayoutService } from '../../../platform/layout/browser/layoutService.js';\nimport { StandaloneServicesNLS } from '../../common/standaloneStrings.js';\nimport { basename } from '../../../base/common/resources.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { ConsoleLogger, ILogService, LogService } from '../../../platform/log/common/log.js';\nimport { IWorkspaceTrustManagementService } from '../../../platform/workspace/common/workspaceTrust.js';\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\nimport { ContextViewService } from '../../../platform/contextview/browser/contextViewService.js';\nimport { LanguageService } from '../../common/services/languageService.js';\nimport { ContextMenuService } from '../../../platform/contextview/browser/contextMenuService.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nimport { getSingletonServiceDescriptors, registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { OpenerService } from '../../browser/services/openerService.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorker.js';\nimport { EditorWorkerService } from '../../browser/services/editorWorkerService.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { MarkerDecorationsService } from '../../common/services/markerDecorationsService.js';\nimport { IMarkerDecorationsService } from '../../common/services/markerDecorations.js';\nimport { ModelService } from '../../common/services/modelService.js';\nimport { StandaloneQuickInputService } from './quickInput/standaloneQuickInputService.js';\nimport { StandaloneThemeService } from './standaloneThemeService.js';\nimport { IStandaloneThemeService } from '../common/standaloneTheme.js';\nimport { AccessibilityService } from '../../../platform/accessibility/browser/accessibilityService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { IMenuService } from '../../../platform/actions/common/actions.js';\nimport { MenuService } from '../../../platform/actions/common/menuService.js';\nimport { BrowserClipboardService } from '../../../platform/clipboard/browser/clipboardService.js';\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyService } from '../../../platform/contextkey/browser/contextKeyService.js';\nimport { SyncDescriptor } from '../../../platform/instantiation/common/descriptors.js';\nimport { InstantiationService } from '../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { IListService, ListService } from '../../../platform/list/browser/listService.js';\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\nimport { MarkerService } from '../../../platform/markers/common/markerService.js';\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\nimport { IQuickInputService } from '../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService, InMemoryStorageService } from '../../../platform/storage/common/storage.js';\nimport '../../common/services/languageFeaturesService.js';\nimport { DefaultConfigurationModel } from '../../../platform/configuration/common/configurations.js';\nclass SimpleModel {\n    constructor(model) {\n        this.disposed = false;\n        this.model = model;\n        this._onWillDispose = new Emitter();\n    }\n    get textEditorModel() {\n        return this.model;\n    }\n    dispose() {\n        this.disposed = true;\n        this._onWillDispose.fire();\n    }\n}\nlet StandaloneTextModelService = class StandaloneTextModelService {\n    constructor(modelService) {\n        this.modelService = modelService;\n    }\n    createModelReference(resource) {\n        const model = this.modelService.getModel(resource);\n        if (!model) {\n            return Promise.reject(new Error(`Model not found`));\n        }\n        return Promise.resolve(new ImmortalReference(new SimpleModel(model)));\n    }\n};\nStandaloneTextModelService = __decorate([\n    __param(0, IModelService)\n], StandaloneTextModelService);\nclass StandaloneEditorProgressService {\n    show() {\n        return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER;\n    }\n    showWhile(promise, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield promise;\n        });\n    }\n}\nStandaloneEditorProgressService.NULL_PROGRESS_RUNNER = {\n    done: () => { },\n    total: () => { },\n    worked: () => { }\n};\nclass StandaloneProgressService {\n    withProgress(_options, task, onDidCancel) {\n        return task({\n            report: () => { },\n        });\n    }\n}\nclass StandaloneDialogService {\n    confirm(confirmation) {\n        return this.doConfirm(confirmation).then(confirmed => {\n            return {\n                confirmed,\n                checkboxChecked: false // unsupported\n            };\n        });\n    }\n    doConfirm(confirmation) {\n        let messageText = confirmation.message;\n        if (confirmation.detail) {\n            messageText = messageText + '\\n\\n' + confirmation.detail;\n        }\n        return Promise.resolve(window.confirm(messageText));\n    }\n    show(severity, message, buttons, options) {\n        return Promise.resolve({ choice: 0 });\n    }\n}\nexport class StandaloneNotificationService {\n    info(message) {\n        return this.notify({ severity: Severity.Info, message });\n    }\n    warn(message) {\n        return this.notify({ severity: Severity.Warning, message });\n    }\n    error(error) {\n        return this.notify({ severity: Severity.Error, message: error });\n    }\n    notify(notification) {\n        switch (notification.severity) {\n            case Severity.Error:\n                console.error(notification.message);\n                break;\n            case Severity.Warning:\n                console.warn(notification.message);\n                break;\n            default:\n                console.log(notification.message);\n                break;\n        }\n        return StandaloneNotificationService.NO_OP;\n    }\n    status(message, options) {\n        return Disposable.None;\n    }\n}\nStandaloneNotificationService.NO_OP = new NoOpNotification();\nlet StandaloneCommandService = class StandaloneCommandService {\n    constructor(instantiationService) {\n        this._onWillExecuteCommand = new Emitter();\n        this._onDidExecuteCommand = new Emitter();\n        this.onWillExecuteCommand = this._onWillExecuteCommand.event;\n        this.onDidExecuteCommand = this._onDidExecuteCommand.event;\n        this._instantiationService = instantiationService;\n    }\n    executeCommand(id, ...args) {\n        const command = CommandsRegistry.getCommand(id);\n        if (!command) {\n            return Promise.reject(new Error(`command '${id}' not found`));\n        }\n        try {\n            this._onWillExecuteCommand.fire({ commandId: id, args });\n            const result = this._instantiationService.invokeFunction.apply(this._instantiationService, [command.handler, ...args]);\n            this._onDidExecuteCommand.fire({ commandId: id, args });\n            return Promise.resolve(result);\n        }\n        catch (err) {\n            return Promise.reject(err);\n        }\n    }\n};\nStandaloneCommandService = __decorate([\n    __param(0, IInstantiationService)\n], StandaloneCommandService);\nexport { StandaloneCommandService };\nlet StandaloneKeybindingService = class StandaloneKeybindingService extends AbstractKeybindingService {\n    constructor(contextKeyService, commandService, telemetryService, notificationService, logService, codeEditorService) {\n        super(contextKeyService, commandService, telemetryService, notificationService, logService);\n        this._cachedResolver = null;\n        this._dynamicKeybindings = [];\n        this._domNodeListeners = [];\n        const addContainer = (domNode) => {\n            const disposables = new DisposableStore();\n            // for standard keybindings\n            disposables.add(dom.addDisposableListener(domNode, dom.EventType.KEY_DOWN, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                const shouldPreventDefault = this._dispatch(keyEvent, keyEvent.target);\n                if (shouldPreventDefault) {\n                    keyEvent.preventDefault();\n                    keyEvent.stopPropagation();\n                }\n            }));\n            // for single modifier chord keybindings (e.g. shift shift)\n            disposables.add(dom.addDisposableListener(domNode, dom.EventType.KEY_UP, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                const shouldPreventDefault = this._singleModifierDispatch(keyEvent, keyEvent.target);\n                if (shouldPreventDefault) {\n                    keyEvent.preventDefault();\n                }\n            }));\n            this._domNodeListeners.push(new DomNodeListeners(domNode, disposables));\n        };\n        const removeContainer = (domNode) => {\n            for (let i = 0; i < this._domNodeListeners.length; i++) {\n                const domNodeListeners = this._domNodeListeners[i];\n                if (domNodeListeners.domNode === domNode) {\n                    this._domNodeListeners.splice(i, 1);\n                    domNodeListeners.dispose();\n                }\n            }\n        };\n        const addCodeEditor = (codeEditor) => {\n            if (codeEditor.getOption(56 /* EditorOption.inDiffEditor */)) {\n                return;\n            }\n            addContainer(codeEditor.getContainerDomNode());\n        };\n        const removeCodeEditor = (codeEditor) => {\n            if (codeEditor.getOption(56 /* EditorOption.inDiffEditor */)) {\n                return;\n            }\n            removeContainer(codeEditor.getContainerDomNode());\n        };\n        this._register(codeEditorService.onCodeEditorAdd(addCodeEditor));\n        this._register(codeEditorService.onCodeEditorRemove(removeCodeEditor));\n        codeEditorService.listCodeEditors().forEach(addCodeEditor);\n        const addDiffEditor = (diffEditor) => {\n            addContainer(diffEditor.getContainerDomNode());\n        };\n        const removeDiffEditor = (diffEditor) => {\n            removeContainer(diffEditor.getContainerDomNode());\n        };\n        this._register(codeEditorService.onDiffEditorAdd(addDiffEditor));\n        this._register(codeEditorService.onDiffEditorRemove(removeDiffEditor));\n        codeEditorService.listDiffEditors().forEach(addDiffEditor);\n    }\n    addDynamicKeybinding(command, keybinding, handler, when) {\n        return combinedDisposable(CommandsRegistry.registerCommand(command, handler), this.addDynamicKeybindings([{\n                keybinding,\n                command,\n                when\n            }]));\n    }\n    addDynamicKeybindings(rules) {\n        const entries = rules.map((rule) => {\n            var _a, _b;\n            const keybinding = createKeybinding(rule.keybinding, OS);\n            return {\n                keybinding: (_a = keybinding === null || keybinding === void 0 ? void 0 : keybinding.parts) !== null && _a !== void 0 ? _a : null,\n                command: (_b = rule.command) !== null && _b !== void 0 ? _b : null,\n                commandArgs: rule.commandArgs,\n                when: rule.when,\n                weight1: 1000,\n                weight2: 0,\n                extensionId: null,\n                isBuiltinExtension: false\n            };\n        });\n        this._dynamicKeybindings = this._dynamicKeybindings.concat(entries);\n        this.updateResolver();\n        return toDisposable(() => {\n            // Search the first entry and remove them all since they will be contiguous\n            for (let i = 0; i < this._dynamicKeybindings.length; i++) {\n                if (this._dynamicKeybindings[i] === entries[0]) {\n                    this._dynamicKeybindings.splice(i, entries.length);\n                    this.updateResolver();\n                    return;\n                }\n            }\n        });\n    }\n    updateResolver() {\n        this._cachedResolver = null;\n        this._onDidUpdateKeybindings.fire();\n    }\n    _getResolver() {\n        if (!this._cachedResolver) {\n            const defaults = this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(), true);\n            const overrides = this._toNormalizedKeybindingItems(this._dynamicKeybindings, false);\n            this._cachedResolver = new KeybindingResolver(defaults, overrides, (str) => this._log(str));\n        }\n        return this._cachedResolver;\n    }\n    _documentHasFocus() {\n        return document.hasFocus();\n    }\n    _toNormalizedKeybindingItems(items, isDefault) {\n        const result = [];\n        let resultLen = 0;\n        for (const item of items) {\n            const when = item.when || undefined;\n            const keybinding = item.keybinding;\n            if (!keybinding) {\n                // This might be a removal keybinding item in user settings => accept it\n                result[resultLen++] = new ResolvedKeybindingItem(undefined, item.command, item.commandArgs, when, isDefault, null, false);\n            }\n            else {\n                const resolvedKeybindings = USLayoutResolvedKeybinding.resolveUserBinding(keybinding, OS);\n                for (const resolvedKeybinding of resolvedKeybindings) {\n                    result[resultLen++] = new ResolvedKeybindingItem(resolvedKeybinding, item.command, item.commandArgs, when, isDefault, null, false);\n                }\n            }\n        }\n        return result;\n    }\n    resolveKeyboardEvent(keyboardEvent) {\n        const keybinding = new SimpleKeybinding(keyboardEvent.ctrlKey, keyboardEvent.shiftKey, keyboardEvent.altKey, keyboardEvent.metaKey, keyboardEvent.keyCode).toChord();\n        return new USLayoutResolvedKeybinding(keybinding, OS);\n    }\n};\nStandaloneKeybindingService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICommandService),\n    __param(2, ITelemetryService),\n    __param(3, INotificationService),\n    __param(4, ILogService),\n    __param(5, ICodeEditorService)\n], StandaloneKeybindingService);\nexport { StandaloneKeybindingService };\nclass DomNodeListeners extends Disposable {\n    constructor(domNode, disposables) {\n        super();\n        this.domNode = domNode;\n        this._register(disposables);\n    }\n}\nfunction isConfigurationOverrides(thing) {\n    return thing\n        && typeof thing === 'object'\n        && (!thing.overrideIdentifier || typeof thing.overrideIdentifier === 'string')\n        && (!thing.resource || thing.resource instanceof URI);\n}\nexport class StandaloneConfigurationService {\n    constructor() {\n        this._onDidChangeConfiguration = new Emitter();\n        this.onDidChangeConfiguration = this._onDidChangeConfiguration.event;\n        this._configuration = new Configuration(new DefaultConfigurationModel(), new ConfigurationModel(), new ConfigurationModel(), new ConfigurationModel());\n    }\n    getValue(arg1, arg2) {\n        const section = typeof arg1 === 'string' ? arg1 : undefined;\n        const overrides = isConfigurationOverrides(arg1) ? arg1 : isConfigurationOverrides(arg2) ? arg2 : {};\n        return this._configuration.getValue(section, overrides, undefined);\n    }\n    updateValues(values) {\n        const previous = { data: this._configuration.toData() };\n        const changedKeys = [];\n        for (const entry of values) {\n            const [key, value] = entry;\n            if (this.getValue(key) === value) {\n                continue;\n            }\n            this._configuration.updateValue(key, value);\n            changedKeys.push(key);\n        }\n        if (changedKeys.length > 0) {\n            const configurationChangeEvent = new ConfigurationChangeEvent({ keys: changedKeys, overrides: [] }, previous, this._configuration);\n            configurationChangeEvent.source = 8 /* ConfigurationTarget.MEMORY */;\n            configurationChangeEvent.sourceConfig = null;\n            this._onDidChangeConfiguration.fire(configurationChangeEvent);\n        }\n        return Promise.resolve();\n    }\n    updateValue(key, value, arg3, arg4) {\n        return this.updateValues([[key, value]]);\n    }\n    inspect(key, options = {}) {\n        return this._configuration.inspect(key, options, undefined);\n    }\n}\nlet StandaloneResourceConfigurationService = class StandaloneResourceConfigurationService {\n    constructor(configurationService) {\n        this.configurationService = configurationService;\n        this._onDidChangeConfiguration = new Emitter();\n        this.configurationService.onDidChangeConfiguration((e) => {\n            this._onDidChangeConfiguration.fire({ affectedKeys: e.affectedKeys, affectsConfiguration: (resource, configuration) => e.affectsConfiguration(configuration) });\n        });\n    }\n    getValue(resource, arg2, arg3) {\n        const position = Pos.isIPosition(arg2) ? arg2 : null;\n        const section = position ? (typeof arg3 === 'string' ? arg3 : undefined) : (typeof arg2 === 'string' ? arg2 : undefined);\n        if (typeof section === 'undefined') {\n            return this.configurationService.getValue();\n        }\n        return this.configurationService.getValue(section);\n    }\n};\nStandaloneResourceConfigurationService = __decorate([\n    __param(0, IConfigurationService)\n], StandaloneResourceConfigurationService);\nlet StandaloneResourcePropertiesService = class StandaloneResourcePropertiesService {\n    constructor(configurationService) {\n        this.configurationService = configurationService;\n    }\n    getEOL(resource, language) {\n        const eol = this.configurationService.getValue('files.eol', { overrideIdentifier: language, resource });\n        if (eol && typeof eol === 'string' && eol !== 'auto') {\n            return eol;\n        }\n        return (isLinux || isMacintosh) ? '\\n' : '\\r\\n';\n    }\n};\nStandaloneResourcePropertiesService = __decorate([\n    __param(0, IConfigurationService)\n], StandaloneResourcePropertiesService);\nclass StandaloneTelemetryService {\n    publicLog(eventName, data) {\n        return Promise.resolve(undefined);\n    }\n    publicLog2(eventName, data) {\n        return this.publicLog(eventName, data);\n    }\n}\nclass StandaloneWorkspaceContextService {\n    constructor() {\n        const resource = URI.from({ scheme: StandaloneWorkspaceContextService.SCHEME, authority: 'model', path: '/' });\n        this.workspace = { id: '4064f6ec-cb38-4ad0-af64-ee6467e63c82', folders: [new WorkspaceFolder({ uri: resource, name: '', index: 0 })] };\n    }\n    getWorkspace() {\n        return this.workspace;\n    }\n    getWorkspaceFolder(resource) {\n        return resource && resource.scheme === StandaloneWorkspaceContextService.SCHEME ? this.workspace.folders[0] : null;\n    }\n}\nStandaloneWorkspaceContextService.SCHEME = 'inmemory';\nexport function updateConfigurationService(configurationService, source, isDiffEditor) {\n    if (!source) {\n        return;\n    }\n    if (!(configurationService instanceof StandaloneConfigurationService)) {\n        return;\n    }\n    const toUpdate = [];\n    Object.keys(source).forEach((key) => {\n        if (isEditorConfigurationKey(key)) {\n            toUpdate.push([`editor.${key}`, source[key]]);\n        }\n        if (isDiffEditor && isDiffEditorConfigurationKey(key)) {\n            toUpdate.push([`diffEditor.${key}`, source[key]]);\n        }\n    });\n    if (toUpdate.length > 0) {\n        configurationService.updateValues(toUpdate);\n    }\n}\nlet StandaloneBulkEditService = class StandaloneBulkEditService {\n    constructor(_modelService) {\n        this._modelService = _modelService;\n        //\n    }\n    hasPreviewHandler() {\n        return false;\n    }\n    apply(edits, _options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const textEdits = new Map();\n            for (const edit of edits) {\n                if (!(edit instanceof ResourceTextEdit)) {\n                    throw new Error('bad edit - only text edits are supported');\n                }\n                const model = this._modelService.getModel(edit.resource);\n                if (!model) {\n                    throw new Error('bad edit - model not found');\n                }\n                if (typeof edit.versionId === 'number' && model.getVersionId() !== edit.versionId) {\n                    throw new Error('bad state - model changed in the meantime');\n                }\n                let array = textEdits.get(model);\n                if (!array) {\n                    array = [];\n                    textEdits.set(model, array);\n                }\n                array.push(EditOperation.replaceMove(Range.lift(edit.textEdit.range), edit.textEdit.text));\n            }\n            let totalEdits = 0;\n            let totalFiles = 0;\n            for (const [model, edits] of textEdits) {\n                model.pushStackElement();\n                model.pushEditOperations([], edits, () => []);\n                model.pushStackElement();\n                totalFiles += 1;\n                totalEdits += edits.length;\n            }\n            return {\n                ariaSummary: strings.format(StandaloneServicesNLS.bulkEditServiceSummary, totalEdits, totalFiles)\n            };\n        });\n    }\n};\nStandaloneBulkEditService = __decorate([\n    __param(0, IModelService)\n], StandaloneBulkEditService);\nclass StandaloneUriLabelService {\n    getUriLabel(resource, options) {\n        if (resource.scheme === 'file') {\n            return resource.fsPath;\n        }\n        return resource.path;\n    }\n    getUriBasenameLabel(resource) {\n        return basename(resource);\n    }\n}\nlet StandaloneContextViewService = class StandaloneContextViewService extends ContextViewService {\n    constructor(layoutService, _codeEditorService) {\n        super(layoutService);\n        this._codeEditorService = _codeEditorService;\n    }\n    showContextView(delegate, container, shadowRoot) {\n        if (!container) {\n            const codeEditor = this._codeEditorService.getFocusedCodeEditor() || this._codeEditorService.getActiveCodeEditor();\n            if (codeEditor) {\n                container = codeEditor.getContainerDomNode();\n            }\n        }\n        return super.showContextView(delegate, container, shadowRoot);\n    }\n};\nStandaloneContextViewService = __decorate([\n    __param(0, ILayoutService),\n    __param(1, ICodeEditorService)\n], StandaloneContextViewService);\nclass StandaloneWorkspaceTrustManagementService {\n    constructor() {\n        this._neverEmitter = new Emitter();\n        this.onDidChangeTrust = this._neverEmitter.event;\n    }\n    isWorkspaceTrusted() {\n        return true;\n    }\n}\nclass StandaloneLanguageService extends LanguageService {\n    constructor() {\n        super();\n    }\n}\nclass StandaloneLogService extends LogService {\n    constructor() {\n        super(new ConsoleLogger());\n    }\n}\nlet StandaloneContextMenuService = class StandaloneContextMenuService extends ContextMenuService {\n    constructor(telemetryService, notificationService, contextViewService, keybindingService, themeService) {\n        super(telemetryService, notificationService, contextViewService, keybindingService, themeService);\n        this.configure({ blockMouse: false }); // we do not want that in the standalone editor\n    }\n};\nStandaloneContextMenuService = __decorate([\n    __param(0, ITelemetryService),\n    __param(1, INotificationService),\n    __param(2, IContextViewService),\n    __param(3, IKeybindingService),\n    __param(4, IThemeService)\n], StandaloneContextMenuService);\nregisterSingleton(IConfigurationService, StandaloneConfigurationService);\nregisterSingleton(ITextResourceConfigurationService, StandaloneResourceConfigurationService);\nregisterSingleton(ITextResourcePropertiesService, StandaloneResourcePropertiesService);\nregisterSingleton(IWorkspaceContextService, StandaloneWorkspaceContextService);\nregisterSingleton(ILabelService, StandaloneUriLabelService);\nregisterSingleton(ITelemetryService, StandaloneTelemetryService);\nregisterSingleton(IDialogService, StandaloneDialogService);\nregisterSingleton(INotificationService, StandaloneNotificationService);\nregisterSingleton(IMarkerService, MarkerService);\nregisterSingleton(ILanguageService, StandaloneLanguageService);\nregisterSingleton(IStandaloneThemeService, StandaloneThemeService);\nregisterSingleton(ILogService, StandaloneLogService);\nregisterSingleton(IModelService, ModelService);\nregisterSingleton(IMarkerDecorationsService, MarkerDecorationsService);\nregisterSingleton(IContextKeyService, ContextKeyService);\nregisterSingleton(IProgressService, StandaloneProgressService);\nregisterSingleton(IEditorProgressService, StandaloneEditorProgressService);\nregisterSingleton(IStorageService, InMemoryStorageService);\nregisterSingleton(IEditorWorkerService, EditorWorkerService);\nregisterSingleton(IBulkEditService, StandaloneBulkEditService);\nregisterSingleton(IWorkspaceTrustManagementService, StandaloneWorkspaceTrustManagementService);\nregisterSingleton(ITextModelService, StandaloneTextModelService);\nregisterSingleton(IAccessibilityService, AccessibilityService);\nregisterSingleton(IListService, ListService);\nregisterSingleton(ICommandService, StandaloneCommandService);\nregisterSingleton(IKeybindingService, StandaloneKeybindingService);\nregisterSingleton(IQuickInputService, StandaloneQuickInputService);\nregisterSingleton(IContextViewService, StandaloneContextViewService);\nregisterSingleton(IOpenerService, OpenerService);\nregisterSingleton(IClipboardService, BrowserClipboardService);\nregisterSingleton(IContextMenuService, StandaloneContextMenuService);\nregisterSingleton(IMenuService, MenuService);\n/**\n * We don't want to eagerly instantiate services because embedders get a one time chance\n * to override services when they create the first editor.\n */\nexport var StandaloneServices;\n(function (StandaloneServices) {\n    const serviceCollection = new ServiceCollection();\n    for (const [id, descriptor] of getSingletonServiceDescriptors()) {\n        serviceCollection.set(id, descriptor);\n    }\n    const instantiationService = new InstantiationService(serviceCollection, true);\n    serviceCollection.set(IInstantiationService, instantiationService);\n    function get(serviceId) {\n        const r = serviceCollection.get(serviceId);\n        if (!r) {\n            throw new Error('Missing service ' + serviceId);\n        }\n        if (r instanceof SyncDescriptor) {\n            return instantiationService.invokeFunction((accessor) => accessor.get(serviceId));\n        }\n        else {\n            return r;\n        }\n    }\n    StandaloneServices.get = get;\n    let initialized = false;\n    function initialize(overrides) {\n        if (initialized) {\n            return instantiationService;\n        }\n        initialized = true;\n        // Add singletons that were registered after this module loaded\n        for (const [id, descriptor] of getSingletonServiceDescriptors()) {\n            if (!serviceCollection.get(id)) {\n                serviceCollection.set(id, descriptor);\n            }\n        }\n        // Initialize the service collection with the overrides, but only if the\n        // service was not instantiated in the meantime.\n        for (const serviceId in overrides) {\n            if (overrides.hasOwnProperty(serviceId)) {\n                const serviceIdentifier = createDecorator(serviceId);\n                const r = serviceCollection.get(serviceIdentifier);\n                if (r instanceof SyncDescriptor) {\n                    serviceCollection.set(serviceIdentifier, overrides[serviceId]);\n                }\n            }\n        }\n        return instantiationService;\n    }\n    StandaloneServices.initialize = initialize;\n})(StandaloneServices || (StandaloneServices = {}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\nimport { Disposable, toDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { CodeEditorWidget } from '../../browser/widget/codeEditorWidget.js';\nimport { DiffEditorWidget } from '../../browser/widget/diffEditorWidget.js';\nimport { InternalEditorAction } from '../../common/editorAction.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorker.js';\nimport { StandaloneKeybindingService, updateConfigurationService } from './standaloneServices.js';\nimport { IStandaloneThemeService } from '../common/standaloneTheme.js';\nimport { MenuId, MenuRegistry } from '../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { StandaloneCodeEditorNLS } from '../../common/standaloneStrings.js';\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { StandaloneCodeEditorService } from './standaloneCodeEditorService.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../common/languages/modesRegistry.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\nlet LAST_GENERATED_COMMAND_ID = 0;\nlet ariaDomNodeCreated = false;\n/**\n * Create ARIA dom node inside parent,\n * or only for the first editor instantiation inside document.body.\n * @param parent container element for ARIA dom node\n */\nfunction createAriaDomNode(parent) {\n    if (!parent) {\n        if (ariaDomNodeCreated) {\n            return;\n        }\n        ariaDomNodeCreated = true;\n    }\n    aria.setARIAContainer(parent || document.body);\n}\n/**\n * A code editor to be used both by the standalone editor and the standalone diff editor.\n */\nlet StandaloneCodeEditor = class StandaloneCodeEditor extends CodeEditorWidget {\n    constructor(domElement, _options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService) {\n        const options = Object.assign({}, _options);\n        options.ariaLabel = options.ariaLabel || StandaloneCodeEditorNLS.editorViewAccessibleLabel;\n        options.ariaLabel = options.ariaLabel + ';' + (StandaloneCodeEditorNLS.accessibilityHelpMessage);\n        super(domElement, options, {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService);\n        if (keybindingService instanceof StandaloneKeybindingService) {\n            this._standaloneKeybindingService = keybindingService;\n        }\n        else {\n            this._standaloneKeybindingService = null;\n        }\n        createAriaDomNode(options.ariaContainerElement);\n    }\n    addCommand(keybinding, handler, context) {\n        if (!this._standaloneKeybindingService) {\n            console.warn('Cannot add command because the editor is configured with an unrecognized KeybindingService');\n            return null;\n        }\n        const commandId = 'DYNAMIC_' + (++LAST_GENERATED_COMMAND_ID);\n        const whenExpression = ContextKeyExpr.deserialize(context);\n        this._standaloneKeybindingService.addDynamicKeybinding(commandId, keybinding, handler, whenExpression);\n        return commandId;\n    }\n    createContextKey(key, defaultValue) {\n        return this._contextKeyService.createKey(key, defaultValue);\n    }\n    addAction(_descriptor) {\n        if ((typeof _descriptor.id !== 'string') || (typeof _descriptor.label !== 'string') || (typeof _descriptor.run !== 'function')) {\n            throw new Error('Invalid action descriptor, `id`, `label` and `run` are required properties!');\n        }\n        if (!this._standaloneKeybindingService) {\n            console.warn('Cannot add keybinding because the editor is configured with an unrecognized KeybindingService');\n            return Disposable.None;\n        }\n        // Read descriptor options\n        const id = _descriptor.id;\n        const label = _descriptor.label;\n        const precondition = ContextKeyExpr.and(ContextKeyExpr.equals('editorId', this.getId()), ContextKeyExpr.deserialize(_descriptor.precondition));\n        const keybindings = _descriptor.keybindings;\n        const keybindingsWhen = ContextKeyExpr.and(precondition, ContextKeyExpr.deserialize(_descriptor.keybindingContext));\n        const contextMenuGroupId = _descriptor.contextMenuGroupId || null;\n        const contextMenuOrder = _descriptor.contextMenuOrder || 0;\n        const run = (accessor, ...args) => {\n            return Promise.resolve(_descriptor.run(this, ...args));\n        };\n        const toDispose = new DisposableStore();\n        // Generate a unique id to allow the same descriptor.id across multiple editor instances\n        const uniqueId = this.getId() + ':' + id;\n        // Register the command\n        toDispose.add(CommandsRegistry.registerCommand(uniqueId, run));\n        // Register the context menu item\n        if (contextMenuGroupId) {\n            const menuItem = {\n                command: {\n                    id: uniqueId,\n                    title: label\n                },\n                when: precondition,\n                group: contextMenuGroupId,\n                order: contextMenuOrder\n            };\n            toDispose.add(MenuRegistry.appendMenuItem(MenuId.EditorContext, menuItem));\n        }\n        // Register the keybindings\n        if (Array.isArray(keybindings)) {\n            for (const kb of keybindings) {\n                toDispose.add(this._standaloneKeybindingService.addDynamicKeybinding(uniqueId, kb, run, keybindingsWhen));\n            }\n        }\n        // Finally, register an internal editor action\n        const internalAction = new InternalEditorAction(uniqueId, label, label, precondition, run, this._contextKeyService);\n        // Store it under the original id, such that trigger with the original id will work\n        this._actions[id] = internalAction;\n        toDispose.add(toDisposable(() => {\n            delete this._actions[id];\n        }));\n        return toDispose;\n    }\n    _triggerCommand(handlerId, payload) {\n        if (this._codeEditorService instanceof StandaloneCodeEditorService) {\n            // Help commands find this editor as the active editor\n            try {\n                this._codeEditorService.setActiveCodeEditor(this);\n                super._triggerCommand(handlerId, payload);\n            }\n            finally {\n                this._codeEditorService.setActiveCodeEditor(null);\n            }\n        }\n        else {\n            super._triggerCommand(handlerId, payload);\n        }\n    }\n};\nStandaloneCodeEditor = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, ICodeEditorService),\n    __param(4, ICommandService),\n    __param(5, IContextKeyService),\n    __param(6, IKeybindingService),\n    __param(7, IThemeService),\n    __param(8, INotificationService),\n    __param(9, IAccessibilityService),\n    __param(10, ILanguageConfigurationService),\n    __param(11, ILanguageFeaturesService)\n], StandaloneCodeEditor);\nexport { StandaloneCodeEditor };\nlet StandaloneEditor = class StandaloneEditor extends StandaloneCodeEditor {\n    constructor(domElement, _options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, configurationService, accessibilityService, modelService, languageService, languageConfigurationService, languageFeaturesService) {\n        const options = Object.assign({}, _options);\n        updateConfigurationService(configurationService, options, false);\n        const themeDomRegistration = themeService.registerEditorContainer(domElement);\n        if (typeof options.theme === 'string') {\n            themeService.setTheme(options.theme);\n        }\n        if (typeof options.autoDetectHighContrast !== 'undefined') {\n            themeService.setAutoDetectHighContrast(Boolean(options.autoDetectHighContrast));\n        }\n        const _model = options.model;\n        delete options.model;\n        super(domElement, options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService);\n        this._configurationService = configurationService;\n        this._standaloneThemeService = themeService;\n        this._register(themeDomRegistration);\n        let model;\n        if (typeof _model === 'undefined') {\n            const languageId = languageService.getLanguageIdByMimeType(options.language) || options.language || PLAINTEXT_LANGUAGE_ID;\n            model = createTextModel(modelService, languageService, options.value || '', languageId, undefined);\n            this._ownsModel = true;\n        }\n        else {\n            model = _model;\n            this._ownsModel = false;\n        }\n        this._attachModel(model);\n        if (model) {\n            const e = {\n                oldModelUrl: null,\n                newModelUrl: model.uri\n            };\n            this._onDidChangeModel.fire(e);\n        }\n    }\n    dispose() {\n        super.dispose();\n    }\n    updateOptions(newOptions) {\n        updateConfigurationService(this._configurationService, newOptions, false);\n        if (typeof newOptions.theme === 'string') {\n            this._standaloneThemeService.setTheme(newOptions.theme);\n        }\n        if (typeof newOptions.autoDetectHighContrast !== 'undefined') {\n            this._standaloneThemeService.setAutoDetectHighContrast(Boolean(newOptions.autoDetectHighContrast));\n        }\n        super.updateOptions(newOptions);\n    }\n    _postDetachModelCleanup(detachedModel) {\n        super._postDetachModelCleanup(detachedModel);\n        if (detachedModel && this._ownsModel) {\n            detachedModel.dispose();\n            this._ownsModel = false;\n        }\n    }\n};\nStandaloneEditor = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, ICodeEditorService),\n    __param(4, ICommandService),\n    __param(5, IContextKeyService),\n    __param(6, IKeybindingService),\n    __param(7, IStandaloneThemeService),\n    __param(8, INotificationService),\n    __param(9, IConfigurationService),\n    __param(10, IAccessibilityService),\n    __param(11, IModelService),\n    __param(12, ILanguageService),\n    __param(13, ILanguageConfigurationService),\n    __param(14, ILanguageFeaturesService)\n], StandaloneEditor);\nexport { StandaloneEditor };\nlet StandaloneDiffEditor = class StandaloneDiffEditor extends DiffEditorWidget {\n    constructor(domElement, _options, instantiationService, contextKeyService, editorWorkerService, codeEditorService, themeService, notificationService, configurationService, contextMenuService, editorProgressService, clipboardService) {\n        const options = Object.assign({}, _options);\n        updateConfigurationService(configurationService, options, true);\n        const themeDomRegistration = themeService.registerEditorContainer(domElement);\n        if (typeof options.theme === 'string') {\n            themeService.setTheme(options.theme);\n        }\n        if (typeof options.autoDetectHighContrast !== 'undefined') {\n            themeService.setAutoDetectHighContrast(Boolean(options.autoDetectHighContrast));\n        }\n        super(domElement, options, {}, clipboardService, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService, contextMenuService, editorProgressService);\n        this._configurationService = configurationService;\n        this._standaloneThemeService = themeService;\n        this._register(themeDomRegistration);\n    }\n    dispose() {\n        super.dispose();\n    }\n    updateOptions(newOptions) {\n        updateConfigurationService(this._configurationService, newOptions, true);\n        if (typeof newOptions.theme === 'string') {\n            this._standaloneThemeService.setTheme(newOptions.theme);\n        }\n        if (typeof newOptions.autoDetectHighContrast !== 'undefined') {\n            this._standaloneThemeService.setAutoDetectHighContrast(Boolean(newOptions.autoDetectHighContrast));\n        }\n        super.updateOptions(newOptions);\n    }\n    _createInnerEditor(instantiationService, container, options) {\n        return instantiationService.createInstance(StandaloneCodeEditor, container, options);\n    }\n    getOriginalEditor() {\n        return super.getOriginalEditor();\n    }\n    getModifiedEditor() {\n        return super.getModifiedEditor();\n    }\n    addCommand(keybinding, handler, context) {\n        return this.getModifiedEditor().addCommand(keybinding, handler, context);\n    }\n    createContextKey(key, defaultValue) {\n        return this.getModifiedEditor().createContextKey(key, defaultValue);\n    }\n    addAction(descriptor) {\n        return this.getModifiedEditor().addAction(descriptor);\n    }\n};\nStandaloneDiffEditor = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, IContextKeyService),\n    __param(4, IEditorWorkerService),\n    __param(5, ICodeEditorService),\n    __param(6, IStandaloneThemeService),\n    __param(7, INotificationService),\n    __param(8, IConfigurationService),\n    __param(9, IContextMenuService),\n    __param(10, IEditorProgressService),\n    __param(11, IClipboardService)\n], StandaloneDiffEditor);\nexport { StandaloneDiffEditor };\n/**\n * @internal\n */\nexport function createTextModel(modelService, languageService, value, languageId, uri) {\n    value = value || '';\n    if (!languageId) {\n        const firstLF = value.indexOf('\\n');\n        let firstLine = value;\n        if (firstLF !== -1) {\n            firstLine = value.substring(0, firstLF);\n        }\n        return doCreateModel(modelService, value, languageService.createByFilepathOrFirstLine(uri || null, firstLine), uri);\n    }\n    return doCreateModel(modelService, value, languageService.createById(languageId), uri);\n}\n/**\n * @internal\n */\nfunction doCreateModel(modelService, value, languageSelection, uri) {\n    return modelService.createModel(value, languageSelection, uri);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './standalone-tokens.css';\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { splitLines } from '../../../base/common/strings.js';\nimport { FontMeasurements } from '../../browser/config/fontMeasurements.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { DiffNavigator } from '../../browser/widget/diffNavigator.js';\nimport { ApplyUpdateResult, ConfigurationChangedEvent, EditorOptions } from '../../common/config/editorOptions.js';\nimport { BareFontInfo, FontInfo } from '../../common/config/fontInfo.js';\nimport { EditorType } from '../../common/editorCommon.js';\nimport { FindMatch, TextModelResolvedOptions } from '../../common/model.js';\nimport * as languages from '../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { NullState, nullTokenize } from '../../common/languages/nullTokenize.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { createWebWorker as actualCreateWebWorker } from '../../browser/services/webWorker.js';\nimport * as standaloneEnums from '../../common/standalone/standaloneEnums.js';\nimport { Colorizer } from './colorizer.js';\nimport { createTextModel, StandaloneDiffEditor, StandaloneEditor } from './standaloneCodeEditor.js';\nimport { StandaloneKeybindingService, StandaloneServices } from './standaloneServices.js';\nimport { IStandaloneThemeService } from '../common/standaloneTheme.js';\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { EditorCommand } from '../../browser/editorExtensions.js';\nimport { MenuRegistry, MenuId } from '../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\n/**\n * Create a new editor under `domElement`.\n * `domElement` should be empty (not contain other dom nodes).\n * The editor will read the size of `domElement`.\n */\nexport function create(domElement, options, override) {\n    const instantiationService = StandaloneServices.initialize(override || {});\n    return instantiationService.createInstance(StandaloneEditor, domElement, options);\n}\n/**\n * Emitted when an editor is created.\n * Creating a diff editor might cause this listener to be invoked with the two editors.\n * @event\n */\nexport function onDidCreateEditor(listener) {\n    const codeEditorService = StandaloneServices.get(ICodeEditorService);\n    return codeEditorService.onCodeEditorAdd((editor) => {\n        listener(editor);\n    });\n}\n/**\n * Emitted when an diff editor is created.\n * @event\n */\nexport function onDidCreateDiffEditor(listener) {\n    const codeEditorService = StandaloneServices.get(ICodeEditorService);\n    return codeEditorService.onDiffEditorAdd((editor) => {\n        listener(editor);\n    });\n}\n/**\n * Get all the created editors.\n */\nexport function getEditors() {\n    const codeEditorService = StandaloneServices.get(ICodeEditorService);\n    return codeEditorService.listCodeEditors();\n}\n/**\n * Get all the created diff editors.\n */\nexport function getDiffEditors() {\n    const codeEditorService = StandaloneServices.get(ICodeEditorService);\n    return codeEditorService.listDiffEditors();\n}\n/**\n * Create a new diff editor under `domElement`.\n * `domElement` should be empty (not contain other dom nodes).\n * The editor will read the size of `domElement`.\n */\nexport function createDiffEditor(domElement, options, override) {\n    const instantiationService = StandaloneServices.initialize(override || {});\n    return instantiationService.createInstance(StandaloneDiffEditor, domElement, options);\n}\nexport function createDiffNavigator(diffEditor, opts) {\n    return new DiffNavigator(diffEditor, opts);\n}\n/**\n * Add a command.\n */\nexport function addCommand(descriptor) {\n    if ((typeof descriptor.id !== 'string') || (typeof descriptor.run !== 'function')) {\n        throw new Error('Invalid command descriptor, `id` and `run` are required properties!');\n    }\n    return CommandsRegistry.registerCommand(descriptor.id, descriptor.run);\n}\n/**\n * Add an action to all editors.\n */\nexport function addEditorAction(descriptor) {\n    if ((typeof descriptor.id !== 'string') || (typeof descriptor.label !== 'string') || (typeof descriptor.run !== 'function')) {\n        throw new Error('Invalid action descriptor, `id`, `label` and `run` are required properties!');\n    }\n    const precondition = ContextKeyExpr.deserialize(descriptor.precondition);\n    const run = (accessor, ...args) => {\n        return EditorCommand.runEditorCommand(accessor, args, precondition, (accessor, editor, args) => Promise.resolve(descriptor.run(editor, ...args)));\n    };\n    const toDispose = new DisposableStore();\n    // Register the command\n    toDispose.add(CommandsRegistry.registerCommand(descriptor.id, run));\n    // Register the context menu item\n    if (descriptor.contextMenuGroupId) {\n        const menuItem = {\n            command: {\n                id: descriptor.id,\n                title: descriptor.label\n            },\n            when: precondition,\n            group: descriptor.contextMenuGroupId,\n            order: descriptor.contextMenuOrder || 0\n        };\n        toDispose.add(MenuRegistry.appendMenuItem(MenuId.EditorContext, menuItem));\n    }\n    // Register the keybindings\n    if (Array.isArray(descriptor.keybindings)) {\n        const keybindingService = StandaloneServices.get(IKeybindingService);\n        if (!(keybindingService instanceof StandaloneKeybindingService)) {\n            console.warn('Cannot add keybinding because the editor is configured with an unrecognized KeybindingService');\n        }\n        else {\n            const keybindingsWhen = ContextKeyExpr.and(precondition, ContextKeyExpr.deserialize(descriptor.keybindingContext));\n            toDispose.add(keybindingService.addDynamicKeybindings(descriptor.keybindings.map((keybinding) => {\n                return {\n                    keybinding,\n                    command: descriptor.id,\n                    when: keybindingsWhen\n                };\n            })));\n        }\n    }\n    return toDispose;\n}\n/**\n * Add a keybinding rule.\n */\nexport function addKeybindingRule(rule) {\n    return addKeybindingRules([rule]);\n}\n/**\n * Add keybinding rules.\n */\nexport function addKeybindingRules(rules) {\n    const keybindingService = StandaloneServices.get(IKeybindingService);\n    if (!(keybindingService instanceof StandaloneKeybindingService)) {\n        console.warn('Cannot add keybinding because the editor is configured with an unrecognized KeybindingService');\n        return Disposable.None;\n    }\n    return keybindingService.addDynamicKeybindings(rules.map((rule) => {\n        return {\n            keybinding: rule.keybinding,\n            command: rule.command,\n            commandArgs: rule.commandArgs,\n            when: ContextKeyExpr.deserialize(rule.when),\n        };\n    }));\n}\n/**\n * Create a new editor model.\n * You can specify the language that should be set for this model or let the language be inferred from the `uri`.\n */\nexport function createModel(value, language, uri) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    const languageId = languageService.getLanguageIdByMimeType(language) || language;\n    return createTextModel(StandaloneServices.get(IModelService), languageService, value, languageId, uri);\n}\n/**\n * Change the language for a model.\n */\nexport function setModelLanguage(model, languageId) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    const modelService = StandaloneServices.get(IModelService);\n    modelService.setMode(model, languageService.createById(languageId));\n}\n/**\n * Set the markers for a model.\n */\nexport function setModelMarkers(model, owner, markers) {\n    if (model) {\n        const markerService = StandaloneServices.get(IMarkerService);\n        markerService.changeOne(owner, model.uri, markers);\n    }\n}\n/**\n * Remove all markers of an owner.\n */\nexport function removeAllMarkers(owner) {\n    const markerService = StandaloneServices.get(IMarkerService);\n    markerService.changeAll(owner, []);\n}\n/**\n * Get markers for owner and/or resource\n *\n * @returns list of markers\n */\nexport function getModelMarkers(filter) {\n    const markerService = StandaloneServices.get(IMarkerService);\n    return markerService.read(filter);\n}\n/**\n * Emitted when markers change for a model.\n * @event\n */\nexport function onDidChangeMarkers(listener) {\n    const markerService = StandaloneServices.get(IMarkerService);\n    return markerService.onMarkerChanged(listener);\n}\n/**\n * Get the model that has `uri` if it exists.\n */\nexport function getModel(uri) {\n    const modelService = StandaloneServices.get(IModelService);\n    return modelService.getModel(uri);\n}\n/**\n * Get all the created models.\n */\nexport function getModels() {\n    const modelService = StandaloneServices.get(IModelService);\n    return modelService.getModels();\n}\n/**\n * Emitted when a model is created.\n * @event\n */\nexport function onDidCreateModel(listener) {\n    const modelService = StandaloneServices.get(IModelService);\n    return modelService.onModelAdded(listener);\n}\n/**\n * Emitted right before a model is disposed.\n * @event\n */\nexport function onWillDisposeModel(listener) {\n    const modelService = StandaloneServices.get(IModelService);\n    return modelService.onModelRemoved(listener);\n}\n/**\n * Emitted when a different language is set to a model.\n * @event\n */\nexport function onDidChangeModelLanguage(listener) {\n    const modelService = StandaloneServices.get(IModelService);\n    return modelService.onModelLanguageChanged((e) => {\n        listener({\n            model: e.model,\n            oldLanguage: e.oldLanguageId\n        });\n    });\n}\n/**\n * Create a new web worker that has model syncing capabilities built in.\n * Specify an AMD module to load that will `create` an object that will be proxied.\n */\nexport function createWebWorker(opts) {\n    return actualCreateWebWorker(StandaloneServices.get(IModelService), StandaloneServices.get(ILanguageConfigurationService), opts);\n}\n/**\n * Colorize the contents of `domNode` using attribute `data-lang`.\n */\nexport function colorizeElement(domNode, options) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    const themeService = StandaloneServices.get(IStandaloneThemeService);\n    themeService.registerEditorContainer(domNode);\n    return Colorizer.colorizeElement(themeService, languageService, domNode, options);\n}\n/**\n * Colorize `text` using language `languageId`.\n */\nexport function colorize(text, languageId, options) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    const themeService = StandaloneServices.get(IStandaloneThemeService);\n    themeService.registerEditorContainer(document.body);\n    return Colorizer.colorize(languageService, text, languageId, options);\n}\n/**\n * Colorize a line in a model.\n */\nexport function colorizeModelLine(model, lineNumber, tabSize = 4) {\n    const themeService = StandaloneServices.get(IStandaloneThemeService);\n    themeService.registerEditorContainer(document.body);\n    return Colorizer.colorizeModelLine(model, lineNumber, tabSize);\n}\n/**\n * @internal\n */\nfunction getSafeTokenizationSupport(language) {\n    const tokenizationSupport = languages.TokenizationRegistry.get(language);\n    if (tokenizationSupport) {\n        return tokenizationSupport;\n    }\n    return {\n        getInitialState: () => NullState,\n        tokenize: (line, hasEOL, state) => nullTokenize(language, state)\n    };\n}\n/**\n * Tokenize `text` using language `languageId`\n */\nexport function tokenize(text, languageId) {\n    // Needed in order to get the mode registered for subsequent look-ups\n    languages.TokenizationRegistry.getOrCreate(languageId);\n    const tokenizationSupport = getSafeTokenizationSupport(languageId);\n    const lines = splitLines(text);\n    const result = [];\n    let state = tokenizationSupport.getInitialState();\n    for (let i = 0, len = lines.length; i < len; i++) {\n        const line = lines[i];\n        const tokenizationResult = tokenizationSupport.tokenize(line, true, state);\n        result[i] = tokenizationResult.tokens;\n        state = tokenizationResult.endState;\n    }\n    return result;\n}\n/**\n * Define a new theme or update an existing theme.\n */\nexport function defineTheme(themeName, themeData) {\n    const standaloneThemeService = StandaloneServices.get(IStandaloneThemeService);\n    standaloneThemeService.defineTheme(themeName, themeData);\n}\n/**\n * Switches to a theme.\n */\nexport function setTheme(themeName) {\n    const standaloneThemeService = StandaloneServices.get(IStandaloneThemeService);\n    standaloneThemeService.setTheme(themeName);\n}\n/**\n * Clears all cached font measurements and triggers re-measurement.\n */\nexport function remeasureFonts() {\n    FontMeasurements.clearAllFontInfos();\n}\n/**\n * Register a command.\n */\nexport function registerCommand(id, handler) {\n    return CommandsRegistry.registerCommand({ id, handler });\n}\n/**\n * @internal\n */\nexport function createMonacoEditorAPI() {\n    return {\n        // methods\n        create: create,\n        getEditors: getEditors,\n        getDiffEditors: getDiffEditors,\n        onDidCreateEditor: onDidCreateEditor,\n        onDidCreateDiffEditor: onDidCreateDiffEditor,\n        createDiffEditor: createDiffEditor,\n        createDiffNavigator: createDiffNavigator,\n        addCommand: addCommand,\n        addEditorAction: addEditorAction,\n        addKeybindingRule: addKeybindingRule,\n        addKeybindingRules: addKeybindingRules,\n        createModel: createModel,\n        setModelLanguage: setModelLanguage,\n        setModelMarkers: setModelMarkers,\n        getModelMarkers: getModelMarkers,\n        removeAllMarkers: removeAllMarkers,\n        onDidChangeMarkers: onDidChangeMarkers,\n        getModels: getModels,\n        getModel: getModel,\n        onDidCreateModel: onDidCreateModel,\n        onWillDisposeModel: onWillDisposeModel,\n        onDidChangeModelLanguage: onDidChangeModelLanguage,\n        createWebWorker: createWebWorker,\n        colorizeElement: colorizeElement,\n        colorize: colorize,\n        colorizeModelLine: colorizeModelLine,\n        tokenize: tokenize,\n        defineTheme: defineTheme,\n        setTheme: setTheme,\n        remeasureFonts: remeasureFonts,\n        registerCommand: registerCommand,\n        // enums\n        AccessibilitySupport: standaloneEnums.AccessibilitySupport,\n        ContentWidgetPositionPreference: standaloneEnums.ContentWidgetPositionPreference,\n        CursorChangeReason: standaloneEnums.CursorChangeReason,\n        DefaultEndOfLine: standaloneEnums.DefaultEndOfLine,\n        EditorAutoIndentStrategy: standaloneEnums.EditorAutoIndentStrategy,\n        EditorOption: standaloneEnums.EditorOption,\n        EndOfLinePreference: standaloneEnums.EndOfLinePreference,\n        EndOfLineSequence: standaloneEnums.EndOfLineSequence,\n        MinimapPosition: standaloneEnums.MinimapPosition,\n        MouseTargetType: standaloneEnums.MouseTargetType,\n        OverlayWidgetPositionPreference: standaloneEnums.OverlayWidgetPositionPreference,\n        OverviewRulerLane: standaloneEnums.OverviewRulerLane,\n        RenderLineNumbersType: standaloneEnums.RenderLineNumbersType,\n        RenderMinimap: standaloneEnums.RenderMinimap,\n        ScrollbarVisibility: standaloneEnums.ScrollbarVisibility,\n        ScrollType: standaloneEnums.ScrollType,\n        TextEditorCursorBlinkingStyle: standaloneEnums.TextEditorCursorBlinkingStyle,\n        TextEditorCursorStyle: standaloneEnums.TextEditorCursorStyle,\n        TrackedRangeStickiness: standaloneEnums.TrackedRangeStickiness,\n        WrappingIndent: standaloneEnums.WrappingIndent,\n        InjectedTextCursorStops: standaloneEnums.InjectedTextCursorStops,\n        PositionAffinity: standaloneEnums.PositionAffinity,\n        // classes\n        ConfigurationChangedEvent: ConfigurationChangedEvent,\n        BareFontInfo: BareFontInfo,\n        FontInfo: FontInfo,\n        TextModelResolvedOptions: TextModelResolvedOptions,\n        FindMatch: FindMatch,\n        ApplyUpdateResult: ApplyUpdateResult,\n        // vars\n        EditorType: EditorType,\n        EditorOptions: EditorOptions\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n/*\n * This module only exports 'compile' which compiles a JSON language definition\n * into a typed and checked ILexer definition.\n */\nimport * as monarchCommon from './monarchCommon.js';\n/*\n * Type helpers\n *\n * Note: this is just for sanity checks on the JSON description which is\n * helpful for the programmer. No checks are done anymore once the lexer is\n * already 'compiled and checked'.\n *\n */\nfunction isArrayOf(elemType, obj) {\n    if (!obj) {\n        return false;\n    }\n    if (!(Array.isArray(obj))) {\n        return false;\n    }\n    for (const el of obj) {\n        if (!(elemType(el))) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction bool(prop, defValue) {\n    if (typeof prop === 'boolean') {\n        return prop;\n    }\n    return defValue;\n}\nfunction string(prop, defValue) {\n    if (typeof (prop) === 'string') {\n        return prop;\n    }\n    return defValue;\n}\nfunction arrayToHash(array) {\n    const result = {};\n    for (const e of array) {\n        result[e] = true;\n    }\n    return result;\n}\nfunction createKeywordMatcher(arr, caseInsensitive = false) {\n    if (caseInsensitive) {\n        arr = arr.map(function (x) { return x.toLowerCase(); });\n    }\n    const hash = arrayToHash(arr);\n    if (caseInsensitive) {\n        return function (word) {\n            return hash[word.toLowerCase()] !== undefined && hash.hasOwnProperty(word.toLowerCase());\n        };\n    }\n    else {\n        return function (word) {\n            return hash[word] !== undefined && hash.hasOwnProperty(word);\n        };\n    }\n}\n// Lexer helpers\n/**\n * Compiles a regular expression string, adding the 'i' flag if 'ignoreCase' is set, and the 'u' flag if 'unicode' is set.\n * Also replaces @\\w+ or sequences with the content of the specified attribute\n * @\\w+ replacement can be avoided by escaping `@` signs with another `@` sign.\n * @example /@attr/ will be replaced with the value of lexer[attr]\n * @example /@@text/ will not be replaced and will become /@text/.\n */\nfunction compileRegExp(lexer, str) {\n    // @@ must be interpreted as a literal @, so we replace all occurences of @@ with a placeholder character\n    str = str.replace(/@@/g, `\\x01`);\n    let n = 0;\n    let hadExpansion;\n    do {\n        hadExpansion = false;\n        str = str.replace(/@(\\w+)/g, function (s, attr) {\n            hadExpansion = true;\n            let sub = '';\n            if (typeof (lexer[attr]) === 'string') {\n                sub = lexer[attr];\n            }\n            else if (lexer[attr] && lexer[attr] instanceof RegExp) {\n                sub = lexer[attr].source;\n            }\n            else {\n                if (lexer[attr] === undefined) {\n                    throw monarchCommon.createError(lexer, 'language definition does not contain attribute \\'' + attr + '\\', used at: ' + str);\n                }\n                else {\n                    throw monarchCommon.createError(lexer, 'attribute reference \\'' + attr + '\\' must be a string, used at: ' + str);\n                }\n            }\n            return (monarchCommon.empty(sub) ? '' : '(?:' + sub + ')');\n        });\n        n++;\n    } while (hadExpansion && n < 5);\n    // handle escaped @@\n    str = str.replace(/\\x01/g, '@');\n    const flags = (lexer.ignoreCase ? 'i' : '') + (lexer.unicode ? 'u' : '');\n    return new RegExp(str, flags);\n}\n/**\n * Compiles guard functions for case matches.\n * This compiles 'cases' attributes into efficient match functions.\n *\n */\nfunction selectScrutinee(id, matches, state, num) {\n    if (num < 0) {\n        return id;\n    }\n    if (num < matches.length) {\n        return matches[num];\n    }\n    if (num >= 100) {\n        num = num - 100;\n        const parts = state.split('.');\n        parts.unshift(state);\n        if (num < parts.length) {\n            return parts[num];\n        }\n    }\n    return null;\n}\nfunction createGuard(lexer, ruleName, tkey, val) {\n    // get the scrutinee and pattern\n    let scrut = -1; // -1: $!, 0-99: $n, 100+n: $Sn\n    let oppat = tkey;\n    let matches = tkey.match(/^\\$(([sS]?)(\\d\\d?)|#)(.*)$/);\n    if (matches) {\n        if (matches[3]) { // if digits\n            scrut = parseInt(matches[3]);\n            if (matches[2]) {\n                scrut = scrut + 100; // if [sS] present\n            }\n        }\n        oppat = matches[4];\n    }\n    // get operator\n    let op = '~';\n    let pat = oppat;\n    if (!oppat || oppat.length === 0) {\n        op = '!=';\n        pat = '';\n    }\n    else if (/^\\w*$/.test(pat)) { // just a word\n        op = '==';\n    }\n    else {\n        matches = oppat.match(/^(@|!@|~|!~|==|!=)(.*)$/);\n        if (matches) {\n            op = matches[1];\n            pat = matches[2];\n        }\n    }\n    // set the tester function\n    let tester;\n    // special case a regexp that matches just words\n    if ((op === '~' || op === '!~') && /^(\\w|\\|)*$/.test(pat)) {\n        const inWords = createKeywordMatcher(pat.split('|'), lexer.ignoreCase);\n        tester = function (s) { return (op === '~' ? inWords(s) : !inWords(s)); };\n    }\n    else if (op === '@' || op === '!@') {\n        const words = lexer[pat];\n        if (!words) {\n            throw monarchCommon.createError(lexer, 'the @ match target \\'' + pat + '\\' is not defined, in rule: ' + ruleName);\n        }\n        if (!(isArrayOf(function (elem) { return (typeof (elem) === 'string'); }, words))) {\n            throw monarchCommon.createError(lexer, 'the @ match target \\'' + pat + '\\' must be an array of strings, in rule: ' + ruleName);\n        }\n        const inWords = createKeywordMatcher(words, lexer.ignoreCase);\n        tester = function (s) { return (op === '@' ? inWords(s) : !inWords(s)); };\n    }\n    else if (op === '~' || op === '!~') {\n        if (pat.indexOf('$') < 0) {\n            // precompile regular expression\n            const re = compileRegExp(lexer, '^' + pat + '$');\n            tester = function (s) { return (op === '~' ? re.test(s) : !re.test(s)); };\n        }\n        else {\n            tester = function (s, id, matches, state) {\n                const re = compileRegExp(lexer, '^' + monarchCommon.substituteMatches(lexer, pat, id, matches, state) + '$');\n                return re.test(s);\n            };\n        }\n    }\n    else { // if (op==='==' || op==='!=') {\n        if (pat.indexOf('$') < 0) {\n            const patx = monarchCommon.fixCase(lexer, pat);\n            tester = function (s) { return (op === '==' ? s === patx : s !== patx); };\n        }\n        else {\n            const patx = monarchCommon.fixCase(lexer, pat);\n            tester = function (s, id, matches, state, eos) {\n                const patexp = monarchCommon.substituteMatches(lexer, patx, id, matches, state);\n                return (op === '==' ? s === patexp : s !== patexp);\n            };\n        }\n    }\n    // return the branch object\n    if (scrut === -1) {\n        return {\n            name: tkey, value: val, test: function (id, matches, state, eos) {\n                return tester(id, id, matches, state, eos);\n            }\n        };\n    }\n    else {\n        return {\n            name: tkey, value: val, test: function (id, matches, state, eos) {\n                const scrutinee = selectScrutinee(id, matches, state, scrut);\n                return tester(!scrutinee ? '' : scrutinee, id, matches, state, eos);\n            }\n        };\n    }\n}\n/**\n * Compiles an action: i.e. optimize regular expressions and case matches\n * and do many sanity checks.\n *\n * This is called only during compilation but if the lexer definition\n * contains user functions as actions (which is usually not allowed), then this\n * may be called during lexing. It is important therefore to compile common cases efficiently\n */\nfunction compileAction(lexer, ruleName, action) {\n    if (!action) {\n        return { token: '' };\n    }\n    else if (typeof (action) === 'string') {\n        return action; // { token: action };\n    }\n    else if (action.token || action.token === '') {\n        if (typeof (action.token) !== 'string') {\n            throw monarchCommon.createError(lexer, 'a \\'token\\' attribute must be of type string, in rule: ' + ruleName);\n        }\n        else {\n            // only copy specific typed fields (only happens once during compile Lexer)\n            const newAction = { token: action.token };\n            if (action.token.indexOf('$') >= 0) {\n                newAction.tokenSubst = true;\n            }\n            if (typeof (action.bracket) === 'string') {\n                if (action.bracket === '@open') {\n                    newAction.bracket = 1 /* monarchCommon.MonarchBracket.Open */;\n                }\n                else if (action.bracket === '@close') {\n                    newAction.bracket = -1 /* monarchCommon.MonarchBracket.Close */;\n                }\n                else {\n                    throw monarchCommon.createError(lexer, 'a \\'bracket\\' attribute must be either \\'@open\\' or \\'@close\\', in rule: ' + ruleName);\n                }\n            }\n            if (action.next) {\n                if (typeof (action.next) !== 'string') {\n                    throw monarchCommon.createError(lexer, 'the next state must be a string value in rule: ' + ruleName);\n                }\n                else {\n                    let next = action.next;\n                    if (!/^(@pop|@push|@popall)$/.test(next)) {\n                        if (next[0] === '@') {\n                            next = next.substr(1); // peel off starting @ sign\n                        }\n                        if (next.indexOf('$') < 0) { // no dollar substitution, we can check if the state exists\n                            if (!monarchCommon.stateExists(lexer, monarchCommon.substituteMatches(lexer, next, '', [], ''))) {\n                                throw monarchCommon.createError(lexer, 'the next state \\'' + action.next + '\\' is not defined in rule: ' + ruleName);\n                            }\n                        }\n                    }\n                    newAction.next = next;\n                }\n            }\n            if (typeof (action.goBack) === 'number') {\n                newAction.goBack = action.goBack;\n            }\n            if (typeof (action.switchTo) === 'string') {\n                newAction.switchTo = action.switchTo;\n            }\n            if (typeof (action.log) === 'string') {\n                newAction.log = action.log;\n            }\n            if (typeof (action.nextEmbedded) === 'string') {\n                newAction.nextEmbedded = action.nextEmbedded;\n                lexer.usesEmbedded = true;\n            }\n            return newAction;\n        }\n    }\n    else if (Array.isArray(action)) {\n        const results = [];\n        for (let i = 0, len = action.length; i < len; i++) {\n            results[i] = compileAction(lexer, ruleName, action[i]);\n        }\n        return { group: results };\n    }\n    else if (action.cases) {\n        // build an array of test cases\n        const cases = [];\n        // for each case, push a test function and result value\n        for (const tkey in action.cases) {\n            if (action.cases.hasOwnProperty(tkey)) {\n                const val = compileAction(lexer, ruleName, action.cases[tkey]);\n                // what kind of case\n                if (tkey === '@default' || tkey === '@' || tkey === '') {\n                    cases.push({ test: undefined, value: val, name: tkey });\n                }\n                else if (tkey === '@eos') {\n                    cases.push({ test: function (id, matches, state, eos) { return eos; }, value: val, name: tkey });\n                }\n                else {\n                    cases.push(createGuard(lexer, ruleName, tkey, val)); // call separate function to avoid local variable capture\n                }\n            }\n        }\n        // create a matching function\n        const def = lexer.defaultToken;\n        return {\n            test: function (id, matches, state, eos) {\n                for (const _case of cases) {\n                    const didmatch = (!_case.test || _case.test(id, matches, state, eos));\n                    if (didmatch) {\n                        return _case.value;\n                    }\n                }\n                return def;\n            }\n        };\n    }\n    else {\n        throw monarchCommon.createError(lexer, 'an action must be a string, an object with a \\'token\\' or \\'cases\\' attribute, or an array of actions; in rule: ' + ruleName);\n    }\n}\n/**\n * Helper class for creating matching rules\n */\nclass Rule {\n    constructor(name) {\n        this.regex = new RegExp('');\n        this.action = { token: '' };\n        this.matchOnlyAtLineStart = false;\n        this.name = '';\n        this.name = name;\n    }\n    setRegex(lexer, re) {\n        let sregex;\n        if (typeof (re) === 'string') {\n            sregex = re;\n        }\n        else if (re instanceof RegExp) {\n            sregex = re.source;\n        }\n        else {\n            throw monarchCommon.createError(lexer, 'rules must start with a match string or regular expression: ' + this.name);\n        }\n        this.matchOnlyAtLineStart = (sregex.length > 0 && sregex[0] === '^');\n        this.name = this.name + ': ' + sregex;\n        this.regex = compileRegExp(lexer, '^(?:' + (this.matchOnlyAtLineStart ? sregex.substr(1) : sregex) + ')');\n    }\n    setAction(lexer, act) {\n        this.action = compileAction(lexer, this.name, act);\n    }\n}\n/**\n * Compiles a json description function into json where all regular expressions,\n * case matches etc, are compiled and all include rules are expanded.\n * We also compile the bracket definitions, supply defaults, and do many sanity checks.\n * If the 'jsonStrict' parameter is 'false', we allow at certain locations\n * regular expression objects and functions that get called during lexing.\n * (Currently we have no samples that need this so perhaps we should always have\n * jsonStrict to true).\n */\nexport function compile(languageId, json) {\n    if (!json || typeof (json) !== 'object') {\n        throw new Error('Monarch: expecting a language definition object');\n    }\n    // Create our lexer\n    const lexer = {};\n    lexer.languageId = languageId;\n    lexer.includeLF = bool(json.includeLF, false);\n    lexer.noThrow = false; // raise exceptions during compilation\n    lexer.maxStack = 100;\n    // Set standard fields: be defensive about types\n    lexer.start = (typeof json.start === 'string' ? json.start : null);\n    lexer.ignoreCase = bool(json.ignoreCase, false);\n    lexer.unicode = bool(json.unicode, false);\n    lexer.tokenPostfix = string(json.tokenPostfix, '.' + lexer.languageId);\n    lexer.defaultToken = string(json.defaultToken, 'source');\n    lexer.usesEmbedded = false; // becomes true if we find a nextEmbedded action\n    // For calling compileAction later on\n    const lexerMin = json;\n    lexerMin.languageId = languageId;\n    lexerMin.includeLF = lexer.includeLF;\n    lexerMin.ignoreCase = lexer.ignoreCase;\n    lexerMin.unicode = lexer.unicode;\n    lexerMin.noThrow = lexer.noThrow;\n    lexerMin.usesEmbedded = lexer.usesEmbedded;\n    lexerMin.stateNames = json.tokenizer;\n    lexerMin.defaultToken = lexer.defaultToken;\n    // Compile an array of rules into newrules where RegExp objects are created.\n    function addRules(state, newrules, rules) {\n        for (const rule of rules) {\n            let include = rule.include;\n            if (include) {\n                if (typeof (include) !== 'string') {\n                    throw monarchCommon.createError(lexer, 'an \\'include\\' attribute must be a string at: ' + state);\n                }\n                if (include[0] === '@') {\n                    include = include.substr(1); // peel off starting @\n                }\n                if (!json.tokenizer[include]) {\n                    throw monarchCommon.createError(lexer, 'include target \\'' + include + '\\' is not defined at: ' + state);\n                }\n                addRules(state + '.' + include, newrules, json.tokenizer[include]);\n            }\n            else {\n                const newrule = new Rule(state);\n                // Set up new rule attributes\n                if (Array.isArray(rule) && rule.length >= 1 && rule.length <= 3) {\n                    newrule.setRegex(lexerMin, rule[0]);\n                    if (rule.length >= 3) {\n                        if (typeof (rule[1]) === 'string') {\n                            newrule.setAction(lexerMin, { token: rule[1], next: rule[2] });\n                        }\n                        else if (typeof (rule[1]) === 'object') {\n                            const rule1 = rule[1];\n                            rule1.next = rule[2];\n                            newrule.setAction(lexerMin, rule1);\n                        }\n                        else {\n                            throw monarchCommon.createError(lexer, 'a next state as the last element of a rule can only be given if the action is either an object or a string, at: ' + state);\n                        }\n                    }\n                    else {\n                        newrule.setAction(lexerMin, rule[1]);\n                    }\n                }\n                else {\n                    if (!rule.regex) {\n                        throw monarchCommon.createError(lexer, 'a rule must either be an array, or an object with a \\'regex\\' or \\'include\\' field at: ' + state);\n                    }\n                    if (rule.name) {\n                        if (typeof rule.name === 'string') {\n                            newrule.name = rule.name;\n                        }\n                    }\n                    if (rule.matchOnlyAtStart) {\n                        newrule.matchOnlyAtLineStart = bool(rule.matchOnlyAtLineStart, false);\n                    }\n                    newrule.setRegex(lexerMin, rule.regex);\n                    newrule.setAction(lexerMin, rule.action);\n                }\n                newrules.push(newrule);\n            }\n        }\n    }\n    // compile the tokenizer rules\n    if (!json.tokenizer || typeof (json.tokenizer) !== 'object') {\n        throw monarchCommon.createError(lexer, 'a language definition must define the \\'tokenizer\\' attribute as an object');\n    }\n    lexer.tokenizer = [];\n    for (const key in json.tokenizer) {\n        if (json.tokenizer.hasOwnProperty(key)) {\n            if (!lexer.start) {\n                lexer.start = key;\n            }\n            const rules = json.tokenizer[key];\n            lexer.tokenizer[key] = new Array();\n            addRules('tokenizer.' + key, lexer.tokenizer[key], rules);\n        }\n    }\n    lexer.usesEmbedded = lexerMin.usesEmbedded; // can be set during compileAction\n    // Set simple brackets\n    if (json.brackets) {\n        if (!(Array.isArray(json.brackets))) {\n            throw monarchCommon.createError(lexer, 'the \\'brackets\\' attribute must be defined as an array');\n        }\n    }\n    else {\n        json.brackets = [\n            { open: '{', close: '}', token: 'delimiter.curly' },\n            { open: '[', close: ']', token: 'delimiter.square' },\n            { open: '(', close: ')', token: 'delimiter.parenthesis' },\n            { open: '<', close: '>', token: 'delimiter.angle' }\n        ];\n    }\n    const brackets = [];\n    for (const el of json.brackets) {\n        let desc = el;\n        if (desc && Array.isArray(desc) && desc.length === 3) {\n            desc = { token: desc[2], open: desc[0], close: desc[1] };\n        }\n        if (desc.open === desc.close) {\n            throw monarchCommon.createError(lexer, 'open and close brackets in a \\'brackets\\' attribute must be different: ' + desc.open +\n                '\\n hint: use the \\'bracket\\' attribute if matching on equal brackets is required.');\n        }\n        if (typeof desc.open === 'string' && typeof desc.token === 'string' && typeof desc.close === 'string') {\n            brackets.push({\n                token: desc.token + lexer.tokenPostfix,\n                open: monarchCommon.fixCase(lexer, desc.open),\n                close: monarchCommon.fixCase(lexer, desc.close)\n            });\n        }\n        else {\n            throw monarchCommon.createError(lexer, 'every element in the \\'brackets\\' array must be a \\'{open,close,token}\\' object or array');\n        }\n    }\n    lexer.brackets = brackets;\n    // Disable throw so the syntax highlighter goes, no matter what\n    lexer.noThrow = true;\n    return lexer;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Color } from '../../../base/common/color.js';\nimport { Range } from '../../common/core/range.js';\nimport * as languages from '../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { ModesRegistry } from '../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport * as standaloneEnums from '../../common/standalone/standaloneEnums.js';\nimport { StandaloneServices } from './standaloneServices.js';\nimport { compile } from '../common/monarch/monarchCompile.js';\nimport { MonarchTokenizer } from '../common/monarch/monarchLexer.js';\nimport { IStandaloneThemeService } from '../common/standaloneTheme.js';\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\n/**\n * Register information about a new language.\n */\nexport function register(language) {\n    // Intentionally using the `ModesRegistry` here to avoid\n    // instantiating services too quickly in the standalone editor.\n    ModesRegistry.registerLanguage(language);\n}\n/**\n * Get the information of all the registered languages.\n */\nexport function getLanguages() {\n    let result = [];\n    result = result.concat(ModesRegistry.getLanguages());\n    return result;\n}\nexport function getEncodedLanguageId(languageId) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    return languageService.languageIdCodec.encodeLanguageId(languageId);\n}\n/**\n * An event emitted when a language is needed for the first time (e.g. a model has it set).\n * @event\n */\nexport function onLanguage(languageId, callback) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    const disposable = languageService.onDidEncounterLanguage((encounteredLanguageId) => {\n        if (encounteredLanguageId === languageId) {\n            // stop listening\n            disposable.dispose();\n            // invoke actual listener\n            callback();\n        }\n    });\n    return disposable;\n}\n/**\n * Set the editing configuration for a language.\n */\nexport function setLanguageConfiguration(languageId, configuration) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    if (!languageService.isRegisteredLanguageId(languageId)) {\n        throw new Error(`Cannot set configuration for unknown language ${languageId}`);\n    }\n    const languageConfigurationService = StandaloneServices.get(ILanguageConfigurationService);\n    return languageConfigurationService.register(languageId, configuration, 100);\n}\n/**\n * @internal\n */\nexport class EncodedTokenizationSupportAdapter {\n    constructor(languageId, actual) {\n        this._languageId = languageId;\n        this._actual = actual;\n    }\n    getInitialState() {\n        return this._actual.getInitialState();\n    }\n    tokenize(line, hasEOL, state) {\n        if (typeof this._actual.tokenize === 'function') {\n            return TokenizationSupportAdapter.adaptTokenize(this._languageId, this._actual, line, state);\n        }\n        throw new Error('Not supported!');\n    }\n    tokenizeEncoded(line, hasEOL, state) {\n        const result = this._actual.tokenizeEncoded(line, state);\n        return new languages.EncodedTokenizationResult(result.tokens, result.endState);\n    }\n}\n/**\n * @internal\n */\nexport class TokenizationSupportAdapter {\n    constructor(_languageId, _actual, _languageService, _standaloneThemeService) {\n        this._languageId = _languageId;\n        this._actual = _actual;\n        this._languageService = _languageService;\n        this._standaloneThemeService = _standaloneThemeService;\n    }\n    getInitialState() {\n        return this._actual.getInitialState();\n    }\n    static _toClassicTokens(tokens, language) {\n        const result = [];\n        let previousStartIndex = 0;\n        for (let i = 0, len = tokens.length; i < len; i++) {\n            const t = tokens[i];\n            let startIndex = t.startIndex;\n            // Prevent issues stemming from a buggy external tokenizer.\n            if (i === 0) {\n                // Force first token to start at first index!\n                startIndex = 0;\n            }\n            else if (startIndex < previousStartIndex) {\n                // Force tokens to be after one another!\n                startIndex = previousStartIndex;\n            }\n            result[i] = new languages.Token(startIndex, t.scopes, language);\n            previousStartIndex = startIndex;\n        }\n        return result;\n    }\n    static adaptTokenize(language, actual, line, state) {\n        const actualResult = actual.tokenize(line, state);\n        const tokens = TokenizationSupportAdapter._toClassicTokens(actualResult.tokens, language);\n        let endState;\n        // try to save an object if possible\n        if (actualResult.endState.equals(state)) {\n            endState = state;\n        }\n        else {\n            endState = actualResult.endState;\n        }\n        return new languages.TokenizationResult(tokens, endState);\n    }\n    tokenize(line, hasEOL, state) {\n        return TokenizationSupportAdapter.adaptTokenize(this._languageId, this._actual, line, state);\n    }\n    _toBinaryTokens(languageIdCodec, tokens) {\n        const languageId = languageIdCodec.encodeLanguageId(this._languageId);\n        const tokenTheme = this._standaloneThemeService.getColorTheme().tokenTheme;\n        const result = [];\n        let resultLen = 0;\n        let previousStartIndex = 0;\n        for (let i = 0, len = tokens.length; i < len; i++) {\n            const t = tokens[i];\n            const metadata = tokenTheme.match(languageId, t.scopes);\n            if (resultLen > 0 && result[resultLen - 1] === metadata) {\n                // same metadata\n                continue;\n            }\n            let startIndex = t.startIndex;\n            // Prevent issues stemming from a buggy external tokenizer.\n            if (i === 0) {\n                // Force first token to start at first index!\n                startIndex = 0;\n            }\n            else if (startIndex < previousStartIndex) {\n                // Force tokens to be after one another!\n                startIndex = previousStartIndex;\n            }\n            result[resultLen++] = startIndex;\n            result[resultLen++] = metadata;\n            previousStartIndex = startIndex;\n        }\n        const actualResult = new Uint32Array(resultLen);\n        for (let i = 0; i < resultLen; i++) {\n            actualResult[i] = result[i];\n        }\n        return actualResult;\n    }\n    tokenizeEncoded(line, hasEOL, state) {\n        const actualResult = this._actual.tokenize(line, state);\n        const tokens = this._toBinaryTokens(this._languageService.languageIdCodec, actualResult.tokens);\n        let endState;\n        // try to save an object if possible\n        if (actualResult.endState.equals(state)) {\n            endState = state;\n        }\n        else {\n            endState = actualResult.endState;\n        }\n        return new languages.EncodedTokenizationResult(tokens, endState);\n    }\n}\nfunction isATokensProvider(provider) {\n    return (typeof provider.getInitialState === 'function');\n}\nfunction isEncodedTokensProvider(provider) {\n    return 'tokenizeEncoded' in provider;\n}\nfunction isThenable(obj) {\n    return obj && typeof obj.then === 'function';\n}\n/**\n * Change the color map that is used for token colors.\n * Supported formats (hex): #RRGGBB, $RRGGBBAA, #RGB, #RGBA\n */\nexport function setColorMap(colorMap) {\n    const standaloneThemeService = StandaloneServices.get(IStandaloneThemeService);\n    if (colorMap) {\n        const result = [null];\n        for (let i = 1, len = colorMap.length; i < len; i++) {\n            result[i] = Color.fromHex(colorMap[i]);\n        }\n        standaloneThemeService.setColorMapOverride(result);\n    }\n    else {\n        standaloneThemeService.setColorMapOverride(null);\n    }\n}\n/**\n * @internal\n */\nfunction createTokenizationSupportAdapter(languageId, provider) {\n    if (isEncodedTokensProvider(provider)) {\n        return new EncodedTokenizationSupportAdapter(languageId, provider);\n    }\n    else {\n        return new TokenizationSupportAdapter(languageId, provider, StandaloneServices.get(ILanguageService), StandaloneServices.get(IStandaloneThemeService));\n    }\n}\n/**\n * Register a tokens provider factory for a language. This tokenizer will be exclusive with a tokenizer\n * set using `setTokensProvider` or one created using `setMonarchTokensProvider`, but will work together\n * with a tokens provider set using `registerDocumentSemanticTokensProvider` or `registerDocumentRangeSemanticTokensProvider`.\n */\nexport function registerTokensProviderFactory(languageId, factory) {\n    const adaptedFactory = {\n        createTokenizationSupport: () => __awaiter(this, void 0, void 0, function* () {\n            const result = yield Promise.resolve(factory.create());\n            if (!result) {\n                return null;\n            }\n            if (isATokensProvider(result)) {\n                return createTokenizationSupportAdapter(languageId, result);\n            }\n            return new MonarchTokenizer(StandaloneServices.get(ILanguageService), StandaloneServices.get(IStandaloneThemeService), languageId, compile(languageId, result), StandaloneServices.get(IConfigurationService));\n        })\n    };\n    return languages.TokenizationRegistry.registerFactory(languageId, adaptedFactory);\n}\n/**\n * Set the tokens provider for a language (manual implementation). This tokenizer will be exclusive\n * with a tokenizer created using `setMonarchTokensProvider`, or with `registerTokensProviderFactory`,\n * but will work together with a tokens provider set using `registerDocumentSemanticTokensProvider`\n * or `registerDocumentRangeSemanticTokensProvider`.\n */\nexport function setTokensProvider(languageId, provider) {\n    const languageService = StandaloneServices.get(ILanguageService);\n    if (!languageService.isRegisteredLanguageId(languageId)) {\n        throw new Error(`Cannot set tokens provider for unknown language ${languageId}`);\n    }\n    if (isThenable(provider)) {\n        return registerTokensProviderFactory(languageId, { create: () => provider });\n    }\n    return languages.TokenizationRegistry.register(languageId, createTokenizationSupportAdapter(languageId, provider));\n}\n/**\n * Set the tokens provider for a language (monarch implementation). This tokenizer will be exclusive\n * with a tokenizer set using `setTokensProvider`, or with `registerTokensProviderFactory`, but will\n * work together with a tokens provider set using `registerDocumentSemanticTokensProvider` or\n * `registerDocumentRangeSemanticTokensProvider`.\n */\nexport function setMonarchTokensProvider(languageId, languageDef) {\n    const create = (languageDef) => {\n        return new MonarchTokenizer(StandaloneServices.get(ILanguageService), StandaloneServices.get(IStandaloneThemeService), languageId, compile(languageId, languageDef), StandaloneServices.get(IConfigurationService));\n    };\n    if (isThenable(languageDef)) {\n        return registerTokensProviderFactory(languageId, { create: () => languageDef });\n    }\n    return languages.TokenizationRegistry.register(languageId, create(languageDef));\n}\n/**\n * Register a reference provider (used by e.g. reference search).\n */\nexport function registerReferenceProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.referenceProvider.register(languageSelector, provider);\n}\n/**\n * Register a rename provider (used by e.g. rename symbol).\n */\nexport function registerRenameProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.renameProvider.register(languageSelector, provider);\n}\n/**\n * Register a signature help provider (used by e.g. parameter hints).\n */\nexport function registerSignatureHelpProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.signatureHelpProvider.register(languageSelector, provider);\n}\n/**\n * Register a hover provider (used by e.g. editor hover).\n */\nexport function registerHoverProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.hoverProvider.register(languageSelector, {\n        provideHover: (model, position, token) => {\n            const word = model.getWordAtPosition(position);\n            return Promise.resolve(provider.provideHover(model, position, token)).then((value) => {\n                if (!value) {\n                    return undefined;\n                }\n                if (!value.range && word) {\n                    value.range = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n                }\n                if (!value.range) {\n                    value.range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n                }\n                return value;\n            });\n        }\n    });\n}\n/**\n * Register a document symbol provider (used by e.g. outline).\n */\nexport function registerDocumentSymbolProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.documentSymbolProvider.register(languageSelector, provider);\n}\n/**\n * Register a document highlight provider (used by e.g. highlight occurrences).\n */\nexport function registerDocumentHighlightProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.documentHighlightProvider.register(languageSelector, provider);\n}\n/**\n * Register an linked editing range provider.\n */\nexport function registerLinkedEditingRangeProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.linkedEditingRangeProvider.register(languageSelector, provider);\n}\n/**\n * Register a definition provider (used by e.g. go to definition).\n */\nexport function registerDefinitionProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.definitionProvider.register(languageSelector, provider);\n}\n/**\n * Register a implementation provider (used by e.g. go to implementation).\n */\nexport function registerImplementationProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.implementationProvider.register(languageSelector, provider);\n}\n/**\n * Register a type definition provider (used by e.g. go to type definition).\n */\nexport function registerTypeDefinitionProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.typeDefinitionProvider.register(languageSelector, provider);\n}\n/**\n * Register a code lens provider (used by e.g. inline code lenses).\n */\nexport function registerCodeLensProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.codeLensProvider.register(languageSelector, provider);\n}\n/**\n * Register a code action provider (used by e.g. quick fix).\n */\nexport function registerCodeActionProvider(languageSelector, provider, metadata) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.codeActionProvider.register(languageSelector, {\n        providedCodeActionKinds: metadata === null || metadata === void 0 ? void 0 : metadata.providedCodeActionKinds,\n        documentation: metadata === null || metadata === void 0 ? void 0 : metadata.documentation,\n        provideCodeActions: (model, range, context, token) => {\n            const markerService = StandaloneServices.get(IMarkerService);\n            const markers = markerService.read({ resource: model.uri }).filter(m => {\n                return Range.areIntersectingOrTouching(m, range);\n            });\n            return provider.provideCodeActions(model, range, { markers, only: context.only, trigger: context.trigger }, token);\n        },\n        resolveCodeAction: provider.resolveCodeAction\n    });\n}\n/**\n * Register a formatter that can handle only entire models.\n */\nexport function registerDocumentFormattingEditProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.documentFormattingEditProvider.register(languageSelector, provider);\n}\n/**\n * Register a formatter that can handle a range inside a model.\n */\nexport function registerDocumentRangeFormattingEditProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.documentRangeFormattingEditProvider.register(languageSelector, provider);\n}\n/**\n * Register a formatter than can do formatting as the user types.\n */\nexport function registerOnTypeFormattingEditProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.onTypeFormattingEditProvider.register(languageSelector, provider);\n}\n/**\n * Register a link provider that can find links in text.\n */\nexport function registerLinkProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.linkProvider.register(languageSelector, provider);\n}\n/**\n * Register a completion item provider (use by e.g. suggestions).\n */\nexport function registerCompletionItemProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.completionProvider.register(languageSelector, provider);\n}\n/**\n * Register a document color provider (used by Color Picker, Color Decorator).\n */\nexport function registerColorProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.colorProvider.register(languageSelector, provider);\n}\n/**\n * Register a folding range provider\n */\nexport function registerFoldingRangeProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.foldingRangeProvider.register(languageSelector, provider);\n}\n/**\n * Register a declaration provider\n */\nexport function registerDeclarationProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.declarationProvider.register(languageSelector, provider);\n}\n/**\n * Register a selection range provider\n */\nexport function registerSelectionRangeProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.selectionRangeProvider.register(languageSelector, provider);\n}\n/**\n * Register a document semantic tokens provider. A semantic tokens provider will complement and enhance a\n * simple top-down tokenizer. Simple top-down tokenizers can be set either via `setMonarchTokensProvider`\n * or `setTokensProvider`.\n *\n * For the best user experience, register both a semantic tokens provider and a top-down tokenizer.\n */\nexport function registerDocumentSemanticTokensProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.documentSemanticTokensProvider.register(languageSelector, provider);\n}\n/**\n * Register a document range semantic tokens provider. A semantic tokens provider will complement and enhance a\n * simple top-down tokenizer. Simple top-down tokenizers can be set either via `setMonarchTokensProvider`\n * or `setTokensProvider`.\n *\n * For the best user experience, register both a semantic tokens provider and a top-down tokenizer.\n */\nexport function registerDocumentRangeSemanticTokensProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.documentRangeSemanticTokensProvider.register(languageSelector, provider);\n}\n/**\n * Register an inline completions provider.\n */\nexport function registerInlineCompletionsProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.inlineCompletionsProvider.register(languageSelector, provider);\n}\n/**\n * Register an inlay hints provider.\n */\nexport function registerInlayHintsProvider(languageSelector, provider) {\n    const languageFeaturesService = StandaloneServices.get(ILanguageFeaturesService);\n    return languageFeaturesService.inlayHintsProvider.register(languageSelector, provider);\n}\n/**\n * @internal\n */\nexport function createMonacoLanguagesAPI() {\n    return {\n        register: register,\n        getLanguages: getLanguages,\n        onLanguage: onLanguage,\n        getEncodedLanguageId: getEncodedLanguageId,\n        // provider methods\n        setLanguageConfiguration: setLanguageConfiguration,\n        setColorMap: setColorMap,\n        registerTokensProviderFactory: registerTokensProviderFactory,\n        setTokensProvider: setTokensProvider,\n        setMonarchTokensProvider: setMonarchTokensProvider,\n        registerReferenceProvider: registerReferenceProvider,\n        registerRenameProvider: registerRenameProvider,\n        registerCompletionItemProvider: registerCompletionItemProvider,\n        registerSignatureHelpProvider: registerSignatureHelpProvider,\n        registerHoverProvider: registerHoverProvider,\n        registerDocumentSymbolProvider: registerDocumentSymbolProvider,\n        registerDocumentHighlightProvider: registerDocumentHighlightProvider,\n        registerLinkedEditingRangeProvider: registerLinkedEditingRangeProvider,\n        registerDefinitionProvider: registerDefinitionProvider,\n        registerImplementationProvider: registerImplementationProvider,\n        registerTypeDefinitionProvider: registerTypeDefinitionProvider,\n        registerCodeLensProvider: registerCodeLensProvider,\n        registerCodeActionProvider: registerCodeActionProvider,\n        registerDocumentFormattingEditProvider: registerDocumentFormattingEditProvider,\n        registerDocumentRangeFormattingEditProvider: registerDocumentRangeFormattingEditProvider,\n        registerOnTypeFormattingEditProvider: registerOnTypeFormattingEditProvider,\n        registerLinkProvider: registerLinkProvider,\n        registerColorProvider: registerColorProvider,\n        registerFoldingRangeProvider: registerFoldingRangeProvider,\n        registerDeclarationProvider: registerDeclarationProvider,\n        registerSelectionRangeProvider: registerSelectionRangeProvider,\n        registerDocumentSemanticTokensProvider: registerDocumentSemanticTokensProvider,\n        registerDocumentRangeSemanticTokensProvider: registerDocumentRangeSemanticTokensProvider,\n        registerInlineCompletionsProvider: registerInlineCompletionsProvider,\n        registerInlayHintsProvider: registerInlayHintsProvider,\n        // enums\n        DocumentHighlightKind: standaloneEnums.DocumentHighlightKind,\n        CompletionItemKind: standaloneEnums.CompletionItemKind,\n        CompletionItemTag: standaloneEnums.CompletionItemTag,\n        CompletionItemInsertTextRule: standaloneEnums.CompletionItemInsertTextRule,\n        SymbolKind: standaloneEnums.SymbolKind,\n        SymbolTag: standaloneEnums.SymbolTag,\n        IndentAction: standaloneEnums.IndentAction,\n        CompletionTriggerKind: standaloneEnums.CompletionTriggerKind,\n        SignatureHelpTriggerKind: standaloneEnums.SignatureHelpTriggerKind,\n        InlayHintKind: standaloneEnums.InlayHintKind,\n        InlineCompletionTriggerKind: standaloneEnums.InlineCompletionTriggerKind,\n        CodeActionTriggerType: standaloneEnums.CodeActionTriggerType,\n        // classes\n        FoldingRangeKind: languages.FoldingRangeKind,\n    };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a;\nimport { EditorOptions } from './common/config/editorOptions.js';\nimport { createMonacoBaseAPI } from './common/services/editorBaseApi.js';\nimport { createMonacoEditorAPI } from './standalone/browser/standaloneEditor.js';\nimport { createMonacoLanguagesAPI } from './standalone/browser/standaloneLanguages.js';\nimport { globals } from '../base/common/platform.js';\nimport { FormattingConflicts } from './contrib/format/browser/format.js';\n// Set defaults for standalone editor\nEditorOptions.wrappingIndent.defaultValue = 0 /* WrappingIndent.None */;\nEditorOptions.glyphMargin.defaultValue = false;\nEditorOptions.autoIndent.defaultValue = 3 /* EditorAutoIndentStrategy.Advanced */;\nEditorOptions.overviewRulerLanes.defaultValue = 2;\n// We need to register a formatter selector which simply picks the first available formatter.\n// See https://github.com/microsoft/monaco-editor/issues/2327\nFormattingConflicts.setFormatterSelector((formatter, document, mode) => Promise.resolve(formatter[0]));\nconst api = createMonacoBaseAPI();\napi.editor = createMonacoEditorAPI();\napi.languages = createMonacoLanguagesAPI();\nexport const CancellationTokenSource = api.CancellationTokenSource;\nexport const Emitter = api.Emitter;\nexport const KeyCode = api.KeyCode;\nexport const KeyMod = api.KeyMod;\nexport const Position = api.Position;\nexport const Range = api.Range;\nexport const Selection = api.Selection;\nexport const SelectionDirection = api.SelectionDirection;\nexport const MarkerSeverity = api.MarkerSeverity;\nexport const MarkerTag = api.MarkerTag;\nexport const Uri = api.Uri;\nexport const Token = api.Token;\nexport const editor = api.editor;\nexport const languages = api.languages;\nif (((_a = globals.MonacoEnvironment) === null || _a === void 0 ? void 0 : _a.globalAPI) || (typeof define === 'function' && define.amd)) {\n    self.monaco = api;\n}\nif (typeof self.require !== 'undefined' && typeof self.require.config === 'function') {\n    self.require.config({\n        ignoreDuplicateModules: [\n            'vscode-languageserver-types',\n            'vscode-languageserver-types/main',\n            'vscode-languageserver-textdocument',\n            'vscode-languageserver-textdocument/main',\n            'vscode-nls',\n            'vscode-nls/vscode-nls',\n            'jsonc-parser',\n            'jsonc-parser/main',\n            'vscode-uri',\n            'vscode-uri/index',\n            'vs/basic-languages/typescript/typescript'\n        ]\n    });\n}\n"],"names":["KeyMod$1","firstPart","secondPart","KeyChord","KeyMod","createMonacoBaseAPI","CancellationTokenSource","Emitter","standaloneEnums.KeyCode","Position","Range","Selection","standaloneEnums.SelectionDirection","standaloneEnums.MarkerSeverity","standaloneEnums.MarkerTag","URI","Token","defaultOptions","DiffNavigator","Disposable","editor","options","objects.mixin","e","lineChanges","lineChange","charChange","left","right","fwd","found","position","i","len","range","scrollType","assert.ok","info","pos","INITIALIZE","webWorkerWarningLogged","logOnceWebWorkerWarning","err","isWeb","RequestMessage","vsWorker","req","method","args","ReplyMessage","seq","res","SubscribeEventMessage","eventName","arg","EventMessage","event","UnsubscribeEventMessage","SimpleWorkerProtocol","handler","workerId","resolve","reject","emitter","message","msg","replyMessage","reply","requestMessage","r","transformErrorForSerialization","disposable","transfer","SimpleWorkerClient","workerFactory","moduleId","host","lazyProxyReject","propertyIsDynamicEvent","propertyIsEvent","loaderConfiguration","globals","hostMethods","types.getAllMethodNames","proxyMethodRequest","proxyListen","availableMethods","createProxyObject","error","name","strings.isUpperAsciiLetter","methodNames","invoke","createProxyMethod","createProxyDynamicEvent","result","methodName","_a","ttPolicy","value","getWorker","label","workerUrl","isPromiseLike","obj","WebWorker","id","onMessageCallback","onErrorCallback","workerOrPromise","w","ev","DefaultWorkerFactory","MINIMUM_MATCHING_CHARACTER_LENGTH","computeDiff","originalSequence","modifiedSequence","continueProcessingPredicate","pretty","LcsDiff","LineSequence","lines","startColumns","endColumns","length","getFirstNonBlankColumn","getLastNonBlankColumn","elements","index","shouldIgnoreTrimWhitespace","startIndex","endIndex","charCodes","lineNumbers","columns","lineContent","startColumn","endColumn","col","CharSequence","s","idx","arr","CharChange","originalStartLineNumber","originalStartColumn","originalEndLineNumber","originalEndColumn","modifiedStartLineNumber","modifiedStartColumn","modifiedEndLineNumber","modifiedEndColumn","diffChange","originalCharSequence","modifiedCharSequence","postProcessCharChanges","rawChanges","prevChange","currChange","originalMatchingLength","modifiedMatchingLength","LineChange","charChanges","originalLineSequence","modifiedLineSequence","continueCharDiff","shouldComputeCharChanges","shouldPostProcessCharChanges","DiffComputer","originalLines","modifiedLines","opts","createContinueProcessingPredicate","diffResult","quitEarly","originalLineIndex","modifiedLineIndex","nextChange","originalStop","modifiedStop","originalLine","modifiedLine","originalChar","modifiedChar","originalMaxColumn","modifiedMaxColumn","originalLineNumber","modifiedLineNumber","txt","defaultValue","strings.firstNonWhitespaceIndex","strings.lastNonWhitespaceIndex","maximumRuntime","startTime","MirrorTextModel","uri","eol","versionId","changes","change","eolLength","linesLength","lineStartValues","PrefixSumComputer","lineIndex","newValue","insertText","insertLines","splitLines","newLengths","Uint8Matrix","rows","cols","data","row","StateMachine","edges","maxCharCode","maxState","from","chCode","to","states","currentState","_stateMachine","getStateMachine","_classifier","getClassifier","CharacterClassifier","FORCE_TERMINATION_CHARACTERS","CANNOT_END_WITH_CHARACTERS","LinkComputer","classifier","line","lineNumber","linkBeginIndex","linkEndIndex","lastIncludedCharIndex","charCodeBeforeLink","lastCharCodeInLink","model","stateMachine","lineCount","j","linkBeginChCode","state","hasOpenParens","hasOpenSquareBracket","inSquareBrackets","hasOpenCurlyBracket","resetStateMachine","chClass","computeLinks","BasicInplaceReplace","range1","text1","range2","text2","up","text","numberResult","precision","n1","n2","valueSets","valueSet","__awaiter","this","thisArg","_arguments","P","generator","adopt","fulfilled","step","rejected","MirrorModel","BaseMirrorModel","wordDefinition","wordAtText","getWordAtText","ensureValidWordDefinition","wordenize","lineText","wordRangesIdx","wordRanges","content","ranges","words","match","lineEnding","startLineIndex","endLineIndex","resultLines","offset","out","lineLength","start","end","column","hasChanged","maxCharacter","EditorSimpleWorker","foreignModuleFactory","all","key","strURL","url","UnicodeTextModelHighlighter","originalUrl","modifiedUrl","ignoreTrimWhitespace","maxComputationTime","original","modified","originalTextModel","modifiedTextModel","identical","originalLineCount","modifiedLineCount","modelUrl","edits","lastEol","a","b","aRng","bRng","stringDiff","editOffset","newEdit","modelUrls","leadingWord","wordDef","wordDefFlags","sw","StopWatch","wordDefRegExp","seen","outer","word","array","selectionText","wordRange","createData","foreignHostMethods","ctx","types.createProxyObject","__decorate","decorators","target","desc","c","d","__param","paramIndex","decorator","STOP_SYNC_MODEL_DELTA_TIME_MS","STOP_WORKER_DELTA_TIME_MS","canSyncModel","modelService","resource","EditorWorkerService","configurationService","logService","languageConfigurationService","languageFeaturesService","WorkerManager","token","client","links","WordBasedCompletionItemProvider","isNonEmptyArray","timeout","IModelService","ITextResourceConfigurationService","ILogService","ILanguageConfigurationService","ILanguageFeaturesService","workerManager","config","models","candidate","replace","insert","IntervalTimer","_","EditorWorkerClient","EditorModelManager","proxy","keepIdleModels","timer","dispose","resources","forceLargeModels","resourceStr","currentTime","toRemove","toDispose","DisposableStore","toDisposable","SynchronousWorkerClient","instance","EditorWorkerHost","workerClient","canceled","regExpFlags","createWebWorker","MonacoWebWorkerImpl","foreignMethods","foreignProxy","foreignMethod","isFuzzyActionArr","what","isFuzzyAction","isString","isIAction","empty","fixCase","lexer","str","sanitize","log","createError","substituteMatches","matches","re","stateMatches","full","sub","dollar","hash","n","attr","ofs","total","findRules","inState","rules","stateExists","CACHE_STACK_DEPTH","MonarchStackElementFactory","maxCacheDepth","parent","MonarchStackElement","stackElementId","element","other","EmbeddedLanguageData","languageId","MonarchLineStateFactory","stack","embeddedLanguageData","MonarchLineState","MonarchClassicTokensCollector","startOffset","type","languages.Token","embeddedLanguageLine","hasEOL","offsetDelta","nestedLanguageId","embeddedModeState","nestedLanguageTokenizationSupport","languages.TokenizationRegistry","nestedResult","endState","languages.TokenizationResult","MonarchModernTokensCollector","languageService","theme","metadata","aLen","bLen","cLen","languages.EncodedTokenizationResult","MonarchTokenizer","standaloneThemeService","_configurationService","emitting","isOneOfMyEmbeddedModes","language","promises","tokenizationSupport","nestedModeStatus","rootState","lineState","nullTokenize","tokensCollector","endLineState","nullTokenizeEncoded","collector","monarchCommon.findRules","monarchCommon.createError","popOffset","hasEmbeddedPopRule","rule","monarchCommon.isIAction","regex","regexSource","flags","nestedEndState","nestedLanguageLine","restOfTheLine","lineWithoutLF","lineWithoutLFLength","groupMatching","forceEvaluation","pos0","stackLen0","groupLen0","matched","action","enteringEmbeddedLanguage","groupEntry","restOfLine","monarchCommon.isFuzzyAction","monarchCommon.substituteMatches","nextState","monarchCommon.log","computeNewStateForEmbeddedLanguage","totalLen","tokenType","monarchCommon.isString","rest","bracket","findBracket","monarchCommon.sanitize","NullState","IConfigurationService","monarchCommon.fixCase","brackets","Colorizer","themeService","domNode","mimeType","render","trustedhtml","languageIdCodec","tabSize","strings.startsWithUTF8BOM","strings.splitLines","_fakeColorize","TokenizationRegistry","_colorize","mightContainNonBasicASCII","mightContainRTL","tokens","isBasicASCII","ViewLineRenderingData","containsRTL","renderViewLine","RenderLineInput","inflatedTokens","execute","_actualColorize","status","html","lineTokens","LineTokens","renderResult","tokenizeResult","AbstractCodeEditorService","_themeService","LinkedList","editorWithWidgetFocus","editors","provider","ed","key1","dest","input","source","sideBySide","rm","IThemeService","StandaloneCodeEditorService","contextKeyService","hasCodeEditor","activeCodeEditor","schema","Schemas","windowOpenNoOpener","selection","IContextKeyService","registerSingleton","ICodeEditorService","ILayoutService","createDecorator","StandaloneLayoutService","_codeEditorService","Event","dom.getClientArea","EditorScopedLayoutService","_container","codeEditorService","getResourceLabel","stackElementCounter","ResourceStackElement","actual","resourceLabel","strResource","groupId","groupOrder","sourceId","sourceOrder","isValid","ResourceReasonPair","reason","RemovedResources","externalRemoval","noParallelUniverses","messages","nls.localize","WorkspaceStackElement","resourceLabels","strResources","ResourceEditStack","filter","futureElement","ResourceEditStackSnapshot","snapshot","snapshotLength","isOK","snapshotIndex","removePastAfter","removeFutureBefore","past","future","individualMap","EditStackSnapshot","editStacks","missingEditStack","UndoRedoService","_dialogService","_notificationService","uriComparisonKeyComputer","group","UndoRedoGroup","UndoRedoSource","editStack","closestPastElement","ignoreResources","individualArr","_element","matchedElement","matchedStrResource","resourceOrSource","onUnexpectedError","editStackSnapshot","cleanup","continuation","releaseLocks","callback","isDisposable","affectedEditStacks","WorkspaceVerificationError","checkInvalidatedResources","cannotUndoDueToResources","cannotLockDueToResources","undoConfirmed","verificationError","pastElement","secondPastElement","Severity","verificationError1","verificationError2","cannotRedoDueToResources","IDialogService","INotificationService","returnValue","IUndoRedoService","ConfigurationModel","_contents","_keys","_overrides","section","getConfigurationValue","overrideIdentifier","overrideContents","identifier","overrideConfigurationModel","others","contents","objects.deepClone","overrides","keys","otherOverride","override","o","arrays.equals","arrays.distinct","contentsForKey","overrideContentsForKey","types.isObject","objects.deepFreeze","contentsForIdentifierOnly","mergeContents","contentsToMerge","addToValueTree","removeFromValueTree","Configuration","_defaultConfiguration","_policyConfiguration","_applicationConfiguration","_localUserConfiguration","_remoteUserConfiguration","_workspaceConfiguration","_folderConfigurations","ResourceMap","_memoryConfiguration","_memoryConfigurationByResource","_freeze","workspace","memoryConfiguration","consolidateConfigurationModel","folderConfigurationModel","memoryConfigurationModel","policyValue","applicationValue","userValue","userLocalValue","userRemoteValue","workspaceValue","workspaceFolderValue","memoryValue","overrideIdentifiers","configurationModel","consolidateConfiguration","root","memoryConfigurationForResource","folder","folderConsolidatedConfiguration","workspaceConsolidateConfiguration","folderConfiguration","defaultConfiguration","policyConfiguration","applicationConfiguration","userConfiguration","workspaceConfiguration","folders","ConfigurationChangeEvent","previous","currentConfiguraiton","currentWorkspace","keysSet","value1","value2","objects.equals","affectedKeysTree","requestedTree","toValuesTree","HIGH_FREQ_COMMANDS","AbstractKeybindingService","_contextKeyService","_commandService","_telemetryService","_logService","KeybindingModifierSet","TimeoutTimer","commandId","context","keybinding","contextValue","currentChord","keypressLabel","chordEnterTime","singleModifier","isSingleModiferChord","shouldPreventDefault","dispatchKeyname","resolveResult","modifier","KeybindingResolver","defaultKeybindings","defaultKeybinding","command","k","defaultKb","keypressFirstPart","keypressChordPart","when","expressionsAreEqualWithConstantSubstitution","removals","commandRemovals","isRemoved","commandRemoval","keypress","item","conflicts","conflict","conflictIsChord","itemIsChord","implies","items","lookupMap","candidates","printWhenExplanation","printSourceExplanation","kb","ResolvedKeybindingItem","resolvedKeybinding","commandArgs","isDefault","extensionId","isBuiltinExtension","removeElementsAfterNulls","BaseResolvedKeybinding","ResolvedKeybinding","os","parts","illegalArgument","UILabelProvider","AriaLabelProvider","ElectronAcceleratorLabelProvider","ResolvedKeybindingPart","USLayoutResolvedKeybinding","keyCode","KeyCodeUtils","scanCode","immutableKeyCode","IMMUTABLE_CODE_TO_KEY_CODE","binding","SimpleKeybinding","ChordKeybinding","LayoutAnchorMode","layout","viewportSize","viewSize","anchor","layoutAfterAnchorBoundary","layoutBeforeAnchorBoundary","ContextView","container","domPosition","DOM.$","DOM.hide","style","SHADOW_ROOT_CSS","toDisposeOnSetContainer","DOM.addStandardDisposableListener","delegate","_b","DOM.clearNode","DOM.show","platform.isIOS","BrowserFeatures","around","DOM.isHTMLElement","elementPosition","DOM.getDomNodePagePosition","zoom","DOM.getDomNodeZoomLevel","viewSizeWidth","DOM.getTotalWidth","viewSizeHeight","DOM.getTotalHeight","anchorPosition","anchorAlignment","anchorAxisAlignment","top","verticalAnchor","horizontalAnchor","containerPosition","onCapture","DOM.isAncestor","ContextViewService","layoutService","shadowRoot","GLOBSTAR","GLOB_SPLIT","PATH_REGEX","NO_PATH_REGEX","ALL_FORWARD_SLASHES","starsToRegExp","starCount","isLastPattern","splitGlobAware","pattern","splitChar","segments","inBraces","inBrackets","curVal","char","parseRegExp","regEx","segment","previousSegmentWasGlobStar","braceVal","bracketVal","escapeRegExpCharacters","braceRegExp","choice","T1","T2","T3","T3_2","T4","T5","CACHE","LRUCache","FALSE","NULL","parsePattern","arg1","patternKey","parsedPattern","wrapRelativePattern","trivia1","trimForExclusions","trivia2","trivia3","trivia4and5","toRegExp","arg2","wrappedPattern","path","basename","isEqualOrParent","isLinux","base","slashBase","backslashBase","basenames","parsedPatterns","aggregateBasenameMatches","patternsLength","withBasenames","allPaths","current","targetPath","matchPathEnds","usingPosixSep","sep","posix","nativePath","nativePathEnd","targetPathEnd","regExp","hasSibling","parse","isRelativePattern","resultPattern","parsedExpression","rp","expression","parseExpressionPattern","resultExpression","resultPromises","isThenable","resultPromise","extname","clausePattern","basenamePatterns","patterns","aggregate","ch","aggregatedPatterns","registeredAssociations","nonUserRegisteredAssociations","userRegisteredAssociations","registerPlatformLanguageAssociation","association","warnOnOverwrite","_registerLanguageAssociation","userConfigured","associationItem","toLanguageAssociationItem","clearPlatformLanguageAssociations","getLanguageIds","firstLine","getAssociations","DataUri","Mimes","filename","configuredLanguage","getAssociationByPath","PLAINTEXT_LANGUAGE_ID","registeredLanguage","firstlineLanguage","getAssociationByFirstline","associations","filenameMatch","patternMatch","extensionMatch","startsWithUTF8BOM","hasOwnProperty","NULL_LANGUAGE_ID","LanguageIdCodec","LanguagesRegistry","useModesRegistry","ModesRegistry","m","langId","alias","mimetype","Registry","Extensions","lang","resolvedLanguage","primaryMime","extension","filenamePattern","firstLineRegexStr","firstLineRegex","regExpLeadsToEndlessLoop","langAliases","langAlias","containsAliases","bestName","languageName","languageNameLower","LanguageService","languageIds","firstOrDefault","LanguageSelection","_onDidChangeLanguages","_selector","formatRule","def","Codicon","MENU_MNEMONIC_REGEX","MENU_ESCAPED_MNEMONIC_REGEX","Direction","Menu","ActionBar","actions","menuElement","parentData","isMacintosh","Gesture","addDisposableListener","EventType","StandardKeyboardEvent","EventHelper","SubmenuMenuActionViewItem","relatedTarget","isAncestor","lastFocusedItem","TouchEventType","DomScrollableElement","scrollElement","scrollTop","MenuSeparatorActionViewItem","isInShadowDOM","createStyleSheet","getMenuWidgetCSS","fgColor","bgColor","border","borderRadius","shadow","BaseMenuActionViewItem","elem","fromRight","Separator","SubmenuAction","menuActionViewItem","mnemonic","actionViewItems","menuItemOptions","keybindingLabel","BaseActionViewItem","RunOnceScheduler","isFirefox","StandardMouseEvent","append","$","setSize","clearNode","stripIcons","cleanLabel","cleanMnemonic","strings.escape","escMatch","replaceDoubleEscapes","strings.ltrim","strings.rtrim","checked","isSelected","outline","outlineOffset","submenuActions","submenuOptions","getActiveElement","force","windowDimensions","submenu","entry","expandDirection","ret","selectFirstItem","computedStyles","paddingTop","EmptySubmenuAction","entryBox","entryBoxUpdated","viewBox","Dimension","ActionViewItem","mnemonicInText","isForShadowDom","scrollbarShadowColor","scrollbarSliderBackgroundColor","scrollbarSliderHoverBackgroundColor","scrollbarSliderActiveBackgroundColor","ContextMenuHandler","contextViewService","telemetryService","notificationService","keybindingService","menu","shadowRootElement","isHTMLElement","className","menuDisposables","actionRunner","ActionRunner","attachMenuStyler","combinedDisposable","didCancel","isCancellationError","ContextMenuService","ModifierKeyEmitter","ITelemetryService","IContextViewService","IKeybindingService","EditorOpenSource","CommandOpener","matchesScheme","ICommandService","EditorOpener","_editorService","extractSelection","normalizePath","OpenerService","editorService","commandService","href","matchesSomeScheme","dom.windowOpenNoOpener","opener","validator","resolver","externalOpener","targetURI","validationTarget","externalUri","preferredOpenerId","CancellationToken","MarkerDecorations","markers","newDecorations","oldIds","ids","decoration","MarkerDecorationsService","_markerService","markerDecorations","changedResources","marker","owner","newModelDecorations","rawMarker","MarkerSeverity","maxColumn","minColumn","color","zIndex","inlineClassName","minimap","themeColorFromId","overviewRulerWarning","minimapWarning","MinimapPosition","overviewRulerInfo","overviewRulerError","minimapError","OverviewRulerLane","tag","IMarkerService","Color","Button","mixin","eventType","eventHandled","trackFocus","hoverBackground","styles","background","foreground","reset","renderLabelWithIcons","CSS_DONE","CSS_ACTIVE","CSS_INFINITE","CSS_INFINITE_LONG_RUNNING","CSS_DISCRETE","defaultOpts","ProgressBar","show","delayed","iconPathToClass","iconClassGenerator","IdGenerator","getIconClass","iconPath","iconClass","dom.createCSSRule","dom.asCSSUrl","dom.$","QuickInputBox","dom.addDisposableListener","dom.EventType","dom.append","InputBox","placeholder","ariaLabel","password","KeybindingLabel","chordPart","dom.clearNode","part","modifierLabels","keyLabel","highlight","separator","localize","extraClass","keyElement","equals","intlFileNameCollatorBaseNumeric","IdleValue","collator","compareFileNames","one","caseSensitive","compareAnything","lookFor","elementAName","elementBName","prefixCompare","compareByPrefix","elementASuffixMatch","elementBSuffixMatch","elementAPrefixMatch","elementBPrefixMatch","ListElement","init","ListElementRenderer","dom.addStandardDisposableListener","row1","row2","IconLabel","keybindingContainer","platform.OS","detailContainer","labelHighlights","descriptionHighlights","detailHighlights","buttons","button","cssClasses","Action","ListElementDelegate","QuickInputListFocus","QuickInputList","accessibilityProvider","QuickInputAccessibilityProvider","platform.isMacintosh","focus1","focus2","whenNoneVisible","count","inputElements","fireButtonTriggered","_c","saneLabel","saneSortLabel","parseLabelWithIcons","saneMeta","saneDescription","saneDetail","saneAriaLabel","getCodiconAriaLabel","hasCheckbox","map","focused","maxHeight","query","queryWithWhitespace","currentSeparator","withNullAsUndefined","matchesFuzzyIconAware","matchesContiguousIconAware","metaHighlights","shownElements","normalizedSearchValue","compareEntries","allChecked","display","memoize","iconOffsets","matchesContiguous","wordToMatchAgainstWithoutIconsTrimmed","ltrim","leadingWhitespaceOffset","iconOffset","wordToMatchAgainst","matchIndex","elementA","elementB","labelHighlightsA","labelHighlightsB","backButton","QuickInput","ui","title","description","totalSteps","enabled","contextKey","busy","ignoreFocusOut","shouldUpdate","isIOS","validationMessage","severity","QuickInputHideReason","leftButtons","rightButtons","dom.reset","QuickPick","ItemActivation","quickNavigate","skipUpdate","canSelectMany","canAcceptInBackground","matchOnDescription","matchOnDetail","matchOnLabel","matchOnLabelMode","sortByLabel","autoFocusOnList","keepScrollPosition","itemActivation","activeItems","selectedItems","NO_KEY_MODS","valueSelection","showCustomButton","hover","showOkButton","hideInput","dom.EventHelper","focusedItems","checkedItems","inBackground","veto","keyboardEvent","scrollTopBefore","visibilities","QuickInputController","listener","styleSheet","dom.createStyleSheet","titleBar","leftActionBar","rightActionBar","description1","headerContainer","checkAll","list","inputBox","description2","extraContainer","filterContainer","visibleCountContainer","visibleCount","CountBadge","countContainer","okContainer","ok","customButtonContainer","customButton","progressBar","focusTracker","dom.trackFocus","selectors","stops","controller","picks","doResolve","activeItem","disposables","removed","keepScrollPositionBefore","_activeItem","oldController","backKeybindingLabel","focusChanged","currentElement","dimension","titleBarOffset","width","quickInputTitleBackground","quickInputBackground","quickInputForeground","contrastBorder","widgetShadow","newStyles","DefaultQuickAccessFilterValue","QuickAccessRegistry","providerA","providerB","coalesce","prefix","QuickAccessController","quickInputService","instantiationService","pick","descriptor","visibleQuickAccess","visibleDescriptor","newValueCandidateWithoutPrefix","defaultFilterValue","picker","pickPromise","DeferredPromise","once","cts","providerForValue","providerDescriptor","IQuickInputService","IInstantiationService","QuickInputService","Themable","accessibilityService","user","renderers","WorkbenchList","RawContextKey","computeStyles","inputForeground","inputBackground","inputBorder","inputValidationInfoBackground","inputValidationInfoForeground","inputValidationInfoBorder","inputValidationWarningBackground","inputValidationWarningForeground","inputValidationWarningBorder","inputValidationErrorBackground","inputValidationErrorForeground","inputValidationErrorBorder","badgeBackground","badgeForeground","buttonForeground","buttonBackground","buttonHoverBackground","progressBarBackground","keybindingLabelBackground","keybindingLabelForeground","keybindingLabelBorder","keybindingLabelBottomBorder","quickInputListFocusForeground","quickInputListFocusIconForeground","quickInputListFocusBackground","activeContrastBorder","pickerGroupBorder","pickerGroupForeground","IAccessibilityService","EditorScopedQuickInputService","contribution","QuickInputEditorContribution","widget","StandaloneQuickInputService","newQuickInputService","QuickInputEditorWidget","codeEditor","registerEditorContribution","ParsedTokenThemeRule","fontStyle","parseTokenTheme","resultLen","lenJ","resolveParsedTokenThemeRules","parsedThemeRules","customTokenColors","strcmp","defaultFontStyle","defaultForeground","defaultBackground","incomingDefaults","colorMap","ColorMap","foregroundColorId","backgroundColorId","defaults","ThemeTrieElementRule","ThemeTrieElement","TokenTheme","colorRegExp","standardToken","toStandardTokenType","STANDARD_TOKEN_TYPE_REGEXP","mainRule","dotIndex","head","tail","child","generateTokensCSSForColorMap","vs","editorBackground","editorForeground","editorInactiveSelection","editorIndentGuides","editorActiveIndentGuides","editorSelectionHighlight","vs_dark","hc_black","hc_light","getIconsStyleSheet","onDidChangeEmmiter","iconRegistry","getIconRegistry","productIconTheme","UnthemedProductIconTheme","usedFontIds","formatIconRule","definition","fontContribution","asCSSPropertyValue","fontWeight","src","l","asCSSUrl","ThemeIcon","VS_LIGHT_THEME_NAME","VS_DARK_THEME_NAME","HC_BLACK_THEME_NAME","HC_LIGHT_THEME_NAME","colorRegistry","themingRegistry","ThemingExtensions","StandaloneTheme","standaloneThemeData","isBuiltinTheme","colors","baseData","getBuiltinRules","colorId","useDefault","ColorScheme","encodedTokensColors","modifiers","modelLanguage","TokenMetadata","themeName","builtinTheme","newBuiltInTheme","themeData","StandaloneThemeService","iconsStyleSheet","addMatchMediaChangeListener","dom.isInShadowDOM","styleElement","colorMapOverride","desiredTheme","wantsHighContrast","isHighContrast","newThemeName","isDark","autoDetectHighContrast","cssRules","hasRule","ruleCollector","p","colorVariables","asCssVariableName","IStandaloneThemeService","AccessibilityService","_layoutService","CONTEXT_ACCESSIBILITY_MODE_ENABLED","updateContextKey","reduceMotionMatcher","updateRootClasses","reduce","MenuService","storageService","PersistedMenuHideState","IStorageService","_storageService","raw","hidden","entries","removeFastWithoutKeepingOrder","_id","_hiddenStates","_options","_menuService","rebuildMenuSoon","MenuRegistry","lazyListener","startLazyListener","fireChangeSoon","menuItems","groupName","isIMenuItem","toggledExpression","toggleActions","activeActions","menuHide","createMenuHide","MenuItemAction","SubmenuItemAction","exp","set","aGroup","bGroup","aPrio","bPrio","aStr","bStr","IMenuService","hide","toAction","toggle","BrowserClipboardService","isSafari","isWebkitWebView","currentWritePromise","activeElement","textArea","KEYBINDING_CONTEXT_ATTR","Context","NullContext","ConfigAwareContextValuesContainer","TernarySearchTree","allKeys","Iterable","ArrayContextKeyChangeEvent","changedKeys","configKey","cachedItems","configValue","ContextKey","service","SimpleContextKeyChangeEvent","CompositeContextKeyChangeEvent","events","evt","allEventKeysInContext","AbstractContextKeyService","myContextId","PauseableEmitter","ScopedContextKeyService","myContext","findContextAttr","ContextKeyService","contextId","parentContextId","MutableDisposable","extraInfo","thisContextValues","setContext","accessor","stringifyURIs","cloneAndChange","CommandsRegistry","SET_CONTEXT_COMMAND_ID","Node","Graph","_hashFn","node","fromNode","toNode","outgoing","CyclicDependencyError","graph","InstantiationService","services","ServiceCollection","strict","fn","_trace","Trace","_done","illegalState","ctorOrDescriptor","SyncDescriptor","ctor","serviceDependencies","_util","serviceArgs","dependency","firstServiceArgPos","delta","instanceOrDesc","thing","cycleCount","roots","supportsDelayedInstantiation","_supportsDelayedInstantiation","idle","prop","_target","printWarning","first","dur","causedCreation","printChild","trace","nested","DoubleResourceMap","ownerMap","resourceMap","removedA","removedB","_d","MarkerStats","oldStats","newStats","op","MarkerService","DebounceEmitter","markerData","isFalsyOrEmpty","code","startLineNumber","endLineNumber","relatedInformation","tags","existing","groups","severities","take","newLen","iterable","score","selector","candidateUri","candidateLanguage","candidateIsSynchronized","candidateNotebookUri","candidateNotebookType","scheme","hasAccessToAllModels","notebookType","normalizedPattern","normalize","matchGlobPattern","isExclusive","MatchCandidate","notebookUri","LanguageFeatureRegistry","_notebookInfoResolver","lastBucket","lastBucketScore","notebookInfo","shouldSynchronizeModel","LanguageFeaturesService","DefaultConfigurationModel","configurationDefaultsOverrides","properties","defaultOverrideValue","OVERRIDE_PROPERTY_REGEX","overrideIdentifiersFromKey","SimpleModel","StandaloneTextModelService","ImmortalReference","StandaloneEditorProgressService","promise","delay","StandaloneProgressService","task","onDidCancel","StandaloneDialogService","confirmation","confirmed","messageText","StandaloneNotificationService","notification","NoOpNotification","StandaloneCommandService","StandaloneKeybindingService","addContainer","keyEvent","DomNodeListeners","removeContainer","domNodeListeners","addCodeEditor","removeCodeEditor","addDiffEditor","diffEditor","removeDiffEditor","createKeybinding","OS","KeybindingsRegistry","resolvedKeybindings","isConfigurationOverrides","StandaloneConfigurationService","values","configurationChangeEvent","arg3","arg4","StandaloneResourceConfigurationService","configuration","Pos","StandaloneResourcePropertiesService","StandaloneTelemetryService","StandaloneWorkspaceContextService","WorkspaceFolder","updateConfigurationService","isDiffEditor","toUpdate","isEditorConfigurationKey","isDiffEditorConfigurationKey","StandaloneBulkEditService","_modelService","textEdits","edit","ResourceTextEdit","EditOperation","totalEdits","totalFiles","strings.format","StandaloneServicesNLS","StandaloneUriLabelService","StandaloneContextViewService","StandaloneWorkspaceTrustManagementService","StandaloneLanguageService","StandaloneLogService","LogService","ConsoleLogger","StandaloneContextMenuService","ITextResourcePropertiesService","IWorkspaceContextService","ILabelService","ILanguageService","ModelService","IMarkerDecorationsService","IProgressService","IEditorProgressService","InMemoryStorageService","IEditorWorkerService","IBulkEditService","IWorkspaceTrustManagementService","ITextModelService","IListService","ListService","IOpenerService","IClipboardService","IContextMenuService","StandaloneServices","serviceCollection","getSingletonServiceDescriptors","get","serviceId","initialized","initialize","serviceIdentifier","LAST_GENERATED_COMMAND_ID","ariaDomNodeCreated","createAriaDomNode","aria.setARIAContainer","StandaloneCodeEditor","CodeEditorWidget","domElement","StandaloneCodeEditorNLS","whenExpression","ContextKeyExpr","_descriptor","precondition","keybindings","keybindingsWhen","contextMenuGroupId","contextMenuOrder","run","uniqueId","menuItem","MenuId","internalAction","InternalEditorAction","handlerId","payload","StandaloneEditor","themeDomRegistration","_model","createTextModel","newOptions","detachedModel","StandaloneDiffEditor","DiffEditorWidget","editorWorkerService","contextMenuService","editorProgressService","clipboardService","firstLF","doCreateModel","languageSelection","create","onDidCreateEditor","onDidCreateDiffEditor","getEditors","getDiffEditors","createDiffEditor","createDiffNavigator","addCommand","addEditorAction","EditorCommand","addKeybindingRule","addKeybindingRules","createModel","setModelLanguage","setModelMarkers","removeAllMarkers","getModelMarkers","onDidChangeMarkers","getModel","getModels","onDidCreateModel","onWillDisposeModel","onDidChangeModelLanguage","actualCreateWebWorker","colorizeElement","colorize","colorizeModelLine","getSafeTokenizationSupport","tokenize","tokenizationResult","defineTheme","setTheme","remeasureFonts","FontMeasurements","registerCommand","createMonacoEditorAPI","standaloneEnums.AccessibilitySupport","standaloneEnums.ContentWidgetPositionPreference","standaloneEnums.CursorChangeReason","standaloneEnums.DefaultEndOfLine","standaloneEnums.EditorAutoIndentStrategy","standaloneEnums.EditorOption","standaloneEnums.EndOfLinePreference","standaloneEnums.EndOfLineSequence","standaloneEnums.MinimapPosition","standaloneEnums.MouseTargetType","standaloneEnums.OverlayWidgetPositionPreference","standaloneEnums.OverviewRulerLane","standaloneEnums.RenderLineNumbersType","standaloneEnums.RenderMinimap","standaloneEnums.ScrollbarVisibility","standaloneEnums.ScrollType","standaloneEnums.TextEditorCursorBlinkingStyle","standaloneEnums.TextEditorCursorStyle","standaloneEnums.TrackedRangeStickiness","standaloneEnums.WrappingIndent","standaloneEnums.InjectedTextCursorStops","standaloneEnums.PositionAffinity","ConfigurationChangedEvent","BareFontInfo","FontInfo","TextModelResolvedOptions","FindMatch","ApplyUpdateResult","EditorType","EditorOptions","isArrayOf","elemType","el","bool","defValue","string","arrayToHash","createKeywordMatcher","caseInsensitive","x","compileRegExp","hadExpansion","monarchCommon.empty","selectScrutinee","num","createGuard","ruleName","tkey","val","scrut","oppat","pat","tester","inWords","patx","eos","patexp","scrutinee","compileAction","newAction","next","monarchCommon.stateExists","results","cases","_case","Rule","sregex","act","compile","json","lexerMin","addRules","newrules","include","newrule","rule1","register","getLanguages","getEncodedLanguageId","onLanguage","encounteredLanguageId","setLanguageConfiguration","EncodedTokenizationSupportAdapter","TokenizationSupportAdapter","_languageId","_actual","_languageService","_standaloneThemeService","previousStartIndex","t","actualResult","tokenTheme","isATokensProvider","isEncodedTokensProvider","setColorMap","createTokenizationSupportAdapter","registerTokensProviderFactory","factory","adaptedFactory","setTokensProvider","setMonarchTokensProvider","languageDef","registerReferenceProvider","languageSelector","registerRenameProvider","registerSignatureHelpProvider","registerHoverProvider","registerDocumentSymbolProvider","registerDocumentHighlightProvider","registerLinkedEditingRangeProvider","registerDefinitionProvider","registerImplementationProvider","registerTypeDefinitionProvider","registerCodeLensProvider","registerCodeActionProvider","registerDocumentFormattingEditProvider","registerDocumentRangeFormattingEditProvider","registerOnTypeFormattingEditProvider","registerLinkProvider","registerCompletionItemProvider","registerColorProvider","registerFoldingRangeProvider","registerDeclarationProvider","registerSelectionRangeProvider","registerDocumentSemanticTokensProvider","registerDocumentRangeSemanticTokensProvider","registerInlineCompletionsProvider","registerInlayHintsProvider","createMonacoLanguagesAPI","standaloneEnums.DocumentHighlightKind","standaloneEnums.CompletionItemKind","standaloneEnums.CompletionItemTag","standaloneEnums.CompletionItemInsertTextRule","standaloneEnums.SymbolKind","standaloneEnums.SymbolTag","standaloneEnums.IndentAction","standaloneEnums.CompletionTriggerKind","standaloneEnums.SignatureHelpTriggerKind","standaloneEnums.InlayHintKind","standaloneEnums.InlineCompletionTriggerKind","standaloneEnums.CodeActionTriggerType","languages.FoldingRangeKind","FormattingConflicts","formatter","document","mode","api","KeyCode","SelectionDirection","MarkerTag","Uri","languages"],"mappings":"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"}